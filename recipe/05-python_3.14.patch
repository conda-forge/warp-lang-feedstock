# From git diff v1.9.1 5ddc94f042dc7a41d22911dcff7800ab6da3be29 > warp-python-3.14.patch.
# See https://github.com/conda-forge/warp-lang-feedstock/pull/70#issuecomment-3444164558
diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml
index 090c1f82..e28ad0cc 100644
--- a/.github/workflows/ci.yml
+++ b/.github/workflows/ci.yml
@@ -28,43 +28,28 @@ on:
     - cron: "45 9 * * *"
 
 jobs:
-  build-warp-windows:
-    runs-on: windows-2022
-    steps:
-      - name: Checkout repository
-        uses: actions/checkout@v4
-        with:
-          lfs: true
-      - name: Install uv
-        uses: astral-sh/setup-uv@d4b2f3b6ecc6e67c4457f6d3e41ec42d3d0fcb86
-        with:
-          version: "0.7.5"
-      - name: Set up Python
-        uses: actions/setup-python@v5
-        with:
-          python-version-file: '.python-version'
-      - name: Install CTK
-        uses: Jimver/cuda-toolkit@v0.2.21
-        id: cuda-toolkit
-        with:
-          sub-packages: '["cudart", "nvcc", "nvrtc_dev", "nvjitlink"]'
-          method: 'network'
-      - name: Install dependencies
-        run: |
-          uv venv
-          uv pip install --upgrade numpy
-      - name: Build
-        run: |
-          .venv\Scripts\activate
-          python build_lib.py
-      - name: Upload build artifact
-        uses: actions/upload-artifact@v4
-        with:
-          name: build-artifact-windows
-          path: ./warp/bin/
-
-  build-warp-ubuntu-x86_64:
-    runs-on: ubuntu-22.04
+  build-warp:
+    runs-on: ${{ matrix.os }}
+    strategy:
+      fail-fast: false
+      matrix:
+        include:
+          - os: windows-2025
+            platform: windows
+            cuda-sub-packages: '["cudart", "nvcc", "nvrtc_dev", "nvjitlink"]'
+            cuda-non-cuda-packages: ''
+          - os: ubuntu-24.04
+            platform: ubuntu-x86_64
+            cuda-sub-packages: '["cudart-dev", "nvcc", "nvrtc-dev"]'
+            cuda-non-cuda-packages: '["libnvjitlink-dev"]'
+          - os: ubuntu-24.04-arm
+            platform: ubuntu-aarch64
+            cuda-sub-packages: '["cudart-dev", "nvcc", "nvrtc-dev"]'
+            cuda-non-cuda-packages: '["libnvjitlink-dev"]'
+          - os: macos-latest
+            platform: macos
+            cuda-sub-packages: ''
+            cuda-non-cuda-packages: ''
     outputs:
       artifact-url: ${{ steps.exports-header.outputs.artifact-url }}
     steps:
@@ -72,244 +57,97 @@ jobs:
         uses: actions/checkout@v4
         with:
           lfs: true
+      
       - name: Install uv
         uses: astral-sh/setup-uv@d4b2f3b6ecc6e67c4457f6d3e41ec42d3d0fcb86
         with:
-          version: "0.7.5"
+          version: "0.8.23"
+      
       - name: Set up Python
         uses: actions/setup-python@v5
         with:
           python-version-file: '.python-version'
-      - name: Install CTK
-        uses: Jimver/cuda-toolkit@v0.2.21
-        id: cuda-toolkit
+      
+      - name: Cache build artifacts
+        if: matrix.platform != 'macos'
+        uses: actions/cache@v4
+        id: cache-build
+        with:
+          path: warp/bin/
+          key: build-${{ matrix.platform }}-${{ hashFiles('build_lib.py', 'warp/build_dll.py', 'build_llvm.py', 'warp/native/**/*.cpp', 'warp/native/**/*.cu', 'warp/native/**/*.h', 'deps/libmathdx-deps.packman.xml') }}
+      
+      - name: Install CTK (with non-CUDA packages)
+        if: steps.cache-build.outputs.cache-hit != 'true' && matrix.cuda-sub-packages != '' && matrix.cuda-non-cuda-packages != ''
+        uses: Jimver/cuda-toolkit@1a3c14e26833ccf292b268f9a790fb47dea7b2da
+        with:
+          sub-packages: ${{ matrix.cuda-sub-packages }}
+          non-cuda-sub-packages: ${{ matrix.cuda-non-cuda-packages }}
+          method: 'network'
+      
+      - name: Install CTK (without non-CUDA packages)
+        if: steps.cache-build.outputs.cache-hit != 'true' && matrix.cuda-sub-packages != '' && matrix.cuda-non-cuda-packages == ''
+        uses: Jimver/cuda-toolkit@c35baa1a18fd1fc9dcf47c5bd839bf30559c0bc3  # https://github.com/Jimver/cuda-toolkit/issues/395
         with:
-          sub-packages: '["cudart-dev", "nvcc", "nvrtc-dev"]'
-          non-cuda-sub-packages: '["libnvjitlink-dev"]'
+          sub-packages: ${{ matrix.cuda-sub-packages }}
           method: 'network'
-      - name: Install dependencies
-        run: |
-          uv venv
-          uv pip install --upgrade numpy
+      
       - name: Build Warp
-        run: |
-          source .venv/bin/activate
-          python build_lib.py
+        if: steps.cache-build.outputs.cache-hit != 'true'
+        run: uv run build_lib.py
+      
       - name: Upload build artifact
         uses: actions/upload-artifact@v4
         with:
-          name: build-artifact-ubuntu-x86_64
+          name: build-artifact-${{ matrix.platform }}
           path: warp/bin/
+      
       - name: Upload exports.h
         uses: actions/upload-artifact@v4
         id: exports-header
         with:
-          name: exports-header
+          name: exports-header-${{ matrix.platform }}
           path: warp/native/exports.h
 
-  build-warp-ubuntu-aarch64:
-    runs-on: ubuntu-22.04-arm
+  test-warp:
+    runs-on: ${{ matrix.os }}
+    needs: build-warp
+    strategy:
+      fail-fast: false
+      matrix:
+        include:
+          - os: windows-2025
+            platform: windows
+          - os: ubuntu-24.04
+            platform: ubuntu-x86_64
+          - os: ubuntu-24.04-arm
+            platform: ubuntu-aarch64
+          - os: macos-latest
+            platform: macos
     steps:
       - name: Checkout repository
         uses: actions/checkout@v4
         with:
           lfs: true
+      
       - name: Install uv
         uses: astral-sh/setup-uv@d4b2f3b6ecc6e67c4457f6d3e41ec42d3d0fcb86
         with:
-          version: "0.7.5"
-      - name: Set up Python
-        uses: actions/setup-python@v5.6.0
-        with:
-          python-version-file: '.python-version'
-      - name: Install CTK
-        uses: Jimver/cuda-toolkit@v0.2.21
-        id: cuda-toolkit
-        with:
-          sub-packages: '["cudart-dev", "nvcc", "nvrtc-dev"]'
-          non-cuda-sub-packages: '["libnvjitlink-dev"]'
-          method: 'network'
-      - name: Install dependencies
-        run: |
-          uv venv
-          uv pip install --upgrade numpy
-      - name: Build Warp
-        run: |
-          source .venv/bin/activate
-          python build_lib.py
-      - name: Upload build artifact
-        uses: actions/upload-artifact@v4
-        with:
-          name: build-artifact-ubuntu-aarch64
-          path: warp/bin/
-
-  build-warp-macos:
-    runs-on: macos-latest
-    steps:
-      - name: Checkout repository
-        uses: actions/checkout@v4
-        with:
-          lfs: true
-      - name: Install uv
-        uses: astral-sh/setup-uv@d4b2f3b6ecc6e67c4457f6d3e41ec42d3d0fcb86
-        with:
-          version: "0.7.5"
-      - name: Set up Python
-        uses: actions/setup-python@v5
-        with:
-          python-version-file: '.python-version'
-      - name: Install dependencies
-        run: |
-          uv venv
-          uv pip install --upgrade numpy
-      - name: Build
-        run: |
-          source .venv/bin/activate
-          python build_lib.py
-      - name: Upload build artifact
-        uses: actions/upload-artifact@v4
-        with:
-          name: build-artifact-macos
-          path: ./warp/bin/
-
-  test-warp-windows:
-    runs-on: windows-latest
-    needs: build-warp-windows
-    env:
-      OS: windows-latest
-    steps:
-      - name: Checkout repository
-        uses: actions/checkout@v4
-        with:
-          lfs: true
-      - name: Install uv
-        uses: astral-sh/setup-uv@d4b2f3b6ecc6e67c4457f6d3e41ec42d3d0fcb86
-        with:
-          version: "0.7.5"
+          version: "0.8.23"
+      
       - name: Set up Python
         uses: actions/setup-python@v5
         with:
           python-version-file: '.python-version'
+      
       - name: Download Warp build artifact
         uses: actions/download-artifact@v4
         with:
-          name: build-artifact-windows
-          path: ./warp/bin/
-      - name: Install Dependencies
-        run: |
-          uv venv
-          uv pip install --upgrade numpy usd-core Pillow
-          uv pip install -e .
-      - name: Run Tests
-        run: uv run -m warp.tests --junit-report-xml rspec.xml -s autodetect
-      - name: Test Summary
-        uses: test-summary/action@v2.3
-        with:
-          paths: "rspec.xml"
-          show: "fail"
-        if: always()
-
-  test-warp-ubuntu-x86_64:
-    runs-on: ubuntu-latest
-    needs: build-warp-ubuntu-x86_64
-    env:
-      OS: ubuntu-latest
-    steps:
-      - name: Checkout repository
-        uses: actions/checkout@v4
-        with:
-          lfs: true
-      - name: Install uv
-        uses: astral-sh/setup-uv@d4b2f3b6ecc6e67c4457f6d3e41ec42d3d0fcb86
-        with:
-          version: "0.7.5"
-      - name: Set up Python
-        uses: actions/setup-python@v5
-        with:
-          python-version-file: '.python-version'
-      - name: Download Warp build artifact
-        uses: actions/download-artifact@v4
-        with:
-          name: build-artifact-ubuntu-x86_64
-          path: ./warp/bin/
-      - name: Install Dependencies
-        run: |
-          uv venv
-          uv pip install --upgrade numpy usd-core Pillow
-          uv pip install -e .
-      - name: Run Tests
-        run: uv run -m warp.tests --junit-report-xml rspec.xml -s autodetect
-      - name: Test Summary
-        uses: test-summary/action@v2.3
-        with:
-          paths: "rspec.xml"
-          show: "fail"
-        if: always()
-
-  test-warp-ubuntu-aarch64:
-    runs-on: ubuntu-22.04-arm
-    needs: build-warp-ubuntu-aarch64
-    env:
-      OS: ubuntu-22.04-arm
-    steps:
-      - name: Checkout repository
-        uses: actions/checkout@v4
-        with:
-          lfs: true
-      - name: Set up Python
-        uses: actions/setup-python@v5
-        with:
-          python-version-file: '.python-version'
-      - name: Download Warp build artifact
-        uses: actions/download-artifact@v4
-        with:
-          name: build-artifact-ubuntu-aarch64
-          path: ./warp/bin/
-      - name: Install Dependencies
-        run: |
-          python -m pip cache purge
-          python -m pip install --upgrade pip
-          pip install --no-cache-dir --upgrade numpy
-          pip install -e .
-      - name: Run Tests
-        run: python -m warp.tests --junit-report-xml rspec.xml -s autodetect
-      - name: Test Summary
-        uses: test-summary/action@v2.3
-        with:
-          paths: "rspec.xml"
-          show: "fail"
-        if: always()
-
-  test-warp-macos:
-    runs-on: macos-latest
-    needs: build-warp-macos
-    env:
-      OS: macos-latest
-    steps:
-      - name: Checkout repository
-        uses: actions/checkout@v4
-        with:
-          lfs: true
-      - name: Install uv
-        uses: astral-sh/setup-uv@d4b2f3b6ecc6e67c4457f6d3e41ec42d3d0fcb86
-        with:
-          version: "0.7.5"
-      - name: Set up Python
-        uses: actions/setup-python@v5
-        with:
-          python-version-file: '.python-version'
-      - name: Download Warp build artifact
-        uses: actions/download-artifact@v4
-        with:
-          name: build-artifact-macos
-          path: ./warp/bin/
-      - name: Install Dependencies
-        run: |
-          uv venv
-          uv pip install --upgrade numpy usd-core Pillow
-          uv pip install -e .
+          name: build-artifact-${{ matrix.platform }}
+          path: warp/bin/
+      
       - name: Run Tests
-        run: uv run -m warp.tests --maxjobs 4  --junit-report-xml rspec.xml -s autodetect
+        run: uv run --extra dev -m warp.tests --junit-report-xml rspec.xml -s autodetect
+      
       - name: Test Summary
         uses: test-summary/action@v2.3
         with:
@@ -319,7 +157,7 @@ jobs:
 
   pull-request-docs:
     runs-on: ubuntu-latest
-    needs: build-warp-ubuntu-x86_64
+    needs: build-warp
     if: ${{ github.event_name == 'pull_request' }}
     outputs:
       artifact-url: ${{ steps.build-docs-output.outputs.artifact-url }}
@@ -329,7 +167,7 @@ jobs:
       - name: Install uv
         uses: astral-sh/setup-uv@d4b2f3b6ecc6e67c4457f6d3e41ec42d3d0fcb86
         with:
-          version: "0.7.5"
+          version: "0.8.23"
       - name: Set up Python
         uses: actions/setup-python@v5
         with:
@@ -339,16 +177,11 @@ jobs:
         with:
           name: build-artifact-ubuntu-x86_64
           path: warp/bin/
-      - name: Install dependencies
-        run: |
-          uv venv
-          uv pip install -r docs/requirements.txt
       - name: Build Sphinx documentation
         run: |
-          source .venv/bin/activate
-          uv run build_docs.py --quick
+          uv run --extra docs build_docs.py --quick
       - name: Upload artifacts
-        uses: actions/upload-artifact@v4.6.2
+        uses: actions/upload-artifact@v4
         id: build-docs-output
         with:
           name: build-docs-output
@@ -382,7 +215,7 @@ jobs:
 
   check-exports-header:
     runs-on: ubuntu-latest
-    needs: build-warp-ubuntu-x86_64
+    needs: build-warp
     if: ${{ github.event_name == 'pull_request' }}
     steps:
       - name: Checkout repository
@@ -390,11 +223,117 @@ jobs:
       - name: Download exports.h
         uses: actions/download-artifact@v4
         with:
-          name: exports-header
+          name: exports-header-ubuntu-x86_64
           path: warp/native/
       - name: Check exports.h
         env:
-          ARTIFACT_URL: ${{ needs.build-warp-ubuntu-x86_64.outputs.artifact-url }}
+          ARTIFACT_URL: ${{ needs.build-warp.outputs.artifact-url }}
         run: >
           git diff --exit-code warp/native/exports.h ||
           (echo "Please run build_lib.py (or download from $ARTIFACT_URL) and add warp/native/exports.h to your pull request." && false)
+
+  check-unnamespaced-symbols:
+    runs-on: ubuntu-latest
+    needs: build-warp
+    steps:
+      - name: Download Warp build artifact
+        uses: actions/download-artifact@v4
+        with:
+          name: build-artifact-ubuntu-x86_64
+          path: warp/bin/
+      - name: Check for un-namespaced symbols
+        run: |
+          echo "Checking for un-namespaced symbols..."
+          LIBRARIES_TO_CHECK="warp/bin/warp.so warp/bin/warp-clang.so"
+          found_symbols=""
+
+          for lib in $LIBRARIES_TO_CHECK; do
+            echo "--> Checking $lib"
+            if [ ! -f "$lib" ]; then
+              echo "ERROR: $lib not found"
+              found_symbols="true"
+              continue
+            fi
+            output=$(readelf -Ws "$lib" | awk '$7 ~ /^[0-9]+$/ && $8 !~ /^_?wp_/ {print $8}' | grep -Ev '^(_Z|__|\.)' || true)
+            
+            if [ -n "$output" ]; then
+              echo "ERROR: Found un-namespaced symbols in $lib:"
+              echo "$output"
+              found_symbols="true"
+            fi
+          done
+
+          if [ -n "$found_symbols" ]; then
+            echo "FAIL: Un-namespaced symbols detected. Please prefix them with 'wp_' or '_wp_'."
+            exit 1
+          fi
+
+          echo "SUCCESS: All symbols are correctly namespaced."
+
+  cppcheck:
+    runs-on: ubuntu-latest
+    steps:
+      - name: Checkout repository
+        uses: actions/checkout@v4
+      
+      - name: Cache cppcheck build directory
+        uses: actions/cache@v4
+        with:
+          path: _build/.cppcheck
+          key: cppcheck-${{ github.run_id }}
+          restore-keys: |
+            cppcheck-
+      
+      - name: Set up Miniforge
+        run: |
+          wget -q -O Miniforge3.sh "https://github.com/conda-forge/miniforge/releases/latest/download/Miniforge3-$(uname)-$(uname -m).sh"
+          bash Miniforge3.sh -b -p "${HOME}/conda"
+          echo "${HOME}/conda/bin" >> $GITHUB_PATH
+      
+      - name: Install cppcheck
+        run: |
+          source "${HOME}/conda/etc/profile.d/conda.sh"
+          conda activate
+          conda install cppcheck --channel conda-forge -y
+          mkdir -p _build/.cppcheck
+          cppcheck --version
+      
+      - name: Run cppcheck
+        run: |
+          source "${HOME}/conda/etc/profile.d/conda.sh"
+          conda activate
+          cppcheck \
+            --inline-suppr \
+            --cppcheck-build-dir=_build/.cppcheck \
+            --enable=warning \
+            --quiet \
+            --error-exitcode=1 \
+            -j $(nproc) \
+            --suppress=*:warp/native/nanovdb/* \
+            --suppress=normalCheckLevelMaxBranches \
+            warp
+      
+      - name: Generate XML report
+        if: always()
+        run: |
+          source "${HOME}/conda/etc/profile.d/conda.sh"
+          conda activate
+          cppcheck \
+            --inline-suppr \
+            --cppcheck-build-dir=_build/.cppcheck \
+            --enable=warning \
+            --quiet \
+            --xml \
+            --xml-version=2 \
+            -j $(nproc) \
+            --suppress=*:warp/native/nanovdb/* \
+            --suppress=normalCheckLevelMaxBranches \
+            warp \
+            2> cppcheck-report.xml
+      
+      - name: Upload cppcheck report
+        if: always()
+        uses: actions/upload-artifact@v4
+        with:
+          name: cppcheck-report
+          path: cppcheck-report.xml
diff --git a/.github/workflows/sphinx.yml b/.github/workflows/sphinx.yml
index e32f5396..fb6783d8 100644
--- a/.github/workflows/sphinx.yml
+++ b/.github/workflows/sphinx.yml
@@ -35,22 +35,17 @@ jobs:
       - name: Install uv
         uses: astral-sh/setup-uv@d4b2f3b6ecc6e67c4457f6d3e41ec42d3d0fcb86
         with:
-          version: "0.7.5"
+          version: "0.8.23"
       - name: Set up Python
         uses: actions/setup-python@v5
         with:
           python-version-file: '.python-version'
-      - name: Install dependencies
-        run: |
-          uv venv
-          uv pip install -r docs/requirements.txt
       - name: Build Warp without CUDA Support
         run: |
-          source .venv/bin/activate
-          python build_lib.py
+          uv run build_lib.py
       - name: Build Sphinx documentation
         run: |
-          uv run build_docs.py --quick
+          uv run --extra docs build_docs.py --quick
       - name: Upload artifacts
         uses: actions/upload-artifact@v4
         with:
diff --git a/.gitlab-ci.yml b/.gitlab-ci.yml
index c8469365..cd301a5a 100644
--- a/.gitlab-ci.yml
+++ b/.gitlab-ci.yml
@@ -43,22 +43,14 @@ variables:
   CUDA_BIN: "$CI_PROJECT_DIR/_build/target-deps/cuda/bin"
   CUDA: "$CI_PROJECT_DIR/_build/target-deps/cuda"
   CUDA_HOME: "$CI_PROJECT_DIR/_build/target-deps/cuda"
-  PYTHON: "$CI_PROJECT_DIR/_build/target-deps/python/python"
-  LINBUILD: "$CI_PROJECT_DIR/_build/host-deps/linbuild/linbuild.sh"
   WARP_CACHE_ROOT: "$CI_PROJECT_DIR/.cache/warp" # Used by the parallel test runner
   GIT_DEPTH: 1
   UV_LINK_MODE: copy
-  DEFAULT_PYTHON:
-    value: "3.9.18+nv1"
-    options:
-      - "3.11.8+nv1"
-      - "3.10.13+nv3"
-      - "3.9.18+nv1"
-      - "3.8.18+nv1"
-    description: "The default Python version used in the main testing jobs."
+  UV_HTTP_TIMEOUT: 120
   UV_PYTHON:
     value: "3.12"
     options:
+      - "3.14"
       - "3.13"
       - "3.12"
       - "3.11"
@@ -89,9 +81,12 @@ linux-aarch64 build:
     - echo -e "\\e[0Ksection_start:`date +%s`:install_dependencies[collapsed=true]\\r\\e[0KInstalling dependencies"
     - yum update -y && yum install curl wget -y
     - gcc --version
+    - wget -qO- https://astral.sh/uv/install.sh | sh
+    - export PATH="$HOME/.local/bin:$CUDA_BIN:$PATH"
+    - tools/packman/packman pull --platform linux-aarch64 deps/cuda-toolkit-deps.packman.xml --verbose --include-tag "cuda-12"
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
   script:
-    - ./tools/ci/building/build-linux-aarch64/build.sh --no-docker
+    - uv run build_lib.py --cuda_path=$CUDA
     - mkdir -p warp/bin/linux-aarch64
     - mv warp/bin/warp.so warp/bin/linux-aarch64
     - mv warp/bin/warp-clang.so warp/bin/linux-aarch64
@@ -106,9 +101,12 @@ linux-x86_64 build:
     - echo -e "\\e[0Ksection_start:`date +%s`:install_dependencies[collapsed=true]\\r\\e[0KInstalling dependencies"
     - yum update -y && yum install curl wget -y
     - gcc --version
+    - wget -qO- https://astral.sh/uv/install.sh | sh
+    - export PATH="$HOME/.local/bin:$CUDA_BIN:$PATH"
+    - tools/packman/packman pull --platform linux-x86_64 deps/cuda-toolkit-deps.packman.xml --verbose --include-tag "cuda-12"
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
   script:
-    - ./tools/ci/building/build-linux-x86_64/build.sh --no-docker
+    - uv run build_lib.py --cuda_path=$CUDA
     - mkdir -p warp/bin/linux-x86_64
     - mv warp/bin/warp.so warp/bin/linux-x86_64
     - mv warp/bin/warp-clang.so warp/bin/linux-x86_64
@@ -120,8 +118,15 @@ windows-x86_64 build:
     - .runner-build-windows-x86_64
   before_script:
     - powershell -command "Get-Volume | Format-Table -AutoSize"
+    - powershell -ExecutionPolicy ByPass -c {$env:UV_UNMANAGED_INSTALL = "$env:CI_PROJECT_DIR\_uv";irm https://astral.sh/uv/install.ps1 | iex}
+    - $env:PATH = "$env:CI_PROJECT_DIR\_uv\bin;$env:PATH"
+    - tools\packman\packman pull --platform windows-x86_64 deps\cuda-toolkit-deps.packman.xml --verbose --include-tag "cuda-12"
+    - tools\packman\packman install -l _build\host-deps\winsdk winsdk 10.17763
+    - tools\packman\packman install -l _build\host-deps\msvc msvc 2019-16.11.24
   script:
-    - ./tools/ci/building/build-windows-x86_64/build.bat
+    - |
+      $env:PATH = "$env:CI_PROJECT_DIR\_uv;$env:PATH"
+      uv run build_lib.py --msvc_path=_build\host-deps\msvc\VC\Tools\MSVC\14.29.30133 --sdk_path=_build\host-deps\winsdk --cuda_path=_build\target-deps\cuda
 
 mac-x86_64 build:
   stage: build
@@ -129,8 +134,12 @@ mac-x86_64 build:
     - .save_warp_bin_artifact
     - .runner-build-macos-universal
     - .macos_warp_tags
+  before_script:
+    - df -h
+    - curl -LsSf https://astral.sh/uv/install.sh | env UV_UNMANAGED_INSTALL="$CI_PROJECT_DIR/_uv" sh
+    - export PATH="$CI_PROJECT_DIR/_uv/bin:$PATH"
   script:
-    - ./tools/ci/building/build-linux-x86_64/build.sh
+    - uv run build_lib.py
 
 linux-x86_64 cuda 13 build:
   stage: build
@@ -141,9 +150,12 @@ linux-x86_64 cuda 13 build:
   before_script:
     - echo -e "\\e[0Ksection_start:`date +%s`:install_dependencies[collapsed=true]\\r\\e[0KInstalling dependencies"
     - yum update -y && yum install curl wget -y
+    - wget -qO- https://astral.sh/uv/install.sh | sh
+    - export PATH="$HOME/.local/bin:$CUDA_BIN:$PATH"
+    - tools/packman/packman pull --platform linux-x86_64 deps/cuda-toolkit-deps.packman.xml --verbose --include-tag "cuda-13"
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
   script:
-    - ./tools/ci/building/build-linux-x86_64/build.sh --cuda 13 --no-docker # We are already using the builder image
+    - uv run build_lib.py --cuda_path=$CUDA
     - mkdir -p warp/bin/linux-x86_64
     - mv warp/bin/warp.so warp/bin/linux-x86_64
     - mv warp/bin/warp-clang.so warp/bin/linux-x86_64
@@ -182,7 +194,7 @@ osec:pulse-trufflehog:
 # This job tests code snippets in the documentation
 doctest:
   stage: quality
-  image: python:3.11-slim
+  image: ghcr.io/astral-sh/uv:bookworm
   needs: [linux-x86_64 build]
   extends:
     - .ipp_lnx_x86_64_gpu
@@ -193,11 +205,9 @@ doctest:
     # Move compiled binaries out of platform-specific directory
     - mv warp/bin/linux-x86_64/warp.so warp/bin/
     - mv warp/bin/linux-x86_64/warp-clang.so warp/bin/
-    - python -m pip install --upgrade pip
-    - python -m pip install -r docs/requirements.txt
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
   script:
-    - sphinx-build -b doctest docs docs/_build/doctest
+    - uv run --extra docs build_docs.py --doctest-only
 
 # The only purpose of this job is to make sure documentation can be built on Windows.
 # The output does not get published anywhere, but the website can be viewed in the
@@ -214,15 +224,12 @@ windows-x86_64 docs:
     - !reference [.snippets, define-powershell-GetTime]
     - Write-Output "$([char]27)[0Ksection_start:$(GetTime):install_dependencies[collapsed=true]$([char]13)$([char]27)[0KInstalling dependencies"
     - powershell -command "Get-Volume | Format-Table -AutoSize"
-    - $python_name = "3.12.6+nv1-windows-x86_64"
-    - tools/packman/packman.cmd install -l _build/target-deps/python python $python_name
-    - '& $env:CI_PROJECT_DIR\_build\target-deps\python\python.exe -m venv _venv'
-    - .\_venv\Scripts\Activate.ps1
-    - python -m pip install --upgrade pip
-    - python -m pip install -r docs/requirements.txt
+    - powershell -ExecutionPolicy ByPass -c {$env:UV_UNMANAGED_INSTALL = "$env:CI_PROJECT_DIR\_uv";irm https://astral.sh/uv/install.ps1 | iex}
     - Write-Output "$([char]27)[0Ksection_end:$(GetTime):install_dependencies$([char]13)$([char]27)[0K"
   script:
-    - python build_docs.py --quick
+    - |
+      $env:PATH = "$env:CI_PROJECT_DIR\_uv;$env:PATH"
+      uv run --extra docs build_docs.py --quick
     - mv docs/_build/html/ ./public/
   after_script:
     - echo "View the website at https://$CI_PROJECT_ROOT_NAMESPACE.$CI_PAGES_DOMAIN/-/$CI_PROJECT_NAME/-/jobs/$CI_JOB_ID/artifacts/public/index.html"
@@ -241,6 +248,11 @@ check un-namespaced symbols linux-x86_64:
 
       for lib in $LIBRARIES_TO_CHECK; do
         echo "--> Checking $lib"
+        if [ ! -f "$lib" ]; then
+          echo "ERROR: $lib not found"
+          found_symbols="true"
+          continue
+        fi
         output=$(readelf -Ws "$lib" | awk '$7 ~ /^[0-9]+$/ && $8 !~ /^_?wp_/ {print $8}' | grep -Ev '^(_Z|__|\.)' || true)
         
         if [ -n "$output" ]; then
@@ -347,10 +359,9 @@ linux-aarch64 test:
   before_script:
     - echo -e "\\e[0Ksection_start:`date +%s`:install_dependencies[collapsed=true]\\r\\e[0KInstalling dependencies"
     - !reference [.snippets, install-python+warp-aarch64]
-    - python -m pip install -U "coverage[toml]"
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
   script:
-    - python -m warp.tests --junit-report-xml rspec.xml --coverage --coverage-xml coverage.xml -s autodetect --failfast
+    - uv run --extra dev -m warp.tests --junit-report-xml rspec.xml --coverage --coverage-xml coverage.xml -s autodetect --failfast
 
 linux-aarch64 test jetson:
   needs: [linux-aarch64 build]
@@ -363,7 +374,7 @@ linux-aarch64 test jetson:
     - !reference [.snippets, install-python+warp-aarch64]
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
   script:
-    - python -m warp.tests --junit-report-xml rspec.xml -s autodetect --failfast
+    - uv run --extra dev -m warp.tests --junit-report-xml rspec.xml -s autodetect --failfast
   tags:
     - gpu/orin
 
@@ -376,19 +387,17 @@ linux-x86_64 test:
   before_script:
     - echo -e "\\e[0Ksection_start:`date +%s`:install_dependencies[collapsed=true]\\r\\e[0KInstalling dependencies"
     - df -h
-    - apt-get update && apt-get install curl git --no-install-recommends -y
+    - apt-get update && apt-get install curl git ca-certificates --no-install-recommends -y
     # Move compiled binaries out of platform-specific directory
     - mv warp/bin/linux-x86_64/warp.so warp/bin/
     - mv warp/bin/linux-x86_64/warp-clang.so warp/bin/
-    - tools/packman/packman install -l _build/target-deps/python python ${DEFAULT_PYTHON}-linux-x86_64
-    - export PATH="$CUDA_BIN:$PATH"
-    - $PYTHON -m venv _venv
-    - source _venv/bin/activate
-    - python -m pip install --upgrade pip
-    - python -m pip install --upgrade usd-core coverage[toml] blosc Pillow
-    - python -m pip install --upgrade torch --extra-index-url https://download.pytorch.org/whl/cu121
-    - python -m pip install -U "jax[cuda12]"
-    - python -m pip install -e .
+    - curl -LsSf https://astral.sh/uv/install.sh | sh
+    - export PATH="$HOME/.local/bin:$PATH"
+    - uv venv
+    - source .venv/bin/activate
+    - uv sync --extra dev --extra torch-cu12
+    - uv pip install -U "jax[cuda12]"
+    - uv pip install -e .
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
     # HACK: disable P2P tests due to misbehaving agents
     - export WARP_DISABLE_P2P_TESTS=1
@@ -396,9 +405,8 @@ linux-x86_64 test:
     - python -m warp.tests --junit-report-xml rspec.xml --coverage --coverage-xml coverage.xml -s autodetect --failfast
     # Upload report to Codecov
     - git config --global --add safe.directory $CI_PROJECT_DIR
-    - python -m pip install codecov-cli
-    - codecovcli --verbose upload-process --git-service github --disable-search -t $CODECOV_TOKEN -r NVIDIA/warp --plugin pycoverage -F unittests -f coverage.xml
-    - codecovcli --verbose upload-process --git-service github --disable-search -t $CODECOV_TOKEN -r NVIDIA/warp --report-type test_results -f rspec.xml
+    - uvx --from codecov-cli codecovcli --verbose upload-process --git-service github --disable-search -t $CODECOV_TOKEN -r NVIDIA/warp --plugin pycoverage -F unittests -f coverage.xml
+    - uvx --from codecov-cli codecovcli --verbose upload-process --git-service github --disable-search -t $CODECOV_TOKEN -r NVIDIA/warp --report-type test_results -f rspec.xml
 
 # A temporary job for testing on Blackwell until more runners are available
 linux-x86_64-blackwell test:
@@ -409,19 +417,18 @@ linux-x86_64-blackwell test:
   before_script:
     - echo -e "\\e[0Ksection_start:`date +%s`:install_dependencies[collapsed=true]\\r\\e[0KInstalling dependencies"
     - df -h
-    - apt-get update && apt-get install curl git --no-install-recommends -y
+    - apt-get update && apt-get install curl git ca-certificates --no-install-recommends -y
     # Move compiled binaries out of platform-specific directory
     - mv warp/bin/linux-x86_64/warp.so warp/bin/
     - mv warp/bin/linux-x86_64/warp-clang.so warp/bin/
-    - tools/packman/packman install -l _build/target-deps/python python ${DEFAULT_PYTHON}-linux-x86_64
-    - export PATH="$CUDA_BIN:$PATH"
-    - $PYTHON -m venv _venv
-    - source _venv/bin/activate
-    - python -m pip install --upgrade pip
-    - python -m pip install --upgrade usd-core coverage[toml] blosc Pillow
-    - python -m pip install -U --pre torch --index-url https://download.pytorch.org/whl/nightly/cu128
-    - python -m pip install -U --pre jax jaxlib "jax-cuda12-plugin[with_cuda]" jax-cuda12-pjrt -f https://storage.googleapis.com/jax-releases/jax_nightly_releases.html
-    - python -m pip install -e .
+    - curl -LsSf https://astral.sh/uv/install.sh | sh
+    - export PATH="$HOME/.local/bin:$PATH"
+    - uv venv
+    - source .venv/bin/activate
+    - uv sync --extra dev
+    - uv pip install -U --pre torch --index-url https://download.pytorch.org/whl/nightly/cu130
+    - uv pip install -U "jax[cuda13]"
+    - uv pip install -e .
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
   script:
     - python -m warp.tests --junit-report-xml rspec.xml --coverage --coverage-xml coverage.xml -s autodetect --failfast
@@ -441,16 +448,15 @@ mac-x86_64 test:
   before_script:
     - echo -e "\\e[0Ksection_start:`date +%s`:install_dependencies[collapsed=true]\\r\\e[0KInstalling dependencies"
     - !reference [.snippets, install-python+warp-macos]
-    - python -m pip install --upgrade usd-core coverage[toml] Pillow
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
   script:
-    - python -m warp.tests --maxjobs 4 --junit-report-xml rspec.xml --coverage --coverage-xml coverage.xml -s autodetect --failfast
+    - uv run --extra dev -m warp.tests --maxjobs 4 --junit-report-xml rspec.xml --coverage --coverage-xml coverage.xml -s autodetect --failfast
 
 # Note that for throughput reasons this runs on a single-GPU runner
 windows-x86_64 test:
   stage: test
   needs: [windows-x86_64 build]
-  timeout: 30m
+  timeout: 60m
   extends:
     - .runner-test-windows-x86_64-gpu
     - .test_common_with_coverage
@@ -458,22 +464,17 @@ windows-x86_64 test:
     - !reference [.snippets, define-powershell-GetTime]
     - Write-Output "$([char]27)[0Ksection_start:$(GetTime):install_dependencies[collapsed=true]$([char]13)$([char]27)[0KInstalling dependencies"
     - powershell -command "Get-Volume | Format-Table -AutoSize"
-    - $python_name = $DEFAULT_PYTHON + "-windows-x86_64"
-    - tools/packman/packman.cmd install -l _build/target-deps/python python $python_name
-    - '& $env:CI_PROJECT_DIR\_build\target-deps\python\python.exe -m venv _venv'
-    - .\_venv\Scripts\Activate.ps1
-    - python -m pip install --upgrade pip
-    - python -m pip install --upgrade usd-core==25.5.1 coverage[toml] numpy blosc Pillow
-    - python -m pip install --upgrade torch --extra-index-url https://download.pytorch.org/whl/cu121
-    - python -m pip install -e .
+    - powershell -ExecutionPolicy ByPass -c {$env:UV_UNMANAGED_INSTALL = "$env:CI_PROJECT_DIR\_uv";irm https://astral.sh/uv/install.ps1 | iex}
     - Write-Output "$([char]27)[0Ksection_end:$(GetTime):install_dependencies$([char]13)$([char]27)[0K"
   script:
-    - python -m warp.tests --junit-report-xml rspec.xml --coverage --coverage-xml coverage.xml -s autodetect --failfast
-    # Upload report to Codecov
-    - git config --global --add safe.directory $env:CI_PROJECT_DIR
-    - python -m pip install codecov-cli
-    - codecovcli --verbose upload-process --git-service github --disable-search -t $CODECOV_TOKEN -r NVIDIA/warp --plugin pycoverage -F unittests -f coverage.xml
-    - codecovcli --verbose upload-process --git-service github --disable-search -t $CODECOV_TOKEN -r NVIDIA/warp --report-type test_results -f rspec.xml
+    # Locking usd-core to 25.5.1 to work around a frequent loading crash
+    - |
+      $env:PATH = "$env:CI_PROJECT_DIR\_uv;$env:PATH"
+      uv run --extra dev --extra torch-cu12 --with usd-core==25.5.1 -m warp.tests --junit-report-xml rspec.xml --coverage --coverage-xml coverage.xml -s autodetect --failfast
+      # Upload report to Codecov
+      git config --global --add safe.directory $env:CI_PROJECT_DIR
+      & "$env:CI_PROJECT_DIR\_uv\uvx.exe" --from codecov-cli codecovcli --verbose upload-process --git-service github --disable-search -t $CODECOV_TOKEN -r NVIDIA/warp --plugin pycoverage -F unittests -f coverage.xml
+      & "$env:CI_PROJECT_DIR\_uv\uvx.exe" --from codecov-cli codecovcli --verbose upload-process --git-service github --disable-search -t $CODECOV_TOKEN -r NVIDIA/warp --report-type test_results -f rspec.xml
 
 # Optional multi-GPU Windows job (likely longer queue time)
 windows-x86_64 test mgpu:
@@ -481,7 +482,7 @@ windows-x86_64 test mgpu:
   needs: [windows-x86_64 build]
   extends:
     - .save_test_report_artifact
-  timeout: 30m
+  timeout: 60m
   rules:
     - if: $CI_PIPELINE_SOURCE == "schedule"
     - if: $CI_COMMIT_TAG
@@ -492,17 +493,13 @@ windows-x86_64 test mgpu:
     - !reference [.snippets, define-powershell-GetTime]
     - Write-Output "$([char]27)[0Ksection_start:$(GetTime):install_dependencies[collapsed=true]$([char]13)$([char]27)[0KInstalling dependencies"
     - powershell -command "Get-Volume | Format-Table -AutoSize"
-    - $python_name = $DEFAULT_PYTHON + "-windows-x86_64"
-    - tools/packman/packman.cmd install -l _build/target-deps/python python $python_name
-    - '& $env:CI_PROJECT_DIR\_build\target-deps\python\python.exe -m venv _venv'
-    - .\_venv\Scripts\Activate.ps1
-    - python -m pip install --upgrade pip
-    - python -m pip install --upgrade usd-core==25.5.1 numpy blosc Pillow
-    - python -m pip install --upgrade torch --extra-index-url https://download.pytorch.org/whl/cu121
-    - python -m pip install -e .
+    - powershell -ExecutionPolicy ByPass -c {$env:UV_UNMANAGED_INSTALL = "$env:CI_PROJECT_DIR\_uv";irm https://astral.sh/uv/install.ps1 | iex}
     - Write-Output "$([char]27)[0Ksection_end:$(GetTime):install_dependencies$([char]13)$([char]27)[0K"
   script:
-    - python -m warp.tests --junit-report-xml rspec.xml -s autodetect --failfast
+    # Locking usd-core to 25.5.1 to work around a frequent loading crash
+    - |
+      $env:PATH = "$env:CI_PROJECT_DIR\_uv;$env:PATH"
+      uv run --extra dev --extra torch-cu12 --with usd-core==25.5.1 -m warp.tests --junit-report-xml rspec.xml -s autodetect --failfast
   tags:
     - win-x86_64-gpu-2x-573.42
 
@@ -519,18 +516,15 @@ linux-x86_64 test warp-init:
   before_script:
     - echo -e "\\e[0Ksection_start:`date +%s`:install_dependencies[collapsed=true]\\r\\e[0KInstalling dependencies"
     - df -h
-    - apt-get update && apt-get install curl --no-install-recommends -y
+    - apt-get update && apt-get install curl ca-certificates --no-install-recommends -y
     # Move compiled binaries out of platform-specific directory
     - mv warp/bin/linux-x86_64/warp.so warp/bin/
     - mv warp/bin/linux-x86_64/warp-clang.so warp/bin/
-    - tools/packman/packman install -l _build/target-deps/python python ${DEFAULT_PYTHON}-linux-x86_64
-    - $PYTHON -m venv _venv
-    - source _venv/bin/activate
-    - python -m pip install --upgrade pip
-    - python -m pip install -e .
+    - curl -LsSf https://astral.sh/uv/install.sh | sh
+    - export PATH="$HOME/.local/bin:$PATH"
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
   script:
-    - python -m warp.tests --junit-report-xml rspec.xml -s autodetect --disable-process-pooling --disable-concurrent-futures --level test -p 'test_implicit_init.py'
+    - uv run --extra dev -m warp.tests --junit-report-xml rspec.xml -s autodetect --disable-process-pooling --disable-concurrent-futures --level test -p 'test_implicit_init.py'
 
 # Optional job to test MuJoCo Warp
 linux-x86_64 test mujoco warp:
@@ -589,20 +583,20 @@ linux-x86_64 python matrix test:
   parallel:
     matrix:
       - UV_PYTHON: "3.8"
+      - UV_PYTHON: "3.9"
       - UV_PYTHON: "3.13"
+      - UV_PYTHON: "3.14"
   before_script:
     - echo -e "\\e[0Ksection_start:`date +%s`:install_dependencies[collapsed=true]\\r\\e[0KInstalling dependencies"
     - df -h
+    # Python 3.14 requires a C compiler for some dependencies
+    - if [ "$UV_PYTHON" = "3.14" ]; then apt-get update && apt-get install build-essential --no-install-recommends -y; fi
     # Move compiled binaries out of platform-specific directory
     - mv warp/bin/linux-x86_64/warp.so warp/bin/
     - mv warp/bin/linux-x86_64/warp-clang.so warp/bin/
-    # Python environment
-    - uv venv
-    - uv pip install usd-core blosc Pillow
-    - uv pip install -e .
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
   script:
-    - uv run -m warp.tests --junit-report-xml rspec.xml -s autodetect --failfast
+    - uv run --extra dev -m warp.tests --junit-report-xml rspec.xml -s autodetect --failfast
 
 # Benchmark this commit with the current main branch using Airspeed Velocity
 # Only runs on merge requests
@@ -647,8 +641,8 @@ linux-x86_64 asv:
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
   script:
     - asv machine --yes
-    - asv continuous --interleave-rounds --append-samples --no-only-changed -f 1.10 --bench '^(?!api)' $COMPARE_REF $CI_COMMIT_SHA
-  allow_failure: True # Can make success required after we have tested this job more
+    - asv continuous -e --interleave-rounds --append-samples --no-only-changed -f 1.10 --bench '^(?!api)' $COMPARE_REF $CI_COMMIT_SHA 2>&1 || (asv compare --split $COMPARE_REF $CI_COMMIT_SHA 2>&1 && exit 2)
+  allow_failure: True
 
 # ==============================================================================
 # Child pipelines
@@ -658,39 +652,6 @@ linux-x86_64 asv:
 # jobs in this section.
 # ==============================================================================
 
-# Trigger additional (no code coverage) pipelines testing more Python versions
-# Workaround from https://gitlab.com/gitlab-org/gitlab/-/issues/284086
-trigger python 3.X test pipelines:
-  stage: test
-  image: busybox
-  needs:
-    - linux-aarch64 build
-    - linux-x86_64 build
-    - windows-x86_64 build
-    - mac-x86_64 build
-  extends:
-    - .ipp_lnx_x86_64_cpu_micro
-  rules:
-    - if: $CI_PIPELINE_SOURCE == "schedule"
-    - if: $CI_COMMIT_TAG
-    - if: $CI_COMMIT_BRANCH =~ /^release-.*/
-    - when: manual # Can be triggered in all other scenarios
-      allow_failure: true
-  variables:
-    GIT_STRATEGY: none
-  script:
-    - echo "Run this job to test additional Python versions."
-
-python 3.8 test:
-  stage: child pipelines
-  needs: [trigger python 3.X test pipelines]
-  trigger:
-    include: /.gitlab/ci/additional-tests.yml
-  extends:
-    - .trigger_common
-  variables:
-    DEFAULT_PYTHON: "3.8.18+nv1"
-
 # Trigger debug build and test (no code coverage) pipelines
 # Workaround from https://gitlab.com/gitlab-org/gitlab/-/issues/284086
 trigger debug build and test pipeline:
@@ -785,6 +746,7 @@ clang compilation:
     include: /.gitlab/ci/clang-build-and-test.yml
   needs: []
   extends:
+    - .basic_test_changes_rules
     - .trigger_common
 
 # ==============================================================================
@@ -1011,33 +973,33 @@ publish tag wheels to artifactory:
     - cd dist
     - >
       jf rt u --fail-no-op --url=$ARTIFACTORY_BASE_URL --access-token $ARTIFACTORY_SVC_ACCESS_TOKEN
-      --target-props 'component_name=warp-lang;release_approver=ershi;release_status=ready'
-      '*.whl' sw-warp-pypi-local/warp/$CI_COMMIT_REF_NAME/$VERSION/
+      --target-props 'component_name=warp-lang;release_approver=ershi'
+      '*.whl' sw-warp-pypi-local/warp/$CI_COMMIT_REF_NAME/
     # Set build-specific properties on individual artifacts
     - >
       jf rt sp --fail-no-op --url=$ARTIFACTORY_BASE_URL --access-token $ARTIFACTORY_SVC_ACCESS_TOKEN
-      sw-warp-pypi-local/warp/$CI_COMMIT_REF_NAME/$VERSION/*-win_amd64.whl
+      sw-warp-pypi-local/warp/$CI_COMMIT_REF_NAME/*-win_amd64.whl
       'arch=x86_64;os=windows'
     - >
       jf rt sp --fail-no-op --url=$ARTIFACTORY_BASE_URL --access-token $ARTIFACTORY_SVC_ACCESS_TOKEN
-      sw-warp-pypi-local/warp/$CI_COMMIT_REF_NAME/$VERSION/*-manylinux_2_34_aarch64.whl
+      sw-warp-pypi-local/warp/$CI_COMMIT_REF_NAME/*-manylinux_2_34_aarch64.whl
       'arch=aarch64;os=linux'
     - >
       jf rt sp --fail-no-op --url=$ARTIFACTORY_BASE_URL --access-token $ARTIFACTORY_SVC_ACCESS_TOKEN
-      sw-warp-pypi-local/warp/$CI_COMMIT_REF_NAME/$VERSION/*-manylinux_2_28_x86_64.whl
+      sw-warp-pypi-local/warp/$CI_COMMIT_REF_NAME/*-manylinux_2_28_x86_64.whl
       'arch=x86_64;os=linux'
     - >
       jf rt sp --fail-no-op --url=$ARTIFACTORY_BASE_URL --access-token $ARTIFACTORY_SVC_ACCESS_TOKEN
-      sw-warp-pypi-local/warp/$CI_COMMIT_REF_NAME/$VERSION/*-macosx_*_universal2.whl
+      sw-warp-pypi-local/warp/$CI_COMMIT_REF_NAME/*-macosx_*_universal2.whl
       'arch=any;os=macosx'
     # Set additional common properties on all artifacts
     - >
       jf rt sp --fail-no-op --url=$ARTIFACTORY_BASE_URL --access-token $ARTIFACTORY_SVC_ACCESS_TOKEN
-      sw-warp-pypi-local/warp/$CI_COMMIT_REF_NAME/$VERSION/*.whl
+      sw-warp-pypi-local/warp/$CI_COMMIT_REF_NAME/*.whl
       version=$VERSION
     - >
       jf rt sp --fail-no-op --url=$ARTIFACTORY_BASE_URL --access-token $ARTIFACTORY_SVC_ACCESS_TOKEN
-      sw-warp-pypi-local/warp/$CI_COMMIT_REF_NAME/$VERSION/*.whl
+      sw-warp-pypi-local/warp/$CI_COMMIT_REF_NAME/*.whl
       branch=$CI_COMMIT_REF_NAME
 
 publish wheels to github release:
@@ -1072,15 +1034,12 @@ publish wheels to github release:
   before_script:
     - echo -e "\\e[0Ksection_start:`date +%s`:install_dependencies[collapsed=true]\\r\\e[0KSet up docs environment"
     - df -h
-    - apt-get update && apt-get install make --no-install-recommends -y
     # Move compiled binaries out of platform-specific directory
     - mv warp/bin/linux-x86_64/warp.so warp/bin/
     - mv warp/bin/linux-x86_64/warp-clang.so warp/bin/
-    - uv venv
-    - uv pip install -r docs/requirements.txt
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
   script:
-    - uv run build_docs.py --quick
+    - uv run --extra docs build_docs.py --quick
     - mv docs/_build/html/ ./public/
 
 # Merge requests: Build documentation and save as an artifact
diff --git a/.gitlab/ci/additional-tests.yml b/.gitlab/ci/additional-tests.yml
deleted file mode 100644
index ea1763d8..00000000
--- a/.gitlab/ci/additional-tests.yml
+++ /dev/null
@@ -1,103 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2024 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-# ==============================================================================
-# Additional Tests Child Pipeline
-#
-# This child pipeline is used to test Warp on additional Python versions.
-# It uses the (release mode) binaries from the main pipeline.
-#
-# This pipeline can be triggered from the main GitLab pipeline under specific
-# circumstances. See the child pipelines defined in /.gitlab-ci.yml for the
-# trigger conditions. It is not automatically run in merge request pipelines.
-# ==============================================================================
-
-include: /.gitlab/ci/common.yml
-
-workflow:
-  rules:
-    - if: $CI_PIPELINE_SOURCE == "parent_pipeline"
-
-linux-x86_64 test:
-  stage: test
-  image: ubuntu:22.04
-  needs:
-    - pipeline: $PARENT_PIPELINE_ID
-      job: linux-x86_64 build
-  extends:
-    - .ipp_lnx_x86_64_gpu_2x
-    - .save_test_report_artifact
-  before_script:
-    - echo -e "\\e[0Ksection_start:`date +%s`:install_dependencies[collapsed=true]\\r\\e[0KInstalling dependencies"
-    - df -h
-    - apt-get update && apt-get install curl --no-install-recommends -y
-      # Move compiled binaries out of platform-specific directory
-    - mv warp/bin/linux-x86_64/warp.so warp/bin/
-    - mv warp/bin/linux-x86_64/warp-clang.so warp/bin/
-    - tools/packman/packman install -l _build/target-deps/python python ${DEFAULT_PYTHON}-linux-x86_64
-    - export PATH="$CUDA_BIN:$PATH"
-    - $PYTHON -m venv _venv
-    - source _venv/bin/activate
-    - python -m pip install --upgrade pip
-    - python -m pip install --upgrade usd-core blosc Pillow
-    - python -m pip install --upgrade torch --extra-index-url https://download.pytorch.org/whl/cu121
-    - python -m pip install -U "jax[cuda12]"
-    - python -m pip install -e .
-    - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
-    # HACK: disable P2P tests due to misbehaving agents
-    - export WARP_DISABLE_P2P_TESTS=1
-  script:
-    - python -m warp.tests --junit-report-xml rspec.xml -s autodetect --failfast
-
-windows-x86_64 test:
-  stage: test
-  needs:
-    - pipeline: $PARENT_PIPELINE_ID
-      job: windows-x86_64 build
-  timeout: 30m
-  extends:
-    - .runner-test-windows-x86_64-gpu
-    - .save_test_report_artifact
-  before_script:
-    - !reference [.snippets, define-powershell-GetTime]
-    - Write-Output "$([char]27)[0Ksection_start:$(GetTime):install_dependencies[collapsed=true]$([char]13)$([char]27)[0KInstalling dependencies"
-    - powershell -command "Get-Volume | Format-Table -AutoSize"
-    - $python_name = $DEFAULT_PYTHON + "-windows-x86_64"
-    - tools/packman/packman.cmd install -l _build/target-deps/python python $python_name
-    - '& $env:CI_PROJECT_DIR\_build\target-deps\python\python.exe -m venv _venv'
-    - .\_venv\Scripts\Activate.ps1
-    - python -m pip install --upgrade pip
-    - python -m pip install --upgrade usd-core==25.5.1 numpy blosc Pillow
-    - python -m pip install --upgrade torch --extra-index-url https://download.pytorch.org/whl/cu121
-    - python -m pip install -e .
-    - Write-Output "$([char]27)[0Ksection_end:$(GetTime):install_dependencies$([char]13)$([char]27)[0K"
-  script:
-    - python -m warp.tests --junit-report-xml rspec.xml -s autodetect --failfast
-
-linux-aarch64 test:
-  stage: test
-  image: ubuntu:22.04
-  needs: 
-    - pipeline: $PARENT_PIPELINE_ID
-      job: linux-aarch64 build
-  extends:
-    - .runner-test-linux-aarch64  # TODO: Change to .omni_devplat_arm_docker_gpu
-    - .save_test_report_artifact
-  before_script:
-    - echo -e "\\e[0Ksection_start:`date +%s`:install_dependencies[collapsed=true]\\r\\e[0KInstalling dependencies"
-    - !reference [.snippets, install-python+warp-aarch64]
-    - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
-  script:
-    - python -m warp.tests --junit-report-xml rspec.xml -s autodetect --failfast
diff --git a/.gitlab/ci/clang-build-and-test.yml b/.gitlab/ci/clang-build-and-test.yml
index c2ec2b7c..e04cf592 100644
--- a/.gitlab/ci/clang-build-and-test.yml
+++ b/.gitlab/ci/clang-build-and-test.yml
@@ -43,9 +43,6 @@ stages:
     - clang --version
     - curl -LsSf https://astral.sh/uv/install.sh | env UV_INSTALL_DIR=$CI_PROJECT_DIR/uv sh
     - source $CI_PROJECT_DIR/uv/env
-    - uv venv
-    - source .venv/bin/activate
-    - uv pip install numpy
     - unset CUDA_HOME
 
 linux-x86_64 build:
@@ -59,7 +56,7 @@ linux-x86_64 build:
       - warp/bin/**/*.so
     expire_in: 1 day  # Binary is quite large and we just need it for the test job
   script:
-    - python build_lib.py --clang_build_toolchain
+    - uv run build_lib.py --clang_build_toolchain
     - mkdir -p warp/bin/linux-x86_64
     - mv warp/bin/warp.so warp/bin/linux-x86_64
     - mv warp/bin/warp-clang.so warp/bin/linux-x86_64
@@ -88,14 +85,6 @@ linux-x86_64 test:
     # Install UV
     - curl -LsSf https://astral.sh/uv/install.sh | env UV_INSTALL_DIR=$CI_PROJECT_DIR/uv sh
     - source $CI_PROJECT_DIR/uv/env
-    - uv venv
-    - source .venv/bin/activate
-    - uv pip install numpy usd-core Pillow
-    - uv pip install --upgrade torch --extra-index-url https://download.pytorch.org/whl/cu121
-    - uv pip install -U "jax[cuda12]"
-    - uv pip install -e .
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
-    # HACK: disable P2P tests due to misbehaving agents
-    - export WARP_DISABLE_P2P_TESTS=1
   script:
-    - python -m warp.tests --junit-report-xml rspec.xml -s autodetect --failfast
+    - uv run --extra dev --extra torch-cu12 --with "jax[cuda12]" -m warp.tests --junit-report-xml rspec.xml -s autodetect --failfast
diff --git a/.gitlab/ci/common.yml b/.gitlab/ci/common.yml
index 452da25a..11b026b9 100644
--- a/.gitlab/ci/common.yml
+++ b/.gitlab/ci/common.yml
@@ -53,22 +53,13 @@ include:
     # Move compiled binaries out of platform-specific directory
     - mv warp/bin/linux-aarch64/warp.so warp/bin/
     - mv warp/bin/linux-aarch64/warp-clang.so warp/bin/
-    - apt-get update && apt-get install curl --no-install-recommends -y
-    - tools/packman/packman install -l _build/target-deps/python python ${DEFAULT_PYTHON}-linux-aarch64
-    - $PYTHON -m venv _venv
-    - source _venv/bin/activate
-    - python -m pip install --upgrade pip
-    - python -m pip install --upgrade blosc Pillow
-    - python -m pip install -e .
+    - apt-get update && apt-get install curl ca-certificates --no-install-recommends -y
+    - curl -LsSf https://astral.sh/uv/install.sh | sh
+    - export PATH="$HOME/.local/bin:$PATH"
   install-python+warp-macos:
     - df -h
-    - export PYTHON_NAME="${DEFAULT_PYTHON}-macos-universal";
-    - tools/packman/packman install -l _build/target-deps/python python ${PYTHON_NAME}
-    - $PYTHON -m venv _venv
-    - source _venv/bin/activate
-    - python -m pip install --upgrade pip
-    - python -m pip install --upgrade blosc Pillow
-    - python -m pip install -e .
+    - curl -LsSf https://astral.sh/uv/install.sh | env UV_UNMANAGED_INSTALL="$CI_PROJECT_DIR/_uv" sh
+    - export PATH="$CI_PROJECT_DIR/_uv/bin:$PATH"
   prepare-kit-artifacts:
     - python3 tools/ci/publishing/build_nodes_info.py
     - mv warp exts/omni.warp.core/
@@ -169,8 +160,6 @@ include:
     CUDA_BIN: "$PARENT_PROJECT_DIR/_build/target-deps/cuda/bin"
     CUDA: "$PARENT_PROJECT_DIR/_build/target-deps/cuda"
     CUDA_HOME: "$CI_PROJECT_DIR/_build/target-deps/cuda"
-    PYTHON: "$PARENT_PROJECT_DIR/_build/target-deps/python/python"
-    LINBUILD: "$PARENT_PROJECT_DIR/_build/host-deps/linbuild/linbuild.sh"
     WARP_CACHE_ROOT: "$PARENT_PROJECT_DIR/.cache/warp" # Used by the parallel test runner
   trigger:
     strategy: depend
diff --git a/.gitlab/ci/cuda-13-build.yml b/.gitlab/ci/cuda-13-build.yml
index c01418ff..d06ccd02 100644
--- a/.gitlab/ci/cuda-13-build.yml
+++ b/.gitlab/ci/cuda-13-build.yml
@@ -48,21 +48,16 @@ linux-aarch64 build:
   extends:
     - .omni_devplat_arm_compute
     - .save_warp_bin_artifact
-  variables:
-    PM_PYTHON_EXT: "python"
   before_script:
     - echo -e "\\e[0Ksection_start:`date +%s`:install_dependencies[collapsed=true]\\r\\e[0KInstalling dependencies"
     - yum update -y && yum install curl wget -y
-    - wget -O Miniforge3.sh "https://github.com/conda-forge/miniforge/releases/latest/download/Miniforge3-$(uname)-$(uname -m).sh"
-    - bash Miniforge3.sh -b -p "${CI_PROJECT_DIR}/conda"
-    - source "${CI_PROJECT_DIR}/conda/etc/profile.d/conda.sh"
-    - conda activate
-    - python -m pip install --upgrade pip
-    - python -m pip install --upgrade numpy
+    - gcc --version
+    - wget -qO- https://astral.sh/uv/install.sh | sh
+    - export PATH="$HOME/.local/bin:$CUDA_BIN:$PATH"
     - tools/packman/packman pull --platform linux-aarch64 --include-tag cuda-13 deps/cuda-toolkit-deps.packman.xml
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
   script:
-    - python build_lib.py --cuda_path $CUDA
+    - uv run build_lib.py --cuda_path $CUDA
     - mkdir -p warp/bin/linux-aarch64
     - mv warp/bin/warp.so warp/bin/linux-aarch64
     - mv warp/bin/warp-clang.so warp/bin/linux-aarch64
@@ -74,8 +69,15 @@ windows-x86_64 build:
     - .runner-build-windows-x86_64
   before_script:
     - powershell -command "Get-Volume | Format-Table -AutoSize"
+    - powershell -ExecutionPolicy ByPass -c {$env:UV_UNMANAGED_INSTALL = "$env:CI_PROJECT_DIR\_uv";irm https://astral.sh/uv/install.ps1 | iex}
+    - $env:PATH = "$env:CI_PROJECT_DIR\_uv\bin;$env:PATH"
+    - tools\packman\packman pull --platform windows-x86_64 deps\cuda-toolkit-deps.packman.xml --verbose --include-tag "cuda-13"
+    - tools\packman\packman install -l _build\host-deps\winsdk winsdk 10.17763
+    - tools\packman\packman install -l _build\host-deps\msvc msvc 2019-16.11.24
   script:
-    - ./tools/ci/building/build-windows-x86_64/build.bat --cuda 13
+    - |
+      $env:PATH = "$env:CI_PROJECT_DIR\_uv;$env:PATH"
+      uv run build_lib.py --msvc_path=_build\host-deps\msvc\VC\Tools\MSVC\14.29.30133 --sdk_path=_build\host-deps\winsdk --cuda_path=_build\target-deps\cuda
 
 # ==============================================================================
 # Linting and Code Quality Jobs
@@ -100,6 +102,11 @@ check un-namespaced symbols linux-x86_64:
 
       for lib in $LIBRARIES_TO_CHECK; do
         echo "--> Checking $lib"
+        if [ ! -f "$lib" ]; then
+          echo "ERROR: $lib not found"
+          found_symbols="true"
+          continue
+        fi
         output=$(readelf -Ws "$lib" | awk '$7 ~ /^[0-9]+$/ && $8 !~ /^_?wp_/ {print $8}' | grep -Ev '^(_Z|__|\.)' || true)
         
         if [ -n "$output" ]; then
@@ -141,8 +148,8 @@ create pypi wheels:
   script:
     - sed -i "s/^\(.*\)$/\1+cu13/" VERSION.md # Modify VERSION.md with +cu13
     - uv build --wheel -C--build-option=-Pwindows-x86_64
-    - uv build --wheel -C--build-option=-Plinux-x86_64 -C--build-option=-Mmanylinux_2_34
-    - uv build --wheel -C--build-option=-Plinux-aarch64 -C--build-option=-Mmanylinux_2_34
+    - uv build --wheel -C--build-option=-Plinux-x86_64 -C--build-option=-Mmanylinux2014
+    - uv build --wheel -C--build-option=-Plinux-aarch64 -C--build-option=-Mmanylinux2014
     - find . -type f -exec chmod 664 {} +
     - find . -type d -exec chmod 775 {} +
   artifacts:
@@ -224,32 +231,32 @@ publish tag wheels to artifactory:
     - if: $PARENT_COMMIT_TAG
   allow_failure: true
   before_script:
-    - export VERSION=$(head -n 1 dist/VERSION.md)
+    - export VERSION=$(head -n 1 VERSION.md)
   script:
     - cd dist
     - >
       jf rt u --fail-no-op --url=$ARTIFACTORY_BASE_URL --access-token $ARTIFACTORY_SVC_ACCESS_TOKEN
-      --target-props 'component_name=warp-lang;release_approver=ershi;release_status=ready'
-      '*.whl' sw-warp-pypi-local/warp/$PARENT_COMMIT_REF_NAME/$VERSION/
+      --target-props 'component_name=warp-lang;release_approver=ershi'
+      '*.whl' sw-warp-pypi-local/warp/$PARENT_COMMIT_REF_NAME/
     # Set build-specific properties on individual artifacts
     - >
       jf rt sp --fail-no-op --url=$ARTIFACTORY_BASE_URL --access-token $ARTIFACTORY_SVC_ACCESS_TOKEN
-      sw-warp-pypi-local/warp/$PARENT_COMMIT_REF_NAME/$VERSION/*-win_amd64.whl
+      sw-warp-pypi-local/warp/$PARENT_COMMIT_REF_NAME/*-win_amd64.whl
       'arch=x86_64;os=windows'
     - >
       jf rt sp --fail-no-op --url=$ARTIFACTORY_BASE_URL --access-token $ARTIFACTORY_SVC_ACCESS_TOKEN
-      sw-warp-pypi-local/warp/$PARENT_COMMIT_REF_NAME/$VERSION/*-manylinux_2_34_aarch64.whl
+      sw-warp-pypi-local/warp/$PARENT_COMMIT_REF_NAME/*-manylinux_2_34_aarch64.whl
       'arch=aarch64;os=linux'
     - >
       jf rt sp --fail-no-op --url=$ARTIFACTORY_BASE_URL --access-token $ARTIFACTORY_SVC_ACCESS_TOKEN
-      sw-warp-pypi-local/warp/$PARENT_COMMIT_REF_NAME/$VERSION/*-manylinux_2_34_x86_64.whl
+      sw-warp-pypi-local/warp/$PARENT_COMMIT_REF_NAME/*-manylinux_2_34_x86_64.whl
       'arch=x86_64;os=linux'
     # Set additional common properties on all artifacts
     - >
       jf rt sp --fail-no-op --url=$ARTIFACTORY_BASE_URL --access-token $ARTIFACTORY_SVC_ACCESS_TOKEN
-      sw-warp-pypi-local/warp/$PARENT_COMMIT_REF_NAME/$VERSION/*.whl
+      sw-warp-pypi-local/warp/$PARENT_COMMIT_REF_NAME/*.whl
       version=$VERSION
     - >
       jf rt sp --fail-no-op --url=$ARTIFACTORY_BASE_URL --access-token $ARTIFACTORY_SVC_ACCESS_TOKEN
-      sw-warp-pypi-local/warp/$PARENT_COMMIT_REF_NAME/$VERSION/*.whl
+      sw-warp-pypi-local/warp/$PARENT_COMMIT_REF_NAME/*.whl
       branch=$PARENT_COMMIT_REF_NAME
diff --git a/.gitlab/ci/debug-build-and-test.yml b/.gitlab/ci/debug-build-and-test.yml
index 2f1fad05..436b0147 100644
--- a/.gitlab/ci/debug-build-and-test.yml
+++ b/.gitlab/ci/debug-build-and-test.yml
@@ -51,9 +51,15 @@ stages:
     - echo -e "\\e[0Ksection_start:`date +%s`:install_dependencies[collapsed=true]\\r\\e[0KInstalling dependencies"
     - yum update -y && yum install curl wget -y
     - gcc --version
+    - wget -qO- https://astral.sh/uv/install.sh | sh
+    - export PATH="$HOME/.local/bin:$CUDA_BIN:$PATH"
+    - tools/packman/packman pull --platform linux-aarch64 deps/cuda-toolkit-deps.packman.xml --verbose --include-tag "cuda-12"
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
   script:
-    - ./tools/ci/building/build-linux-aarch64/build.sh --debug --no-docker
+    - uv run build_lib.py --cuda_path=$CUDA --mode=debug
+    - mkdir -p warp/bin/linux-aarch64
+    - mv warp/bin/warp.so warp/bin/linux-aarch64
+    - mv warp/bin/warp-clang.so warp/bin/linux-aarch64
 
 linux-x86_64 build:
   stage: build
@@ -65,9 +71,15 @@ linux-x86_64 build:
     - echo -e "\\e[0Ksection_start:`date +%s`:install_dependencies[collapsed=true]\\r\\e[0KInstalling dependencies"
     - yum update -y && yum install curl wget -y
     - gcc --version
+    - wget -qO- https://astral.sh/uv/install.sh | sh
+    - export PATH="$HOME/.local/bin:$CUDA_BIN:$PATH"
+    - tools/packman/packman pull --platform linux-x86_64 deps/cuda-toolkit-deps.packman.xml --verbose --include-tag "cuda-12"
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
   script:
-    - ./tools/ci/building/build-linux-x86_64/build.sh --debug --no-docker
+    - uv run build_lib.py --cuda_path=$CUDA --mode=debug
+    - mkdir -p warp/bin/linux-x86_64
+    - mv warp/bin/warp.so warp/bin/linux-x86_64
+    - mv warp/bin/warp-clang.so warp/bin/linux-x86_64
 
 windows-x86_64 build:
   stage: build
@@ -76,8 +88,15 @@ windows-x86_64 build:
     - .runner-build-windows-x86_64
   before_script:
     - powershell -command "Get-Volume | Format-Table -AutoSize"
+    - powershell -ExecutionPolicy ByPass -c {$env:UV_UNMANAGED_INSTALL = "$env:CI_PROJECT_DIR\_uv";irm https://astral.sh/uv/install.ps1 | iex}
+    - $env:PATH = "$env:CI_PROJECT_DIR\_uv\bin;$env:PATH"
+    - tools\packman\packman pull --platform windows-x86_64 deps\cuda-toolkit-deps.packman.xml --verbose --include-tag "cuda-12"
+    - tools\packman\packman install -l _build\host-deps\winsdk winsdk 10.17763
+    - tools\packman\packman install -l _build\host-deps\msvc msvc 2019-16.11.24
   script:
-    - ./tools/ci/building/build-windows-x86_64/build.bat --debug
+    - |
+      $env:PATH = "$env:CI_PROJECT_DIR\_uv;$env:PATH"
+      uv run build_lib.py --mode debug --jobs 2 --msvc_path=_build\host-deps\msvc\VC\Tools\MSVC\14.29.30133 --sdk_path=_build\host-deps\winsdk --cuda_path=_build\target-deps\cuda
 
 # ==============================================================================
 # Unit Testing Jobs (Debug)
@@ -97,41 +116,33 @@ windows-x86_64 build:
   before_script:
     - echo -e "\\e[0Ksection_start:`date +%s`:install_dependencies[collapsed=true]\\r\\e[0KInstalling dependencies"
     - !reference [.snippets, install-python+warp-aarch64]
-    - python -m pip install -U "jax[cuda12]"
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
   script:
-    - python -m warp.tests --maxjobs 4 --junit-report-xml rspec.xml -s autodetect --failfast
+    - uv run --extra dev -m warp.tests --maxjobs 4 --junit-report-xml rspec.xml -s autodetect --failfast
 
 linux-x86_64 test:
   stage: test
   image: ubuntu:22.04
   needs: [linux-x86_64 build]
   extends:
-    - .ipp_lnx_x86_64_gpu_2x
+    - .ipp_lnx_x86_64_gpu
     - .save_test_report_artifact
   before_script:
     - echo -e "\\e[0Ksection_start:`date +%s`:install_dependencies[collapsed=true]\\r\\e[0KInstalling dependencies"
     - df -h
-    - apt-get update && apt-get install curl --no-install-recommends -y
-    - tools/packman/packman install -l _build/target-deps/python python ${DEFAULT_PYTHON}-linux-x86_64
-    - export PATH="$CUDA_BIN:$PATH"
-    - $PYTHON -m venv _venv
-    - source _venv/bin/activate
-    - python -m pip install --upgrade pip
-    - python -m pip install --upgrade usd-core Pillow
-    - python -m pip install --upgrade torch --extra-index-url https://download.pytorch.org/whl/cu121
-    - python -m pip install -U "jax[cuda12]"
-    - python -m pip install -e .
+    # Move compiled binaries out of platform-specific directory
+    - mv warp/bin/linux-x86_64/warp.so warp/bin/
+    - mv warp/bin/linux-x86_64/warp-clang.so warp/bin/
+    - curl -LsSf https://astral.sh/uv/install.sh | sh
+    - export PATH="$HOME/.local/bin:$PATH"
     - echo -e "\\e[0Ksection_end:`date +%s`:install_dependencies\\r\\e[0K"
-    # HACK: disable P2P tests due to misbehaving agents
-    - export WARP_DISABLE_P2P_TESTS=1
   script:
-    - python -m warp.tests --maxjobs 4 --junit-report-xml rspec.xml -s autodetect --failfast
+    - uv run --extra dev -m warp.tests --junit-report-xml rspec.xml -s autodetect --failfast
 
 windows-x86_64 test:
   stage: test
   needs: [windows-x86_64 build]
-  timeout: 45m
+  timeout: 90m
   extends:
     - .runner-test-windows-x86_64-gpu
     - .save_test_report_artifact
@@ -139,17 +150,13 @@ windows-x86_64 test:
     - !reference [.snippets, define-powershell-GetTime]
     - Write-Output "$([char]27)[0Ksection_start:$(GetTime):install_dependencies[collapsed=true]$([char]13)$([char]27)[0KInstalling dependencies"
     - powershell -command "Get-Volume | Format-Table -AutoSize"
-    - $python_name = $DEFAULT_PYTHON + "-windows-x86_64"
-    - tools/packman/packman.cmd install -l _build/target-deps/python python $python_name
-    - '& $env:CI_PROJECT_DIR\_build\target-deps\python\python.exe -m venv _venv'
-    - .\_venv\Scripts\Activate.ps1
-    - python -m pip install --upgrade pip
-    - python -m pip install --upgrade usd-core==25.5.1 numpy Pillow
-    - python -m pip install --upgrade torch --extra-index-url https://download.pytorch.org/whl/cu121
-    - python -m pip install -e .
+    - powershell -ExecutionPolicy ByPass -c {$env:UV_UNMANAGED_INSTALL = "$env:CI_PROJECT_DIR\_uv";irm https://astral.sh/uv/install.ps1 | iex}
     - Write-Output "$([char]27)[0Ksection_end:$(GetTime):install_dependencies$([char]13)$([char]27)[0K"
   script:
-    - python -m warp.tests --maxjobs 4 --junit-report-xml rspec.xml -s autodetect --failfast
+    # Locking usd-core to 25.5.1 to work around a frequent loading crash
+    - |
+      $env:PATH = "$env:CI_PROJECT_DIR\_uv;$env:PATH"
+      uv run --extra dev --extra torch-cu12 --with usd-core==25.5.1 -m warp.tests --maxjobs 4 --junit-report-xml rspec.xml -s autodetect --failfast
 
 # ==============================================================================
 # Packaging Jobs
diff --git a/.gitlab/ci/kit-extensions.yml b/.gitlab/ci/kit-extensions.yml
index 16e876d2..a7e031f4 100644
--- a/.gitlab/ci/kit-extensions.yml
+++ b/.gitlab/ci/kit-extensions.yml
@@ -141,11 +141,12 @@ windows-x86_64 extension omni.warp test:
 # Creates an artifact suitable for publishing the Kit extensions
 create linux-aarch64 kit artifacts:
   stage: package
+  image: python:3.12-slim-bookworm
   needs:
     - pipeline: $PARENT_PIPELINE_ID
       job: linux-aarch64 build
   extends:
-    - .omni_nvks_micro_runner
+    - .ipp_lnx_x86_64_cpu_micro
   before_script:
     - apt-get update && apt-get install zip --no-install-recommends -y
     # Move compiled binaries out of platform-specific directory
@@ -162,11 +163,12 @@ create linux-aarch64 kit artifacts:
 
 create linux-x86_64 kit artifacts:
   stage: package
+  image: python:3.12-slim-bookworm
   needs:
     - pipeline: $PARENT_PIPELINE_ID
       job: linux-x86_64 build
   extends:
-    - .omni_nvks_micro_runner
+    - .ipp_lnx_x86_64_cpu_micro
   before_script:
     - apt-get update && apt-get install zip --no-install-recommends -y
     # Move compiled binaries out of platform-specific directory
@@ -183,11 +185,12 @@ create linux-x86_64 kit artifacts:
 
 create windows-x86_64 kit artifacts:
   stage: package
+  image: python:3.12-slim-bookworm
   needs:
     - pipeline: $PARENT_PIPELINE_ID
       job: windows-x86_64 build
   extends:
-    - .omni_nvks_micro_runner
+    - .ipp_lnx_x86_64_cpu_micro
   before_script:
     - apt-get update && apt-get install zip --no-install-recommends -y
   script:
diff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml
index 980ea64a..a44c2eda 100644
--- a/.pre-commit-config.yaml
+++ b/.pre-commit-config.yaml
@@ -20,3 +20,13 @@ repos:
         args: [--fix] # Apply fixes to resolve lint violations.
       # Run the formatter.
       - id: ruff-format
+  - repo: https://github.com/astral-sh/uv-pre-commit
+    # uv version.
+    rev: 0.8.22
+    hooks:
+      # Update the uv lockfile
+      - id: uv-lock
+  - repo: https://github.com/crate-ci/typos
+    rev: v1.37.2
+    hooks:
+      - id: typos
diff --git a/CHANGELOG.md b/CHANGELOG.md
index f7a7c02d..c9ee7d18 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -1,5 +1,48 @@
 # Changelog
 
+## [Unreleased] - 2025-??
+
+### Added
+
+- Add an in-place `wp.Bvh.rebuild()` method that rebuilds the hierarchy without allocating new memory and can be
+  captured in CUDA graphs ([GH-826](https://github.com/NVIDIA/warp/issues/826)).
+- Add atomic bitwise operations `wp.atomic_and()` (`&=`), `wp.atomic_or()` (`|=`), and `wp.atomic_xor()` (`^=`) for
+  scalar types, along with bitwise operations for vector, matrix, and tile types
+  ([GH-886](https://github.com/NVIDIA/warp/issues/886)).
+- Add support for negative indexing and improve slicing for the `wp.array()` type
+  ([GH-504](https://github.com/NVIDIA/warp/issues/504)).
+- Add support for recording and waiting for external events in CUDA graphs
+  ([GH-983](https://github.com/NVIDIA/warp/issues/983)).
+- Add kernel-level functions `bsr_row_index()` and `bsr_block_index()` to `warp.sparse`
+  ([GH-895](https://github.com/NVIDIA/warp/issues/895)).
+- Add support for querying CPU memory information (requires `psutil` package)
+  ([GH-985](https://github.com/NVIDIA/warp/issues/985)).
+- Add support for limiting the graph cache size of JAX callables ([GH-989](https://github.com/NVIDIA/warp/issues/989)).
+- Add support for JAX pmap ([GH-976](https://github.com/NVIDIA/warp/pull/976)).
+
+### Removed
+
+- Remove `warp.sim` module and related examples. This module has been superseded by the Newton library, a separate
+  package with a new API. For migration guidance, see the
+  [Newton migration guide](https://newton-physics.github.io/newton/migration.html) and the original GitHub announcement
+  ([GH-735](https://github.com/NVIDIA/warp/discussions/735)).
+
+### Deprecated
+
+### Changed
+
+- Improve efficiency for `wp.bvh_query_aabb()`, `wp.mesh_query_aabb()` and `wp.bvh_query_ray()`.
+  This fixes a performance regression introduced in Warp 1.6.0 ([GH-758](https://github.com/NVIDIA/warp/issues/758)).
+- Improve efficiency of struct instance creation and attribute access ([GH-968](https://github.com/NVIDIA/warp/issues/968)).
+- Make `warp.sparse` operations with `masked=True` consistent with `bsr_mm()` by preserving result matrix topology,
+  enabling CUDA subgraph capture for `bsr_axpy()`, `bsr_assign()` and `bsr_set_transpose()`
+  ([GH-987](https://github.com/NVIDIA/warp/issues/987)).
+
+### Fixed
+
+- Fix copying and filling arrays with large strides ([GH-929](https://github.com/NVIDIA/warp/issues/929)).
+- Fix graph deletion during capture ([GH-992](https://github.com/NVIDIA/warp/issues/992)).
+
 ## [1.9.1] - 2025-10-01
 
 ### Added
@@ -29,6 +72,8 @@
 - Fix handling of generic kernels with `wp.jax_experimental.ffi.jax_kernel()`.
 - Update built-in documentation to accurately reflect their differentiability status
   ([GH-970](https://github.com/NVIDIA/warp/issues/970)).
+- Fix handling of multi-line lambda expressions and lambda expressions involving parentheses in `wp.map()` ([GH-984](https://github.com/NVIDIA/warp/issues/984)).
+- Fix `wp.atomic_add()` for int64 type ([GH-977](https://github.com/NVIDIA/warp/issues/977))
 
 ## [1.9.0] - 2025-09-04
 
@@ -121,6 +166,8 @@
 - Fix adding superfluous inactive nodes to tetrahedron polynomial function spaces in `warp.fem`.
 - Fix `#line` directives for PythonCUDA source correlation not being emitted by default when a module is compiled in
   debug mode ([GH-901](https://github.com/NVIDIA/warp/issues/901)).
+- Fix 2D shared tile allocation/de-allocation bug inside Warp functions ([GH-877](https://github.com/NVIDIA/warp/issues/877)).
+- Fix loading "unique" modules using `wp.load_module()`.
 
 ## [1.8.1] - 2025-08-01
 
@@ -1825,8 +1872,7 @@
 
 - Initial publish for alpha testing
 
-[Unreleased]: https://github.com/NVIDIA/warp/compare/v1.9.1...HEAD
-[1.9.1]: https://github.com/NVIDIA/warp/releases/tag/v1.9.1
+[Unreleased]: https://github.com/NVIDIA/warp/compare/v1.9.0...HEAD
 [1.9.0]: https://github.com/NVIDIA/warp/releases/tag/v1.9.0
 [1.8.1]: https://github.com/NVIDIA/warp/releases/tag/v1.8.1
 [1.8.0]: https://github.com/NVIDIA/warp/releases/tag/v1.8.0
diff --git a/PUBLICATIONS.md b/PUBLICATIONS.md
index 5af66cfa..42621ebf 100644
--- a/PUBLICATIONS.md
+++ b/PUBLICATIONS.md
@@ -7,6 +7,8 @@ pull request on GitHub or email a link to your arXiv preprint (preferred) or DOI
 
 ## 2025
 
+- **MPMAvatar: Learning 3D Gaussian Avatars with Accurate and Robust Physics-Based Dynamics**. *C. Lee, J. Lee, T. Kim*. October 2025. [arXiv:2510.01619](https://arxiv.org/abs/2510.01619)
+- **MechStyle: Augmenting Generative AI with Mechanical Simulation to Create Stylized and Structurally Viable 3D Models**. *F. Faruqi, A. Abdel-Rahman, L. Tejedor, M. Nisser, J. Li, V. Phadnis, V. Jampani, N. Gershenfeld, M. Hofmann, S. Mueller*. September 2025. [arXiv:2509.20571](https://arxiv.org/abs/2509.20571)
 - **AERO-MPPI: Anchor-Guided Ensemble Trajectory Optimization for Agile Mapless Drone Navigation**. *X. Chen, R. Huang, L. Tang, L. Zhao*. September 2025. [arXiv:2509.17340](https://arxiv.org/abs/2509.17340)
 - **Discovering neural elastoplasticity from kinematic observations**. *G. B. Gavris, W. Sun*. September 2025. [DOI:10.1073/pnas.2508732122](https://doi.org/10.1073/pnas.2508732122)
 - **Learning Simulatable Models of Cloth with Spatially-varying Constitutive Properties**. *G. Chen, S. Suri, Y. Wu, E. Voulga, D. I. W. Levin, D. K. Pai*. July 2025. [arXiv:2507.21288](https://arxiv.org/abs/2507.21288)
diff --git a/README.md b/README.md
index f89f04fb..0a8cf1a6 100644
--- a/README.md
+++ b/README.md
@@ -34,7 +34,7 @@ The easiest way to install Warp is from [PyPI](https://pypi.org/project/warp-lan
 pip install warp-lang
 ```
 
-You can also use `pip install warp-lang[extras]` to install additional dependencies for running examples and USD-related features.
+You can also use `pip install warp-lang[examples]` to install additional dependencies for running examples and USD-related features.
 
 The binaries hosted on PyPI are currently built with the CUDA 12 runtime.
 We also provide binaries built with the CUDA 13.0 runtime on the [GitHub Releases](https://github.com/NVIDIA/warp/releases) page.
@@ -249,95 +249,16 @@ python -m warp.tests
 <table>
     <tbody>
         <tr>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_bounce.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/optim_bounce.png"></a></td>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_cloth_throw.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/optim_cloth_throw.png"></a></td>
             <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_diffray.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/optim_diffray.png"></a></td>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_drone.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/optim_drone.png"></a></td>
-        </tr>
-        <tr>
-            <td align="center">bounce</td>
-            <td align="center">cloth throw</td>
-            <td align="center">diffray</td>
-            <td align="center">drone</td>
-        </tr>
-        <tr>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_inverse_kinematics.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/optim_inverse_kinematics.png"></a></td>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_spring_cage.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/optim_spring_cage.png"></a></td>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_trajectory.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/optim_trajectory.png"></a></td>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_softbody_properties.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/optim_softbody_properties.png"></a></td>
-        </tr>
-        <tr>
-            <td align="center">inverse kinematics</td>
-            <td align="center">spring cage</td>
-            <td align="center">trajectory</td>
-            <td align="center">soft body properties</td>
-        </tr>
-        <tr>
             <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_fluid_checkpoint.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/optim_fluid_checkpoint.png"></a></td>
             <td></td>
             <td></td>
-            <td></td>
         </tr>
         <tr>
+            <td align="center">diffray</td>
             <td align="center">fluid checkpoint</td>
             <td align="center"></td>
             <td align="center"></td>
-            <td align="center"></td>
-        </tr>
-    </tbody>
-</table>
-
-### warp/examples/sim
-
-<table>
-    <tbody>
-        <tr>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_cartpole.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/sim_cartpole.png"></a></td>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_cloth.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/sim_cloth.png"></a></td>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_granular.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/sim_granular.png"></a></td>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_granular_collision_sdf.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/sim_granular_collision_sdf.png"></a></td>
-        </tr>
-        <tr>
-            <td align="center">cartpole</td>
-            <td align="center">cloth</td>
-            <td align="center">granular</td>
-            <td align="center">granular collision sdf</td>
-        </tr>
-        <tr>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_jacobian_ik.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/sim_jacobian_ik.png"></a></td>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_quadruped.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/sim_quadruped.png"></a></td>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_rigid_chain.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/sim_rigid_chain.png"></a></td>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_rigid_contact.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/sim_rigid_contact.png"></a></td>
-        </tr>
-        <tr>
-            <td align="center">jacobian ik</td>
-            <td align="center">quadruped</td>
-            <td align="center">rigid chain</td>
-            <td align="center">rigid contact</td>
-        </tr>
-        <tr>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_rigid_force.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/sim_rigid_force.png"></a></td>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_rigid_gyroscopic.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/sim_rigid_gyroscopic.png"></a></td>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_rigid_soft_contact.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/sim_rigid_soft_contact.png"></a></td>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_soft_body.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/sim_soft_body.png"></a></td>
-        </tr>
-        <tr>
-            <td align="center">rigid force</td>
-            <td align="center">rigid gyroscopic</td>
-            <td align="center">rigid soft contact</td>
-            <td align="center">soft body</td>
-        </tr>
-        <tr>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_cloth_self_contact.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/sim_example_cloth_self_contact.png"></a></td>
-            <td></td>
-            <td></td>
-            <td></td>
-        </tr>
-        <tr>
-            <td align="center">cloth self contact</td>
-            <td align="center"></td>
-            <td align="center"></td>
-            <td align="center"></td>
         </tr>
     </tbody>
 </table>
@@ -349,12 +270,14 @@ python -m warp.tests
         <tr>
             <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/tile/example_tile_mlp.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/tile_mlp.png"></a></td>
             <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/tile/example_tile_nbody.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/tile_nbody.png"></a></td>
-            <td><a href="https://github.com/NVIDIA/warp/tree/main/warp/examples/tile/example_tile_walker.py"><img src="https://media.githubusercontent.com/media/NVIDIA/warp/refs/heads/main/docs/img/examples/tile_walker.png"></a></td>
+            <td></td>
+            <td></td>
         </tr>
         <tr>
             <td align="center">mlp</td>
             <td align="center">nbody</td>
-            <td align="center">walker</td>
+            <td align="center"></td>
+            <td align="center"></td>
         </tr>
     </tbody>
 </table>
@@ -431,6 +354,9 @@ Note that prior to 0.11.0, this schema was not strictly adhered to.
 Warp is provided under the Apache License, Version 2.0.
 Please see [LICENSE.md](https://github.com/NVIDIA/warp/blob/main/LICENSE.md) for full license text.
 
+This project will download and install additional third-party open source software projects.
+Review the license terms of these open source projects before use.
+
 ## Contributing
 
 Contributions and pull requests from the community are welcome.
diff --git a/VERSION.md b/VERSION.md
index 9ab8337f..a597619e 100644
--- a/VERSION.md
+++ b/VERSION.md
@@ -1 +1 @@
-1.9.1
+1.10.0.dev0
diff --git a/asv/benchmarks/api/struct.py b/asv/benchmarks/api/struct.py
new file mode 100644
index 00000000..19cbbabc
--- /dev/null
+++ b/asv/benchmarks/api/struct.py
@@ -0,0 +1,104 @@
+# SPDX-FileCopyrightText: Copyright (c) 2025 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
+# SPDX-License-Identifier: Apache-2.0
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+# http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+import warp as wp
+
+
+@wp.struct
+class A:
+    a: int
+    b: wp.vec3
+    c: wp.array(dtype=float)
+
+
+@wp.struct
+class B:
+    a: A
+    b: wp.mat33
+    c: wp.array2d(dtype=int)
+
+
+@wp.struct
+class C:
+    a: A
+    b: B
+
+
+@wp.struct
+class D:
+    c: C
+    b: B
+    a: A
+    e: wp.float64
+
+
+class StructSetup:
+    number = 1000  # Number of measurements to make between a single setup and teardown
+
+    def setup(self):
+        wp.init()
+        wp.build.clear_kernel_cache()
+
+        self._vec = wp.vec3(1, 2, 3)
+        self._mat = wp.mat33(1, 2, 3, 4, 5, 6, 7, 8, 9)
+        self._array = wp.zeros(10, dtype=float, device="cpu")
+        self._array2d = wp.zeros((10, 10), dtype=int, device="cpu")
+
+        self.a = A()
+        self.d = D()
+
+    def time_construct_simple(self):
+        """
+        Time constructing a simple struct.
+        """
+        A()
+
+    def time_fill_simple(self):
+        """
+        Time filling a simple struct.
+        """
+        self.fill_A(self.a)
+
+    def time_construct_complex(self):
+        """
+        Time constructing a complex struct.
+        """
+        D()
+
+    def time_fill_complex(self):
+        """
+        Time filling a complex struct.
+        """
+        self.fill_D(self.d)
+
+    def fill_A(self, a: A):
+        a.a = 1
+        a.b = self._vec
+        a.c = self._array
+
+    def fill_B(self, b: B):
+        self.fill_A(b.a)
+        b.b = self._mat
+        b.c = self._array2d
+
+    def fill_C(self, c: C):
+        self.fill_A(c.a)
+        self.fill_B(c.b)
+
+    def fill_D(self, d: D):
+        self.fill_C(d.c)
+        self.fill_B(d.b)
+        self.fill_A(d.a)
+        d.e = 1.0
diff --git a/asv/benchmarks/bvh_build.py b/asv/benchmarks/bvh_build.py
new file mode 100644
index 00000000..5b30b922
--- /dev/null
+++ b/asv/benchmarks/bvh_build.py
@@ -0,0 +1,83 @@
+# SPDX-FileCopyrightText: Copyright (c) 2025 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
+# SPDX-License-Identifier: Apache-2.0
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+# http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+import os
+
+import numpy as np
+
+import warp as wp
+
+
+@wp.kernel
+def compute_tri_aabbs(
+    pos: wp.array(dtype=wp.vec3),
+    tri_indices: wp.array(dtype=wp.int32, ndim=1),
+    lower_bounds: wp.array(dtype=wp.vec3),
+    upper_bounds: wp.array(dtype=wp.vec3),
+):
+    t_id = wp.tid()
+
+    v1 = pos[tri_indices[t_id * 3]]
+    v2 = pos[tri_indices[t_id * 3 + 1]]
+    v3 = pos[tri_indices[t_id * 3 + 2]]
+
+    lower_bounds[t_id] = wp.min(wp.min(v1, v2), v3)
+    upper_bounds[t_id] = wp.max(wp.max(v1, v2), v3)
+
+
+class BvhBuild:
+    params = (["sah", "median", "lbvh"], ["bunny", "bear", "rocks"])
+    param_names = ["method", "asset"]
+
+    repeat = 20
+    number = 31
+
+    def setup(self, method, asset):
+        from pxr import Usd, UsdGeom
+
+        if asset == "bear":
+            self.repeat = 40
+
+        wp.init()
+        wp.build.clear_kernel_cache()
+        self.device = wp.get_device("cuda:0")
+
+        asset_stage = Usd.Stage.Open(os.path.join(wp.examples.get_asset_directory(), f"{asset}.usd"))
+        mesh_geom = UsdGeom.Mesh(asset_stage.GetPrimAtPath(f"/root/{asset}"))
+
+        points_np = np.array(mesh_geom.GetPointsAttr().Get())
+        indices_np = np.array(mesh_geom.GetFaceVertexIndicesAttr().Get())
+
+        points = wp.array(points_np, dtype=wp.vec3, device=self.device)
+        indices = wp.array(indices_np, dtype=wp.int32, device=self.device)
+
+        num_faces = int(indices.shape[0] / 3)
+
+        self.lowers = wp.zeros(num_faces, dtype=wp.vec3, device=self.device)
+        self.uppers = wp.zeros(num_faces, dtype=wp.vec3, device=self.device)
+
+        wp.launch(
+            dim=num_faces,
+            kernel=compute_tri_aabbs,
+            inputs=[points, indices],
+            outputs=[self.lowers, self.uppers],
+            device=self.device,
+        )
+
+        wp.synchronize_device(self.device)
+
+    def time_build(self, method, asset):
+        _bvh = wp.Bvh(self.lowers, self.uppers, constructor=method)
+        wp.synchronize_device(self.device)
diff --git a/asv/benchmarks/fem/integrate.py b/asv/benchmarks/fem/integrate.py
index 4b44b412..14264d15 100644
--- a/asv/benchmarks/fem/integrate.py
+++ b/asv/benchmarks/fem/integrate.py
@@ -151,9 +151,8 @@ class FemCorotatedElasticity:
 class FemCorotatedElasticityQuadraticTetmesh(FemCorotatedElasticity):
     """Test corotated elasticity with quadratic tetrahedral elements."""
 
-    rounds = 1
-    repeat = 2
-    number = 5
+    repeat = 5
+    number = 15
 
     params = (["energy", "forces", "hessian"], ["dispatch"])
     param_names = ["fn", "assembly"]
@@ -177,9 +176,8 @@ class FemCorotatedElasticityQuadraticTetmesh(FemCorotatedElasticity):
 class FemCorotatedElasticityLinearGrid(FemCorotatedElasticity):
     """Test corotated elasticity with linear grid elements."""
 
-    rounds = 1
-    repeat = 2
-    number = 5
+    repeat = 5
+    number = 15
 
     params = (["energy", "forces", "hessian"], ["generic", "dispatch"])
     param_names = ["fn", "assembly"]
@@ -202,9 +200,8 @@ class FemCorotatedElasticityLinearGrid(FemCorotatedElasticity):
 class FemCorotatedElasticityVeryHighOrder(FemCorotatedElasticity):
     """Test corotated elasticity with high order elements."""
 
-    rounds = 1
-    repeat = 2
-    number = 5
+    repeat = 15
+    number = 50
 
     params = (["energy", "forces", "hessian"], ["dispatch"])
     param_names = ["fn", "assembly"]
diff --git a/asv/benchmarks/mesh_query.py b/asv/benchmarks/mesh_query.py
deleted file mode 100644
index e9465afb..00000000
--- a/asv/benchmarks/mesh_query.py
+++ /dev/null
@@ -1,107 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2024 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-import importlib.util
-import os
-
-import numpy as np
-from asv_runner.benchmarks.mark import skip_benchmark_if
-
-import warp as wp
-
-pxr = importlib.util.find_spec("pxr")
-USD_AVAILABLE = pxr is not None
-
-wp.set_module_options({"enable_backward": False})
-
-NUM_QUERY_POINTS = 1000000
-seed = 42
-
-
-def get_asset_directory():
-    return os.path.join(os.path.realpath(os.path.dirname(__file__)), "..", "..", "warp", "examples", "assets")
-
-
-@wp.kernel
-def sample_mesh_query_no_sign(
-    mesh: wp.uint64,
-    query_points: wp.array(dtype=wp.vec3),
-    query_d_max: float,
-    query_closest_points: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-    p = query_points[tid]
-    query = wp.mesh_query_point_no_sign(mesh, p, query_d_max)
-
-    if query.result:
-        face = query.face
-        cp = wp.vec3(float(face), query.u, query.v)
-        query_closest_points[tid] = cp
-
-
-class MeshQuery:
-    params = ["bunny", "bear", "rocks"]
-    param_names = ["asset"]
-    number = 20
-    timeout = 60
-
-    def setup(self, asset):
-        from pxr import Usd, UsdGeom
-
-        wp.init()
-        wp.build.clear_kernel_cache()
-        self.device = wp.get_device("cuda:0")
-        wp.load_module(device=self.device)
-
-        asset_stage = Usd.Stage.Open(os.path.join(get_asset_directory(), f"{asset}.usd"))
-        mesh_geom = UsdGeom.Mesh(asset_stage.GetPrimAtPath(f"/root/{asset}"))
-
-        points = np.array(mesh_geom.GetPointsAttr().Get())
-        indices = np.array(mesh_geom.GetFaceVertexIndicesAttr().Get())
-        bounding_box = np.array([points.min(axis=0), points.max(axis=0)])
-
-        global seed
-        rng = np.random.default_rng(seed)
-        seed = seed + 1
-
-        query_points_np = rng.uniform(bounding_box[0, :], bounding_box[1, :], size=(NUM_QUERY_POINTS, 3)).astype(
-            np.float32
-        )
-        self.query_points = wp.array(query_points_np, dtype=wp.vec3, device=self.device)
-
-        # create wp mesh
-        self.mesh = wp.Mesh(
-            points=wp.array(points, dtype=wp.vec3, device=self.device),
-            velocities=None,
-            indices=wp.array(indices, dtype=int, device=self.device),
-        )
-
-        self.query_closest_points = wp.empty_like(self.query_points, device=self.device)
-
-        self.cmd = wp.launch(
-            sample_mesh_query_no_sign,
-            dim=(NUM_QUERY_POINTS,),
-            inputs=[self.mesh.id, self.query_points, 1.0e7, self.query_closest_points],
-            device=self.device,
-            record_cmd=True,
-        )
-        # Warmup
-        self.cmd.launch()
-        wp.synchronize_device(self.device)
-
-    @skip_benchmark_if(USD_AVAILABLE is False)
-    def time_mesh_query(self, asset):
-        self.cmd.launch()
-        wp.synchronize_device(self.device)
diff --git a/asv/benchmarks/spatial_query.py b/asv/benchmarks/spatial_query.py
new file mode 100644
index 00000000..5bfb06e3
--- /dev/null
+++ b/asv/benchmarks/spatial_query.py
@@ -0,0 +1,681 @@
+# SPDX-FileCopyrightText: Copyright (c) 2024 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
+# SPDX-License-Identifier: Apache-2.0
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+# http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+import importlib.util
+import os
+
+import numpy as np
+from asv_runner.benchmarks.mark import skip_benchmark_if, skip_for_params
+from numpy.random import default_rng
+
+import warp as wp
+import warp.examples
+
+pxr = importlib.util.find_spec("pxr")
+USD_AVAILABLE = pxr is not None
+
+wp.set_module_options({"enable_backward": False})
+
+NUM_QUERY_POINTS = 1000000
+NUM_TRIES = 10
+NUM_MESHES = 10
+seed = 42
+
+
+@wp.kernel
+def sample_mesh_query_no_sign(
+    mesh: wp.uint64,
+    query_points: wp.array(dtype=wp.vec3),
+    query_d_max: float,
+    query_closest_points: wp.array(dtype=wp.vec3),
+):
+    tid = wp.tid()
+    p = query_points[tid]
+    query = wp.mesh_query_point_no_sign(mesh, p, query_d_max)
+
+    if query.result:
+        face = query.face
+        cp = wp.vec3(float(face), query.u, query.v)
+        query_closest_points[tid] = cp
+
+
+class MeshQuery:
+    params = ["bunny", "bear", "rocks"]
+    param_names = ["asset"]
+    number = 20
+    timeout = 60
+
+    def setup(self, asset):
+        from pxr import Usd, UsdGeom
+
+        wp.init()
+        wp.build.clear_kernel_cache()
+        self.device = wp.get_device("cuda:0")
+        wp.load_module(device=self.device)
+
+        asset_stage = Usd.Stage.Open(os.path.join(wp.examples.get_asset_directory(), f"{asset}.usd"))
+        mesh_geom = UsdGeom.Mesh(asset_stage.GetPrimAtPath(f"/root/{asset}"))
+
+        points = np.array(mesh_geom.GetPointsAttr().Get())
+        indices = np.array(mesh_geom.GetFaceVertexIndicesAttr().Get())
+        bounding_box = np.array([points.min(axis=0), points.max(axis=0)])
+
+        global seed
+        rng = np.random.default_rng(seed)
+        seed = seed + 1
+
+        query_points_np = rng.uniform(bounding_box[0, :], bounding_box[1, :], size=(NUM_QUERY_POINTS, 3)).astype(
+            np.float32
+        )
+        self.query_points = wp.array(query_points_np, dtype=wp.vec3, device=self.device)
+
+        # create wp mesh
+        self.mesh = wp.Mesh(
+            points=wp.array(points, dtype=wp.vec3, device=self.device),
+            velocities=None,
+            indices=wp.array(indices, dtype=int, device=self.device),
+        )
+
+        self.query_closest_points = wp.empty_like(self.query_points, device=self.device)
+
+        self.cmd = wp.launch(
+            sample_mesh_query_no_sign,
+            dim=(NUM_QUERY_POINTS,),
+            inputs=[self.mesh.id, self.query_points, 1.0e7, self.query_closest_points],
+            device=self.device,
+            record_cmd=True,
+        )
+        # Warmup
+        self.cmd.launch()
+        wp.synchronize_device(self.device)
+
+    @skip_benchmark_if(USD_AVAILABLE is False)
+    def time_mesh_query_closest_point(self, asset):
+        self.cmd.launch()
+        wp.synchronize_device(self.device)
+
+
+@wp.struct
+class Camera:
+    """Basic camera for ray casting"""
+
+    horizontal: float
+    vertical: float
+    aspect: float
+    e: float
+    tan: float
+    pos: wp.vec3
+    rot: wp.quat
+
+
+@wp.struct
+class DirectionalLights:
+    """Stores arrays of directional light directions and intensities."""
+
+    dirs: wp.array(dtype=wp.vec3)
+    intensities: wp.array(dtype=float)
+    num_lights: int
+
+
+def get_v_t_collision_kernel(is_wp_bvh):
+    @wp.kernel
+    def vertex_triangle_collision_detection_kernel_broad_only_base(
+        query_radius: float,
+        geom_id: wp.uint64,
+        pos: wp.array(dtype=wp.vec3),
+        vertex_colliding_triangles_offsets: wp.array(dtype=wp.int32),
+        # outputs
+        vertex_colliding_triangles: wp.array(dtype=wp.int32),
+        vertex_colliding_triangles_count: wp.array(dtype=wp.int32),
+    ):
+        v_index = wp.tid()
+        v = pos[v_index]
+        vertex_buffer_offset = vertex_colliding_triangles_offsets[v_index]
+        vertex_buffer_size = vertex_colliding_triangles_offsets[v_index + 1] - vertex_buffer_offset
+
+        lower = wp.vec3(v[0] - query_radius, v[1] - query_radius, v[2] - query_radius)
+        upper = wp.vec3(v[0] + query_radius, v[1] + query_radius, v[2] + query_radius)
+
+        tri_index = wp.int32(0)
+        vertex_num_collisions = wp.int32(0)
+
+        if wp.static(is_wp_bvh):
+            query = wp.bvh_query_aabb(geom_id, lower, upper)
+            while wp.bvh_query_next(query, tri_index):
+                if vertex_num_collisions < vertex_buffer_size:
+                    vertex_colliding_triangles[2 * (vertex_buffer_offset + vertex_num_collisions)] = v_index
+                    vertex_colliding_triangles[2 * (vertex_buffer_offset + vertex_num_collisions) + 1] = tri_index
+
+                vertex_num_collisions = vertex_num_collisions + 1
+        else:
+            query = wp.mesh_query_aabb(geom_id, lower, upper)
+            while wp.mesh_query_aabb_next(query, tri_index):
+                if vertex_num_collisions < vertex_buffer_size:
+                    vertex_colliding_triangles[2 * (vertex_buffer_offset + vertex_num_collisions)] = v_index
+                    vertex_colliding_triangles[2 * (vertex_buffer_offset + vertex_num_collisions) + 1] = tri_index
+
+                vertex_num_collisions = vertex_num_collisions + 1
+
+        vertex_colliding_triangles_count[v_index] = vertex_num_collisions
+
+    return vertex_triangle_collision_detection_kernel_broad_only_base
+
+
+def get_ray_query_kernel(is_wp_bvh):
+    @wp.kernel
+    def ray_vs_aabb_query_kernel_base(
+        geom_id: wp.uint64,
+        camera: Camera,
+        mesh_pos: wp.array(dtype=wp.vec3),
+        mesh_rot: wp.array(dtype=wp.quat),
+        rays_width: int,
+        rays_height: int,
+        rays: wp.array(dtype=wp.vec3),
+    ):
+        tid = wp.tid()
+
+        x = tid % rays_width
+        y = rays_height - 1 - tid // rays_width
+
+        sx = 2.0 * float(x) / float(rays_width) - 1.0
+        sy = 2.0 * float(y) / float(rays_height) - 1.0
+
+        # compute view ray in world space
+        ro_world = camera.pos
+        rd_world = wp.normalize(
+            wp.quat_rotate(camera.rot, wp.vec3(sx * camera.tan * camera.aspect, sy * camera.tan, -1.0))
+        )
+
+        # compute view ray in mesh space
+        inv = wp.transform_inverse(wp.transform(mesh_pos[0], mesh_rot[0]))
+        ro = wp.transform_point(inv, ro_world)
+        rd = wp.transform_vector(inv, rd_world)
+
+        color = wp.vec3(0.0, 0.0, 0.0)
+
+        index = wp.int(0)
+
+        if wp.static(is_wp_bvh):
+            query = wp.bvh_query_ray(
+                geom_id,
+                ro,
+                rd,
+            )
+            while wp.bvh_query_next(query, index):
+                color += wp.vec3(1.0, 1.0, 1.0)
+        else:
+            query = wp.mesh_query_ray(geom_id, ro, rd, 1.0e6)
+            if query.result:
+                color += wp.vec3(1.0, 1.0, 1.0)
+
+        rays[tid] = color
+
+    return ray_vs_aabb_query_kernel_base
+
+
+def _rand_rotation(rand_eng, rotation_sigma_rad: float) -> np.ndarray:
+    if rotation_sigma_rad <= 0.0:
+        return np.eye(3)
+    axis = rand_eng.normal(size=3)
+    angle = rand_eng.normal(loc=0.0, scale=rotation_sigma_rad)
+
+    rot_mat_wp = wp.quat_to_matrix(wp.quat_from_axis_angle(wp.vec3(axis), angle))
+
+    return np.array(rot_mat_wp).reshape(3, 3)
+
+
+@wp.kernel
+def compute_tri_aabbs(
+    pos: wp.array(dtype=wp.vec3),
+    tri_indices: wp.array(dtype=wp.int32, ndim=1),
+    lower_bounds: wp.array(dtype=wp.vec3),
+    upper_bounds: wp.array(dtype=wp.vec3),
+):
+    t_id = wp.tid()
+
+    v1 = pos[tri_indices[t_id * 3]]
+    v2 = pos[tri_indices[t_id * 3 + 1]]
+    v3 = pos[tri_indices[t_id * 3 + 2]]
+
+    lower_bounds[t_id] = wp.min(wp.min(v1, v2), v3)
+    upper_bounds[t_id] = wp.max(wp.max(v1, v2), v3)
+
+
+def replicate_mesh_with_random_perturbation(
+    points: np.ndarray,  # (N,3) float
+    faces: np.ndarray,  # (M,3) int
+    K: int,
+    rand_eng,
+    *,
+    translation_sigma: float = 0.9,  # stddev of xyz translation
+    rotation_sigma_rad: float = 0.25,  # stddev of rotation angle (radians)
+    scale_sigma: float = 0.05,  # stddev for uniform scale around 1.0
+    vertex_noise_sigma: float = 0.0,  # per-vertex jitter (pre-transform)
+    include_original: bool = False,  # also keep the unperturbed original
+) -> tuple[np.ndarray, np.ndarray]:
+    """
+    Make K randomized copies of a triangle mesh and merge into one mesh.
+    Each copy gets:
+      - optional per-vertex Gaussian jitter (vertex_noise_sigma)
+      - a random rigid transform (rotation + translation)
+      - a random uniform scale (1 + N(0, scale_sigma)), clipped to >0
+    Returns (merged_points, merged_faces).
+    """
+    points = np.asarray(points, dtype=float)
+    faces = np.asarray(faces, dtype=np.int64)
+    if points.ndim != 2 or points.shape[1] != 3:
+        raise ValueError("points must be (N,3).")
+    if faces.ndim != 2 or faces.shape[1] != 3:
+        raise ValueError("faces must be (M,3).")
+    N = points.shape[0]
+
+    copies = []
+    faces_all = []
+
+    offset = 0
+
+    if include_original:
+        copies.append(points.copy())
+        faces_all.append(faces.copy() + offset)
+        offset += N
+
+    for _ in range(K):
+        pts = points.copy()
+
+        # per-vertex jitter (optional)
+        if vertex_noise_sigma > 0.0:
+            pts += rand_eng.normal(scale=vertex_noise_sigma, size=pts.shape)
+
+        # random transform
+        R = _rand_rotation(rand_eng, rotation_sigma_rad)
+        s = 1.0 + rand_eng.normal(loc=0.0, scale=scale_sigma) if scale_sigma > 0 else 1.0
+        s = max(s, 1e-8)  # avoid nonpositive/zero scale
+        t = rand_eng.normal(loc=0.0, scale=translation_sigma, size=3)
+
+        # apply: row-vectors => pts @ R^T
+        pts = (pts @ R.T) * s + t
+
+        copies.append(pts)
+        faces_all.append(faces.copy() + offset)
+        offset += N
+
+    merged_points = np.vstack(copies) if copies else points.copy()
+    merged_faces = np.vstack(faces_all) if faces_all else faces.copy()
+
+    return merged_points, merged_faces
+
+
+class BvhAABBQuery:
+    params = [[0.002, 0.004, 0.008], ["cpu", "cuda"]]
+    param_names = ["query_radius", "device"]
+
+    number = 5
+    timeout = 120
+
+    def setup(self, query_radius, device):
+        with wp.ScopedDevice(device):
+            from pxr import Usd, UsdGeom
+
+            global seed
+
+            rand_eng = default_rng(seed)  # or default_rng() for non-deterministic
+            seed = seed + 1
+
+            wp.init()
+            wp.build.clear_kernel_cache()
+            self.device = wp.get_device(device)
+            wp.load_module(device=self.device)
+
+            asset_stage = Usd.Stage.Open(os.path.join(wp.examples.get_asset_directory(), "bunny.usd"))
+            mesh_geom = UsdGeom.Mesh(asset_stage.GetPrimAtPath("/root/bunny"))
+
+            points_base = np.array(mesh_geom.GetPointsAttr().Get())
+            indices_base = np.array(mesh_geom.GetFaceVertexIndicesAttr().Get())
+
+            if NUM_MESHES != 1:
+                points, indices = replicate_mesh_with_random_perturbation(
+                    points_base, indices_base.reshape((-1, 3)), NUM_MESHES, rand_eng
+                )
+                indices = indices.reshape(-1)
+            else:
+                points = points_base
+                indices = indices_base
+
+            bounding_box = np.array([points.min(axis=0), points.max(axis=0)])
+
+            self.points = wp.array(points, dtype=wp.vec3)
+            self.indices = wp.array(indices, dtype=int)
+
+            bb_min = bounding_box[0]
+            bb_max = bounding_box[1]
+
+            # Option A (no extra cast, if your NumPy supports dtype in Generator.random)
+            query_points_np = bb_min + (bb_max - bb_min) * rand_eng.random((NUM_QUERY_POINTS, 3), dtype=np.float32)
+
+            # Option B (always works; uses uniform + cast)
+
+            self.query_points = wp.array(query_points_np, dtype=wp.vec3)
+
+            num_faces = int(indices.shape[0] / 3)
+            # create wp Bvh
+            self.lowers = wp.zeros(num_faces, dtype=wp.vec3)
+            self.uppers = wp.zeros(num_faces, dtype=wp.vec3)
+
+            wp.launch(
+                dim=num_faces,
+                kernel=compute_tri_aabbs,
+                inputs=[self.points, self.indices],
+                outputs=[self.lowers, self.uppers],
+            )
+
+            self.bvh = wp.Bvh(self.lowers, self.uppers)
+
+            self.mesh = wp.Mesh(self.points, wp.array(indices, dtype=int))
+
+            buffer_size_per_vertex = 32
+            self.vertex_colliding_triangles_offsets = wp.array(
+                np.arange(0, buffer_size_per_vertex * (NUM_QUERY_POINTS + 1), buffer_size_per_vertex, dtype=int),
+                dtype=wp.int32,
+            )
+            self.vertex_colliding_triangles = wp.zeros(2 * buffer_size_per_vertex * NUM_QUERY_POINTS, dtype=wp.int32)
+            self.vertex_colliding_triangles_count = wp.zeros(NUM_QUERY_POINTS, dtype=wp.int32)
+
+            self.bvh_vertex_triangle_collision_detection_kernel = get_v_t_collision_kernel(True)
+            self.mesh_vertex_triangle_collision_detection_kernel = get_v_t_collision_kernel(False)
+
+            if self.bvh.device.is_cpu:
+                self.cmd_bvh = wp.launch(
+                    dim=NUM_QUERY_POINTS,
+                    kernel=self.bvh_vertex_triangle_collision_detection_kernel,
+                    inputs=[
+                        query_radius,
+                        self.bvh.id,
+                        self.query_points,
+                        self.vertex_colliding_triangles_offsets,
+                    ],
+                    outputs=[self.vertex_colliding_triangles, self.vertex_colliding_triangles_count],
+                    record_cmd=True,
+                )
+
+                self.cmd_mesh = wp.launch(
+                    dim=NUM_QUERY_POINTS,
+                    kernel=self.mesh_vertex_triangle_collision_detection_kernel,
+                    inputs=[
+                        query_radius,
+                        self.mesh.id,
+                        self.query_points,
+                        self.vertex_colliding_triangles_offsets,
+                    ],
+                    outputs=[self.vertex_colliding_triangles, self.vertex_colliding_triangles_count],
+                    record_cmd=True,
+                )
+            else:
+                wp.load_module(device=device)
+                with wp.ScopedCapture(force_module_load=False) as capture:
+                    for _ in range(NUM_TRIES):
+                        wp.launch(
+                            dim=NUM_QUERY_POINTS,
+                            kernel=self.bvh_vertex_triangle_collision_detection_kernel,
+                            inputs=[
+                                query_radius,
+                                self.bvh.id,
+                                self.query_points,
+                                self.vertex_colliding_triangles_offsets,
+                            ],
+                            outputs=[self.vertex_colliding_triangles, self.vertex_colliding_triangles_count],
+                        )
+
+                self.cuda_graph_bvh_aabb_vs_aabb = capture.graph
+
+                with wp.ScopedCapture(force_module_load=False) as capture:
+                    for _ in range(NUM_TRIES):
+                        wp.launch(
+                            dim=NUM_QUERY_POINTS,
+                            kernel=self.mesh_vertex_triangle_collision_detection_kernel,
+                            inputs=[
+                                query_radius,
+                                self.mesh.id,
+                                self.query_points,
+                                self.vertex_colliding_triangles_offsets,
+                            ],
+                            outputs=[self.vertex_colliding_triangles, self.vertex_colliding_triangles_count],
+                        )
+
+                self.cuda_graph_mesh_aabb_vs_aabb = capture.graph
+
+                # warm up run
+                wp.capture_launch(self.cuda_graph_bvh_aabb_vs_aabb)
+                wp.capture_launch(self.cuda_graph_mesh_aabb_vs_aabb)
+                wp.synchronize_device(self.device)
+
+    @skip_for_params([(0.004, "cpu"), (0.008, "cpu")])
+    @skip_benchmark_if(USD_AVAILABLE is False)
+    def time_bvh_aabb_vs_aabb_query(self, query_radius, device):
+        if self.bvh.device.is_cpu:
+            self.cmd_bvh.launch()
+        else:
+            wp.capture_launch(self.cuda_graph_bvh_aabb_vs_aabb)
+        wp.synchronize_device(self.device)
+
+    @skip_for_params([(0.004, "cpu"), (0.008, "cpu")])
+    @skip_benchmark_if(USD_AVAILABLE is False)
+    def time_mesh_aabb_vs_aabb_query(self, query_radius, device):
+        if self.bvh.device.is_cpu:
+            self.cmd_mesh.launch()
+        else:
+            wp.capture_launch(self.cuda_graph_mesh_aabb_vs_aabb)
+        wp.synchronize_device(self.device)
+
+
+class BvhRayQuery:
+    params = [[480, 1080, 1920], ["cpu", "cuda"]]
+    param_names = ["resolution"]
+
+    number = 5
+    timeout = 120
+
+    def setup(self, resolution, device):
+        cam_pos = wp.vec3(0.0, 0.75, 7.0)
+        cam_rot = wp.quat(0.0, 0.0, 0.0, 1.0)
+        horizontal_aperture = 36.0
+        vertical_aperture = 36.0
+        aspect = horizontal_aperture / vertical_aperture
+        focal_length = 50.0
+
+        from pxr import Usd, UsdGeom
+
+        global seed
+
+        self.device = wp.get_device(device)
+
+        with wp.ScopedDevice(self.device):
+            rand_eng = default_rng(seed)  # or default_rng() for non-deterministic
+            seed = seed + 1
+
+            wp.init()
+            wp.build.clear_kernel_cache()
+            wp.load_module(device=self.device)
+
+            asset_stage = Usd.Stage.Open(os.path.join(wp.examples.get_asset_directory(), "bunny.usd"))
+            mesh_geom = UsdGeom.Mesh(asset_stage.GetPrimAtPath("/root/bunny"))
+
+            points_base = np.array(mesh_geom.GetPointsAttr().Get())
+            indices_base = np.array(mesh_geom.GetFaceVertexIndicesAttr().Get())
+
+            if NUM_MESHES != 1:
+                points, indices = replicate_mesh_with_random_perturbation(
+                    points_base, indices_base.reshape((-1, 3)), NUM_MESHES, rand_eng
+                )
+                indices = indices.reshape(-1)
+            else:
+                points = points_base
+                indices = indices_base
+
+            self.points = wp.array(points, dtype=wp.vec3)
+            self.indices = wp.array(indices, dtype=int)
+
+            bounding_box = np.array([points.min(axis=0), points.max(axis=0)])
+
+            num_faces = int(indices.shape[0] / 3)
+            # create wp Bvh
+            self.lowers = wp.zeros(num_faces, dtype=wp.vec3)
+            self.uppers = wp.zeros(num_faces, dtype=wp.vec3)
+
+            wp.launch(
+                dim=num_faces,
+                kernel=compute_tri_aabbs,
+                inputs=[self.points, self.indices],
+                outputs=[self.lowers, self.uppers],
+            )
+
+            self.bvh = wp.Bvh(self.lowers, self.uppers)
+            self.mesh = wp.Mesh(self.points, wp.array(indices, dtype=int))
+
+            bb_min = bounding_box[0]
+            bb_max = bounding_box[1]
+
+            # Option A (no extra cast, if your NumPy supports dtype in Generator.random)
+            query_points_np = bb_min + (bb_max - bb_min) * rand_eng.random((NUM_QUERY_POINTS, 3), dtype=np.float32)
+
+            # Option B (always works; uses uniform + cast)
+
+            self.query_points = wp.array(query_points_np, dtype=wp.vec3)
+
+            self.mesh_pos = wp.zeros(1, dtype=wp.vec3, requires_grad=True)
+            self.mesh_rot = wp.array(np.array([0.0, 0.0, 0.0, 1.0]), dtype=wp.quat, requires_grad=True)
+            num_faces = int(indices.shape[0] / 3)
+
+            # construct camera
+            self.camera = Camera()
+            self.camera.horizontal = horizontal_aperture
+            self.camera.vertical = vertical_aperture
+            self.camera.aspect = aspect
+            self.camera.e = focal_length
+            self.camera.tan = vertical_aperture / (2.0 * focal_length)
+            self.camera.pos = cam_pos
+            self.camera.rot = cam_rot
+
+            # construct lights
+            self.lights = DirectionalLights()
+            self.lights.dirs = wp.array(np.array([[1.0, 0.0, 0.0], [0.0, 0.0, 1.0]]), dtype=wp.vec3, requires_grad=True)
+            self.lights.intensities = wp.array(np.array([2.0, 0.2]), dtype=float, requires_grad=True)
+            self.lights.num_lights = 2
+
+            # construct rays
+            self.rays_width = resolution
+            self.rays_height = resolution
+            self.num_rays = self.rays_width * self.rays_height
+            self.rays = wp.zeros(self.num_rays, dtype=wp.vec3, requires_grad=True)
+
+            self.bvh_ray_vs_aabb_query_kernel = get_ray_query_kernel(True)
+            self.mesh_ray_vs_aabb_query_kernel = get_ray_query_kernel(False)
+
+            if self.bvh.device.is_cpu:
+                self.cmd_bvh_query = wp.launch(
+                    dim=self.num_rays,
+                    kernel=self.bvh_ray_vs_aabb_query_kernel,
+                    inputs=[
+                        self.bvh.id,
+                        self.camera,
+                        self.mesh_pos,
+                        self.mesh_rot,
+                        self.rays_width,
+                        self.rays_height,
+                    ],
+                    outputs=[
+                        self.rays,
+                    ],
+                    record_cmd=True,
+                )
+                self.cmd_mesh_query = wp.launch(
+                    dim=self.num_rays,
+                    kernel=self.mesh_ray_vs_aabb_query_kernel,
+                    inputs=[
+                        self.mesh.id,
+                        self.camera,
+                        self.mesh_pos,
+                        self.mesh_rot,
+                        self.rays_width,
+                        self.rays_height,
+                    ],
+                    outputs=[
+                        self.rays,
+                    ],
+                    record_cmd=True,
+                )
+
+            else:
+                wp.load_module(device=device)
+                with wp.ScopedCapture(force_module_load=False) as capture:
+                    for _ in range(NUM_TRIES):
+                        wp.launch(
+                            dim=self.num_rays,
+                            kernel=self.bvh_ray_vs_aabb_query_kernel,
+                            inputs=[
+                                self.bvh.id,
+                                self.camera,
+                                self.mesh_pos,
+                                self.mesh_rot,
+                                self.rays_width,
+                                self.rays_height,
+                            ],
+                            outputs=[
+                                self.rays,
+                            ],
+                        )
+
+                self.cuda_graph_bvh_ray_vs_aabb = capture.graph
+
+                with wp.ScopedCapture(force_module_load=False) as capture:
+                    for _ in range(NUM_TRIES):
+                        wp.launch(
+                            dim=self.num_rays,
+                            kernel=self.mesh_ray_vs_aabb_query_kernel,
+                            inputs=[
+                                self.mesh.id,
+                                self.camera,
+                                self.mesh_pos,
+                                self.mesh_rot,
+                                self.rays_width,
+                                self.rays_height,
+                            ],
+                            outputs=[
+                                self.rays,
+                            ],
+                        )
+                self.cuda_graph_mesh_ray_vs_aabb = capture.graph
+
+                # warm up run
+                wp.capture_launch(self.cuda_graph_bvh_ray_vs_aabb)
+                wp.capture_launch(self.cuda_graph_mesh_ray_vs_aabb)
+                wp.synchronize_device()
+
+    @skip_for_params([(1080, "cpu"), (1920, "cpu")])
+    @skip_benchmark_if(USD_AVAILABLE is False)
+    def time_bvh_ray_vs_aabb_query(self, resolution, device):
+        if self.bvh.device.is_cpu:
+            self.cmd_bvh_query.launch()
+        else:
+            wp.capture_launch(self.cuda_graph_bvh_ray_vs_aabb)
+        wp.synchronize_device()
+
+    @skip_for_params([(1080, "cpu"), (1920, "cpu")])
+    @skip_benchmark_if(USD_AVAILABLE is False)
+    def time_mesh_ray_vs_aabb_query(self, resolution, device):
+        if self.bvh.device.is_cpu:
+            self.cmd_mesh_query.launch()
+        else:
+            wp.capture_launch(self.cuda_graph_mesh_ray_vs_aabb)
+        wp.synchronize_device()
diff --git a/build_docs.py b/build_docs.py
index 0b6ad342..98ad363f 100644
--- a/build_docs.py
+++ b/build_docs.py
@@ -14,51 +14,113 @@
 # limitations under the License.
 
 import argparse
+import logging
 import os
 import shutil
-import subprocess
 
 import warp  # ensure all API functions are loaded  # noqa: F401
 from warp.context import export_functions_rst, export_stubs
 
 parser = argparse.ArgumentParser(description="Warp Sphinx Documentation Builder")
 parser.add_argument("--quick", action="store_true", help="Only build docs, skipping doctest tests of code blocks.")
+parser.add_argument("--doctest-only", action="store_true", help="Only run doctest, skipping HTML build.")
+parser.add_argument("--verbose", "-v", action="store_true", help="Enable verbose logging")
 
 args = parser.parse_args()
 
+# Validate argument combinations
+if args.quick and args.doctest_only:
+    parser.error("--quick and --doctest-only are mutually exclusive")
+
+# Configure logging
+log_level = logging.DEBUG if args.verbose else logging.INFO
+logging.basicConfig(
+    level=log_level,
+    format="[%(asctime)s] %(levelname)s: %(message)s",
+    datefmt="%H:%M:%S",
+    handlers=[logging.StreamHandler()],
+)
+logger = logging.getLogger(__name__)
+
+
+def format_file_with_ruff(file_path):
+    """Format file with ruff using pre-commit for version consistency."""
+    logger.debug(f"Formatting {file_path} with ruff via pre-commit")
+    try:
+        import pre_commit.main
+
+        result = pre_commit.main.main(["run", "ruff-format", "--files", file_path])
+        if result == 0:
+            logger.info(f"Formatted {file_path} using pre-commit (no changes needed)")
+        elif result == 1:
+            # Exit code 1 typically means files were modified (which is what we want)
+            logger.info(f"Formatted {file_path} using pre-commit (files modified)")
+        else:
+            raise RuntimeError(f"Pre-commit formatting failed for {file_path} with exit code {result}")
+    except ImportError as err:
+        raise ImportError(
+            f"Could not format {file_path}: pre-commit not available. "
+            "Install with 'pip install warp-lang[dev]' or equivalent."
+        ) from err
+
+
+def build_sphinx_docs(source_dir, output_dir, builder="html"):
+    """Build Sphinx documentation programmatically."""
+    logger.info(f"Building {builder} documentation: {source_dir} -> {output_dir}")
+    try:
+        from sphinx.cmd.build import build_main
+
+        # Clean previous output
+        if os.path.exists(output_dir):
+            logger.debug(f"Cleaning previous output directory: {output_dir}")
+            shutil.rmtree(output_dir)
+
+        # sphinx-build -W -b html source_dir output_dir
+        logger.debug(f"Running sphinx-build -W -b {builder} {source_dir} {output_dir}")
+        result = build_main(["-W", "-b", builder, source_dir, output_dir])
+        if result != 0:
+            raise RuntimeError(f"Sphinx build failed with exit code {result}")
+
+        logger.info(f"Successfully built {builder} documentation")
+
+    except ImportError as err:
+        raise ImportError(
+            "Could not build docs: sphinx not available. Install with 'pip install warp-lang[docs]' or equivalent."
+        ) from err
+
+
 base_path = os.path.dirname(os.path.realpath(__file__))
 
+logger.info("Starting Warp documentation build")
+
 # generate stubs for autocomplete
+logger.info("Generating API stubs for autocomplete")
 with open(os.path.join(base_path, "warp", "__init__.pyi"), "w") as stub_file:
     export_stubs(stub_file)
 
 # code formatting of __init__.pyi
-subprocess.run(["ruff", "format", "--verbose", os.path.join(base_path, "warp", "__init__.pyi")], check=True)
+format_file_with_ruff(os.path.join(base_path, "warp", "__init__.pyi"))
 
+logger.info("Generating function reference documentation")
 with open(os.path.join(base_path, "docs", "modules", "functions.rst"), "w") as function_ref:
     export_functions_rst(function_ref)
 
 source_dir = os.path.join(base_path, "docs")
-output_dir = os.path.join(base_path, "docs", "_build", "html")
-
-# Clean previous HTML output
-if os.path.exists(output_dir):
-    shutil.rmtree(output_dir)
-
-command = ["sphinx-build", "-W", "-b", "html", source_dir, output_dir]
-
-subprocess.run(command, check=True)
-
-if not args.quick:
-    print("Running doctest... (skip with --no_doctest)")
-
-    output_dir = os.path.join(base_path, "docs", "_build", "doctest")
-
-    if os.path.exists(output_dir):
-        shutil.rmtree(output_dir)
-
-    command = ["sphinx-build", "-W", "-b", "doctest", source_dir, output_dir]
-
-    subprocess.run(command, check=True)
 
-print("Finished")
+if args.doctest_only:
+    # Only run doctest
+    logger.info("Running doctest only (skipping HTML build)")
+    doctest_output_dir = os.path.join(base_path, "docs", "_build", "doctest")
+    build_sphinx_docs(source_dir, doctest_output_dir, "doctest")
+else:
+    # Build HTML docs
+    html_output_dir = os.path.join(base_path, "docs", "_build", "html")
+    build_sphinx_docs(source_dir, html_output_dir, "html")
+
+    # Run doctest unless --quick is specified
+    if not args.quick:
+        logger.info("Running doctest... (skip with --quick)")
+        doctest_output_dir = os.path.join(base_path, "docs", "_build", "doctest")
+        build_sphinx_docs(source_dir, doctest_output_dir, "doctest")
+
+logger.info("Documentation build completed successfully")
diff --git a/build_lib.py b/build_lib.py
index 91a1c1d9..10b816da 100644
--- a/build_lib.py
+++ b/build_lib.py
@@ -1,3 +1,10 @@
+# /// script
+# requires-python = ">=3.8"
+# dependencies = [
+#     "numpy",
+# ]
+# ///
+
 # SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
 # SPDX-License-Identifier: Apache-2.0
 #
@@ -207,6 +214,8 @@ def main(argv: list[str] | None = None) -> int:
     parser.add_argument("--quick", action="store_true", help="Only generate PTX code")
     parser.set_defaults(quick=False)
 
+    parser.add_argument("-j", "--jobs", type=int, default=4, help="Number of concurrent build tasks.")
+
     group_clang_llvm = parser.add_argument_group("Clang/LLVM Options")
     group_clang_llvm.add_argument("--llvm_path", type=str, help="Path to an existing LLVM installation")
     group_clang_llvm.add_argument(
@@ -302,15 +311,28 @@ def main(argv: list[str] | None = None) -> int:
 
         if args.cuda_path is None:
             print("Warning: CUDA toolchain not found, building without CUDA support")
-            warp_cu_path = None
+            warp_cu_paths = None
         else:
-            warp_cu_path = os.path.join(build_path, "native/warp.cu")
+            cuda_sources = [
+                "native/bvh.cu",
+                "native/mesh.cu",
+                "native/sort.cu",
+                "native/hashgrid.cu",
+                "native/reduce.cu",
+                "native/runlength_encode.cu",
+                "native/scan.cu",
+                "native/sparse.cu",
+                "native/volume.cu",
+                "native/volume_builder.cu",
+                "native/warp.cu",
+            ]
+            warp_cu_paths = [os.path.join(build_path, cu) for cu in cuda_sources]
 
         if args.libmathdx and args.libmathdx_path is None:
             print("Warning: libmathdx not found, building without MathDx support")
 
         warp_dll_path = os.path.join(build_path, f"bin/{lib_name('warp')}")
-        build_dll.build_dll(args, dll_path=warp_dll_path, cpp_paths=warp_cpp_paths, cu_path=warp_cu_path)
+        build_dll.build_dll(args, dll_path=warp_dll_path, cpp_paths=warp_cpp_paths, cu_paths=warp_cu_paths)
 
         # build warp-clang.dll
         if args.standalone:
diff --git a/build_llvm.py b/build_llvm.py
index aee0a9f1..52edb16b 100644
--- a/build_llvm.py
+++ b/build_llvm.py
@@ -386,7 +386,7 @@ def build_warp_clang_for_arch(args, lib_name: str, arch: str) -> None:
             args,
             dll_path=clang_dll_path,
             cpp_paths=clang_cpp_paths,
-            cu_path=None,
+            cu_paths=None,
             arch=arch,
             libs=libs,
             mode=args.mode if args.build_llvm else "release",
diff --git a/docs/basics.rst b/docs/basics.rst
index e12ec951..b0060e1b 100644
--- a/docs/basics.rst
+++ b/docs/basics.rst
@@ -317,49 +317,33 @@ By default, status messages will be printed out after each module has been loade
 
 For debugging purposes, ``wp.config.verbose = True`` can be set to also get a printout when each module load begins.
 
-Here is an example illustrating the functionality of the kernel cache by running ``python3 -m warp.examples.sim.example_cartpole``
+Here is an example illustrating the functionality of the kernel cache by running ``python -m warp.examples.tile.example_tile_cholesky``
 twice. The first time, we see:
 
 .. code:: bat
 
-    Warp 1.2.0 initialized:
-        CUDA Toolkit 12.5, Driver 12.5
-        Devices:
-          "cpu"      : "x86_64"
-          "cuda:0"   : "NVIDIA GeForce RTX 3090" (24 GiB, sm_86, mempool enabled)
-          "cuda:1"   : "NVIDIA GeForce RTX 3090" (24 GiB, sm_86, mempool enabled)
-        CUDA peer access:
-          Supported fully (all-directional)
-        Kernel cache:
-          /home/nvidia/.cache/warp/1.2.0
-    Module warp.sim.collide 296dfb5 load on device 'cuda:0' took 17982.83 ms (compiled)
-    Module warp.sim.articulation b2cf0c2 load on device 'cuda:0' took 5686.67 ms (compiled)
-    Module warp.sim.integrator_euler b87aa18 load on device 'cuda:0' took 7753.78 ms (compiled)
-    Module warp.sim.integrator 036f39a load on device 'cuda:0' took 456.53 ms (compiled)
-    step took 0.06 ms
-    render took 4.63 ms
-
-The second time we run this example, we see that the module-loading messages now say ``(cached)`` and take much
-less time to load since code compilation is skipped:
+    Warp 1.10.0.dev0 initialized:
+    CUDA Toolkit 13.0, Driver 13.0
+    Devices:
+        "cpu"      : "x86_64"
+        "cuda:0"   : "NVIDIA RTX PRO 6000 Blackwell Max-Q Workstation Edition" (95 GiB, sm_120, mempool enabled)
+    Kernel cache:
+        /home/nvidia/.cache/warp/1.10.0.dev0
+    Module __main__ 0b0ecab load on device 'cuda:0' took 4136.19 ms  (compiled)
+
+The second time we run this example, we see that the module-loading message now says ``(cached)`` and that it takes
+much less time to load the module since code compilation is skipped:
 
 .. code:: bat
 
-    Warp 1.2.0 initialized:
-        CUDA Toolkit 12.5, Driver 12.5
-        Devices:
-          "cpu"      : "x86_64"
-          "cuda:0"   : "NVIDIA GeForce RTX 3090" (24 GiB, sm_86, mempool enabled)
-          "cuda:1"   : "NVIDIA GeForce RTX 3090" (24 GiB, sm_86, mempool enabled)
-        CUDA peer access:
-          Supported fully (all-directional)
-        Kernel cache:
-          /home/nvidia/.cache/warp/1.2.0
-    Module warp.sim.collide 296dfb5 load on device 'cuda:0' took 9.07 ms (cached)
-    Module warp.sim.articulation b2cf0c2 load on device 'cuda:0' took 4.96 ms (cached)
-    Module warp.sim.integrator_euler b87aa18 load on device 'cuda:0' took 3.69 ms (cached)
-    Module warp.sim.integrator 036f39a load on device 'cuda:0' took 0.39 ms (cached)
-    step took 0.04 ms
-    render took 5.05 ms
+    Warp 1.10.0.dev0 initialized:
+    CUDA Toolkit 13.0, Driver 13.0
+    Devices:
+        "cpu"      : "x86_64"
+        "cuda:0"   : "NVIDIA RTX PRO 6000 Blackwell Max-Q Workstation Edition" (95 GiB, sm_120, mempool enabled)
+    Kernel cache:
+        /home/nvidia/.cache/warp/1.10.0.dev0
+    Module __main__ 0b0ecab load on device 'cuda:0' took 30.98 ms  (cached)
 
 For more information, see the :doc:`codegen` section.
 
diff --git a/docs/img/examples/sim_cartpole.png b/docs/img/examples/sim_cartpole.png
deleted file mode 100644
index 2fba0466..00000000
--- a/docs/img/examples/sim_cartpole.png
+++ /dev/null
@@ -1,3 +0,0 @@
-version https://git-lfs.github.com/spec/v1
-oid sha256:90b0071fcc1c14595f6cb5621c8e20c9b0c920fb88c6e407e5f78c898fc76248
-size 4322
diff --git a/docs/img/examples/sim_cloth.png b/docs/img/examples/sim_cloth.png
deleted file mode 100644
index b5508beb..00000000
--- a/docs/img/examples/sim_cloth.png
+++ /dev/null
@@ -1,3 +0,0 @@
-version https://git-lfs.github.com/spec/v1
-oid sha256:92b0ed41bfaf5b5770cc24db92fbc817b0441480377112cac89405265996888d
-size 7838
diff --git a/docs/img/examples/sim_example_cloth_self_contact.png b/docs/img/examples/sim_example_cloth_self_contact.png
deleted file mode 100644
index 962cd104..00000000
--- a/docs/img/examples/sim_example_cloth_self_contact.png
+++ /dev/null
@@ -1,3 +0,0 @@
-version https://git-lfs.github.com/spec/v1
-oid sha256:80d9b2fd74d1268d186d3d07aa5d2ade81e7343a051458664c92b109fdca2f9e
-size 3465
diff --git a/docs/img/examples/sim_granular.png b/docs/img/examples/sim_granular.png
deleted file mode 100644
index de06c8de..00000000
--- a/docs/img/examples/sim_granular.png
+++ /dev/null
@@ -1,3 +0,0 @@
-version https://git-lfs.github.com/spec/v1
-oid sha256:d19fe1162b1e7a401ea7d323412ae56df3bda07d8593c46245695e46b7170d14
-size 18896
diff --git a/docs/img/examples/sim_granular_collision_sdf.png b/docs/img/examples/sim_granular_collision_sdf.png
deleted file mode 100644
index 232c0b89..00000000
--- a/docs/img/examples/sim_granular_collision_sdf.png
+++ /dev/null
@@ -1,3 +0,0 @@
-version https://git-lfs.github.com/spec/v1
-oid sha256:78906a7b7de48062b12986b242ef4224e2baf073a0eae45eebbe15950e002184
-size 20884
diff --git a/docs/img/examples/sim_jacobian_ik.png b/docs/img/examples/sim_jacobian_ik.png
deleted file mode 100644
index 42af5148..00000000
--- a/docs/img/examples/sim_jacobian_ik.png
+++ /dev/null
@@ -1,3 +0,0 @@
-version https://git-lfs.github.com/spec/v1
-oid sha256:9e106768111c9e1a344aa384d19f9bb3873d5cd51c2749776fa91ce2c92b715e
-size 4630
diff --git a/docs/img/examples/sim_quadruped.png b/docs/img/examples/sim_quadruped.png
deleted file mode 100644
index 14d5941e..00000000
--- a/docs/img/examples/sim_quadruped.png
+++ /dev/null
@@ -1,3 +0,0 @@
-version https://git-lfs.github.com/spec/v1
-oid sha256:c1a9209b64c7af9109191193d4762d762418a0218bcf432a9c51dad53716391f
-size 7849
diff --git a/docs/img/examples/sim_rigid_chain.png b/docs/img/examples/sim_rigid_chain.png
deleted file mode 100644
index 719b78df..00000000
--- a/docs/img/examples/sim_rigid_chain.png
+++ /dev/null
@@ -1,3 +0,0 @@
-version https://git-lfs.github.com/spec/v1
-oid sha256:36bb3f6231b30ceabe7412ddc8538664795b177cb511fdb50c76b9ca46895ae7
-size 856
diff --git a/docs/img/examples/sim_rigid_contact.png b/docs/img/examples/sim_rigid_contact.png
deleted file mode 100644
index 948c2f9a..00000000
--- a/docs/img/examples/sim_rigid_contact.png
+++ /dev/null
@@ -1,3 +0,0 @@
-version https://git-lfs.github.com/spec/v1
-oid sha256:7a88bfeaa9a859e8bda81f078e806440692d7a45f55a15103fecb98c0b910c09
-size 13720
diff --git a/docs/img/examples/sim_rigid_force.png b/docs/img/examples/sim_rigid_force.png
deleted file mode 100644
index 4bd27107..00000000
--- a/docs/img/examples/sim_rigid_force.png
+++ /dev/null
@@ -1,3 +0,0 @@
-version https://git-lfs.github.com/spec/v1
-oid sha256:bf7a3d375ac0dc6854f166059bf350d377ec07b37c07b3132e554e469a4b2783
-size 4876
diff --git a/docs/img/examples/sim_rigid_gyroscopic.png b/docs/img/examples/sim_rigid_gyroscopic.png
deleted file mode 100644
index c376fcd2..00000000
--- a/docs/img/examples/sim_rigid_gyroscopic.png
+++ /dev/null
@@ -1,3 +0,0 @@
-version https://git-lfs.github.com/spec/v1
-oid sha256:b7c43d31b6a8563f356cab06c52c9073460d4c3a738dbafb152b585e3baee472
-size 1717
diff --git a/docs/img/examples/sim_rigid_soft_contact.png b/docs/img/examples/sim_rigid_soft_contact.png
deleted file mode 100644
index b8668919..00000000
--- a/docs/img/examples/sim_rigid_soft_contact.png
+++ /dev/null
@@ -1,3 +0,0 @@
-version https://git-lfs.github.com/spec/v1
-oid sha256:b40ff37574e580065c94aebcde49c8105cd357c5d2242175cc03653d6b8aed01
-size 7063
diff --git a/docs/img/examples/sim_soft_body.png b/docs/img/examples/sim_soft_body.png
deleted file mode 100644
index 229f7c9a..00000000
--- a/docs/img/examples/sim_soft_body.png
+++ /dev/null
@@ -1,3 +0,0 @@
-version https://git-lfs.github.com/spec/v1
-oid sha256:3384abc4ea034657542c371f92de095201f264abe0dde4ecec263976e60d333a
-size 2721
diff --git a/docs/index.rst b/docs/index.rst
index 7234dba3..0c460c6b 100644
--- a/docs/index.rst
+++ b/docs/index.rst
@@ -22,7 +22,7 @@ The easiest way to install Warp is from `PyPI <https://pypi.org/project/warp-lan
 
     $ pip install warp-lang
 
-You can also use ``pip install warp-lang[extras]`` to install additional dependencies for running examples
+You can also use ``pip install warp-lang[examples]`` to install additional dependencies for running examples
 and USD-related features.
 
 The binaries hosted on PyPI are currently built with the CUDA 12 runtime and therefore
@@ -210,89 +210,14 @@ warp/examples/optim
 .. list-table::
     :class: gallery
 
-    * - .. image:: ./img/examples/optim_bounce.png
-           :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_bounce.py
-      - .. image:: ./img/examples/optim_cloth_throw.png
-           :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_cloth_throw.py
-      - .. image:: ./img/examples/optim_diffray.png
+    * - .. image:: ./img/examples/optim_diffray.png
            :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_diffray.py
-      - .. image:: ./img/examples/optim_drone.png
-           :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_drone.py
-    * - bounce
-      - cloth throw
-      - diffray
-      - drone
-    * - .. image:: ./img/examples/optim_inverse_kinematics.png
-           :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_inverse_kinematics.py
-      - .. image:: ./img/examples/optim_spring_cage.png
-           :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_spring_cage.py
-      - .. image:: ./img/examples/optim_trajectory.png
-           :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_trajectory.py
-      - .. image:: ./img/examples/optim_softbody_properties.png
-           :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_softbody_properties.py
-    * - inverse kinematics
-      - spring cage
-      - trajectory
-      - soft body properties
-    * - .. image:: ./img/examples/optim_fluid_checkpoint.png
+      - .. image:: ./img/examples/optim_fluid_checkpoint.png
            :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/optim/example_fluid_checkpoint.py
       -
       -
-      -
-    * - fluid checkpoint
-      -
-      -
-      -
-
-warp/examples/sim
-^^^^^^^^^^^^^^^^^
-
-.. list-table::
-    :class: gallery
-
-    * - .. image:: ./img/examples/sim_cartpole.png
-            :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_cartpole.py
-      - .. image:: ./img/examples/sim_cloth.png
-            :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_cloth.py
-      - .. image:: ./img/examples/sim_granular.png
-            :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_granular.py
-      - .. image:: ./img/examples/sim_granular_collision_sdf.png
-            :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_granular_collision_sdf.py
-    * - cartpole
-      - cloth
-      - granular
-      - granular collision sdf
-    * - .. image:: ./img/examples/sim_jacobian_ik.png
-            :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_jacobian_ik.py
-      - .. image:: ./img/examples/sim_quadruped.png
-            :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_quadruped.py
-      - .. image:: ./img/examples/sim_rigid_chain.png
-            :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_rigid_chain.py
-      - .. image:: ./img/examples/sim_rigid_contact.png
-            :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_rigid_contact.py
-    * - jacobian ik
-      - quadruped
-      - rigid chain
-      - rigid contact
-    * - .. image:: ./img/examples/sim_rigid_force.png
-            :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_rigid_force.py
-      - .. image:: ./img/examples/sim_rigid_gyroscopic.png
-            :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_rigid_gyroscopic.py
-      - .. image:: ./img/examples/sim_rigid_soft_contact.png
-            :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_rigid_soft_contact.py
-      - .. image:: ./img/examples/sim_soft_body.png
-            :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_soft_body.py
-    * - rigid force
-      - rigid gyroscopic
-      - rigid soft contact
-      - soft body
-    * - .. image:: ./img/examples/sim_example_cloth_self_contact.png
-           :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/sim/example_cloth_self_contact.py
-      -
-      -
-      -
-    * - cloth self contact
-      -
+    * - diffray
+      - fluid checkpoint
       -
       -
 
@@ -306,12 +231,11 @@ warp/examples/tile
             :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/tile/example_tile_mlp.py
       - .. image:: ./img/examples/tile_nbody.png
             :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/tile/example_tile_nbody.py
-      - .. image:: ./img/examples/tile_walker.png
-            :target: https://github.com/NVIDIA/warp/tree/main/warp/examples/tile/example_tile_walker.py
+      -
       -
     * - mlp
       - nbody
-      - walker
+      -
       -
 
 Omniverse
@@ -388,6 +312,9 @@ License
 Warp is provided under the Apache License, Version 2.0. Please see
 `LICENSE.md <https://github.com/NVIDIA/warp/blob/main/LICENSE.md>`__ for the full license text.
 
+This project will download and install additional third-party open source software projects.
+Review the license terms of these open source projects before use.
+
 Contributing
 ------------
 
@@ -460,7 +387,6 @@ Full Table of Contents
     :maxdepth: 2
     :caption: Simulation Reference
    
-    modules/sim
     modules/sparse
     modules/fem
     modules/render
diff --git a/docs/installation.rst b/docs/installation.rst
index f152c360..19a8e17d 100644
--- a/docs/installation.rst
+++ b/docs/installation.rst
@@ -60,9 +60,9 @@ the ``pip install`` command, e.g.
    * - Platform
      - Install Command
    * - Linux aarch64
-     - ``pip install https://github.com/NVIDIA/warp/releases/download/v1.9.1/warp_lang-1.9.1+cu13-py3-none-manylinux_2_34_aarch64.whl``
+     - ``pip install https://github.com/NVIDIA/warp/releases/download/v1.9.1/warp_lang-1.9.1+cu13-py3-none-manylinux2014_aarch64.whl``
    * - Linux x86-64
-     - ``pip install https://github.com/NVIDIA/warp/releases/download/v1.9.1/warp_lang-1.9.1+cu13-py3-none-manylinux_2_34_x86_64.whl``
+     - ``pip install https://github.com/NVIDIA/warp/releases/download/v1.9.1/warp_lang-1.9.1+cu13-py3-none-manylinux2014_x86_64.whl``
    * - Windows x86-64
      - ``pip install https://github.com/NVIDIA/warp/releases/download/v1.9.1/warp_lang-1.9.1+cu13-py3-none-win_amd64.whl``
 
@@ -121,11 +121,13 @@ Warp supports Python versions 3.8 onwards, with 3.9 or newer recommended for ful
 
 The following optional dependencies are required to support certain features:
 
-* `usd-core <https://pypi.org/project/usd-core>`_: Required for some Warp examples, ``warp.sim.parse_usd()``, and ``warp.render.UsdRenderer``.
+* `usd-core <https://pypi.org/project/usd-core>`_: Required for some Warp examples, tests, and the :class:`warp.render.UsdRenderer`.
+* `pyglet <https://pyglet.org/>`_: Required for some Warp examples and the :class:`warp.render.OpenGLRenderer`.
 * `JAX <https://jax.readthedocs.io/en/latest/installation.html>`_: Required for JAX interoperability (see :ref:`jax-interop`).
 * `PyTorch <https://pytorch.org/get-started/locally/>`_: Required for PyTorch interoperability (see :ref:`pytorch-interop`).
 * `Paddle <https://github.com/PaddlePaddle/Paddle>`_: Required for Paddle interoperability (see :ref:`paddle-interop`).
 * `NVTX for Python <https://github.com/NVIDIA/NVTX#python>`_: Required to use :class:`wp.ScopedTimer(use_nvtx=True) <warp.ScopedTimer>`.
+* `psutil <https://psutil.readthedocs.io/en/latest/>`_: Required to query CPU memory info (`get_device("cpu").total_memory`, `get_device("cpu").free_memory`).
 
 Building from Source
 --------------------
diff --git a/docs/modules/allocators.rst b/docs/modules/allocators.rst
index 79efa420..521dee23 100644
--- a/docs/modules/allocators.rst
+++ b/docs/modules/allocators.rst
@@ -120,7 +120,7 @@ Querying Memory Usage
 The amount of memory the application is currently using from a specific memory
 pool can be queried using :func:`wp.get_mempool_used_mem_current() <warp.get_mempool_used_mem_current>`.
 This can be different from the amount of memory reserved for the pool itself.
-Similarly, the high-water mark of used memory can be quered using
+Similarly, the high-water mark of used memory can be queried using
 :func:`wp.get_mempool_used_mem_high() <warp.get_mempool_used_mem_high>`.
 
 .. autofunction:: warp.get_mempool_used_mem_current
diff --git a/docs/modules/functions.rst b/docs/modules/functions.rst
index 492c0c80..c0c33813 100644
--- a/docs/modules/functions.rst
+++ b/docs/modules/functions.rst
@@ -4266,6 +4266,468 @@ Utility
     The operation is only atomic on a per-component basis for vectors and matrices.
 
 
+.. py:function:: atomic_and(arr: Array[Any], i: Int, value: Any) -> Any
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise AND between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i] &= value``.
+
+
+.. py:function:: atomic_and(arr: Array[Any], i: Int, j: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise AND between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j] &= value``.
+
+
+.. py:function:: atomic_and(arr: Array[Any], i: Int, j: Int, k: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise AND between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k] &= value``.
+
+
+.. py:function:: atomic_and(arr: Array[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise AND between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k,l] &= value``.
+
+
+.. py:function:: atomic_and(arr: FabricArray[Any], i: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise AND between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i] &= value``.
+
+
+.. py:function:: atomic_and(arr: FabricArray[Any], i: Int, j: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise AND between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j] &= value``.
+
+
+.. py:function:: atomic_and(arr: FabricArray[Any], i: Int, j: Int, k: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise AND between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k] &= value``.
+
+
+.. py:function:: atomic_and(arr: FabricArray[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise AND between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k,l] &= value``.
+
+
+.. py:function:: atomic_and(arr: IndexedFabricArray[Any], i: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise AND between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i] &= value``.
+
+
+.. py:function:: atomic_and(arr: IndexedFabricArray[Any], i: Int, j: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise AND between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j] &= value``.
+
+
+.. py:function:: atomic_and(arr: IndexedFabricArray[Any], i: Int, j: Int, k: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise AND between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k] &= value``.
+
+
+.. py:function:: atomic_and(arr: IndexedFabricArray[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise AND between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k,l] &= value``.
+
+
+.. py:function:: atomic_or(arr: Array[Any], i: Int, value: Any) -> Any
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise OR between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i] |= value``.
+
+
+.. py:function:: atomic_or(arr: Array[Any], i: Int, j: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise OR between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j] |= value``.
+
+
+.. py:function:: atomic_or(arr: Array[Any], i: Int, j: Int, k: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise OR between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k] |= value``.
+
+
+.. py:function:: atomic_or(arr: Array[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise OR between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k,l] |= value``.
+
+
+.. py:function:: atomic_or(arr: FabricArray[Any], i: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise OR between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i] |= value``.
+
+
+.. py:function:: atomic_or(arr: FabricArray[Any], i: Int, j: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise OR between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j] |= value``.
+
+
+.. py:function:: atomic_or(arr: FabricArray[Any], i: Int, j: Int, k: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise OR between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k] |= value``.
+
+
+.. py:function:: atomic_or(arr: FabricArray[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise OR between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k,l] |= value``.
+
+
+.. py:function:: atomic_or(arr: IndexedFabricArray[Any], i: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise OR between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i] |= value``.
+
+
+.. py:function:: atomic_or(arr: IndexedFabricArray[Any], i: Int, j: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise OR between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j] |= value``.
+
+
+.. py:function:: atomic_or(arr: IndexedFabricArray[Any], i: Int, j: Int, k: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise OR between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k] |= value``.
+
+
+.. py:function:: atomic_or(arr: IndexedFabricArray[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise OR between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k,l] |= value``.
+
+
+.. py:function:: atomic_xor(arr: Array[Any], i: Int, value: Any) -> Any
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise XOR between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i] ^= value``.
+
+
+.. py:function:: atomic_xor(arr: Array[Any], i: Int, j: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise XOR between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j] ^= value``.
+
+
+.. py:function:: atomic_xor(arr: Array[Any], i: Int, j: Int, k: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise XOR between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k] ^= value``.
+
+
+.. py:function:: atomic_xor(arr: Array[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise XOR between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k,l] ^= value``.
+
+
+.. py:function:: atomic_xor(arr: FabricArray[Any], i: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise XOR between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i] ^= value``.
+
+
+.. py:function:: atomic_xor(arr: FabricArray[Any], i: Int, j: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise XOR between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j] ^= value``.
+
+
+.. py:function:: atomic_xor(arr: FabricArray[Any], i: Int, j: Int, k: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise XOR between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k] ^= value``.
+
+
+.. py:function:: atomic_xor(arr: FabricArray[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise XOR between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k,l] ^= value``.
+
+
+.. py:function:: atomic_xor(arr: IndexedFabricArray[Any], i: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise XOR between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i] ^= value``.
+
+
+.. py:function:: atomic_xor(arr: IndexedFabricArray[Any], i: Int, j: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise XOR between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j] ^= value``.
+
+
+.. py:function:: atomic_xor(arr: IndexedFabricArray[Any], i: Int, j: Int, k: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise XOR between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k] ^= value``.
+
+
+.. py:function:: atomic_xor(arr: IndexedFabricArray[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+
+    Atomically performs a bitwise XOR between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k,l] ^= value``.
+
+
 .. py:function:: lerp(a: Float, b: Float, t: Float) -> Float
 
     .. hlist::
@@ -5654,6 +6116,41 @@ Operators
        * Python
 
 
+.. py:function:: bit_and(a: Vector[Any,Int], b: Vector[Any,Int]) -> Vector[Any,Int]
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+       * Python
+
+
+.. py:function:: bit_and(a: Matrix[Any,Any,Int], b: Matrix[Any,Any,Int]) -> Matrix[Any,Any,Int]
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+       * Python
+
+
+.. py:function:: bit_and(a: Tile[Any,Tuple[int, ...]], b: Tile[Any,Tuple[int, ...]]) -> Tile[Scalar,Tuple[int, ...]]
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+       * Python
+
+    Bitwise AND each element of two tiles together
+
+
 .. py:function:: bit_or(a: Int, b: Int) -> Int
 
     .. hlist::
@@ -5663,6 +6160,41 @@ Operators
        * Python
 
 
+.. py:function:: bit_or(a: Vector[Any,Int], b: Vector[Any,Int]) -> Vector[Any,Int]
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+       * Python
+
+
+.. py:function:: bit_or(a: Matrix[Any,Any,Int], b: Matrix[Any,Any,Int]) -> Matrix[Any,Any,Int]
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+       * Python
+
+
+.. py:function:: bit_or(a: Tile[Any,Tuple[int, ...]], b: Tile[Any,Tuple[int, ...]]) -> Tile[Scalar,Tuple[int, ...]]
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+       * Python
+
+    Bitwise OR each element of two tiles together
+
+
 .. py:function:: bit_xor(a: Int, b: Int) -> Int
 
     .. hlist::
@@ -5672,6 +6204,41 @@ Operators
        * Python
 
 
+.. py:function:: bit_xor(a: Vector[Any,Int], b: Vector[Any,Int]) -> Vector[Any,Int]
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+       * Python
+
+
+.. py:function:: bit_xor(a: Matrix[Any,Any,Int], b: Matrix[Any,Any,Int]) -> Matrix[Any,Any,Int]
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+       * Python
+
+
+.. py:function:: bit_xor(a: Tile[Any,Tuple[int, ...]], b: Tile[Any,Tuple[int, ...]]) -> Tile[Scalar,Tuple[int, ...]]
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+       * Python
+
+    Bitwise XOR each element of two tiles together
+
+
 .. py:function:: lshift(a: Int, b: Int) -> Int
 
     .. hlist::
@@ -5679,7 +6246,28 @@ Operators
 
        * Kernel
        * Python
-       * Differentiable
+
+
+.. py:function:: lshift(a: Vector[Any,Int], b: Vector[Any,Int]) -> Vector[Any,Int]
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+       * Python
+
+
+.. py:function:: lshift(a: Matrix[Any,Any,Int], b: Matrix[Any,Any,Int]) -> Matrix[Any,Any,Int]
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+       * Python
 
 
 .. py:function:: rshift(a: Int, b: Int) -> Int
@@ -5691,6 +6279,28 @@ Operators
        * Python
 
 
+.. py:function:: rshift(a: Vector[Any,Int], b: Vector[Any,Int]) -> Vector[Any,Int]
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+       * Python
+
+
+.. py:function:: rshift(a: Matrix[Any,Any,Int], b: Matrix[Any,Any,Int]) -> Matrix[Any,Any,Int]
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+       * Python
+
+
 .. py:function:: invert(a: Int) -> Int
 
     .. hlist::
@@ -5698,7 +6308,28 @@ Operators
 
        * Kernel
        * Python
-       * Differentiable
+
+
+.. py:function:: invert(a: Vector[Any,Int]) -> Vector[Any,Int]
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+       * Python
+
+
+.. py:function:: invert(a: Matrix[Any,Any,Int]) -> Matrix[Any,Any,Int]
+    :noindex:
+    :nocontentsentry:
+
+    .. hlist::
+       :columns: 8
+
+       * Kernel
+       * Python
 
 
 .. py:function:: mul(a: Scalar, b: Scalar) -> Scalar
diff --git a/docs/modules/render.rst b/docs/modules/render.rst
index 7160a6ac..2a90cbb5 100644
--- a/docs/modules/render.rst
+++ b/docs/modules/render.rst
@@ -5,9 +5,6 @@ warp.render
 
 The ``warp.render`` module provides a set of renderers that can be used for visualizing scenes involving shapes of various types.
 
-Built on top of these stand-alone renderers, the ``warp.sim.render`` module provides renderers that can be used to
-visualize scenes directly from ``warp.sim.ModelBuilder`` objects and update them from ``warp.sim.State`` objects.
-
 Standalone Renderers
 --------------------
 
@@ -21,21 +18,6 @@ a USD file that can then be rendered in an external 3D application or renderer o
 .. autoclass:: OpenGLRenderer
     :members:
 
-Simulation Renderers
---------------------
-
-Based on these renderers from ``warp.render``, the ``SimRendererUsd`` (which equals ``SimRenderer``) and
-``SimRendererOpenGL`` classes from ``warp.sim.render`` are derived to populate the renderers directly from
-``warp.sim.ModelBuilder`` scenes and update them from ``warp.sim.State`` objects.
-
-.. currentmodule:: warp.sim.render
-
-.. autoclass:: SimRendererUsd
-    :members:
-
-.. autoclass:: SimRendererOpenGL
-    :members:
-
 CUDA Graphics Interface
 -----------------------
 
diff --git a/docs/modules/sim.rst b/docs/modules/sim.rst
deleted file mode 100644
index 5d97c9a9..00000000
--- a/docs/modules/sim.rst
+++ /dev/null
@@ -1,356 +0,0 @@
-:tocdepth: 3
-
-warp.sim
-========
-
-.. currentmodule:: warp.sim
-
-.. deprecated:: v1.8
-
-   ``warp.sim`` will be replaced by the upcoming `Newton library <https://github.com/newton-physics/newton>`__,
-   which will be released as a separate package with a new API.
-   Please note that migrating will require code changes. A guide will be provided in the future.
-   For more details, see the `announcement on GitHub <https://github.com/NVIDIA/warp/discussions/735>`__.
-
-Warp includes a simulation module ``warp.sim`` that includes many common physical simulation models and integrators
-for explicit and implicit time-stepping.
-
-Model
------
-
-.. autoclass:: ModelBuilder
-    :members:
-
-.. autoclass:: Model
-    :members:
-
-.. autoclass:: ModelShapeMaterials
-    :members:
-
-.. autoclass:: ModelShapeGeometry
-    :members:
-
-.. autoclass:: JointAxis
-    :members:
-
-.. autoclass:: Mesh
-   :members:
-
-.. autoclass:: SDF
-   :members:
-
-.. _Joint types:
-
-Joint types
-^^^^^^^^^^^^^^
-
-.. data:: JOINT_PRISMATIC
-
-    Prismatic (slider) joint
-
-.. data:: JOINT_REVOLUTE
-
-    Revolute (hinge) joint
-
-.. data:: JOINT_BALL
-
-    Ball (spherical) joint with quaternion state representation
-
-.. data:: JOINT_FIXED
-
-    Fixed (static) joint
-
-.. data:: JOINT_FREE
-
-    Free (floating) joint
-
-.. data:: JOINT_COMPOUND
-
-    Compound joint with 3 rotational degrees of freedom
-
-.. data:: JOINT_UNIVERSAL
-
-    Universal joint with 2 rotational degrees of freedom
-
-.. data:: JOINT_DISTANCE
-
-    Distance joint that keeps two bodies at a distance within its joint limits (only supported in :class:`XPBDIntegrator` at the moment)
-
-.. data:: JOINT_D6
-
-    Generic D6 joint with up to 3 translational and 3 rotational degrees of freedom
-
-.. _Joint modes:
-
-Joint control modes
-^^^^^^^^^^^^^^^^^^^
-
-Joint modes control the behavior of how the joint control input :attr:`Control.joint_act` affects the torque applied at a given joint axis.
-By default, it behaves as a direct force application via :data:`JOINT_MODE_FORCE`. Other modes can be used to implement joint position or velocity drives:
-
-.. data:: JOINT_MODE_FORCE
-
-    This is the default control mode where the control input is the torque :math:`\tau` applied at the joint axis.
-
-.. data:: JOINT_MODE_TARGET_POSITION
-
-    The control input is the target position :math:`\mathbf{q}_{\text{target}}` which is achieved via PD control of torque :math:`\tau` where the proportional and derivative gains are set by :attr:`Model.joint_target_ke` and :attr:`Model.joint_target_kd`:
-
-    .. math::
-
-        \tau = k_e (\mathbf{q}_{\text{target}} - \mathbf{q}) - k_d \mathbf{\dot{q}}
-
-.. data:: JOINT_MODE_TARGET_VELOCITY
-   
-    The control input is the target velocity :math:`\mathbf{\dot{q}}_{\text{target}}` which is achieved via a controller of torque :math:`\tau` that brings the velocity at the joint axis to the target through proportional gain :attr:`Model.joint_target_ke`: 
-    
-    .. math::
-
-        \tau = k_e (\mathbf{\dot{q}}_{\text{target}} - \mathbf{\dot{q}})
-
-State
------
-
-.. autoclass:: State
-    :members:
-
-Control
--------
-
-.. autoclass:: Control
-    :members:
-
-.. _FK-IK:
-
-Forward / Inverse Kinematics
-----------------------------
-
-Articulated rigid-body mechanisms are kinematically described by the joints that connect the bodies as well as the
-relative transform from the parent and child body to the respective anchor frames of the joint in the parent and child body:
-
-.. image:: /img/joint_transforms.png
-   :width: 400
-   :align: center
-
-.. list-table:: Variable names in the kernels from articulation.py
-   :widths: 10 90
-   :header-rows: 1
-
-   * - Symbol
-     - Description
-   * - x_wp
-     - World transform of the parent body (stored at :attr:`State.body_q`)
-   * - x_wc
-     - World transform of the child body (stored at :attr:`State.body_q`)
-   * - x_pj
-     - Transform from the parent body to the joint parent anchor frame (defined by :attr:`Model.joint_X_p`)
-   * - x_cj
-     - Transform from the child body to the joint child anchor frame (defined by :attr:`Model.joint_X_c`)
-   * - x_j
-     - Joint transform from the joint parent anchor frame to the joint child anchor frame
-
-In the forward kinematics, the joint transform is determined by the joint coordinates (generalized joint positions :attr:`State.joint_q` and velocities :attr:`State.joint_qd`).
-Given the parent body's world transform :math:`x_{wp}` and the joint transform :math:`x_{j}`, the child body's world transform :math:`x_{wc}` is computed as:
-
-.. math::
-   x_{wc} = x_{wp} \cdot x_{pj} \cdot x_{j} \cdot x_{cj}^{-1}.
-
-.. autofunction:: eval_fk
-
-.. autofunction:: eval_ik
-
-Integrators
------------
-
-.. autoclass:: Integrator
-    :members:
-
-.. autoclass:: SemiImplicitIntegrator
-    :members:
-
-.. autoclass:: XPBDIntegrator
-    :members:
-
-.. autoclass:: FeatherstoneIntegrator
-    :members:
-
-.. autoclass:: VBDIntegrator
-    :members:
-
-Collisions
-----------
-
-
-Shapes are used to define the geometry of the rigid bodies in the simulation. Shapes without a parent body are considered static shapes.
-Use the ``add_shape_*`` methods in :class:`ModelBuilder` to add shapes to the model, such as :meth:`ModelBuilder.add_shape_sphere`, :meth:`ModelBuilder.add_shape_box`, :meth:`ModelBuilder.add_shape_capsule`, :meth:`ModelBuilder.add_shape_cylinder`, :meth:`ModelBuilder.add_shape_cone`, :meth:`ModelBuilder.add_shape_mesh`, :meth:`ModelBuilder.add_shape_sdf`, and :meth:`ModelBuilder.add_shape_plane`.
-The following shape types are supported:
-
-.. data:: GEO_SPHERE
-
-    Sphere shape
-
-.. data:: GEO_BOX
-    
-    Box shape
-
-.. data:: GEO_CAPSULE
-
-    Capsule shape
-
-.. data:: GEO_CYLINDER
-
-    Cylinder shape
-
-.. data:: GEO_CONE
-
-    Cone shape
-
-.. data:: GEO_MESH
-
-    Triangular mesh shape, see :class:`Mesh`
-
-.. data:: GEO_SDF
-
-    Signed distance field (volume) shape, see :class:`SDF`
-
-.. data:: GEO_PLANE
-
-    Rectangular plane shape (unlimited if the width or length is set to 0)
-
-
-Besides particle collisions with these shapes, the following rigid-body shape collisions are supported:
-
-.. list-table::
-   :header-rows: 1
-   :stub-columns: 1
-   :align: center
-   :widths: 10 10 10 10 10 10 10 10 10 10
-
-   * - 
-     - Particle
-     - Sphere
-     - Box
-     - Capsule
-     - Cylinder
-     - Cone
-     - Mesh
-     - SDF
-     - Plane
-   * - Particle
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-   * - Sphere
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-   * - Box
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-   * - Capsule
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-   * - Cylinder
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-   * - Cone
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-   * - Mesh
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-   * - SDF
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-   * - Plane
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-     - 
-
-.. autofunction:: collide
-
-Importers
----------
-
-Warp sim supports the loading of simulation models from URDF, MuJoCo (MJCF), and USD Physics files.
-
-.. autofunction:: parse_urdf
-
-.. autofunction:: parse_mjcf
-
-.. autofunction:: parse_usd
-
-.. autofunction:: resolve_usd_from_url
-
-Utility Functions
------------------
-
-Common utility functions used in simulators.
-
-.. autofunction:: velocity_at_point
-
-.. autofunction:: quat_to_euler
-
-.. autofunction:: quat_from_euler
-
-.. autofunction:: load_mesh
diff --git a/docs/modules/sparse.rst b/docs/modules/sparse.rst
index f2cb1939..590093d7 100644
--- a/docs/modules/sparse.rst
+++ b/docs/modules/sparse.rst
@@ -123,6 +123,8 @@ To get the exact count on host, you can explicitly synchronize using the `nnz_sy
 
 .. note:: The `nnz_sync()` method ensures that any ongoing transfer of the exact nnz number from the device offsets array to the host has completed and updates the nnz upper bound. This synchronization is only necessary when you need the exact count - for most operations, the upper bound is sufficient.
 
+If the number of non-zeros has been changed from outside of the ``warp.sparse`` builtin functions, for instance by direct modifications to the offsets array, use the `notify_nnz_changed()` method to ensure consistency.
+
 Converting back to COO Format
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
@@ -213,6 +215,15 @@ For more control about memory allocations, you may use the underlying lower-leve
     )
 
 
+Kernel-level utilities
+~~~~~~~~~~~~~~~~~~~~~~
+
+The following Warp functions are available for use in kernels:
+
+.. autofunction:: warp.sparse.bsr_row_index
+
+.. autofunction:: warp.sparse.bsr_block_index
+
 Reference
 ~~~~~~~~~
 .. automodule:: warp.sparse
diff --git a/docs/requirements.txt b/docs/requirements.txt
deleted file mode 100644
index 0db8e3bf..00000000
--- a/docs/requirements.txt
+++ /dev/null
@@ -1,6 +0,0 @@
-sphinx==8.2.3
-sphinx_copybutton==0.5.2
-numpy==2.2.4
-ruff==0.11.10
-myst-parser==4.0.1
-nvidia-sphinx-theme==0.0.8
diff --git a/exts/omni.warp.core/config/extension.toml b/exts/omni.warp.core/config/extension.toml
index 3a2f87c5..d23c3d68 100644
--- a/exts/omni.warp.core/config/extension.toml
+++ b/exts/omni.warp.core/config/extension.toml
@@ -1,6 +1,6 @@
 [package]
 # Semantic Versioning is used: https://semver.org/
-version = "1.9.1"
+version = "1.10.0-dev.0"
 authors = ["NVIDIA"]
 title = "Warp Core"
 description="The core Warp Python module"
diff --git a/exts/omni.warp.core/docs/CHANGELOG.md b/exts/omni.warp.core/docs/CHANGELOG.md
index eff33ce4..0e9a1462 100644
--- a/exts/omni.warp.core/docs/CHANGELOG.md
+++ b/exts/omni.warp.core/docs/CHANGELOG.md
@@ -121,6 +121,8 @@
 - Fix adding superfluous inactive nodes to tetrahedron polynomial function spaces in `warp.fem`.
 - Fix `#line` directives for PythonCUDA source correlation not being emitted by default when a module is compiled in
   debug mode ([GH-901](https://github.com/NVIDIA/warp/issues/901)).
+- Fix 2D shared tile allocation/de-allocation bug inside Warp functions ([GH-877](https://github.com/NVIDIA/warp/issues/877)).
+- Fix loading "unique" modules using `wp.load_module()`.
 
 ## [1.8.1] - 2025-08-01
 
diff --git a/exts/omni.warp/config/extension.toml b/exts/omni.warp/config/extension.toml
index 3dbd5b36..cb6488ff 100644
--- a/exts/omni.warp/config/extension.toml
+++ b/exts/omni.warp/config/extension.toml
@@ -1,6 +1,6 @@
 [package]
 # Semantic Versioning is used: https://semver.org/
-version = "1.9.1"
+version = "1.10.0-dev.0"
 authors = ["NVIDIA"]
 title = "Warp"
 description="Warp OmniGraph Nodes and Sample Scenes"
@@ -36,7 +36,7 @@ exclude = ["Ogn*Database.py", "*/ogn*"]
 "omni.timeline" = {}
 "omni.ui" = {optional = true}
 "omni.usd" = {}
-"omni.warp.core" = { version="~1.9-*" }
+"omni.warp.core" = { version="~1.10-*" }
 "usdrt.scenegraph" = {}
 
 [settings]
diff --git a/exts/omni.warp/data/scenes/.thumbs/256x256/cloth_simulation.usda.png b/exts/omni.warp/data/scenes/.thumbs/256x256/cloth_simulation.usda.png
deleted file mode 100644
index 64388e38..00000000
--- a/exts/omni.warp/data/scenes/.thumbs/256x256/cloth_simulation.usda.png
+++ /dev/null
@@ -1,3 +0,0 @@
-version https://git-lfs.github.com/spec/v1
-oid sha256:6f0cb8a86a6c2bf207622a0a2b787c6e0a8c88f69cf1c0c7f63f87464113cf87
-size 30925
diff --git a/exts/omni.warp/data/scenes/.thumbs/256x256/particles_simulation_drop.usda.png b/exts/omni.warp/data/scenes/.thumbs/256x256/particles_simulation_drop.usda.png
deleted file mode 100644
index da8a653b..00000000
--- a/exts/omni.warp/data/scenes/.thumbs/256x256/particles_simulation_drop.usda.png
+++ /dev/null
@@ -1,3 +0,0 @@
-version https://git-lfs.github.com/spec/v1
-oid sha256:138230e8da8913e1f5b4a41409521fc852eebaefac4697f2c84dce849007fd7b
-size 60805
diff --git a/exts/omni.warp/data/scenes/.thumbs/256x256/particles_simulation_throw.usda.png b/exts/omni.warp/data/scenes/.thumbs/256x256/particles_simulation_throw.usda.png
deleted file mode 100644
index fb6a2620..00000000
--- a/exts/omni.warp/data/scenes/.thumbs/256x256/particles_simulation_throw.usda.png
+++ /dev/null
@@ -1,3 +0,0 @@
-version https://git-lfs.github.com/spec/v1
-oid sha256:b7f98c68d08aadb77404d5fb30344dc8f34260956673a36175558e3e7db35ac8
-size 57545
diff --git a/exts/omni.warp/data/scenes/cloth_simulation.usda b/exts/omni.warp/data/scenes/cloth_simulation.usda
deleted file mode 100644
index cccb56a1..00000000
--- a/exts/omni.warp/data/scenes/cloth_simulation.usda
+++ /dev/null
@@ -1,391 +0,0 @@
-#usda 1.0
-(
-    customLayerData = {
-        dictionary cameraSettings = {
-            string boundCamera = "/CameraRoot/Camera"
-        }
-        dictionary renderSettings = {
-            int "rtx:post:dlss:execMode" = 0
-            bool "rtx:translucency:enabled" = 0
-        }
-    }
-    defaultPrim = "World"
-    endTimeCode = 36000
-    framesPerSecond = 60
-    metersPerUnit = 0.01
-    startTimeCode = 0
-    upAxis = "Y"
-)
-
-def Xform "World"
-{
-    def OmniGraph "ActionGraph"
-    {
-        token evaluationMode = "Automatic"
-        token evaluator:type = "execution"
-        token fabricCacheBacking = "Shared"
-        int2 fileFormatVersion = (1, 7)
-        token pipelineStage = "pipelineStageSimulation"
-
-        def OmniGraphNode "on_loaded" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            token node:type = "omni.graph.action.OnLoaded"
-            int node:typeVersion = 1
-            custom uint outputs:execOut (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (430, -120)
-        }
-
-        def OmniGraphNode "on_tick" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom uint inputs:framePeriod = 0
-            custom bool inputs:onlyPlayback = 1
-            token node:type = "omni.graph.action.OnTick"
-            int node:typeVersion = 1
-            custom double outputs:absoluteSimTime
-            custom double outputs:deltaSeconds
-            custom double outputs:frame
-            custom bool outputs:isPlaying
-            custom uint outputs:tick (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            custom double outputs:time
-            custom double outputs:timeSinceStart
-            custom double state:accumulatedSeconds = 0
-            custom uint state:frameCount = 0
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (490, 40)
-        }
-
-        def OmniGraphNode "read_xform" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom rel inputs:prim = </World/Cloth> (
-                customData = {
-                    dictionary omni = {
-                        dictionary graph = {
-                            string relType = "target"
-                        }
-                    }
-                }
-            )
-            custom token inputs:primPath = ""
-            custom bool inputs:usePath = 0
-            token node:type = "omni.graph.nodes.GetPrimLocalToWorldTransform"
-            int node:typeVersion = 2
-            custom matrix4d outputs:localToWorldTransform
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (500, -250)
-        }
-
-        def OmniGraphNode "read_collider" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom int inputs:_debugStamp
-            custom bool inputs:applySkelBinding = 0
-            custom string inputs:attrNamesToImport = "*"
-            custom bool inputs:computeBoundingBox = 0
-            custom bool inputs:enableBundleChangeTracking = 1
-            custom bool inputs:enableChangeTracking
-            custom string inputs:pathPattern = ""
-            custom rel inputs:prims = </World/Collider/Bunny> (
-                customData = {
-                    dictionary omni = {
-                        dictionary graph = {
-                            string relType = "target"
-                        }
-                    }
-                }
-            )
-            custom string inputs:typePattern = "*"
-            custom timecode inputs:usdTimecode = nan
-            token node:type = "omni.graph.nodes.ReadPrimsV2"
-            int node:typeVersion = 1
-            custom bool state:applySkelBinding = 0
-            custom string state:attrNamesToImport
-            custom bool state:computeBoundingBox = 0
-            custom bool state:enableBundleChangeTracking
-            custom bool state:enableChangeTracking
-            custom uint64[] state:inputPrimPaths = []
-            custom string state:pathPattern
-            custom uint64[] state:primPaths = []
-            custom string state:typePattern
-            custom timecode state:usdTimecode = -1
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (800, 190)
-
-            def Output "outputs_primsBundle"
-            {
-            }
-        }
-
-        def OmniGraphNode "grid_create" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom int2 inputs:dims = (64, 64)
-            custom uint inputs:execIn
-            prepend uint inputs:execIn.connect = [
-                </World/ActionGraph/on_loaded.outputs:execOut>,
-                </World/ActionGraph/on_tick.outputs:tick>,
-            ]
-            custom float2 inputs:size = (100, 100)
-            custom matrix4d inputs:transform
-            prepend matrix4d inputs:transform.connect = </World/ActionGraph/read_xform.outputs:localToWorldTransform>
-            token node:type = "omni.warp.WarpGridCreate"
-            int node:typeVersion = 1
-            custom uint outputs:execOut (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (810, -56)
-
-            def Output "outputs_mesh"
-            {
-            }
-        }
-
-        def OmniGraphNode "cloth_simulate" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom rel inputs:cloth
-            prepend rel inputs:cloth = </World/ActionGraph/grid_create/outputs_mesh>
-            custom float inputs:clothDensity = 1
-            custom float inputs:clothEdgeBendingStiffness = 0.01
-            custom float inputs:clothEdgeDampingStiffness = 0.1
-            custom float inputs:clothTriAreaStiffness = 1000000
-            custom float inputs:clothTriDampingStiffness = 0.00001
-            custom float inputs:clothTriDrag = 0
-            custom float inputs:clothTriElasticStiffness = 100000
-            custom float inputs:clothTriLift = 0
-            custom rel inputs:collider
-            prepend rel inputs:collider = </World/ActionGraph/read_collider/outputs_primsBundle>
-            custom float inputs:colliderContactDistance = 2.5
-            custom float inputs:colliderContactQueryRange = 1
-            custom float inputs:contactDampingStiffness = 1e-5
-            custom float inputs:contactElasticStiffness = 100000000
-            custom float inputs:contactFrictionCoeff = 0.75
-            custom float inputs:contactFrictionStiffness = 10000
-            custom bool inputs:enabled = 1
-            custom uint inputs:execIn
-            prepend uint inputs:execIn.connect = </World/ActionGraph/grid_create.outputs:execOut>
-            custom vector3f inputs:gravity = (0, -980, 0)
-            custom float inputs:groundAltitude = 8
-            custom bool inputs:groundEnabled = 1
-            custom int inputs:substepCount = 32
-            custom double inputs:time = 0
-            prepend double inputs:time.connect = </World/ActionGraph/on_tick.outputs:time>
-            token node:type = "omni.warp.WarpClothSimulate"
-            int node:typeVersion = 1
-            custom uint outputs:execOut (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (1117, 11)
-
-            def Output "outputs_cloth"
-            {
-            }
-        }
-
-        def OmniGraphNode "bundle_inspect_changes" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom rel inputs:bundle
-            prepend rel inputs:bundle = </World/ActionGraph/cloth_simulate/outputs_cloth>
-            custom uint inputs:execIn
-            prepend uint inputs:execIn.connect = </World/ActionGraph/cloth_simulate.outputs:execOut>
-            token node:type = "omni.warp.WarpOgnBundleInspectChanges"
-            int node:typeVersion = 1
-            custom string outputs:attrsChanged
-            custom uint outputs:execOut (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            custom bool outputs:topologyChanged
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (1385, 25)
-
-            def Output "outputs_bundle"
-            {
-            }
-        }
-
-        def OmniGraphNode "write_prims" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom string inputs:attrNamesToExport = "*"
-            prepend string inputs:attrNamesToExport.connect = </World/ActionGraph/bundle_inspect_changes.outputs:attrsChanged>
-            custom uint inputs:execIn
-            prepend uint inputs:execIn.connect = </World/ActionGraph/bundle_inspect_changes.outputs:execOut>
-            custom token inputs:layerIdentifier
-            custom string inputs:pathPattern = "*"
-            custom rel inputs:prims = </World/Cloth> (
-                customData = {
-                    dictionary omni = {
-                        dictionary graph = {
-                            string relType = "target"
-                        }
-                    }
-                }
-            )
-            custom rel inputs:primsBundle
-            prepend rel inputs:primsBundle = </World/ActionGraph/bundle_inspect_changes/outputs_bundle>
-            custom bool inputs:scatterUnderTargets = 0
-            custom string inputs:typePattern = "*"
-            custom bool inputs:usdWriteBack = 1
-            prepend bool inputs:usdWriteBack.connect = </World/ActionGraph/bundle_inspect_changes.outputs:topologyChanged>
-            token node:type = "omni.graph.nodes.WritePrimsV2"
-            int node:typeVersion = 1
-            custom uint outputs:execOut (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            custom string state:attrNamesToExport = "*"
-            custom token state:layerIdentifier
-            custom string state:pathPattern = "*"
-            custom uint64 state:primBundleDirtyId
-            custom uint64[] state:prims = []
-            custom bool state:scatterUnderTargets = 0
-            custom string state:typePattern = "*"
-            custom bool state:usdWriteBack = 1
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (1670, 50)
-        }
-    }
-
-    def Scope "Looks"
-    {
-        def "CeramicMaterial" (
-            prepend payload = @./assets/materials/ceramic_material.usda@
-        )
-        {
-            over "CeramicMaterial"
-            {
-                over "Shader"
-                {
-                    color3f inputs:diffuse_reflection_color = (0.75, 0.75, 0.75) (
-                        customData = {
-                            float3 default = (0.2, 0.2, 0.2)
-                        }
-                        displayGroup = "Albedo"
-                        displayName = "Albedo Color"
-                        doc = "This is the albedo base color"
-                        hidden = false
-                        renderType = "color"
-                    )
-                }
-            }
-        }
-
-        def "ClothMaterial" (
-            prepend payload = @./assets/materials/cloth_material.usda@
-        )
-        {
-            over "ClothMaterial"
-            {
-                over "Shader"
-                {
-                    color3f inputs:diffuse_reflection_color = (0.8, 0.35, 0.125) (
-                        customData = {
-                            float3 default = (0.2, 0.2, 0.2)
-                        }
-                        displayGroup = "Albedo"
-                        displayName = "Albedo Color"
-                        doc = "This is the albedo base color"
-                        hidden = false
-                        renderType = "color"
-                    )
-                }
-            }
-        }
-    }
-
-    def Mesh "Cloth" (
-        prepend apiSchemas = ["MaterialBindingAPI"]
-    )
-    {
-        rel material:binding = </World/Looks/ClothMaterial/ClothMaterial> (
-            bindMaterialAs = "weakerThanDescendants"
-        )
-        float3 xformOp:rotateXYZ = (0, 0, 0)
-        float3 xformOp:scale = (1, 1, 1)
-        double3 xformOp:translate = (0, 100, 0)
-        uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:rotateXYZ", "xformOp:scale"]
-    }
-
-    def "Collider" (
-        prepend payload = @./assets/geometries/bunny.usd@
-    )
-    {
-        float3 xformOp:rotateXYZ = (0, 0, 0)
-        float3 xformOp:scale = (1, 1, 1)
-        double3 xformOp:translate = (0, 25, 0)
-        uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:rotateXYZ", "xformOp:scale"]
-
-        over "Bunny" (
-            prepend apiSchemas = ["MaterialBindingAPI"]
-        )
-        {
-            rel material:binding = </World/Looks/CeramicMaterial/CeramicMaterial> (
-                bindMaterialAs = "weakerThanDescendants"
-            )
-        }
-    }
-}
-
-def Xform "Environment"
-{
-    double3 xformOp:rotateXYZ = (0, 0, 0)
-    double3 xformOp:scale = (1, 1, 1)
-    double3 xformOp:translate = (0, 0, 0)
-    uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:rotateXYZ", "xformOp:scale"]
-
-    def "Stage" (
-        prepend payload = @./assets/environments/stage.usda@
-    )
-    {
-    }
-}
-
-def Xform "CameraRoot"
-{
-    double3 xformOp:rotateXYZ = (-20, 10, 0)
-    double3 xformOp:scale = (1, 1, 1)
-    double3 xformOp:translate = (0, 30, 0)
-    uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:rotateXYZ", "xformOp:scale"]
-
-    def Camera "Camera"
-    {
-        float2 clippingRange = (1, 10000000)
-        float focalLength = 25
-        float focusDistance = 375
-        float fStop = 0
-        bool omni:kit:cameraLock = 0
-        double3 xformOp:rotateYXZ = (0, 0, 0)
-        double3 xformOp:scale = (1, 1, 1)
-        double3 xformOp:translate = (0, 0, 400)
-        uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:rotateYXZ", "xformOp:scale"]
-    }
-}
diff --git a/exts/omni.warp/data/scenes/particles_simulation_drop.usda b/exts/omni.warp/data/scenes/particles_simulation_drop.usda
deleted file mode 100644
index f927d22e..00000000
--- a/exts/omni.warp/data/scenes/particles_simulation_drop.usda
+++ /dev/null
@@ -1,464 +0,0 @@
-#usda 1.0
-(
-    customLayerData = {
-        dictionary cameraSettings = {
-            string boundCamera = "/CameraRoot/Camera"
-        }
-        dictionary renderSettings = {
-            int "rtx:post:dlss:execMode" = 0
-            bool "rtx:translucency:enabled" = 0
-        }
-    }
-    defaultPrim = "World"
-    endTimeCode = 36000
-    framesPerSecond = 60
-    metersPerUnit = 0.01
-    startTimeCode = 0
-    upAxis = "Y"
-)
-
-def Xform "World"
-{
-    def OmniGraph "ActionGraph"
-    {
-        token evaluationMode = "Automatic"
-        token evaluator:type = "execution"
-        token fabricCacheBacking = "Shared"
-        int2 fileFormatVersion = (1, 7)
-        token pipelineStage = "pipelineStageSimulation"
-
-        def OmniGraphNode "on_loaded" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            token node:type = "omni.graph.action.OnLoaded"
-            int node:typeVersion = 1
-            custom uint outputs:execOut (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (0, -270)
-        }
-
-        def OmniGraphNode "on_tick" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom uint inputs:framePeriod = 0
-            custom bool inputs:onlyPlayback = 1
-            token node:type = "omni.graph.action.OnTick"
-            int node:typeVersion = 1
-            custom double outputs:absoluteSimTime
-            custom double outputs:deltaSeconds
-            custom double outputs:frame
-            custom bool outputs:isPlaying
-            custom uint outputs:tick (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            custom double outputs:time
-            custom double outputs:timeSinceStart
-            custom double state:accumulatedSeconds = 0
-            custom uint state:frameCount = 0
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (32, 60)
-        }
-
-        def OmniGraphNode "read_xform" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom rel inputs:prim = </World/Points> (
-                customData = {
-                    dictionary omni = {
-                        dictionary graph = {
-                            string relType = "target"
-                        }
-                    }
-                }
-            )
-            custom token inputs:primPath
-            custom bool inputs:usePath = 0
-            token node:type = "omni.graph.nodes.GetPrimLocalToWorldTransform"
-            int node:typeVersion = 2
-            custom matrix4d outputs:localToWorldTransform
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (-70, -160)
-        }
-
-        def OmniGraphNode "read_emitter" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom int inputs:_debugStamp
-            custom bool inputs:applySkelBinding = 0
-            custom string inputs:attrNamesToImport = "*"
-            custom bool inputs:computeBoundingBox = 0
-            custom bool inputs:enableBundleChangeTracking = 1
-            custom bool inputs:enableChangeTracking
-            custom string inputs:pathPattern = ""
-            custom rel inputs:prims = </World/Emitter> (
-                customData = {
-                    dictionary omni = {
-                        dictionary graph = {
-                            string relType = "target"
-                        }
-                    }
-                }
-            )
-            custom string inputs:typePattern = "*"
-            custom timecode inputs:usdTimecode = nan
-            token node:type = "omni.graph.nodes.ReadPrimsV2"
-            int node:typeVersion = 1
-            custom bool state:applySkelBinding = 0
-            custom string state:attrNamesToImport
-            custom bool state:computeBoundingBox = 0
-            custom bool state:enableBundleChangeTracking
-            custom bool state:enableChangeTracking
-            custom uint64[] state:inputPrimPaths = []
-            custom string state:pathPattern
-            custom uint64[] state:primPaths = []
-            custom string state:typePattern
-            custom timecode state:usdTimecode = -1
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (20, -60)
-
-            def Output "outputs_primsBundle"
-            {
-            }
-        }
-
-        def OmniGraphNode "read_collider" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom int inputs:_debugStamp
-            custom bool inputs:applySkelBinding = 0
-            custom string inputs:attrNamesToImport = "*"
-            custom bool inputs:computeBoundingBox = 0
-            custom bool inputs:enableBundleChangeTracking = 1
-            custom bool inputs:enableChangeTracking
-            custom string inputs:pathPattern = ""
-            custom rel inputs:prims = </World/Collider> (
-                customData = {
-                    dictionary omni = {
-                        dictionary graph = {
-                            string relType = "target"
-                        }
-                    }
-                }
-            )
-            custom string inputs:typePattern = "*"
-            custom timecode inputs:usdTimecode = nan
-            token node:type = "omni.graph.nodes.ReadPrimsV2"
-            int node:typeVersion = 1
-            custom bool state:applySkelBinding = 0
-            custom string state:attrNamesToImport
-            custom bool state:computeBoundingBox = 0
-            custom bool state:enableBundleChangeTracking
-            custom bool state:enableChangeTracking
-            custom uint64[] state:inputPrimPaths = []
-            custom string state:pathPattern
-            custom uint64[] state:primPaths = []
-            custom string state:typePattern
-            custom timecode state:usdTimecode = -1
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (350, 200)
-
-            def Output "outputs_primsBundle"
-            {
-            }
-        }
-
-        def OmniGraphNode "particles_from_mesh" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom uint inputs:execIn
-            prepend uint inputs:execIn.connect = [
-                </World/ActionGraph/on_loaded.outputs:execOut>,
-                </World/ActionGraph/on_tick.outputs:tick>,
-            ]
-            custom float inputs:mass = 1
-            custom int inputs:maxPoints = 1000000
-            custom float inputs:maxSdf = 0
-            custom rel inputs:mesh
-            prepend rel inputs:mesh = </World/ActionGraph/read_emitter/outputs_primsBundle>
-            custom float inputs:minSdf = -100
-            custom float inputs:radius = 2
-            custom int inputs:seed
-            custom float inputs:spacing = 5
-            custom float inputs:spacingJitter = 1
-            custom matrix4d inputs:transform
-            prepend matrix4d inputs:transform.connect = </World/ActionGraph/read_xform.outputs:localToWorldTransform>
-            custom float inputs:velocityAmount = 0
-            custom vector3f inputs:velocityDir = (0, 0, 1)
-            token node:type = "omni.warp.WarpParticlesFromMesh"
-            int node:typeVersion = 1
-            custom uint outputs:execOut (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (350, -138)
-
-            def Output "outputs_particles"
-            {
-            }
-        }
-
-        def OmniGraphNode "particles_simulate" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom rel inputs:collider
-            prepend rel inputs:collider = </World/ActionGraph/read_collider/outputs_primsBundle>
-            custom float inputs:colliderContactDistance = 1
-            custom float inputs:colliderContactQueryRange = 100
-            custom float inputs:colliderContactRange = 100
-            custom float inputs:contactDampingStiffness = 1
-            custom float inputs:contactElasticStiffness = 250
-            custom float inputs:contactFrictionCoeff = 1
-            custom float inputs:contactFrictionStiffness = 5
-            custom bool inputs:enabled = 1
-            custom uint inputs:execIn
-            prepend uint inputs:execIn.connect = </World/ActionGraph/particles_from_mesh.outputs:execOut>
-            custom float inputs:globalScale = 100
-            custom vector3f inputs:gravity = (0, -980, 0)
-            custom float inputs:groundAltitude = 0
-            custom bool inputs:groundEnabled = 1
-            custom rel inputs:particles
-            prepend rel inputs:particles = </World/ActionGraph/particles_from_mesh/outputs_particles>
-            custom float inputs:particlesContactAdhesion = 0.25
-            custom float inputs:particlesContactCohesion = 0.75
-            custom float inputs:particlesQueryRange = 4
-            custom float inputs:particlesRange = 2
-            custom int inputs:substepCount = 16
-            custom double inputs:time = 0
-            prepend double inputs:time.connect = </World/ActionGraph/on_tick.outputs:time>
-            token node:type = "omni.warp.WarpParticlesSimulate"
-            int node:typeVersion = 1
-            custom uint outputs:execOut (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (657, -46)
-
-            def Output "outputs_particles"
-            {
-            }
-        }
-
-        def OmniGraphNode "bundle_inspect_changes" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom rel inputs:bundle
-            prepend rel inputs:bundle = </World/ActionGraph/particles_simulate/outputs_particles>
-            custom uint inputs:execIn
-            prepend uint inputs:execIn.connect = </World/ActionGraph/particles_simulate.outputs:execOut>
-            token node:type = "omni.warp.WarpOgnBundleInspectChanges"
-            int node:typeVersion = 1
-            custom string outputs:attrsChanged
-            custom uint outputs:execOut (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            custom bool outputs:topologyChanged
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (910, -25)
-
-            def Output "outputs_bundle"
-            {
-            }
-        }
-
-        def OmniGraphNode "write_prims" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom string inputs:attrNamesToExport = "*"
-            prepend string inputs:attrNamesToExport.connect = </World/ActionGraph/bundle_inspect_changes.outputs:attrsChanged>
-            custom uint inputs:execIn
-            prepend uint inputs:execIn.connect = </World/ActionGraph/bundle_inspect_changes.outputs:execOut>
-            custom token inputs:layerIdentifier
-            custom string inputs:pathPattern = "*"
-            custom rel inputs:prims = </World/Points> (
-                customData = {
-                    dictionary omni = {
-                        dictionary graph = {
-                            string relType = "target"
-                        }
-                    }
-                }
-            )
-            custom rel inputs:primsBundle
-            prepend rel inputs:primsBundle = </World/ActionGraph/bundle_inspect_changes/outputs_bundle>
-            custom bool inputs:scatterUnderTargets = 0
-            custom string inputs:typePattern = "*"
-            custom bool inputs:usdWriteBack = 1
-            prepend bool inputs:usdWriteBack.connect = </World/ActionGraph/bundle_inspect_changes.outputs:topologyChanged>
-            token node:type = "omni.graph.nodes.WritePrimsV2"
-            int node:typeVersion = 1
-            custom uint outputs:execOut (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            custom string state:attrNamesToExport = "*"
-            custom token state:layerIdentifier
-            custom string state:pathPattern = "*"
-            custom uint64 state:primBundleDirtyId
-            custom uint64[] state:prims = []
-            custom bool state:scatterUnderTargets = 0
-            custom string state:typePattern = "*"
-            custom bool state:usdWriteBack = 1
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (1200, 0)
-        }
-    }
-
-    def Scope "Looks"
-    {
-        def "CeramicMaterial" (
-            prepend payload = @./assets/materials/ceramic_material.usda@
-        )
-        {
-            over "CeramicMaterial"
-            {
-                over "Shader"
-                {
-                    color3f inputs:diffuse_reflection_color = (0.75, 0.75, 0.75) (
-                        customData = {
-                            float3 default = (0.2, 0.2, 0.2)
-                        }
-                        displayGroup = "Albedo"
-                        displayName = "Albedo Color"
-                        doc = "This is the albedo base color"
-                        hidden = false
-                        renderType = "color"
-                    )
-                }
-            }
-        }
-
-        def "ParticleMaterial" (
-            prepend payload = @./assets/materials/particle_material.usda@
-        )
-        {
-            over "ParticleMaterial"
-            {
-                over "Shader"
-                {
-                    color3f inputs:diffuse_reflection_color = (0.16, 0.11, 0.08) (
-                        customData = {
-                            float3 default = (0.2, 0.2, 0.2)
-                        }
-                        displayGroup = "Albedo"
-                        displayName = "Albedo Color"
-                        doc = "This is the albedo base color"
-                        hidden = false
-                        renderType = "color"
-                    )
-                }
-            }
-        }
-    }
-
-    def Points "Points" (
-        prepend apiSchemas = ["MaterialBindingAPI"]
-    )
-    {
-        rel material:binding = </World/Looks/ParticleMaterial/ParticleMaterial> (
-            bindMaterialAs = "weakerThanDescendants"
-        )
-    }
-
-    def Mesh "Emitter" (
-        prepend apiSchemas = ["OmniSceneVisualizationAPI"]
-    )
-    {
-        float3[] extent = [(-50, -50, -50), (50, 50, 50)]
-        int[] faceVertexCounts = [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3]
-        int[] faceVertexIndices = [0, 32, 33, 1, 1, 33, 34, 2, 2, 34, 35, 3, 3, 35, 36, 4, 4, 36, 37, 5, 5, 37, 38, 6, 6, 38, 39, 7, 7, 39, 40, 8, 8, 40, 41, 9, 9, 41, 42, 10, 10, 42, 43, 11, 11, 43, 44, 12, 12, 44, 45, 13, 13, 45, 46, 14, 14, 46, 47, 15, 15, 47, 48, 16, 16, 48, 49, 17, 17, 49, 50, 18, 18, 50, 51, 19, 19, 51, 52, 20, 20, 52, 53, 21, 21, 53, 54, 22, 22, 54, 55, 23, 23, 55, 56, 24, 24, 56, 57, 25, 25, 57, 58, 26, 26, 58, 59, 27, 27, 59, 60, 28, 28, 60, 61, 29, 29, 61, 62, 30, 30, 62, 63, 31, 31, 63, 32, 0, 0, 1, 64, 1, 2, 64, 2, 3, 64, 3, 4, 64, 4, 5, 64, 5, 6, 64, 6, 7, 64, 7, 8, 64, 8, 9, 64, 9, 10, 64, 10, 11, 64, 11, 12, 64, 12, 13, 64, 13, 14, 64, 14, 15, 64, 15, 16, 64, 16, 17, 64, 17, 18, 64, 18, 19, 64, 19, 20, 64, 20, 21, 64, 21, 22, 64, 22, 23, 64, 23, 24, 64, 24, 25, 64, 25, 26, 64, 26, 27, 64, 27, 28, 64, 28, 29, 64, 29, 30, 64, 30, 31, 64, 31, 0, 64, 32, 65, 33, 33, 65, 34, 34, 65, 35, 35, 65, 36, 36, 65, 37, 37, 65, 38, 38, 65, 39, 39, 65, 40, 40, 65, 41, 41, 65, 42, 42, 65, 43, 43, 65, 44, 44, 65, 45, 45, 65, 46, 46, 65, 47, 47, 65, 48, 48, 65, 49, 49, 65, 50, 50, 65, 51, 51, 65, 52, 52, 65, 53, 53, 65, 54, 54, 65, 55, 55, 65, 56, 56, 65, 57, 57, 65, 58, 58, 65, 59, 59, 65, 60, 60, 65, 61, 61, 65, 62, 62, 65, 63, 63, 65, 32]
-        bool omni:scene:visualization:drawWireframe = 1
-        point3f[] points = [(50, -50, 0), (49.03926, -50, 9.754517), (46.193974, -50, 19.13417), (41.57348, -50, 27.778513), (35.35534, -50, 35.35534), (27.778513, -50, 41.57348), (19.13417, -50, 46.193974), (9.754517, -50, 49.03926), (3.061617e-15, -50, 50), (-9.754517, -50, 49.03926), (-19.13417, -50, 46.193974), (-27.778513, -50, 41.57348), (-35.35534, -50, 35.35534), (-41.57348, -50, 27.778513), (-46.193974, -50, 19.13417), (-49.03926, -50, 9.754517), (-50, -50, 6.123234e-15), (-49.03926, -50, -9.754517), (-46.193974, -50, -19.13417), (-41.57348, -50, -27.778513), (-35.35534, -50, -35.35534), (-27.778513, -50, -41.57348), (-19.13417, -50, -46.193974), (-9.754517, -50, -49.03926), (-9.184851e-15, -50, -50), (9.754517, -50, -49.03926), (19.13417, -50, -46.193974), (27.778513, -50, -41.57348), (35.35534, -50, -35.35534), (41.57348, -50, -27.778513), (46.193974, -50, -19.13417), (49.03926, -50, -9.754517), (50, 50, 0), (49.03926, 50, 9.754517), (46.193974, 50, 19.13417), (41.57348, 50, 27.778513), (35.35534, 50, 35.35534), (27.778513, 50, 41.57348), (19.13417, 50, 46.193974), (9.754517, 50, 49.03926), (3.061617e-15, 50, 50), (-9.754517, 50, 49.03926), (-19.13417, 50, 46.193974), (-27.778513, 50, 41.57348), (-35.35534, 50, 35.35534), (-41.57348, 50, 27.778513), (-46.193974, 50, 19.13417), (-49.03926, 50, 9.754517), (-50, 50, 6.123234e-15), (-49.03926, 50, -9.754517), (-46.193974, 50, -19.13417), (-41.57348, 50, -27.778513), (-35.35534, 50, -35.35534), (-27.778513, 50, -41.57348), (-19.13417, 50, -46.193974), (-9.754517, 50, -49.03926), (-9.184851e-15, 50, -50), (9.754517, 50, -49.03926), (19.13417, 50, -46.193974), (27.778513, 50, -41.57348), (35.35534, 50, -35.35534), (41.57348, 50, -27.778513), (46.193974, 50, -19.13417), (49.03926, 50, -9.754517), (0, -50, 0), (0, 50, 0)]
-        uniform token purpose = "guide"
-        uniform token subdivisionScheme = "none"
-        token visibility = "inherited"
-        double3 xformOp:rotateXYZ = (-45, 0, 0)
-        double3 xformOp:scale = (1, 1.75, 1)
-        double3 xformOp:translate = (0, 300, 0)
-        uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:rotateXYZ", "xformOp:scale"]
-    }
-
-    def Mesh "Collider" (
-        prepend apiSchemas = ["MaterialBindingAPI"]
-    )
-    {
-        float3[] extent = [(-50, -50, -50), (50, 50, 50)]
-        int[] faceVertexCounts = [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3]
-        int[] faceVertexIndices = [0, 1, 2, 0, 2, 3, 0, 3, 4, 0, 4, 5, 0, 5, 6, 0, 6, 7, 0, 7, 8, 0, 8, 9, 0, 9, 10, 0, 10, 11, 0, 11, 12, 0, 12, 13, 0, 13, 14, 0, 14, 15, 0, 15, 16, 0, 16, 17, 0, 17, 18, 0, 18, 19, 0, 19, 20, 0, 20, 21, 0, 21, 22, 0, 22, 23, 0, 23, 24, 0, 24, 25, 0, 25, 26, 0, 26, 27, 0, 27, 28, 0, 28, 29, 0, 29, 30, 0, 30, 31, 0, 31, 32, 0, 32, 1, 1, 33, 34, 2, 2, 34, 35, 3, 3, 35, 36, 4, 4, 36, 37, 5, 5, 37, 38, 6, 6, 38, 39, 7, 7, 39, 40, 8, 8, 40, 41, 9, 9, 41, 42, 10, 10, 42, 43, 11, 11, 43, 44, 12, 12, 44, 45, 13, 13, 45, 46, 14, 14, 46, 47, 15, 15, 47, 48, 16, 16, 48, 49, 17, 17, 49, 50, 18, 18, 50, 51, 19, 19, 51, 52, 20, 20, 52, 53, 21, 21, 53, 54, 22, 22, 54, 55, 23, 23, 55, 56, 24, 24, 56, 57, 25, 25, 57, 58, 26, 26, 58, 59, 27, 27, 59, 60, 28, 28, 60, 61, 29, 29, 61, 62, 30, 30, 62, 63, 31, 31, 63, 64, 32, 32, 64, 33, 1, 33, 65, 66, 34, 34, 66, 67, 35, 35, 67, 68, 36, 36, 68, 69, 37, 37, 69, 70, 38, 38, 70, 71, 39, 39, 71, 72, 40, 40, 72, 73, 41, 41, 73, 74, 42, 42, 74, 75, 43, 43, 75, 76, 44, 44, 76, 77, 45, 45, 77, 78, 46, 46, 78, 79, 47, 47, 79, 80, 48, 48, 80, 81, 49, 49, 81, 82, 50, 50, 82, 83, 51, 51, 83, 84, 52, 52, 84, 85, 53, 53, 85, 86, 54, 54, 86, 87, 55, 55, 87, 88, 56, 56, 88, 89, 57, 57, 89, 90, 58, 58, 90, 91, 59, 59, 91, 92, 60, 60, 92, 93, 61, 61, 93, 94, 62, 62, 94, 95, 63, 63, 95, 96, 64, 64, 96, 65, 33, 65, 97, 98, 66, 66, 98, 99, 67, 67, 99, 100, 68, 68, 100, 101, 69, 69, 101, 102, 70, 70, 102, 103, 71, 71, 103, 104, 72, 72, 104, 105, 73, 73, 105, 106, 74, 74, 106, 107, 75, 75, 107, 108, 76, 76, 108, 109, 77, 77, 109, 110, 78, 78, 110, 111, 79, 79, 111, 112, 80, 80, 112, 113, 81, 81, 113, 114, 82, 82, 114, 115, 83, 83, 115, 116, 84, 84, 116, 117, 85, 85, 117, 118, 86, 86, 118, 119, 87, 87, 119, 120, 88, 88, 120, 121, 89, 89, 121, 122, 90, 90, 122, 123, 91, 91, 123, 124, 92, 92, 124, 125, 93, 93, 125, 126, 94, 94, 126, 127, 95, 95, 127, 128, 96, 96, 128, 97, 65, 97, 129, 130, 98, 98, 130, 131, 99, 99, 131, 132, 100, 100, 132, 133, 101, 101, 133, 134, 102, 102, 134, 135, 103, 103, 135, 136, 104, 104, 136, 137, 105, 105, 137, 138, 106, 106, 138, 139, 107, 107, 139, 140, 108, 108, 140, 141, 109, 109, 141, 142, 110, 110, 142, 143, 111, 111, 143, 144, 112, 112, 144, 145, 113, 113, 145, 146, 114, 114, 146, 147, 115, 115, 147, 148, 116, 116, 148, 149, 117, 117, 149, 150, 118, 118, 150, 151, 119, 119, 151, 152, 120, 120, 152, 153, 121, 121, 153, 154, 122, 122, 154, 155, 123, 123, 155, 156, 124, 124, 156, 157, 125, 125, 157, 158, 126, 126, 158, 159, 127, 127, 159, 160, 128, 128, 160, 129, 97, 129, 161, 162, 130, 130, 162, 163, 131, 131, 163, 164, 132, 132, 164, 165, 133, 133, 165, 166, 134, 134, 166, 167, 135, 135, 167, 168, 136, 136, 168, 169, 137, 137, 169, 170, 138, 138, 170, 171, 139, 139, 171, 172, 140, 140, 172, 173, 141, 141, 173, 174, 142, 142, 174, 175, 143, 143, 175, 176, 144, 144, 176, 177, 145, 145, 177, 178, 146, 146, 178, 179, 147, 147, 179, 180, 148, 148, 180, 181, 149, 149, 181, 182, 150, 150, 182, 183, 151, 151, 183, 184, 152, 152, 184, 185, 153, 153, 185, 186, 154, 154, 186, 187, 155, 155, 187, 188, 156, 156, 188, 189, 157, 157, 189, 190, 158, 158, 190, 191, 159, 159, 191, 192, 160, 160, 192, 161, 129, 161, 193, 194, 162, 162, 194, 195, 163, 163, 195, 196, 164, 164, 196, 197, 165, 165, 197, 198, 166, 166, 198, 199, 167, 167, 199, 200, 168, 168, 200, 201, 169, 169, 201, 202, 170, 170, 202, 203, 171, 171, 203, 204, 172, 172, 204, 205, 173, 173, 205, 206, 174, 174, 206, 207, 175, 175, 207, 208, 176, 176, 208, 209, 177, 177, 209, 210, 178, 178, 210, 211, 179, 179, 211, 212, 180, 180, 212, 213, 181, 181, 213, 214, 182, 182, 214, 215, 183, 183, 215, 216, 184, 184, 216, 217, 185, 185, 217, 218, 186, 186, 218, 219, 187, 187, 219, 220, 188, 188, 220, 221, 189, 189, 221, 222, 190, 190, 222, 223, 191, 191, 223, 224, 192, 192, 224, 193, 161, 193, 225, 226, 194, 194, 226, 227, 195, 195, 227, 228, 196, 196, 228, 229, 197, 197, 229, 230, 198, 198, 230, 231, 199, 199, 231, 232, 200, 200, 232, 233, 201, 201, 233, 234, 202, 202, 234, 235, 203, 203, 235, 236, 204, 204, 236, 237, 205, 205, 237, 238, 206, 206, 238, 239, 207, 207, 239, 240, 208, 208, 240, 241, 209, 209, 241, 242, 210, 210, 242, 243, 211, 211, 243, 244, 212, 212, 244, 245, 213, 213, 245, 246, 214, 214, 246, 247, 215, 215, 247, 248, 216, 216, 248, 249, 217, 217, 249, 250, 218, 218, 250, 251, 219, 219, 251, 252, 220, 220, 252, 253, 221, 221, 253, 254, 222, 222, 254, 255, 223, 223, 255, 256, 224, 224, 256, 225, 193, 225, 257, 258, 226, 226, 258, 259, 227, 227, 259, 260, 228, 228, 260, 261, 229, 229, 261, 262, 230, 230, 262, 263, 231, 231, 263, 264, 232, 232, 264, 265, 233, 233, 265, 266, 234, 234, 266, 267, 235, 235, 267, 268, 236, 236, 268, 269, 237, 237, 269, 270, 238, 238, 270, 271, 239, 239, 271, 272, 240, 240, 272, 273, 241, 241, 273, 274, 242, 242, 274, 275, 243, 243, 275, 276, 244, 244, 276, 277, 245, 245, 277, 278, 246, 246, 278, 279, 247, 247, 279, 280, 248, 248, 280, 281, 249, 249, 281, 282, 250, 250, 282, 283, 251, 251, 283, 284, 252, 252, 284, 285, 253, 253, 285, 286, 254, 254, 286, 287, 255, 255, 287, 288, 256, 256, 288, 257, 225, 257, 289, 290, 258, 258, 290, 291, 259, 259, 291, 292, 260, 260, 292, 293, 261, 261, 293, 294, 262, 262, 294, 295, 263, 263, 295, 296, 264, 264, 296, 297, 265, 265, 297, 298, 266, 266, 298, 299, 267, 267, 299, 300, 268, 268, 300, 301, 269, 269, 301, 302, 270, 270, 302, 303, 271, 271, 303, 304, 272, 272, 304, 305, 273, 273, 305, 306, 274, 274, 306, 307, 275, 275, 307, 308, 276, 276, 308, 309, 277, 277, 309, 310, 278, 278, 310, 311, 279, 279, 311, 312, 280, 280, 312, 313, 281, 281, 313, 314, 282, 282, 314, 315, 283, 283, 315, 316, 284, 284, 316, 317, 285, 285, 317, 318, 286, 286, 318, 319, 287, 287, 319, 320, 288, 288, 320, 289, 257, 289, 321, 322, 290, 290, 322, 323, 291, 291, 323, 324, 292, 292, 324, 325, 293, 293, 325, 326, 294, 294, 326, 327, 295, 295, 327, 328, 296, 296, 328, 329, 297, 297, 329, 330, 298, 298, 330, 331, 299, 299, 331, 332, 300, 300, 332, 333, 301, 301, 333, 334, 302, 302, 334, 335, 303, 303, 335, 336, 304, 304, 336, 337, 305, 305, 337, 338, 306, 306, 338, 339, 307, 307, 339, 340, 308, 308, 340, 341, 309, 309, 341, 342, 310, 310, 342, 343, 311, 311, 343, 344, 312, 312, 344, 345, 313, 313, 345, 346, 314, 314, 346, 347, 315, 315, 347, 348, 316, 316, 348, 349, 317, 317, 349, 350, 318, 318, 350, 351, 319, 319, 351, 352, 320, 320, 352, 321, 289, 321, 353, 354, 322, 322, 354, 355, 323, 323, 355, 356, 324, 324, 356, 357, 325, 325, 357, 358, 326, 326, 358, 359, 327, 327, 359, 360, 328, 328, 360, 361, 329, 329, 361, 362, 330, 330, 362, 363, 331, 331, 363, 364, 332, 332, 364, 365, 333, 333, 365, 366, 334, 334, 366, 367, 335, 335, 367, 368, 336, 336, 368, 369, 337, 337, 369, 370, 338, 338, 370, 371, 339, 339, 371, 372, 340, 340, 372, 373, 341, 341, 373, 374, 342, 342, 374, 375, 343, 343, 375, 376, 344, 344, 376, 377, 345, 345, 377, 378, 346, 346, 378, 379, 347, 347, 379, 380, 348, 348, 380, 381, 349, 349, 381, 382, 350, 350, 382, 383, 351, 351, 383, 384, 352, 352, 384, 353, 321, 353, 385, 386, 354, 354, 386, 387, 355, 355, 387, 388, 356, 356, 388, 389, 357, 357, 389, 390, 358, 358, 390, 391, 359, 359, 391, 392, 360, 360, 392, 393, 361, 361, 393, 394, 362, 362, 394, 395, 363, 363, 395, 396, 364, 364, 396, 397, 365, 365, 397, 398, 366, 366, 398, 399, 367, 367, 399, 400, 368, 368, 400, 401, 369, 369, 401, 402, 370, 370, 402, 403, 371, 371, 403, 404, 372, 372, 404, 405, 373, 373, 405, 406, 374, 374, 406, 407, 375, 375, 407, 408, 376, 376, 408, 409, 377, 377, 409, 410, 378, 378, 410, 411, 379, 379, 411, 412, 380, 380, 412, 413, 381, 381, 413, 414, 382, 382, 414, 415, 383, 383, 415, 416, 384, 384, 416, 385, 353, 385, 417, 418, 386, 386, 418, 419, 387, 387, 419, 420, 388, 388, 420, 421, 389, 389, 421, 422, 390, 390, 422, 423, 391, 391, 423, 424, 392, 392, 424, 425, 393, 393, 425, 426, 394, 394, 426, 427, 395, 395, 427, 428, 396, 396, 428, 429, 397, 397, 429, 430, 398, 398, 430, 431, 399, 399, 431, 432, 400, 400, 432, 433, 401, 401, 433, 434, 402, 402, 434, 435, 403, 403, 435, 436, 404, 404, 436, 437, 405, 405, 437, 438, 406, 406, 438, 439, 407, 407, 439, 440, 408, 408, 440, 441, 409, 409, 441, 442, 410, 410, 442, 443, 411, 411, 443, 444, 412, 412, 444, 445, 413, 413, 445, 446, 414, 414, 446, 447, 415, 415, 447, 448, 416, 416, 448, 417, 385, 417, 449, 450, 418, 418, 450, 451, 419, 419, 451, 452, 420, 420, 452, 453, 421, 421, 453, 454, 422, 422, 454, 455, 423, 423, 455, 456, 424, 424, 456, 457, 425, 425, 457, 458, 426, 426, 458, 459, 427, 427, 459, 460, 428, 428, 460, 461, 429, 429, 461, 462, 430, 430, 462, 463, 431, 431, 463, 464, 432, 432, 464, 465, 433, 433, 465, 466, 434, 434, 466, 467, 435, 435, 467, 468, 436, 436, 468, 469, 437, 437, 469, 470, 438, 438, 470, 471, 439, 439, 471, 472, 440, 440, 472, 473, 441, 441, 473, 474, 442, 442, 474, 475, 443, 443, 475, 476, 444, 444, 476, 477, 445, 445, 477, 478, 446, 446, 478, 479, 447, 447, 479, 480, 448, 448, 480, 449, 417, 449, 481, 450, 450, 481, 451, 451, 481, 452, 452, 481, 453, 453, 481, 454, 454, 481, 455, 455, 481, 456, 456, 481, 457, 457, 481, 458, 458, 481, 459, 459, 481, 460, 460, 481, 461, 461, 481, 462, 462, 481, 463, 463, 481, 464, 464, 481, 465, 465, 481, 466, 466, 481, 467, 467, 481, 468, 468, 481, 469, 469, 481, 470, 470, 481, 471, 471, 481, 472, 472, 481, 473, 473, 481, 474, 474, 481, 475, 475, 481, 476, 476, 481, 477, 477, 481, 478, 478, 481, 479, 479, 481, 480, 480, 481, 449]
-        rel material:binding = </World/Looks/CeramicMaterial/CeramicMaterial> (
-            bindMaterialAs = "weakerThanDescendants"
-        )
-        normal3f[] normals = [(0, -50, 0), (9.754517, -49.03926, 0), (9.567085, -49.03926, 1.9030117), (0, -50, 0), (9.567085, -49.03926, 1.9030117), (9.011998, -49.03926, 3.7328918), (0, -50, 0), (9.011998, -49.03926, 3.7328918), (8.110583, -49.03926, 5.4193187), (0, -50, 0), (8.110583, -49.03926, 5.4193187), (6.8974843, -49.03926, 6.8974843), (0, -50, 0), (6.8974843, -49.03926, 6.8974843), (5.4193187, -49.03926, 8.110583), (0, -50, 0), (5.4193187, -49.03926, 8.110583), (3.7328918, -49.03926, 9.011998), (0, -50, 0), (3.7328918, -49.03926, 9.011998), (1.9030117, -49.03926, 9.567085), (0, -50, 0), (1.9030117, -49.03926, 9.567085), (5.9729185e-16, -49.03926, 9.754517), (0, -50, 0), (5.9729185e-16, -49.03926, 9.754517), (-1.9030117, -49.03926, 9.567085), (0, -50, 0), (-1.9030117, -49.03926, 9.567085), (-3.7328918, -49.03926, 9.011998), (0, -50, 0), (-3.7328918, -49.03926, 9.011998), (-5.4193187, -49.03926, 8.110583), (0, -50, 0), (-5.4193187, -49.03926, 8.110583), (-6.8974843, -49.03926, 6.8974843), (0, -50, 0), (-6.8974843, -49.03926, 6.8974843), (-8.110583, -49.03926, 5.4193187), (0, -50, 0), (-8.110583, -49.03926, 5.4193187), (-9.011998, -49.03926, 3.7328918), (0, -50, 0), (-9.011998, -49.03926, 3.7328918), (-9.567085, -49.03926, 1.9030117), (0, -50, 0), (-9.567085, -49.03926, 1.9030117), (-9.754517, -49.03926, 1.1945837e-15), (0, -50, 0), (-9.754517, -49.03926, 1.1945837e-15), (-9.567085, -49.03926, -1.9030117), (0, -50, 0), (-9.567085, -49.03926, -1.9030117), (-9.011998, -49.03926, -3.7328918), (0, -50, 0), (-9.011998, -49.03926, -3.7328918), (-8.110583, -49.03926, -5.4193187), (0, -50, 0), (-8.110583, -49.03926, -5.4193187), (-6.8974843, -49.03926, -6.8974843), (0, -50, 0), (-6.8974843, -49.03926, -6.8974843), (-5.4193187, -49.03926, -8.110583), (0, -50, 0), (-5.4193187, -49.03926, -8.110583), (-3.7328918, -49.03926, -9.011998), (0, -50, 0), (-3.7328918, -49.03926, -9.011998), (-1.9030117, -49.03926, -9.567085), (0, -50, 0), (-1.9030117, -49.03926, -9.567085), (-1.7918755e-15, -49.03926, -9.754517), (0, -50, 0), (-1.7918755e-15, -49.03926, -9.754517), (1.9030117, -49.03926, -9.567085), (0, -50, 0), (1.9030117, -49.03926, -9.567085), (3.7328918, -49.03926, -9.011998), (0, -50, 0), (3.7328918, -49.03926, -9.011998), (5.4193187, -49.03926, -8.110583), (0, -50, 0), (5.4193187, -49.03926, -8.110583), (6.8974843, -49.03926, -6.8974843), (0, -50, 0), (6.8974843, -49.03926, -6.8974843), (8.110583, -49.03926, -5.4193187), (0, -50, 0), (8.110583, -49.03926, -5.4193187), (9.011998, -49.03926, -3.7328918), (0, -50, 0), (9.011998, -49.03926, -3.7328918), (9.567085, -49.03926, -1.9030117), (0, -50, 0), (9.567085, -49.03926, -1.9030117), (9.754517, -49.03926, 0), (9.754517, -49.03926, 0), (19.13417, -46.193974, 0), (18.766514, -46.193974, 3.7328918), (9.567085, -49.03926, 1.9030117), (9.567085, -49.03926, 1.9030117), (18.766514, -46.193974, 3.7328918), (17.67767, -46.193974, 7.322331), (9.011998, -49.03926, 3.7328918), (9.011998, -49.03926, 3.7328918), (17.67767, -46.193974, 7.322331), (15.909483, -46.193974, 10.630376), (8.110583, -49.03926, 5.4193187), (8.110583, -49.03926, 5.4193187), (15.909483, -46.193974, 10.630376), (13.529902, -46.193974, 13.529902), (6.8974843, -49.03926, 6.8974843), (6.8974843, -49.03926, 6.8974843), (13.529902, -46.193974, 13.529902), (10.630376, -46.193974, 15.909483), (5.4193187, -49.03926, 8.110583), (5.4193187, -49.03926, 8.110583), (10.630376, -46.193974, 15.909483), (7.322331, -46.193974, 17.67767), (3.7328918, -49.03926, 9.011998), (3.7328918, -49.03926, 9.011998), (7.322331, -46.193974, 17.67767), (3.7328918, -46.193974, 18.766514), (1.9030117, -49.03926, 9.567085), (1.9030117, -49.03926, 9.567085), (3.7328918, -46.193974, 18.766514), (1.1716302e-15, -46.193974, 19.13417), (5.9729185e-16, -49.03926, 9.754517), (5.9729185e-16, -49.03926, 9.754517), (1.1716302e-15, -46.193974, 19.13417), (-3.7328918, -46.193974, 18.766514), (-1.9030117, -49.03926, 9.567085), (-1.9030117, -49.03926, 9.567085), (-3.7328918, -46.193974, 18.766514), (-7.322331, -46.193974, 17.67767), (-3.7328918, -49.03926, 9.011998), (-3.7328918, -49.03926, 9.011998), (-7.322331, -46.193974, 17.67767), (-10.630376, -46.193974, 15.909483), (-5.4193187, -49.03926, 8.110583), (-5.4193187, -49.03926, 8.110583), (-10.630376, -46.193974, 15.909483), (-13.529902, -46.193974, 13.529902), (-6.8974843, -49.03926, 6.8974843), (-6.8974843, -49.03926, 6.8974843), (-13.529902, -46.193974, 13.529902), (-15.909483, -46.193974, 10.630376), (-8.110583, -49.03926, 5.4193187), (-8.110583, -49.03926, 5.4193187), (-15.909483, -46.193974, 10.630376), (-17.67767, -46.193974, 7.322331), (-9.011998, -49.03926, 3.7328918), (-9.011998, -49.03926, 3.7328918), (-17.67767, -46.193974, 7.322331), (-18.766514, -46.193974, 3.7328918), (-9.567085, -49.03926, 1.9030117), (-9.567085, -49.03926, 1.9030117), (-18.766514, -46.193974, 3.7328918), (-19.13417, -46.193974, 2.3432603e-15), (-9.754517, -49.03926, 1.1945837e-15), (-9.754517, -49.03926, 1.1945837e-15), (-19.13417, -46.193974, 2.3432603e-15), (-18.766514, -46.193974, -3.7328918), (-9.567085, -49.03926, -1.9030117), (-9.567085, -49.03926, -1.9030117), (-18.766514, -46.193974, -3.7328918), (-17.67767, -46.193974, -7.322331), (-9.011998, -49.03926, -3.7328918), (-9.011998, -49.03926, -3.7328918), (-17.67767, -46.193974, -7.322331), (-15.909483, -46.193974, -10.630376), (-8.110583, -49.03926, -5.4193187), (-8.110583, -49.03926, -5.4193187), (-15.909483, -46.193974, -10.630376), (-13.529902, -46.193974, -13.529902), (-6.8974843, -49.03926, -6.8974843), (-6.8974843, -49.03926, -6.8974843), (-13.529902, -46.193974, -13.529902), (-10.630376, -46.193974, -15.909483), (-5.4193187, -49.03926, -8.110583), (-5.4193187, -49.03926, -8.110583), (-10.630376, -46.193974, -15.909483), (-7.322331, -46.193974, -17.67767), (-3.7328918, -49.03926, -9.011998), (-3.7328918, -49.03926, -9.011998), (-7.322331, -46.193974, -17.67767), (-3.7328918, -46.193974, -18.766514), (-1.9030117, -49.03926, -9.567085), (-1.9030117, -49.03926, -9.567085), (-3.7328918, -46.193974, -18.766514), (-3.5148903e-15, -46.193974, -19.13417), (-1.7918755e-15, -49.03926, -9.754517), (-1.7918755e-15, -49.03926, -9.754517), (-3.5148903e-15, -46.193974, -19.13417), (3.7328918, -46.193974, -18.766514), (1.9030117, -49.03926, -9.567085), (1.9030117, -49.03926, -9.567085), (3.7328918, -46.193974, -18.766514), (7.322331, -46.193974, -17.67767), (3.7328918, -49.03926, -9.011998), (3.7328918, -49.03926, -9.011998), (7.322331, -46.193974, -17.67767), (10.630376, -46.193974, -15.909483), (5.4193187, -49.03926, -8.110583), (5.4193187, -49.03926, -8.110583), (10.630376, -46.193974, -15.909483), (13.529902, -46.193974, -13.529902), (6.8974843, -49.03926, -6.8974843), (6.8974843, -49.03926, -6.8974843), (13.529902, -46.193974, -13.529902), (15.909483, -46.193974, -10.630376), (8.110583, -49.03926, -5.4193187), (8.110583, -49.03926, -5.4193187), (15.909483, -46.193974, -10.630376), (17.67767, -46.193974, -7.322331), (9.011998, -49.03926, -3.7328918), (9.011998, -49.03926, -3.7328918), (17.67767, -46.193974, -7.322331), (18.766514, -46.193974, -3.7328918), (9.567085, -49.03926, -1.9030117), (9.567085, -49.03926, -1.9030117), (18.766514, -46.193974, -3.7328918), (19.13417, -46.193974, 0), (9.754517, -49.03926, 0), (19.13417, -46.193974, 0), (27.778513, -41.57348, 0), (27.244755, -41.57348, 5.4193187), (18.766514, -46.193974, 3.7328918), (18.766514, -46.193974, 3.7328918), (27.244755, -41.57348, 5.4193187), (25.664, -41.57348, 10.630376), (17.67767, -46.193974, 7.322331), (17.67767, -46.193974, 7.322331), (25.664, -41.57348, 10.630376), (23.096987, -41.57348, 15.432914), (15.909483, -46.193974, 10.630376), (15.909483, -46.193974, 10.630376), (23.096987, -41.57348, 15.432914), (19.642374, -41.57348, 19.642374), (13.529902, -46.193974, 13.529902), (13.529902, -46.193974, 13.529902), (19.642374, -41.57348, 19.642374), (15.432914, -41.57348, 23.096987), (10.630376, -46.193974, 15.909483), (10.630376, -46.193974, 15.909483), (15.432914, -41.57348, 23.096987), (10.630376, -41.57348, 25.664), (7.322331, -46.193974, 17.67767), (7.322331, -46.193974, 17.67767), (10.630376, -41.57348, 25.664), (5.4193187, -41.57348, 27.244755), (3.7328918, -46.193974, 18.766514), (3.7328918, -46.193974, 18.766514), (5.4193187, -41.57348, 27.244755), (1.7009433e-15, -41.57348, 27.778513), (1.1716302e-15, -46.193974, 19.13417), (1.1716302e-15, -46.193974, 19.13417), (1.7009433e-15, -41.57348, 27.778513), (-5.4193187, -41.57348, 27.244755), (-3.7328918, -46.193974, 18.766514), (-3.7328918, -46.193974, 18.766514), (-5.4193187, -41.57348, 27.244755), (-10.630376, -41.57348, 25.664), (-7.322331, -46.193974, 17.67767), (-7.322331, -46.193974, 17.67767), (-10.630376, -41.57348, 25.664), (-15.432914, -41.57348, 23.096987), (-10.630376, -46.193974, 15.909483), (-10.630376, -46.193974, 15.909483), (-15.432914, -41.57348, 23.096987), (-19.642374, -41.57348, 19.642374), (-13.529902, -46.193974, 13.529902), (-13.529902, -46.193974, 13.529902), (-19.642374, -41.57348, 19.642374), (-23.096987, -41.57348, 15.432914), (-15.909483, -46.193974, 10.630376), (-15.909483, -46.193974, 10.630376), (-23.096987, -41.57348, 15.432914), (-25.664, -41.57348, 10.630376), (-17.67767, -46.193974, 7.322331), (-17.67767, -46.193974, 7.322331), (-25.664, -41.57348, 10.630376), (-27.244755, -41.57348, 5.4193187), (-18.766514, -46.193974, 3.7328918), (-18.766514, -46.193974, 3.7328918), (-27.244755, -41.57348, 5.4193187), (-27.778513, -41.57348, 3.4018865e-15), (-19.13417, -46.193974, 2.3432603e-15), (-19.13417, -46.193974, 2.3432603e-15), (-27.778513, -41.57348, 3.4018865e-15), (-27.244755, -41.57348, -5.4193187), (-18.766514, -46.193974, -3.7328918), (-18.766514, -46.193974, -3.7328918), (-27.244755, -41.57348, -5.4193187), (-25.664, -41.57348, -10.630376), (-17.67767, -46.193974, -7.322331), (-17.67767, -46.193974, -7.322331), (-25.664, -41.57348, -10.630376), (-23.096987, -41.57348, -15.432914), (-15.909483, -46.193974, -10.630376), (-15.909483, -46.193974, -10.630376), (-23.096987, -41.57348, -15.432914), (-19.642374, -41.57348, -19.642374), (-13.529902, -46.193974, -13.529902), (-13.529902, -46.193974, -13.529902), (-19.642374, -41.57348, -19.642374), (-15.432914, -41.57348, -23.096987), (-10.630376, -46.193974, -15.909483), (-10.630376, -46.193974, -15.909483), (-15.432914, -41.57348, -23.096987), (-10.630376, -41.57348, -25.664), (-7.322331, -46.193974, -17.67767), (-7.322331, -46.193974, -17.67767), (-10.630376, -41.57348, -25.664), (-5.4193187, -41.57348, -27.244755), (-3.7328918, -46.193974, -18.766514), (-3.7328918, -46.193974, -18.766514), (-5.4193187, -41.57348, -27.244755), (-5.1028297e-15, -41.57348, -27.778513), (-3.5148903e-15, -46.193974, -19.13417), (-3.5148903e-15, -46.193974, -19.13417), (-5.1028297e-15, -41.57348, -27.778513), (5.4193187, -41.57348, -27.244755), (3.7328918, -46.193974, -18.766514), (3.7328918, -46.193974, -18.766514), (5.4193187, -41.57348, -27.244755), (10.630376, -41.57348, -25.664), (7.322331, -46.193974, -17.67767), (7.322331, -46.193974, -17.67767), (10.630376, -41.57348, -25.664), (15.432914, -41.57348, -23.096987), (10.630376, -46.193974, -15.909483), (10.630376, -46.193974, -15.909483), (15.432914, -41.57348, -23.096987), (19.642374, -41.57348, -19.642374), (13.529902, -46.193974, -13.529902), (13.529902, -46.193974, -13.529902), (19.642374, -41.57348, -19.642374), (23.096987, -41.57348, -15.432914), (15.909483, -46.193974, -10.630376), (15.909483, -46.193974, -10.630376), (23.096987, -41.57348, -15.432914), (25.664, -41.57348, -10.630376), (17.67767, -46.193974, -7.322331), (17.67767, -46.193974, -7.322331), (25.664, -41.57348, -10.630376), (27.244755, -41.57348, -5.4193187), (18.766514, -46.193974, -3.7328918), (18.766514, -46.193974, -3.7328918), (27.244755, -41.57348, -5.4193187), (27.778513, -41.57348, 0), (19.13417, -46.193974, 0), (27.778513, -41.57348, 0), (35.35534, -35.35534, 0), (34.676, -35.35534, 6.8974843), (27.244755, -41.57348, 5.4193187), (27.244755, -41.57348, 5.4193187), (34.676, -35.35534, 6.8974843), (32.664074, -35.35534, 13.529902), (25.664, -41.57348, 10.630376), (25.664, -41.57348, 10.630376), (32.664074, -35.35534, 13.529902), (29.396889, -35.35534, 19.642374), (23.096987, -41.57348, 15.432914), (23.096987, -41.57348, 15.432914), (29.396889, -35.35534, 19.642374), (25, -35.35534, 25), (19.642374, -41.57348, 19.642374), (19.642374, -41.57348, 19.642374), (25, -35.35534, 25), (19.642374, -35.35534, 29.396889), (15.432914, -41.57348, 23.096987), (15.432914, -41.57348, 23.096987), (19.642374, -35.35534, 29.396889), (13.529902, -35.35534, 32.664074), (10.630376, -41.57348, 25.664), (10.630376, -41.57348, 25.664), (13.529902, -35.35534, 32.664074), (6.8974843, -35.35534, 34.676), (5.4193187, -41.57348, 27.244755), (5.4193187, -41.57348, 27.244755), (6.8974843, -35.35534, 34.676), (2.1648902e-15, -35.35534, 35.35534), (1.7009433e-15, -41.57348, 27.778513), (1.7009433e-15, -41.57348, 27.778513), (2.1648902e-15, -35.35534, 35.35534), (-6.8974843, -35.35534, 34.676), (-5.4193187, -41.57348, 27.244755), (-5.4193187, -41.57348, 27.244755), (-6.8974843, -35.35534, 34.676), (-13.529902, -35.35534, 32.664074), (-10.630376, -41.57348, 25.664), (-10.630376, -41.57348, 25.664), (-13.529902, -35.35534, 32.664074), (-19.642374, -35.35534, 29.396889), (-15.432914, -41.57348, 23.096987), (-15.432914, -41.57348, 23.096987), (-19.642374, -35.35534, 29.396889), (-25, -35.35534, 25), (-19.642374, -41.57348, 19.642374), (-19.642374, -41.57348, 19.642374), (-25, -35.35534, 25), (-29.396889, -35.35534, 19.642374), (-23.096987, -41.57348, 15.432914), (-23.096987, -41.57348, 15.432914), (-29.396889, -35.35534, 19.642374), (-32.664074, -35.35534, 13.529902), (-25.664, -41.57348, 10.630376), (-25.664, -41.57348, 10.630376), (-32.664074, -35.35534, 13.529902), (-34.676, -35.35534, 6.8974843), (-27.244755, -41.57348, 5.4193187), (-27.244755, -41.57348, 5.4193187), (-34.676, -35.35534, 6.8974843), (-35.35534, -35.35534, 4.3297804e-15), (-27.778513, -41.57348, 3.4018865e-15), (-27.778513, -41.57348, 3.4018865e-15), (-35.35534, -35.35534, 4.3297804e-15), (-34.676, -35.35534, -6.8974843), (-27.244755, -41.57348, -5.4193187), (-27.244755, -41.57348, -5.4193187), (-34.676, -35.35534, -6.8974843), (-32.664074, -35.35534, -13.529902), (-25.664, -41.57348, -10.630376), (-25.664, -41.57348, -10.630376), (-32.664074, -35.35534, -13.529902), (-29.396889, -35.35534, -19.642374), (-23.096987, -41.57348, -15.432914), (-23.096987, -41.57348, -15.432914), (-29.396889, -35.35534, -19.642374), (-25, -35.35534, -25), (-19.642374, -41.57348, -19.642374), (-19.642374, -41.57348, -19.642374), (-25, -35.35534, -25), (-19.642374, -35.35534, -29.396889), (-15.432914, -41.57348, -23.096987), (-15.432914, -41.57348, -23.096987), (-19.642374, -35.35534, -29.396889), (-13.529902, -35.35534, -32.664074), (-10.630376, -41.57348, -25.664), (-10.630376, -41.57348, -25.664), (-13.529902, -35.35534, -32.664074), (-6.8974843, -35.35534, -34.676), (-5.4193187, -41.57348, -27.244755), (-5.4193187, -41.57348, -27.244755), (-6.8974843, -35.35534, -34.676), (-6.49467e-15, -35.35534, -35.35534), (-5.1028297e-15, -41.57348, -27.778513), (-5.1028297e-15, -41.57348, -27.778513), (-6.49467e-15, -35.35534, -35.35534), (6.8974843, -35.35534, -34.676), (5.4193187, -41.57348, -27.244755), (5.4193187, -41.57348, -27.244755), (6.8974843, -35.35534, -34.676), (13.529902, -35.35534, -32.664074), (10.630376, -41.57348, -25.664), (10.630376, -41.57348, -25.664), (13.529902, -35.35534, -32.664074), (19.642374, -35.35534, -29.396889), (15.432914, -41.57348, -23.096987), (15.432914, -41.57348, -23.096987), (19.642374, -35.35534, -29.396889), (25, -35.35534, -25), (19.642374, -41.57348, -19.642374), (19.642374, -41.57348, -19.642374), (25, -35.35534, -25), (29.396889, -35.35534, -19.642374), (23.096987, -41.57348, -15.432914), (23.096987, -41.57348, -15.432914), (29.396889, -35.35534, -19.642374), (32.664074, -35.35534, -13.529902), (25.664, -41.57348, -10.630376), (25.664, -41.57348, -10.630376), (32.664074, -35.35534, -13.529902), (34.676, -35.35534, -6.8974843), (27.244755, -41.57348, -5.4193187), (27.244755, -41.57348, -5.4193187), (34.676, -35.35534, -6.8974843), (35.35534, -35.35534, 0), (27.778513, -41.57348, 0), (35.35534, -35.35534, 0), (41.57348, -27.778513, 0), (40.77466, -27.778513, 8.110583), (34.676, -35.35534, 6.8974843), (34.676, -35.35534, 6.8974843), (40.77466, -27.778513, 8.110583), (38.408886, -27.778513, 15.909483), (32.664074, -35.35534, 13.529902), (32.664074, -35.35534, 13.529902), (38.408886, -27.778513, 15.909483), (34.567085, -27.778513, 23.096987), (29.396889, -35.35534, 19.642374), (29.396889, -35.35534, 19.642374), (34.567085, -27.778513, 23.096987), (29.396889, -27.778513, 29.396889), (25, -35.35534, 25), (25, -35.35534, 25), (29.396889, -27.778513, 29.396889), (23.096987, -27.778513, 34.567085), (19.642374, -35.35534, 29.396889), (19.642374, -35.35534, 29.396889), (23.096987, -27.778513, 34.567085), (15.909483, -27.778513, 38.408886), (13.529902, -35.35534, 32.664074), (13.529902, -35.35534, 32.664074), (15.909483, -27.778513, 38.408886), (8.110583, -27.778513, 40.77466), (6.8974843, -35.35534, 34.676), (6.8974843, -35.35534, 34.676), (8.110583, -27.778513, 40.77466), (2.5456415e-15, -27.778513, 41.57348), (2.1648902e-15, -35.35534, 35.35534), (2.1648902e-15, -35.35534, 35.35534), (2.5456415e-15, -27.778513, 41.57348), (-8.110583, -27.778513, 40.77466), (-6.8974843, -35.35534, 34.676), (-6.8974843, -35.35534, 34.676), (-8.110583, -27.778513, 40.77466), (-15.909483, -27.778513, 38.408886), (-13.529902, -35.35534, 32.664074), (-13.529902, -35.35534, 32.664074), (-15.909483, -27.778513, 38.408886), (-23.096987, -27.778513, 34.567085), (-19.642374, -35.35534, 29.396889), (-19.642374, -35.35534, 29.396889), (-23.096987, -27.778513, 34.567085), (-29.396889, -27.778513, 29.396889), (-25, -35.35534, 25), (-25, -35.35534, 25), (-29.396889, -27.778513, 29.396889), (-34.567085, -27.778513, 23.096987), (-29.396889, -35.35534, 19.642374), (-29.396889, -35.35534, 19.642374), (-34.567085, -27.778513, 23.096987), (-38.408886, -27.778513, 15.909483), (-32.664074, -35.35534, 13.529902), (-32.664074, -35.35534, 13.529902), (-38.408886, -27.778513, 15.909483), (-40.77466, -27.778513, 8.110583), (-34.676, -35.35534, 6.8974843), (-34.676, -35.35534, 6.8974843), (-40.77466, -27.778513, 8.110583), (-41.57348, -27.778513, 5.091283e-15), (-35.35534, -35.35534, 4.3297804e-15), (-35.35534, -35.35534, 4.3297804e-15), (-41.57348, -27.778513, 5.091283e-15), (-40.77466, -27.778513, -8.110583), (-34.676, -35.35534, -6.8974843), (-34.676, -35.35534, -6.8974843), (-40.77466, -27.778513, -8.110583), (-38.408886, -27.778513, -15.909483), (-32.664074, -35.35534, -13.529902), (-32.664074, -35.35534, -13.529902), (-38.408886, -27.778513, -15.909483), (-34.567085, -27.778513, -23.096987), (-29.396889, -35.35534, -19.642374), (-29.396889, -35.35534, -19.642374), (-34.567085, -27.778513, -23.096987), (-29.396889, -27.778513, -29.396889), (-25, -35.35534, -25), (-25, -35.35534, -25), (-29.396889, -27.778513, -29.396889), (-23.096987, -27.778513, -34.567085), (-19.642374, -35.35534, -29.396889), (-19.642374, -35.35534, -29.396889), (-23.096987, -27.778513, -34.567085), (-15.909483, -27.778513, -38.408886), (-13.529902, -35.35534, -32.664074), (-13.529902, -35.35534, -32.664074), (-15.909483, -27.778513, -38.408886), (-8.110583, -27.778513, -40.77466), (-6.8974843, -35.35534, -34.676), (-6.8974843, -35.35534, -34.676), (-8.110583, -27.778513, -40.77466), (-7.6369244e-15, -27.778513, -41.57348), (-6.49467e-15, -35.35534, -35.35534), (-6.49467e-15, -35.35534, -35.35534), (-7.6369244e-15, -27.778513, -41.57348), (8.110583, -27.778513, -40.77466), (6.8974843, -35.35534, -34.676), (6.8974843, -35.35534, -34.676), (8.110583, -27.778513, -40.77466), (15.909483, -27.778513, -38.408886), (13.529902, -35.35534, -32.664074), (13.529902, -35.35534, -32.664074), (15.909483, -27.778513, -38.408886), (23.096987, -27.778513, -34.567085), (19.642374, -35.35534, -29.396889), (19.642374, -35.35534, -29.396889), (23.096987, -27.778513, -34.567085), (29.396889, -27.778513, -29.396889), (25, -35.35534, -25), (25, -35.35534, -25), (29.396889, -27.778513, -29.396889), (34.567085, -27.778513, -23.096987), (29.396889, -35.35534, -19.642374), (29.396889, -35.35534, -19.642374), (34.567085, -27.778513, -23.096987), (38.408886, -27.778513, -15.909483), (32.664074, -35.35534, -13.529902), (32.664074, -35.35534, -13.529902), (38.408886, -27.778513, -15.909483), (40.77466, -27.778513, -8.110583), (34.676, -35.35534, -6.8974843), (34.676, -35.35534, -6.8974843), (40.77466, -27.778513, -8.110583), (41.57348, -27.778513, 0), (35.35534, -35.35534, 0), (41.57348, -27.778513, 0), (46.193974, -19.13417, 0), (45.306374, -19.13417, 9.011998), (40.77466, -27.778513, 8.110583), (40.77466, -27.778513, 8.110583), (45.306374, -19.13417, 9.011998), (42.67767, -19.13417, 17.67767), (38.408886, -27.778513, 15.909483), (38.408886, -27.778513, 15.909483), (42.67767, -19.13417, 17.67767), (38.408886, -19.13417, 25.664), (34.567085, -27.778513, 23.096987), (34.567085, -27.778513, 23.096987), (38.408886, -19.13417, 25.664), (32.664074, -19.13417, 32.664074), (29.396889, -27.778513, 29.396889), (29.396889, -27.778513, 29.396889), (32.664074, -19.13417, 32.664074), (25.664, -19.13417, 38.408886), (23.096987, -27.778513, 34.567085), (23.096987, -27.778513, 34.567085), (25.664, -19.13417, 38.408886), (17.67767, -19.13417, 42.67767), (15.909483, -27.778513, 38.408886), (15.909483, -27.778513, 38.408886), (17.67767, -19.13417, 42.67767), (9.011998, -19.13417, 45.306374), (8.110583, -27.778513, 40.77466), (8.110583, -27.778513, 40.77466), (9.011998, -19.13417, 45.306374), (2.8285653e-15, -19.13417, 46.193974), (2.5456415e-15, -27.778513, 41.57348), (2.5456415e-15, -27.778513, 41.57348), (2.8285653e-15, -19.13417, 46.193974), (-9.011998, -19.13417, 45.306374), (-8.110583, -27.778513, 40.77466), (-8.110583, -27.778513, 40.77466), (-9.011998, -19.13417, 45.306374), (-17.67767, -19.13417, 42.67767), (-15.909483, -27.778513, 38.408886), (-15.909483, -27.778513, 38.408886), (-17.67767, -19.13417, 42.67767), (-25.664, -19.13417, 38.408886), (-23.096987, -27.778513, 34.567085), (-23.096987, -27.778513, 34.567085), (-25.664, -19.13417, 38.408886), (-32.664074, -19.13417, 32.664074), (-29.396889, -27.778513, 29.396889), (-29.396889, -27.778513, 29.396889), (-32.664074, -19.13417, 32.664074), (-38.408886, -19.13417, 25.664), (-34.567085, -27.778513, 23.096987), (-34.567085, -27.778513, 23.096987), (-38.408886, -19.13417, 25.664), (-42.67767, -19.13417, 17.67767), (-38.408886, -27.778513, 15.909483), (-38.408886, -27.778513, 15.909483), (-42.67767, -19.13417, 17.67767), (-45.306374, -19.13417, 9.011998), (-40.77466, -27.778513, 8.110583), (-40.77466, -27.778513, 8.110583), (-45.306374, -19.13417, 9.011998), (-46.193974, -19.13417, 5.6571306e-15), (-41.57348, -27.778513, 5.091283e-15), (-41.57348, -27.778513, 5.091283e-15), (-46.193974, -19.13417, 5.6571306e-15), (-45.306374, -19.13417, -9.011998), (-40.77466, -27.778513, -8.110583), (-40.77466, -27.778513, -8.110583), (-45.306374, -19.13417, -9.011998), (-42.67767, -19.13417, -17.67767), (-38.408886, -27.778513, -15.909483), (-38.408886, -27.778513, -15.909483), (-42.67767, -19.13417, -17.67767), (-38.408886, -19.13417, -25.664), (-34.567085, -27.778513, -23.096987), (-34.567085, -27.778513, -23.096987), (-38.408886, -19.13417, -25.664), (-32.664074, -19.13417, -32.664074), (-29.396889, -27.778513, -29.396889), (-29.396889, -27.778513, -29.396889), (-32.664074, -19.13417, -32.664074), (-25.664, -19.13417, -38.408886), (-23.096987, -27.778513, -34.567085), (-23.096987, -27.778513, -34.567085), (-25.664, -19.13417, -38.408886), (-17.67767, -19.13417, -42.67767), (-15.909483, -27.778513, -38.408886), (-15.909483, -27.778513, -38.408886), (-17.67767, -19.13417, -42.67767), (-9.011998, -19.13417, -45.306374), (-8.110583, -27.778513, -40.77466), (-8.110583, -27.778513, -40.77466), (-9.011998, -19.13417, -45.306374), (-8.4856955e-15, -19.13417, -46.193974), (-7.6369244e-15, -27.778513, -41.57348), (-7.6369244e-15, -27.778513, -41.57348), (-8.4856955e-15, -19.13417, -46.193974), (9.011998, -19.13417, -45.306374), (8.110583, -27.778513, -40.77466), (8.110583, -27.778513, -40.77466), (9.011998, -19.13417, -45.306374), (17.67767, -19.13417, -42.67767), (15.909483, -27.778513, -38.408886), (15.909483, -27.778513, -38.408886), (17.67767, -19.13417, -42.67767), (25.664, -19.13417, -38.408886), (23.096987, -27.778513, -34.567085), (23.096987, -27.778513, -34.567085), (25.664, -19.13417, -38.408886), (32.664074, -19.13417, -32.664074), (29.396889, -27.778513, -29.396889), (29.396889, -27.778513, -29.396889), (32.664074, -19.13417, -32.664074), (38.408886, -19.13417, -25.664), (34.567085, -27.778513, -23.096987), (34.567085, -27.778513, -23.096987), (38.408886, -19.13417, -25.664), (42.67767, -19.13417, -17.67767), (38.408886, -27.778513, -15.909483), (38.408886, -27.778513, -15.909483), (42.67767, -19.13417, -17.67767), (45.306374, -19.13417, -9.011998), (40.77466, -27.778513, -8.110583), (40.77466, -27.778513, -8.110583), (45.306374, -19.13417, -9.011998), (46.193974, -19.13417, 0), (41.57348, -27.778513, 0), (46.193974, -19.13417, 0), (49.03926, -9.754517, 0), (48.09699, -9.754517, 9.567085), (45.306374, -19.13417, 9.011998), (45.306374, -19.13417, 9.011998), (48.09699, -9.754517, 9.567085), (45.306374, -9.754517, 18.766514), (42.67767, -19.13417, 17.67767), (42.67767, -19.13417, 17.67767), (45.306374, -9.754517, 18.766514), (40.77466, -9.754517, 27.244755), (38.408886, -19.13417, 25.664), (38.408886, -19.13417, 25.664), (40.77466, -9.754517, 27.244755), (34.676, -9.754517, 34.676), (32.664074, -19.13417, 32.664074), (32.664074, -19.13417, 32.664074), (34.676, -9.754517, 34.676), (27.244755, -9.754517, 40.77466), (25.664, -19.13417, 38.408886), (25.664, -19.13417, 38.408886), (27.244755, -9.754517, 40.77466), (18.766514, -9.754517, 45.306374), (17.67767, -19.13417, 42.67767), (17.67767, -19.13417, 42.67767), (18.766514, -9.754517, 45.306374), (9.567085, -9.754517, 48.09699), (9.011998, -19.13417, 45.306374), (9.011998, -19.13417, 45.306374), (9.567085, -9.754517, 48.09699), (3.002789e-15, -9.754517, 49.03926), (2.8285653e-15, -19.13417, 46.193974), (2.8285653e-15, -19.13417, 46.193974), (3.002789e-15, -9.754517, 49.03926), (-9.567085, -9.754517, 48.09699), (-9.011998, -19.13417, 45.306374), (-9.011998, -19.13417, 45.306374), (-9.567085, -9.754517, 48.09699), (-18.766514, -9.754517, 45.306374), (-17.67767, -19.13417, 42.67767), (-17.67767, -19.13417, 42.67767), (-18.766514, -9.754517, 45.306374), (-27.244755, -9.754517, 40.77466), (-25.664, -19.13417, 38.408886), (-25.664, -19.13417, 38.408886), (-27.244755, -9.754517, 40.77466), (-34.676, -9.754517, 34.676), (-32.664074, -19.13417, 32.664074), (-32.664074, -19.13417, 32.664074), (-34.676, -9.754517, 34.676), (-40.77466, -9.754517, 27.244755), (-38.408886, -19.13417, 25.664), (-38.408886, -19.13417, 25.664), (-40.77466, -9.754517, 27.244755), (-45.306374, -9.754517, 18.766514), (-42.67767, -19.13417, 17.67767), (-42.67767, -19.13417, 17.67767), (-45.306374, -9.754517, 18.766514), (-48.09699, -9.754517, 9.567085), (-45.306374, -19.13417, 9.011998), (-45.306374, -19.13417, 9.011998), (-48.09699, -9.754517, 9.567085), (-49.03926, -9.754517, 6.005578e-15), (-46.193974, -19.13417, 5.6571306e-15), (-46.193974, -19.13417, 5.6571306e-15), (-49.03926, -9.754517, 6.005578e-15), (-48.09699, -9.754517, -9.567085), (-45.306374, -19.13417, -9.011998), (-45.306374, -19.13417, -9.011998), (-48.09699, -9.754517, -9.567085), (-45.306374, -9.754517, -18.766514), (-42.67767, -19.13417, -17.67767), (-42.67767, -19.13417, -17.67767), (-45.306374, -9.754517, -18.766514), (-40.77466, -9.754517, -27.244755), (-38.408886, -19.13417, -25.664), (-38.408886, -19.13417, -25.664), (-40.77466, -9.754517, -27.244755), (-34.676, -9.754517, -34.676), (-32.664074, -19.13417, -32.664074), (-32.664074, -19.13417, -32.664074), (-34.676, -9.754517, -34.676), (-27.244755, -9.754517, -40.77466), (-25.664, -19.13417, -38.408886), (-25.664, -19.13417, -38.408886), (-27.244755, -9.754517, -40.77466), (-18.766514, -9.754517, -45.306374), (-17.67767, -19.13417, -42.67767), (-17.67767, -19.13417, -42.67767), (-18.766514, -9.754517, -45.306374), (-9.567085, -9.754517, -48.09699), (-9.011998, -19.13417, -45.306374), (-9.011998, -19.13417, -45.306374), (-9.567085, -9.754517, -48.09699), (-9.0083665e-15, -9.754517, -49.03926), (-8.4856955e-15, -19.13417, -46.193974), (-8.4856955e-15, -19.13417, -46.193974), (-9.0083665e-15, -9.754517, -49.03926), (9.567085, -9.754517, -48.09699), (9.011998, -19.13417, -45.306374), (9.011998, -19.13417, -45.306374), (9.567085, -9.754517, -48.09699), (18.766514, -9.754517, -45.306374), (17.67767, -19.13417, -42.67767), (17.67767, -19.13417, -42.67767), (18.766514, -9.754517, -45.306374), (27.244755, -9.754517, -40.77466), (25.664, -19.13417, -38.408886), (25.664, -19.13417, -38.408886), (27.244755, -9.754517, -40.77466), (34.676, -9.754517, -34.676), (32.664074, -19.13417, -32.664074), (32.664074, -19.13417, -32.664074), (34.676, -9.754517, -34.676), (40.77466, -9.754517, -27.244755), (38.408886, -19.13417, -25.664), (38.408886, -19.13417, -25.664), (40.77466, -9.754517, -27.244755), (45.306374, -9.754517, -18.766514), (42.67767, -19.13417, -17.67767), (42.67767, -19.13417, -17.67767), (45.306374, -9.754517, -18.766514), (48.09699, -9.754517, -9.567085), (45.306374, -19.13417, -9.011998), (45.306374, -19.13417, -9.011998), (48.09699, -9.754517, -9.567085), (49.03926, -9.754517, 0), (46.193974, -19.13417, 0), (49.03926, -9.754517, 0), (50, 0, 0), (49.03926, 0, 9.754517), (48.09699, -9.754517, 9.567085), (48.09699, -9.754517, 9.567085), (49.03926, 0, 9.754517), (46.193974, 0, 19.13417), (45.306374, -9.754517, 18.766514), (45.306374, -9.754517, 18.766514), (46.193974, 0, 19.13417), (41.57348, 0, 27.778513), (40.77466, -9.754517, 27.244755), (40.77466, -9.754517, 27.244755), (41.57348, 0, 27.778513), (35.35534, 0, 35.35534), (34.676, -9.754517, 34.676), (34.676, -9.754517, 34.676), (35.35534, 0, 35.35534), (27.778513, 0, 41.57348), (27.244755, -9.754517, 40.77466), (27.244755, -9.754517, 40.77466), (27.778513, 0, 41.57348), (19.13417, 0, 46.193974), (18.766514, -9.754517, 45.306374), (18.766514, -9.754517, 45.306374), (19.13417, 0, 46.193974), (9.754517, 0, 49.03926), (9.567085, -9.754517, 48.09699), (9.567085, -9.754517, 48.09699), (9.754517, 0, 49.03926), (3.061617e-15, 0, 50), (3.002789e-15, -9.754517, 49.03926), (3.002789e-15, -9.754517, 49.03926), (3.061617e-15, 0, 50), (-9.754517, 0, 49.03926), (-9.567085, -9.754517, 48.09699), (-9.567085, -9.754517, 48.09699), (-9.754517, 0, 49.03926), (-19.13417, 0, 46.193974), (-18.766514, -9.754517, 45.306374), (-18.766514, -9.754517, 45.306374), (-19.13417, 0, 46.193974), (-27.778513, 0, 41.57348), (-27.244755, -9.754517, 40.77466), (-27.244755, -9.754517, 40.77466), (-27.778513, 0, 41.57348), (-35.35534, 0, 35.35534), (-34.676, -9.754517, 34.676), (-34.676, -9.754517, 34.676), (-35.35534, 0, 35.35534), (-41.57348, 0, 27.778513), (-40.77466, -9.754517, 27.244755), (-40.77466, -9.754517, 27.244755), (-41.57348, 0, 27.778513), (-46.193974, 0, 19.13417), (-45.306374, -9.754517, 18.766514), (-45.306374, -9.754517, 18.766514), (-46.193974, 0, 19.13417), (-49.03926, 0, 9.754517), (-48.09699, -9.754517, 9.567085), (-48.09699, -9.754517, 9.567085), (-49.03926, 0, 9.754517), (-50, 0, 6.123234e-15), (-49.03926, -9.754517, 6.005578e-15), (-49.03926, -9.754517, 6.005578e-15), (-50, 0, 6.123234e-15), (-49.03926, 0, -9.754517), (-48.09699, -9.754517, -9.567085), (-48.09699, -9.754517, -9.567085), (-49.03926, 0, -9.754517), (-46.193974, 0, -19.13417), (-45.306374, -9.754517, -18.766514), (-45.306374, -9.754517, -18.766514), (-46.193974, 0, -19.13417), (-41.57348, 0, -27.778513), (-40.77466, -9.754517, -27.244755), (-40.77466, -9.754517, -27.244755), (-41.57348, 0, -27.778513), (-35.35534, 0, -35.35534), (-34.676, -9.754517, -34.676), (-34.676, -9.754517, -34.676), (-35.35534, 0, -35.35534), (-27.778513, 0, -41.57348), (-27.244755, -9.754517, -40.77466), (-27.244755, -9.754517, -40.77466), (-27.778513, 0, -41.57348), (-19.13417, 0, -46.193974), (-18.766514, -9.754517, -45.306374), (-18.766514, -9.754517, -45.306374), (-19.13417, 0, -46.193974), (-9.754517, 0, -49.03926), (-9.567085, -9.754517, -48.09699), (-9.567085, -9.754517, -48.09699), (-9.754517, 0, -49.03926), (-9.184851e-15, 0, -50), (-9.0083665e-15, -9.754517, -49.03926), (-9.0083665e-15, -9.754517, -49.03926), (-9.184851e-15, 0, -50), (9.754517, 0, -49.03926), (9.567085, -9.754517, -48.09699), (9.567085, -9.754517, -48.09699), (9.754517, 0, -49.03926), (19.13417, 0, -46.193974), (18.766514, -9.754517, -45.306374), (18.766514, -9.754517, -45.306374), (19.13417, 0, -46.193974), (27.778513, 0, -41.57348), (27.244755, -9.754517, -40.77466), (27.244755, -9.754517, -40.77466), (27.778513, 0, -41.57348), (35.35534, 0, -35.35534), (34.676, -9.754517, -34.676), (34.676, -9.754517, -34.676), (35.35534, 0, -35.35534), (41.57348, 0, -27.778513), (40.77466, -9.754517, -27.244755), (40.77466, -9.754517, -27.244755), (41.57348, 0, -27.778513), (46.193974, 0, -19.13417), (45.306374, -9.754517, -18.766514), (45.306374, -9.754517, -18.766514), (46.193974, 0, -19.13417), (49.03926, 0, -9.754517), (48.09699, -9.754517, -9.567085), (48.09699, -9.754517, -9.567085), (49.03926, 0, -9.754517), (50, 0, 0), (49.03926, -9.754517, 0), (50, 0, 0), (49.03926, 9.754517, 0), (48.09699, 9.754517, 9.567085), (49.03926, 0, 9.754517), (49.03926, 0, 9.754517), (48.09699, 9.754517, 9.567085), (45.306374, 9.754517, 18.766514), (46.193974, 0, 19.13417), (46.193974, 0, 19.13417), (45.306374, 9.754517, 18.766514), (40.77466, 9.754517, 27.244755), (41.57348, 0, 27.778513), (41.57348, 0, 27.778513), (40.77466, 9.754517, 27.244755), (34.676, 9.754517, 34.676), (35.35534, 0, 35.35534), (35.35534, 0, 35.35534), (34.676, 9.754517, 34.676), (27.244755, 9.754517, 40.77466), (27.778513, 0, 41.57348), (27.778513, 0, 41.57348), (27.244755, 9.754517, 40.77466), (18.766514, 9.754517, 45.306374), (19.13417, 0, 46.193974), (19.13417, 0, 46.193974), (18.766514, 9.754517, 45.306374), (9.567085, 9.754517, 48.09699), (9.754517, 0, 49.03926), (9.754517, 0, 49.03926), (9.567085, 9.754517, 48.09699), (3.002789e-15, 9.754517, 49.03926), (3.061617e-15, 0, 50), (3.061617e-15, 0, 50), (3.002789e-15, 9.754517, 49.03926), (-9.567085, 9.754517, 48.09699), (-9.754517, 0, 49.03926), (-9.754517, 0, 49.03926), (-9.567085, 9.754517, 48.09699), (-18.766514, 9.754517, 45.306374), (-19.13417, 0, 46.193974), (-19.13417, 0, 46.193974), (-18.766514, 9.754517, 45.306374), (-27.244755, 9.754517, 40.77466), (-27.778513, 0, 41.57348), (-27.778513, 0, 41.57348), (-27.244755, 9.754517, 40.77466), (-34.676, 9.754517, 34.676), (-35.35534, 0, 35.35534), (-35.35534, 0, 35.35534), (-34.676, 9.754517, 34.676), (-40.77466, 9.754517, 27.244755), (-41.57348, 0, 27.778513), (-41.57348, 0, 27.778513), (-40.77466, 9.754517, 27.244755), (-45.306374, 9.754517, 18.766514), (-46.193974, 0, 19.13417), (-46.193974, 0, 19.13417), (-45.306374, 9.754517, 18.766514), (-48.09699, 9.754517, 9.567085), (-49.03926, 0, 9.754517), (-49.03926, 0, 9.754517), (-48.09699, 9.754517, 9.567085), (-49.03926, 9.754517, 6.005578e-15), (-50, 0, 6.123234e-15), (-50, 0, 6.123234e-15), (-49.03926, 9.754517, 6.005578e-15), (-48.09699, 9.754517, -9.567085), (-49.03926, 0, -9.754517), (-49.03926, 0, -9.754517), (-48.09699, 9.754517, -9.567085), (-45.306374, 9.754517, -18.766514), (-46.193974, 0, -19.13417), (-46.193974, 0, -19.13417), (-45.306374, 9.754517, -18.766514), (-40.77466, 9.754517, -27.244755), (-41.57348, 0, -27.778513), (-41.57348, 0, -27.778513), (-40.77466, 9.754517, -27.244755), (-34.676, 9.754517, -34.676), (-35.35534, 0, -35.35534), (-35.35534, 0, -35.35534), (-34.676, 9.754517, -34.676), (-27.244755, 9.754517, -40.77466), (-27.778513, 0, -41.57348), (-27.778513, 0, -41.57348), (-27.244755, 9.754517, -40.77466), (-18.766514, 9.754517, -45.306374), (-19.13417, 0, -46.193974), (-19.13417, 0, -46.193974), (-18.766514, 9.754517, -45.306374), (-9.567085, 9.754517, -48.09699), (-9.754517, 0, -49.03926), (-9.754517, 0, -49.03926), (-9.567085, 9.754517, -48.09699), (-9.0083665e-15, 9.754517, -49.03926), (-9.184851e-15, 0, -50), (-9.184851e-15, 0, -50), (-9.0083665e-15, 9.754517, -49.03926), (9.567085, 9.754517, -48.09699), (9.754517, 0, -49.03926), (9.754517, 0, -49.03926), (9.567085, 9.754517, -48.09699), (18.766514, 9.754517, -45.306374), (19.13417, 0, -46.193974), (19.13417, 0, -46.193974), (18.766514, 9.754517, -45.306374), (27.244755, 9.754517, -40.77466), (27.778513, 0, -41.57348), (27.778513, 0, -41.57348), (27.244755, 9.754517, -40.77466), (34.676, 9.754517, -34.676), (35.35534, 0, -35.35534), (35.35534, 0, -35.35534), (34.676, 9.754517, -34.676), (40.77466, 9.754517, -27.244755), (41.57348, 0, -27.778513), (41.57348, 0, -27.778513), (40.77466, 9.754517, -27.244755), (45.306374, 9.754517, -18.766514), (46.193974, 0, -19.13417), (46.193974, 0, -19.13417), (45.306374, 9.754517, -18.766514), (48.09699, 9.754517, -9.567085), (49.03926, 0, -9.754517), (49.03926, 0, -9.754517), (48.09699, 9.754517, -9.567085), (49.03926, 9.754517, 0), (50, 0, 0), (49.03926, 9.754517, 0), (46.193974, 19.13417, 0), (45.306374, 19.13417, 9.011998), (48.09699, 9.754517, 9.567085), (48.09699, 9.754517, 9.567085), (45.306374, 19.13417, 9.011998), (42.67767, 19.13417, 17.67767), (45.306374, 9.754517, 18.766514), (45.306374, 9.754517, 18.766514), (42.67767, 19.13417, 17.67767), (38.408886, 19.13417, 25.664), (40.77466, 9.754517, 27.244755), (40.77466, 9.754517, 27.244755), (38.408886, 19.13417, 25.664), (32.664074, 19.13417, 32.664074), (34.676, 9.754517, 34.676), (34.676, 9.754517, 34.676), (32.664074, 19.13417, 32.664074), (25.664, 19.13417, 38.408886), (27.244755, 9.754517, 40.77466), (27.244755, 9.754517, 40.77466), (25.664, 19.13417, 38.408886), (17.67767, 19.13417, 42.67767), (18.766514, 9.754517, 45.306374), (18.766514, 9.754517, 45.306374), (17.67767, 19.13417, 42.67767), (9.011998, 19.13417, 45.306374), (9.567085, 9.754517, 48.09699), (9.567085, 9.754517, 48.09699), (9.011998, 19.13417, 45.306374), (2.8285653e-15, 19.13417, 46.193974), (3.002789e-15, 9.754517, 49.03926), (3.002789e-15, 9.754517, 49.03926), (2.8285653e-15, 19.13417, 46.193974), (-9.011998, 19.13417, 45.306374), (-9.567085, 9.754517, 48.09699), (-9.567085, 9.754517, 48.09699), (-9.011998, 19.13417, 45.306374), (-17.67767, 19.13417, 42.67767), (-18.766514, 9.754517, 45.306374), (-18.766514, 9.754517, 45.306374), (-17.67767, 19.13417, 42.67767), (-25.664, 19.13417, 38.408886), (-27.244755, 9.754517, 40.77466), (-27.244755, 9.754517, 40.77466), (-25.664, 19.13417, 38.408886), (-32.664074, 19.13417, 32.664074), (-34.676, 9.754517, 34.676), (-34.676, 9.754517, 34.676), (-32.664074, 19.13417, 32.664074), (-38.408886, 19.13417, 25.664), (-40.77466, 9.754517, 27.244755), (-40.77466, 9.754517, 27.244755), (-38.408886, 19.13417, 25.664), (-42.67767, 19.13417, 17.67767), (-45.306374, 9.754517, 18.766514), (-45.306374, 9.754517, 18.766514), (-42.67767, 19.13417, 17.67767), (-45.306374, 19.13417, 9.011998), (-48.09699, 9.754517, 9.567085), (-48.09699, 9.754517, 9.567085), (-45.306374, 19.13417, 9.011998), (-46.193974, 19.13417, 5.6571306e-15), (-49.03926, 9.754517, 6.005578e-15), (-49.03926, 9.754517, 6.005578e-15), (-46.193974, 19.13417, 5.6571306e-15), (-45.306374, 19.13417, -9.011998), (-48.09699, 9.754517, -9.567085), (-48.09699, 9.754517, -9.567085), (-45.306374, 19.13417, -9.011998), (-42.67767, 19.13417, -17.67767), (-45.306374, 9.754517, -18.766514), (-45.306374, 9.754517, -18.766514), (-42.67767, 19.13417, -17.67767), (-38.408886, 19.13417, -25.664), (-40.77466, 9.754517, -27.244755), (-40.77466, 9.754517, -27.244755), (-38.408886, 19.13417, -25.664), (-32.664074, 19.13417, -32.664074), (-34.676, 9.754517, -34.676), (-34.676, 9.754517, -34.676), (-32.664074, 19.13417, -32.664074), (-25.664, 19.13417, -38.408886), (-27.244755, 9.754517, -40.77466), (-27.244755, 9.754517, -40.77466), (-25.664, 19.13417, -38.408886), (-17.67767, 19.13417, -42.67767), (-18.766514, 9.754517, -45.306374), (-18.766514, 9.754517, -45.306374), (-17.67767, 19.13417, -42.67767), (-9.011998, 19.13417, -45.306374), (-9.567085, 9.754517, -48.09699), (-9.567085, 9.754517, -48.09699), (-9.011998, 19.13417, -45.306374), (-8.4856955e-15, 19.13417, -46.193974), (-9.0083665e-15, 9.754517, -49.03926), (-9.0083665e-15, 9.754517, -49.03926), (-8.4856955e-15, 19.13417, -46.193974), (9.011998, 19.13417, -45.306374), (9.567085, 9.754517, -48.09699), (9.567085, 9.754517, -48.09699), (9.011998, 19.13417, -45.306374), (17.67767, 19.13417, -42.67767), (18.766514, 9.754517, -45.306374), (18.766514, 9.754517, -45.306374), (17.67767, 19.13417, -42.67767), (25.664, 19.13417, -38.408886), (27.244755, 9.754517, -40.77466), (27.244755, 9.754517, -40.77466), (25.664, 19.13417, -38.408886), (32.664074, 19.13417, -32.664074), (34.676, 9.754517, -34.676), (34.676, 9.754517, -34.676), (32.664074, 19.13417, -32.664074), (38.408886, 19.13417, -25.664), (40.77466, 9.754517, -27.244755), (40.77466, 9.754517, -27.244755), (38.408886, 19.13417, -25.664), (42.67767, 19.13417, -17.67767), (45.306374, 9.754517, -18.766514), (45.306374, 9.754517, -18.766514), (42.67767, 19.13417, -17.67767), (45.306374, 19.13417, -9.011998), (48.09699, 9.754517, -9.567085), (48.09699, 9.754517, -9.567085), (45.306374, 19.13417, -9.011998), (46.193974, 19.13417, 0), (49.03926, 9.754517, 0), (46.193974, 19.13417, 0), (41.57348, 27.778513, 0), (40.77466, 27.778513, 8.110583), (45.306374, 19.13417, 9.011998), (45.306374, 19.13417, 9.011998), (40.77466, 27.778513, 8.110583), (38.408886, 27.778513, 15.909483), (42.67767, 19.13417, 17.67767), (42.67767, 19.13417, 17.67767), (38.408886, 27.778513, 15.909483), (34.567085, 27.778513, 23.096987), (38.408886, 19.13417, 25.664), (38.408886, 19.13417, 25.664), (34.567085, 27.778513, 23.096987), (29.396889, 27.778513, 29.396889), (32.664074, 19.13417, 32.664074), (32.664074, 19.13417, 32.664074), (29.396889, 27.778513, 29.396889), (23.096987, 27.778513, 34.567085), (25.664, 19.13417, 38.408886), (25.664, 19.13417, 38.408886), (23.096987, 27.778513, 34.567085), (15.909483, 27.778513, 38.408886), (17.67767, 19.13417, 42.67767), (17.67767, 19.13417, 42.67767), (15.909483, 27.778513, 38.408886), (8.110583, 27.778513, 40.77466), (9.011998, 19.13417, 45.306374), (9.011998, 19.13417, 45.306374), (8.110583, 27.778513, 40.77466), (2.5456415e-15, 27.778513, 41.57348), (2.8285653e-15, 19.13417, 46.193974), (2.8285653e-15, 19.13417, 46.193974), (2.5456415e-15, 27.778513, 41.57348), (-8.110583, 27.778513, 40.77466), (-9.011998, 19.13417, 45.306374), (-9.011998, 19.13417, 45.306374), (-8.110583, 27.778513, 40.77466), (-15.909483, 27.778513, 38.408886), (-17.67767, 19.13417, 42.67767), (-17.67767, 19.13417, 42.67767), (-15.909483, 27.778513, 38.408886), (-23.096987, 27.778513, 34.567085), (-25.664, 19.13417, 38.408886), (-25.664, 19.13417, 38.408886), (-23.096987, 27.778513, 34.567085), (-29.396889, 27.778513, 29.396889), (-32.664074, 19.13417, 32.664074), (-32.664074, 19.13417, 32.664074), (-29.396889, 27.778513, 29.396889), (-34.567085, 27.778513, 23.096987), (-38.408886, 19.13417, 25.664), (-38.408886, 19.13417, 25.664), (-34.567085, 27.778513, 23.096987), (-38.408886, 27.778513, 15.909483), (-42.67767, 19.13417, 17.67767), (-42.67767, 19.13417, 17.67767), (-38.408886, 27.778513, 15.909483), (-40.77466, 27.778513, 8.110583), (-45.306374, 19.13417, 9.011998), (-45.306374, 19.13417, 9.011998), (-40.77466, 27.778513, 8.110583), (-41.57348, 27.778513, 5.091283e-15), (-46.193974, 19.13417, 5.6571306e-15), (-46.193974, 19.13417, 5.6571306e-15), (-41.57348, 27.778513, 5.091283e-15), (-40.77466, 27.778513, -8.110583), (-45.306374, 19.13417, -9.011998), (-45.306374, 19.13417, -9.011998), (-40.77466, 27.778513, -8.110583), (-38.408886, 27.778513, -15.909483), (-42.67767, 19.13417, -17.67767), (-42.67767, 19.13417, -17.67767), (-38.408886, 27.778513, -15.909483), (-34.567085, 27.778513, -23.096987), (-38.408886, 19.13417, -25.664), (-38.408886, 19.13417, -25.664), (-34.567085, 27.778513, -23.096987), (-29.396889, 27.778513, -29.396889), (-32.664074, 19.13417, -32.664074), (-32.664074, 19.13417, -32.664074), (-29.396889, 27.778513, -29.396889), (-23.096987, 27.778513, -34.567085), (-25.664, 19.13417, -38.408886), (-25.664, 19.13417, -38.408886), (-23.096987, 27.778513, -34.567085), (-15.909483, 27.778513, -38.408886), (-17.67767, 19.13417, -42.67767), (-17.67767, 19.13417, -42.67767), (-15.909483, 27.778513, -38.408886), (-8.110583, 27.778513, -40.77466), (-9.011998, 19.13417, -45.306374), (-9.011998, 19.13417, -45.306374), (-8.110583, 27.778513, -40.77466), (-7.6369244e-15, 27.778513, -41.57348), (-8.4856955e-15, 19.13417, -46.193974), (-8.4856955e-15, 19.13417, -46.193974), (-7.6369244e-15, 27.778513, -41.57348), (8.110583, 27.778513, -40.77466), (9.011998, 19.13417, -45.306374), (9.011998, 19.13417, -45.306374), (8.110583, 27.778513, -40.77466), (15.909483, 27.778513, -38.408886), (17.67767, 19.13417, -42.67767), (17.67767, 19.13417, -42.67767), (15.909483, 27.778513, -38.408886), (23.096987, 27.778513, -34.567085), (25.664, 19.13417, -38.408886), (25.664, 19.13417, -38.408886), (23.096987, 27.778513, -34.567085), (29.396889, 27.778513, -29.396889), (32.664074, 19.13417, -32.664074), (32.664074, 19.13417, -32.664074), (29.396889, 27.778513, -29.396889), (34.567085, 27.778513, -23.096987), (38.408886, 19.13417, -25.664), (38.408886, 19.13417, -25.664), (34.567085, 27.778513, -23.096987), (38.408886, 27.778513, -15.909483), (42.67767, 19.13417, -17.67767), (42.67767, 19.13417, -17.67767), (38.408886, 27.778513, -15.909483), (40.77466, 27.778513, -8.110583), (45.306374, 19.13417, -9.011998), (45.306374, 19.13417, -9.011998), (40.77466, 27.778513, -8.110583), (41.57348, 27.778513, 0), (46.193974, 19.13417, 0), (41.57348, 27.778513, 0), (35.35534, 35.35534, 0), (34.676, 35.35534, 6.8974843), (40.77466, 27.778513, 8.110583), (40.77466, 27.778513, 8.110583), (34.676, 35.35534, 6.8974843), (32.664074, 35.35534, 13.529902), (38.408886, 27.778513, 15.909483), (38.408886, 27.778513, 15.909483), (32.664074, 35.35534, 13.529902), (29.396889, 35.35534, 19.642374), (34.567085, 27.778513, 23.096987), (34.567085, 27.778513, 23.096987), (29.396889, 35.35534, 19.642374), (25, 35.35534, 25), (29.396889, 27.778513, 29.396889), (29.396889, 27.778513, 29.396889), (25, 35.35534, 25), (19.642374, 35.35534, 29.396889), (23.096987, 27.778513, 34.567085), (23.096987, 27.778513, 34.567085), (19.642374, 35.35534, 29.396889), (13.529902, 35.35534, 32.664074), (15.909483, 27.778513, 38.408886), (15.909483, 27.778513, 38.408886), (13.529902, 35.35534, 32.664074), (6.8974843, 35.35534, 34.676), (8.110583, 27.778513, 40.77466), (8.110583, 27.778513, 40.77466), (6.8974843, 35.35534, 34.676), (2.1648902e-15, 35.35534, 35.35534), (2.5456415e-15, 27.778513, 41.57348), (2.5456415e-15, 27.778513, 41.57348), (2.1648902e-15, 35.35534, 35.35534), (-6.8974843, 35.35534, 34.676), (-8.110583, 27.778513, 40.77466), (-8.110583, 27.778513, 40.77466), (-6.8974843, 35.35534, 34.676), (-13.529902, 35.35534, 32.664074), (-15.909483, 27.778513, 38.408886), (-15.909483, 27.778513, 38.408886), (-13.529902, 35.35534, 32.664074), (-19.642374, 35.35534, 29.396889), (-23.096987, 27.778513, 34.567085), (-23.096987, 27.778513, 34.567085), (-19.642374, 35.35534, 29.396889), (-25, 35.35534, 25), (-29.396889, 27.778513, 29.396889), (-29.396889, 27.778513, 29.396889), (-25, 35.35534, 25), (-29.396889, 35.35534, 19.642374), (-34.567085, 27.778513, 23.096987), (-34.567085, 27.778513, 23.096987), (-29.396889, 35.35534, 19.642374), (-32.664074, 35.35534, 13.529902), (-38.408886, 27.778513, 15.909483), (-38.408886, 27.778513, 15.909483), (-32.664074, 35.35534, 13.529902), (-34.676, 35.35534, 6.8974843), (-40.77466, 27.778513, 8.110583), (-40.77466, 27.778513, 8.110583), (-34.676, 35.35534, 6.8974843), (-35.35534, 35.35534, 4.3297804e-15), (-41.57348, 27.778513, 5.091283e-15), (-41.57348, 27.778513, 5.091283e-15), (-35.35534, 35.35534, 4.3297804e-15), (-34.676, 35.35534, -6.8974843), (-40.77466, 27.778513, -8.110583), (-40.77466, 27.778513, -8.110583), (-34.676, 35.35534, -6.8974843), (-32.664074, 35.35534, -13.529902), (-38.408886, 27.778513, -15.909483), (-38.408886, 27.778513, -15.909483), (-32.664074, 35.35534, -13.529902), (-29.396889, 35.35534, -19.642374), (-34.567085, 27.778513, -23.096987), (-34.567085, 27.778513, -23.096987), (-29.396889, 35.35534, -19.642374), (-25, 35.35534, -25), (-29.396889, 27.778513, -29.396889), (-29.396889, 27.778513, -29.396889), (-25, 35.35534, -25), (-19.642374, 35.35534, -29.396889), (-23.096987, 27.778513, -34.567085), (-23.096987, 27.778513, -34.567085), (-19.642374, 35.35534, -29.396889), (-13.529902, 35.35534, -32.664074), (-15.909483, 27.778513, -38.408886), (-15.909483, 27.778513, -38.408886), (-13.529902, 35.35534, -32.664074), (-6.8974843, 35.35534, -34.676), (-8.110583, 27.778513, -40.77466), (-8.110583, 27.778513, -40.77466), (-6.8974843, 35.35534, -34.676), (-6.49467e-15, 35.35534, -35.35534), (-7.6369244e-15, 27.778513, -41.57348), (-7.6369244e-15, 27.778513, -41.57348), (-6.49467e-15, 35.35534, -35.35534), (6.8974843, 35.35534, -34.676), (8.110583, 27.778513, -40.77466), (8.110583, 27.778513, -40.77466), (6.8974843, 35.35534, -34.676), (13.529902, 35.35534, -32.664074), (15.909483, 27.778513, -38.408886), (15.909483, 27.778513, -38.408886), (13.529902, 35.35534, -32.664074), (19.642374, 35.35534, -29.396889), (23.096987, 27.778513, -34.567085), (23.096987, 27.778513, -34.567085), (19.642374, 35.35534, -29.396889), (25, 35.35534, -25), (29.396889, 27.778513, -29.396889), (29.396889, 27.778513, -29.396889), (25, 35.35534, -25), (29.396889, 35.35534, -19.642374), (34.567085, 27.778513, -23.096987), (34.567085, 27.778513, -23.096987), (29.396889, 35.35534, -19.642374), (32.664074, 35.35534, -13.529902), (38.408886, 27.778513, -15.909483), (38.408886, 27.778513, -15.909483), (32.664074, 35.35534, -13.529902), (34.676, 35.35534, -6.8974843), (40.77466, 27.778513, -8.110583), (40.77466, 27.778513, -8.110583), (34.676, 35.35534, -6.8974843), (35.35534, 35.35534, 0), (41.57348, 27.778513, 0), (35.35534, 35.35534, 0), (27.778513, 41.57348, 0), (27.244755, 41.57348, 5.4193187), (34.676, 35.35534, 6.8974843), (34.676, 35.35534, 6.8974843), (27.244755, 41.57348, 5.4193187), (25.664, 41.57348, 10.630376), (32.664074, 35.35534, 13.529902), (32.664074, 35.35534, 13.529902), (25.664, 41.57348, 10.630376), (23.096987, 41.57348, 15.432914), (29.396889, 35.35534, 19.642374), (29.396889, 35.35534, 19.642374), (23.096987, 41.57348, 15.432914), (19.642374, 41.57348, 19.642374), (25, 35.35534, 25), (25, 35.35534, 25), (19.642374, 41.57348, 19.642374), (15.432914, 41.57348, 23.096987), (19.642374, 35.35534, 29.396889), (19.642374, 35.35534, 29.396889), (15.432914, 41.57348, 23.096987), (10.630376, 41.57348, 25.664), (13.529902, 35.35534, 32.664074), (13.529902, 35.35534, 32.664074), (10.630376, 41.57348, 25.664), (5.4193187, 41.57348, 27.244755), (6.8974843, 35.35534, 34.676), (6.8974843, 35.35534, 34.676), (5.4193187, 41.57348, 27.244755), (1.7009433e-15, 41.57348, 27.778513), (2.1648902e-15, 35.35534, 35.35534), (2.1648902e-15, 35.35534, 35.35534), (1.7009433e-15, 41.57348, 27.778513), (-5.4193187, 41.57348, 27.244755), (-6.8974843, 35.35534, 34.676), (-6.8974843, 35.35534, 34.676), (-5.4193187, 41.57348, 27.244755), (-10.630376, 41.57348, 25.664), (-13.529902, 35.35534, 32.664074), (-13.529902, 35.35534, 32.664074), (-10.630376, 41.57348, 25.664), (-15.432914, 41.57348, 23.096987), (-19.642374, 35.35534, 29.396889), (-19.642374, 35.35534, 29.396889), (-15.432914, 41.57348, 23.096987), (-19.642374, 41.57348, 19.642374), (-25, 35.35534, 25), (-25, 35.35534, 25), (-19.642374, 41.57348, 19.642374), (-23.096987, 41.57348, 15.432914), (-29.396889, 35.35534, 19.642374), (-29.396889, 35.35534, 19.642374), (-23.096987, 41.57348, 15.432914), (-25.664, 41.57348, 10.630376), (-32.664074, 35.35534, 13.529902), (-32.664074, 35.35534, 13.529902), (-25.664, 41.57348, 10.630376), (-27.244755, 41.57348, 5.4193187), (-34.676, 35.35534, 6.8974843), (-34.676, 35.35534, 6.8974843), (-27.244755, 41.57348, 5.4193187), (-27.778513, 41.57348, 3.4018865e-15), (-35.35534, 35.35534, 4.3297804e-15), (-35.35534, 35.35534, 4.3297804e-15), (-27.778513, 41.57348, 3.4018865e-15), (-27.244755, 41.57348, -5.4193187), (-34.676, 35.35534, -6.8974843), (-34.676, 35.35534, -6.8974843), (-27.244755, 41.57348, -5.4193187), (-25.664, 41.57348, -10.630376), (-32.664074, 35.35534, -13.529902), (-32.664074, 35.35534, -13.529902), (-25.664, 41.57348, -10.630376), (-23.096987, 41.57348, -15.432914), (-29.396889, 35.35534, -19.642374), (-29.396889, 35.35534, -19.642374), (-23.096987, 41.57348, -15.432914), (-19.642374, 41.57348, -19.642374), (-25, 35.35534, -25), (-25, 35.35534, -25), (-19.642374, 41.57348, -19.642374), (-15.432914, 41.57348, -23.096987), (-19.642374, 35.35534, -29.396889), (-19.642374, 35.35534, -29.396889), (-15.432914, 41.57348, -23.096987), (-10.630376, 41.57348, -25.664), (-13.529902, 35.35534, -32.664074), (-13.529902, 35.35534, -32.664074), (-10.630376, 41.57348, -25.664), (-5.4193187, 41.57348, -27.244755), (-6.8974843, 35.35534, -34.676), (-6.8974843, 35.35534, -34.676), (-5.4193187, 41.57348, -27.244755), (-5.1028297e-15, 41.57348, -27.778513), (-6.49467e-15, 35.35534, -35.35534), (-6.49467e-15, 35.35534, -35.35534), (-5.1028297e-15, 41.57348, -27.778513), (5.4193187, 41.57348, -27.244755), (6.8974843, 35.35534, -34.676), (6.8974843, 35.35534, -34.676), (5.4193187, 41.57348, -27.244755), (10.630376, 41.57348, -25.664), (13.529902, 35.35534, -32.664074), (13.529902, 35.35534, -32.664074), (10.630376, 41.57348, -25.664), (15.432914, 41.57348, -23.096987), (19.642374, 35.35534, -29.396889), (19.642374, 35.35534, -29.396889), (15.432914, 41.57348, -23.096987), (19.642374, 41.57348, -19.642374), (25, 35.35534, -25), (25, 35.35534, -25), (19.642374, 41.57348, -19.642374), (23.096987, 41.57348, -15.432914), (29.396889, 35.35534, -19.642374), (29.396889, 35.35534, -19.642374), (23.096987, 41.57348, -15.432914), (25.664, 41.57348, -10.630376), (32.664074, 35.35534, -13.529902), (32.664074, 35.35534, -13.529902), (25.664, 41.57348, -10.630376), (27.244755, 41.57348, -5.4193187), (34.676, 35.35534, -6.8974843), (34.676, 35.35534, -6.8974843), (27.244755, 41.57348, -5.4193187), (27.778513, 41.57348, 0), (35.35534, 35.35534, 0), (27.778513, 41.57348, 0), (19.13417, 46.193974, 0), (18.766514, 46.193974, 3.7328918), (27.244755, 41.57348, 5.4193187), (27.244755, 41.57348, 5.4193187), (18.766514, 46.193974, 3.7328918), (17.67767, 46.193974, 7.322331), (25.664, 41.57348, 10.630376), (25.664, 41.57348, 10.630376), (17.67767, 46.193974, 7.322331), (15.909483, 46.193974, 10.630376), (23.096987, 41.57348, 15.432914), (23.096987, 41.57348, 15.432914), (15.909483, 46.193974, 10.630376), (13.529902, 46.193974, 13.529902), (19.642374, 41.57348, 19.642374), (19.642374, 41.57348, 19.642374), (13.529902, 46.193974, 13.529902), (10.630376, 46.193974, 15.909483), (15.432914, 41.57348, 23.096987), (15.432914, 41.57348, 23.096987), (10.630376, 46.193974, 15.909483), (7.322331, 46.193974, 17.67767), (10.630376, 41.57348, 25.664), (10.630376, 41.57348, 25.664), (7.322331, 46.193974, 17.67767), (3.7328918, 46.193974, 18.766514), (5.4193187, 41.57348, 27.244755), (5.4193187, 41.57348, 27.244755), (3.7328918, 46.193974, 18.766514), (1.1716302e-15, 46.193974, 19.13417), (1.7009433e-15, 41.57348, 27.778513), (1.7009433e-15, 41.57348, 27.778513), (1.1716302e-15, 46.193974, 19.13417), (-3.7328918, 46.193974, 18.766514), (-5.4193187, 41.57348, 27.244755), (-5.4193187, 41.57348, 27.244755), (-3.7328918, 46.193974, 18.766514), (-7.322331, 46.193974, 17.67767), (-10.630376, 41.57348, 25.664), (-10.630376, 41.57348, 25.664), (-7.322331, 46.193974, 17.67767), (-10.630376, 46.193974, 15.909483), (-15.432914, 41.57348, 23.096987), (-15.432914, 41.57348, 23.096987), (-10.630376, 46.193974, 15.909483), (-13.529902, 46.193974, 13.529902), (-19.642374, 41.57348, 19.642374), (-19.642374, 41.57348, 19.642374), (-13.529902, 46.193974, 13.529902), (-15.909483, 46.193974, 10.630376), (-23.096987, 41.57348, 15.432914), (-23.096987, 41.57348, 15.432914), (-15.909483, 46.193974, 10.630376), (-17.67767, 46.193974, 7.322331), (-25.664, 41.57348, 10.630376), (-25.664, 41.57348, 10.630376), (-17.67767, 46.193974, 7.322331), (-18.766514, 46.193974, 3.7328918), (-27.244755, 41.57348, 5.4193187), (-27.244755, 41.57348, 5.4193187), (-18.766514, 46.193974, 3.7328918), (-19.13417, 46.193974, 2.3432603e-15), (-27.778513, 41.57348, 3.4018865e-15), (-27.778513, 41.57348, 3.4018865e-15), (-19.13417, 46.193974, 2.3432603e-15), (-18.766514, 46.193974, -3.7328918), (-27.244755, 41.57348, -5.4193187), (-27.244755, 41.57348, -5.4193187), (-18.766514, 46.193974, -3.7328918), (-17.67767, 46.193974, -7.322331), (-25.664, 41.57348, -10.630376), (-25.664, 41.57348, -10.630376), (-17.67767, 46.193974, -7.322331), (-15.909483, 46.193974, -10.630376), (-23.096987, 41.57348, -15.432914), (-23.096987, 41.57348, -15.432914), (-15.909483, 46.193974, -10.630376), (-13.529902, 46.193974, -13.529902), (-19.642374, 41.57348, -19.642374), (-19.642374, 41.57348, -19.642374), (-13.529902, 46.193974, -13.529902), (-10.630376, 46.193974, -15.909483), (-15.432914, 41.57348, -23.096987), (-15.432914, 41.57348, -23.096987), (-10.630376, 46.193974, -15.909483), (-7.322331, 46.193974, -17.67767), (-10.630376, 41.57348, -25.664), (-10.630376, 41.57348, -25.664), (-7.322331, 46.193974, -17.67767), (-3.7328918, 46.193974, -18.766514), (-5.4193187, 41.57348, -27.244755), (-5.4193187, 41.57348, -27.244755), (-3.7328918, 46.193974, -18.766514), (-3.5148903e-15, 46.193974, -19.13417), (-5.1028297e-15, 41.57348, -27.778513), (-5.1028297e-15, 41.57348, -27.778513), (-3.5148903e-15, 46.193974, -19.13417), (3.7328918, 46.193974, -18.766514), (5.4193187, 41.57348, -27.244755), (5.4193187, 41.57348, -27.244755), (3.7328918, 46.193974, -18.766514), (7.322331, 46.193974, -17.67767), (10.630376, 41.57348, -25.664), (10.630376, 41.57348, -25.664), (7.322331, 46.193974, -17.67767), (10.630376, 46.193974, -15.909483), (15.432914, 41.57348, -23.096987), (15.432914, 41.57348, -23.096987), (10.630376, 46.193974, -15.909483), (13.529902, 46.193974, -13.529902), (19.642374, 41.57348, -19.642374), (19.642374, 41.57348, -19.642374), (13.529902, 46.193974, -13.529902), (15.909483, 46.193974, -10.630376), (23.096987, 41.57348, -15.432914), (23.096987, 41.57348, -15.432914), (15.909483, 46.193974, -10.630376), (17.67767, 46.193974, -7.322331), (25.664, 41.57348, -10.630376), (25.664, 41.57348, -10.630376), (17.67767, 46.193974, -7.322331), (18.766514, 46.193974, -3.7328918), (27.244755, 41.57348, -5.4193187), (27.244755, 41.57348, -5.4193187), (18.766514, 46.193974, -3.7328918), (19.13417, 46.193974, 0), (27.778513, 41.57348, 0), (19.13417, 46.193974, 0), (9.754517, 49.03926, 0), (9.567085, 49.03926, 1.9030117), (18.766514, 46.193974, 3.7328918), (18.766514, 46.193974, 3.7328918), (9.567085, 49.03926, 1.9030117), (9.011998, 49.03926, 3.7328918), (17.67767, 46.193974, 7.322331), (17.67767, 46.193974, 7.322331), (9.011998, 49.03926, 3.7328918), (8.110583, 49.03926, 5.4193187), (15.909483, 46.193974, 10.630376), (15.909483, 46.193974, 10.630376), (8.110583, 49.03926, 5.4193187), (6.8974843, 49.03926, 6.8974843), (13.529902, 46.193974, 13.529902), (13.529902, 46.193974, 13.529902), (6.8974843, 49.03926, 6.8974843), (5.4193187, 49.03926, 8.110583), (10.630376, 46.193974, 15.909483), (10.630376, 46.193974, 15.909483), (5.4193187, 49.03926, 8.110583), (3.7328918, 49.03926, 9.011998), (7.322331, 46.193974, 17.67767), (7.322331, 46.193974, 17.67767), (3.7328918, 49.03926, 9.011998), (1.9030117, 49.03926, 9.567085), (3.7328918, 46.193974, 18.766514), (3.7328918, 46.193974, 18.766514), (1.9030117, 49.03926, 9.567085), (5.9729185e-16, 49.03926, 9.754517), (1.1716302e-15, 46.193974, 19.13417), (1.1716302e-15, 46.193974, 19.13417), (5.9729185e-16, 49.03926, 9.754517), (-1.9030117, 49.03926, 9.567085), (-3.7328918, 46.193974, 18.766514), (-3.7328918, 46.193974, 18.766514), (-1.9030117, 49.03926, 9.567085), (-3.7328918, 49.03926, 9.011998), (-7.322331, 46.193974, 17.67767), (-7.322331, 46.193974, 17.67767), (-3.7328918, 49.03926, 9.011998), (-5.4193187, 49.03926, 8.110583), (-10.630376, 46.193974, 15.909483), (-10.630376, 46.193974, 15.909483), (-5.4193187, 49.03926, 8.110583), (-6.8974843, 49.03926, 6.8974843), (-13.529902, 46.193974, 13.529902), (-13.529902, 46.193974, 13.529902), (-6.8974843, 49.03926, 6.8974843), (-8.110583, 49.03926, 5.4193187), (-15.909483, 46.193974, 10.630376), (-15.909483, 46.193974, 10.630376), (-8.110583, 49.03926, 5.4193187), (-9.011998, 49.03926, 3.7328918), (-17.67767, 46.193974, 7.322331), (-17.67767, 46.193974, 7.322331), (-9.011998, 49.03926, 3.7328918), (-9.567085, 49.03926, 1.9030117), (-18.766514, 46.193974, 3.7328918), (-18.766514, 46.193974, 3.7328918), (-9.567085, 49.03926, 1.9030117), (-9.754517, 49.03926, 1.1945837e-15), (-19.13417, 46.193974, 2.3432603e-15), (-19.13417, 46.193974, 2.3432603e-15), (-9.754517, 49.03926, 1.1945837e-15), (-9.567085, 49.03926, -1.9030117), (-18.766514, 46.193974, -3.7328918), (-18.766514, 46.193974, -3.7328918), (-9.567085, 49.03926, -1.9030117), (-9.011998, 49.03926, -3.7328918), (-17.67767, 46.193974, -7.322331), (-17.67767, 46.193974, -7.322331), (-9.011998, 49.03926, -3.7328918), (-8.110583, 49.03926, -5.4193187), (-15.909483, 46.193974, -10.630376), (-15.909483, 46.193974, -10.630376), (-8.110583, 49.03926, -5.4193187), (-6.8974843, 49.03926, -6.8974843), (-13.529902, 46.193974, -13.529902), (-13.529902, 46.193974, -13.529902), (-6.8974843, 49.03926, -6.8974843), (-5.4193187, 49.03926, -8.110583), (-10.630376, 46.193974, -15.909483), (-10.630376, 46.193974, -15.909483), (-5.4193187, 49.03926, -8.110583), (-3.7328918, 49.03926, -9.011998), (-7.322331, 46.193974, -17.67767), (-7.322331, 46.193974, -17.67767), (-3.7328918, 49.03926, -9.011998), (-1.9030117, 49.03926, -9.567085), (-3.7328918, 46.193974, -18.766514), (-3.7328918, 46.193974, -18.766514), (-1.9030117, 49.03926, -9.567085), (-1.7918755e-15, 49.03926, -9.754517), (-3.5148903e-15, 46.193974, -19.13417), (-3.5148903e-15, 46.193974, -19.13417), (-1.7918755e-15, 49.03926, -9.754517), (1.9030117, 49.03926, -9.567085), (3.7328918, 46.193974, -18.766514), (3.7328918, 46.193974, -18.766514), (1.9030117, 49.03926, -9.567085), (3.7328918, 49.03926, -9.011998), (7.322331, 46.193974, -17.67767), (7.322331, 46.193974, -17.67767), (3.7328918, 49.03926, -9.011998), (5.4193187, 49.03926, -8.110583), (10.630376, 46.193974, -15.909483), (10.630376, 46.193974, -15.909483), (5.4193187, 49.03926, -8.110583), (6.8974843, 49.03926, -6.8974843), (13.529902, 46.193974, -13.529902), (13.529902, 46.193974, -13.529902), (6.8974843, 49.03926, -6.8974843), (8.110583, 49.03926, -5.4193187), (15.909483, 46.193974, -10.630376), (15.909483, 46.193974, -10.630376), (8.110583, 49.03926, -5.4193187), (9.011998, 49.03926, -3.7328918), (17.67767, 46.193974, -7.322331), (17.67767, 46.193974, -7.322331), (9.011998, 49.03926, -3.7328918), (9.567085, 49.03926, -1.9030117), (18.766514, 46.193974, -3.7328918), (18.766514, 46.193974, -3.7328918), (9.567085, 49.03926, -1.9030117), (9.754517, 49.03926, 0), (19.13417, 46.193974, 0), (9.754517, 49.03926, 0), (0, 50, 0), (9.567085, 49.03926, 1.9030117), (9.567085, 49.03926, 1.9030117), (0, 50, 0), (9.011998, 49.03926, 3.7328918), (9.011998, 49.03926, 3.7328918), (0, 50, 0), (8.110583, 49.03926, 5.4193187), (8.110583, 49.03926, 5.4193187), (0, 50, 0), (6.8974843, 49.03926, 6.8974843), (6.8974843, 49.03926, 6.8974843), (0, 50, 0), (5.4193187, 49.03926, 8.110583), (5.4193187, 49.03926, 8.110583), (0, 50, 0), (3.7328918, 49.03926, 9.011998), (3.7328918, 49.03926, 9.011998), (0, 50, 0), (1.9030117, 49.03926, 9.567085), (1.9030117, 49.03926, 9.567085), (0, 50, 0), (5.9729185e-16, 49.03926, 9.754517), (5.9729185e-16, 49.03926, 9.754517), (0, 50, 0), (-1.9030117, 49.03926, 9.567085), (-1.9030117, 49.03926, 9.567085), (0, 50, 0), (-3.7328918, 49.03926, 9.011998), (-3.7328918, 49.03926, 9.011998), (0, 50, 0), (-5.4193187, 49.03926, 8.110583), (-5.4193187, 49.03926, 8.110583), (0, 50, 0), (-6.8974843, 49.03926, 6.8974843), (-6.8974843, 49.03926, 6.8974843), (0, 50, 0), (-8.110583, 49.03926, 5.4193187), (-8.110583, 49.03926, 5.4193187), (0, 50, 0), (-9.011998, 49.03926, 3.7328918), (-9.011998, 49.03926, 3.7328918), (0, 50, 0), (-9.567085, 49.03926, 1.9030117), (-9.567085, 49.03926, 1.9030117), (0, 50, 0), (-9.754517, 49.03926, 1.1945837e-15), (-9.754517, 49.03926, 1.1945837e-15), (0, 50, 0), (-9.567085, 49.03926, -1.9030117), (-9.567085, 49.03926, -1.9030117), (0, 50, 0), (-9.011998, 49.03926, -3.7328918), (-9.011998, 49.03926, -3.7328918), (0, 50, 0), (-8.110583, 49.03926, -5.4193187), (-8.110583, 49.03926, -5.4193187), (0, 50, 0), (-6.8974843, 49.03926, -6.8974843), (-6.8974843, 49.03926, -6.8974843), (0, 50, 0), (-5.4193187, 49.03926, -8.110583), (-5.4193187, 49.03926, -8.110583), (0, 50, 0), (-3.7328918, 49.03926, -9.011998), (-3.7328918, 49.03926, -9.011998), (0, 50, 0), (-1.9030117, 49.03926, -9.567085), (-1.9030117, 49.03926, -9.567085), (0, 50, 0), (-1.7918755e-15, 49.03926, -9.754517), (-1.7918755e-15, 49.03926, -9.754517), (0, 50, 0), (1.9030117, 49.03926, -9.567085), (1.9030117, 49.03926, -9.567085), (0, 50, 0), (3.7328918, 49.03926, -9.011998), (3.7328918, 49.03926, -9.011998), (0, 50, 0), (5.4193187, 49.03926, -8.110583), (5.4193187, 49.03926, -8.110583), (0, 50, 0), (6.8974843, 49.03926, -6.8974843), (6.8974843, 49.03926, -6.8974843), (0, 50, 0), (8.110583, 49.03926, -5.4193187), (8.110583, 49.03926, -5.4193187), (0, 50, 0), (9.011998, 49.03926, -3.7328918), (9.011998, 49.03926, -3.7328918), (0, 50, 0), (9.567085, 49.03926, -1.9030117), (9.567085, 49.03926, -1.9030117), (0, 50, 0), (9.754517, 49.03926, 0)] (
-            interpolation = "faceVarying"
-        )
-        point3f[] points = [(0, -50, 0), (9.754517, -49.03926, 0), (9.567085, -49.03926, 1.9030117), (9.011998, -49.03926, 3.7328918), (8.110583, -49.03926, 5.4193187), (6.8974843, -49.03926, 6.8974843), (5.4193187, -49.03926, 8.110583), (3.7328918, -49.03926, 9.011998), (1.9030117, -49.03926, 9.567085), (5.9729185e-16, -49.03926, 9.754517), (-1.9030117, -49.03926, 9.567085), (-3.7328918, -49.03926, 9.011998), (-5.4193187, -49.03926, 8.110583), (-6.8974843, -49.03926, 6.8974843), (-8.110583, -49.03926, 5.4193187), (-9.011998, -49.03926, 3.7328918), (-9.567085, -49.03926, 1.9030117), (-9.754517, -49.03926, 1.1945837e-15), (-9.567085, -49.03926, -1.9030117), (-9.011998, -49.03926, -3.7328918), (-8.110583, -49.03926, -5.4193187), (-6.8974843, -49.03926, -6.8974843), (-5.4193187, -49.03926, -8.110583), (-3.7328918, -49.03926, -9.011998), (-1.9030117, -49.03926, -9.567085), (-1.7918755e-15, -49.03926, -9.754517), (1.9030117, -49.03926, -9.567085), (3.7328918, -49.03926, -9.011998), (5.4193187, -49.03926, -8.110583), (6.8974843, -49.03926, -6.8974843), (8.110583, -49.03926, -5.4193187), (9.011998, -49.03926, -3.7328918), (9.567085, -49.03926, -1.9030117), (19.13417, -46.193974, 0), (18.766514, -46.193974, 3.7328918), (17.67767, -46.193974, 7.322331), (15.909483, -46.193974, 10.630376), (13.529902, -46.193974, 13.529902), (10.630376, -46.193974, 15.909483), (7.322331, -46.193974, 17.67767), (3.7328918, -46.193974, 18.766514), (1.1716302e-15, -46.193974, 19.13417), (-3.7328918, -46.193974, 18.766514), (-7.322331, -46.193974, 17.67767), (-10.630376, -46.193974, 15.909483), (-13.529902, -46.193974, 13.529902), (-15.909483, -46.193974, 10.630376), (-17.67767, -46.193974, 7.322331), (-18.766514, -46.193974, 3.7328918), (-19.13417, -46.193974, 2.3432603e-15), (-18.766514, -46.193974, -3.7328918), (-17.67767, -46.193974, -7.322331), (-15.909483, -46.193974, -10.630376), (-13.529902, -46.193974, -13.529902), (-10.630376, -46.193974, -15.909483), (-7.322331, -46.193974, -17.67767), (-3.7328918, -46.193974, -18.766514), (-3.5148903e-15, -46.193974, -19.13417), (3.7328918, -46.193974, -18.766514), (7.322331, -46.193974, -17.67767), (10.630376, -46.193974, -15.909483), (13.529902, -46.193974, -13.529902), (15.909483, -46.193974, -10.630376), (17.67767, -46.193974, -7.322331), (18.766514, -46.193974, -3.7328918), (27.778513, -41.57348, 0), (27.244755, -41.57348, 5.4193187), (25.664, -41.57348, 10.630376), (23.096987, -41.57348, 15.432914), (19.642374, -41.57348, 19.642374), (15.432914, -41.57348, 23.096987), (10.630376, -41.57348, 25.664), (5.4193187, -41.57348, 27.244755), (1.7009433e-15, -41.57348, 27.778513), (-5.4193187, -41.57348, 27.244755), (-10.630376, -41.57348, 25.664), (-15.432914, -41.57348, 23.096987), (-19.642374, -41.57348, 19.642374), (-23.096987, -41.57348, 15.432914), (-25.664, -41.57348, 10.630376), (-27.244755, -41.57348, 5.4193187), (-27.778513, -41.57348, 3.4018865e-15), (-27.244755, -41.57348, -5.4193187), (-25.664, -41.57348, -10.630376), (-23.096987, -41.57348, -15.432914), (-19.642374, -41.57348, -19.642374), (-15.432914, -41.57348, -23.096987), (-10.630376, -41.57348, -25.664), (-5.4193187, -41.57348, -27.244755), (-5.1028297e-15, -41.57348, -27.778513), (5.4193187, -41.57348, -27.244755), (10.630376, -41.57348, -25.664), (15.432914, -41.57348, -23.096987), (19.642374, -41.57348, -19.642374), (23.096987, -41.57348, -15.432914), (25.664, -41.57348, -10.630376), (27.244755, -41.57348, -5.4193187), (35.35534, -35.35534, 0), (34.676, -35.35534, 6.8974843), (32.664074, -35.35534, 13.529902), (29.396889, -35.35534, 19.642374), (25, -35.35534, 25), (19.642374, -35.35534, 29.396889), (13.529902, -35.35534, 32.664074), (6.8974843, -35.35534, 34.676), (2.1648902e-15, -35.35534, 35.35534), (-6.8974843, -35.35534, 34.676), (-13.529902, -35.35534, 32.664074), (-19.642374, -35.35534, 29.396889), (-25, -35.35534, 25), (-29.396889, -35.35534, 19.642374), (-32.664074, -35.35534, 13.529902), (-34.676, -35.35534, 6.8974843), (-35.35534, -35.35534, 4.3297804e-15), (-34.676, -35.35534, -6.8974843), (-32.664074, -35.35534, -13.529902), (-29.396889, -35.35534, -19.642374), (-25, -35.35534, -25), (-19.642374, -35.35534, -29.396889), (-13.529902, -35.35534, -32.664074), (-6.8974843, -35.35534, -34.676), (-6.49467e-15, -35.35534, -35.35534), (6.8974843, -35.35534, -34.676), (13.529902, -35.35534, -32.664074), (19.642374, -35.35534, -29.396889), (25, -35.35534, -25), (29.396889, -35.35534, -19.642374), (32.664074, -35.35534, -13.529902), (34.676, -35.35534, -6.8974843), (41.57348, -27.778513, 0), (40.77466, -27.778513, 8.110583), (38.408886, -27.778513, 15.909483), (34.567085, -27.778513, 23.096987), (29.396889, -27.778513, 29.396889), (23.096987, -27.778513, 34.567085), (15.909483, -27.778513, 38.408886), (8.110583, -27.778513, 40.77466), (2.5456415e-15, -27.778513, 41.57348), (-8.110583, -27.778513, 40.77466), (-15.909483, -27.778513, 38.408886), (-23.096987, -27.778513, 34.567085), (-29.396889, -27.778513, 29.396889), (-34.567085, -27.778513, 23.096987), (-38.408886, -27.778513, 15.909483), (-40.77466, -27.778513, 8.110583), (-41.57348, -27.778513, 5.091283e-15), (-40.77466, -27.778513, -8.110583), (-38.408886, -27.778513, -15.909483), (-34.567085, -27.778513, -23.096987), (-29.396889, -27.778513, -29.396889), (-23.096987, -27.778513, -34.567085), (-15.909483, -27.778513, -38.408886), (-8.110583, -27.778513, -40.77466), (-7.6369244e-15, -27.778513, -41.57348), (8.110583, -27.778513, -40.77466), (15.909483, -27.778513, -38.408886), (23.096987, -27.778513, -34.567085), (29.396889, -27.778513, -29.396889), (34.567085, -27.778513, -23.096987), (38.408886, -27.778513, -15.909483), (40.77466, -27.778513, -8.110583), (46.193974, -19.13417, 0), (45.306374, -19.13417, 9.011998), (42.67767, -19.13417, 17.67767), (38.408886, -19.13417, 25.664), (32.664074, -19.13417, 32.664074), (25.664, -19.13417, 38.408886), (17.67767, -19.13417, 42.67767), (9.011998, -19.13417, 45.306374), (2.8285653e-15, -19.13417, 46.193974), (-9.011998, -19.13417, 45.306374), (-17.67767, -19.13417, 42.67767), (-25.664, -19.13417, 38.408886), (-32.664074, -19.13417, 32.664074), (-38.408886, -19.13417, 25.664), (-42.67767, -19.13417, 17.67767), (-45.306374, -19.13417, 9.011998), (-46.193974, -19.13417, 5.6571306e-15), (-45.306374, -19.13417, -9.011998), (-42.67767, -19.13417, -17.67767), (-38.408886, -19.13417, -25.664), (-32.664074, -19.13417, -32.664074), (-25.664, -19.13417, -38.408886), (-17.67767, -19.13417, -42.67767), (-9.011998, -19.13417, -45.306374), (-8.4856955e-15, -19.13417, -46.193974), (9.011998, -19.13417, -45.306374), (17.67767, -19.13417, -42.67767), (25.664, -19.13417, -38.408886), (32.664074, -19.13417, -32.664074), (38.408886, -19.13417, -25.664), (42.67767, -19.13417, -17.67767), (45.306374, -19.13417, -9.011998), (49.03926, -9.754517, 0), (48.09699, -9.754517, 9.567085), (45.306374, -9.754517, 18.766514), (40.77466, -9.754517, 27.244755), (34.676, -9.754517, 34.676), (27.244755, -9.754517, 40.77466), (18.766514, -9.754517, 45.306374), (9.567085, -9.754517, 48.09699), (3.002789e-15, -9.754517, 49.03926), (-9.567085, -9.754517, 48.09699), (-18.766514, -9.754517, 45.306374), (-27.244755, -9.754517, 40.77466), (-34.676, -9.754517, 34.676), (-40.77466, -9.754517, 27.244755), (-45.306374, -9.754517, 18.766514), (-48.09699, -9.754517, 9.567085), (-49.03926, -9.754517, 6.005578e-15), (-48.09699, -9.754517, -9.567085), (-45.306374, -9.754517, -18.766514), (-40.77466, -9.754517, -27.244755), (-34.676, -9.754517, -34.676), (-27.244755, -9.754517, -40.77466), (-18.766514, -9.754517, -45.306374), (-9.567085, -9.754517, -48.09699), (-9.0083665e-15, -9.754517, -49.03926), (9.567085, -9.754517, -48.09699), (18.766514, -9.754517, -45.306374), (27.244755, -9.754517, -40.77466), (34.676, -9.754517, -34.676), (40.77466, -9.754517, -27.244755), (45.306374, -9.754517, -18.766514), (48.09699, -9.754517, -9.567085), (50, 0, 0), (49.03926, 0, 9.754517), (46.193974, 0, 19.13417), (41.57348, 0, 27.778513), (35.35534, 0, 35.35534), (27.778513, 0, 41.57348), (19.13417, 0, 46.193974), (9.754517, 0, 49.03926), (3.061617e-15, 0, 50), (-9.754517, 0, 49.03926), (-19.13417, 0, 46.193974), (-27.778513, 0, 41.57348), (-35.35534, 0, 35.35534), (-41.57348, 0, 27.778513), (-46.193974, 0, 19.13417), (-49.03926, 0, 9.754517), (-50, 0, 6.123234e-15), (-49.03926, 0, -9.754517), (-46.193974, 0, -19.13417), (-41.57348, 0, -27.778513), (-35.35534, 0, -35.35534), (-27.778513, 0, -41.57348), (-19.13417, 0, -46.193974), (-9.754517, 0, -49.03926), (-9.184851e-15, 0, -50), (9.754517, 0, -49.03926), (19.13417, 0, -46.193974), (27.778513, 0, -41.57348), (35.35534, 0, -35.35534), (41.57348, 0, -27.778513), (46.193974, 0, -19.13417), (49.03926, 0, -9.754517), (49.03926, 9.754517, 0), (48.09699, 9.754517, 9.567085), (45.306374, 9.754517, 18.766514), (40.77466, 9.754517, 27.244755), (34.676, 9.754517, 34.676), (27.244755, 9.754517, 40.77466), (18.766514, 9.754517, 45.306374), (9.567085, 9.754517, 48.09699), (3.002789e-15, 9.754517, 49.03926), (-9.567085, 9.754517, 48.09699), (-18.766514, 9.754517, 45.306374), (-27.244755, 9.754517, 40.77466), (-34.676, 9.754517, 34.676), (-40.77466, 9.754517, 27.244755), (-45.306374, 9.754517, 18.766514), (-48.09699, 9.754517, 9.567085), (-49.03926, 9.754517, 6.005578e-15), (-48.09699, 9.754517, -9.567085), (-45.306374, 9.754517, -18.766514), (-40.77466, 9.754517, -27.244755), (-34.676, 9.754517, -34.676), (-27.244755, 9.754517, -40.77466), (-18.766514, 9.754517, -45.306374), (-9.567085, 9.754517, -48.09699), (-9.0083665e-15, 9.754517, -49.03926), (9.567085, 9.754517, -48.09699), (18.766514, 9.754517, -45.306374), (27.244755, 9.754517, -40.77466), (34.676, 9.754517, -34.676), (40.77466, 9.754517, -27.244755), (45.306374, 9.754517, -18.766514), (48.09699, 9.754517, -9.567085), (46.193974, 19.13417, 0), (45.306374, 19.13417, 9.011998), (42.67767, 19.13417, 17.67767), (38.408886, 19.13417, 25.664), (32.664074, 19.13417, 32.664074), (25.664, 19.13417, 38.408886), (17.67767, 19.13417, 42.67767), (9.011998, 19.13417, 45.306374), (2.8285653e-15, 19.13417, 46.193974), (-9.011998, 19.13417, 45.306374), (-17.67767, 19.13417, 42.67767), (-25.664, 19.13417, 38.408886), (-32.664074, 19.13417, 32.664074), (-38.408886, 19.13417, 25.664), (-42.67767, 19.13417, 17.67767), (-45.306374, 19.13417, 9.011998), (-46.193974, 19.13417, 5.6571306e-15), (-45.306374, 19.13417, -9.011998), (-42.67767, 19.13417, -17.67767), (-38.408886, 19.13417, -25.664), (-32.664074, 19.13417, -32.664074), (-25.664, 19.13417, -38.408886), (-17.67767, 19.13417, -42.67767), (-9.011998, 19.13417, -45.306374), (-8.4856955e-15, 19.13417, -46.193974), (9.011998, 19.13417, -45.306374), (17.67767, 19.13417, -42.67767), (25.664, 19.13417, -38.408886), (32.664074, 19.13417, -32.664074), (38.408886, 19.13417, -25.664), (42.67767, 19.13417, -17.67767), (45.306374, 19.13417, -9.011998), (41.57348, 27.778513, 0), (40.77466, 27.778513, 8.110583), (38.408886, 27.778513, 15.909483), (34.567085, 27.778513, 23.096987), (29.396889, 27.778513, 29.396889), (23.096987, 27.778513, 34.567085), (15.909483, 27.778513, 38.408886), (8.110583, 27.778513, 40.77466), (2.5456415e-15, 27.778513, 41.57348), (-8.110583, 27.778513, 40.77466), (-15.909483, 27.778513, 38.408886), (-23.096987, 27.778513, 34.567085), (-29.396889, 27.778513, 29.396889), (-34.567085, 27.778513, 23.096987), (-38.408886, 27.778513, 15.909483), (-40.77466, 27.778513, 8.110583), (-41.57348, 27.778513, 5.091283e-15), (-40.77466, 27.778513, -8.110583), (-38.408886, 27.778513, -15.909483), (-34.567085, 27.778513, -23.096987), (-29.396889, 27.778513, -29.396889), (-23.096987, 27.778513, -34.567085), (-15.909483, 27.778513, -38.408886), (-8.110583, 27.778513, -40.77466), (-7.6369244e-15, 27.778513, -41.57348), (8.110583, 27.778513, -40.77466), (15.909483, 27.778513, -38.408886), (23.096987, 27.778513, -34.567085), (29.396889, 27.778513, -29.396889), (34.567085, 27.778513, -23.096987), (38.408886, 27.778513, -15.909483), (40.77466, 27.778513, -8.110583), (35.35534, 35.35534, 0), (34.676, 35.35534, 6.8974843), (32.664074, 35.35534, 13.529902), (29.396889, 35.35534, 19.642374), (25, 35.35534, 25), (19.642374, 35.35534, 29.396889), (13.529902, 35.35534, 32.664074), (6.8974843, 35.35534, 34.676), (2.1648902e-15, 35.35534, 35.35534), (-6.8974843, 35.35534, 34.676), (-13.529902, 35.35534, 32.664074), (-19.642374, 35.35534, 29.396889), (-25, 35.35534, 25), (-29.396889, 35.35534, 19.642374), (-32.664074, 35.35534, 13.529902), (-34.676, 35.35534, 6.8974843), (-35.35534, 35.35534, 4.3297804e-15), (-34.676, 35.35534, -6.8974843), (-32.664074, 35.35534, -13.529902), (-29.396889, 35.35534, -19.642374), (-25, 35.35534, -25), (-19.642374, 35.35534, -29.396889), (-13.529902, 35.35534, -32.664074), (-6.8974843, 35.35534, -34.676), (-6.49467e-15, 35.35534, -35.35534), (6.8974843, 35.35534, -34.676), (13.529902, 35.35534, -32.664074), (19.642374, 35.35534, -29.396889), (25, 35.35534, -25), (29.396889, 35.35534, -19.642374), (32.664074, 35.35534, -13.529902), (34.676, 35.35534, -6.8974843), (27.778513, 41.57348, 0), (27.244755, 41.57348, 5.4193187), (25.664, 41.57348, 10.630376), (23.096987, 41.57348, 15.432914), (19.642374, 41.57348, 19.642374), (15.432914, 41.57348, 23.096987), (10.630376, 41.57348, 25.664), (5.4193187, 41.57348, 27.244755), (1.7009433e-15, 41.57348, 27.778513), (-5.4193187, 41.57348, 27.244755), (-10.630376, 41.57348, 25.664), (-15.432914, 41.57348, 23.096987), (-19.642374, 41.57348, 19.642374), (-23.096987, 41.57348, 15.432914), (-25.664, 41.57348, 10.630376), (-27.244755, 41.57348, 5.4193187), (-27.778513, 41.57348, 3.4018865e-15), (-27.244755, 41.57348, -5.4193187), (-25.664, 41.57348, -10.630376), (-23.096987, 41.57348, -15.432914), (-19.642374, 41.57348, -19.642374), (-15.432914, 41.57348, -23.096987), (-10.630376, 41.57348, -25.664), (-5.4193187, 41.57348, -27.244755), (-5.1028297e-15, 41.57348, -27.778513), (5.4193187, 41.57348, -27.244755), (10.630376, 41.57348, -25.664), (15.432914, 41.57348, -23.096987), (19.642374, 41.57348, -19.642374), (23.096987, 41.57348, -15.432914), (25.664, 41.57348, -10.630376), (27.244755, 41.57348, -5.4193187), (19.13417, 46.193974, 0), (18.766514, 46.193974, 3.7328918), (17.67767, 46.193974, 7.322331), (15.909483, 46.193974, 10.630376), (13.529902, 46.193974, 13.529902), (10.630376, 46.193974, 15.909483), (7.322331, 46.193974, 17.67767), (3.7328918, 46.193974, 18.766514), (1.1716302e-15, 46.193974, 19.13417), (-3.7328918, 46.193974, 18.766514), (-7.322331, 46.193974, 17.67767), (-10.630376, 46.193974, 15.909483), (-13.529902, 46.193974, 13.529902), (-15.909483, 46.193974, 10.630376), (-17.67767, 46.193974, 7.322331), (-18.766514, 46.193974, 3.7328918), (-19.13417, 46.193974, 2.3432603e-15), (-18.766514, 46.193974, -3.7328918), (-17.67767, 46.193974, -7.322331), (-15.909483, 46.193974, -10.630376), (-13.529902, 46.193974, -13.529902), (-10.630376, 46.193974, -15.909483), (-7.322331, 46.193974, -17.67767), (-3.7328918, 46.193974, -18.766514), (-3.5148903e-15, 46.193974, -19.13417), (3.7328918, 46.193974, -18.766514), (7.322331, 46.193974, -17.67767), (10.630376, 46.193974, -15.909483), (13.529902, 46.193974, -13.529902), (15.909483, 46.193974, -10.630376), (17.67767, 46.193974, -7.322331), (18.766514, 46.193974, -3.7328918), (9.754517, 49.03926, 0), (9.567085, 49.03926, 1.9030117), (9.011998, 49.03926, 3.7328918), (8.110583, 49.03926, 5.4193187), (6.8974843, 49.03926, 6.8974843), (5.4193187, 49.03926, 8.110583), (3.7328918, 49.03926, 9.011998), (1.9030117, 49.03926, 9.567085), (5.9729185e-16, 49.03926, 9.754517), (-1.9030117, 49.03926, 9.567085), (-3.7328918, 49.03926, 9.011998), (-5.4193187, 49.03926, 8.110583), (-6.8974843, 49.03926, 6.8974843), (-8.110583, 49.03926, 5.4193187), (-9.011998, 49.03926, 3.7328918), (-9.567085, 49.03926, 1.9030117), (-9.754517, 49.03926, 1.1945837e-15), (-9.567085, 49.03926, -1.9030117), (-9.011998, 49.03926, -3.7328918), (-8.110583, 49.03926, -5.4193187), (-6.8974843, 49.03926, -6.8974843), (-5.4193187, 49.03926, -8.110583), (-3.7328918, 49.03926, -9.011998), (-1.9030117, 49.03926, -9.567085), (-1.7918755e-15, 49.03926, -9.754517), (1.9030117, 49.03926, -9.567085), (3.7328918, 49.03926, -9.011998), (5.4193187, 49.03926, -8.110583), (6.8974843, 49.03926, -6.8974843), (8.110583, 49.03926, -5.4193187), (9.011998, 49.03926, -3.7328918), (9.567085, 49.03926, -1.9030117), (0, 50, 0)]
-        uniform token subdivisionScheme = "none"
-        double3 xformOp:rotateXYZ = (0, 0, 0)
-        double3 xformOp:scale = (1, 1, 1)
-        double3 xformOp:translate = (0, 100, 0)
-        uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:rotateXYZ", "xformOp:scale"]
-    }
-}
-
-def Xform "Environment"
-{
-    double3 xformOp:rotateXYZ = (0, 0, 0)
-    double3 xformOp:scale = (1, 1, 1)
-    double3 xformOp:translate = (0, 0, 0)
-    uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:rotateXYZ", "xformOp:scale"]
-
-    def "Stage" (
-        prepend payload = @./assets/environments/stage.usda@
-    )
-    {
-        over "Geometries"
-        {
-            over "Platform"
-            {
-                token visibility = "invisible"
-            }
-        }
-    }
-}
-
-def Xform "CameraRoot"
-{
-    double3 xformOp:rotateXYZ = (-20, 60, 0)
-    double3 xformOp:scale = (1, 1, 1)
-    double3 xformOp:translate = (0, 150, 0)
-    uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:rotateXYZ", "xformOp:scale"]
-
-    def Camera "Camera"
-    {
-        float2 clippingRange = (1, 10000000)
-        float focalLength = 25
-        float focusDistance = 950
-        float fStop = 0
-        bool omni:kit:cameraLock = 0
-        double3 xformOp:rotateYXZ = (0, 0, 0)
-        double3 xformOp:scale = (1, 1, 1)
-        double3 xformOp:translate = (0, 0, 1000)
-        uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:rotateYXZ", "xformOp:scale"]
-    }
-}
diff --git a/exts/omni.warp/data/scenes/particles_simulation_throw.usda b/exts/omni.warp/data/scenes/particles_simulation_throw.usda
deleted file mode 100644
index 31985d88..00000000
--- a/exts/omni.warp/data/scenes/particles_simulation_throw.usda
+++ /dev/null
@@ -1,464 +0,0 @@
-#usda 1.0
-(
-    customLayerData = {
-        dictionary cameraSettings = {
-            string boundCamera = "/CameraRoot/Camera"
-        }
-        dictionary renderSettings = {
-            int "rtx:post:dlss:execMode" = 0
-            bool "rtx:translucency:enabled" = 0
-        }
-    }
-    defaultPrim = "World"
-    endTimeCode = 36000
-    framesPerSecond = 60
-    metersPerUnit = 0.01
-    startTimeCode = 0
-    upAxis = "Y"
-)
-
-def Xform "World"
-{
-    def OmniGraph "ActionGraph"
-    {
-        token evaluationMode = "Automatic"
-        token evaluator:type = "execution"
-        token fabricCacheBacking = "Shared"
-        int2 fileFormatVersion = (1, 7)
-        token pipelineStage = "pipelineStageSimulation"
-
-        def OmniGraphNode "on_loaded" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            token node:type = "omni.graph.action.OnLoaded"
-            int node:typeVersion = 1
-            custom uint outputs:execOut (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            uniform token ui:nodegraph:node:expansionState = "open"
-            uniform float2 ui:nodegraph:node:pos = (0, -250)
-        }
-
-        def OmniGraphNode "on_tick" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom uint inputs:framePeriod = 0
-            custom bool inputs:onlyPlayback = 1
-            token node:type = "omni.graph.action.OnTick"
-            int node:typeVersion = 1
-            custom double outputs:absoluteSimTime
-            custom double outputs:deltaSeconds
-            custom double outputs:frame
-            custom bool outputs:isPlaying
-            custom uint outputs:tick (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            custom double outputs:time
-            custom double outputs:timeSinceStart
-            custom double state:accumulatedSeconds = 0
-            custom uint state:frameCount = 0
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (32, 60)
-        }
-
-        def OmniGraphNode "read_xform" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom rel inputs:prim = </World/Points> (
-                customData = {
-                    dictionary omni = {
-                        dictionary graph = {
-                            string relType = "target"
-                        }
-                    }
-                }
-            )
-            custom token inputs:primPath
-            custom bool inputs:usePath = 0
-            token node:type = "omni.graph.nodes.GetPrimLocalToWorldTransform"
-            int node:typeVersion = 2
-            custom matrix4d outputs:localToWorldTransform
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (-70, -160)
-        }
-
-        def OmniGraphNode "read_emitter" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom int inputs:_debugStamp
-            custom bool inputs:applySkelBinding = 0
-            custom string inputs:attrNamesToImport = "*"
-            custom bool inputs:computeBoundingBox = 0
-            custom bool inputs:enableBundleChangeTracking = 1
-            custom bool inputs:enableChangeTracking
-            custom string inputs:pathPattern = ""
-            custom rel inputs:prims = </World/Emitter> (
-                customData = {
-                    dictionary omni = {
-                        dictionary graph = {
-                            string relType = "target"
-                        }
-                    }
-                }
-            )
-            custom string inputs:typePattern = "*"
-            custom timecode inputs:usdTimecode = nan
-            token node:type = "omni.graph.nodes.ReadPrimsV2"
-            int node:typeVersion = 1
-            custom bool state:applySkelBinding = 0
-            custom string state:attrNamesToImport
-            custom bool state:computeBoundingBox = 0
-            custom bool state:enableBundleChangeTracking
-            custom bool state:enableChangeTracking
-            custom uint64[] state:inputPrimPaths = []
-            custom string state:pathPattern
-            custom uint64[] state:primPaths = []
-            custom string state:typePattern
-            custom timecode state:usdTimecode = -1
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (20, -60)
-
-            def Output "outputs_primsBundle"
-            {
-            }
-        }
-
-        def OmniGraphNode "read_collider" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom int inputs:_debugStamp
-            custom bool inputs:applySkelBinding = 0
-            custom string inputs:attrNamesToImport = "*"
-            custom bool inputs:computeBoundingBox = 0
-            custom bool inputs:enableBundleChangeTracking = 1
-            custom bool inputs:enableChangeTracking
-            custom string inputs:pathPattern = ""
-            custom rel inputs:prims = </World/Collider> (
-                customData = {
-                    dictionary omni = {
-                        dictionary graph = {
-                            string relType = "target"
-                        }
-                    }
-                }
-            )
-            custom string inputs:typePattern = "*"
-            custom timecode inputs:usdTimecode = nan
-            token node:type = "omni.graph.nodes.ReadPrimsV2"
-            int node:typeVersion = 1
-            custom bool state:applySkelBinding = 0
-            custom string state:attrNamesToImport
-            custom bool state:computeBoundingBox = 0
-            custom bool state:enableBundleChangeTracking
-            custom bool state:enableChangeTracking
-            custom uint64[] state:inputPrimPaths = []
-            custom string state:pathPattern
-            custom uint64[] state:primPaths = []
-            custom string state:typePattern
-            custom timecode state:usdTimecode = -1
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (350, 200)
-
-            def Output "outputs_primsBundle"
-            {
-            }
-        }
-
-        def OmniGraphNode "particles_from_mesh" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom uint inputs:execIn
-            prepend uint inputs:execIn.connect = [
-                </World/ActionGraph/on_tick.outputs:tick>,
-                </World/ActionGraph/on_loaded.outputs:execOut>,
-            ]
-            custom float inputs:mass = 1
-            custom int inputs:maxPoints = 1000000
-            custom float inputs:maxSdf = 0
-            custom rel inputs:mesh
-            prepend rel inputs:mesh = </World/ActionGraph/read_emitter/outputs_primsBundle>
-            custom float inputs:minSdf = -100
-            custom float inputs:radius = 2
-            custom int inputs:seed
-            custom float inputs:spacing = 4
-            custom float inputs:spacingJitter = 0
-            custom matrix4d inputs:transform
-            prepend matrix4d inputs:transform.connect = </World/ActionGraph/read_xform.outputs:localToWorldTransform>
-            custom float inputs:velocityAmount = 750
-            custom vector3f inputs:velocityDir = (0, 0, 1)
-            token node:type = "omni.warp.WarpParticlesFromMesh"
-            int node:typeVersion = 1
-            custom uint outputs:execOut (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (350, -138)
-
-            def Output "outputs_particles"
-            {
-            }
-        }
-
-        def OmniGraphNode "particles_simulate" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom rel inputs:collider
-            prepend rel inputs:collider = </World/ActionGraph/read_collider/outputs_primsBundle>
-            custom float inputs:colliderContactDistance = 1
-            custom float inputs:colliderContactQueryRange = 100
-            custom float inputs:colliderContactRange = 100
-            custom float inputs:contactDampingStiffness = 1
-            custom float inputs:contactElasticStiffness = 100
-            custom float inputs:contactFrictionCoeff = 0.75
-            custom float inputs:contactFrictionStiffness = 1
-            custom bool inputs:enabled = 1
-            custom uint inputs:execIn
-            prepend uint inputs:execIn.connect = </World/ActionGraph/particles_from_mesh.outputs:execOut>
-            custom float inputs:globalScale = 100
-            custom vector3f inputs:gravity = (0, -980, 0)
-            custom float inputs:groundAltitude = 0
-            custom bool inputs:groundEnabled = 1
-            custom rel inputs:particles
-            prepend rel inputs:particles = </World/ActionGraph/particles_from_mesh/outputs_particles>
-            custom float inputs:particlesContactAdhesion = 0
-            custom float inputs:particlesContactCohesion = 0.2
-            custom float inputs:particlesQueryRange = 4
-            custom float inputs:particlesRange = 2
-            custom int inputs:substepCount = 16
-            custom double inputs:time = 0
-            prepend double inputs:time.connect = </World/ActionGraph/on_tick.outputs:time>
-            token node:type = "omni.warp.WarpParticlesSimulate"
-            int node:typeVersion = 1
-            custom uint outputs:execOut (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (657, -46)
-
-            def Output "outputs_particles"
-            {
-            }
-        }
-
-        def OmniGraphNode "bundle_inspect_changes" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom rel inputs:bundle
-            prepend rel inputs:bundle = </World/ActionGraph/particles_simulate/outputs_particles>
-            custom uint inputs:execIn
-            prepend uint inputs:execIn.connect = </World/ActionGraph/particles_simulate.outputs:execOut>
-            token node:type = "omni.warp.WarpOgnBundleInspectChanges"
-            int node:typeVersion = 1
-            custom string outputs:attrsChanged
-            custom uint outputs:execOut (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            custom bool outputs:topologyChanged
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (910, -25)
-
-            def Output "outputs_bundle"
-            {
-            }
-        }
-
-        def OmniGraphNode "write_prims" (
-            prepend apiSchemas = ["NodeGraphNodeAPI"]
-        )
-        {
-            custom string inputs:attrNamesToExport = "*"
-            prepend string inputs:attrNamesToExport.connect = </World/ActionGraph/bundle_inspect_changes.outputs:attrsChanged>
-            custom uint inputs:execIn
-            prepend uint inputs:execIn.connect = </World/ActionGraph/bundle_inspect_changes.outputs:execOut>
-            custom token inputs:layerIdentifier
-            custom string inputs:pathPattern = "*"
-            custom rel inputs:prims = </World/Points> (
-                customData = {
-                    dictionary omni = {
-                        dictionary graph = {
-                            string relType = "target"
-                        }
-                    }
-                }
-            )
-            custom rel inputs:primsBundle
-            prepend rel inputs:primsBundle = </World/ActionGraph/bundle_inspect_changes/outputs_bundle>
-            custom bool inputs:scatterUnderTargets = 0
-            custom string inputs:typePattern = "*"
-            custom bool inputs:usdWriteBack = 1
-            prepend bool inputs:usdWriteBack.connect = </World/ActionGraph/bundle_inspect_changes.outputs:topologyChanged>
-            token node:type = "omni.graph.nodes.WritePrimsV2"
-            int node:typeVersion = 1
-            custom uint outputs:execOut (
-                customData = {
-                    bool isExecution = 1
-                }
-            )
-            custom string state:attrNamesToExport = "*"
-            custom token state:layerIdentifier
-            custom string state:pathPattern = "*"
-            custom uint64 state:primBundleDirtyId
-            custom uint64[] state:prims = []
-            custom bool state:scatterUnderTargets = 0
-            custom string state:typePattern = "*"
-            custom bool state:usdWriteBack = 1
-            uniform token ui:nodegraph:node:expansionState = "minimized"
-            uniform float2 ui:nodegraph:node:pos = (1180, 0)
-        }
-    }
-
-    def Scope "Looks"
-    {
-        def "CeramicMaterial" (
-            prepend payload = @./assets/materials/ceramic_material.usda@
-        )
-        {
-            over "CeramicMaterial"
-            {
-                over "Shader"
-                {
-                    color3f inputs:diffuse_reflection_color = (0.75, 0.75, 0.75) (
-                        customData = {
-                            float3 default = (0.2, 0.2, 0.2)
-                        }
-                        displayGroup = "Albedo"
-                        displayName = "Albedo Color"
-                        doc = "This is the albedo base color"
-                        hidden = false
-                        renderType = "color"
-                    )
-                }
-            }
-        }
-
-        def "ParticleMaterial" (
-            prepend payload = @./assets/materials/particle_material.usda@
-        )
-        {
-            over "ParticleMaterial"
-            {
-                over "Shader"
-                {
-                    color3f inputs:diffuse_reflection_color = (0.16, 0.11, 0.08) (
-                        customData = {
-                            float3 default = (0.2, 0.2, 0.2)
-                        }
-                        displayGroup = "Albedo"
-                        displayName = "Albedo Color"
-                        doc = "This is the albedo base color"
-                        hidden = false
-                        renderType = "color"
-                    )
-                }
-            }
-        }
-    }
-
-    def Points "Points" (
-        prepend apiSchemas = ["MaterialBindingAPI"]
-    )
-    {
-        rel material:binding = </World/Looks/ParticleMaterial/ParticleMaterial> (
-            bindMaterialAs = "weakerThanDescendants"
-        )
-    }
-
-    def Mesh "Emitter" (
-        prepend apiSchemas = ["OmniSceneVisualizationAPI"]
-    )
-    {
-        float3[] extent = [(-50, -50, -50), (50, 50, 50)]
-        int[] faceVertexCounts = [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3]
-        int[] faceVertexIndices = [0, 32, 33, 1, 1, 33, 34, 2, 2, 34, 35, 3, 3, 35, 36, 4, 4, 36, 37, 5, 5, 37, 38, 6, 6, 38, 39, 7, 7, 39, 40, 8, 8, 40, 41, 9, 9, 41, 42, 10, 10, 42, 43, 11, 11, 43, 44, 12, 12, 44, 45, 13, 13, 45, 46, 14, 14, 46, 47, 15, 15, 47, 48, 16, 16, 48, 49, 17, 17, 49, 50, 18, 18, 50, 51, 19, 19, 51, 52, 20, 20, 52, 53, 21, 21, 53, 54, 22, 22, 54, 55, 23, 23, 55, 56, 24, 24, 56, 57, 25, 25, 57, 58, 26, 26, 58, 59, 27, 27, 59, 60, 28, 28, 60, 61, 29, 29, 61, 62, 30, 30, 62, 63, 31, 31, 63, 32, 0, 0, 1, 64, 1, 2, 64, 2, 3, 64, 3, 4, 64, 4, 5, 64, 5, 6, 64, 6, 7, 64, 7, 8, 64, 8, 9, 64, 9, 10, 64, 10, 11, 64, 11, 12, 64, 12, 13, 64, 13, 14, 64, 14, 15, 64, 15, 16, 64, 16, 17, 64, 17, 18, 64, 18, 19, 64, 19, 20, 64, 20, 21, 64, 21, 22, 64, 22, 23, 64, 23, 24, 64, 24, 25, 64, 25, 26, 64, 26, 27, 64, 27, 28, 64, 28, 29, 64, 29, 30, 64, 30, 31, 64, 31, 0, 64, 32, 65, 33, 33, 65, 34, 34, 65, 35, 35, 65, 36, 36, 65, 37, 37, 65, 38, 38, 65, 39, 39, 65, 40, 40, 65, 41, 41, 65, 42, 42, 65, 43, 43, 65, 44, 44, 65, 45, 45, 65, 46, 46, 65, 47, 47, 65, 48, 48, 65, 49, 49, 65, 50, 50, 65, 51, 51, 65, 52, 52, 65, 53, 53, 65, 54, 54, 65, 55, 55, 65, 56, 56, 65, 57, 57, 65, 58, 58, 65, 59, 59, 65, 60, 60, 65, 61, 61, 65, 62, 62, 65, 63, 63, 65, 32]
-        bool omni:scene:visualization:drawWireframe = 1
-        point3f[] points = [(50, -50, 0), (49.03926, -50, 9.754517), (46.193974, -50, 19.13417), (41.57348, -50, 27.778513), (35.35534, -50, 35.35534), (27.778513, -50, 41.57348), (19.13417, -50, 46.193974), (9.754517, -50, 49.03926), (3.061617e-15, -50, 50), (-9.754517, -50, 49.03926), (-19.13417, -50, 46.193974), (-27.778513, -50, 41.57348), (-35.35534, -50, 35.35534), (-41.57348, -50, 27.778513), (-46.193974, -50, 19.13417), (-49.03926, -50, 9.754517), (-50, -50, 6.123234e-15), (-49.03926, -50, -9.754517), (-46.193974, -50, -19.13417), (-41.57348, -50, -27.778513), (-35.35534, -50, -35.35534), (-27.778513, -50, -41.57348), (-19.13417, -50, -46.193974), (-9.754517, -50, -49.03926), (-9.184851e-15, -50, -50), (9.754517, -50, -49.03926), (19.13417, -50, -46.193974), (27.778513, -50, -41.57348), (35.35534, -50, -35.35534), (41.57348, -50, -27.778513), (46.193974, -50, -19.13417), (49.03926, -50, -9.754517), (50, 50, 0), (49.03926, 50, 9.754517), (46.193974, 50, 19.13417), (41.57348, 50, 27.778513), (35.35534, 50, 35.35534), (27.778513, 50, 41.57348), (19.13417, 50, 46.193974), (9.754517, 50, 49.03926), (3.061617e-15, 50, 50), (-9.754517, 50, 49.03926), (-19.13417, 50, 46.193974), (-27.778513, 50, 41.57348), (-35.35534, 50, 35.35534), (-41.57348, 50, 27.778513), (-46.193974, 50, 19.13417), (-49.03926, 50, 9.754517), (-50, 50, 6.123234e-15), (-49.03926, 50, -9.754517), (-46.193974, 50, -19.13417), (-41.57348, 50, -27.778513), (-35.35534, 50, -35.35534), (-27.778513, 50, -41.57348), (-19.13417, 50, -46.193974), (-9.754517, 50, -49.03926), (-9.184851e-15, 50, -50), (9.754517, 50, -49.03926), (19.13417, 50, -46.193974), (27.778513, 50, -41.57348), (35.35534, 50, -35.35534), (41.57348, 50, -27.778513), (46.193974, 50, -19.13417), (49.03926, 50, -9.754517), (0, -50, 0), (0, 50, 0)]
-        uniform token subdivisionScheme = "none"
-        uniform token purpose = "guide"
-        token visibility = "inherited"
-        double3 xformOp:rotateXYZ = (0, 180, 0)
-        double3 xformOp:scale = (1, 1.75, 1)
-        double3 xformOp:translate = (0, 125, 250)
-        uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:rotateXYZ", "xformOp:scale"]
-    }
-
-    def Mesh "Collider" (
-        prepend apiSchemas = ["MaterialBindingAPI"]
-    )
-    {
-        float3[] extent = [(-50, -50, -50), (50, 50, 50)]
-        int[] faceVertexCounts = [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3]
-        int[] faceVertexIndices = [0, 1, 2, 0, 2, 3, 0, 3, 4, 0, 4, 5, 0, 5, 6, 0, 6, 7, 0, 7, 8, 0, 8, 9, 0, 9, 10, 0, 10, 11, 0, 11, 12, 0, 12, 13, 0, 13, 14, 0, 14, 15, 0, 15, 16, 0, 16, 17, 0, 17, 18, 0, 18, 19, 0, 19, 20, 0, 20, 21, 0, 21, 22, 0, 22, 23, 0, 23, 24, 0, 24, 25, 0, 25, 26, 0, 26, 27, 0, 27, 28, 0, 28, 29, 0, 29, 30, 0, 30, 31, 0, 31, 32, 0, 32, 1, 1, 33, 34, 2, 2, 34, 35, 3, 3, 35, 36, 4, 4, 36, 37, 5, 5, 37, 38, 6, 6, 38, 39, 7, 7, 39, 40, 8, 8, 40, 41, 9, 9, 41, 42, 10, 10, 42, 43, 11, 11, 43, 44, 12, 12, 44, 45, 13, 13, 45, 46, 14, 14, 46, 47, 15, 15, 47, 48, 16, 16, 48, 49, 17, 17, 49, 50, 18, 18, 50, 51, 19, 19, 51, 52, 20, 20, 52, 53, 21, 21, 53, 54, 22, 22, 54, 55, 23, 23, 55, 56, 24, 24, 56, 57, 25, 25, 57, 58, 26, 26, 58, 59, 27, 27, 59, 60, 28, 28, 60, 61, 29, 29, 61, 62, 30, 30, 62, 63, 31, 31, 63, 64, 32, 32, 64, 33, 1, 33, 65, 66, 34, 34, 66, 67, 35, 35, 67, 68, 36, 36, 68, 69, 37, 37, 69, 70, 38, 38, 70, 71, 39, 39, 71, 72, 40, 40, 72, 73, 41, 41, 73, 74, 42, 42, 74, 75, 43, 43, 75, 76, 44, 44, 76, 77, 45, 45, 77, 78, 46, 46, 78, 79, 47, 47, 79, 80, 48, 48, 80, 81, 49, 49, 81, 82, 50, 50, 82, 83, 51, 51, 83, 84, 52, 52, 84, 85, 53, 53, 85, 86, 54, 54, 86, 87, 55, 55, 87, 88, 56, 56, 88, 89, 57, 57, 89, 90, 58, 58, 90, 91, 59, 59, 91, 92, 60, 60, 92, 93, 61, 61, 93, 94, 62, 62, 94, 95, 63, 63, 95, 96, 64, 64, 96, 65, 33, 65, 97, 98, 66, 66, 98, 99, 67, 67, 99, 100, 68, 68, 100, 101, 69, 69, 101, 102, 70, 70, 102, 103, 71, 71, 103, 104, 72, 72, 104, 105, 73, 73, 105, 106, 74, 74, 106, 107, 75, 75, 107, 108, 76, 76, 108, 109, 77, 77, 109, 110, 78, 78, 110, 111, 79, 79, 111, 112, 80, 80, 112, 113, 81, 81, 113, 114, 82, 82, 114, 115, 83, 83, 115, 116, 84, 84, 116, 117, 85, 85, 117, 118, 86, 86, 118, 119, 87, 87, 119, 120, 88, 88, 120, 121, 89, 89, 121, 122, 90, 90, 122, 123, 91, 91, 123, 124, 92, 92, 124, 125, 93, 93, 125, 126, 94, 94, 126, 127, 95, 95, 127, 128, 96, 96, 128, 97, 65, 97, 129, 130, 98, 98, 130, 131, 99, 99, 131, 132, 100, 100, 132, 133, 101, 101, 133, 134, 102, 102, 134, 135, 103, 103, 135, 136, 104, 104, 136, 137, 105, 105, 137, 138, 106, 106, 138, 139, 107, 107, 139, 140, 108, 108, 140, 141, 109, 109, 141, 142, 110, 110, 142, 143, 111, 111, 143, 144, 112, 112, 144, 145, 113, 113, 145, 146, 114, 114, 146, 147, 115, 115, 147, 148, 116, 116, 148, 149, 117, 117, 149, 150, 118, 118, 150, 151, 119, 119, 151, 152, 120, 120, 152, 153, 121, 121, 153, 154, 122, 122, 154, 155, 123, 123, 155, 156, 124, 124, 156, 157, 125, 125, 157, 158, 126, 126, 158, 159, 127, 127, 159, 160, 128, 128, 160, 129, 97, 129, 161, 162, 130, 130, 162, 163, 131, 131, 163, 164, 132, 132, 164, 165, 133, 133, 165, 166, 134, 134, 166, 167, 135, 135, 167, 168, 136, 136, 168, 169, 137, 137, 169, 170, 138, 138, 170, 171, 139, 139, 171, 172, 140, 140, 172, 173, 141, 141, 173, 174, 142, 142, 174, 175, 143, 143, 175, 176, 144, 144, 176, 177, 145, 145, 177, 178, 146, 146, 178, 179, 147, 147, 179, 180, 148, 148, 180, 181, 149, 149, 181, 182, 150, 150, 182, 183, 151, 151, 183, 184, 152, 152, 184, 185, 153, 153, 185, 186, 154, 154, 186, 187, 155, 155, 187, 188, 156, 156, 188, 189, 157, 157, 189, 190, 158, 158, 190, 191, 159, 159, 191, 192, 160, 160, 192, 161, 129, 161, 193, 194, 162, 162, 194, 195, 163, 163, 195, 196, 164, 164, 196, 197, 165, 165, 197, 198, 166, 166, 198, 199, 167, 167, 199, 200, 168, 168, 200, 201, 169, 169, 201, 202, 170, 170, 202, 203, 171, 171, 203, 204, 172, 172, 204, 205, 173, 173, 205, 206, 174, 174, 206, 207, 175, 175, 207, 208, 176, 176, 208, 209, 177, 177, 209, 210, 178, 178, 210, 211, 179, 179, 211, 212, 180, 180, 212, 213, 181, 181, 213, 214, 182, 182, 214, 215, 183, 183, 215, 216, 184, 184, 216, 217, 185, 185, 217, 218, 186, 186, 218, 219, 187, 187, 219, 220, 188, 188, 220, 221, 189, 189, 221, 222, 190, 190, 222, 223, 191, 191, 223, 224, 192, 192, 224, 193, 161, 193, 225, 226, 194, 194, 226, 227, 195, 195, 227, 228, 196, 196, 228, 229, 197, 197, 229, 230, 198, 198, 230, 231, 199, 199, 231, 232, 200, 200, 232, 233, 201, 201, 233, 234, 202, 202, 234, 235, 203, 203, 235, 236, 204, 204, 236, 237, 205, 205, 237, 238, 206, 206, 238, 239, 207, 207, 239, 240, 208, 208, 240, 241, 209, 209, 241, 242, 210, 210, 242, 243, 211, 211, 243, 244, 212, 212, 244, 245, 213, 213, 245, 246, 214, 214, 246, 247, 215, 215, 247, 248, 216, 216, 248, 249, 217, 217, 249, 250, 218, 218, 250, 251, 219, 219, 251, 252, 220, 220, 252, 253, 221, 221, 253, 254, 222, 222, 254, 255, 223, 223, 255, 256, 224, 224, 256, 225, 193, 225, 257, 258, 226, 226, 258, 259, 227, 227, 259, 260, 228, 228, 260, 261, 229, 229, 261, 262, 230, 230, 262, 263, 231, 231, 263, 264, 232, 232, 264, 265, 233, 233, 265, 266, 234, 234, 266, 267, 235, 235, 267, 268, 236, 236, 268, 269, 237, 237, 269, 270, 238, 238, 270, 271, 239, 239, 271, 272, 240, 240, 272, 273, 241, 241, 273, 274, 242, 242, 274, 275, 243, 243, 275, 276, 244, 244, 276, 277, 245, 245, 277, 278, 246, 246, 278, 279, 247, 247, 279, 280, 248, 248, 280, 281, 249, 249, 281, 282, 250, 250, 282, 283, 251, 251, 283, 284, 252, 252, 284, 285, 253, 253, 285, 286, 254, 254, 286, 287, 255, 255, 287, 288, 256, 256, 288, 257, 225, 257, 289, 290, 258, 258, 290, 291, 259, 259, 291, 292, 260, 260, 292, 293, 261, 261, 293, 294, 262, 262, 294, 295, 263, 263, 295, 296, 264, 264, 296, 297, 265, 265, 297, 298, 266, 266, 298, 299, 267, 267, 299, 300, 268, 268, 300, 301, 269, 269, 301, 302, 270, 270, 302, 303, 271, 271, 303, 304, 272, 272, 304, 305, 273, 273, 305, 306, 274, 274, 306, 307, 275, 275, 307, 308, 276, 276, 308, 309, 277, 277, 309, 310, 278, 278, 310, 311, 279, 279, 311, 312, 280, 280, 312, 313, 281, 281, 313, 314, 282, 282, 314, 315, 283, 283, 315, 316, 284, 284, 316, 317, 285, 285, 317, 318, 286, 286, 318, 319, 287, 287, 319, 320, 288, 288, 320, 289, 257, 289, 321, 322, 290, 290, 322, 323, 291, 291, 323, 324, 292, 292, 324, 325, 293, 293, 325, 326, 294, 294, 326, 327, 295, 295, 327, 328, 296, 296, 328, 329, 297, 297, 329, 330, 298, 298, 330, 331, 299, 299, 331, 332, 300, 300, 332, 333, 301, 301, 333, 334, 302, 302, 334, 335, 303, 303, 335, 336, 304, 304, 336, 337, 305, 305, 337, 338, 306, 306, 338, 339, 307, 307, 339, 340, 308, 308, 340, 341, 309, 309, 341, 342, 310, 310, 342, 343, 311, 311, 343, 344, 312, 312, 344, 345, 313, 313, 345, 346, 314, 314, 346, 347, 315, 315, 347, 348, 316, 316, 348, 349, 317, 317, 349, 350, 318, 318, 350, 351, 319, 319, 351, 352, 320, 320, 352, 321, 289, 321, 353, 354, 322, 322, 354, 355, 323, 323, 355, 356, 324, 324, 356, 357, 325, 325, 357, 358, 326, 326, 358, 359, 327, 327, 359, 360, 328, 328, 360, 361, 329, 329, 361, 362, 330, 330, 362, 363, 331, 331, 363, 364, 332, 332, 364, 365, 333, 333, 365, 366, 334, 334, 366, 367, 335, 335, 367, 368, 336, 336, 368, 369, 337, 337, 369, 370, 338, 338, 370, 371, 339, 339, 371, 372, 340, 340, 372, 373, 341, 341, 373, 374, 342, 342, 374, 375, 343, 343, 375, 376, 344, 344, 376, 377, 345, 345, 377, 378, 346, 346, 378, 379, 347, 347, 379, 380, 348, 348, 380, 381, 349, 349, 381, 382, 350, 350, 382, 383, 351, 351, 383, 384, 352, 352, 384, 353, 321, 353, 385, 386, 354, 354, 386, 387, 355, 355, 387, 388, 356, 356, 388, 389, 357, 357, 389, 390, 358, 358, 390, 391, 359, 359, 391, 392, 360, 360, 392, 393, 361, 361, 393, 394, 362, 362, 394, 395, 363, 363, 395, 396, 364, 364, 396, 397, 365, 365, 397, 398, 366, 366, 398, 399, 367, 367, 399, 400, 368, 368, 400, 401, 369, 369, 401, 402, 370, 370, 402, 403, 371, 371, 403, 404, 372, 372, 404, 405, 373, 373, 405, 406, 374, 374, 406, 407, 375, 375, 407, 408, 376, 376, 408, 409, 377, 377, 409, 410, 378, 378, 410, 411, 379, 379, 411, 412, 380, 380, 412, 413, 381, 381, 413, 414, 382, 382, 414, 415, 383, 383, 415, 416, 384, 384, 416, 385, 353, 385, 417, 418, 386, 386, 418, 419, 387, 387, 419, 420, 388, 388, 420, 421, 389, 389, 421, 422, 390, 390, 422, 423, 391, 391, 423, 424, 392, 392, 424, 425, 393, 393, 425, 426, 394, 394, 426, 427, 395, 395, 427, 428, 396, 396, 428, 429, 397, 397, 429, 430, 398, 398, 430, 431, 399, 399, 431, 432, 400, 400, 432, 433, 401, 401, 433, 434, 402, 402, 434, 435, 403, 403, 435, 436, 404, 404, 436, 437, 405, 405, 437, 438, 406, 406, 438, 439, 407, 407, 439, 440, 408, 408, 440, 441, 409, 409, 441, 442, 410, 410, 442, 443, 411, 411, 443, 444, 412, 412, 444, 445, 413, 413, 445, 446, 414, 414, 446, 447, 415, 415, 447, 448, 416, 416, 448, 417, 385, 417, 449, 450, 418, 418, 450, 451, 419, 419, 451, 452, 420, 420, 452, 453, 421, 421, 453, 454, 422, 422, 454, 455, 423, 423, 455, 456, 424, 424, 456, 457, 425, 425, 457, 458, 426, 426, 458, 459, 427, 427, 459, 460, 428, 428, 460, 461, 429, 429, 461, 462, 430, 430, 462, 463, 431, 431, 463, 464, 432, 432, 464, 465, 433, 433, 465, 466, 434, 434, 466, 467, 435, 435, 467, 468, 436, 436, 468, 469, 437, 437, 469, 470, 438, 438, 470, 471, 439, 439, 471, 472, 440, 440, 472, 473, 441, 441, 473, 474, 442, 442, 474, 475, 443, 443, 475, 476, 444, 444, 476, 477, 445, 445, 477, 478, 446, 446, 478, 479, 447, 447, 479, 480, 448, 448, 480, 449, 417, 449, 481, 450, 450, 481, 451, 451, 481, 452, 452, 481, 453, 453, 481, 454, 454, 481, 455, 455, 481, 456, 456, 481, 457, 457, 481, 458, 458, 481, 459, 459, 481, 460, 460, 481, 461, 461, 481, 462, 462, 481, 463, 463, 481, 464, 464, 481, 465, 465, 481, 466, 466, 481, 467, 467, 481, 468, 468, 481, 469, 469, 481, 470, 470, 481, 471, 471, 481, 472, 472, 481, 473, 473, 481, 474, 474, 481, 475, 475, 481, 476, 476, 481, 477, 477, 481, 478, 478, 481, 479, 479, 481, 480, 480, 481, 449]
-        rel material:binding = </World/Looks/CeramicMaterial/CeramicMaterial> (
-            bindMaterialAs = "weakerThanDescendants"
-        )
-        normal3f[] normals = [(0, -50, 0), (9.754517, -49.03926, 0), (9.567085, -49.03926, 1.9030117), (0, -50, 0), (9.567085, -49.03926, 1.9030117), (9.011998, -49.03926, 3.7328918), (0, -50, 0), (9.011998, -49.03926, 3.7328918), (8.110583, -49.03926, 5.4193187), (0, -50, 0), (8.110583, -49.03926, 5.4193187), (6.8974843, -49.03926, 6.8974843), (0, -50, 0), (6.8974843, -49.03926, 6.8974843), (5.4193187, -49.03926, 8.110583), (0, -50, 0), (5.4193187, -49.03926, 8.110583), (3.7328918, -49.03926, 9.011998), (0, -50, 0), (3.7328918, -49.03926, 9.011998), (1.9030117, -49.03926, 9.567085), (0, -50, 0), (1.9030117, -49.03926, 9.567085), (5.9729185e-16, -49.03926, 9.754517), (0, -50, 0), (5.9729185e-16, -49.03926, 9.754517), (-1.9030117, -49.03926, 9.567085), (0, -50, 0), (-1.9030117, -49.03926, 9.567085), (-3.7328918, -49.03926, 9.011998), (0, -50, 0), (-3.7328918, -49.03926, 9.011998), (-5.4193187, -49.03926, 8.110583), (0, -50, 0), (-5.4193187, -49.03926, 8.110583), (-6.8974843, -49.03926, 6.8974843), (0, -50, 0), (-6.8974843, -49.03926, 6.8974843), (-8.110583, -49.03926, 5.4193187), (0, -50, 0), (-8.110583, -49.03926, 5.4193187), (-9.011998, -49.03926, 3.7328918), (0, -50, 0), (-9.011998, -49.03926, 3.7328918), (-9.567085, -49.03926, 1.9030117), (0, -50, 0), (-9.567085, -49.03926, 1.9030117), (-9.754517, -49.03926, 1.1945837e-15), (0, -50, 0), (-9.754517, -49.03926, 1.1945837e-15), (-9.567085, -49.03926, -1.9030117), (0, -50, 0), (-9.567085, -49.03926, -1.9030117), (-9.011998, -49.03926, -3.7328918), (0, -50, 0), (-9.011998, -49.03926, -3.7328918), (-8.110583, -49.03926, -5.4193187), (0, -50, 0), (-8.110583, -49.03926, -5.4193187), (-6.8974843, -49.03926, -6.8974843), (0, -50, 0), (-6.8974843, -49.03926, -6.8974843), (-5.4193187, -49.03926, -8.110583), (0, -50, 0), (-5.4193187, -49.03926, -8.110583), (-3.7328918, -49.03926, -9.011998), (0, -50, 0), (-3.7328918, -49.03926, -9.011998), (-1.9030117, -49.03926, -9.567085), (0, -50, 0), (-1.9030117, -49.03926, -9.567085), (-1.7918755e-15, -49.03926, -9.754517), (0, -50, 0), (-1.7918755e-15, -49.03926, -9.754517), (1.9030117, -49.03926, -9.567085), (0, -50, 0), (1.9030117, -49.03926, -9.567085), (3.7328918, -49.03926, -9.011998), (0, -50, 0), (3.7328918, -49.03926, -9.011998), (5.4193187, -49.03926, -8.110583), (0, -50, 0), (5.4193187, -49.03926, -8.110583), (6.8974843, -49.03926, -6.8974843), (0, -50, 0), (6.8974843, -49.03926, -6.8974843), (8.110583, -49.03926, -5.4193187), (0, -50, 0), (8.110583, -49.03926, -5.4193187), (9.011998, -49.03926, -3.7328918), (0, -50, 0), (9.011998, -49.03926, -3.7328918), (9.567085, -49.03926, -1.9030117), (0, -50, 0), (9.567085, -49.03926, -1.9030117), (9.754517, -49.03926, 0), (9.754517, -49.03926, 0), (19.13417, -46.193974, 0), (18.766514, -46.193974, 3.7328918), (9.567085, -49.03926, 1.9030117), (9.567085, -49.03926, 1.9030117), (18.766514, -46.193974, 3.7328918), (17.67767, -46.193974, 7.322331), (9.011998, -49.03926, 3.7328918), (9.011998, -49.03926, 3.7328918), (17.67767, -46.193974, 7.322331), (15.909483, -46.193974, 10.630376), (8.110583, -49.03926, 5.4193187), (8.110583, -49.03926, 5.4193187), (15.909483, -46.193974, 10.630376), (13.529902, -46.193974, 13.529902), (6.8974843, -49.03926, 6.8974843), (6.8974843, -49.03926, 6.8974843), (13.529902, -46.193974, 13.529902), (10.630376, -46.193974, 15.909483), (5.4193187, -49.03926, 8.110583), (5.4193187, -49.03926, 8.110583), (10.630376, -46.193974, 15.909483), (7.322331, -46.193974, 17.67767), (3.7328918, -49.03926, 9.011998), (3.7328918, -49.03926, 9.011998), (7.322331, -46.193974, 17.67767), (3.7328918, -46.193974, 18.766514), (1.9030117, -49.03926, 9.567085), (1.9030117, -49.03926, 9.567085), (3.7328918, -46.193974, 18.766514), (1.1716302e-15, -46.193974, 19.13417), (5.9729185e-16, -49.03926, 9.754517), (5.9729185e-16, -49.03926, 9.754517), (1.1716302e-15, -46.193974, 19.13417), (-3.7328918, -46.193974, 18.766514), (-1.9030117, -49.03926, 9.567085), (-1.9030117, -49.03926, 9.567085), (-3.7328918, -46.193974, 18.766514), (-7.322331, -46.193974, 17.67767), (-3.7328918, -49.03926, 9.011998), (-3.7328918, -49.03926, 9.011998), (-7.322331, -46.193974, 17.67767), (-10.630376, -46.193974, 15.909483), (-5.4193187, -49.03926, 8.110583), (-5.4193187, -49.03926, 8.110583), (-10.630376, -46.193974, 15.909483), (-13.529902, -46.193974, 13.529902), (-6.8974843, -49.03926, 6.8974843), (-6.8974843, -49.03926, 6.8974843), (-13.529902, -46.193974, 13.529902), (-15.909483, -46.193974, 10.630376), (-8.110583, -49.03926, 5.4193187), (-8.110583, -49.03926, 5.4193187), (-15.909483, -46.193974, 10.630376), (-17.67767, -46.193974, 7.322331), (-9.011998, -49.03926, 3.7328918), (-9.011998, -49.03926, 3.7328918), (-17.67767, -46.193974, 7.322331), (-18.766514, -46.193974, 3.7328918), (-9.567085, -49.03926, 1.9030117), (-9.567085, -49.03926, 1.9030117), (-18.766514, -46.193974, 3.7328918), (-19.13417, -46.193974, 2.3432603e-15), (-9.754517, -49.03926, 1.1945837e-15), (-9.754517, -49.03926, 1.1945837e-15), (-19.13417, -46.193974, 2.3432603e-15), (-18.766514, -46.193974, -3.7328918), (-9.567085, -49.03926, -1.9030117), (-9.567085, -49.03926, -1.9030117), (-18.766514, -46.193974, -3.7328918), (-17.67767, -46.193974, -7.322331), (-9.011998, -49.03926, -3.7328918), (-9.011998, -49.03926, -3.7328918), (-17.67767, -46.193974, -7.322331), (-15.909483, -46.193974, -10.630376), (-8.110583, -49.03926, -5.4193187), (-8.110583, -49.03926, -5.4193187), (-15.909483, -46.193974, -10.630376), (-13.529902, -46.193974, -13.529902), (-6.8974843, -49.03926, -6.8974843), (-6.8974843, -49.03926, -6.8974843), (-13.529902, -46.193974, -13.529902), (-10.630376, -46.193974, -15.909483), (-5.4193187, -49.03926, -8.110583), (-5.4193187, -49.03926, -8.110583), (-10.630376, -46.193974, -15.909483), (-7.322331, -46.193974, -17.67767), (-3.7328918, -49.03926, -9.011998), (-3.7328918, -49.03926, -9.011998), (-7.322331, -46.193974, -17.67767), (-3.7328918, -46.193974, -18.766514), (-1.9030117, -49.03926, -9.567085), (-1.9030117, -49.03926, -9.567085), (-3.7328918, -46.193974, -18.766514), (-3.5148903e-15, -46.193974, -19.13417), (-1.7918755e-15, -49.03926, -9.754517), (-1.7918755e-15, -49.03926, -9.754517), (-3.5148903e-15, -46.193974, -19.13417), (3.7328918, -46.193974, -18.766514), (1.9030117, -49.03926, -9.567085), (1.9030117, -49.03926, -9.567085), (3.7328918, -46.193974, -18.766514), (7.322331, -46.193974, -17.67767), (3.7328918, -49.03926, -9.011998), (3.7328918, -49.03926, -9.011998), (7.322331, -46.193974, -17.67767), (10.630376, -46.193974, -15.909483), (5.4193187, -49.03926, -8.110583), (5.4193187, -49.03926, -8.110583), (10.630376, -46.193974, -15.909483), (13.529902, -46.193974, -13.529902), (6.8974843, -49.03926, -6.8974843), (6.8974843, -49.03926, -6.8974843), (13.529902, -46.193974, -13.529902), (15.909483, -46.193974, -10.630376), (8.110583, -49.03926, -5.4193187), (8.110583, -49.03926, -5.4193187), (15.909483, -46.193974, -10.630376), (17.67767, -46.193974, -7.322331), (9.011998, -49.03926, -3.7328918), (9.011998, -49.03926, -3.7328918), (17.67767, -46.193974, -7.322331), (18.766514, -46.193974, -3.7328918), (9.567085, -49.03926, -1.9030117), (9.567085, -49.03926, -1.9030117), (18.766514, -46.193974, -3.7328918), (19.13417, -46.193974, 0), (9.754517, -49.03926, 0), (19.13417, -46.193974, 0), (27.778513, -41.57348, 0), (27.244755, -41.57348, 5.4193187), (18.766514, -46.193974, 3.7328918), (18.766514, -46.193974, 3.7328918), (27.244755, -41.57348, 5.4193187), (25.664, -41.57348, 10.630376), (17.67767, -46.193974, 7.322331), (17.67767, -46.193974, 7.322331), (25.664, -41.57348, 10.630376), (23.096987, -41.57348, 15.432914), (15.909483, -46.193974, 10.630376), (15.909483, -46.193974, 10.630376), (23.096987, -41.57348, 15.432914), (19.642374, -41.57348, 19.642374), (13.529902, -46.193974, 13.529902), (13.529902, -46.193974, 13.529902), (19.642374, -41.57348, 19.642374), (15.432914, -41.57348, 23.096987), (10.630376, -46.193974, 15.909483), (10.630376, -46.193974, 15.909483), (15.432914, -41.57348, 23.096987), (10.630376, -41.57348, 25.664), (7.322331, -46.193974, 17.67767), (7.322331, -46.193974, 17.67767), (10.630376, -41.57348, 25.664), (5.4193187, -41.57348, 27.244755), (3.7328918, -46.193974, 18.766514), (3.7328918, -46.193974, 18.766514), (5.4193187, -41.57348, 27.244755), (1.7009433e-15, -41.57348, 27.778513), (1.1716302e-15, -46.193974, 19.13417), (1.1716302e-15, -46.193974, 19.13417), (1.7009433e-15, -41.57348, 27.778513), (-5.4193187, -41.57348, 27.244755), (-3.7328918, -46.193974, 18.766514), (-3.7328918, -46.193974, 18.766514), (-5.4193187, -41.57348, 27.244755), (-10.630376, -41.57348, 25.664), (-7.322331, -46.193974, 17.67767), (-7.322331, -46.193974, 17.67767), (-10.630376, -41.57348, 25.664), (-15.432914, -41.57348, 23.096987), (-10.630376, -46.193974, 15.909483), (-10.630376, -46.193974, 15.909483), (-15.432914, -41.57348, 23.096987), (-19.642374, -41.57348, 19.642374), (-13.529902, -46.193974, 13.529902), (-13.529902, -46.193974, 13.529902), (-19.642374, -41.57348, 19.642374), (-23.096987, -41.57348, 15.432914), (-15.909483, -46.193974, 10.630376), (-15.909483, -46.193974, 10.630376), (-23.096987, -41.57348, 15.432914), (-25.664, -41.57348, 10.630376), (-17.67767, -46.193974, 7.322331), (-17.67767, -46.193974, 7.322331), (-25.664, -41.57348, 10.630376), (-27.244755, -41.57348, 5.4193187), (-18.766514, -46.193974, 3.7328918), (-18.766514, -46.193974, 3.7328918), (-27.244755, -41.57348, 5.4193187), (-27.778513, -41.57348, 3.4018865e-15), (-19.13417, -46.193974, 2.3432603e-15), (-19.13417, -46.193974, 2.3432603e-15), (-27.778513, -41.57348, 3.4018865e-15), (-27.244755, -41.57348, -5.4193187), (-18.766514, -46.193974, -3.7328918), (-18.766514, -46.193974, -3.7328918), (-27.244755, -41.57348, -5.4193187), (-25.664, -41.57348, -10.630376), (-17.67767, -46.193974, -7.322331), (-17.67767, -46.193974, -7.322331), (-25.664, -41.57348, -10.630376), (-23.096987, -41.57348, -15.432914), (-15.909483, -46.193974, -10.630376), (-15.909483, -46.193974, -10.630376), (-23.096987, -41.57348, -15.432914), (-19.642374, -41.57348, -19.642374), (-13.529902, -46.193974, -13.529902), (-13.529902, -46.193974, -13.529902), (-19.642374, -41.57348, -19.642374), (-15.432914, -41.57348, -23.096987), (-10.630376, -46.193974, -15.909483), (-10.630376, -46.193974, -15.909483), (-15.432914, -41.57348, -23.096987), (-10.630376, -41.57348, -25.664), (-7.322331, -46.193974, -17.67767), (-7.322331, -46.193974, -17.67767), (-10.630376, -41.57348, -25.664), (-5.4193187, -41.57348, -27.244755), (-3.7328918, -46.193974, -18.766514), (-3.7328918, -46.193974, -18.766514), (-5.4193187, -41.57348, -27.244755), (-5.1028297e-15, -41.57348, -27.778513), (-3.5148903e-15, -46.193974, -19.13417), (-3.5148903e-15, -46.193974, -19.13417), (-5.1028297e-15, -41.57348, -27.778513), (5.4193187, -41.57348, -27.244755), (3.7328918, -46.193974, -18.766514), (3.7328918, -46.193974, -18.766514), (5.4193187, -41.57348, -27.244755), (10.630376, -41.57348, -25.664), (7.322331, -46.193974, -17.67767), (7.322331, -46.193974, -17.67767), (10.630376, -41.57348, -25.664), (15.432914, -41.57348, -23.096987), (10.630376, -46.193974, -15.909483), (10.630376, -46.193974, -15.909483), (15.432914, -41.57348, -23.096987), (19.642374, -41.57348, -19.642374), (13.529902, -46.193974, -13.529902), (13.529902, -46.193974, -13.529902), (19.642374, -41.57348, -19.642374), (23.096987, -41.57348, -15.432914), (15.909483, -46.193974, -10.630376), (15.909483, -46.193974, -10.630376), (23.096987, -41.57348, -15.432914), (25.664, -41.57348, -10.630376), (17.67767, -46.193974, -7.322331), (17.67767, -46.193974, -7.322331), (25.664, -41.57348, -10.630376), (27.244755, -41.57348, -5.4193187), (18.766514, -46.193974, -3.7328918), (18.766514, -46.193974, -3.7328918), (27.244755, -41.57348, -5.4193187), (27.778513, -41.57348, 0), (19.13417, -46.193974, 0), (27.778513, -41.57348, 0), (35.35534, -35.35534, 0), (34.676, -35.35534, 6.8974843), (27.244755, -41.57348, 5.4193187), (27.244755, -41.57348, 5.4193187), (34.676, -35.35534, 6.8974843), (32.664074, -35.35534, 13.529902), (25.664, -41.57348, 10.630376), (25.664, -41.57348, 10.630376), (32.664074, -35.35534, 13.529902), (29.396889, -35.35534, 19.642374), (23.096987, -41.57348, 15.432914), (23.096987, -41.57348, 15.432914), (29.396889, -35.35534, 19.642374), (25, -35.35534, 25), (19.642374, -41.57348, 19.642374), (19.642374, -41.57348, 19.642374), (25, -35.35534, 25), (19.642374, -35.35534, 29.396889), (15.432914, -41.57348, 23.096987), (15.432914, -41.57348, 23.096987), (19.642374, -35.35534, 29.396889), (13.529902, -35.35534, 32.664074), (10.630376, -41.57348, 25.664), (10.630376, -41.57348, 25.664), (13.529902, -35.35534, 32.664074), (6.8974843, -35.35534, 34.676), (5.4193187, -41.57348, 27.244755), (5.4193187, -41.57348, 27.244755), (6.8974843, -35.35534, 34.676), (2.1648902e-15, -35.35534, 35.35534), (1.7009433e-15, -41.57348, 27.778513), (1.7009433e-15, -41.57348, 27.778513), (2.1648902e-15, -35.35534, 35.35534), (-6.8974843, -35.35534, 34.676), (-5.4193187, -41.57348, 27.244755), (-5.4193187, -41.57348, 27.244755), (-6.8974843, -35.35534, 34.676), (-13.529902, -35.35534, 32.664074), (-10.630376, -41.57348, 25.664), (-10.630376, -41.57348, 25.664), (-13.529902, -35.35534, 32.664074), (-19.642374, -35.35534, 29.396889), (-15.432914, -41.57348, 23.096987), (-15.432914, -41.57348, 23.096987), (-19.642374, -35.35534, 29.396889), (-25, -35.35534, 25), (-19.642374, -41.57348, 19.642374), (-19.642374, -41.57348, 19.642374), (-25, -35.35534, 25), (-29.396889, -35.35534, 19.642374), (-23.096987, -41.57348, 15.432914), (-23.096987, -41.57348, 15.432914), (-29.396889, -35.35534, 19.642374), (-32.664074, -35.35534, 13.529902), (-25.664, -41.57348, 10.630376), (-25.664, -41.57348, 10.630376), (-32.664074, -35.35534, 13.529902), (-34.676, -35.35534, 6.8974843), (-27.244755, -41.57348, 5.4193187), (-27.244755, -41.57348, 5.4193187), (-34.676, -35.35534, 6.8974843), (-35.35534, -35.35534, 4.3297804e-15), (-27.778513, -41.57348, 3.4018865e-15), (-27.778513, -41.57348, 3.4018865e-15), (-35.35534, -35.35534, 4.3297804e-15), (-34.676, -35.35534, -6.8974843), (-27.244755, -41.57348, -5.4193187), (-27.244755, -41.57348, -5.4193187), (-34.676, -35.35534, -6.8974843), (-32.664074, -35.35534, -13.529902), (-25.664, -41.57348, -10.630376), (-25.664, -41.57348, -10.630376), (-32.664074, -35.35534, -13.529902), (-29.396889, -35.35534, -19.642374), (-23.096987, -41.57348, -15.432914), (-23.096987, -41.57348, -15.432914), (-29.396889, -35.35534, -19.642374), (-25, -35.35534, -25), (-19.642374, -41.57348, -19.642374), (-19.642374, -41.57348, -19.642374), (-25, -35.35534, -25), (-19.642374, -35.35534, -29.396889), (-15.432914, -41.57348, -23.096987), (-15.432914, -41.57348, -23.096987), (-19.642374, -35.35534, -29.396889), (-13.529902, -35.35534, -32.664074), (-10.630376, -41.57348, -25.664), (-10.630376, -41.57348, -25.664), (-13.529902, -35.35534, -32.664074), (-6.8974843, -35.35534, -34.676), (-5.4193187, -41.57348, -27.244755), (-5.4193187, -41.57348, -27.244755), (-6.8974843, -35.35534, -34.676), (-6.49467e-15, -35.35534, -35.35534), (-5.1028297e-15, -41.57348, -27.778513), (-5.1028297e-15, -41.57348, -27.778513), (-6.49467e-15, -35.35534, -35.35534), (6.8974843, -35.35534, -34.676), (5.4193187, -41.57348, -27.244755), (5.4193187, -41.57348, -27.244755), (6.8974843, -35.35534, -34.676), (13.529902, -35.35534, -32.664074), (10.630376, -41.57348, -25.664), (10.630376, -41.57348, -25.664), (13.529902, -35.35534, -32.664074), (19.642374, -35.35534, -29.396889), (15.432914, -41.57348, -23.096987), (15.432914, -41.57348, -23.096987), (19.642374, -35.35534, -29.396889), (25, -35.35534, -25), (19.642374, -41.57348, -19.642374), (19.642374, -41.57348, -19.642374), (25, -35.35534, -25), (29.396889, -35.35534, -19.642374), (23.096987, -41.57348, -15.432914), (23.096987, -41.57348, -15.432914), (29.396889, -35.35534, -19.642374), (32.664074, -35.35534, -13.529902), (25.664, -41.57348, -10.630376), (25.664, -41.57348, -10.630376), (32.664074, -35.35534, -13.529902), (34.676, -35.35534, -6.8974843), (27.244755, -41.57348, -5.4193187), (27.244755, -41.57348, -5.4193187), (34.676, -35.35534, -6.8974843), (35.35534, -35.35534, 0), (27.778513, -41.57348, 0), (35.35534, -35.35534, 0), (41.57348, -27.778513, 0), (40.77466, -27.778513, 8.110583), (34.676, -35.35534, 6.8974843), (34.676, -35.35534, 6.8974843), (40.77466, -27.778513, 8.110583), (38.408886, -27.778513, 15.909483), (32.664074, -35.35534, 13.529902), (32.664074, -35.35534, 13.529902), (38.408886, -27.778513, 15.909483), (34.567085, -27.778513, 23.096987), (29.396889, -35.35534, 19.642374), (29.396889, -35.35534, 19.642374), (34.567085, -27.778513, 23.096987), (29.396889, -27.778513, 29.396889), (25, -35.35534, 25), (25, -35.35534, 25), (29.396889, -27.778513, 29.396889), (23.096987, -27.778513, 34.567085), (19.642374, -35.35534, 29.396889), (19.642374, -35.35534, 29.396889), (23.096987, -27.778513, 34.567085), (15.909483, -27.778513, 38.408886), (13.529902, -35.35534, 32.664074), (13.529902, -35.35534, 32.664074), (15.909483, -27.778513, 38.408886), (8.110583, -27.778513, 40.77466), (6.8974843, -35.35534, 34.676), (6.8974843, -35.35534, 34.676), (8.110583, -27.778513, 40.77466), (2.5456415e-15, -27.778513, 41.57348), (2.1648902e-15, -35.35534, 35.35534), (2.1648902e-15, -35.35534, 35.35534), (2.5456415e-15, -27.778513, 41.57348), (-8.110583, -27.778513, 40.77466), (-6.8974843, -35.35534, 34.676), (-6.8974843, -35.35534, 34.676), (-8.110583, -27.778513, 40.77466), (-15.909483, -27.778513, 38.408886), (-13.529902, -35.35534, 32.664074), (-13.529902, -35.35534, 32.664074), (-15.909483, -27.778513, 38.408886), (-23.096987, -27.778513, 34.567085), (-19.642374, -35.35534, 29.396889), (-19.642374, -35.35534, 29.396889), (-23.096987, -27.778513, 34.567085), (-29.396889, -27.778513, 29.396889), (-25, -35.35534, 25), (-25, -35.35534, 25), (-29.396889, -27.778513, 29.396889), (-34.567085, -27.778513, 23.096987), (-29.396889, -35.35534, 19.642374), (-29.396889, -35.35534, 19.642374), (-34.567085, -27.778513, 23.096987), (-38.408886, -27.778513, 15.909483), (-32.664074, -35.35534, 13.529902), (-32.664074, -35.35534, 13.529902), (-38.408886, -27.778513, 15.909483), (-40.77466, -27.778513, 8.110583), (-34.676, -35.35534, 6.8974843), (-34.676, -35.35534, 6.8974843), (-40.77466, -27.778513, 8.110583), (-41.57348, -27.778513, 5.091283e-15), (-35.35534, -35.35534, 4.3297804e-15), (-35.35534, -35.35534, 4.3297804e-15), (-41.57348, -27.778513, 5.091283e-15), (-40.77466, -27.778513, -8.110583), (-34.676, -35.35534, -6.8974843), (-34.676, -35.35534, -6.8974843), (-40.77466, -27.778513, -8.110583), (-38.408886, -27.778513, -15.909483), (-32.664074, -35.35534, -13.529902), (-32.664074, -35.35534, -13.529902), (-38.408886, -27.778513, -15.909483), (-34.567085, -27.778513, -23.096987), (-29.396889, -35.35534, -19.642374), (-29.396889, -35.35534, -19.642374), (-34.567085, -27.778513, -23.096987), (-29.396889, -27.778513, -29.396889), (-25, -35.35534, -25), (-25, -35.35534, -25), (-29.396889, -27.778513, -29.396889), (-23.096987, -27.778513, -34.567085), (-19.642374, -35.35534, -29.396889), (-19.642374, -35.35534, -29.396889), (-23.096987, -27.778513, -34.567085), (-15.909483, -27.778513, -38.408886), (-13.529902, -35.35534, -32.664074), (-13.529902, -35.35534, -32.664074), (-15.909483, -27.778513, -38.408886), (-8.110583, -27.778513, -40.77466), (-6.8974843, -35.35534, -34.676), (-6.8974843, -35.35534, -34.676), (-8.110583, -27.778513, -40.77466), (-7.6369244e-15, -27.778513, -41.57348), (-6.49467e-15, -35.35534, -35.35534), (-6.49467e-15, -35.35534, -35.35534), (-7.6369244e-15, -27.778513, -41.57348), (8.110583, -27.778513, -40.77466), (6.8974843, -35.35534, -34.676), (6.8974843, -35.35534, -34.676), (8.110583, -27.778513, -40.77466), (15.909483, -27.778513, -38.408886), (13.529902, -35.35534, -32.664074), (13.529902, -35.35534, -32.664074), (15.909483, -27.778513, -38.408886), (23.096987, -27.778513, -34.567085), (19.642374, -35.35534, -29.396889), (19.642374, -35.35534, -29.396889), (23.096987, -27.778513, -34.567085), (29.396889, -27.778513, -29.396889), (25, -35.35534, -25), (25, -35.35534, -25), (29.396889, -27.778513, -29.396889), (34.567085, -27.778513, -23.096987), (29.396889, -35.35534, -19.642374), (29.396889, -35.35534, -19.642374), (34.567085, -27.778513, -23.096987), (38.408886, -27.778513, -15.909483), (32.664074, -35.35534, -13.529902), (32.664074, -35.35534, -13.529902), (38.408886, -27.778513, -15.909483), (40.77466, -27.778513, -8.110583), (34.676, -35.35534, -6.8974843), (34.676, -35.35534, -6.8974843), (40.77466, -27.778513, -8.110583), (41.57348, -27.778513, 0), (35.35534, -35.35534, 0), (41.57348, -27.778513, 0), (46.193974, -19.13417, 0), (45.306374, -19.13417, 9.011998), (40.77466, -27.778513, 8.110583), (40.77466, -27.778513, 8.110583), (45.306374, -19.13417, 9.011998), (42.67767, -19.13417, 17.67767), (38.408886, -27.778513, 15.909483), (38.408886, -27.778513, 15.909483), (42.67767, -19.13417, 17.67767), (38.408886, -19.13417, 25.664), (34.567085, -27.778513, 23.096987), (34.567085, -27.778513, 23.096987), (38.408886, -19.13417, 25.664), (32.664074, -19.13417, 32.664074), (29.396889, -27.778513, 29.396889), (29.396889, -27.778513, 29.396889), (32.664074, -19.13417, 32.664074), (25.664, -19.13417, 38.408886), (23.096987, -27.778513, 34.567085), (23.096987, -27.778513, 34.567085), (25.664, -19.13417, 38.408886), (17.67767, -19.13417, 42.67767), (15.909483, -27.778513, 38.408886), (15.909483, -27.778513, 38.408886), (17.67767, -19.13417, 42.67767), (9.011998, -19.13417, 45.306374), (8.110583, -27.778513, 40.77466), (8.110583, -27.778513, 40.77466), (9.011998, -19.13417, 45.306374), (2.8285653e-15, -19.13417, 46.193974), (2.5456415e-15, -27.778513, 41.57348), (2.5456415e-15, -27.778513, 41.57348), (2.8285653e-15, -19.13417, 46.193974), (-9.011998, -19.13417, 45.306374), (-8.110583, -27.778513, 40.77466), (-8.110583, -27.778513, 40.77466), (-9.011998, -19.13417, 45.306374), (-17.67767, -19.13417, 42.67767), (-15.909483, -27.778513, 38.408886), (-15.909483, -27.778513, 38.408886), (-17.67767, -19.13417, 42.67767), (-25.664, -19.13417, 38.408886), (-23.096987, -27.778513, 34.567085), (-23.096987, -27.778513, 34.567085), (-25.664, -19.13417, 38.408886), (-32.664074, -19.13417, 32.664074), (-29.396889, -27.778513, 29.396889), (-29.396889, -27.778513, 29.396889), (-32.664074, -19.13417, 32.664074), (-38.408886, -19.13417, 25.664), (-34.567085, -27.778513, 23.096987), (-34.567085, -27.778513, 23.096987), (-38.408886, -19.13417, 25.664), (-42.67767, -19.13417, 17.67767), (-38.408886, -27.778513, 15.909483), (-38.408886, -27.778513, 15.909483), (-42.67767, -19.13417, 17.67767), (-45.306374, -19.13417, 9.011998), (-40.77466, -27.778513, 8.110583), (-40.77466, -27.778513, 8.110583), (-45.306374, -19.13417, 9.011998), (-46.193974, -19.13417, 5.6571306e-15), (-41.57348, -27.778513, 5.091283e-15), (-41.57348, -27.778513, 5.091283e-15), (-46.193974, -19.13417, 5.6571306e-15), (-45.306374, -19.13417, -9.011998), (-40.77466, -27.778513, -8.110583), (-40.77466, -27.778513, -8.110583), (-45.306374, -19.13417, -9.011998), (-42.67767, -19.13417, -17.67767), (-38.408886, -27.778513, -15.909483), (-38.408886, -27.778513, -15.909483), (-42.67767, -19.13417, -17.67767), (-38.408886, -19.13417, -25.664), (-34.567085, -27.778513, -23.096987), (-34.567085, -27.778513, -23.096987), (-38.408886, -19.13417, -25.664), (-32.664074, -19.13417, -32.664074), (-29.396889, -27.778513, -29.396889), (-29.396889, -27.778513, -29.396889), (-32.664074, -19.13417, -32.664074), (-25.664, -19.13417, -38.408886), (-23.096987, -27.778513, -34.567085), (-23.096987, -27.778513, -34.567085), (-25.664, -19.13417, -38.408886), (-17.67767, -19.13417, -42.67767), (-15.909483, -27.778513, -38.408886), (-15.909483, -27.778513, -38.408886), (-17.67767, -19.13417, -42.67767), (-9.011998, -19.13417, -45.306374), (-8.110583, -27.778513, -40.77466), (-8.110583, -27.778513, -40.77466), (-9.011998, -19.13417, -45.306374), (-8.4856955e-15, -19.13417, -46.193974), (-7.6369244e-15, -27.778513, -41.57348), (-7.6369244e-15, -27.778513, -41.57348), (-8.4856955e-15, -19.13417, -46.193974), (9.011998, -19.13417, -45.306374), (8.110583, -27.778513, -40.77466), (8.110583, -27.778513, -40.77466), (9.011998, -19.13417, -45.306374), (17.67767, -19.13417, -42.67767), (15.909483, -27.778513, -38.408886), (15.909483, -27.778513, -38.408886), (17.67767, -19.13417, -42.67767), (25.664, -19.13417, -38.408886), (23.096987, -27.778513, -34.567085), (23.096987, -27.778513, -34.567085), (25.664, -19.13417, -38.408886), (32.664074, -19.13417, -32.664074), (29.396889, -27.778513, -29.396889), (29.396889, -27.778513, -29.396889), (32.664074, -19.13417, -32.664074), (38.408886, -19.13417, -25.664), (34.567085, -27.778513, -23.096987), (34.567085, -27.778513, -23.096987), (38.408886, -19.13417, -25.664), (42.67767, -19.13417, -17.67767), (38.408886, -27.778513, -15.909483), (38.408886, -27.778513, -15.909483), (42.67767, -19.13417, -17.67767), (45.306374, -19.13417, -9.011998), (40.77466, -27.778513, -8.110583), (40.77466, -27.778513, -8.110583), (45.306374, -19.13417, -9.011998), (46.193974, -19.13417, 0), (41.57348, -27.778513, 0), (46.193974, -19.13417, 0), (49.03926, -9.754517, 0), (48.09699, -9.754517, 9.567085), (45.306374, -19.13417, 9.011998), (45.306374, -19.13417, 9.011998), (48.09699, -9.754517, 9.567085), (45.306374, -9.754517, 18.766514), (42.67767, -19.13417, 17.67767), (42.67767, -19.13417, 17.67767), (45.306374, -9.754517, 18.766514), (40.77466, -9.754517, 27.244755), (38.408886, -19.13417, 25.664), (38.408886, -19.13417, 25.664), (40.77466, -9.754517, 27.244755), (34.676, -9.754517, 34.676), (32.664074, -19.13417, 32.664074), (32.664074, -19.13417, 32.664074), (34.676, -9.754517, 34.676), (27.244755, -9.754517, 40.77466), (25.664, -19.13417, 38.408886), (25.664, -19.13417, 38.408886), (27.244755, -9.754517, 40.77466), (18.766514, -9.754517, 45.306374), (17.67767, -19.13417, 42.67767), (17.67767, -19.13417, 42.67767), (18.766514, -9.754517, 45.306374), (9.567085, -9.754517, 48.09699), (9.011998, -19.13417, 45.306374), (9.011998, -19.13417, 45.306374), (9.567085, -9.754517, 48.09699), (3.002789e-15, -9.754517, 49.03926), (2.8285653e-15, -19.13417, 46.193974), (2.8285653e-15, -19.13417, 46.193974), (3.002789e-15, -9.754517, 49.03926), (-9.567085, -9.754517, 48.09699), (-9.011998, -19.13417, 45.306374), (-9.011998, -19.13417, 45.306374), (-9.567085, -9.754517, 48.09699), (-18.766514, -9.754517, 45.306374), (-17.67767, -19.13417, 42.67767), (-17.67767, -19.13417, 42.67767), (-18.766514, -9.754517, 45.306374), (-27.244755, -9.754517, 40.77466), (-25.664, -19.13417, 38.408886), (-25.664, -19.13417, 38.408886), (-27.244755, -9.754517, 40.77466), (-34.676, -9.754517, 34.676), (-32.664074, -19.13417, 32.664074), (-32.664074, -19.13417, 32.664074), (-34.676, -9.754517, 34.676), (-40.77466, -9.754517, 27.244755), (-38.408886, -19.13417, 25.664), (-38.408886, -19.13417, 25.664), (-40.77466, -9.754517, 27.244755), (-45.306374, -9.754517, 18.766514), (-42.67767, -19.13417, 17.67767), (-42.67767, -19.13417, 17.67767), (-45.306374, -9.754517, 18.766514), (-48.09699, -9.754517, 9.567085), (-45.306374, -19.13417, 9.011998), (-45.306374, -19.13417, 9.011998), (-48.09699, -9.754517, 9.567085), (-49.03926, -9.754517, 6.005578e-15), (-46.193974, -19.13417, 5.6571306e-15), (-46.193974, -19.13417, 5.6571306e-15), (-49.03926, -9.754517, 6.005578e-15), (-48.09699, -9.754517, -9.567085), (-45.306374, -19.13417, -9.011998), (-45.306374, -19.13417, -9.011998), (-48.09699, -9.754517, -9.567085), (-45.306374, -9.754517, -18.766514), (-42.67767, -19.13417, -17.67767), (-42.67767, -19.13417, -17.67767), (-45.306374, -9.754517, -18.766514), (-40.77466, -9.754517, -27.244755), (-38.408886, -19.13417, -25.664), (-38.408886, -19.13417, -25.664), (-40.77466, -9.754517, -27.244755), (-34.676, -9.754517, -34.676), (-32.664074, -19.13417, -32.664074), (-32.664074, -19.13417, -32.664074), (-34.676, -9.754517, -34.676), (-27.244755, -9.754517, -40.77466), (-25.664, -19.13417, -38.408886), (-25.664, -19.13417, -38.408886), (-27.244755, -9.754517, -40.77466), (-18.766514, -9.754517, -45.306374), (-17.67767, -19.13417, -42.67767), (-17.67767, -19.13417, -42.67767), (-18.766514, -9.754517, -45.306374), (-9.567085, -9.754517, -48.09699), (-9.011998, -19.13417, -45.306374), (-9.011998, -19.13417, -45.306374), (-9.567085, -9.754517, -48.09699), (-9.0083665e-15, -9.754517, -49.03926), (-8.4856955e-15, -19.13417, -46.193974), (-8.4856955e-15, -19.13417, -46.193974), (-9.0083665e-15, -9.754517, -49.03926), (9.567085, -9.754517, -48.09699), (9.011998, -19.13417, -45.306374), (9.011998, -19.13417, -45.306374), (9.567085, -9.754517, -48.09699), (18.766514, -9.754517, -45.306374), (17.67767, -19.13417, -42.67767), (17.67767, -19.13417, -42.67767), (18.766514, -9.754517, -45.306374), (27.244755, -9.754517, -40.77466), (25.664, -19.13417, -38.408886), (25.664, -19.13417, -38.408886), (27.244755, -9.754517, -40.77466), (34.676, -9.754517, -34.676), (32.664074, -19.13417, -32.664074), (32.664074, -19.13417, -32.664074), (34.676, -9.754517, -34.676), (40.77466, -9.754517, -27.244755), (38.408886, -19.13417, -25.664), (38.408886, -19.13417, -25.664), (40.77466, -9.754517, -27.244755), (45.306374, -9.754517, -18.766514), (42.67767, -19.13417, -17.67767), (42.67767, -19.13417, -17.67767), (45.306374, -9.754517, -18.766514), (48.09699, -9.754517, -9.567085), (45.306374, -19.13417, -9.011998), (45.306374, -19.13417, -9.011998), (48.09699, -9.754517, -9.567085), (49.03926, -9.754517, 0), (46.193974, -19.13417, 0), (49.03926, -9.754517, 0), (50, 0, 0), (49.03926, 0, 9.754517), (48.09699, -9.754517, 9.567085), (48.09699, -9.754517, 9.567085), (49.03926, 0, 9.754517), (46.193974, 0, 19.13417), (45.306374, -9.754517, 18.766514), (45.306374, -9.754517, 18.766514), (46.193974, 0, 19.13417), (41.57348, 0, 27.778513), (40.77466, -9.754517, 27.244755), (40.77466, -9.754517, 27.244755), (41.57348, 0, 27.778513), (35.35534, 0, 35.35534), (34.676, -9.754517, 34.676), (34.676, -9.754517, 34.676), (35.35534, 0, 35.35534), (27.778513, 0, 41.57348), (27.244755, -9.754517, 40.77466), (27.244755, -9.754517, 40.77466), (27.778513, 0, 41.57348), (19.13417, 0, 46.193974), (18.766514, -9.754517, 45.306374), (18.766514, -9.754517, 45.306374), (19.13417, 0, 46.193974), (9.754517, 0, 49.03926), (9.567085, -9.754517, 48.09699), (9.567085, -9.754517, 48.09699), (9.754517, 0, 49.03926), (3.061617e-15, 0, 50), (3.002789e-15, -9.754517, 49.03926), (3.002789e-15, -9.754517, 49.03926), (3.061617e-15, 0, 50), (-9.754517, 0, 49.03926), (-9.567085, -9.754517, 48.09699), (-9.567085, -9.754517, 48.09699), (-9.754517, 0, 49.03926), (-19.13417, 0, 46.193974), (-18.766514, -9.754517, 45.306374), (-18.766514, -9.754517, 45.306374), (-19.13417, 0, 46.193974), (-27.778513, 0, 41.57348), (-27.244755, -9.754517, 40.77466), (-27.244755, -9.754517, 40.77466), (-27.778513, 0, 41.57348), (-35.35534, 0, 35.35534), (-34.676, -9.754517, 34.676), (-34.676, -9.754517, 34.676), (-35.35534, 0, 35.35534), (-41.57348, 0, 27.778513), (-40.77466, -9.754517, 27.244755), (-40.77466, -9.754517, 27.244755), (-41.57348, 0, 27.778513), (-46.193974, 0, 19.13417), (-45.306374, -9.754517, 18.766514), (-45.306374, -9.754517, 18.766514), (-46.193974, 0, 19.13417), (-49.03926, 0, 9.754517), (-48.09699, -9.754517, 9.567085), (-48.09699, -9.754517, 9.567085), (-49.03926, 0, 9.754517), (-50, 0, 6.123234e-15), (-49.03926, -9.754517, 6.005578e-15), (-49.03926, -9.754517, 6.005578e-15), (-50, 0, 6.123234e-15), (-49.03926, 0, -9.754517), (-48.09699, -9.754517, -9.567085), (-48.09699, -9.754517, -9.567085), (-49.03926, 0, -9.754517), (-46.193974, 0, -19.13417), (-45.306374, -9.754517, -18.766514), (-45.306374, -9.754517, -18.766514), (-46.193974, 0, -19.13417), (-41.57348, 0, -27.778513), (-40.77466, -9.754517, -27.244755), (-40.77466, -9.754517, -27.244755), (-41.57348, 0, -27.778513), (-35.35534, 0, -35.35534), (-34.676, -9.754517, -34.676), (-34.676, -9.754517, -34.676), (-35.35534, 0, -35.35534), (-27.778513, 0, -41.57348), (-27.244755, -9.754517, -40.77466), (-27.244755, -9.754517, -40.77466), (-27.778513, 0, -41.57348), (-19.13417, 0, -46.193974), (-18.766514, -9.754517, -45.306374), (-18.766514, -9.754517, -45.306374), (-19.13417, 0, -46.193974), (-9.754517, 0, -49.03926), (-9.567085, -9.754517, -48.09699), (-9.567085, -9.754517, -48.09699), (-9.754517, 0, -49.03926), (-9.184851e-15, 0, -50), (-9.0083665e-15, -9.754517, -49.03926), (-9.0083665e-15, -9.754517, -49.03926), (-9.184851e-15, 0, -50), (9.754517, 0, -49.03926), (9.567085, -9.754517, -48.09699), (9.567085, -9.754517, -48.09699), (9.754517, 0, -49.03926), (19.13417, 0, -46.193974), (18.766514, -9.754517, -45.306374), (18.766514, -9.754517, -45.306374), (19.13417, 0, -46.193974), (27.778513, 0, -41.57348), (27.244755, -9.754517, -40.77466), (27.244755, -9.754517, -40.77466), (27.778513, 0, -41.57348), (35.35534, 0, -35.35534), (34.676, -9.754517, -34.676), (34.676, -9.754517, -34.676), (35.35534, 0, -35.35534), (41.57348, 0, -27.778513), (40.77466, -9.754517, -27.244755), (40.77466, -9.754517, -27.244755), (41.57348, 0, -27.778513), (46.193974, 0, -19.13417), (45.306374, -9.754517, -18.766514), (45.306374, -9.754517, -18.766514), (46.193974, 0, -19.13417), (49.03926, 0, -9.754517), (48.09699, -9.754517, -9.567085), (48.09699, -9.754517, -9.567085), (49.03926, 0, -9.754517), (50, 0, 0), (49.03926, -9.754517, 0), (50, 0, 0), (49.03926, 9.754517, 0), (48.09699, 9.754517, 9.567085), (49.03926, 0, 9.754517), (49.03926, 0, 9.754517), (48.09699, 9.754517, 9.567085), (45.306374, 9.754517, 18.766514), (46.193974, 0, 19.13417), (46.193974, 0, 19.13417), (45.306374, 9.754517, 18.766514), (40.77466, 9.754517, 27.244755), (41.57348, 0, 27.778513), (41.57348, 0, 27.778513), (40.77466, 9.754517, 27.244755), (34.676, 9.754517, 34.676), (35.35534, 0, 35.35534), (35.35534, 0, 35.35534), (34.676, 9.754517, 34.676), (27.244755, 9.754517, 40.77466), (27.778513, 0, 41.57348), (27.778513, 0, 41.57348), (27.244755, 9.754517, 40.77466), (18.766514, 9.754517, 45.306374), (19.13417, 0, 46.193974), (19.13417, 0, 46.193974), (18.766514, 9.754517, 45.306374), (9.567085, 9.754517, 48.09699), (9.754517, 0, 49.03926), (9.754517, 0, 49.03926), (9.567085, 9.754517, 48.09699), (3.002789e-15, 9.754517, 49.03926), (3.061617e-15, 0, 50), (3.061617e-15, 0, 50), (3.002789e-15, 9.754517, 49.03926), (-9.567085, 9.754517, 48.09699), (-9.754517, 0, 49.03926), (-9.754517, 0, 49.03926), (-9.567085, 9.754517, 48.09699), (-18.766514, 9.754517, 45.306374), (-19.13417, 0, 46.193974), (-19.13417, 0, 46.193974), (-18.766514, 9.754517, 45.306374), (-27.244755, 9.754517, 40.77466), (-27.778513, 0, 41.57348), (-27.778513, 0, 41.57348), (-27.244755, 9.754517, 40.77466), (-34.676, 9.754517, 34.676), (-35.35534, 0, 35.35534), (-35.35534, 0, 35.35534), (-34.676, 9.754517, 34.676), (-40.77466, 9.754517, 27.244755), (-41.57348, 0, 27.778513), (-41.57348, 0, 27.778513), (-40.77466, 9.754517, 27.244755), (-45.306374, 9.754517, 18.766514), (-46.193974, 0, 19.13417), (-46.193974, 0, 19.13417), (-45.306374, 9.754517, 18.766514), (-48.09699, 9.754517, 9.567085), (-49.03926, 0, 9.754517), (-49.03926, 0, 9.754517), (-48.09699, 9.754517, 9.567085), (-49.03926, 9.754517, 6.005578e-15), (-50, 0, 6.123234e-15), (-50, 0, 6.123234e-15), (-49.03926, 9.754517, 6.005578e-15), (-48.09699, 9.754517, -9.567085), (-49.03926, 0, -9.754517), (-49.03926, 0, -9.754517), (-48.09699, 9.754517, -9.567085), (-45.306374, 9.754517, -18.766514), (-46.193974, 0, -19.13417), (-46.193974, 0, -19.13417), (-45.306374, 9.754517, -18.766514), (-40.77466, 9.754517, -27.244755), (-41.57348, 0, -27.778513), (-41.57348, 0, -27.778513), (-40.77466, 9.754517, -27.244755), (-34.676, 9.754517, -34.676), (-35.35534, 0, -35.35534), (-35.35534, 0, -35.35534), (-34.676, 9.754517, -34.676), (-27.244755, 9.754517, -40.77466), (-27.778513, 0, -41.57348), (-27.778513, 0, -41.57348), (-27.244755, 9.754517, -40.77466), (-18.766514, 9.754517, -45.306374), (-19.13417, 0, -46.193974), (-19.13417, 0, -46.193974), (-18.766514, 9.754517, -45.306374), (-9.567085, 9.754517, -48.09699), (-9.754517, 0, -49.03926), (-9.754517, 0, -49.03926), (-9.567085, 9.754517, -48.09699), (-9.0083665e-15, 9.754517, -49.03926), (-9.184851e-15, 0, -50), (-9.184851e-15, 0, -50), (-9.0083665e-15, 9.754517, -49.03926), (9.567085, 9.754517, -48.09699), (9.754517, 0, -49.03926), (9.754517, 0, -49.03926), (9.567085, 9.754517, -48.09699), (18.766514, 9.754517, -45.306374), (19.13417, 0, -46.193974), (19.13417, 0, -46.193974), (18.766514, 9.754517, -45.306374), (27.244755, 9.754517, -40.77466), (27.778513, 0, -41.57348), (27.778513, 0, -41.57348), (27.244755, 9.754517, -40.77466), (34.676, 9.754517, -34.676), (35.35534, 0, -35.35534), (35.35534, 0, -35.35534), (34.676, 9.754517, -34.676), (40.77466, 9.754517, -27.244755), (41.57348, 0, -27.778513), (41.57348, 0, -27.778513), (40.77466, 9.754517, -27.244755), (45.306374, 9.754517, -18.766514), (46.193974, 0, -19.13417), (46.193974, 0, -19.13417), (45.306374, 9.754517, -18.766514), (48.09699, 9.754517, -9.567085), (49.03926, 0, -9.754517), (49.03926, 0, -9.754517), (48.09699, 9.754517, -9.567085), (49.03926, 9.754517, 0), (50, 0, 0), (49.03926, 9.754517, 0), (46.193974, 19.13417, 0), (45.306374, 19.13417, 9.011998), (48.09699, 9.754517, 9.567085), (48.09699, 9.754517, 9.567085), (45.306374, 19.13417, 9.011998), (42.67767, 19.13417, 17.67767), (45.306374, 9.754517, 18.766514), (45.306374, 9.754517, 18.766514), (42.67767, 19.13417, 17.67767), (38.408886, 19.13417, 25.664), (40.77466, 9.754517, 27.244755), (40.77466, 9.754517, 27.244755), (38.408886, 19.13417, 25.664), (32.664074, 19.13417, 32.664074), (34.676, 9.754517, 34.676), (34.676, 9.754517, 34.676), (32.664074, 19.13417, 32.664074), (25.664, 19.13417, 38.408886), (27.244755, 9.754517, 40.77466), (27.244755, 9.754517, 40.77466), (25.664, 19.13417, 38.408886), (17.67767, 19.13417, 42.67767), (18.766514, 9.754517, 45.306374), (18.766514, 9.754517, 45.306374), (17.67767, 19.13417, 42.67767), (9.011998, 19.13417, 45.306374), (9.567085, 9.754517, 48.09699), (9.567085, 9.754517, 48.09699), (9.011998, 19.13417, 45.306374), (2.8285653e-15, 19.13417, 46.193974), (3.002789e-15, 9.754517, 49.03926), (3.002789e-15, 9.754517, 49.03926), (2.8285653e-15, 19.13417, 46.193974), (-9.011998, 19.13417, 45.306374), (-9.567085, 9.754517, 48.09699), (-9.567085, 9.754517, 48.09699), (-9.011998, 19.13417, 45.306374), (-17.67767, 19.13417, 42.67767), (-18.766514, 9.754517, 45.306374), (-18.766514, 9.754517, 45.306374), (-17.67767, 19.13417, 42.67767), (-25.664, 19.13417, 38.408886), (-27.244755, 9.754517, 40.77466), (-27.244755, 9.754517, 40.77466), (-25.664, 19.13417, 38.408886), (-32.664074, 19.13417, 32.664074), (-34.676, 9.754517, 34.676), (-34.676, 9.754517, 34.676), (-32.664074, 19.13417, 32.664074), (-38.408886, 19.13417, 25.664), (-40.77466, 9.754517, 27.244755), (-40.77466, 9.754517, 27.244755), (-38.408886, 19.13417, 25.664), (-42.67767, 19.13417, 17.67767), (-45.306374, 9.754517, 18.766514), (-45.306374, 9.754517, 18.766514), (-42.67767, 19.13417, 17.67767), (-45.306374, 19.13417, 9.011998), (-48.09699, 9.754517, 9.567085), (-48.09699, 9.754517, 9.567085), (-45.306374, 19.13417, 9.011998), (-46.193974, 19.13417, 5.6571306e-15), (-49.03926, 9.754517, 6.005578e-15), (-49.03926, 9.754517, 6.005578e-15), (-46.193974, 19.13417, 5.6571306e-15), (-45.306374, 19.13417, -9.011998), (-48.09699, 9.754517, -9.567085), (-48.09699, 9.754517, -9.567085), (-45.306374, 19.13417, -9.011998), (-42.67767, 19.13417, -17.67767), (-45.306374, 9.754517, -18.766514), (-45.306374, 9.754517, -18.766514), (-42.67767, 19.13417, -17.67767), (-38.408886, 19.13417, -25.664), (-40.77466, 9.754517, -27.244755), (-40.77466, 9.754517, -27.244755), (-38.408886, 19.13417, -25.664), (-32.664074, 19.13417, -32.664074), (-34.676, 9.754517, -34.676), (-34.676, 9.754517, -34.676), (-32.664074, 19.13417, -32.664074), (-25.664, 19.13417, -38.408886), (-27.244755, 9.754517, -40.77466), (-27.244755, 9.754517, -40.77466), (-25.664, 19.13417, -38.408886), (-17.67767, 19.13417, -42.67767), (-18.766514, 9.754517, -45.306374), (-18.766514, 9.754517, -45.306374), (-17.67767, 19.13417, -42.67767), (-9.011998, 19.13417, -45.306374), (-9.567085, 9.754517, -48.09699), (-9.567085, 9.754517, -48.09699), (-9.011998, 19.13417, -45.306374), (-8.4856955e-15, 19.13417, -46.193974), (-9.0083665e-15, 9.754517, -49.03926), (-9.0083665e-15, 9.754517, -49.03926), (-8.4856955e-15, 19.13417, -46.193974), (9.011998, 19.13417, -45.306374), (9.567085, 9.754517, -48.09699), (9.567085, 9.754517, -48.09699), (9.011998, 19.13417, -45.306374), (17.67767, 19.13417, -42.67767), (18.766514, 9.754517, -45.306374), (18.766514, 9.754517, -45.306374), (17.67767, 19.13417, -42.67767), (25.664, 19.13417, -38.408886), (27.244755, 9.754517, -40.77466), (27.244755, 9.754517, -40.77466), (25.664, 19.13417, -38.408886), (32.664074, 19.13417, -32.664074), (34.676, 9.754517, -34.676), (34.676, 9.754517, -34.676), (32.664074, 19.13417, -32.664074), (38.408886, 19.13417, -25.664), (40.77466, 9.754517, -27.244755), (40.77466, 9.754517, -27.244755), (38.408886, 19.13417, -25.664), (42.67767, 19.13417, -17.67767), (45.306374, 9.754517, -18.766514), (45.306374, 9.754517, -18.766514), (42.67767, 19.13417, -17.67767), (45.306374, 19.13417, -9.011998), (48.09699, 9.754517, -9.567085), (48.09699, 9.754517, -9.567085), (45.306374, 19.13417, -9.011998), (46.193974, 19.13417, 0), (49.03926, 9.754517, 0), (46.193974, 19.13417, 0), (41.57348, 27.778513, 0), (40.77466, 27.778513, 8.110583), (45.306374, 19.13417, 9.011998), (45.306374, 19.13417, 9.011998), (40.77466, 27.778513, 8.110583), (38.408886, 27.778513, 15.909483), (42.67767, 19.13417, 17.67767), (42.67767, 19.13417, 17.67767), (38.408886, 27.778513, 15.909483), (34.567085, 27.778513, 23.096987), (38.408886, 19.13417, 25.664), (38.408886, 19.13417, 25.664), (34.567085, 27.778513, 23.096987), (29.396889, 27.778513, 29.396889), (32.664074, 19.13417, 32.664074), (32.664074, 19.13417, 32.664074), (29.396889, 27.778513, 29.396889), (23.096987, 27.778513, 34.567085), (25.664, 19.13417, 38.408886), (25.664, 19.13417, 38.408886), (23.096987, 27.778513, 34.567085), (15.909483, 27.778513, 38.408886), (17.67767, 19.13417, 42.67767), (17.67767, 19.13417, 42.67767), (15.909483, 27.778513, 38.408886), (8.110583, 27.778513, 40.77466), (9.011998, 19.13417, 45.306374), (9.011998, 19.13417, 45.306374), (8.110583, 27.778513, 40.77466), (2.5456415e-15, 27.778513, 41.57348), (2.8285653e-15, 19.13417, 46.193974), (2.8285653e-15, 19.13417, 46.193974), (2.5456415e-15, 27.778513, 41.57348), (-8.110583, 27.778513, 40.77466), (-9.011998, 19.13417, 45.306374), (-9.011998, 19.13417, 45.306374), (-8.110583, 27.778513, 40.77466), (-15.909483, 27.778513, 38.408886), (-17.67767, 19.13417, 42.67767), (-17.67767, 19.13417, 42.67767), (-15.909483, 27.778513, 38.408886), (-23.096987, 27.778513, 34.567085), (-25.664, 19.13417, 38.408886), (-25.664, 19.13417, 38.408886), (-23.096987, 27.778513, 34.567085), (-29.396889, 27.778513, 29.396889), (-32.664074, 19.13417, 32.664074), (-32.664074, 19.13417, 32.664074), (-29.396889, 27.778513, 29.396889), (-34.567085, 27.778513, 23.096987), (-38.408886, 19.13417, 25.664), (-38.408886, 19.13417, 25.664), (-34.567085, 27.778513, 23.096987), (-38.408886, 27.778513, 15.909483), (-42.67767, 19.13417, 17.67767), (-42.67767, 19.13417, 17.67767), (-38.408886, 27.778513, 15.909483), (-40.77466, 27.778513, 8.110583), (-45.306374, 19.13417, 9.011998), (-45.306374, 19.13417, 9.011998), (-40.77466, 27.778513, 8.110583), (-41.57348, 27.778513, 5.091283e-15), (-46.193974, 19.13417, 5.6571306e-15), (-46.193974, 19.13417, 5.6571306e-15), (-41.57348, 27.778513, 5.091283e-15), (-40.77466, 27.778513, -8.110583), (-45.306374, 19.13417, -9.011998), (-45.306374, 19.13417, -9.011998), (-40.77466, 27.778513, -8.110583), (-38.408886, 27.778513, -15.909483), (-42.67767, 19.13417, -17.67767), (-42.67767, 19.13417, -17.67767), (-38.408886, 27.778513, -15.909483), (-34.567085, 27.778513, -23.096987), (-38.408886, 19.13417, -25.664), (-38.408886, 19.13417, -25.664), (-34.567085, 27.778513, -23.096987), (-29.396889, 27.778513, -29.396889), (-32.664074, 19.13417, -32.664074), (-32.664074, 19.13417, -32.664074), (-29.396889, 27.778513, -29.396889), (-23.096987, 27.778513, -34.567085), (-25.664, 19.13417, -38.408886), (-25.664, 19.13417, -38.408886), (-23.096987, 27.778513, -34.567085), (-15.909483, 27.778513, -38.408886), (-17.67767, 19.13417, -42.67767), (-17.67767, 19.13417, -42.67767), (-15.909483, 27.778513, -38.408886), (-8.110583, 27.778513, -40.77466), (-9.011998, 19.13417, -45.306374), (-9.011998, 19.13417, -45.306374), (-8.110583, 27.778513, -40.77466), (-7.6369244e-15, 27.778513, -41.57348), (-8.4856955e-15, 19.13417, -46.193974), (-8.4856955e-15, 19.13417, -46.193974), (-7.6369244e-15, 27.778513, -41.57348), (8.110583, 27.778513, -40.77466), (9.011998, 19.13417, -45.306374), (9.011998, 19.13417, -45.306374), (8.110583, 27.778513, -40.77466), (15.909483, 27.778513, -38.408886), (17.67767, 19.13417, -42.67767), (17.67767, 19.13417, -42.67767), (15.909483, 27.778513, -38.408886), (23.096987, 27.778513, -34.567085), (25.664, 19.13417, -38.408886), (25.664, 19.13417, -38.408886), (23.096987, 27.778513, -34.567085), (29.396889, 27.778513, -29.396889), (32.664074, 19.13417, -32.664074), (32.664074, 19.13417, -32.664074), (29.396889, 27.778513, -29.396889), (34.567085, 27.778513, -23.096987), (38.408886, 19.13417, -25.664), (38.408886, 19.13417, -25.664), (34.567085, 27.778513, -23.096987), (38.408886, 27.778513, -15.909483), (42.67767, 19.13417, -17.67767), (42.67767, 19.13417, -17.67767), (38.408886, 27.778513, -15.909483), (40.77466, 27.778513, -8.110583), (45.306374, 19.13417, -9.011998), (45.306374, 19.13417, -9.011998), (40.77466, 27.778513, -8.110583), (41.57348, 27.778513, 0), (46.193974, 19.13417, 0), (41.57348, 27.778513, 0), (35.35534, 35.35534, 0), (34.676, 35.35534, 6.8974843), (40.77466, 27.778513, 8.110583), (40.77466, 27.778513, 8.110583), (34.676, 35.35534, 6.8974843), (32.664074, 35.35534, 13.529902), (38.408886, 27.778513, 15.909483), (38.408886, 27.778513, 15.909483), (32.664074, 35.35534, 13.529902), (29.396889, 35.35534, 19.642374), (34.567085, 27.778513, 23.096987), (34.567085, 27.778513, 23.096987), (29.396889, 35.35534, 19.642374), (25, 35.35534, 25), (29.396889, 27.778513, 29.396889), (29.396889, 27.778513, 29.396889), (25, 35.35534, 25), (19.642374, 35.35534, 29.396889), (23.096987, 27.778513, 34.567085), (23.096987, 27.778513, 34.567085), (19.642374, 35.35534, 29.396889), (13.529902, 35.35534, 32.664074), (15.909483, 27.778513, 38.408886), (15.909483, 27.778513, 38.408886), (13.529902, 35.35534, 32.664074), (6.8974843, 35.35534, 34.676), (8.110583, 27.778513, 40.77466), (8.110583, 27.778513, 40.77466), (6.8974843, 35.35534, 34.676), (2.1648902e-15, 35.35534, 35.35534), (2.5456415e-15, 27.778513, 41.57348), (2.5456415e-15, 27.778513, 41.57348), (2.1648902e-15, 35.35534, 35.35534), (-6.8974843, 35.35534, 34.676), (-8.110583, 27.778513, 40.77466), (-8.110583, 27.778513, 40.77466), (-6.8974843, 35.35534, 34.676), (-13.529902, 35.35534, 32.664074), (-15.909483, 27.778513, 38.408886), (-15.909483, 27.778513, 38.408886), (-13.529902, 35.35534, 32.664074), (-19.642374, 35.35534, 29.396889), (-23.096987, 27.778513, 34.567085), (-23.096987, 27.778513, 34.567085), (-19.642374, 35.35534, 29.396889), (-25, 35.35534, 25), (-29.396889, 27.778513, 29.396889), (-29.396889, 27.778513, 29.396889), (-25, 35.35534, 25), (-29.396889, 35.35534, 19.642374), (-34.567085, 27.778513, 23.096987), (-34.567085, 27.778513, 23.096987), (-29.396889, 35.35534, 19.642374), (-32.664074, 35.35534, 13.529902), (-38.408886, 27.778513, 15.909483), (-38.408886, 27.778513, 15.909483), (-32.664074, 35.35534, 13.529902), (-34.676, 35.35534, 6.8974843), (-40.77466, 27.778513, 8.110583), (-40.77466, 27.778513, 8.110583), (-34.676, 35.35534, 6.8974843), (-35.35534, 35.35534, 4.3297804e-15), (-41.57348, 27.778513, 5.091283e-15), (-41.57348, 27.778513, 5.091283e-15), (-35.35534, 35.35534, 4.3297804e-15), (-34.676, 35.35534, -6.8974843), (-40.77466, 27.778513, -8.110583), (-40.77466, 27.778513, -8.110583), (-34.676, 35.35534, -6.8974843), (-32.664074, 35.35534, -13.529902), (-38.408886, 27.778513, -15.909483), (-38.408886, 27.778513, -15.909483), (-32.664074, 35.35534, -13.529902), (-29.396889, 35.35534, -19.642374), (-34.567085, 27.778513, -23.096987), (-34.567085, 27.778513, -23.096987), (-29.396889, 35.35534, -19.642374), (-25, 35.35534, -25), (-29.396889, 27.778513, -29.396889), (-29.396889, 27.778513, -29.396889), (-25, 35.35534, -25), (-19.642374, 35.35534, -29.396889), (-23.096987, 27.778513, -34.567085), (-23.096987, 27.778513, -34.567085), (-19.642374, 35.35534, -29.396889), (-13.529902, 35.35534, -32.664074), (-15.909483, 27.778513, -38.408886), (-15.909483, 27.778513, -38.408886), (-13.529902, 35.35534, -32.664074), (-6.8974843, 35.35534, -34.676), (-8.110583, 27.778513, -40.77466), (-8.110583, 27.778513, -40.77466), (-6.8974843, 35.35534, -34.676), (-6.49467e-15, 35.35534, -35.35534), (-7.6369244e-15, 27.778513, -41.57348), (-7.6369244e-15, 27.778513, -41.57348), (-6.49467e-15, 35.35534, -35.35534), (6.8974843, 35.35534, -34.676), (8.110583, 27.778513, -40.77466), (8.110583, 27.778513, -40.77466), (6.8974843, 35.35534, -34.676), (13.529902, 35.35534, -32.664074), (15.909483, 27.778513, -38.408886), (15.909483, 27.778513, -38.408886), (13.529902, 35.35534, -32.664074), (19.642374, 35.35534, -29.396889), (23.096987, 27.778513, -34.567085), (23.096987, 27.778513, -34.567085), (19.642374, 35.35534, -29.396889), (25, 35.35534, -25), (29.396889, 27.778513, -29.396889), (29.396889, 27.778513, -29.396889), (25, 35.35534, -25), (29.396889, 35.35534, -19.642374), (34.567085, 27.778513, -23.096987), (34.567085, 27.778513, -23.096987), (29.396889, 35.35534, -19.642374), (32.664074, 35.35534, -13.529902), (38.408886, 27.778513, -15.909483), (38.408886, 27.778513, -15.909483), (32.664074, 35.35534, -13.529902), (34.676, 35.35534, -6.8974843), (40.77466, 27.778513, -8.110583), (40.77466, 27.778513, -8.110583), (34.676, 35.35534, -6.8974843), (35.35534, 35.35534, 0), (41.57348, 27.778513, 0), (35.35534, 35.35534, 0), (27.778513, 41.57348, 0), (27.244755, 41.57348, 5.4193187), (34.676, 35.35534, 6.8974843), (34.676, 35.35534, 6.8974843), (27.244755, 41.57348, 5.4193187), (25.664, 41.57348, 10.630376), (32.664074, 35.35534, 13.529902), (32.664074, 35.35534, 13.529902), (25.664, 41.57348, 10.630376), (23.096987, 41.57348, 15.432914), (29.396889, 35.35534, 19.642374), (29.396889, 35.35534, 19.642374), (23.096987, 41.57348, 15.432914), (19.642374, 41.57348, 19.642374), (25, 35.35534, 25), (25, 35.35534, 25), (19.642374, 41.57348, 19.642374), (15.432914, 41.57348, 23.096987), (19.642374, 35.35534, 29.396889), (19.642374, 35.35534, 29.396889), (15.432914, 41.57348, 23.096987), (10.630376, 41.57348, 25.664), (13.529902, 35.35534, 32.664074), (13.529902, 35.35534, 32.664074), (10.630376, 41.57348, 25.664), (5.4193187, 41.57348, 27.244755), (6.8974843, 35.35534, 34.676), (6.8974843, 35.35534, 34.676), (5.4193187, 41.57348, 27.244755), (1.7009433e-15, 41.57348, 27.778513), (2.1648902e-15, 35.35534, 35.35534), (2.1648902e-15, 35.35534, 35.35534), (1.7009433e-15, 41.57348, 27.778513), (-5.4193187, 41.57348, 27.244755), (-6.8974843, 35.35534, 34.676), (-6.8974843, 35.35534, 34.676), (-5.4193187, 41.57348, 27.244755), (-10.630376, 41.57348, 25.664), (-13.529902, 35.35534, 32.664074), (-13.529902, 35.35534, 32.664074), (-10.630376, 41.57348, 25.664), (-15.432914, 41.57348, 23.096987), (-19.642374, 35.35534, 29.396889), (-19.642374, 35.35534, 29.396889), (-15.432914, 41.57348, 23.096987), (-19.642374, 41.57348, 19.642374), (-25, 35.35534, 25), (-25, 35.35534, 25), (-19.642374, 41.57348, 19.642374), (-23.096987, 41.57348, 15.432914), (-29.396889, 35.35534, 19.642374), (-29.396889, 35.35534, 19.642374), (-23.096987, 41.57348, 15.432914), (-25.664, 41.57348, 10.630376), (-32.664074, 35.35534, 13.529902), (-32.664074, 35.35534, 13.529902), (-25.664, 41.57348, 10.630376), (-27.244755, 41.57348, 5.4193187), (-34.676, 35.35534, 6.8974843), (-34.676, 35.35534, 6.8974843), (-27.244755, 41.57348, 5.4193187), (-27.778513, 41.57348, 3.4018865e-15), (-35.35534, 35.35534, 4.3297804e-15), (-35.35534, 35.35534, 4.3297804e-15), (-27.778513, 41.57348, 3.4018865e-15), (-27.244755, 41.57348, -5.4193187), (-34.676, 35.35534, -6.8974843), (-34.676, 35.35534, -6.8974843), (-27.244755, 41.57348, -5.4193187), (-25.664, 41.57348, -10.630376), (-32.664074, 35.35534, -13.529902), (-32.664074, 35.35534, -13.529902), (-25.664, 41.57348, -10.630376), (-23.096987, 41.57348, -15.432914), (-29.396889, 35.35534, -19.642374), (-29.396889, 35.35534, -19.642374), (-23.096987, 41.57348, -15.432914), (-19.642374, 41.57348, -19.642374), (-25, 35.35534, -25), (-25, 35.35534, -25), (-19.642374, 41.57348, -19.642374), (-15.432914, 41.57348, -23.096987), (-19.642374, 35.35534, -29.396889), (-19.642374, 35.35534, -29.396889), (-15.432914, 41.57348, -23.096987), (-10.630376, 41.57348, -25.664), (-13.529902, 35.35534, -32.664074), (-13.529902, 35.35534, -32.664074), (-10.630376, 41.57348, -25.664), (-5.4193187, 41.57348, -27.244755), (-6.8974843, 35.35534, -34.676), (-6.8974843, 35.35534, -34.676), (-5.4193187, 41.57348, -27.244755), (-5.1028297e-15, 41.57348, -27.778513), (-6.49467e-15, 35.35534, -35.35534), (-6.49467e-15, 35.35534, -35.35534), (-5.1028297e-15, 41.57348, -27.778513), (5.4193187, 41.57348, -27.244755), (6.8974843, 35.35534, -34.676), (6.8974843, 35.35534, -34.676), (5.4193187, 41.57348, -27.244755), (10.630376, 41.57348, -25.664), (13.529902, 35.35534, -32.664074), (13.529902, 35.35534, -32.664074), (10.630376, 41.57348, -25.664), (15.432914, 41.57348, -23.096987), (19.642374, 35.35534, -29.396889), (19.642374, 35.35534, -29.396889), (15.432914, 41.57348, -23.096987), (19.642374, 41.57348, -19.642374), (25, 35.35534, -25), (25, 35.35534, -25), (19.642374, 41.57348, -19.642374), (23.096987, 41.57348, -15.432914), (29.396889, 35.35534, -19.642374), (29.396889, 35.35534, -19.642374), (23.096987, 41.57348, -15.432914), (25.664, 41.57348, -10.630376), (32.664074, 35.35534, -13.529902), (32.664074, 35.35534, -13.529902), (25.664, 41.57348, -10.630376), (27.244755, 41.57348, -5.4193187), (34.676, 35.35534, -6.8974843), (34.676, 35.35534, -6.8974843), (27.244755, 41.57348, -5.4193187), (27.778513, 41.57348, 0), (35.35534, 35.35534, 0), (27.778513, 41.57348, 0), (19.13417, 46.193974, 0), (18.766514, 46.193974, 3.7328918), (27.244755, 41.57348, 5.4193187), (27.244755, 41.57348, 5.4193187), (18.766514, 46.193974, 3.7328918), (17.67767, 46.193974, 7.322331), (25.664, 41.57348, 10.630376), (25.664, 41.57348, 10.630376), (17.67767, 46.193974, 7.322331), (15.909483, 46.193974, 10.630376), (23.096987, 41.57348, 15.432914), (23.096987, 41.57348, 15.432914), (15.909483, 46.193974, 10.630376), (13.529902, 46.193974, 13.529902), (19.642374, 41.57348, 19.642374), (19.642374, 41.57348, 19.642374), (13.529902, 46.193974, 13.529902), (10.630376, 46.193974, 15.909483), (15.432914, 41.57348, 23.096987), (15.432914, 41.57348, 23.096987), (10.630376, 46.193974, 15.909483), (7.322331, 46.193974, 17.67767), (10.630376, 41.57348, 25.664), (10.630376, 41.57348, 25.664), (7.322331, 46.193974, 17.67767), (3.7328918, 46.193974, 18.766514), (5.4193187, 41.57348, 27.244755), (5.4193187, 41.57348, 27.244755), (3.7328918, 46.193974, 18.766514), (1.1716302e-15, 46.193974, 19.13417), (1.7009433e-15, 41.57348, 27.778513), (1.7009433e-15, 41.57348, 27.778513), (1.1716302e-15, 46.193974, 19.13417), (-3.7328918, 46.193974, 18.766514), (-5.4193187, 41.57348, 27.244755), (-5.4193187, 41.57348, 27.244755), (-3.7328918, 46.193974, 18.766514), (-7.322331, 46.193974, 17.67767), (-10.630376, 41.57348, 25.664), (-10.630376, 41.57348, 25.664), (-7.322331, 46.193974, 17.67767), (-10.630376, 46.193974, 15.909483), (-15.432914, 41.57348, 23.096987), (-15.432914, 41.57348, 23.096987), (-10.630376, 46.193974, 15.909483), (-13.529902, 46.193974, 13.529902), (-19.642374, 41.57348, 19.642374), (-19.642374, 41.57348, 19.642374), (-13.529902, 46.193974, 13.529902), (-15.909483, 46.193974, 10.630376), (-23.096987, 41.57348, 15.432914), (-23.096987, 41.57348, 15.432914), (-15.909483, 46.193974, 10.630376), (-17.67767, 46.193974, 7.322331), (-25.664, 41.57348, 10.630376), (-25.664, 41.57348, 10.630376), (-17.67767, 46.193974, 7.322331), (-18.766514, 46.193974, 3.7328918), (-27.244755, 41.57348, 5.4193187), (-27.244755, 41.57348, 5.4193187), (-18.766514, 46.193974, 3.7328918), (-19.13417, 46.193974, 2.3432603e-15), (-27.778513, 41.57348, 3.4018865e-15), (-27.778513, 41.57348, 3.4018865e-15), (-19.13417, 46.193974, 2.3432603e-15), (-18.766514, 46.193974, -3.7328918), (-27.244755, 41.57348, -5.4193187), (-27.244755, 41.57348, -5.4193187), (-18.766514, 46.193974, -3.7328918), (-17.67767, 46.193974, -7.322331), (-25.664, 41.57348, -10.630376), (-25.664, 41.57348, -10.630376), (-17.67767, 46.193974, -7.322331), (-15.909483, 46.193974, -10.630376), (-23.096987, 41.57348, -15.432914), (-23.096987, 41.57348, -15.432914), (-15.909483, 46.193974, -10.630376), (-13.529902, 46.193974, -13.529902), (-19.642374, 41.57348, -19.642374), (-19.642374, 41.57348, -19.642374), (-13.529902, 46.193974, -13.529902), (-10.630376, 46.193974, -15.909483), (-15.432914, 41.57348, -23.096987), (-15.432914, 41.57348, -23.096987), (-10.630376, 46.193974, -15.909483), (-7.322331, 46.193974, -17.67767), (-10.630376, 41.57348, -25.664), (-10.630376, 41.57348, -25.664), (-7.322331, 46.193974, -17.67767), (-3.7328918, 46.193974, -18.766514), (-5.4193187, 41.57348, -27.244755), (-5.4193187, 41.57348, -27.244755), (-3.7328918, 46.193974, -18.766514), (-3.5148903e-15, 46.193974, -19.13417), (-5.1028297e-15, 41.57348, -27.778513), (-5.1028297e-15, 41.57348, -27.778513), (-3.5148903e-15, 46.193974, -19.13417), (3.7328918, 46.193974, -18.766514), (5.4193187, 41.57348, -27.244755), (5.4193187, 41.57348, -27.244755), (3.7328918, 46.193974, -18.766514), (7.322331, 46.193974, -17.67767), (10.630376, 41.57348, -25.664), (10.630376, 41.57348, -25.664), (7.322331, 46.193974, -17.67767), (10.630376, 46.193974, -15.909483), (15.432914, 41.57348, -23.096987), (15.432914, 41.57348, -23.096987), (10.630376, 46.193974, -15.909483), (13.529902, 46.193974, -13.529902), (19.642374, 41.57348, -19.642374), (19.642374, 41.57348, -19.642374), (13.529902, 46.193974, -13.529902), (15.909483, 46.193974, -10.630376), (23.096987, 41.57348, -15.432914), (23.096987, 41.57348, -15.432914), (15.909483, 46.193974, -10.630376), (17.67767, 46.193974, -7.322331), (25.664, 41.57348, -10.630376), (25.664, 41.57348, -10.630376), (17.67767, 46.193974, -7.322331), (18.766514, 46.193974, -3.7328918), (27.244755, 41.57348, -5.4193187), (27.244755, 41.57348, -5.4193187), (18.766514, 46.193974, -3.7328918), (19.13417, 46.193974, 0), (27.778513, 41.57348, 0), (19.13417, 46.193974, 0), (9.754517, 49.03926, 0), (9.567085, 49.03926, 1.9030117), (18.766514, 46.193974, 3.7328918), (18.766514, 46.193974, 3.7328918), (9.567085, 49.03926, 1.9030117), (9.011998, 49.03926, 3.7328918), (17.67767, 46.193974, 7.322331), (17.67767, 46.193974, 7.322331), (9.011998, 49.03926, 3.7328918), (8.110583, 49.03926, 5.4193187), (15.909483, 46.193974, 10.630376), (15.909483, 46.193974, 10.630376), (8.110583, 49.03926, 5.4193187), (6.8974843, 49.03926, 6.8974843), (13.529902, 46.193974, 13.529902), (13.529902, 46.193974, 13.529902), (6.8974843, 49.03926, 6.8974843), (5.4193187, 49.03926, 8.110583), (10.630376, 46.193974, 15.909483), (10.630376, 46.193974, 15.909483), (5.4193187, 49.03926, 8.110583), (3.7328918, 49.03926, 9.011998), (7.322331, 46.193974, 17.67767), (7.322331, 46.193974, 17.67767), (3.7328918, 49.03926, 9.011998), (1.9030117, 49.03926, 9.567085), (3.7328918, 46.193974, 18.766514), (3.7328918, 46.193974, 18.766514), (1.9030117, 49.03926, 9.567085), (5.9729185e-16, 49.03926, 9.754517), (1.1716302e-15, 46.193974, 19.13417), (1.1716302e-15, 46.193974, 19.13417), (5.9729185e-16, 49.03926, 9.754517), (-1.9030117, 49.03926, 9.567085), (-3.7328918, 46.193974, 18.766514), (-3.7328918, 46.193974, 18.766514), (-1.9030117, 49.03926, 9.567085), (-3.7328918, 49.03926, 9.011998), (-7.322331, 46.193974, 17.67767), (-7.322331, 46.193974, 17.67767), (-3.7328918, 49.03926, 9.011998), (-5.4193187, 49.03926, 8.110583), (-10.630376, 46.193974, 15.909483), (-10.630376, 46.193974, 15.909483), (-5.4193187, 49.03926, 8.110583), (-6.8974843, 49.03926, 6.8974843), (-13.529902, 46.193974, 13.529902), (-13.529902, 46.193974, 13.529902), (-6.8974843, 49.03926, 6.8974843), (-8.110583, 49.03926, 5.4193187), (-15.909483, 46.193974, 10.630376), (-15.909483, 46.193974, 10.630376), (-8.110583, 49.03926, 5.4193187), (-9.011998, 49.03926, 3.7328918), (-17.67767, 46.193974, 7.322331), (-17.67767, 46.193974, 7.322331), (-9.011998, 49.03926, 3.7328918), (-9.567085, 49.03926, 1.9030117), (-18.766514, 46.193974, 3.7328918), (-18.766514, 46.193974, 3.7328918), (-9.567085, 49.03926, 1.9030117), (-9.754517, 49.03926, 1.1945837e-15), (-19.13417, 46.193974, 2.3432603e-15), (-19.13417, 46.193974, 2.3432603e-15), (-9.754517, 49.03926, 1.1945837e-15), (-9.567085, 49.03926, -1.9030117), (-18.766514, 46.193974, -3.7328918), (-18.766514, 46.193974, -3.7328918), (-9.567085, 49.03926, -1.9030117), (-9.011998, 49.03926, -3.7328918), (-17.67767, 46.193974, -7.322331), (-17.67767, 46.193974, -7.322331), (-9.011998, 49.03926, -3.7328918), (-8.110583, 49.03926, -5.4193187), (-15.909483, 46.193974, -10.630376), (-15.909483, 46.193974, -10.630376), (-8.110583, 49.03926, -5.4193187), (-6.8974843, 49.03926, -6.8974843), (-13.529902, 46.193974, -13.529902), (-13.529902, 46.193974, -13.529902), (-6.8974843, 49.03926, -6.8974843), (-5.4193187, 49.03926, -8.110583), (-10.630376, 46.193974, -15.909483), (-10.630376, 46.193974, -15.909483), (-5.4193187, 49.03926, -8.110583), (-3.7328918, 49.03926, -9.011998), (-7.322331, 46.193974, -17.67767), (-7.322331, 46.193974, -17.67767), (-3.7328918, 49.03926, -9.011998), (-1.9030117, 49.03926, -9.567085), (-3.7328918, 46.193974, -18.766514), (-3.7328918, 46.193974, -18.766514), (-1.9030117, 49.03926, -9.567085), (-1.7918755e-15, 49.03926, -9.754517), (-3.5148903e-15, 46.193974, -19.13417), (-3.5148903e-15, 46.193974, -19.13417), (-1.7918755e-15, 49.03926, -9.754517), (1.9030117, 49.03926, -9.567085), (3.7328918, 46.193974, -18.766514), (3.7328918, 46.193974, -18.766514), (1.9030117, 49.03926, -9.567085), (3.7328918, 49.03926, -9.011998), (7.322331, 46.193974, -17.67767), (7.322331, 46.193974, -17.67767), (3.7328918, 49.03926, -9.011998), (5.4193187, 49.03926, -8.110583), (10.630376, 46.193974, -15.909483), (10.630376, 46.193974, -15.909483), (5.4193187, 49.03926, -8.110583), (6.8974843, 49.03926, -6.8974843), (13.529902, 46.193974, -13.529902), (13.529902, 46.193974, -13.529902), (6.8974843, 49.03926, -6.8974843), (8.110583, 49.03926, -5.4193187), (15.909483, 46.193974, -10.630376), (15.909483, 46.193974, -10.630376), (8.110583, 49.03926, -5.4193187), (9.011998, 49.03926, -3.7328918), (17.67767, 46.193974, -7.322331), (17.67767, 46.193974, -7.322331), (9.011998, 49.03926, -3.7328918), (9.567085, 49.03926, -1.9030117), (18.766514, 46.193974, -3.7328918), (18.766514, 46.193974, -3.7328918), (9.567085, 49.03926, -1.9030117), (9.754517, 49.03926, 0), (19.13417, 46.193974, 0), (9.754517, 49.03926, 0), (0, 50, 0), (9.567085, 49.03926, 1.9030117), (9.567085, 49.03926, 1.9030117), (0, 50, 0), (9.011998, 49.03926, 3.7328918), (9.011998, 49.03926, 3.7328918), (0, 50, 0), (8.110583, 49.03926, 5.4193187), (8.110583, 49.03926, 5.4193187), (0, 50, 0), (6.8974843, 49.03926, 6.8974843), (6.8974843, 49.03926, 6.8974843), (0, 50, 0), (5.4193187, 49.03926, 8.110583), (5.4193187, 49.03926, 8.110583), (0, 50, 0), (3.7328918, 49.03926, 9.011998), (3.7328918, 49.03926, 9.011998), (0, 50, 0), (1.9030117, 49.03926, 9.567085), (1.9030117, 49.03926, 9.567085), (0, 50, 0), (5.9729185e-16, 49.03926, 9.754517), (5.9729185e-16, 49.03926, 9.754517), (0, 50, 0), (-1.9030117, 49.03926, 9.567085), (-1.9030117, 49.03926, 9.567085), (0, 50, 0), (-3.7328918, 49.03926, 9.011998), (-3.7328918, 49.03926, 9.011998), (0, 50, 0), (-5.4193187, 49.03926, 8.110583), (-5.4193187, 49.03926, 8.110583), (0, 50, 0), (-6.8974843, 49.03926, 6.8974843), (-6.8974843, 49.03926, 6.8974843), (0, 50, 0), (-8.110583, 49.03926, 5.4193187), (-8.110583, 49.03926, 5.4193187), (0, 50, 0), (-9.011998, 49.03926, 3.7328918), (-9.011998, 49.03926, 3.7328918), (0, 50, 0), (-9.567085, 49.03926, 1.9030117), (-9.567085, 49.03926, 1.9030117), (0, 50, 0), (-9.754517, 49.03926, 1.1945837e-15), (-9.754517, 49.03926, 1.1945837e-15), (0, 50, 0), (-9.567085, 49.03926, -1.9030117), (-9.567085, 49.03926, -1.9030117), (0, 50, 0), (-9.011998, 49.03926, -3.7328918), (-9.011998, 49.03926, -3.7328918), (0, 50, 0), (-8.110583, 49.03926, -5.4193187), (-8.110583, 49.03926, -5.4193187), (0, 50, 0), (-6.8974843, 49.03926, -6.8974843), (-6.8974843, 49.03926, -6.8974843), (0, 50, 0), (-5.4193187, 49.03926, -8.110583), (-5.4193187, 49.03926, -8.110583), (0, 50, 0), (-3.7328918, 49.03926, -9.011998), (-3.7328918, 49.03926, -9.011998), (0, 50, 0), (-1.9030117, 49.03926, -9.567085), (-1.9030117, 49.03926, -9.567085), (0, 50, 0), (-1.7918755e-15, 49.03926, -9.754517), (-1.7918755e-15, 49.03926, -9.754517), (0, 50, 0), (1.9030117, 49.03926, -9.567085), (1.9030117, 49.03926, -9.567085), (0, 50, 0), (3.7328918, 49.03926, -9.011998), (3.7328918, 49.03926, -9.011998), (0, 50, 0), (5.4193187, 49.03926, -8.110583), (5.4193187, 49.03926, -8.110583), (0, 50, 0), (6.8974843, 49.03926, -6.8974843), (6.8974843, 49.03926, -6.8974843), (0, 50, 0), (8.110583, 49.03926, -5.4193187), (8.110583, 49.03926, -5.4193187), (0, 50, 0), (9.011998, 49.03926, -3.7328918), (9.011998, 49.03926, -3.7328918), (0, 50, 0), (9.567085, 49.03926, -1.9030117), (9.567085, 49.03926, -1.9030117), (0, 50, 0), (9.754517, 49.03926, 0)] (
-            interpolation = "faceVarying"
-        )
-        point3f[] points = [(0, -50, 0), (9.754517, -49.03926, 0), (9.567085, -49.03926, 1.9030117), (9.011998, -49.03926, 3.7328918), (8.110583, -49.03926, 5.4193187), (6.8974843, -49.03926, 6.8974843), (5.4193187, -49.03926, 8.110583), (3.7328918, -49.03926, 9.011998), (1.9030117, -49.03926, 9.567085), (5.9729185e-16, -49.03926, 9.754517), (-1.9030117, -49.03926, 9.567085), (-3.7328918, -49.03926, 9.011998), (-5.4193187, -49.03926, 8.110583), (-6.8974843, -49.03926, 6.8974843), (-8.110583, -49.03926, 5.4193187), (-9.011998, -49.03926, 3.7328918), (-9.567085, -49.03926, 1.9030117), (-9.754517, -49.03926, 1.1945837e-15), (-9.567085, -49.03926, -1.9030117), (-9.011998, -49.03926, -3.7328918), (-8.110583, -49.03926, -5.4193187), (-6.8974843, -49.03926, -6.8974843), (-5.4193187, -49.03926, -8.110583), (-3.7328918, -49.03926, -9.011998), (-1.9030117, -49.03926, -9.567085), (-1.7918755e-15, -49.03926, -9.754517), (1.9030117, -49.03926, -9.567085), (3.7328918, -49.03926, -9.011998), (5.4193187, -49.03926, -8.110583), (6.8974843, -49.03926, -6.8974843), (8.110583, -49.03926, -5.4193187), (9.011998, -49.03926, -3.7328918), (9.567085, -49.03926, -1.9030117), (19.13417, -46.193974, 0), (18.766514, -46.193974, 3.7328918), (17.67767, -46.193974, 7.322331), (15.909483, -46.193974, 10.630376), (13.529902, -46.193974, 13.529902), (10.630376, -46.193974, 15.909483), (7.322331, -46.193974, 17.67767), (3.7328918, -46.193974, 18.766514), (1.1716302e-15, -46.193974, 19.13417), (-3.7328918, -46.193974, 18.766514), (-7.322331, -46.193974, 17.67767), (-10.630376, -46.193974, 15.909483), (-13.529902, -46.193974, 13.529902), (-15.909483, -46.193974, 10.630376), (-17.67767, -46.193974, 7.322331), (-18.766514, -46.193974, 3.7328918), (-19.13417, -46.193974, 2.3432603e-15), (-18.766514, -46.193974, -3.7328918), (-17.67767, -46.193974, -7.322331), (-15.909483, -46.193974, -10.630376), (-13.529902, -46.193974, -13.529902), (-10.630376, -46.193974, -15.909483), (-7.322331, -46.193974, -17.67767), (-3.7328918, -46.193974, -18.766514), (-3.5148903e-15, -46.193974, -19.13417), (3.7328918, -46.193974, -18.766514), (7.322331, -46.193974, -17.67767), (10.630376, -46.193974, -15.909483), (13.529902, -46.193974, -13.529902), (15.909483, -46.193974, -10.630376), (17.67767, -46.193974, -7.322331), (18.766514, -46.193974, -3.7328918), (27.778513, -41.57348, 0), (27.244755, -41.57348, 5.4193187), (25.664, -41.57348, 10.630376), (23.096987, -41.57348, 15.432914), (19.642374, -41.57348, 19.642374), (15.432914, -41.57348, 23.096987), (10.630376, -41.57348, 25.664), (5.4193187, -41.57348, 27.244755), (1.7009433e-15, -41.57348, 27.778513), (-5.4193187, -41.57348, 27.244755), (-10.630376, -41.57348, 25.664), (-15.432914, -41.57348, 23.096987), (-19.642374, -41.57348, 19.642374), (-23.096987, -41.57348, 15.432914), (-25.664, -41.57348, 10.630376), (-27.244755, -41.57348, 5.4193187), (-27.778513, -41.57348, 3.4018865e-15), (-27.244755, -41.57348, -5.4193187), (-25.664, -41.57348, -10.630376), (-23.096987, -41.57348, -15.432914), (-19.642374, -41.57348, -19.642374), (-15.432914, -41.57348, -23.096987), (-10.630376, -41.57348, -25.664), (-5.4193187, -41.57348, -27.244755), (-5.1028297e-15, -41.57348, -27.778513), (5.4193187, -41.57348, -27.244755), (10.630376, -41.57348, -25.664), (15.432914, -41.57348, -23.096987), (19.642374, -41.57348, -19.642374), (23.096987, -41.57348, -15.432914), (25.664, -41.57348, -10.630376), (27.244755, -41.57348, -5.4193187), (35.35534, -35.35534, 0), (34.676, -35.35534, 6.8974843), (32.664074, -35.35534, 13.529902), (29.396889, -35.35534, 19.642374), (25, -35.35534, 25), (19.642374, -35.35534, 29.396889), (13.529902, -35.35534, 32.664074), (6.8974843, -35.35534, 34.676), (2.1648902e-15, -35.35534, 35.35534), (-6.8974843, -35.35534, 34.676), (-13.529902, -35.35534, 32.664074), (-19.642374, -35.35534, 29.396889), (-25, -35.35534, 25), (-29.396889, -35.35534, 19.642374), (-32.664074, -35.35534, 13.529902), (-34.676, -35.35534, 6.8974843), (-35.35534, -35.35534, 4.3297804e-15), (-34.676, -35.35534, -6.8974843), (-32.664074, -35.35534, -13.529902), (-29.396889, -35.35534, -19.642374), (-25, -35.35534, -25), (-19.642374, -35.35534, -29.396889), (-13.529902, -35.35534, -32.664074), (-6.8974843, -35.35534, -34.676), (-6.49467e-15, -35.35534, -35.35534), (6.8974843, -35.35534, -34.676), (13.529902, -35.35534, -32.664074), (19.642374, -35.35534, -29.396889), (25, -35.35534, -25), (29.396889, -35.35534, -19.642374), (32.664074, -35.35534, -13.529902), (34.676, -35.35534, -6.8974843), (41.57348, -27.778513, 0), (40.77466, -27.778513, 8.110583), (38.408886, -27.778513, 15.909483), (34.567085, -27.778513, 23.096987), (29.396889, -27.778513, 29.396889), (23.096987, -27.778513, 34.567085), (15.909483, -27.778513, 38.408886), (8.110583, -27.778513, 40.77466), (2.5456415e-15, -27.778513, 41.57348), (-8.110583, -27.778513, 40.77466), (-15.909483, -27.778513, 38.408886), (-23.096987, -27.778513, 34.567085), (-29.396889, -27.778513, 29.396889), (-34.567085, -27.778513, 23.096987), (-38.408886, -27.778513, 15.909483), (-40.77466, -27.778513, 8.110583), (-41.57348, -27.778513, 5.091283e-15), (-40.77466, -27.778513, -8.110583), (-38.408886, -27.778513, -15.909483), (-34.567085, -27.778513, -23.096987), (-29.396889, -27.778513, -29.396889), (-23.096987, -27.778513, -34.567085), (-15.909483, -27.778513, -38.408886), (-8.110583, -27.778513, -40.77466), (-7.6369244e-15, -27.778513, -41.57348), (8.110583, -27.778513, -40.77466), (15.909483, -27.778513, -38.408886), (23.096987, -27.778513, -34.567085), (29.396889, -27.778513, -29.396889), (34.567085, -27.778513, -23.096987), (38.408886, -27.778513, -15.909483), (40.77466, -27.778513, -8.110583), (46.193974, -19.13417, 0), (45.306374, -19.13417, 9.011998), (42.67767, -19.13417, 17.67767), (38.408886, -19.13417, 25.664), (32.664074, -19.13417, 32.664074), (25.664, -19.13417, 38.408886), (17.67767, -19.13417, 42.67767), (9.011998, -19.13417, 45.306374), (2.8285653e-15, -19.13417, 46.193974), (-9.011998, -19.13417, 45.306374), (-17.67767, -19.13417, 42.67767), (-25.664, -19.13417, 38.408886), (-32.664074, -19.13417, 32.664074), (-38.408886, -19.13417, 25.664), (-42.67767, -19.13417, 17.67767), (-45.306374, -19.13417, 9.011998), (-46.193974, -19.13417, 5.6571306e-15), (-45.306374, -19.13417, -9.011998), (-42.67767, -19.13417, -17.67767), (-38.408886, -19.13417, -25.664), (-32.664074, -19.13417, -32.664074), (-25.664, -19.13417, -38.408886), (-17.67767, -19.13417, -42.67767), (-9.011998, -19.13417, -45.306374), (-8.4856955e-15, -19.13417, -46.193974), (9.011998, -19.13417, -45.306374), (17.67767, -19.13417, -42.67767), (25.664, -19.13417, -38.408886), (32.664074, -19.13417, -32.664074), (38.408886, -19.13417, -25.664), (42.67767, -19.13417, -17.67767), (45.306374, -19.13417, -9.011998), (49.03926, -9.754517, 0), (48.09699, -9.754517, 9.567085), (45.306374, -9.754517, 18.766514), (40.77466, -9.754517, 27.244755), (34.676, -9.754517, 34.676), (27.244755, -9.754517, 40.77466), (18.766514, -9.754517, 45.306374), (9.567085, -9.754517, 48.09699), (3.002789e-15, -9.754517, 49.03926), (-9.567085, -9.754517, 48.09699), (-18.766514, -9.754517, 45.306374), (-27.244755, -9.754517, 40.77466), (-34.676, -9.754517, 34.676), (-40.77466, -9.754517, 27.244755), (-45.306374, -9.754517, 18.766514), (-48.09699, -9.754517, 9.567085), (-49.03926, -9.754517, 6.005578e-15), (-48.09699, -9.754517, -9.567085), (-45.306374, -9.754517, -18.766514), (-40.77466, -9.754517, -27.244755), (-34.676, -9.754517, -34.676), (-27.244755, -9.754517, -40.77466), (-18.766514, -9.754517, -45.306374), (-9.567085, -9.754517, -48.09699), (-9.0083665e-15, -9.754517, -49.03926), (9.567085, -9.754517, -48.09699), (18.766514, -9.754517, -45.306374), (27.244755, -9.754517, -40.77466), (34.676, -9.754517, -34.676), (40.77466, -9.754517, -27.244755), (45.306374, -9.754517, -18.766514), (48.09699, -9.754517, -9.567085), (50, 0, 0), (49.03926, 0, 9.754517), (46.193974, 0, 19.13417), (41.57348, 0, 27.778513), (35.35534, 0, 35.35534), (27.778513, 0, 41.57348), (19.13417, 0, 46.193974), (9.754517, 0, 49.03926), (3.061617e-15, 0, 50), (-9.754517, 0, 49.03926), (-19.13417, 0, 46.193974), (-27.778513, 0, 41.57348), (-35.35534, 0, 35.35534), (-41.57348, 0, 27.778513), (-46.193974, 0, 19.13417), (-49.03926, 0, 9.754517), (-50, 0, 6.123234e-15), (-49.03926, 0, -9.754517), (-46.193974, 0, -19.13417), (-41.57348, 0, -27.778513), (-35.35534, 0, -35.35534), (-27.778513, 0, -41.57348), (-19.13417, 0, -46.193974), (-9.754517, 0, -49.03926), (-9.184851e-15, 0, -50), (9.754517, 0, -49.03926), (19.13417, 0, -46.193974), (27.778513, 0, -41.57348), (35.35534, 0, -35.35534), (41.57348, 0, -27.778513), (46.193974, 0, -19.13417), (49.03926, 0, -9.754517), (49.03926, 9.754517, 0), (48.09699, 9.754517, 9.567085), (45.306374, 9.754517, 18.766514), (40.77466, 9.754517, 27.244755), (34.676, 9.754517, 34.676), (27.244755, 9.754517, 40.77466), (18.766514, 9.754517, 45.306374), (9.567085, 9.754517, 48.09699), (3.002789e-15, 9.754517, 49.03926), (-9.567085, 9.754517, 48.09699), (-18.766514, 9.754517, 45.306374), (-27.244755, 9.754517, 40.77466), (-34.676, 9.754517, 34.676), (-40.77466, 9.754517, 27.244755), (-45.306374, 9.754517, 18.766514), (-48.09699, 9.754517, 9.567085), (-49.03926, 9.754517, 6.005578e-15), (-48.09699, 9.754517, -9.567085), (-45.306374, 9.754517, -18.766514), (-40.77466, 9.754517, -27.244755), (-34.676, 9.754517, -34.676), (-27.244755, 9.754517, -40.77466), (-18.766514, 9.754517, -45.306374), (-9.567085, 9.754517, -48.09699), (-9.0083665e-15, 9.754517, -49.03926), (9.567085, 9.754517, -48.09699), (18.766514, 9.754517, -45.306374), (27.244755, 9.754517, -40.77466), (34.676, 9.754517, -34.676), (40.77466, 9.754517, -27.244755), (45.306374, 9.754517, -18.766514), (48.09699, 9.754517, -9.567085), (46.193974, 19.13417, 0), (45.306374, 19.13417, 9.011998), (42.67767, 19.13417, 17.67767), (38.408886, 19.13417, 25.664), (32.664074, 19.13417, 32.664074), (25.664, 19.13417, 38.408886), (17.67767, 19.13417, 42.67767), (9.011998, 19.13417, 45.306374), (2.8285653e-15, 19.13417, 46.193974), (-9.011998, 19.13417, 45.306374), (-17.67767, 19.13417, 42.67767), (-25.664, 19.13417, 38.408886), (-32.664074, 19.13417, 32.664074), (-38.408886, 19.13417, 25.664), (-42.67767, 19.13417, 17.67767), (-45.306374, 19.13417, 9.011998), (-46.193974, 19.13417, 5.6571306e-15), (-45.306374, 19.13417, -9.011998), (-42.67767, 19.13417, -17.67767), (-38.408886, 19.13417, -25.664), (-32.664074, 19.13417, -32.664074), (-25.664, 19.13417, -38.408886), (-17.67767, 19.13417, -42.67767), (-9.011998, 19.13417, -45.306374), (-8.4856955e-15, 19.13417, -46.193974), (9.011998, 19.13417, -45.306374), (17.67767, 19.13417, -42.67767), (25.664, 19.13417, -38.408886), (32.664074, 19.13417, -32.664074), (38.408886, 19.13417, -25.664), (42.67767, 19.13417, -17.67767), (45.306374, 19.13417, -9.011998), (41.57348, 27.778513, 0), (40.77466, 27.778513, 8.110583), (38.408886, 27.778513, 15.909483), (34.567085, 27.778513, 23.096987), (29.396889, 27.778513, 29.396889), (23.096987, 27.778513, 34.567085), (15.909483, 27.778513, 38.408886), (8.110583, 27.778513, 40.77466), (2.5456415e-15, 27.778513, 41.57348), (-8.110583, 27.778513, 40.77466), (-15.909483, 27.778513, 38.408886), (-23.096987, 27.778513, 34.567085), (-29.396889, 27.778513, 29.396889), (-34.567085, 27.778513, 23.096987), (-38.408886, 27.778513, 15.909483), (-40.77466, 27.778513, 8.110583), (-41.57348, 27.778513, 5.091283e-15), (-40.77466, 27.778513, -8.110583), (-38.408886, 27.778513, -15.909483), (-34.567085, 27.778513, -23.096987), (-29.396889, 27.778513, -29.396889), (-23.096987, 27.778513, -34.567085), (-15.909483, 27.778513, -38.408886), (-8.110583, 27.778513, -40.77466), (-7.6369244e-15, 27.778513, -41.57348), (8.110583, 27.778513, -40.77466), (15.909483, 27.778513, -38.408886), (23.096987, 27.778513, -34.567085), (29.396889, 27.778513, -29.396889), (34.567085, 27.778513, -23.096987), (38.408886, 27.778513, -15.909483), (40.77466, 27.778513, -8.110583), (35.35534, 35.35534, 0), (34.676, 35.35534, 6.8974843), (32.664074, 35.35534, 13.529902), (29.396889, 35.35534, 19.642374), (25, 35.35534, 25), (19.642374, 35.35534, 29.396889), (13.529902, 35.35534, 32.664074), (6.8974843, 35.35534, 34.676), (2.1648902e-15, 35.35534, 35.35534), (-6.8974843, 35.35534, 34.676), (-13.529902, 35.35534, 32.664074), (-19.642374, 35.35534, 29.396889), (-25, 35.35534, 25), (-29.396889, 35.35534, 19.642374), (-32.664074, 35.35534, 13.529902), (-34.676, 35.35534, 6.8974843), (-35.35534, 35.35534, 4.3297804e-15), (-34.676, 35.35534, -6.8974843), (-32.664074, 35.35534, -13.529902), (-29.396889, 35.35534, -19.642374), (-25, 35.35534, -25), (-19.642374, 35.35534, -29.396889), (-13.529902, 35.35534, -32.664074), (-6.8974843, 35.35534, -34.676), (-6.49467e-15, 35.35534, -35.35534), (6.8974843, 35.35534, -34.676), (13.529902, 35.35534, -32.664074), (19.642374, 35.35534, -29.396889), (25, 35.35534, -25), (29.396889, 35.35534, -19.642374), (32.664074, 35.35534, -13.529902), (34.676, 35.35534, -6.8974843), (27.778513, 41.57348, 0), (27.244755, 41.57348, 5.4193187), (25.664, 41.57348, 10.630376), (23.096987, 41.57348, 15.432914), (19.642374, 41.57348, 19.642374), (15.432914, 41.57348, 23.096987), (10.630376, 41.57348, 25.664), (5.4193187, 41.57348, 27.244755), (1.7009433e-15, 41.57348, 27.778513), (-5.4193187, 41.57348, 27.244755), (-10.630376, 41.57348, 25.664), (-15.432914, 41.57348, 23.096987), (-19.642374, 41.57348, 19.642374), (-23.096987, 41.57348, 15.432914), (-25.664, 41.57348, 10.630376), (-27.244755, 41.57348, 5.4193187), (-27.778513, 41.57348, 3.4018865e-15), (-27.244755, 41.57348, -5.4193187), (-25.664, 41.57348, -10.630376), (-23.096987, 41.57348, -15.432914), (-19.642374, 41.57348, -19.642374), (-15.432914, 41.57348, -23.096987), (-10.630376, 41.57348, -25.664), (-5.4193187, 41.57348, -27.244755), (-5.1028297e-15, 41.57348, -27.778513), (5.4193187, 41.57348, -27.244755), (10.630376, 41.57348, -25.664), (15.432914, 41.57348, -23.096987), (19.642374, 41.57348, -19.642374), (23.096987, 41.57348, -15.432914), (25.664, 41.57348, -10.630376), (27.244755, 41.57348, -5.4193187), (19.13417, 46.193974, 0), (18.766514, 46.193974, 3.7328918), (17.67767, 46.193974, 7.322331), (15.909483, 46.193974, 10.630376), (13.529902, 46.193974, 13.529902), (10.630376, 46.193974, 15.909483), (7.322331, 46.193974, 17.67767), (3.7328918, 46.193974, 18.766514), (1.1716302e-15, 46.193974, 19.13417), (-3.7328918, 46.193974, 18.766514), (-7.322331, 46.193974, 17.67767), (-10.630376, 46.193974, 15.909483), (-13.529902, 46.193974, 13.529902), (-15.909483, 46.193974, 10.630376), (-17.67767, 46.193974, 7.322331), (-18.766514, 46.193974, 3.7328918), (-19.13417, 46.193974, 2.3432603e-15), (-18.766514, 46.193974, -3.7328918), (-17.67767, 46.193974, -7.322331), (-15.909483, 46.193974, -10.630376), (-13.529902, 46.193974, -13.529902), (-10.630376, 46.193974, -15.909483), (-7.322331, 46.193974, -17.67767), (-3.7328918, 46.193974, -18.766514), (-3.5148903e-15, 46.193974, -19.13417), (3.7328918, 46.193974, -18.766514), (7.322331, 46.193974, -17.67767), (10.630376, 46.193974, -15.909483), (13.529902, 46.193974, -13.529902), (15.909483, 46.193974, -10.630376), (17.67767, 46.193974, -7.322331), (18.766514, 46.193974, -3.7328918), (9.754517, 49.03926, 0), (9.567085, 49.03926, 1.9030117), (9.011998, 49.03926, 3.7328918), (8.110583, 49.03926, 5.4193187), (6.8974843, 49.03926, 6.8974843), (5.4193187, 49.03926, 8.110583), (3.7328918, 49.03926, 9.011998), (1.9030117, 49.03926, 9.567085), (5.9729185e-16, 49.03926, 9.754517), (-1.9030117, 49.03926, 9.567085), (-3.7328918, 49.03926, 9.011998), (-5.4193187, 49.03926, 8.110583), (-6.8974843, 49.03926, 6.8974843), (-8.110583, 49.03926, 5.4193187), (-9.011998, 49.03926, 3.7328918), (-9.567085, 49.03926, 1.9030117), (-9.754517, 49.03926, 1.1945837e-15), (-9.567085, 49.03926, -1.9030117), (-9.011998, 49.03926, -3.7328918), (-8.110583, 49.03926, -5.4193187), (-6.8974843, 49.03926, -6.8974843), (-5.4193187, 49.03926, -8.110583), (-3.7328918, 49.03926, -9.011998), (-1.9030117, 49.03926, -9.567085), (-1.7918755e-15, 49.03926, -9.754517), (1.9030117, 49.03926, -9.567085), (3.7328918, 49.03926, -9.011998), (5.4193187, 49.03926, -8.110583), (6.8974843, 49.03926, -6.8974843), (8.110583, 49.03926, -5.4193187), (9.011998, 49.03926, -3.7328918), (9.567085, 49.03926, -1.9030117), (0, 50, 0)]
-        uniform token subdivisionScheme = "none"
-        double3 xformOp:rotateXYZ = (0, 0, 0)
-        double3 xformOp:scale = (1, 1, 1)
-        double3 xformOp:translate = (0, 0, 0)
-        uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:rotateXYZ", "xformOp:scale"]
-    }
-}
-
-def Xform "Environment"
-{
-    double3 xformOp:rotateXYZ = (0, 0, 0)
-    double3 xformOp:scale = (1, 1, 1)
-    double3 xformOp:translate = (0, 0, 0)
-    uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:rotateXYZ", "xformOp:scale"]
-
-    def "Stage" (
-        prepend payload = @./assets/environments/stage.usda@
-    )
-    {
-        over "Geometries"
-        {
-            over "Platform"
-            {
-                token visibility = "invisible"
-            }
-        }
-    }
-}
-
-def Xform "CameraRoot"
-{
-    double3 xformOp:rotateXYZ = (-20, 60, 0)
-    double3 xformOp:scale = (1, 1, 1)
-    double3 xformOp:translate = (0, 30, -100)
-    uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:rotateXYZ", "xformOp:scale"]
-
-    def Camera "Camera"
-    {
-        float2 clippingRange = (1, 10000000)
-        float focalLength = 25
-        float focusDistance = 950
-        float fStop = 0
-        bool omni:kit:cameraLock = 0
-        double3 xformOp:rotateYXZ = (0, 0, 0)
-        double3 xformOp:scale = (1, 1, 1)
-        double3 xformOp:translate = (0, 0, 1000)
-        uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:rotateYXZ", "xformOp:scale"]
-    }
-}
diff --git a/exts/omni.warp/docs/CHANGELOG.md b/exts/omni.warp/docs/CHANGELOG.md
index 70bc98bf..0e9a1462 100644
--- a/exts/omni.warp/docs/CHANGELOG.md
+++ b/exts/omni.warp/docs/CHANGELOG.md
@@ -30,7 +30,6 @@
 - Update built-in documentation to accurately reflect their differentiability status
   ([GH-970](https://github.com/NVIDIA/warp/issues/970)).
 
-
 ## [1.9.0] - 2025-09-04
 
 ### Added
@@ -122,6 +121,8 @@
 - Fix adding superfluous inactive nodes to tetrahedron polynomial function spaces in `warp.fem`.
 - Fix `#line` directives for PythonCUDA source correlation not being emitted by default when a module is compiled in
   debug mode ([GH-901](https://github.com/NVIDIA/warp/issues/901)).
+- Fix 2D shared tile allocation/de-allocation bug inside Warp functions ([GH-877](https://github.com/NVIDIA/warp/issues/877)).
+- Fix loading "unique" modules using `wp.load_module()`.
 
 ## [1.8.1] - 2025-08-01
 
diff --git a/exts/omni.warp/omni/warp/nodes/_impl/OgnClothSimulate.ogn b/exts/omni.warp/omni/warp/nodes/_impl/OgnClothSimulate.ogn
deleted file mode 100644
index 88a98e2e..00000000
--- a/exts/omni.warp/omni/warp/nodes/_impl/OgnClothSimulate.ogn
+++ /dev/null
@@ -1,253 +0,0 @@
-{
-    "WarpClothSimulate": {
-        "version": 1,
-        "categoryDefinitions": "../../../../config/warp_categories.json",
-        "description": "Simulates cloth.",
-        "categories": ["warp"],
-        "language": "Python",
-        "uiName": "Cloth Simulate (Deprecated)",
-        "metadata": {
-            "hidden": "true"
-        },
-        "cudaPointers": "cpu",
-        "exclude": ["tests"],
-        "inputs": {
-            "execIn": {
-                "type": "execution",
-                "description": "Input execution."
-            },
-            "enabled": {
-                "type": "bool",
-                "description": "Whether to enable the simulation.",
-                "uiName": "Enabled",
-                "default": true
-            },
-            "substepCount": {
-                "type": "int",
-                "description": "Number of substeps.",
-                "uiName": "Substep Count",
-                "default": 32
-            },
-            "gravity": {
-                "type": "vectorf[3]",
-                "description": "Gravity force.",
-                "uiName": "Gravity",
-                "default": [0.0, -980, 0.0]
-            },
-            "contactElasticStiffness": {
-                "type": "float",
-                "description": "Contact elastic stiffness. Multiple of the global scale value.",
-                "uiName": "Contact Elastic Stiffness",
-                "default": 100000.0,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "contactFrictionStiffness": {
-                "type": "float",
-                "description": "Contact friction stiffness. Multiple of the global scale value.",
-                "uiName": "Contact Friction Stiffness",
-                "default": 10000.0,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "contactFrictionCoeff": {
-                "type": "float",
-                "description": "Contact coefficient of friction.",
-                "uiName": "Contact Friction Coeff",
-                "default": 0.75,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "contactDampingStiffness": {
-                "type": "float",
-                "description": "Contact damping stiffness. Multiple of the global scale value.",
-                "uiName": "Contact Damping Stiffness",
-                "default": 10000.0,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "cloth": {
-                "type": "bundle",
-                "description": "Cloth to simulate.",
-                "uiName": "Cloth",
-                "memoryType": "cuda"
-            },
-            "clothDensity": {
-                "type": "float",
-                "description": "Cloth density.",
-                "uiName": "Cloth Density",
-                "default": 0.1,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "clothTriElasticStiffness": {
-                "type": "float",
-                "description": "Triangle elastic stiffness. Multiple of the global scale value.",
-                "uiName": "Cloth Triangle Elastic Stiffness",
-                "default": 100000.0,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "clothTriAreaStiffness": {
-                "type": "float",
-                "description": "Triangle area stiffness. Multiple of the global scale value.",
-                "uiName": "Cloth Triangle Area Stiffness",
-                "default": 100000.0,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "clothTriDampingStiffness": {
-                "type": "float",
-                "description": "Triangle damping stiffness. Multiple of the global scale value.",
-                "uiName": "Cloth Triangle Damping Stiffness",
-                "default": 0.00001,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "clothTriDrag": {
-                "type": "float",
-                "description": "Triangle drag force. Multiple of the global scale value.",
-                "uiName": "Cloth Triangle Drag",
-                "default": 0.0,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "clothTriLift": {
-                "type": "float",
-                "description": "Triangle lift force. Multiple of the global scale value.",
-                "uiName": "Cloth Triangle Lift",
-                "default": 0.0,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "clothEdgeBendingStiffness": {
-                "type": "float",
-                "description": "Edge bending stiffness. Multiple of the global scale value.",
-                "uiName": "Cloth Edge Bending Stiffness",
-                "default": 0.01,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "clothEdgeDampingStiffness": {
-                "type": "float",
-                "description": "Edge damping stiffness. Multiple of the global scale value.",
-                "uiName": "Cloth Edge Damping Stiffness",
-                "default": 0.00001,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "collider": {
-                "type": "bundle",
-                "description": "Collider geometry mesh.",
-                "uiName": "Collider",
-                "optional": true,
-                "memoryType": "cuda"
-            },
-            "colliderContactDistance": {
-                "type": "float",
-                "description": "Distance to maintain from the collider's surface.",
-                "uiName": "Collider Contact Distance",
-                "default": 5.0,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "colliderContactQueryRange": {
-                "type": "float",
-                "description": "Distance to start probing for contacts with the collider's surface. Multiple of the collider contact distance.",
-                "uiName": "Collider Contact Query Range",
-                "default": 10.0,
-                "metadata": {
-                    "min": 1.0
-                }
-            },
-            "springIndexPairs": {
-                "type": "int[2][]",
-                "description": "Vertex indices where each pair represents a spring constraint.",
-                "uiName": "Spring Index Pairs"
-            },
-            "springElasticStiffness": {
-                "type": "float",
-                "description": "Spring elastic stiffness. Multiple of the global scale value.",
-                "uiName": "Spring Elastic Stiffness",
-                "default": 1000.0,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "springDampingStiffness": {
-                "type": "float",
-                "description": "Spring elastic stiffness. Multiple of the global scale value.",
-                "uiName": "Spring Damping Stiffness",
-                "default": 1.0,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "springVisualize": {
-                "type": "bool",
-                "description": "Whether to visualize the spring constraints.",
-                "uiName": "Spring Visualize",
-                "default": false
-            },
-            "springVisualizeWidth": {
-                "type": "float",
-                "description": "Visualization width for the spring constraints.",
-                "uiName": "Spring Visualize Width",
-                "default": 0.5
-            },
-            "springVisualizeColor": {
-                "type": "colorf[3]",
-                "description": "Visualization colour for the spring constraints.",
-                "uiName": "Spring Visualize Color",
-                "default": [10.0, 10.0, 0.0]
-            },
-            "groundEnabled": {
-                "type": "bool",
-                "description": "Whether to add a ground collider.",
-                "uiName": "Ground Enabled",
-                "default": true
-            },
-            "groundAltitude": {
-                "type": "float",
-                "description": "Position of the ground on the Y axis.",
-                "uiName": "Ground Altitude"
-            },
-            "time": {
-                "type": "double",
-                "description": "Time.",
-                "uiName": "Time"
-            }
-        },
-        "outputs": {
-            "execOut": {
-                "type": "execution",
-                "description": "Output execution."
-            },
-            "cloth": {
-                "type": "bundle",
-                "description": "Output particles geometry.",
-                "uiName": "Cloth",
-                "memoryType": "cuda"
-            },
-            "visualization": {
-                "type": "bundle",
-                "description": "Output visualization.",
-                "uiName": "Visualization",
-                "memoryType": "cuda"
-            }
-        }
-    }
-}
diff --git a/exts/omni.warp/omni/warp/nodes/_impl/OgnClothSimulate.py b/exts/omni.warp/omni/warp/nodes/_impl/OgnClothSimulate.py
deleted file mode 100644
index 613369d6..00000000
--- a/exts/omni.warp/omni/warp/nodes/_impl/OgnClothSimulate.py
+++ /dev/null
@@ -1,673 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2023 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-"""Node simulating cloth."""
-
-import traceback
-
-import carb
-import numpy as np
-import omni.graph.core as og
-import omni.timeline
-import omni.warp.nodes
-from omni.warp.nodes.ogn.OgnClothSimulateDatabase import OgnClothSimulateDatabase
-
-import warp as wp
-
-USE_GRAPH = True
-
-PROFILING = False
-
-
-#   Kernels
-# ------------------------------------------------------------------------------
-
-
-@wp.kernel(enable_backward=False)
-def transform_points_kernel(
-    points: wp.array(dtype=wp.vec3),
-    xform: wp.mat44,
-    out_points: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-    out_points[tid] = wp.transform_point(xform, points[tid])
-
-
-@wp.kernel(enable_backward=False)
-def update_collider_kernel(
-    points_0: wp.array(dtype=wp.vec3),
-    points_1: wp.array(dtype=wp.vec3),
-    xform_0: wp.mat44,
-    xform_1: wp.mat44,
-    sim_dt: float,
-    out_points: wp.array(dtype=wp.vec3),
-    out_velocities: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-
-    point_0 = wp.transform_point(xform_0, points_0[tid])
-    point_1 = wp.transform_point(xform_1, points_1[tid])
-
-    out_points[tid] = point_1
-    out_velocities[tid] = (point_1 - point_0) / sim_dt
-
-
-@wp.kernel(enable_backward=False)
-def update_cloth_kernel(
-    points_0: wp.array(dtype=wp.vec3),
-    xform: wp.mat44,
-    out_points: wp.array(dtype=wp.vec3),
-    out_velocities: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-
-    point = wp.transform_point(xform, points_0[tid])
-    diff = point - points_0[tid]
-
-    out_points[tid] = point
-    out_velocities[tid] = out_velocities[tid] + diff
-
-
-@wp.kernel
-def update_contacts_kernel(
-    points: wp.array(dtype=wp.vec3),
-    velocities: wp.array(dtype=wp.vec3),
-    sim_dt: float,
-    out_points: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-    out_points[tid] = points[tid] + velocities[tid] * sim_dt
-
-
-def basis_curve_points_from_springs_kernel(
-    points: wp.array(dtype=wp.vec3),
-    indices: wp.array(dtype=int),
-    out_points: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-    idx = indices[tid]
-    out_points[tid] = points[idx]
-
-
-#   Internal State
-# ------------------------------------------------------------------------------
-
-
-class InternalState:
-    """Internal state for the node."""
-
-    def __init__(self) -> None:
-        self.sim_dt = None
-        self.sim_tick = None
-        self.model = None
-        self.integrator = None
-        self.state_0 = None
-        self.state_1 = None
-        self.xform = None
-        self.collider_xform = None
-        self.collider_mesh = None
-        self.collider_points_0 = None
-        self.collider_points_1 = None
-        self.graph = None
-
-        self.visualization_enabled = False
-        self.sim_enabled = True
-        self.time = 0.0
-
-        self.is_valid = False
-
-        self.attr_tracking = omni.warp.nodes.AttrTracking(
-            (
-                "substepCount",
-                "gravity",
-                "contactElasticStiffness",
-                "contactFrictionStiffness",
-                "contactFrictionCoeff",
-                "contactDampingStiffness",
-                "clothDensity",
-                "clothTriElasticStiffness",
-                "clothTriAreaStiffness",
-                "clothTriDampingStiffness",
-                "clothEdgeBendingStiffness",
-                "clothEdgeDampingStiffness",
-                "colliderContactDistance",
-                "colliderContactQueryRange",
-                "groundEnabled",
-                "groundAltitude",
-            ),
-        )
-
-    def needs_initialization(self, db: OgnClothSimulateDatabase) -> bool:
-        """Checks if the internal state needs to be (re)initialized."""
-        if not self.is_valid or not db.inputs.enabled or not self.sim_enabled:
-            return True
-
-        if self.attr_tracking.have_attrs_changed(db):
-            return True
-
-        if db.inputs.time < self.time:
-            # Reset the simulation when we're rewinding.
-            return True
-
-        return False
-
-    def initialize(
-        self,
-        db: OgnClothSimulateDatabase,
-        device: wp.context.Device,
-    ) -> bool:
-        """Initializes the internal state."""
-        carb.log_warn(
-            "Following the deprecation of the `warp.sim` module in favour of the Newton library, "
-            "the `OgnClothSimulate` sample node is also deprecated and will be removed in v1.10"
-        )
-
-        # Lazy load warp.sim here to not slow down extension loading.
-        import warp.sim
-
-        # Compute the simulation time step.
-        timeline = omni.timeline.get_timeline_interface()
-        sim_rate = timeline.get_ticks_per_second()
-        sim_dt = 1.0 / sim_rate
-
-        # Initialize Warp's simulation model builder.
-        builder = wp.sim.ModelBuilder()
-
-        # Retrieve some data from the cloth mesh.
-        points = omni.warp.nodes.mesh_get_points(db.inputs.cloth)
-        xform = omni.warp.nodes.bundle_get_world_xform(db.inputs.cloth)
-
-        # Transform the cloth point positions into world space.
-        world_points = wp.empty(len(points), dtype=wp.vec3)
-        wp.launch(
-            kernel=transform_points_kernel,
-            dim=len(points),
-            inputs=[
-                points,
-                xform.T,
-            ],
-            outputs=[
-                world_points,
-            ],
-        )
-
-        # Register the cloth geometry mesh into Warp's simulation model builder,
-        # which requires triangulated meshes.
-        face_vertex_indices = omni.warp.nodes.mesh_triangulate(db.inputs.cloth)
-        builder.add_cloth_mesh(
-            pos=(0.0, 0.0, 0.0),
-            rot=(0.0, 0.0, 0.0, 1.0),
-            scale=1.0,
-            vel=(0.0, 0.0, 0.0),
-            vertices=world_points.numpy(),
-            indices=face_vertex_indices.numpy(),
-            density=db.inputs.clothDensity,
-            tri_ke=db.inputs.clothTriElasticStiffness,
-            tri_ka=db.inputs.clothTriAreaStiffness,
-            tri_kd=db.inputs.clothTriDampingStiffness,
-            tri_drag=db.inputs.clothTriDrag,
-            tri_lift=db.inputs.clothTriLift,
-            edge_ke=db.inputs.clothEdgeBendingStiffness,
-            edge_kd=db.inputs.clothEdgeDampingStiffness,
-        )
-
-        # Set a uniform mass to avoid large discrepancies.
-        avg_mass = np.mean(builder.particle_mass)
-        builder.particle_mass = np.full(
-            (len(builder.particle_mass),),
-            avg_mass,
-        )
-
-        # Register any spring constraint.
-        for src_idx, dst_idx in db.inputs.springIndexPairs:
-            builder.add_spring(
-                src_idx,
-                dst_idx,
-                ke=db.inputs.springElasticStiffness,
-                kd=db.inputs.springDampingStiffness,
-                control=1.0,
-            )
-
-        if db.inputs.collider.valid:
-            # Retrieve some data from the collider mesh.
-            collider_points = omni.warp.nodes.mesh_get_points(db.inputs.collider)
-            collider_xform = omni.warp.nodes.bundle_get_world_xform(db.inputs.collider)
-
-            # Transform the collider point position into world space.
-            collider_world_points = wp.empty(
-                len(collider_points),
-                dtype=wp.vec3,
-            )
-            wp.launch(
-                kernel=transform_points_kernel,
-                dim=len(collider_points),
-                inputs=[
-                    collider_points,
-                    collider_xform.T,
-                ],
-                outputs=[
-                    collider_world_points,
-                ],
-            )
-
-            # Initialize Warp's mesh instance, which requires
-            # triangulated meshes.
-            collider_face_vertex_indices = omni.warp.nodes.mesh_triangulate(
-                db.inputs.collider,
-            )
-            collider_mesh = wp.sim.Mesh(
-                collider_world_points.numpy(),
-                collider_face_vertex_indices.numpy(),
-                compute_inertia=False,
-            )
-
-            # Register the collider geometry mesh into Warp's simulation model
-            # builder.
-            builder.add_shape_mesh(
-                body=-1,
-                mesh=collider_mesh,
-                pos=(0.0, 0.0, 0.0),
-                rot=(0.0, 0.0, 0.0, 1.0),
-                scale=(1.0, 1.0, 1.0),
-                density=0.0,
-                ke=0.0,
-                kd=0.0,
-                kf=0.0,
-                mu=0.0,
-            )
-
-            # Store the collider's point positions as internal state.
-            collider_points_0 = wp.empty_like(collider_points)
-            collider_points_1 = wp.empty_like(collider_points)
-            wp.copy(collider_points_0, collider_points)
-            wp.copy(collider_points_1, collider_points)
-
-            # Store the class members.
-            self.collider_xform = collider_xform.copy()
-            self.collider_mesh = collider_mesh
-            self.collider_points_0 = collider_points_0
-            self.collider_points_1 = collider_points_1
-        else:
-            self.collider_mesh = None
-
-        # Register the ground.
-        builder.set_ground_plane(
-            offset=-db.inputs.groundAltitude + db.inputs.colliderContactDistance * 0.99,
-            ke=0.0,
-            kd=0.0,
-            kf=0.0,
-            mu=0.0,
-        )
-
-        # Create the coloring required by the VBD integrator.
-        builder.color()
-
-        # Build the simulation model.
-        model = builder.finalize()
-
-        # Allocate a single contact per particle.
-        model.allocate_soft_contacts(model.particle_count)
-
-        # Initialize the integrator.
-        integrator = wp.sim.VBDIntegrator(model, iterations=1)
-
-        # Set the model properties.
-        model.ground = db.inputs.groundEnabled
-        model.gravity = db.inputs.gravity
-        model.soft_contact_ke = db.inputs.contactElasticStiffness
-        model.soft_contact_kf = db.inputs.contactFrictionStiffness
-        model.soft_contact_mu = db.inputs.contactFrictionCoeff
-        model.soft_contact_kd = db.inputs.contactDampingStiffness
-        model.soft_contact_margin = db.inputs.colliderContactDistance * db.inputs.colliderContactQueryRange
-        model.particle_radius.fill_(db.inputs.colliderContactDistance)
-
-        # Store the class members.
-        self.sim_dt = sim_dt
-        self.sim_tick = 0
-        self.model = model
-        self.integrator = integrator
-        self.state_0 = model.state()
-        self.state_1 = model.state()
-        self.xform = xform.copy()
-
-        if USE_GRAPH:
-            # Create the CUDA graph. We first manually load the necessary
-            # modules to avoid the capture to load all the modules that are
-            # registered and possibly not relevant.
-            wp.load_module(device=device)
-            wp.set_module_options({"block_dim": 256}, warp.sim.integrator_vbd)
-            wp.load_module(module=warp.sim, device=device, recursive=True)
-            wp.capture_begin(force_module_load=False)
-            try:
-                step(db)
-            finally:
-                self.graph = wp.capture_end()
-
-        self.attr_tracking.update_state(db)
-
-        return True
-
-
-#   Compute
-# ------------------------------------------------------------------------------
-
-
-def update_collider(
-    db: OgnClothSimulateDatabase,
-) -> None:
-    """Updates the collider state."""
-    state = db.per_instance_state
-
-    points = omni.warp.nodes.mesh_get_points(db.inputs.collider)
-    xform = omni.warp.nodes.bundle_get_world_xform(db.inputs.collider)
-
-    # Store the current point positions.
-    wp.copy(state.collider_points_1, points)
-
-    # Retrieve the previous and current world transformations.
-    xform_0 = state.collider_xform
-    xform_1 = xform
-
-    # Update the internal point positions and velocities.
-    wp.launch(
-        kernel=update_collider_kernel,
-        dim=len(state.collider_mesh.vertices),
-        inputs=[
-            state.collider_points_0,
-            state.collider_points_1,
-            xform_0.T,
-            xform_1.T,
-            state.sim_dt,
-        ],
-        outputs=[
-            state.collider_mesh.mesh.points,
-            state.collider_mesh.mesh.velocities,
-        ],
-    )
-
-    # Swap the previous and current collider point positions.
-    (state.collider_points_0, state.collider_points_1) = (
-        state.collider_points_1,
-        state.collider_points_0,
-    )
-
-    # Refit the BVH.
-    state.collider_mesh.mesh.refit()
-
-    # Update the state members.
-    state.collider_xform = xform.copy()
-
-
-def update_cloth(
-    db: OgnClothSimulateDatabase,
-) -> None:
-    """Updates the cloth state."""
-    state = db.per_instance_state
-
-    xform = omni.warp.nodes.bundle_get_world_xform(db.inputs.cloth)
-
-    # Retrieve the previous and current world transformations.
-    xform_0 = state.xform
-    xform_1 = xform
-
-    try:
-        xform_0_inv = np.linalg.inv(xform_0)
-    except np.linalg.LinAlgError:
-        # On the first run, OG sometimes return an invalid matrix,
-        # so we default it to the identity one.
-        xform_0_inv = np.identity(4)
-
-    # Update the internal point positions and velocities.
-    wp.launch(
-        kernel=update_cloth_kernel,
-        dim=len(state.state_0.particle_q),
-        inputs=[
-            state.state_0.particle_q,
-            np.matmul(xform_0_inv, xform_1).T,
-        ],
-        outputs=[
-            state.state_0.particle_q,
-            state.state_0.particle_qd,
-        ],
-    )
-
-    # Update the state members.
-    state.xform = xform.copy()
-
-
-def step(db: OgnClothSimulateDatabase) -> None:
-    """Steps through the simulation."""
-    state = db.per_instance_state
-
-    sim_dt = state.sim_dt / db.inputs.substepCount
-
-    # Run the collision detection once per frame.
-    wp.sim.collide(state.model, state.state_0)
-
-    for _ in range(db.inputs.substepCount):
-        state.state_0.clear_forces()
-
-        wp.launch(
-            update_contacts_kernel,
-            state.model.soft_contact_max,
-            inputs=[
-                state.model.soft_contact_body_pos,
-                state.model.soft_contact_body_vel,
-                sim_dt,
-            ],
-            outputs=[
-                state.model.soft_contact_body_pos,
-            ],
-        )
-
-        state.integrator.simulate(
-            state.model,
-            state.state_0,
-            state.state_1,
-            sim_dt,
-        )
-
-        # Swap the previous and current states.
-        (state.state_0, state.state_1) = (state.state_1, state.state_0)
-
-
-def simulate(db: OgnClothSimulateDatabase) -> None:
-    """Simulates the cloth at the current time."""
-    state = db.per_instance_state
-
-    if USE_GRAPH:
-        wp.capture_launch(state.graph)
-    else:
-        step(db)
-
-
-def compute(db: OgnClothSimulateDatabase, device: wp.context.Device) -> None:
-    """Evaluates the node."""
-    if not db.inputs.cloth.valid or not db.outputs.cloth.valid:
-        return
-
-    state = db.per_instance_state
-
-    if not db.inputs.enabled:
-        # Pass through the data.
-        db.outputs.cloth = db.inputs.cloth
-
-        # Store whether the simulation was last enabled.
-        state.sim_enabled = False
-        return
-
-    if state.needs_initialization(db):
-        # Initialize the internal state if it hasn't been already.
-
-        # We want to use the input cloth geometry as the initial state
-        # of the simulation so we copy its bundle to the output one.
-        db.outputs.cloth = db.inputs.cloth
-
-        if not state.initialize(db, device):
-            return
-    else:
-        # We skip the simulation if it has just been initialized.
-
-        if state.sim_tick == 0 and omni.warp.nodes.bundle_has_changed(db.inputs.cloth):
-            if not state.initialize(db, device):
-                return
-
-        if (
-            db.inputs.collider.valid
-            and state.collider_mesh is not None
-            and omni.warp.nodes.bundle_has_changed(db.inputs.collider)
-        ):
-            # The collider might be animated so we need to update its state.
-            update_collider(db)
-
-        if omni.warp.nodes.bundle_have_attrs_changed(db.inputs.cloth, ("worldMatrix",)):
-            update_cloth(db)
-
-        with omni.warp.nodes.NodeTimer("simulate", db, active=PROFILING):
-            # Run the cloth simulation at the current time.
-            simulate(db)
-
-        with omni.warp.nodes.NodeTimer("transform_points_to_local_space", db, active=PROFILING):
-            # Retrieve some data from the cloth mesh.
-            xform = omni.warp.nodes.bundle_get_world_xform(db.inputs.cloth)
-
-            try:
-                xform_inv = np.linalg.inv(xform)
-            except np.linalg.LinAlgError:
-                # On the first run, OG sometimes return an invalid matrix,
-                # so we default it to the identity one.
-                xform_inv = np.identity(4)
-
-            # Transform the cloth point positions back into local space
-            # and store them into the bundle.
-            out_points = omni.warp.nodes.points_get_points(db.outputs.cloth)
-            wp.launch(
-                kernel=transform_points_kernel,
-                dim=len(out_points),
-                inputs=[
-                    state.state_0.particle_q,
-                    xform_inv.T,
-                ],
-                outputs=[
-                    out_points,
-                ],
-            )
-
-        # Increment the simulation tick.
-        state.sim_tick += 1
-
-    # Clear any previous visualization data.
-    if state.visualization_enabled:
-        db.outputs.visualization.bundle.clear_contents()
-        state.visualization_enabled = False
-
-    # Each type of visualization goes into its own primitive.
-    visualization_prim = 0
-
-    # Visualize the spring constraints as curves.
-    if db.inputs.springVisualize and db.inputs.springIndexPairs.size > 0:
-        spring_indices = omni.warp.nodes.from_omni_graph(
-            db.inputs.springIndexPairs, dtype=int, shape=(db.inputs.springIndexPairs.size,)
-        )
-
-        # Create a new set of geometry curves within the output bundle.
-        omni.warp.nodes.basis_curves_create_bundle(
-            db.outputs.visualization,
-            len(db.inputs.springIndexPairs) * 2,
-            len(db.inputs.springIndexPairs),
-            type="linear",
-            xform=omni.warp.nodes.bundle_get_world_xform(db.outputs.cloth),
-            create_display_color=True,
-            create_widths=True,
-            child_idx=visualization_prim,
-        )
-
-        # Set the curve point positions by looking up the model's particles
-        # with the spring indices.
-        out_points = omni.warp.nodes.basis_curves_get_points(
-            db.outputs.visualization,
-            child_idx=visualization_prim,
-        )
-        wp.launch(
-            kernel=basis_curve_points_from_springs_kernel,
-            dim=len(out_points),
-            inputs=[
-                state.state_0.particle_q,
-                spring_indices,
-            ],
-            outputs=[
-                out_points,
-            ],
-        )
-
-        # Set the number of points per curve. Each curve represents a constraint
-        # between 2 points, so we set them all to a length of 2.
-        out_counts = omni.warp.nodes.basis_curves_get_curve_vertex_counts(
-            db.outputs.visualization,
-            child_idx=visualization_prim,
-        )
-        out_counts.fill_(2)
-
-        # Set the curve widths.
-        out_widths = omni.warp.nodes.basis_curves_get_widths(
-            db.outputs.visualization,
-            child_idx=visualization_prim,
-        )
-        out_widths.fill_(db.inputs.springVisualizeWidth)
-
-        # Set the curve colours.
-        out_colors = omni.warp.nodes.basis_curves_get_display_color(
-            db.outputs.visualization,
-            child_idx=visualization_prim,
-        )
-        out_colors.fill_(wp.vec3(db.inputs.springVisualizeColor))
-
-        # Store whether any visualization was last enabled.
-        state.visualization_enabled = True
-
-    # Store whether the simulation was last enabled.
-    state.sim_enabled = True
-
-    # Store the current time.
-    state.time = db.inputs.time
-
-
-#   Node Entry Point
-# ------------------------------------------------------------------------------
-
-
-class OgnClothSimulate:
-    """Node."""
-
-    @staticmethod
-    def internal_state() -> InternalState:
-        return InternalState()
-
-    @staticmethod
-    def compute(db: OgnClothSimulateDatabase) -> None:
-        device = omni.warp.nodes.device_get_cuda_compute()
-
-        try:
-            with wp.ScopedDevice(device):
-                compute(db, device)
-        except Exception:
-            db.log_error(traceback.format_exc())
-            db.per_instance_state.is_valid = False
-            return
-
-        db.per_instance_state.is_valid = True
-
-        # Fire the execution for the downstream nodes.
-        db.outputs.execOut = og.ExecutionAttributeState.ENABLED
diff --git a/exts/omni.warp/omni/warp/nodes/_impl/OgnParticlesSimulate.ogn b/exts/omni.warp/omni/warp/nodes/_impl/OgnParticlesSimulate.ogn
deleted file mode 100644
index 53ed7178..00000000
--- a/exts/omni.warp/omni/warp/nodes/_impl/OgnParticlesSimulate.ogn
+++ /dev/null
@@ -1,170 +0,0 @@
-{
-    "WarpParticlesSimulate": {
-        "version": 1,
-        "categoryDefinitions": "../../../../config/warp_categories.json",
-        "description": "Simulates particles.",
-        "categories": ["warp"],
-        "language": "Python",
-        "uiName": "Particles Simulate (Deprecated)",
-        "metadata": {
-            "hidden": "true"
-        },
-        "cudaPointers": "cpu",
-        "exclude": ["tests"],
-        "inputs": {
-            "execIn": {
-                "type": "execution",
-                "description": "Input execution."
-            },
-            "enabled": {
-                "type": "bool",
-                "description": "Whether to enable the simulation.",
-                "uiName": "Enabled",
-                "default": true
-            },
-            "substepCount": {
-                "type": "int",
-                "description": "Number of substeps.",
-                "uiName": "Substep Count",
-                "default": 32
-            },
-            "gravity": {
-                "type": "vectorf[3]",
-                "description": "Gravity force.",
-                "uiName": "Gravity",
-                "default": [0.0, -980, 0.0]
-            },
-            "globalScale": {
-                "type": "float",
-                "description": "Global scale value for the simulation attributes.",
-                "uiName": "Global Scale",
-                "default": 100.0,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "contactElasticStiffness": {
-                "type": "float",
-                "description": "Contact elastic stiffness. Multiple of the global scale value.",
-                "uiName": "Contact Elastic Stiffness",
-                "default": 100.0,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "contactFrictionStiffness": {
-                "type": "float",
-                "description": "Contact friction stiffness. Multiple of the global scale value.",
-                "uiName": "Contact Friction Stiffness",
-                "default": 1.0,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "contactFrictionCoeff": {
-                "type": "float",
-                "description": "Contact coefficient of friction.",
-                "uiName": "Contact Friction Coeff",
-                "default": 0.75,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "contactDampingStiffness": {
-                "type": "float",
-                "description": "Contact damping stiffness. Multiple of the global scale value.",
-                "uiName": "Contact Damping Stiffness",
-                "default": 1.0,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "particles": {
-                "type": "bundle",
-                "description": "Particles to simulate.",
-                "uiName": "Particles",
-                "memoryType": "cuda"
-            },
-            "particlesQueryRange": {
-                "type": "float",
-                "description": "Amount to expand the grid cell size to accommodate caching neighbours between steps. Multiple of the largest particle radius.",
-                "uiName": "Particles Query Range",
-                "default": 2.0,
-                "metadata": {
-                    "min": 1.0
-                }
-            },
-            "particlesContactAdhesion": {
-                "type": "float",
-                "description": "Contact coefficient of adhesion.",
-                "uiName": "Particles Contact Adhesion",
-                "default": 0.25,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "particlesContactCohesion": {
-                "type": "float",
-                "description": "Contact coefficient of cohesion.",
-                "uiName": "Particles Contact Cohesion",
-                "default": 0.1,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "collider": {
-                "type": "bundle",
-                "description": "Collider geometry mesh.",
-                "uiName": "Collider",
-                "optional": true,
-                "memoryType": "cuda"
-            },
-            "colliderContactDistance": {
-                "type": "float",
-                "description": "Distance to maintain from the collider's surface.",
-                "uiName": "Collider Contact Distance",
-                "default": 1,
-                "metadata": {
-                    "min": 0.0
-                }
-            },
-            "colliderContactQueryRange": {
-                "type": "float",
-                "description": "Distance to start probing for contacts with the collider's surface. Multiple of the collider contact distance.",
-                "uiName": "Collider Contact Query Range",
-                "default": 100.0,
-                "metadata": {
-                    "min": 1.0
-                }
-            },
-            "groundEnabled": {
-                "type": "bool",
-                "description": "Whether to add a ground collider.",
-                "uiName": "Ground Enabled",
-                "default": true
-            },
-            "groundAltitude": {
-                "type": "float",
-                "description": "Position of the ground on the Y axis.",
-                "uiName": "Ground Altitude"
-            },
-            "time": {
-                "type": "double",
-                "description": "Time.",
-                "uiName": "Time"
-            }
-        },
-        "outputs": {
-            "execOut": {
-                "type": "execution",
-                "description": "Output execution."
-            },
-            "particles": {
-                "type": "bundle",
-                "description": "Output particles geometry.",
-                "uiName": "Particles",
-                "memoryType": "cuda"
-            }
-        }
-    }
-}
diff --git a/exts/omni.warp/omni/warp/nodes/_impl/OgnParticlesSimulate.py b/exts/omni.warp/omni/warp/nodes/_impl/OgnParticlesSimulate.py
deleted file mode 100644
index 3b839c60..00000000
--- a/exts/omni.warp/omni/warp/nodes/_impl/OgnParticlesSimulate.py
+++ /dev/null
@@ -1,593 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2023 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-"""Node simulating particles."""
-
-import traceback
-from math import inf
-
-import carb
-import numpy as np
-import omni.graph.core as og
-import omni.timeline
-import omni.warp.nodes
-from omni.warp.nodes.ogn.OgnParticlesSimulateDatabase import OgnParticlesSimulateDatabase
-
-import warp as wp
-
-USE_GRAPH = True
-
-PROFILING = False
-
-
-#   Kernels
-# ------------------------------------------------------------------------------
-
-
-@wp.kernel(enable_backward=False)
-def query_max_value_kernel(
-    values: wp.array(dtype=float),
-    out_max: wp.array(dtype=float),
-):
-    wp.atomic_max(out_max, 0, values[wp.tid()])
-
-
-@wp.kernel(enable_backward=False)
-def compute_particles_inv_mass_kernel(
-    masses: wp.array(dtype=float),
-    out_inv_masses: wp.array(dtype=float),
-):
-    tid = wp.tid()
-    out_inv_masses[tid] = 1.0 / masses[tid]
-
-
-@wp.kernel(enable_backward=False)
-def compute_particles_radius_kernel(
-    widths: wp.array(dtype=float),
-    out_radii: wp.array(dtype=float),
-):
-    tid = wp.tid()
-    out_radii[tid] = widths[tid] * 0.5
-
-
-@wp.kernel(enable_backward=False)
-def transform_points_kernel(
-    points: wp.array(dtype=wp.vec3),
-    xform: wp.mat44,
-    out_points: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-    out_points[tid] = wp.transform_point(xform, points[tid])
-
-
-@wp.kernel(enable_backward=False)
-def update_collider_kernel(
-    points_0: wp.array(dtype=wp.vec3),
-    points_1: wp.array(dtype=wp.vec3),
-    xform_0: wp.mat44,
-    xform_1: wp.mat44,
-    sim_dt: float,
-    out_points: wp.array(dtype=wp.vec3),
-    out_velocities: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-
-    point_0 = wp.transform_point(xform_0, points_0[tid])
-    point_1 = wp.transform_point(xform_1, points_1[tid])
-
-    out_points[tid] = point_0
-    out_velocities[tid] = (point_1 - point_0) / sim_dt
-
-
-@wp.kernel(enable_backward=False)
-def update_particles_kernel(
-    points_0: wp.array(dtype=wp.vec3),
-    xform: wp.mat44,
-    out_points: wp.array(dtype=wp.vec3),
-    out_velocities: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-
-    point = wp.transform_point(xform, points_0[tid])
-    diff = point - points_0[tid]
-
-    out_points[tid] = point
-    out_velocities[tid] = out_velocities[tid] + diff
-
-
-#   Internal State
-# ------------------------------------------------------------------------------
-
-
-class InternalState:
-    """Internal state for the node."""
-
-    def __init__(self) -> None:
-        self.sim_dt = None
-        self.sim_tick = None
-        self.model = None
-        self.integrator = None
-        self.state_0 = None
-        self.state_1 = None
-        self.xform = None
-        self.collider_xform = None
-        self.collider_mesh = None
-        self.collider_points_0 = None
-        self.collider_points_1 = None
-        self.graph = None
-
-        self.sim_enabled = True
-        self.time = 0.0
-
-        self.is_valid = False
-
-        self.attr_tracking = omni.warp.nodes.AttrTracking(
-            (
-                "substepCount",
-                "gravity",
-                "globalScale",
-                "contactElasticStiffness",
-                "contactFrictionStiffness",
-                "contactFrictionCoeff",
-                "contactDampingStiffness",
-                "particlesQueryRange",
-                "particlesContactAdhesion",
-                "particlesContactCohesion",
-                "colliderContactDistance",
-                "colliderContactQueryRange",
-                "groundEnabled",
-                "groundAltitude",
-            ),
-        )
-
-    def needs_initialization(self, db: OgnParticlesSimulateDatabase) -> bool:
-        """Checks if the internal state needs to be (re)initialized."""
-        if not self.is_valid or not db.inputs.enabled or not self.sim_enabled:
-            return True
-
-        if self.attr_tracking.have_attrs_changed(db):
-            return True
-
-        if db.inputs.time < self.time:
-            # Reset the simulation when we're rewinding.
-            return True
-
-        return False
-
-    def initialize(
-        self,
-        db: OgnParticlesSimulateDatabase,
-        device: wp.context.Device,
-    ) -> bool:
-        """Initializes the internal state."""
-        carb.log_warn(
-            "Following the deprecation of the `warp.sim` module in favour of the Newton library, "
-            "the `OgnParticlesSimulate` sample node is also deprecated and will be removed in v1.10"
-        )
-
-        # Lazy load warp.sim here to not slow down extension loading.
-        import warp.sim
-
-        # Compute the simulation time step.
-        timeline = omni.timeline.get_timeline_interface()
-        sim_rate = timeline.get_ticks_per_second()
-        sim_dt = 1.0 / sim_rate
-
-        # Initialize Warp's simulation model builder.
-        builder = wp.sim.ModelBuilder()
-
-        # Retrieve some data from the particles points.
-        points = omni.warp.nodes.points_get_points(db.inputs.particles)
-        xform = omni.warp.nodes.bundle_get_world_xform(db.inputs.particles)
-
-        # Transform the particles point positions into world space.
-        world_points = wp.empty(len(points), dtype=wp.vec3)
-        wp.launch(
-            kernel=transform_points_kernel,
-            dim=len(points),
-            inputs=[
-                points,
-                xform.T,
-            ],
-            outputs=[
-                world_points,
-            ],
-        )
-
-        if db.inputs.collider.valid:
-            # Retrieve some data from the collider mesh.
-            collider_points = omni.warp.nodes.mesh_get_points(db.inputs.collider)
-            collider_xform = omni.warp.nodes.bundle_get_world_xform(db.inputs.collider)
-
-            # Transform the collider point positions into world space.
-            collider_world_points = wp.empty(
-                len(collider_points),
-                dtype=wp.vec3,
-            )
-            wp.launch(
-                kernel=transform_points_kernel,
-                dim=len(collider_points),
-                inputs=[
-                    collider_points,
-                    collider_xform.T,
-                ],
-                outputs=[
-                    collider_world_points,
-                ],
-            )
-
-            # Initialize Warp's mesh instance, which requires
-            # triangulated meshes.
-            collider_face_vertex_indices = omni.warp.nodes.mesh_triangulate(
-                db.inputs.collider,
-            )
-            collider_mesh = wp.sim.Mesh(
-                collider_world_points.numpy(),
-                collider_face_vertex_indices.numpy(),
-                compute_inertia=False,
-            )
-
-            # Register the collider geometry mesh into Warp's simulation model
-            # builder.
-            builder.add_shape_mesh(
-                body=-1,
-                mesh=collider_mesh,
-                pos=(0.0, 0.0, 0.0),
-                rot=(0.0, 0.0, 0.0, 1.0),
-                scale=(1.0, 1.0, 1.0),
-            )
-
-            # Store the collider's point positions as internal state.
-            collider_points_0 = wp.empty_like(collider_points)
-            collider_points_1 = wp.empty_like(collider_points)
-            wp.copy(collider_points_0, collider_points)
-            wp.copy(collider_points_1, collider_points)
-
-            # Store the class members.
-            self.collider_xform = collider_xform.copy()
-            self.collider_mesh = collider_mesh
-            self.collider_points_0 = collider_points_0
-            self.collider_points_1 = collider_points_1
-        else:
-            self.collider_mesh = None
-
-        # Register the ground.
-        builder.set_ground_plane(
-            offset=-db.inputs.groundAltitude,
-            ke=0.0,
-            kd=0.0,
-            kf=0.0,
-            mu=0.0,
-        )
-
-        # Build the simulation model.
-        model = builder.finalize()
-
-        # Register the input particles into the system.
-        model.particle_count = omni.warp.nodes.points_get_point_count(db.inputs.particles)
-
-        model.particle_q = world_points
-        model.particle_qd = omni.warp.nodes.points_get_velocities(db.inputs.particles)
-        model.particle_mass = omni.warp.nodes.points_get_masses(db.inputs.particles)
-
-        model.particle_inv_mass = wp.empty_like(model.particle_mass)
-        wp.launch(
-            compute_particles_inv_mass_kernel,
-            dim=model.particle_count,
-            inputs=[model.particle_mass],
-            outputs=[model.particle_inv_mass],
-        )
-
-        widths = omni.warp.nodes.points_get_widths(db.inputs.particles)
-        model.particle_radius = wp.empty_like(widths)
-        wp.launch(
-            compute_particles_radius_kernel,
-            dim=model.particle_count,
-            inputs=[widths],
-            outputs=[model.particle_radius],
-        )
-
-        model.particle_flags = wp.empty(model.particle_count, dtype=wp.uint32)
-        model.particle_flags.fill_(warp.sim.model.PARTICLE_FLAG_ACTIVE.value)
-
-        max_width = wp.array((-inf,), dtype=float)
-        wp.launch(
-            query_max_value_kernel,
-            dim=model.particle_count,
-            inputs=[widths],
-            outputs=[max_width],
-        )
-        model.particle_max_radius = float(max_width.numpy()[0]) * 0.5
-
-        # Allocate a single contact per particle.
-        model.allocate_soft_contacts(model.particle_count)
-
-        # Initialize the integrator.
-        integrator = wp.sim.SemiImplicitIntegrator()
-
-        # Set the model properties.
-        model.ground = db.inputs.groundEnabled
-        model.gravity = db.inputs.gravity
-        model.particle_adhesion = db.inputs.particlesContactAdhesion
-        model.particle_cohesion = db.inputs.particlesContactCohesion
-        model.particle_ke = db.inputs.contactElasticStiffness * db.inputs.globalScale
-        model.particle_kf = db.inputs.contactFrictionStiffness * db.inputs.globalScale
-        model.particle_mu = db.inputs.contactFrictionCoeff
-        model.particle_kd = db.inputs.contactDampingStiffness * db.inputs.globalScale
-        model.soft_contact_ke = db.inputs.contactElasticStiffness * db.inputs.globalScale
-        model.soft_contact_kf = db.inputs.contactFrictionStiffness * db.inputs.globalScale
-        model.soft_contact_mu = db.inputs.contactFrictionCoeff
-        model.soft_contact_kd = db.inputs.contactDampingStiffness * db.inputs.globalScale
-        model.soft_contact_margin = db.inputs.colliderContactDistance * db.inputs.colliderContactQueryRange
-
-        # Store the class members.
-        self.sim_dt = sim_dt
-        self.sim_tick = 0
-        self.model = model
-        self.integrator = integrator
-        self.state_0 = model.state()
-        self.state_1 = model.state()
-        self.xform = xform.copy()
-
-        if USE_GRAPH:
-            # Create the CUDA graph. We first manually load the necessary
-            # modules to avoid the capture to load all the modules that are
-            # registered and possibly not relevant.
-            wp.load_module(device=device)
-            wp.load_module(module=warp.sim, device=device, recursive=True)
-            wp.capture_begin(force_module_load=False)
-            try:
-                step(db)
-            finally:
-                self.graph = wp.capture_end()
-
-        self.attr_tracking.update_state(db)
-
-        return True
-
-
-#   Compute
-# ------------------------------------------------------------------------------
-
-
-def update_collider(
-    db: OgnParticlesSimulateDatabase,
-) -> None:
-    """Updates the collider state."""
-    state = db.per_instance_state
-
-    points = omni.warp.nodes.mesh_get_points(db.inputs.collider)
-    xform = omni.warp.nodes.bundle_get_world_xform(db.inputs.collider)
-
-    # Swap the previous and current collider point positions.
-    (state.collider_points_0, state.collider_points_1) = (
-        state.collider_points_1,
-        state.collider_points_0,
-    )
-
-    # Store the current point positions.
-    wp.copy(state.collider_points_1, points)
-
-    # Retrieve the previous and current world transformations.
-    xform_0 = state.collider_xform
-    xform_1 = xform
-
-    # Update the internal point positions and velocities.
-    wp.launch(
-        kernel=update_collider_kernel,
-        dim=len(state.collider_mesh.vertices),
-        inputs=[
-            state.collider_points_0,
-            state.collider_points_1,
-            xform_0.T,
-            xform_1.T,
-            state.sim_dt,
-        ],
-        outputs=[
-            state.collider_mesh.mesh.points,
-            state.collider_mesh.mesh.velocities,
-        ],
-    )
-
-    # Refit the BVH.
-    state.collider_mesh.mesh.refit()
-
-    # Update the state members.
-    state.collider_xform = xform.copy()
-
-
-def update_particles(
-    db: OgnParticlesSimulateDatabase,
-) -> None:
-    """Updates the particles state."""
-    state = db.per_instance_state
-
-    xform = omni.warp.nodes.bundle_get_world_xform(db.inputs.particles)
-
-    # Retrieve the previous and current world transformations.
-    xform_0 = state.xform
-    xform_1 = xform
-
-    try:
-        xform_0_inv = np.linalg.inv(xform_0)
-    except np.linalg.LinAlgError:
-        # On the first run, OG sometimes return an invalid matrix,
-        # so we default it to the identity one.
-        xform_0_inv = np.identity(4)
-
-    # Update the internal point positions and velocities.
-    wp.launch(
-        kernel=update_particles_kernel,
-        dim=len(state.state_0.particle_q),
-        inputs=[
-            state.state_0.particle_q,
-            np.matmul(xform_0_inv, xform_1).T,
-        ],
-        outputs=[
-            state.state_0.particle_q,
-            state.state_0.particle_qd,
-        ],
-    )
-
-    # Update the state members.
-    state.xform = xform.copy()
-
-
-def step(db: OgnParticlesSimulateDatabase) -> None:
-    """Steps through the simulation."""
-    state = db.per_instance_state
-
-    sim_dt = state.sim_dt / db.inputs.substepCount
-
-    # Run the collision detection once per frame.
-    wp.sim.collide(state.model, state.state_0)
-
-    for _ in range(db.inputs.substepCount):
-        state.state_0.clear_forces()
-        state.integrator.simulate(
-            state.model,
-            state.state_0,
-            state.state_1,
-            sim_dt,
-        )
-
-        # Swap the previous and current states.
-        (state.state_0, state.state_1) = (state.state_1, state.state_0)
-
-
-def simulate(db: OgnParticlesSimulateDatabase) -> None:
-    """Simulates the particles at the current time."""
-    state = db.per_instance_state
-
-    state.model.particle_grid.build(
-        state.state_0.particle_q,
-        state.model.particle_max_radius * db.inputs.particlesQueryRange,
-    )
-
-    if USE_GRAPH:
-        wp.capture_launch(state.graph)
-    else:
-        step(db)
-
-
-def compute(db: OgnParticlesSimulateDatabase, device: wp.context.Device) -> None:
-    """Evaluates the node."""
-    if not db.inputs.particles.valid or not db.outputs.particles.valid:
-        return
-
-    state = db.per_instance_state
-
-    if not db.inputs.enabled:
-        # Pass through the data.
-        db.outputs.particles = db.inputs.particles
-
-        # Store whether the simulation was last enabled.
-        state.sim_enabled = False
-        return
-
-    if state.needs_initialization(db):
-        # Initialize the internal state if it hasn't been already.
-
-        # We want to use the input particles geometry as the initial state
-        # of the simulation so we copy its bundle to the output one.
-        db.outputs.particles = db.inputs.particles
-
-        if not state.initialize(db, device):
-            return
-    else:
-        # We skip the simulation if it has just been initialized.
-
-        if state.sim_tick == 0 and omni.warp.nodes.bundle_has_changed(db.inputs.particles):
-            if not state.initialize(db, device):
-                return
-
-        if (
-            db.inputs.collider.valid
-            and state.collider_mesh is not None
-            and omni.warp.nodes.bundle_has_changed(db.inputs.collider)
-        ):
-            # The collider might be animated so we need to update its state.
-            update_collider(db)
-
-        if omni.warp.nodes.bundle_have_attrs_changed(db.inputs.particles, ("worldMatrix",)):
-            update_particles(db)
-
-        with omni.warp.nodes.NodeTimer("simulate", db, active=PROFILING):
-            # Run the particles simulation at the current time.
-            simulate(db)
-
-        with omni.warp.nodes.NodeTimer("transform_points_to_local_space", db, active=PROFILING):
-            # Retrieve some data from the particles points.
-            xform = omni.warp.nodes.bundle_get_world_xform(db.inputs.particles)
-
-            try:
-                xform_inv = np.linalg.inv(xform)
-            except np.linalg.LinAlgError:
-                # On the first run, OG sometimes return an invalid matrix,
-                # so we default it to the identity one.
-                xform_inv = np.identity(4)
-
-            # Transform the particles point positions back into local space
-            # and store them into the bundle.
-            out_points = omni.warp.nodes.points_get_points(db.outputs.particles)
-            wp.launch(
-                kernel=transform_points_kernel,
-                dim=len(out_points),
-                inputs=[
-                    state.state_0.particle_q,
-                    xform_inv.T,
-                ],
-                outputs=[
-                    out_points,
-                ],
-            )
-
-        # Increment the simulation tick.
-        state.sim_tick += 1
-
-    # Store whether the simulation was last enabled.
-    state.sim_enabled = True
-
-    # Store the current time.
-    state.time = db.inputs.time
-
-
-#   Node Entry Point
-# ------------------------------------------------------------------------------
-
-
-class OgnParticlesSimulate:
-    """Node."""
-
-    @staticmethod
-    def internal_state() -> InternalState:
-        return InternalState()
-
-    @staticmethod
-    def compute(db: OgnParticlesSimulateDatabase) -> None:
-        device = omni.warp.nodes.device_get_cuda_compute()
-
-        try:
-            with wp.ScopedDevice(device):
-                compute(db, device)
-        except Exception:
-            db.log_error(traceback.format_exc())
-            db.per_instance_state.is_valid = False
-            return
-
-        db.per_instance_state.is_valid = True
-
-        # Fire the execution for the downstream nodes.
-        db.outputs.execOut = og.ExecutionAttributeState.ENABLED
diff --git a/exts/omni.warp/omni/warp/nodes/tests/test_sample_cloth_simulation.py b/exts/omni.warp/omni/warp/nodes/tests/test_sample_cloth_simulation.py
deleted file mode 100644
index a8d2e83f..00000000
--- a/exts/omni.warp/omni/warp/nodes/tests/test_sample_cloth_simulation.py
+++ /dev/null
@@ -1,95 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2024 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-"""Tests for the cloth simulation sample scene."""
-
-import unittest
-
-import numpy as np
-import omni.graph.core as og
-import omni.kit
-import omni.usd
-import omni.warp
-
-from ._common import (
-    FrameRange,
-    array_are_almost_equal,
-    attr_disconnect_all,
-    open_sample,
-    validate_render,
-)
-
-TEST_ID = "cloth_simulation"
-
-
-class TestSampleClothSimulation(omni.kit.test.AsyncTestCase):
-    async def _test_eval(self, enable_fsd: bool) -> None:
-        await open_sample(f"{TEST_ID}.usda", enable_fsd=enable_fsd)
-
-        graph = og.Controller.graph("/World/ActionGraph")
-
-        # Force writing to USD so that we can read resulting values from the stage.
-        write_node = og.Controller.node("write_prims", graph)
-        write_usd_attr = og.Controller.attribute("inputs:usdWriteBack", write_node)
-        attr_disconnect_all(write_usd_attr)
-        write_usd_attr.set(True)
-
-        stage = omni.usd.get_context().get_stage()
-        cloth_prim = stage.GetPrimAtPath("/World/Cloth")
-        points_attr = cloth_prim.GetAttribute("points")
-
-        points_first = np.array(points_attr.Get())
-        assert np.isfinite(points_first).all()
-        array_are_almost_equal(np.min(points_first, axis=0), (-50.0, 0.0, -50.0))
-        array_are_almost_equal(np.max(points_first, axis=0), (50.0, 0.0, 50.0))
-
-        prev_points_hash = None
-        curr_points_hash = None
-
-        with FrameRange(60) as frames:
-            async for _ in frames:
-                points = np.array(points_attr.Get())
-                assert np.isfinite(points).all()
-
-                curr_points_hash = hash(points.tobytes())
-                assert curr_points_hash != prev_points_hash
-                prev_points_hash = curr_points_hash
-
-        points_last = np.array(points_attr.Get())
-        assert np.mean(points_last, axis=0)[1] < np.mean(points_first, axis=0)[1]
-
-    async def test_eval_fsd_off(self) -> None:
-        await self._test_eval(enable_fsd=False)
-
-    async def test_eval_fsd_on(self) -> None:
-        await self._test_eval(enable_fsd=True)
-
-    async def _test_capture(self, enable_fsd: bool) -> None:
-        await open_sample(f"{TEST_ID}.usda", enable_fsd=enable_fsd)
-
-        with FrameRange(10) as frames:
-            async for _ in frames:
-                pass
-
-        fsd_str = "fsd_on" if enable_fsd else "fsd_off"
-        await validate_render(f"{TEST_ID}_{fsd_str}")
-
-    @unittest.skipIf(omni.kit.test.utils.is_etm_run(), "Regression in Kit")
-    async def test_capture_fsd_off(self) -> None:
-        await self._test_capture(enable_fsd=False)
-
-    @unittest.skipIf(omni.kit.test.utils.is_etm_run(), "Regression in Kit")
-    async def test_capture_fsd_on(self) -> None:
-        await self._test_capture(enable_fsd=True)
diff --git a/exts/omni.warp/omni/warp/nodes/tests/test_sample_particles_simulation_drop.py b/exts/omni.warp/omni/warp/nodes/tests/test_sample_particles_simulation_drop.py
deleted file mode 100644
index f9c6af44..00000000
--- a/exts/omni.warp/omni/warp/nodes/tests/test_sample_particles_simulation_drop.py
+++ /dev/null
@@ -1,95 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2024 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-"""Tests for the particle simulation drop sample scene."""
-
-import unittest
-
-import numpy as np
-import omni.graph.core as og
-import omni.kit
-import omni.usd
-import omni.warp
-
-from ._common import (
-    FrameRange,
-    array_are_almost_equal,
-    attr_disconnect_all,
-    open_sample,
-    validate_render,
-)
-
-TEST_ID = "particles_simulation_drop"
-
-
-class TestSampleParticlesSimulationDrop(omni.kit.test.AsyncTestCase):
-    async def _test_eval(self, enable_fsd: bool) -> None:
-        await open_sample(f"{TEST_ID}.usda", enable_fsd=enable_fsd)
-
-        graph = og.Controller.graph("/World/ActionGraph")
-
-        # Force writing to USD so that we can read resulting values from the stage.
-        write_node = og.Controller.node("write_prims", graph)
-        write_usd_attr = og.Controller.attribute("inputs:usdWriteBack", write_node)
-        attr_disconnect_all(write_usd_attr)
-        write_usd_attr.set(True)
-
-        stage = omni.usd.get_context().get_stage()
-        points_prim = stage.GetPrimAtPath("/World/Points")
-        points_attr = points_prim.GetAttribute("points")
-
-        points_first = np.array(points_attr.Get())
-        assert np.isfinite(points_first).all()
-        array_are_almost_equal(np.min(points_first, axis=0), (-48.5, 204.25, -95.5), atol=5.0)
-        array_are_almost_equal(np.max(points_first, axis=0), (48.5, 391.25, 91.0), atol=5.0)
-
-        prev_points_hash = None
-        curr_points_hash = None
-
-        with FrameRange(60) as frames:
-            async for _ in frames:
-                points = np.array(points_attr.Get())
-                assert np.isfinite(points).all()
-
-                curr_points_hash = hash(points.tobytes())
-                assert curr_points_hash != prev_points_hash
-                prev_points_hash = curr_points_hash
-
-        points_last = np.array(points_attr.Get())
-        assert np.mean(points_last, axis=0)[1] < np.mean(points_first, axis=0)[1]
-
-    async def test_eval_fsd_off(self) -> None:
-        await self._test_eval(enable_fsd=False)
-
-    async def test_eval_fsd_on(self) -> None:
-        await self._test_eval(enable_fsd=True)
-
-    async def _test_capture(self, enable_fsd: bool) -> None:
-        await open_sample(f"{TEST_ID}.usda", enable_fsd=enable_fsd)
-
-        with FrameRange(10) as frames:
-            async for _ in frames:
-                pass
-
-        fsd_str = "fsd_on" if enable_fsd else "fsd_off"
-        await validate_render(f"{TEST_ID}_{fsd_str}")
-
-    @unittest.skipIf(omni.kit.test.utils.is_etm_run(), "Regression in Kit")
-    async def test_capture_fsd_off(self) -> None:
-        await self._test_capture(enable_fsd=False)
-
-    @unittest.skipIf(omni.kit.test.utils.is_etm_run(), "Regression in Kit")
-    async def test_capture_fsd_on(self) -> None:
-        await self._test_capture(enable_fsd=True)
diff --git a/exts/omni.warp/omni/warp/nodes/tests/test_sample_particles_simulation_throw.py b/exts/omni.warp/omni/warp/nodes/tests/test_sample_particles_simulation_throw.py
deleted file mode 100644
index 20253dbe..00000000
--- a/exts/omni.warp/omni/warp/nodes/tests/test_sample_particles_simulation_throw.py
+++ /dev/null
@@ -1,95 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2024 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-"""Tests for the particles simulation throw sample scene."""
-
-import unittest
-
-import numpy as np
-import omni.graph.core as og
-import omni.kit
-import omni.usd
-import omni.warp
-
-from ._common import (
-    FrameRange,
-    array_are_almost_equal,
-    attr_disconnect_all,
-    open_sample,
-    validate_render,
-)
-
-TEST_ID = "particles_simulation_throw"
-
-
-class TestSampleParticlesSimulationThrow(omni.kit.test.AsyncTestCase):
-    async def _test_eval(self, enable_fsd: bool) -> None:
-        await open_sample(f"{TEST_ID}.usda", enable_fsd=enable_fsd)
-
-        graph = og.Controller.graph("/World/ActionGraph")
-
-        # Force writing to USD so that we can read resulting values from the stage.
-        write_node = og.Controller.node("write_prims", graph)
-        write_usd_attr = og.Controller.attribute("inputs:usdWriteBack", write_node)
-        attr_disconnect_all(write_usd_attr)
-        write_usd_attr.set(True)
-
-        stage = omni.usd.get_context().get_stage()
-        points_prim = stage.GetPrimAtPath("/World/Points")
-        points_attr = points_prim.GetAttribute("points")
-
-        points_first = np.array(points_attr.Get())
-        assert np.isfinite(points_first).all()
-        array_are_almost_equal(np.min(points_first, axis=0), (-48.0, 39.5, 202.0), atol=5.0)
-        array_are_almost_equal(np.max(points_first, axis=0), (48.0, 211.5, 298.0), atol=5.0)
-
-        prev_points_hash = None
-        curr_points_hash = None
-
-        with FrameRange(60) as frames:
-            async for _ in frames:
-                points = np.array(points_attr.Get())
-                assert np.isfinite(points).all()
-
-                curr_points_hash = hash(points.tobytes())
-                assert curr_points_hash != prev_points_hash
-                prev_points_hash = curr_points_hash
-
-        points_last = np.array(points_attr.Get())
-        assert np.mean(points_last, axis=0)[2] < np.mean(points_first, axis=0)[2]
-
-    async def test_eval_fsd_off(self) -> None:
-        await self._test_eval(enable_fsd=False)
-
-    async def test_eval_fsd_on(self) -> None:
-        await self._test_eval(enable_fsd=True)
-
-    async def _test_capture(self, enable_fsd: bool) -> None:
-        await open_sample(f"{TEST_ID}.usda", enable_fsd=enable_fsd)
-
-        with FrameRange(10) as frames:
-            async for _ in frames:
-                pass
-
-        fsd_str = "fsd_on" if enable_fsd else "fsd_off"
-        await validate_render(f"{TEST_ID}_{fsd_str}")
-
-    @unittest.skipIf(omni.kit.test.utils.is_etm_run(), "Regression in Kit")
-    async def test_capture_fsd_off(self) -> None:
-        await self._test_capture(enable_fsd=False)
-
-    @unittest.skipIf(omni.kit.test.utils.is_etm_run(), "Regression in Kit")
-    async def test_capture_fsd_on(self) -> None:
-        await self._test_capture(enable_fsd=True)
diff --git a/licenses/assets/pixel-LICENSE.txt b/licenses/asset_pixel_jpg-LICENSE.txt
similarity index 100%
rename from licenses/assets/pixel-LICENSE.txt
rename to licenses/asset_pixel_jpg-LICENSE.txt
diff --git a/licenses/assets/ant-LICENSE.txt b/licenses/assets/ant-LICENSE.txt
deleted file mode 100644
index d6eae06f..00000000
--- a/licenses/assets/ant-LICENSE.txt
+++ /dev/null
@@ -1,12 +0,0 @@
-The nv_ant.xml asset is based on the ant.xml asset from OpenAI Gym:
-  https://github.com/openai/gym/blob/master/gym/envs/mujoco/assets/ant.xml
-
-The MIT License
-
-Copyright (c) 2016 OpenAI (https://openai.com)
-
-Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
-
-The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-
-THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
diff --git a/licenses/assets/humanoid-LICENSE.txt b/licenses/assets/humanoid-LICENSE.txt
deleted file mode 100644
index 96af2c1d..00000000
--- a/licenses/assets/humanoid-LICENSE.txt
+++ /dev/null
@@ -1,181 +0,0 @@
-The nv_humanoid.xml and humanoid_CMU_V2020.xml assets are based on assets from the DeepMind dm_control suite:
-  https://github.com/deepmind/dm_control/blob/master/dm_control/suite/humanoid.xml
-  https://github.com/deepmind/dm_control/blob/master/dm_control/suite/humanoid_CMU.xml
-
-These assets are licensed under the Apache License below:
-
-                           Version 2.0, January 2004
-                        http://www.apache.org/licenses/
-
-   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION
-
-   1. Definitions.
-
-      "License" shall mean the terms and conditions for use, reproduction,
-      and distribution as defined by Sections 1 through 9 of this document.
-
-      "Licensor" shall mean the copyright owner or entity authorized by
-      the copyright owner that is granting the License.
-
-      "Legal Entity" shall mean the union of the acting entity and all
-      other entities that control, are controlled by, or are under common
-      control with that entity. For the purposes of this definition,
-      "control" means (i) the power, direct or indirect, to cause the
-      direction or management of such entity, whether by contract or
-      otherwise, or (ii) ownership of fifty percent (50%) or more of the
-      outstanding shares, or (iii) beneficial ownership of such entity.
-
-      "You" (or "Your") shall mean an individual or Legal Entity
-      exercising permissions granted by this License.
-
-      "Source" form shall mean the preferred form for making modifications,
-      including but not limited to software source code, documentation
-      source, and configuration files.
-
-      "Object" form shall mean any form resulting from mechanical
-      transformation or translation of a Source form, including but
-      not limited to compiled object code, generated documentation,
-      and conversions to other media types.
-
-      "Work" shall mean the work of authorship, whether in Source or
-      Object form, made available under the License, as indicated by a
-      copyright notice that is included in or attached to the work
-      (an example is provided in the Appendix below).
-
-      "Derivative Works" shall mean any work, whether in Source or Object
-      form, that is based on (or derived from) the Work and for which the
-      editorial revisions, annotations, elaborations, or other modifications
-      represent, as a whole, an original work of authorship. For the purposes
-      of this License, Derivative Works shall not include works that remain
-      separable from, or merely link (or bind by name) to the interfaces of,
-      the Work and Derivative Works thereof.
-
-      "Contribution" shall mean any work of authorship, including
-      the original version of the Work and any modifications or additions
-      to that Work or Derivative Works thereof, that is intentionally
-      submitted to Licensor for inclusion in the Work by the copyright owner
-      or by an individual or Legal Entity authorized to submit on behalf of
-      the copyright owner. For the purposes of this definition, "submitted"
-      means any form of electronic, verbal, or written communication sent
-      to the Licensor or its representatives, including but not limited to
-      communication on electronic mailing lists, source code control systems,
-      and issue tracking systems that are managed by, or on behalf of, the
-      Licensor for the purpose of discussing and improving the Work, but
-      excluding communication that is conspicuously marked or otherwise
-      designated in writing by the copyright owner as "Not a Contribution."
-
-      "Contributor" shall mean Licensor and any individual or Legal Entity
-      on behalf of whom a Contribution has been received by Licensor and
-      subsequently incorporated within the Work.
-
-   2. Grant of Copyright License. Subject to the terms and conditions of
-      this License, each Contributor hereby grants to You a perpetual,
-      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
-      copyright license to reproduce, prepare Derivative Works of,
-      publicly display, publicly perform, sublicense, and distribute the
-      Work and such Derivative Works in Source or Object form.
-
-   3. Grant of Patent License. Subject to the terms and conditions of
-      this License, each Contributor hereby grants to You a perpetual,
-      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
-      (except as stated in this section) patent license to make, have made,
-      use, offer to sell, sell, import, and otherwise transfer the Work,
-      where such license applies only to those patent claims licensable
-      by such Contributor that are necessarily infringed by their
-      Contribution(s) alone or by combination of their Contribution(s)
-      with the Work to which such Contribution(s) was submitted. If You
-      institute patent litigation against any entity (including a
-      cross-claim or counterclaim in a lawsuit) alleging that the Work
-      or a Contribution incorporated within the Work constitutes direct
-      or contributory patent infringement, then any patent licenses
-      granted to You under this License for that Work shall terminate
-      as of the date such litigation is filed.
-
-   4. Redistribution. You may reproduce and distribute copies of the
-      Work or Derivative Works thereof in any medium, with or without
-      modifications, and in Source or Object form, provided that You
-      meet the following conditions:
-
-      (a) You must give any other recipients of the Work or
-          Derivative Works a copy of this License; and
-
-      (b) You must cause any modified files to carry prominent notices
-          stating that You changed the files; and
-
-      (c) You must retain, in the Source form of any Derivative Works
-          that You distribute, all copyright, patent, trademark, and
-          attribution notices from the Source form of the Work,
-          excluding those notices that do not pertain to any part of
-          the Derivative Works; and
-
-      (d) If the Work includes a "NOTICE" text file as part of its
-          distribution, then any Derivative Works that You distribute must
-          include a readable copy of the attribution notices contained
-          within such NOTICE file, excluding those notices that do not
-          pertain to any part of the Derivative Works, in at least one
-          of the following places: within a NOTICE text file distributed
-          as part of the Derivative Works; within the Source form or
-          documentation, if provided along with the Derivative Works; or,
-          within a display generated by the Derivative Works, if and
-          wherever such third-party notices normally appear. The contents
-          of the NOTICE file are for informational purposes only and
-          do not modify the License. You may add Your own attribution
-          notices within Derivative Works that You distribute, alongside
-          or as an addendum to the NOTICE text from the Work, provided
-          that such additional attribution notices cannot be construed
-          as modifying the License.
-
-      You may add Your own copyright statement to Your modifications and
-      may provide additional or different license terms and conditions
-      for use, reproduction, or distribution of Your modifications, or
-      for any such Derivative Works as a whole, provided Your use,
-      reproduction, and distribution of the Work otherwise complies with
-      the conditions stated in this License.
-
-   5. Submission of Contributions. Unless You explicitly state otherwise,
-      any Contribution intentionally submitted for inclusion in the Work
-      by You to the Licensor shall be under the terms and conditions of
-      this License, without any additional terms or conditions.
-      Notwithstanding the above, nothing herein shall supersede or modify
-      the terms of any separate license agreement you may have executed
-      with Licensor regarding such Contributions.
-
-   6. Trademarks. This License does not grant permission to use the trade
-      names, trademarks, service marks, or product names of the Licensor,
-      except as required for reasonable and customary use in describing the
-      origin of the Work and reproducing the content of the NOTICE file.
-
-   7. Disclaimer of Warranty. Unless required by applicable law or
-      agreed to in writing, Licensor provides the Work (and each
-      Contributor provides its Contributions) on an "AS IS" BASIS,
-      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
-      implied, including, without limitation, any warranties or conditions
-      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
-      PARTICULAR PURPOSE. You are solely responsible for determining the
-      appropriateness of using or redistributing the Work and assume any
-      risks associated with Your exercise of permissions under this License.
-
-   8. Limitation of Liability. In no event and under no legal theory,
-      whether in tort (including negligence), contract, or otherwise,
-      unless required by applicable law (such as deliberate and grossly
-      negligent acts) or agreed to in writing, shall any Contributor be
-      liable to You for damages, including any direct, indirect, special,
-      incidental, or consequential damages of any character arising as a
-      result of this License or out of the use or inability to use the
-      Work (including but not limited to damages for loss of goodwill,
-      work stoppage, computer failure or malfunction, or any and all
-      other commercial damages or losses), even if such Contributor
-      has been advised of the possibility of such damages.
-
-   9. Accepting Warranty or Additional Liability. While redistributing
-      the Work or Derivative Works thereof, You may choose to offer,
-      and charge a fee for, acceptance of support, warranty, indemnity,
-      or other liability obligations and/or rights consistent with this
-      License. However, in accepting such obligations, You may act only
-      on Your own behalf and on Your sole responsibility, not on behalf
-      of any other Contributor, and only if You agree to indemnify,
-      defend, and hold each Contributor harmless for any liability
-      incurred by, or claims asserted against, such Contributor by reason
-      of your accepting any such warranty or additional liability.
-
-   END OF TERMS AND CONDITIONS
diff --git a/licenses/libmathdx-LICENSE.txt b/licenses/libmathdx-LICENSE.txt
new file mode 100644
index 00000000..f1e13beb
--- /dev/null
+++ b/licenses/libmathdx-LICENSE.txt
@@ -0,0 +1,220 @@
+================================================================================
+LICENSES FOR NVIDIA LIBMATHDX
+================================================================================
+
+This file contains the license agreements for the NVIDIA libmathdx library and
+its bundled components.
+
+This project, NVIDIA Warp, statically links libmathdx as a dependency.
+Therefore, the following licenses apply.
+
+--------------------------------------------------------------------------------
+1. NVIDIA Software License Agreement
+--------------------------------------------------------------------------------
+
+LICENSE AGREEMENT FOR NVIDIA MATH LIBRARIES SOFTWARE DEVELOPMENT KITS
+
+This license agreement("Agreement) is a legal agreement between you and NVIDIA Corporation ("NVIDIA") and governs your use of the NVIDIA math libraries software development kit as available at NVIDIAs discretion (each, a SDK). 
+
+Each SDK has its own set of software and materials, but here is a description of the types of items that may be included in a SDK: source code, header files, APIs, data sets and assets (examples include images, textures, models, scenes, videos, native API input/output files), binary software, sample code, libraries, utility programs, programming code and documentation. 
+
+This Agreement can be accepted only by an adult of legal age of majority in the country in which the SDK is used. 
+
+If you are entering into this Agreement on behalf of a company or other legal entity, you represent that you have the legal authority to bind the entity to this Agreement, in which case you will mean the entity you represent. 
+
+If you dont have the required age or authority to accept this Agreement, or if you dont accept all the terms and conditions of this Agreement, do not download, install or use the SDK.  
+
+You agree to use the SDK only for purposes that are permitted by (a) this Agreement, and (b) any applicable law, regulation or generally accepted practices or guidelines in the relevant jurisdictions.
+
+1. License. 
+
+1.1 Grant
+
+Subject to the terms of this Agreement, NVIDIA hereby grants you a non-exclusive, non-transferable license, without the right to sublicense (except as expressly provided in this Agreement) to: 
+
+(i) Install and use the SDK, and
+
+(ii) Distribute the binary files, files identified as samples, and headers as incorporated into a software application that meets the distribution requirements indicated in this Agreement. 
+
+1.2 Distribution Requirements
+
+These are the distribution requirements for you to exercise the distribution grant:
+       
+(i) Your application must have material additional functionality, beyond the included portions of the SDK.
+
+(ii) The distributable portions of the SDK shall only be accessed by your application.  
+
+(iii)  The following notice shall be included in modifications and derivative works of sample source code distributed: This software contains source code provided by NVIDIA Corporation.
+
+(iv)  Unless a developer tool is identified in this Agreement as distributable, it is delivered for your internal use only.
+
+(v) The terms under which you distribute your application must be consistent with the terms of this Agreement, including (without limitation) terms relating to the license grant and license restrictions and protection of NVIDIAs intellectual property rights. Additionally, you agree that you will protect the privacy, security and legal rights of your application users. 
+
+(vi) You agree to notify NVIDIA in writing of any known or suspected distribution or use of the SDK not in compliance with the requirements of this Agreement, and to enforce the terms of your agreements with respect to distributed SDK.
+
+1.3 Authorized Users
+
+You may allow employees and contractors of your entity or of your subsidiary(ies) to access and use the SDK from your secure network to perform work on your behalf. 
+
+If you are an academic institution you may allow users enrolled or employed by the academic institution to access and use the SDK from your secure network. 
+
+You are responsible for the compliance with the terms of this Agreement by your authorized users. If you become aware that your authorized users didnt follow the terms of this Agreement, you agree to take reasonable steps to resolve the non-compliance and prevent new occurrences. 
+
+1.4 Pre-Release SDK 
+The SDK versions identified as alpha, beta, preview or otherwise as pre-release, may not be fully functional, may contain errors or design flaws, and may have reduced or different security, privacy, accessibility, availability, and reliability standards relative to commercial versions of NVIDIA software and materials. Use of a pre-release SDK may result in unexpected results, loss of data, project delays or other unpredictable damage or loss. 
+You may use a pre-release SDK at your own risk, understanding that pre-release SDKs are not intended for use in production or business-critical systems. 
+NVIDIA may choose not to make available a commercial version of any pre-release SDK. NVIDIA may also choose to abandon development and terminate the availability of a pre-release SDK at any time without liability. 
+1.5	 Updates
+
+NVIDIA may, at its option, make available patches, workarounds or other updates to this SDK. Unless the updates are provided with their separate governing terms, they are deemed part of the SDK licensed to you as provided in this Agreement.
+
+You agree that the form and content of the SDK that NVIDIA provides may change without prior notice to you. While NVIDIA generally maintains compatibility between versions, NVIDIA may in some cases make changes that introduce incompatibilities in future versions of the SDK.
+
+1.6	 Components Under Other Licenses. 
+
+The SDK may include NVIDIA or third-party components with separate legal notices or terms as may be described in proprietary notices accompanying the SDK, such as components governed by open source software licenses. If and to the extent there is a conflict between the terms in this license and the license terms associated with a component, the license terms associated with the components control only to the extent necessary to resolve the conflict.  
+
+1.7 Reservation of Rights
+
+NVIDIA reserves all rights, title and interest in and to the SDK not expressly granted to you under this Agreement.
+
+2. Limitations. 
+
+The following license limitations apply to your use of the SDK:
+
+2.1 The SDK is licensed for you to develop applications only for use in systems with NVIDIA GPUs.
+
+2.2 You may not reverse engineer, decompile or disassemble, or remove copyright or other proprietary notices from any portion of the SDK or copies of the SDK. 
+
+2.3 Except as expressly provided in this Agreement, you may not copy, sell, rent, sublicense, transfer, distribute, modify, or create derivative works of any portion of the SDK. 
+
+2.4 Unless you have an agreement with NVIDIA for this purpose, you may not indicate that an application created with the SDK is sponsored or endorsed by NVIDIA. 
+
+2.5 You may not bypass, disable, or circumvent any encryption, security, digital rights management or authentication mechanism in the SDK. 
+
+2.6 You may not use the SDK in any manner that would cause it to become subject to an open source software license. As examples, licenses that require as a condition of use, modification, and/or distribution that the SDK be (i) disclosed or distributed in source code form; (ii) licensed for the purpose of making derivative works; or (iii) redistributable at no charge.
+
+2.7  You acknowledge that the SDK as delivered is not tested or certified by NVIDIA for use in connection with the design, construction, maintenance, and/or operation of any system where the use or failure of such system could result in a situation that threatens the safety of human life or results in catastrophic damages (each, a Critical Application). Examples of Critical Applications include use in avionics, navigation, autonomous vehicle applications, ai solutions for automotive products, military, medical, life support or other life critical applications. NVIDIA shall not be liable to you or any third party, in whole or in part, for any claims or damages arising from such uses. You are solely responsible for ensuring that any product or service developed with the SDK as a whole includes sufficient features to comply with all applicable legal and regulatory standards and requirements.
+
+2.8 You agree to defend, indemnify and hold harmless NVIDIA and its affiliates, and their respective employees, contractors, agents, officers and directors, from and against any and all claims, damages, obligations, losses, liabilities, costs or debt, fines, restitutions and expenses (including but not limited to attorneys fees and costs incident to establishing the right of indemnification) arising out of or related to products or services that use the SDK in or for Critical Applications, and for use of the SDK outside of the scope of this Agreement, or not in compliance with its terms.
+
+3. Ownership. 
+
+3.1 NVIDIA or its licensors hold all rights, title and interest in and to the SDK and its modifications, including their respective intellectual property rights. This SDK may include software and materials from NVIDIAs licensors, and these licensors are intended third party beneficiaries that may enforce this Agreement with respect to their intellectual property rights. 
+
+3.2 You may, but dont have to, provide to NVIDIA suggestions, feature requests or other feedback regarding the SDK, including possible enhancements or modifications to the SDK. For any feedback that you voluntarily provide, you hereby grant NVIDIA and its affiliates a perpetual, non-exclusive, worldwide, irrevocable license to use, reproduce, modify, license, sublicense (through multiple tiers of sublicensees), and distribute (through multiple tiers of distributors) it without the payment of any royalties or fees to you. NVIDIA will use feedback at its choice. 
+
+4.  No Warranties. 
+
+THE SDK IS PROVIDED BY NVIDIA AS IS AND WITH ALL FAULTS. TO THE MAXIMUM EXTENT PERMITTED BY LAW, NVIDIA AND ITS AFFILIATES EXPRESSLY DISCLAIM ALL WARRANTIES OF ANY KIND OR NATURE, WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED TO, ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, TITLE, NON-INFRINGEMENT, OR THE ABSENCE OF ANY DEFECTS THEREIN, WHETHER LATENT OR PATENT. NO WARRANTY IS MADE ON THE BASIS OF TRADE USAGE, COURSE OF DEALING OR COURSE OF TRADE. 
+
+5.	Limitations of Liability. 
+
+TO THE MAXIMUM EXTENT PERMITTED BY LAW, NVIDIA AND ITS AFFILIATES SHALL NOT BE LIABLE FOR ANY SPECIAL, INCIDENTAL, PUNITIVE OR CONSEQUENTIAL DAMAGES, OR ANY LOST PROFITS, LOSS OF USE, LOSS OF DATA OR LOSS OF GOODWILL, OR THE COSTS OF PROCURING SUBSTITUTE PRODUCTS, ARISING OUT OF OR IN CONNECTION WITH THIS AGREEMENT OR THE USE OR PERFORMANCE OF THE SDK, WHETHER SUCH LIABILITY ARISES FROM ANY CLAIM BASED UPON BREACH OF CONTRACT, BREACH OF WARRANTY, TORT (INCLUDING NEGLIGENCE), PRODUCT LIABILITY OR ANY OTHER CAUSE OF ACTION OR THEORY OF LIABILITY. IN NO EVENT WILL NVIDIAS AND ITS AFFILIATES TOTAL CUMULATIVE LIABILITY UNDER OR ARISING OUT OF THIS AGREEMENT EXCEED US$10.00. THE NATURE OF THE LIABILITY OR THE NUMBER OF CLAIMS OR SUITS SHALL NOT ENLARGE OR EXTEND THIS LIMIT. 
+
+These exclusions and limitations of liability shall apply regardless if NVIDIA or its affiliates have been advised of the possibility of such damages, and regardless of whether a remedy fails its essential purpose. These exclusions and limitations of liability form an essential basis of the bargain between the parties, and, absent any of these exclusions or limitations of liability, the provisions of this Agreement, including, without limitation, the economic terms, would be substantially different. 
+
+6.   Termination. 
+
+6.1 This Agreement will continue to apply until terminated by either you or NVIDIA as described below. 
+
+6.2 If you want to terminate this Agreement, you may do so by stopping to use the SDK. 
+
+6.3 NVIDIA may, at any time, terminate this Agreement if: (i) you fail to comply with any term of this Agreement and the non-compliance is not fixed within thirty (30) days following notice from NVIDIA (or immediately if you violate NVIDIAs intellectual property rights); (ii) you commence or participate in any legal proceeding against NVIDIA with respect to the SDK; or (iii) NVIDIA decides to no longer provide the SDK in a country or, in NVIDIAs sole discretion, the continued use of it is no longer commercially viable. 
+
+6.4 Upon any termination of this Agreement, you agree to promptly discontinue use of the SDK and destroy all copies in your possession or control. Your prior distributions in accordance with this Agreement are not affected by the termination of this Agreement. Upon written request, you will certify in writing that you have complied with your commitments under this section. Upon any termination of this Agreement all provisions survive except for the licenses granted to you. 
+
+7.  General.  
+ 
+If you wish to assign this Agreement or your rights and obligations, including by merger, consolidation, dissolution or operation of law, contact NVIDIA to ask for permission. Any attempted assignment not approved by NVIDIA in writing shall be void and of no effect. NVIDIA may assign, delegate or transfer this Agreement and its rights and obligations, and if to a non-affiliate you will be notified. 
+
+You agree to cooperate with NVIDIA and provide reasonably requested information to verify your compliance with this Agreement.
+
+This Agreement will be governed in all respects by the laws of the United States and of the State of Delaware as those laws are applied to contracts entered into and performed entirely within Delaware by Delaware residents, without regard to the conflicts of laws principles. The United Nations Convention on Contracts for the International Sale of Goods is specifically disclaimed. You agree to all terms of this Agreement in the English language.
+
+The state or federal courts residing in Santa Clara County, California shall have exclusive jurisdiction over any dispute or claim arising out of this Agreement. Notwithstanding this, you agree that NVIDIA shall still be allowed to apply for injunctive remedies or an equivalent type of urgent legal relief in any jurisdiction. 
+
+If any court of competent jurisdiction determines that any provision of this Agreement is illegal, invalid or unenforceable, such provision will be construed as limited to the extent necessary to be consistent with and fully enforceable under the law and the remaining provisions will remain in full force and effect. Unless otherwise specified, remedies are cumulative.
+
+Each party acknowledges and agrees that the other is an independent contractor in the performance of this Agreement. 
+
+The SDK has been developed entirely at private expense and is commercial items consisting of commercial computer software and commercial computer software documentation provided with RESTRICTED RIGHTS. Use, duplication or disclosure by the U.S. Government or a U.S. Government subcontractor is subject to the restrictions in this Agreement pursuant to DFARS 227.7202-3(a) or as set forth in subparagraphs (b)(1) and (2) of the Commercial Computer Software - Restricted Rights clause at FAR 52.227-19, as applicable. Contractor/manufacturer is NVIDIA, 2788 San Tomas Expressway, Santa Clara, CA 95051.
+
+The SDK is subject to United States export laws and regulations. You agree that you will not ship, transfer or export the SDK into any country, or use the SDK in any manner, prohibited by the United States Bureau of Industry and Security or economic sanctions regulations administered by the U.S. Department of Treasurys Office of Foreign Assets Control (OFAC), or any applicable export laws, restrictions or regulations. These laws include restrictions on destinations, end users and end use. By accepting this Agreement, you confirm that you are not a resident or citizen of any country currently embargoed by the U.S. and that you are not otherwise prohibited from receiving the SDK.
+
+Any notice delivered by NVIDIA to you under this Agreement will be delivered via mail, email or fax. You agree that any notices that NVIDIA sends you electronically will satisfy any legal communication requirements. Please direct your legal notices or other correspondence to NVIDIA Corporation, 2788 San Tomas Expressway, Santa Clara, California 95051, United States of America, Attention: Legal Department.
+
+This Agreement constitutes the entire agreement of the parties with respect to the subject matter of this Agreement and supersedes all prior negotiations or documentation exchanged between the parties relating to this subject matter. Any additional and/or conflicting terms on documents issued by you are null, void, and invalid. Any amendment or waiver under this Agreement shall be in writing and signed by representatives of both parties.
+
+If the distribution terms in this Agreement are not suitable for your organization, or for any questions regarding this Agreement, please contact NVIDIA at nvidia-compute-license-questions@nvidia.com.
+
+(v. February 10, 2022)
+
+--------------------------------------------------------------------------------
+2. BSD License for components from Meta Platforms, Inc.
+--------------------------------------------------------------------------------
+
+Some of the libmathdx routines were written by or derived from code written by Meta Platforms, Inc. and affiliates and are subject to the BSD License as follows:
+
+BSD License
+For Zstandard software
+Copyright (c) Meta Platforms, Inc. and affiliates. All rights reserved.
+
+Redistribution and use in source and binary forms, with or without modification,
+are permitted provided that the following conditions are met:
+
+   Redistributions of source code must retain the above copyright notice, this
+   list of conditions and the following disclaimer.
+
+   Redistributions in binary form must reproduce the above copyright notice,
+   this list of conditions and the following disclaimer in the documentation
+   and/or other materials provided with the distribution
+
+   Neither the name Facebook, nor Meta, nor the names of its contributors may
+   be used to endorse or promote products derived from this software without
+   specific prior written permission.
+
+THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
+ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
+WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
+ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
+ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
+SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+
+--------------------------------------------------------------------------------
+3. MIT-style License for components from Victor Zverovich
+--------------------------------------------------------------------------------
+
+Some of the libmathdx routines were written by or derived from code written by Victor Zverovich and are subject to the following license:
+
+Copyright (c) 2012 - present, Victor Zverovich
+
+Permission is hereby granted, free of charge, to any person obtaining
+a copy of this software and associated documentation files (the
+"Software"), to deal in the Software without restriction, including
+without limitation the rights to use, copy, modify, merge, publish,
+distribute, sublicense, and/or sell copies of the Software, and to
+permit persons to whom the Software is furnished to do so, subject to
+the following conditions:
+
+The above copyright notice and this permission notice shall be
+included in all copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
+EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
+MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
+NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
+LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
+OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
+WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+
+--- Optional exception to the license ---
+
+As an exception, if, as a result of your compiling your source code, portions
+of this Software are embedded into a machine-executable object form of such
+source code, you may redistribute such embedded portions in such object form
+without including the above copyright and permission notices. 
diff --git a/licenses/numpy-LICENSE.txt b/licenses/numpy-LICENSE.txt
deleted file mode 100644
index f1246ac1..00000000
--- a/licenses/numpy-LICENSE.txt
+++ /dev/null
@@ -1,30 +0,0 @@
-Copyright (c) 2005-2022, NumPy Developers.
-All rights reserved.
-
-Redistribution and use in source and binary forms, with or without
-modification, are permitted provided that the following conditions are
-met:
-
-    * Redistributions of source code must retain the above copyright
-       notice, this list of conditions and the following disclaimer.
-
-    * Redistributions in binary form must reproduce the above
-       copyright notice, this list of conditions and the following
-       disclaimer in the documentation and/or other materials provided
-       with the distribution.
-
-    * Neither the name of the NumPy Developers nor the names of any
-       contributors may be used to endorse or promote products derived
-       from this software without specific prior written permission.
-
-THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
-"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
-LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
-A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
-OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
-SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
-LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
-DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
-THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
-(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
-OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
\ No newline at end of file
diff --git a/licenses/python37-LICENSE.txt b/licenses/python37-LICENSE.txt
deleted file mode 100644
index 877c0675..00000000
--- a/licenses/python37-LICENSE.txt
+++ /dev/null
@@ -1,254 +0,0 @@
-A. HISTORY OF THE SOFTWARE
-==========================
-
-Python was created in the early 1990s by Guido van Rossum at Stichting
-Mathematisch Centrum (CWI, see http://www.cwi.nl) in the Netherlands
-as a successor of a language called ABC.  Guido remains Python's
-principal author, although it includes many contributions from others.
-
-In 1995, Guido continued his work on Python at the Corporation for
-National Research Initiatives (CNRI, see http://www.cnri.reston.va.us)
-in Reston, Virginia where he released several versions of the
-software.
-
-In May 2000, Guido and the Python core development team moved to
-BeOpen.com to form the BeOpen PythonLabs team.  In October of the same
-year, the PythonLabs team moved to Digital Creations, which became
-Zope Corporation.  In 2001, the Python Software Foundation (PSF, see
-https://www.python.org/psf/) was formed, a non-profit organization
-created specifically to own Python-related Intellectual Property.
-Zope Corporation was a sponsoring member of the PSF.
-
-All Python releases are Open Source (see http://www.opensource.org for
-the Open Source Definition).  Historically, most, but not all, Python
-releases have also been GPL-compatible; the table below summarizes
-the various releases.
-
-    Release         Derived     Year        Owner       GPL-
-                    from                                compatible? (1)
-
-    0.9.0 thru 1.2              1991-1995   CWI         yes
-    1.3 thru 1.5.2  1.2         1995-1999   CNRI        yes
-    1.6             1.5.2       2000        CNRI        no
-    2.0             1.6         2000        BeOpen.com  no
-    1.6.1           1.6         2001        CNRI        yes (2)
-    2.1             2.0+1.6.1   2001        PSF         no
-    2.0.1           2.0+1.6.1   2001        PSF         yes
-    2.1.1           2.1+2.0.1   2001        PSF         yes
-    2.1.2           2.1.1       2002        PSF         yes
-    2.1.3           2.1.2       2002        PSF         yes
-    2.2 and above   2.1.1       2001-now    PSF         yes
-
-Footnotes:
-
-(1) GPL-compatible doesn't mean that we're distributing Python under
-    the GPL.  All Python licenses, unlike the GPL, let you distribute
-    a modified version without making your changes open source.  The
-    GPL-compatible licenses make it possible to combine Python with
-    other software that is released under the GPL; the others don't.
-
-(2) According to Richard Stallman, 1.6.1 is not GPL-compatible,
-    because its license has a choice of law clause.  According to
-    CNRI, however, Stallman's lawyer has told CNRI's lawyer that 1.6.1
-    is "not incompatible" with the GPL.
-
-Thanks to the many outside volunteers who have worked under Guido's
-direction to make these releases possible.
-
-
-B. TERMS AND CONDITIONS FOR ACCESSING OR OTHERWISE USING PYTHON
-===============================================================
-
-PYTHON SOFTWARE FOUNDATION LICENSE VERSION 2
---------------------------------------------
-
-1. This LICENSE AGREEMENT is between the Python Software Foundation
-("PSF"), and the Individual or Organization ("Licensee") accessing and
-otherwise using this software ("Python") in source or binary form and
-its associated documentation.
-
-2. Subject to the terms and conditions of this License Agreement, PSF hereby
-grants Licensee a nonexclusive, royalty-free, world-wide license to reproduce,
-analyze, test, perform and/or display publicly, prepare derivative works,
-distribute, and otherwise use Python alone or in any derivative version,
-provided, however, that PSF's License Agreement and PSF's notice of copyright,
-i.e., "Copyright (c) 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,
-2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021 Python Software Foundation;
-All Rights Reserved" are retained in Python alone or in any derivative version
-prepared by Licensee.
-
-3. In the event Licensee prepares a derivative work that is based on
-or incorporates Python or any part thereof, and wants to make
-the derivative work available to others as provided herein, then
-Licensee hereby agrees to include in any such work a brief summary of
-the changes made to Python.
-
-4. PSF is making Python available to Licensee on an "AS IS"
-basis.  PSF MAKES NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR
-IMPLIED.  BY WAY OF EXAMPLE, BUT NOT LIMITATION, PSF MAKES NO AND
-DISCLAIMS ANY REPRESENTATION OR WARRANTY OF MERCHANTABILITY OR FITNESS
-FOR ANY PARTICULAR PURPOSE OR THAT THE USE OF PYTHON WILL NOT
-INFRINGE ANY THIRD PARTY RIGHTS.
-
-5. PSF SHALL NOT BE LIABLE TO LICENSEE OR ANY OTHER USERS OF PYTHON
-FOR ANY INCIDENTAL, SPECIAL, OR CONSEQUENTIAL DAMAGES OR LOSS AS
-A RESULT OF MODIFYING, DISTRIBUTING, OR OTHERWISE USING PYTHON,
-OR ANY DERIVATIVE THEREOF, EVEN IF ADVISED OF THE POSSIBILITY THEREOF.
-
-6. This License Agreement will automatically terminate upon a material
-breach of its terms and conditions.
-
-7. Nothing in this License Agreement shall be deemed to create any
-relationship of agency, partnership, or joint venture between PSF and
-Licensee.  This License Agreement does not grant permission to use PSF
-trademarks or trade name in a trademark sense to endorse or promote
-products or services of Licensee, or any third party.
-
-8. By copying, installing or otherwise using Python, Licensee
-agrees to be bound by the terms and conditions of this License
-Agreement.
-
-
-BEOPEN.COM LICENSE AGREEMENT FOR PYTHON 2.0
--------------------------------------------
-
-BEOPEN PYTHON OPEN SOURCE LICENSE AGREEMENT VERSION 1
-
-1. This LICENSE AGREEMENT is between BeOpen.com ("BeOpen"), having an
-office at 160 Saratoga Avenue, Santa Clara, CA 95051, and the
-Individual or Organization ("Licensee") accessing and otherwise using
-this software in source or binary form and its associated
-documentation ("the Software").
-
-2. Subject to the terms and conditions of this BeOpen Python License
-Agreement, BeOpen hereby grants Licensee a non-exclusive,
-royalty-free, world-wide license to reproduce, analyze, test, perform
-and/or display publicly, prepare derivative works, distribute, and
-otherwise use the Software alone or in any derivative version,
-provided, however, that the BeOpen Python License is retained in the
-Software, alone or in any derivative version prepared by Licensee.
-
-3. BeOpen is making the Software available to Licensee on an "AS IS"
-basis.  BEOPEN MAKES NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR
-IMPLIED.  BY WAY OF EXAMPLE, BUT NOT LIMITATION, BEOPEN MAKES NO AND
-DISCLAIMS ANY REPRESENTATION OR WARRANTY OF MERCHANTABILITY OR FITNESS
-FOR ANY PARTICULAR PURPOSE OR THAT THE USE OF THE SOFTWARE WILL NOT
-INFRINGE ANY THIRD PARTY RIGHTS.
-
-4. BEOPEN SHALL NOT BE LIABLE TO LICENSEE OR ANY OTHER USERS OF THE
-SOFTWARE FOR ANY INCIDENTAL, SPECIAL, OR CONSEQUENTIAL DAMAGES OR LOSS
-AS A RESULT OF USING, MODIFYING OR DISTRIBUTING THE SOFTWARE, OR ANY
-DERIVATIVE THEREOF, EVEN IF ADVISED OF THE POSSIBILITY THEREOF.
-
-5. This License Agreement will automatically terminate upon a material
-breach of its terms and conditions.
-
-6. This License Agreement shall be governed by and interpreted in all
-respects by the law of the State of California, excluding conflict of
-law provisions.  Nothing in this License Agreement shall be deemed to
-create any relationship of agency, partnership, or joint venture
-between BeOpen and Licensee.  This License Agreement does not grant
-permission to use BeOpen trademarks or trade names in a trademark
-sense to endorse or promote products or services of Licensee, or any
-third party.  As an exception, the "BeOpen Python" logos available at
-http://www.pythonlabs.com/logos.html may be used according to the
-permissions granted on that web page.
-
-7. By copying, installing or otherwise using the software, Licensee
-agrees to be bound by the terms and conditions of this License
-Agreement.
-
-
-CNRI LICENSE AGREEMENT FOR PYTHON 1.6.1
----------------------------------------
-
-1. This LICENSE AGREEMENT is between the Corporation for National
-Research Initiatives, having an office at 1895 Preston White Drive,
-Reston, VA 20191 ("CNRI"), and the Individual or Organization
-("Licensee") accessing and otherwise using Python 1.6.1 software in
-source or binary form and its associated documentation.
-
-2. Subject to the terms and conditions of this License Agreement, CNRI
-hereby grants Licensee a nonexclusive, royalty-free, world-wide
-license to reproduce, analyze, test, perform and/or display publicly,
-prepare derivative works, distribute, and otherwise use Python 1.6.1
-alone or in any derivative version, provided, however, that CNRI's
-License Agreement and CNRI's notice of copyright, i.e., "Copyright (c)
-1995-2001 Corporation for National Research Initiatives; All Rights
-Reserved" are retained in Python 1.6.1 alone or in any derivative
-version prepared by Licensee.  Alternately, in lieu of CNRI's License
-Agreement, Licensee may substitute the following text (omitting the
-quotes): "Python 1.6.1 is made available subject to the terms and
-conditions in CNRI's License Agreement.  This Agreement together with
-Python 1.6.1 may be located on the Internet using the following
-unique, persistent identifier (known as a handle): 1895.22/1013.  This
-Agreement may also be obtained from a proxy server on the Internet
-using the following URL: http://hdl.handle.net/1895.22/1013".
-
-3. In the event Licensee prepares a derivative work that is based on
-or incorporates Python 1.6.1 or any part thereof, and wants to make
-the derivative work available to others as provided herein, then
-Licensee hereby agrees to include in any such work a brief summary of
-the changes made to Python 1.6.1.
-
-4. CNRI is making Python 1.6.1 available to Licensee on an "AS IS"
-basis.  CNRI MAKES NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR
-IMPLIED.  BY WAY OF EXAMPLE, BUT NOT LIMITATION, CNRI MAKES NO AND
-DISCLAIMS ANY REPRESENTATION OR WARRANTY OF MERCHANTABILITY OR FITNESS
-FOR ANY PARTICULAR PURPOSE OR THAT THE USE OF PYTHON 1.6.1 WILL NOT
-INFRINGE ANY THIRD PARTY RIGHTS.
-
-5. CNRI SHALL NOT BE LIABLE TO LICENSEE OR ANY OTHER USERS OF PYTHON
-1.6.1 FOR ANY INCIDENTAL, SPECIAL, OR CONSEQUENTIAL DAMAGES OR LOSS AS
-A RESULT OF MODIFYING, DISTRIBUTING, OR OTHERWISE USING PYTHON 1.6.1,
-OR ANY DERIVATIVE THEREOF, EVEN IF ADVISED OF THE POSSIBILITY THEREOF.
-
-6. This License Agreement will automatically terminate upon a material
-breach of its terms and conditions.
-
-7. This License Agreement shall be governed by the federal
-intellectual property law of the United States, including without
-limitation the federal copyright law, and, to the extent such
-U.S. federal law does not apply, by the law of the Commonwealth of
-Virginia, excluding Virginia's conflict of law provisions.
-Notwithstanding the foregoing, with regard to derivative works based
-on Python 1.6.1 that incorporate non-separable material that was
-previously distributed under the GNU General Public License (GPL), the
-law of the Commonwealth of Virginia shall govern this License
-Agreement only as to issues arising under or with respect to
-Paragraphs 4, 5, and 7 of this License Agreement.  Nothing in this
-License Agreement shall be deemed to create any relationship of
-agency, partnership, or joint venture between CNRI and Licensee.  This
-License Agreement does not grant permission to use CNRI trademarks or
-trade name in a trademark sense to endorse or promote products or
-services of Licensee, or any third party.
-
-8. By clicking on the "ACCEPT" button where indicated, or by copying,
-installing or otherwise using Python 1.6.1, Licensee agrees to be
-bound by the terms and conditions of this License Agreement.
-
-        ACCEPT
-
-
-CWI LICENSE AGREEMENT FOR PYTHON 0.9.0 THROUGH 1.2
---------------------------------------------------
-
-Copyright (c) 1991 - 1995, Stichting Mathematisch Centrum Amsterdam,
-The Netherlands.  All rights reserved.
-
-Permission to use, copy, modify, and distribute this software and its
-documentation for any purpose and without fee is hereby granted,
-provided that the above copyright notice appear in all copies and that
-both that copyright notice and this permission notice appear in
-supporting documentation, and that the name of Stichting Mathematisch
-Centrum or CWI not be used in advertising or publicity pertaining to
-distribution of the software without specific, written prior
-permission.
-
-STICHTING MATHEMATISCH CENTRUM DISCLAIMS ALL WARRANTIES WITH REGARD TO
-THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
-FITNESS, IN NO EVENT SHALL STICHTING MATHEMATISCH CENTRUM BE LIABLE
-FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
-WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
-ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT
-OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
diff --git a/licenses/python38-LICENSE.txt b/licenses/python38-LICENSE.txt
deleted file mode 100644
index 473861da..00000000
--- a/licenses/python38-LICENSE.txt
+++ /dev/null
@@ -1,279 +0,0 @@
-A. HISTORY OF THE SOFTWARE
-==========================
-
-Python was created in the early 1990s by Guido van Rossum at Stichting
-Mathematisch Centrum (CWI, see http://www.cwi.nl) in the Netherlands
-as a successor of a language called ABC.  Guido remains Python's
-principal author, although it includes many contributions from others.
-
-In 1995, Guido continued his work on Python at the Corporation for
-National Research Initiatives (CNRI, see http://www.cnri.reston.va.us)
-in Reston, Virginia where he released several versions of the
-software.
-
-In May 2000, Guido and the Python core development team moved to
-BeOpen.com to form the BeOpen PythonLabs team.  In October of the same
-year, the PythonLabs team moved to Digital Creations, which became
-Zope Corporation.  In 2001, the Python Software Foundation (PSF, see
-https://www.python.org/psf/) was formed, a non-profit organization
-created specifically to own Python-related Intellectual Property.
-Zope Corporation was a sponsoring member of the PSF.
-
-All Python releases are Open Source (see http://www.opensource.org for
-the Open Source Definition).  Historically, most, but not all, Python
-releases have also been GPL-compatible; the table below summarizes
-the various releases.
-
-    Release         Derived     Year        Owner       GPL-
-                    from                                compatible? (1)
-
-    0.9.0 thru 1.2              1991-1995   CWI         yes
-    1.3 thru 1.5.2  1.2         1995-1999   CNRI        yes
-    1.6             1.5.2       2000        CNRI        no
-    2.0             1.6         2000        BeOpen.com  no
-    1.6.1           1.6         2001        CNRI        yes (2)
-    2.1             2.0+1.6.1   2001        PSF         no
-    2.0.1           2.0+1.6.1   2001        PSF         yes
-    2.1.1           2.1+2.0.1   2001        PSF         yes
-    2.1.2           2.1.1       2002        PSF         yes
-    2.1.3           2.1.2       2002        PSF         yes
-    2.2 and above   2.1.1       2001-now    PSF         yes
-
-Footnotes:
-
-(1) GPL-compatible doesn't mean that we're distributing Python under
-    the GPL.  All Python licenses, unlike the GPL, let you distribute
-    a modified version without making your changes open source.  The
-    GPL-compatible licenses make it possible to combine Python with
-    other software that is released under the GPL; the others don't.
-
-(2) According to Richard Stallman, 1.6.1 is not GPL-compatible,
-    because its license has a choice of law clause.  According to
-    CNRI, however, Stallman's lawyer has told CNRI's lawyer that 1.6.1
-    is "not incompatible" with the GPL.
-
-Thanks to the many outside volunteers who have worked under Guido's
-direction to make these releases possible.
-
-
-B. TERMS AND CONDITIONS FOR ACCESSING OR OTHERWISE USING PYTHON
-===============================================================
-
-Python software and documentation are licensed under the
-Python Software Foundation License Version 2.
-
-Starting with Python 3.8.6, examples, recipes, and other code in
-the documentation are dual licensed under the PSF License Version 2
-and the Zero-Clause BSD license.
-
-Some software incorporated into Python is under different licenses.
-The licenses are listed with code falling under that license.
-
-
-PYTHON SOFTWARE FOUNDATION LICENSE VERSION 2
---------------------------------------------
-
-1. This LICENSE AGREEMENT is between the Python Software Foundation
-("PSF"), and the Individual or Organization ("Licensee") accessing and
-otherwise using this software ("Python") in source or binary form and
-its associated documentation.
-
-2. Subject to the terms and conditions of this License Agreement, PSF hereby
-grants Licensee a nonexclusive, royalty-free, world-wide license to reproduce,
-analyze, test, perform and/or display publicly, prepare derivative works,
-distribute, and otherwise use Python alone or in any derivative version,
-provided, however, that PSF's License Agreement and PSF's notice of copyright,
-i.e., "Copyright (c) 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,
-2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021 Python Software Foundation;
-All Rights Reserved" are retained in Python alone or in any derivative version
-prepared by Licensee.
-
-3. In the event Licensee prepares a derivative work that is based on
-or incorporates Python or any part thereof, and wants to make
-the derivative work available to others as provided herein, then
-Licensee hereby agrees to include in any such work a brief summary of
-the changes made to Python.
-
-4. PSF is making Python available to Licensee on an "AS IS"
-basis.  PSF MAKES NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR
-IMPLIED.  BY WAY OF EXAMPLE, BUT NOT LIMITATION, PSF MAKES NO AND
-DISCLAIMS ANY REPRESENTATION OR WARRANTY OF MERCHANTABILITY OR FITNESS
-FOR ANY PARTICULAR PURPOSE OR THAT THE USE OF PYTHON WILL NOT
-INFRINGE ANY THIRD PARTY RIGHTS.
-
-5. PSF SHALL NOT BE LIABLE TO LICENSEE OR ANY OTHER USERS OF PYTHON
-FOR ANY INCIDENTAL, SPECIAL, OR CONSEQUENTIAL DAMAGES OR LOSS AS
-A RESULT OF MODIFYING, DISTRIBUTING, OR OTHERWISE USING PYTHON,
-OR ANY DERIVATIVE THEREOF, EVEN IF ADVISED OF THE POSSIBILITY THEREOF.
-
-6. This License Agreement will automatically terminate upon a material
-breach of its terms and conditions.
-
-7. Nothing in this License Agreement shall be deemed to create any
-relationship of agency, partnership, or joint venture between PSF and
-Licensee.  This License Agreement does not grant permission to use PSF
-trademarks or trade name in a trademark sense to endorse or promote
-products or services of Licensee, or any third party.
-
-8. By copying, installing or otherwise using Python, Licensee
-agrees to be bound by the terms and conditions of this License
-Agreement.
-
-
-BEOPEN.COM LICENSE AGREEMENT FOR PYTHON 2.0
--------------------------------------------
-
-BEOPEN PYTHON OPEN SOURCE LICENSE AGREEMENT VERSION 1
-
-1. This LICENSE AGREEMENT is between BeOpen.com ("BeOpen"), having an
-office at 160 Saratoga Avenue, Santa Clara, CA 95051, and the
-Individual or Organization ("Licensee") accessing and otherwise using
-this software in source or binary form and its associated
-documentation ("the Software").
-
-2. Subject to the terms and conditions of this BeOpen Python License
-Agreement, BeOpen hereby grants Licensee a non-exclusive,
-royalty-free, world-wide license to reproduce, analyze, test, perform
-and/or display publicly, prepare derivative works, distribute, and
-otherwise use the Software alone or in any derivative version,
-provided, however, that the BeOpen Python License is retained in the
-Software, alone or in any derivative version prepared by Licensee.
-
-3. BeOpen is making the Software available to Licensee on an "AS IS"
-basis.  BEOPEN MAKES NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR
-IMPLIED.  BY WAY OF EXAMPLE, BUT NOT LIMITATION, BEOPEN MAKES NO AND
-DISCLAIMS ANY REPRESENTATION OR WARRANTY OF MERCHANTABILITY OR FITNESS
-FOR ANY PARTICULAR PURPOSE OR THAT THE USE OF THE SOFTWARE WILL NOT
-INFRINGE ANY THIRD PARTY RIGHTS.
-
-4. BEOPEN SHALL NOT BE LIABLE TO LICENSEE OR ANY OTHER USERS OF THE
-SOFTWARE FOR ANY INCIDENTAL, SPECIAL, OR CONSEQUENTIAL DAMAGES OR LOSS
-AS A RESULT OF USING, MODIFYING OR DISTRIBUTING THE SOFTWARE, OR ANY
-DERIVATIVE THEREOF, EVEN IF ADVISED OF THE POSSIBILITY THEREOF.
-
-5. This License Agreement will automatically terminate upon a material
-breach of its terms and conditions.
-
-6. This License Agreement shall be governed by and interpreted in all
-respects by the law of the State of California, excluding conflict of
-law provisions.  Nothing in this License Agreement shall be deemed to
-create any relationship of agency, partnership, or joint venture
-between BeOpen and Licensee.  This License Agreement does not grant
-permission to use BeOpen trademarks or trade names in a trademark
-sense to endorse or promote products or services of Licensee, or any
-third party.  As an exception, the "BeOpen Python" logos available at
-http://www.pythonlabs.com/logos.html may be used according to the
-permissions granted on that web page.
-
-7. By copying, installing or otherwise using the software, Licensee
-agrees to be bound by the terms and conditions of this License
-Agreement.
-
-
-CNRI LICENSE AGREEMENT FOR PYTHON 1.6.1
----------------------------------------
-
-1. This LICENSE AGREEMENT is between the Corporation for National
-Research Initiatives, having an office at 1895 Preston White Drive,
-Reston, VA 20191 ("CNRI"), and the Individual or Organization
-("Licensee") accessing and otherwise using Python 1.6.1 software in
-source or binary form and its associated documentation.
-
-2. Subject to the terms and conditions of this License Agreement, CNRI
-hereby grants Licensee a nonexclusive, royalty-free, world-wide
-license to reproduce, analyze, test, perform and/or display publicly,
-prepare derivative works, distribute, and otherwise use Python 1.6.1
-alone or in any derivative version, provided, however, that CNRI's
-License Agreement and CNRI's notice of copyright, i.e., "Copyright (c)
-1995-2001 Corporation for National Research Initiatives; All Rights
-Reserved" are retained in Python 1.6.1 alone or in any derivative
-version prepared by Licensee.  Alternately, in lieu of CNRI's License
-Agreement, Licensee may substitute the following text (omitting the
-quotes): "Python 1.6.1 is made available subject to the terms and
-conditions in CNRI's License Agreement.  This Agreement together with
-Python 1.6.1 may be located on the Internet using the following
-unique, persistent identifier (known as a handle): 1895.22/1013.  This
-Agreement may also be obtained from a proxy server on the Internet
-using the following URL: http://hdl.handle.net/1895.22/1013".
-
-3. In the event Licensee prepares a derivative work that is based on
-or incorporates Python 1.6.1 or any part thereof, and wants to make
-the derivative work available to others as provided herein, then
-Licensee hereby agrees to include in any such work a brief summary of
-the changes made to Python 1.6.1.
-
-4. CNRI is making Python 1.6.1 available to Licensee on an "AS IS"
-basis.  CNRI MAKES NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR
-IMPLIED.  BY WAY OF EXAMPLE, BUT NOT LIMITATION, CNRI MAKES NO AND
-DISCLAIMS ANY REPRESENTATION OR WARRANTY OF MERCHANTABILITY OR FITNESS
-FOR ANY PARTICULAR PURPOSE OR THAT THE USE OF PYTHON 1.6.1 WILL NOT
-INFRINGE ANY THIRD PARTY RIGHTS.
-
-5. CNRI SHALL NOT BE LIABLE TO LICENSEE OR ANY OTHER USERS OF PYTHON
-1.6.1 FOR ANY INCIDENTAL, SPECIAL, OR CONSEQUENTIAL DAMAGES OR LOSS AS
-A RESULT OF MODIFYING, DISTRIBUTING, OR OTHERWISE USING PYTHON 1.6.1,
-OR ANY DERIVATIVE THEREOF, EVEN IF ADVISED OF THE POSSIBILITY THEREOF.
-
-6. This License Agreement will automatically terminate upon a material
-breach of its terms and conditions.
-
-7. This License Agreement shall be governed by the federal
-intellectual property law of the United States, including without
-limitation the federal copyright law, and, to the extent such
-U.S. federal law does not apply, by the law of the Commonwealth of
-Virginia, excluding Virginia's conflict of law provisions.
-Notwithstanding the foregoing, with regard to derivative works based
-on Python 1.6.1 that incorporate non-separable material that was
-previously distributed under the GNU General Public License (GPL), the
-law of the Commonwealth of Virginia shall govern this License
-Agreement only as to issues arising under or with respect to
-Paragraphs 4, 5, and 7 of this License Agreement.  Nothing in this
-License Agreement shall be deemed to create any relationship of
-agency, partnership, or joint venture between CNRI and Licensee.  This
-License Agreement does not grant permission to use CNRI trademarks or
-trade name in a trademark sense to endorse or promote products or
-services of Licensee, or any third party.
-
-8. By clicking on the "ACCEPT" button where indicated, or by copying,
-installing or otherwise using Python 1.6.1, Licensee agrees to be
-bound by the terms and conditions of this License Agreement.
-
-        ACCEPT
-
-
-CWI LICENSE AGREEMENT FOR PYTHON 0.9.0 THROUGH 1.2
---------------------------------------------------
-
-Copyright (c) 1991 - 1995, Stichting Mathematisch Centrum Amsterdam,
-The Netherlands.  All rights reserved.
-
-Permission to use, copy, modify, and distribute this software and its
-documentation for any purpose and without fee is hereby granted,
-provided that the above copyright notice appear in all copies and that
-both that copyright notice and this permission notice appear in
-supporting documentation, and that the name of Stichting Mathematisch
-Centrum or CWI not be used in advertising or publicity pertaining to
-distribution of the software without specific, written prior
-permission.
-
-STICHTING MATHEMATISCH CENTRUM DISCLAIMS ALL WARRANTIES WITH REGARD TO
-THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
-FITNESS, IN NO EVENT SHALL STICHTING MATHEMATISCH CENTRUM BE LIABLE
-FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
-WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
-ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT
-OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
-
-ZERO-CLAUSE BSD LICENSE FOR CODE IN THE PYTHON DOCUMENTATION
-----------------------------------------------------------------------
-
-Permission to use, copy, modify, and/or distribute this software for any
-purpose with or without fee is hereby granted.
-
-THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
-REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
-AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
-INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
-LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
-OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
-PERFORMANCE OF THIS SOFTWARE.
diff --git a/licenses/python39-LICENSE.txt b/licenses/python39-LICENSE.txt
deleted file mode 100644
index 473861da..00000000
--- a/licenses/python39-LICENSE.txt
+++ /dev/null
@@ -1,279 +0,0 @@
-A. HISTORY OF THE SOFTWARE
-==========================
-
-Python was created in the early 1990s by Guido van Rossum at Stichting
-Mathematisch Centrum (CWI, see http://www.cwi.nl) in the Netherlands
-as a successor of a language called ABC.  Guido remains Python's
-principal author, although it includes many contributions from others.
-
-In 1995, Guido continued his work on Python at the Corporation for
-National Research Initiatives (CNRI, see http://www.cnri.reston.va.us)
-in Reston, Virginia where he released several versions of the
-software.
-
-In May 2000, Guido and the Python core development team moved to
-BeOpen.com to form the BeOpen PythonLabs team.  In October of the same
-year, the PythonLabs team moved to Digital Creations, which became
-Zope Corporation.  In 2001, the Python Software Foundation (PSF, see
-https://www.python.org/psf/) was formed, a non-profit organization
-created specifically to own Python-related Intellectual Property.
-Zope Corporation was a sponsoring member of the PSF.
-
-All Python releases are Open Source (see http://www.opensource.org for
-the Open Source Definition).  Historically, most, but not all, Python
-releases have also been GPL-compatible; the table below summarizes
-the various releases.
-
-    Release         Derived     Year        Owner       GPL-
-                    from                                compatible? (1)
-
-    0.9.0 thru 1.2              1991-1995   CWI         yes
-    1.3 thru 1.5.2  1.2         1995-1999   CNRI        yes
-    1.6             1.5.2       2000        CNRI        no
-    2.0             1.6         2000        BeOpen.com  no
-    1.6.1           1.6         2001        CNRI        yes (2)
-    2.1             2.0+1.6.1   2001        PSF         no
-    2.0.1           2.0+1.6.1   2001        PSF         yes
-    2.1.1           2.1+2.0.1   2001        PSF         yes
-    2.1.2           2.1.1       2002        PSF         yes
-    2.1.3           2.1.2       2002        PSF         yes
-    2.2 and above   2.1.1       2001-now    PSF         yes
-
-Footnotes:
-
-(1) GPL-compatible doesn't mean that we're distributing Python under
-    the GPL.  All Python licenses, unlike the GPL, let you distribute
-    a modified version without making your changes open source.  The
-    GPL-compatible licenses make it possible to combine Python with
-    other software that is released under the GPL; the others don't.
-
-(2) According to Richard Stallman, 1.6.1 is not GPL-compatible,
-    because its license has a choice of law clause.  According to
-    CNRI, however, Stallman's lawyer has told CNRI's lawyer that 1.6.1
-    is "not incompatible" with the GPL.
-
-Thanks to the many outside volunteers who have worked under Guido's
-direction to make these releases possible.
-
-
-B. TERMS AND CONDITIONS FOR ACCESSING OR OTHERWISE USING PYTHON
-===============================================================
-
-Python software and documentation are licensed under the
-Python Software Foundation License Version 2.
-
-Starting with Python 3.8.6, examples, recipes, and other code in
-the documentation are dual licensed under the PSF License Version 2
-and the Zero-Clause BSD license.
-
-Some software incorporated into Python is under different licenses.
-The licenses are listed with code falling under that license.
-
-
-PYTHON SOFTWARE FOUNDATION LICENSE VERSION 2
---------------------------------------------
-
-1. This LICENSE AGREEMENT is between the Python Software Foundation
-("PSF"), and the Individual or Organization ("Licensee") accessing and
-otherwise using this software ("Python") in source or binary form and
-its associated documentation.
-
-2. Subject to the terms and conditions of this License Agreement, PSF hereby
-grants Licensee a nonexclusive, royalty-free, world-wide license to reproduce,
-analyze, test, perform and/or display publicly, prepare derivative works,
-distribute, and otherwise use Python alone or in any derivative version,
-provided, however, that PSF's License Agreement and PSF's notice of copyright,
-i.e., "Copyright (c) 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,
-2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021 Python Software Foundation;
-All Rights Reserved" are retained in Python alone or in any derivative version
-prepared by Licensee.
-
-3. In the event Licensee prepares a derivative work that is based on
-or incorporates Python or any part thereof, and wants to make
-the derivative work available to others as provided herein, then
-Licensee hereby agrees to include in any such work a brief summary of
-the changes made to Python.
-
-4. PSF is making Python available to Licensee on an "AS IS"
-basis.  PSF MAKES NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR
-IMPLIED.  BY WAY OF EXAMPLE, BUT NOT LIMITATION, PSF MAKES NO AND
-DISCLAIMS ANY REPRESENTATION OR WARRANTY OF MERCHANTABILITY OR FITNESS
-FOR ANY PARTICULAR PURPOSE OR THAT THE USE OF PYTHON WILL NOT
-INFRINGE ANY THIRD PARTY RIGHTS.
-
-5. PSF SHALL NOT BE LIABLE TO LICENSEE OR ANY OTHER USERS OF PYTHON
-FOR ANY INCIDENTAL, SPECIAL, OR CONSEQUENTIAL DAMAGES OR LOSS AS
-A RESULT OF MODIFYING, DISTRIBUTING, OR OTHERWISE USING PYTHON,
-OR ANY DERIVATIVE THEREOF, EVEN IF ADVISED OF THE POSSIBILITY THEREOF.
-
-6. This License Agreement will automatically terminate upon a material
-breach of its terms and conditions.
-
-7. Nothing in this License Agreement shall be deemed to create any
-relationship of agency, partnership, or joint venture between PSF and
-Licensee.  This License Agreement does not grant permission to use PSF
-trademarks or trade name in a trademark sense to endorse or promote
-products or services of Licensee, or any third party.
-
-8. By copying, installing or otherwise using Python, Licensee
-agrees to be bound by the terms and conditions of this License
-Agreement.
-
-
-BEOPEN.COM LICENSE AGREEMENT FOR PYTHON 2.0
--------------------------------------------
-
-BEOPEN PYTHON OPEN SOURCE LICENSE AGREEMENT VERSION 1
-
-1. This LICENSE AGREEMENT is between BeOpen.com ("BeOpen"), having an
-office at 160 Saratoga Avenue, Santa Clara, CA 95051, and the
-Individual or Organization ("Licensee") accessing and otherwise using
-this software in source or binary form and its associated
-documentation ("the Software").
-
-2. Subject to the terms and conditions of this BeOpen Python License
-Agreement, BeOpen hereby grants Licensee a non-exclusive,
-royalty-free, world-wide license to reproduce, analyze, test, perform
-and/or display publicly, prepare derivative works, distribute, and
-otherwise use the Software alone or in any derivative version,
-provided, however, that the BeOpen Python License is retained in the
-Software, alone or in any derivative version prepared by Licensee.
-
-3. BeOpen is making the Software available to Licensee on an "AS IS"
-basis.  BEOPEN MAKES NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR
-IMPLIED.  BY WAY OF EXAMPLE, BUT NOT LIMITATION, BEOPEN MAKES NO AND
-DISCLAIMS ANY REPRESENTATION OR WARRANTY OF MERCHANTABILITY OR FITNESS
-FOR ANY PARTICULAR PURPOSE OR THAT THE USE OF THE SOFTWARE WILL NOT
-INFRINGE ANY THIRD PARTY RIGHTS.
-
-4. BEOPEN SHALL NOT BE LIABLE TO LICENSEE OR ANY OTHER USERS OF THE
-SOFTWARE FOR ANY INCIDENTAL, SPECIAL, OR CONSEQUENTIAL DAMAGES OR LOSS
-AS A RESULT OF USING, MODIFYING OR DISTRIBUTING THE SOFTWARE, OR ANY
-DERIVATIVE THEREOF, EVEN IF ADVISED OF THE POSSIBILITY THEREOF.
-
-5. This License Agreement will automatically terminate upon a material
-breach of its terms and conditions.
-
-6. This License Agreement shall be governed by and interpreted in all
-respects by the law of the State of California, excluding conflict of
-law provisions.  Nothing in this License Agreement shall be deemed to
-create any relationship of agency, partnership, or joint venture
-between BeOpen and Licensee.  This License Agreement does not grant
-permission to use BeOpen trademarks or trade names in a trademark
-sense to endorse or promote products or services of Licensee, or any
-third party.  As an exception, the "BeOpen Python" logos available at
-http://www.pythonlabs.com/logos.html may be used according to the
-permissions granted on that web page.
-
-7. By copying, installing or otherwise using the software, Licensee
-agrees to be bound by the terms and conditions of this License
-Agreement.
-
-
-CNRI LICENSE AGREEMENT FOR PYTHON 1.6.1
----------------------------------------
-
-1. This LICENSE AGREEMENT is between the Corporation for National
-Research Initiatives, having an office at 1895 Preston White Drive,
-Reston, VA 20191 ("CNRI"), and the Individual or Organization
-("Licensee") accessing and otherwise using Python 1.6.1 software in
-source or binary form and its associated documentation.
-
-2. Subject to the terms and conditions of this License Agreement, CNRI
-hereby grants Licensee a nonexclusive, royalty-free, world-wide
-license to reproduce, analyze, test, perform and/or display publicly,
-prepare derivative works, distribute, and otherwise use Python 1.6.1
-alone or in any derivative version, provided, however, that CNRI's
-License Agreement and CNRI's notice of copyright, i.e., "Copyright (c)
-1995-2001 Corporation for National Research Initiatives; All Rights
-Reserved" are retained in Python 1.6.1 alone or in any derivative
-version prepared by Licensee.  Alternately, in lieu of CNRI's License
-Agreement, Licensee may substitute the following text (omitting the
-quotes): "Python 1.6.1 is made available subject to the terms and
-conditions in CNRI's License Agreement.  This Agreement together with
-Python 1.6.1 may be located on the Internet using the following
-unique, persistent identifier (known as a handle): 1895.22/1013.  This
-Agreement may also be obtained from a proxy server on the Internet
-using the following URL: http://hdl.handle.net/1895.22/1013".
-
-3. In the event Licensee prepares a derivative work that is based on
-or incorporates Python 1.6.1 or any part thereof, and wants to make
-the derivative work available to others as provided herein, then
-Licensee hereby agrees to include in any such work a brief summary of
-the changes made to Python 1.6.1.
-
-4. CNRI is making Python 1.6.1 available to Licensee on an "AS IS"
-basis.  CNRI MAKES NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR
-IMPLIED.  BY WAY OF EXAMPLE, BUT NOT LIMITATION, CNRI MAKES NO AND
-DISCLAIMS ANY REPRESENTATION OR WARRANTY OF MERCHANTABILITY OR FITNESS
-FOR ANY PARTICULAR PURPOSE OR THAT THE USE OF PYTHON 1.6.1 WILL NOT
-INFRINGE ANY THIRD PARTY RIGHTS.
-
-5. CNRI SHALL NOT BE LIABLE TO LICENSEE OR ANY OTHER USERS OF PYTHON
-1.6.1 FOR ANY INCIDENTAL, SPECIAL, OR CONSEQUENTIAL DAMAGES OR LOSS AS
-A RESULT OF MODIFYING, DISTRIBUTING, OR OTHERWISE USING PYTHON 1.6.1,
-OR ANY DERIVATIVE THEREOF, EVEN IF ADVISED OF THE POSSIBILITY THEREOF.
-
-6. This License Agreement will automatically terminate upon a material
-breach of its terms and conditions.
-
-7. This License Agreement shall be governed by the federal
-intellectual property law of the United States, including without
-limitation the federal copyright law, and, to the extent such
-U.S. federal law does not apply, by the law of the Commonwealth of
-Virginia, excluding Virginia's conflict of law provisions.
-Notwithstanding the foregoing, with regard to derivative works based
-on Python 1.6.1 that incorporate non-separable material that was
-previously distributed under the GNU General Public License (GPL), the
-law of the Commonwealth of Virginia shall govern this License
-Agreement only as to issues arising under or with respect to
-Paragraphs 4, 5, and 7 of this License Agreement.  Nothing in this
-License Agreement shall be deemed to create any relationship of
-agency, partnership, or joint venture between CNRI and Licensee.  This
-License Agreement does not grant permission to use CNRI trademarks or
-trade name in a trademark sense to endorse or promote products or
-services of Licensee, or any third party.
-
-8. By clicking on the "ACCEPT" button where indicated, or by copying,
-installing or otherwise using Python 1.6.1, Licensee agrees to be
-bound by the terms and conditions of this License Agreement.
-
-        ACCEPT
-
-
-CWI LICENSE AGREEMENT FOR PYTHON 0.9.0 THROUGH 1.2
---------------------------------------------------
-
-Copyright (c) 1991 - 1995, Stichting Mathematisch Centrum Amsterdam,
-The Netherlands.  All rights reserved.
-
-Permission to use, copy, modify, and distribute this software and its
-documentation for any purpose and without fee is hereby granted,
-provided that the above copyright notice appear in all copies and that
-both that copyright notice and this permission notice appear in
-supporting documentation, and that the name of Stichting Mathematisch
-Centrum or CWI not be used in advertising or publicity pertaining to
-distribution of the software without specific, written prior
-permission.
-
-STICHTING MATHEMATISCH CENTRUM DISCLAIMS ALL WARRANTIES WITH REGARD TO
-THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
-FITNESS, IN NO EVENT SHALL STICHTING MATHEMATISCH CENTRUM BE LIABLE
-FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
-WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
-ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT
-OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
-
-ZERO-CLAUSE BSD LICENSE FOR CODE IN THE PYTHON DOCUMENTATION
-----------------------------------------------------------------------
-
-Permission to use, copy, modify, and/or distribute this software for any
-purpose with or without fee is hereby granted.
-
-THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
-REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
-AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
-INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
-LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
-OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
-PERFORMANCE OF THIS SOFTWARE.
diff --git a/licenses/usd-LICENSE.txt b/licenses/usd-LICENSE.txt
deleted file mode 100644
index 10c6a6c9..00000000
--- a/licenses/usd-LICENSE.txt
+++ /dev/null
@@ -1,451 +0,0 @@
-Universal Scene Description (USD) components are licensed under the following terms:
-
-
-                               Modified Apache 2.0 License
-
-
-   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION
-
-   1. Definitions.
-
-      "License" shall mean the terms and conditions for use, reproduction,
-      and distribution as defined by Sections 1 through 9 of this document.
-
-      "Licensor" shall mean the copyright owner or entity authorized by
-      the copyright owner that is granting the License.
-
-      "Legal Entity" shall mean the union of the acting entity and all
-      other entities that control, are controlled by, or are under common
-      control with that entity. For the purposes of this definition,
-      "control" means (i) the power, direct or indirect, to cause the
-      direction or management of such entity, whether by contract or
-      otherwise, or (ii) ownership of fifty percent (50%) or more of the
-      outstanding shares, or (iii) beneficial ownership of such entity.
-
-      "You" (or "Your") shall mean an individual or Legal Entity
-      exercising permissions granted by this License.
-
-      "Source" form shall mean the preferred form for making modifications,
-      including but not limited to software source code, documentation
-      source, and configuration files.
-
-      "Object" form shall mean any form resulting from mechanical
-      transformation or translation of a Source form, including but
-      not limited to compiled object code, generated documentation,
-      and conversions to other media types.
-
-      "Work" shall mean the work of authorship, whether in Source or
-      Object form, made available under the License, as indicated by a
-      copyright notice that is included in or attached to the work
-      (an example is provided in the Appendix below).
-
-      "Derivative Works" shall mean any work, whether in Source or Object
-      form, that is based on (or derived from) the Work and for which the
-      editorial revisions, annotations, elaborations, or other modifications
-      represent, as a whole, an original work of authorship. For the purposes
-      of this License, Derivative Works shall not include works that remain
-      separable from, or merely link (or bind by name) to the interfaces of,
-      the Work and Derivative Works thereof.
-
-      "Contribution" shall mean any work of authorship, including
-      the original version of the Work and any modifications or additions
-      to that Work or Derivative Works thereof, that is intentionally
-      submitted to Licensor for inclusion in the Work by the copyright owner
-      or by an individual or Legal Entity authorized to submit on behalf of
-      the copyright owner. For the purposes of this definition, "submitted"
-      means any form of electronic, verbal, or written communication sent
-      to the Licensor or its representatives, including but not limited to
-      communication on electronic mailing lists, source code control systems,
-      and issue tracking systems that are managed by, or on behalf of, the
-      Licensor for the purpose of discussing and improving the Work, but
-      excluding communication that is conspicuously marked or otherwise
-      designated in writing by the copyright owner as "Not a Contribution."
-
-      "Contributor" shall mean Licensor and any individual or Legal Entity
-      on behalf of whom a Contribution has been received by Licensor and
-      subsequently incorporated within the Work.
-
-   2. Grant of Copyright License. Subject to the terms and conditions of
-      this License, each Contributor hereby grants to You a perpetual,
-      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
-      copyright license to reproduce, prepare Derivative Works of,
-      publicly display, publicly perform, sublicense, and distribute the
-      Work and such Derivative Works in Source or Object form.
-
-   3. Grant of Patent License. Subject to the terms and conditions of
-      this License, each Contributor hereby grants to You a perpetual,
-      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
-      (except as stated in this section) patent license to make, have made,
-      use, offer to sell, sell, import, and otherwise transfer the Work,
-      where such license applies only to those patent claims licensable
-      by such Contributor that are necessarily infringed by their
-      Contribution(s) alone or by combination of their Contribution(s)
-      with the Work to which such Contribution(s) was submitted. If You
-      institute patent litigation against any entity (including a
-      cross-claim or counterclaim in a lawsuit) alleging that the Work
-      or a Contribution incorporated within the Work constitutes direct
-      or contributory patent infringement, then any patent licenses
-      granted to You under this License for that Work shall terminate
-      as of the date such litigation is filed.
-
-   4. Redistribution. You may reproduce and distribute copies of the
-      Work or Derivative Works thereof in any medium, with or without
-      modifications, and in Source or Object form, provided that You
-      meet the following conditions:
-
-      (a) You must give any other recipients of the Work or
-          Derivative Works a copy of this License; and
-
-      (b) You must cause any modified files to carry prominent notices
-          stating that You changed the files; and
-
-      (c) You must retain, in the Source form of any Derivative Works
-          that You distribute, all copyright, patent, trademark, and
-          attribution notices from the Source form of the Work,
-          excluding those notices that do not pertain to any part of
-          the Derivative Works; and
-
-      (d) If the Work includes a "NOTICE" text file as part of its
-          distribution, then any Derivative Works that You distribute must
-          include a readable copy of the attribution notices contained
-          within such NOTICE file, excluding those notices that do not
-          pertain to any part of the Derivative Works, in at least one
-          of the following places: within a NOTICE text file distributed
-          as part of the Derivative Works; within the Source form or
-          documentation, if provided along with the Derivative Works; or,
-          within a display generated by the Derivative Works, if and
-          wherever such third-party notices normally appear. The contents
-          of the NOTICE file are for informational purposes only and
-          do not modify the License. You may add Your own attribution
-          notices within Derivative Works that You distribute, alongside
-          or as an addendum to the NOTICE text from the Work, provided
-          that such additional attribution notices cannot be construed
-          as modifying the License.
-
-      You may add Your own copyright statement to Your modifications and
-      may provide additional or different license terms and conditions
-      for use, reproduction, or distribution of Your modifications, or
-      for any such Derivative Works as a whole, provided Your use,
-      reproduction, and distribution of the Work otherwise complies with
-      the conditions stated in this License.
-
-   5. Submission of Contributions. Unless You explicitly state otherwise,
-      any Contribution intentionally submitted for inclusion in the Work
-      by You to the Licensor shall be under the terms and conditions of
-      this License, without any additional terms or conditions.
-      Notwithstanding the above, nothing herein shall supersede or modify
-      the terms of any separate license agreement you may have executed
-      with Licensor regarding such Contributions.
-
-   6. Trademarks. This License does not grant permission to use the trade
-      names, trademarks, service marks, or product names of the Licensor
-      and its affiliates, except as required to comply with Section 4(c) of
-      the License and to reproduce the content of the NOTICE file.
-
-   7. Disclaimer of Warranty. Unless required by applicable law or
-      agreed to in writing, Licensor provides the Work (and each
-      Contributor provides its Contributions) on an "AS IS" BASIS,
-      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
-      implied, including, without limitation, any warranties or conditions
-      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
-      PARTICULAR PURPOSE. You are solely responsible for determining the
-      appropriateness of using or redistributing the Work and assume any
-      risks associated with Your exercise of permissions under this License.
-
-   8. Limitation of Liability. In no event and under no legal theory,
-      whether in tort (including negligence), contract, or otherwise,
-      unless required by applicable law (such as deliberate and grossly
-      negligent acts) or agreed to in writing, shall any Contributor be
-      liable to You for damages, including any direct, indirect, special,
-      incidental, or consequential damages of any character arising as a
-      result of this License or out of the use or inability to use the
-      Work (including but not limited to damages for loss of goodwill,
-      work stoppage, computer failure or malfunction, or any and all
-      other commercial damages or losses), even if such Contributor
-      has been advised of the possibility of such damages.
-
-   9. Accepting Warranty or Additional Liability. While redistributing
-      the Work or Derivative Works thereof, You may choose to offer,
-      and charge a fee for, acceptance of support, warranty, indemnity,
-      or other liability obligations and/or rights consistent with this
-      License. However, in accepting such obligations, You may act only
-      on Your own behalf and on Your sole responsibility, not on behalf
-      of any other Contributor, and only if You agree to indemnify,
-      defend, and hold each Contributor harmless for any liability
-      incurred by, or claims asserted against, such Contributor by reason
-      of your accepting any such warranty or additional liability.
-
-============================================================
-RapidJSON
-============================================================
-
-Tencent is pleased to support the open source community by making RapidJSON available. 
- 
-Copyright (C) 2015 THL A29 Limited, a Tencent company, and Milo Yip.  All rights reserved.
-
-If you have downloaded a copy of the RapidJSON binary from Tencent, please note that the RapidJSON binary is licensed under the MIT License.
-If you have downloaded a copy of the RapidJSON source code from Tencent, please note that RapidJSON source code is licensed under the MIT License, except for the third-party components listed below which are subject to different license terms.  Your integration of RapidJSON into your own projects may require compliance with the MIT License, as well as the other licenses applicable to the third-party components included within RapidJSON. To avoid the problematic JSON license in your own projects, it's sufficient to exclude the bin/jsonchecker/ directory, as it's the only code under the JSON license.
-A copy of the MIT License is included in this file.
-
-Other dependencies and licenses:
-
-Open Source Software Licensed Under the BSD License:
---------------------------------------------------------------------
-
-The msinttypes r29 
-Copyright (c) 2006-2013 Alexander Chemeris 
-All rights reserved.
-
-Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
-
-* Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. 
-* Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
-* Neither the name of  copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.
-
-THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE REGENTS AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-
-Open Source Software Licensed Under the JSON License:
---------------------------------------------------------------------
-
-json.org 
-Copyright (c) 2002 JSON.org
-All Rights Reserved.
-
-JSON_checker
-Copyright (c) 2002 JSON.org
-All Rights Reserved.
-
-	
-Terms of the JSON License:
----------------------------------------------------
-
-Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
-
-The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-
-The Software shall be used for Good, not Evil.
-
-THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
-
-
-Terms of the MIT License:
---------------------------------------------------------------------
-
-Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
-
-The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-
-THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
-
-============================================================
-pygilstate_check
-============================================================
-
-The MIT License (MIT)
-
-Copyright (c) 2014, Pankaj Pandey
-
-Permission is hereby granted, free of charge, to any person obtaining a copy
-of this software and associated documentation files (the "Software"), to deal
-in the Software without restriction, including without limitation the rights
-to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
-copies of the Software, and to permit persons to whom the Software is
-furnished to do so, subject to the following conditions:
-
-The above copyright notice and this permission notice shall be included in all
-copies or substantial portions of the Software.
-
-THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
-IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
-FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
-AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
-LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
-OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
-SOFTWARE.
-
-============================================================
-double-conversion
-============================================================
-
-Copyright 2006-2011, the V8 project authors. All rights reserved.
-Redistribution and use in source and binary forms, with or without
-modification, are permitted provided that the following conditions are
-met:
-
-    * Redistributions of source code must retain the above copyright
-      notice, this list of conditions and the following disclaimer.
-    * Redistributions in binary form must reproduce the above
-      copyright notice, this list of conditions and the following
-      disclaimer in the documentation and/or other materials provided
-      with the distribution.
-    * Neither the name of Google Inc. nor the names of its
-      contributors may be used to endorse or promote products derived
-      from this software without specific prior written permission.
-
-THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
-"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
-LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
-A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
-OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
-SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
-LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
-DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
-THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
-(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
-OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-
-============================================================
-OpenEXR/IlmBase/Half
-============================================================
-
-///////////////////////////////////////////////////////////////////////////
-//
-// Copyright (c) 2002, Industrial Light & Magic, a division of Lucas
-// Digital Ltd. LLC
-// 
-// All rights reserved.
-// 
-// Redistribution and use in source and binary forms, with or without
-// modification, are permitted provided that the following conditions are
-// met:
-// *       Redistributions of source code must retain the above copyright
-// notice, this list of conditions and the following disclaimer.
-// *       Redistributions in binary form must reproduce the above
-// copyright notice, this list of conditions and the following disclaimer
-// in the documentation and/or other materials provided with the
-// distribution.
-// *       Neither the name of Industrial Light & Magic nor the names of
-// its contributors may be used to endorse or promote products derived
-// from this software without specific prior written permission. 
-// 
-// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
-// "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
-// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
-// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
-// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
-// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
-// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
-// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
-// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
-// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
-// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-//
-///////////////////////////////////////////////////////////////////////////
-
-============================================================
-Apple Technical Q&A QA1361 - Detecting the Debugger
-https://developer.apple.com/library/content/qa/qa1361/_index.html
-============================================================
-
-Sample code project: Detecting the Debugger
-Version: 1.0
-
-Abstract: Shows how to determine if code is being run under the debugger.
-
-IMPORTANT:  This Apple software is supplied to you by Apple
-Inc. ("Apple") in consideration of your agreement to the following
-terms, and your use, installation, modification or redistribution of
-this Apple software constitutes acceptance of these terms.  If you do
-not agree with these terms, please do not use, install, modify or
-redistribute this Apple software.
-
-In consideration of your agreement to abide by the following terms, and
-subject to these terms, Apple grants you a personal, non-exclusive
-license, under Apple's copyrights in this original Apple software (the
-"Apple Software"), to use, reproduce, modify and redistribute the Apple
-Software, with or without modifications, in source and/or binary forms;
-provided that if you redistribute the Apple Software in its entirety and
-without modifications, you must retain this notice and the following
-text and disclaimers in all such redistributions of the Apple Software.
-Neither the name, trademarks, service marks or logos of Apple Inc. may
-be used to endorse or promote products derived from the Apple Software
-without specific prior written permission from Apple.  Except as
-expressly stated in this notice, no other rights or licenses, express or
-implied, are granted by Apple herein, including but not limited to any
-patent rights that may be infringed by your derivative works or by other
-works in which the Apple Software may be incorporated.
- 
-The Apple Software is provided by Apple on an "AS IS" basis.  APPLE
-MAKES NO WARRANTIES, EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION
-THE IMPLIED WARRANTIES OF NON-INFRINGEMENT, MERCHANTABILITY AND FITNESS
-FOR A PARTICULAR PURPOSE, REGARDING THE APPLE SOFTWARE OR ITS USE AND
-OPERATION ALONE OR IN COMBINATION WITH YOUR PRODUCTS.
- 
-IN NO EVENT SHALL APPLE BE LIABLE FOR ANY SPECIAL, INDIRECT, INCIDENTAL
-OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
-SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
-INTERRUPTION) ARISING IN ANY WAY OUT OF THE USE, REPRODUCTION,
-MODIFICATION AND/OR DISTRIBUTION OF THE APPLE SOFTWARE, HOWEVER CAUSED
-AND WHETHER UNDER THEORY OF CONTRACT, TORT (INCLUDING NEGLIGENCE),
-STRICT LIABILITY OR OTHERWISE, EVEN IF APPLE HAS BEEN ADVISED OF THE
-POSSIBILITY OF SUCH DAMAGE.
-
-============================================================
-LZ4
-============================================================
-
-LZ4 - Fast LZ compression algorithm
-Copyright (C) 2011-2017, Yann Collet.
-
-BSD 2-Clause License (http://www.opensource.org/licenses/bsd-license.php)
-
-Redistribution and use in source and binary forms, with or without
-modification, are permitted provided that the following conditions are
-met:
-
-    * Redistributions of source code must retain the above copyright
-notice, this list of conditions and the following disclaimer.
-    * Redistributions in binary form must reproduce the above
-copyright notice, this list of conditions and the following disclaimer
-in the documentation and/or other materials provided with the
-distribution.
-
-THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
-"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
-LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
-A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
-OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
-SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
-LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
-DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
-THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
-(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
-OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-
-You can contact the author at :
- - LZ4 homepage : http://www.lz4.org
- - LZ4 source repository : https://github.com/lz4/lz4
-
-============================================================
-stb
-============================================================
-
-stb_image - v2.19 - public domain image loader - http://nothings.org/stb
-                                  no warranty implied; use at your own risk
-
-stb_image_resize - v0.95 - public domain image resizing
-   by Jorge L Rodriguez (@VinoBS) - 2014
-      http://github.com/nothings/stb
-
-stb_image_write - v1.09 - public domain - http://nothings.org/stb/stb_image_write.h
-   writes out PNG/BMP/TGA/JPEG/HDR images to C stdio - Sean Barrett 2010-2015
-                                        no warranty implied; use at your own risk
-
-ALTERNATIVE B - Public Domain (www.unlicense.org)                               
-This is free and unencumbered software released into the public domain.         
-Anyone is free to copy, modify, publish, use, compile, sell, or distribute this 
-software, either in source code form or as a compiled binary, for any purpose,  
-commercial or non-commercial, and by any means.                                 
-In jurisdictions that recognize copyright laws, the author or authors of this   
-software dedicate any and all copyright interest in the software to the public  
-domain. We make this dedication for the benefit of the public at large and to   
-the detriment of our heirs and successors. We intend this dedication to be an   
-overt act of relinquishment in perpetuity of all present and future rights to   
-this software under copyright law.                                              
-THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR          
-IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,        
-FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE         
-AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN          
-ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION    
-WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.                 
-
diff --git a/licenses/windingnumber-LICENSE.txt b/licenses/windingnumber-LICENSE.txt
new file mode 100644
index 00000000..31c6aa55
--- /dev/null
+++ b/licenses/windingnumber-LICENSE.txt
@@ -0,0 +1,21 @@
+MIT License
+
+Copyright (c) 2018 Side Effects Software Inc.
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in all
+copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+SOFTWARE.
diff --git a/pyproject.toml b/pyproject.toml
index ecab2fcb..cc1bd1ab 100644
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -14,7 +14,7 @@
 # limitations under the License.
 
 [build-system]
-requires = ["setuptools>=61", "build", "wheel"]
+requires = ["setuptools>=75.3.2", "build", "wheel"]
 build-backend = "setuptools.build_meta"
 
 [project]
@@ -34,6 +34,7 @@ classifiers = [
     "Programming Language :: Python :: 3.11",
     "Programming Language :: Python :: 3.12",
     "Programming Language :: Python :: 3.13",
+    "Programming Language :: Python :: 3.14",
     "Programming Language :: Python :: 3 :: Only",
     "Environment :: GPU :: NVIDIA CUDA",
     "Environment :: GPU :: NVIDIA CUDA :: 12",
@@ -54,19 +55,32 @@ Changelog = "https://github.com/NVIDIA/warp/blob/main/CHANGELOG.md"
 docs = [
     'nvidia-sphinx-theme; python_version >= "3.9"',
     "sphinx-copybutton",
-    "ruff == 0.11.10",
+    "pre-commit",
     "myst_parser",
 ]
+benchmark = [
+    "usd-core>=25.5 ; platform_machine != 'aarch64' and python_version < '3.14'",
+    "usd-exchange>=2.1.0a3 ; python_full_version >= '3.10' and platform_machine == 'aarch64'",
+]
+examples = [
+    "blosc>=1.11.1",
+    "matplotlib>=3.7.5",
+    "pillow>=10.4.0",
+    "psutil>=7.1.0",
+    "pyglet>=2.1.9",
+    "usd-core>=25.5 ; platform_machine != 'aarch64' and python_version < '3.14'",
+    "usd-exchange>=2.1.0a3 ; python_full_version >= '3.10' and platform_machine == 'aarch64'",
+]
+torch-cu12 = [
+    "warp-lang[examples]",
+    'torch>=2.7.0; python_version >= "3.9"',
+]
 dev = [
-    "pre-commit",
-    "ruff == 0.11.10",
+    "warp-lang[examples]",
+    "warp-lang[docs]",
     "nvtx",
-    'nvidia-sphinx-theme; python_version >= "3.9"',
-    "sphinx-copybutton",
     "coverage[toml]",
 ]
-benchmark = ["usd-core ; platform_machine != 'aarch64'"]
-extras = ['usd-core', 'matplotlib', 'pillow', 'pyglet']
 
 [tool.setuptools.packages.find]
 include = ["warp*"]
@@ -84,7 +98,6 @@ extend-exclude = [
     "warp/thirdparty/appdirs.py",
     "warp/thirdparty/dlpack.py",
     "tools",
-    "__init__.pyi",
 ]
 
 [tool.ruff.lint]
@@ -113,6 +126,7 @@ ignore = [
     "UP018",   # Warp kernels often use float(val) and int(val)
     "RUF046",  # Warp kernels often use int(val)
 ]
+exclude = ["warp/__init__.pyi"]
 
 [tool.ruff.lint.per-file-ignores]
 "__init__.py" = ["F401", "PLC0414"]
@@ -130,7 +144,7 @@ line-ending = "auto"
 docstring-code-format = true
 
 [tool.coverage.run]
-source = ["warp", "warp.sim", "warp.render"]
+source = ["warp", "warp.render"]
 disable_warnings = [
     "module-not-measured",
     "module-not-imported",
@@ -163,3 +177,31 @@ name = "testpypi"
 url = "https://test.pypi.org/simple/"
 publish-url = "https://test.pypi.org/legacy/"
 explicit = true
+
+[tool.uv.sources]
+torch = [{ index = "pytorch-cu129", extra = "torch-cu12" }]
+
+[[tool.uv.index]]
+name = "pytorch-cu129"
+url = "https://download.pytorch.org/whl/cu129"
+explicit = true
+
+[tool.typos]
+files.extend-exclude = ["/tools/packman", "/tools/repoman", "/PUBLICATIONS.md", "/licenses", "/warp/native/nanovdb", "*.svg", "*.usda"]
+
+[tool.typos.default]
+extend-ignore-re = [
+    # MSVC compiler flags like /Fo, /Fe, /Fd, etc.
+    "/F[oedpircaOAu]"
+]
+
+[tool.typos.default.extend-words]
+arange = "arange"
+commun = "commun"
+dout = "dout"
+iy = "iy"
+nd = "nd"
+
+[tool.typos.default.extend-identifiers]
+CU_DEVICE_ATTRIBUTE_MAX_SHARED_MEMORY_PER_BLOCK_OPTIN = "CU_DEVICE_ATTRIBUTE_MAX_SHARED_MEMORY_PER_BLOCK_OPTIN"
+ba = "ba"
diff --git a/setup.py b/setup.py
index b131f4e3..bad24c27 100644
--- a/setup.py
+++ b/setup.py
@@ -36,7 +36,7 @@ parser.add_argument(
     "-M",
     type=str,
     default="manylinux_2_28",
-    help="Manylinux flavor for Linux wheels: manylinux_2_28|manylinux_2_34",
+    help="Manylinux flavor for Linux wheels: manylinux2014|manylinux_2_28|manylinux_2_34",
 )
 args = parser.parse_known_args()[0]
 
@@ -164,7 +164,7 @@ class WarpBDistWheel(bdist_wheel):
     user_options: ClassVar[list[tuple[str, str, str]]] = [
         *bdist_wheel.user_options,
         ("platform=", "P", "Wheel platform: windows|linux|macos-x86_64|aarch64|universal"),
-        ("manylinux=", "M", "Manylinux flavor for Linux wheels: manylinux_2_28|manylinux_2_34"),
+        ("manylinux=", "M", "Manylinux flavor for Linux wheels: manylinux2014|manylinux_2_28|manylinux_2_34"),
     ]
 
     def initialize_options(self):
@@ -232,7 +232,6 @@ setuptools.setup(
         ]
     },
     distclass=BinaryDistribution,
-    cmdclass={
-        "bdist_wheel": WarpBDistWheel,
-    },
+    cmdclass={"bdist_wheel": WarpBDistWheel},
+    license_files=["LICENSE.md", "licenses/*.txt"],
 )
diff --git a/tools/ci/publishing/set_nightly_version.py b/tools/ci/publishing/set_nightly_version.py
index 6bc8179d..d8341d5d 100644
--- a/tools/ci/publishing/set_nightly_version.py
+++ b/tools/ci/publishing/set_nightly_version.py
@@ -26,25 +26,48 @@ def increment_minor(version: str) -> str:
     """Return an incremented version based on the input semantic version.
     
     Args:
-        version: Input version string in format <major>.<minor>.<patch>.
+        version: Input version string in format <major>.<minor>.<patch> or 
+                <major>.<minor>.<patch><tag>.
         
     Returns:
-        New version with incremented minor version and patch set to 0.
+        New version with incremented minor version, patch set to 0, and tag removed.
         
     Raises:
         ValueError: If version string is not in expected format.
     """
     # Split the version string into components
     parts = version.split(".")
-    if len(parts) != 3:
-        raise ValueError("Version string must be in <major>.<minor>.<patch> format")
+    if len(parts) < 3:
+        raise ValueError("Version string must be in <major>.<minor>.<patch> or <major>.<minor>.<patch><tag> format")
+    
+    # Extract major, minor, and patch
+    major = int(parts[0])
+    minor = int(parts[1])
+    
+    # Handle patch and potential tag
+    patch_part = parts[2]
+    if patch_part.isdigit():
+        # Simple case: major.minor.patch
+        patch = int(patch_part)
+    else:
+        # Case with tag: major.minor.patch<tag>
+        # Find where digits end and tag begins
+        patch_end = 0
+        for i, char in enumerate(patch_part):
+            if not char.isdigit():
+                patch_end = i
+                break
+        
+        if patch_end == 0:
+            raise ValueError("Patch version must contain at least one digit")
+        
+        patch = int(patch_part[:patch_end])
     
     # Increment the minor version and reset patch to 0
-    major, minor, patch = map(int, parts)
     minor += 1
     patch = 0
     
-    # Return the new version string
+    # Return the new version string without tag
     return f"{major}.{minor}.{patch}"
 
 def write_new_version_to_config(config_file_path: str, new_version: str, dry_run: bool = False) -> bool:
@@ -152,7 +175,13 @@ if __name__ == "__main__":
             base_version = file.readline().strip()
             
         # Increment the minor version so the nightly build is considered newer than the latest release
-        base_version_incremented = increment_minor(base_version)
+        # But don't increment if the base version is already a dev version
+        if "dev" in base_version:
+            # Extract the version part before "dev" (e.g., "1.9.0" from "1.9.0.dev0")
+            dev_index = base_version.find("dev")
+            base_version_incremented = base_version[:dev_index].rstrip(".")
+        else:
+            base_version_incremented = increment_minor(base_version)
 
         # See https://peps.python.org/pep-0440/#developmental-releases
         dateint = args.date if args.date else datetime.date.today().strftime("%Y%m%d")
diff --git a/uv.lock b/uv.lock
new file mode 100644
index 00000000..844209fe
--- /dev/null
+++ b/uv.lock
@@ -0,0 +1,3823 @@
+version = 1
+revision = 3
+requires-python = ">=3.8"
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+
+[[package]]
+name = "accessible-pygments"
+version = "0.0.5"
+source = { registry = "https://pypi.org/simple" }
+dependencies = [
+    { name = "pygments", marker = "python_full_version >= '3.9'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/bc/c1/bbac6a50d02774f91572938964c582fff4270eee73ab822a4aeea4d8b11b/accessible_pygments-0.0.5.tar.gz", hash = "sha256:40918d3e6a2b619ad424cb91e556bd3bd8865443d9f22f1dcdf79e33c8046872", size = 1377899, upload-time = "2024-05-10T11:23:10.216Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/8d/3f/95338030883d8c8b91223b4e21744b04d11b161a3ef117295d8241f50ab4/accessible_pygments-0.0.5-py3-none-any.whl", hash = "sha256:88ae3211e68a1d0b011504b2ffc1691feafce124b845bd072ab6f9f66f34d4b7", size = 1395903, upload-time = "2024-05-10T11:23:08.421Z" },
+]
+
+[[package]]
+name = "alabaster"
+version = "0.7.13"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/94/71/a8ee96d1fd95ca04a0d2e2d9c4081dac4c2d2b12f7ddb899c8cb9bfd1532/alabaster-0.7.13.tar.gz", hash = "sha256:a27a4a084d5e690e16e01e03ad2b2e552c61a65469419b907243193de1a84ae2", size = 11454, upload-time = "2023-01-13T06:42:53.797Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/64/88/c7083fc61120ab661c5d0b82cb77079fc1429d3f913a456c1c82cf4658f7/alabaster-0.7.13-py3-none-any.whl", hash = "sha256:1ee19aca801bbabb5ba3f5f258e4422dfa86f82f3e9cefb0859b283cdd7f62a3", size = 13857, upload-time = "2023-01-13T06:42:52.336Z" },
+]
+
+[[package]]
+name = "alabaster"
+version = "0.7.16"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/c9/3e/13dd8e5ed9094e734ac430b5d0eb4f2bb001708a8b7856cbf8e084e001ba/alabaster-0.7.16.tar.gz", hash = "sha256:75a8b99c28a5dad50dd7f8ccdd447a121ddb3892da9e53d1ca5cca3106d58d65", size = 23776, upload-time = "2024-01-10T00:56:10.189Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/32/34/d4e1c02d3bee589efb5dfa17f88ea08bdb3e3eac12bc475462aec52ed223/alabaster-0.7.16-py3-none-any.whl", hash = "sha256:b46733c07dce03ae4e150330b975c75737fa60f0a7c591b6c8bf4928a28e2c92", size = 13511, upload-time = "2024-01-10T00:56:08.388Z" },
+]
+
+[[package]]
+name = "alabaster"
+version = "1.0.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/a6/f8/d9c74d0daf3f742840fd818d69cfae176fa332022fd44e3469487d5a9420/alabaster-1.0.0.tar.gz", hash = "sha256:c00dca57bca26fa62a6d7d0a9fcce65f3e026e9bfe33e9c538fd3fbb2144fd9e", size = 24210, upload-time = "2024-07-26T18:15:03.762Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/7e/b3/6b4067be973ae96ba0d615946e314c5ae35f9f993eca561b356540bb0c2b/alabaster-1.0.0-py3-none-any.whl", hash = "sha256:fc6786402dc3fcb2de3cabd5fe455a2db534b371124f1f21de8731783dec828b", size = 13929, upload-time = "2024-07-26T18:15:02.05Z" },
+]
+
+[[package]]
+name = "babel"
+version = "2.17.0"
+source = { registry = "https://pypi.org/simple" }
+dependencies = [
+    { name = "pytz", marker = "python_full_version < '3.9'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/7d/6b/d52e42361e1aa00709585ecc30b3f9684b3ab62530771402248b1b1d6240/babel-2.17.0.tar.gz", hash = "sha256:0c54cffb19f690cdcc52a3b50bcbf71e07a808d1c80d549f2459b9d2cf0afb9d", size = 9951852, upload-time = "2025-02-01T15:17:41.026Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/b7/b8/3fe70c75fe32afc4bb507f75563d39bc5642255d1d94f1f23604725780bf/babel-2.17.0-py3-none-any.whl", hash = "sha256:4d0b53093fdfb4b21c92b5213dba5a1b23885afa8383709427046b21c366e5f2", size = 10182537, upload-time = "2025-02-01T15:17:37.39Z" },
+]
+
+[[package]]
+name = "beautifulsoup4"
+version = "4.14.2"
+source = { registry = "https://pypi.org/simple" }
+dependencies = [
+    { name = "soupsieve", marker = "python_full_version >= '3.9'" },
+    { name = "typing-extensions", version = "4.15.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/77/e9/df2358efd7659577435e2177bfa69cba6c33216681af51a707193dec162a/beautifulsoup4-4.14.2.tar.gz", hash = "sha256:2a98ab9f944a11acee9cc848508ec28d9228abfd522ef0fad6a02a72e0ded69e", size = 625822, upload-time = "2025-09-29T10:05:42.613Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/94/fe/3aed5d0be4d404d12d36ab97e2f1791424d9ca39c2f754a6285d59a3b01d/beautifulsoup4-4.14.2-py3-none-any.whl", hash = "sha256:5ef6fa3a8cbece8488d66985560f97ed091e22bbc4e9c2338508a9d5de6d4515", size = 106392, upload-time = "2025-09-29T10:05:43.771Z" },
+]
+
+[[package]]
+name = "blosc"
+version = "1.11.1"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/40/26/3dc5b6163bb335fb175717b1589e78c865c7601a0513131628024bcaf54b/blosc-1.11.1.tar.gz", hash = "sha256:c22119b27bae1063a697f639028b422d55811b0880c3fc0149cbdea791d0b276", size = 1177460, upload-time = "2022-12-15T22:10:16.396Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/d5/bc/471adb6160823adaef5ba29060c4460ef2ef8b62615a1d6404114f784d30/blosc-1.11.1-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:345577759e5e1cd0905faf89ad1dbcc60bb7a56b759985a417c5b0cab0e0117a", size = 2570677, upload-time = "2022-12-15T22:09:14.514Z" },
+    { url = "https://files.pythonhosted.org/packages/7e/93/656810ae0f88d2e9e5067352e3a5b68713edcf963a86d4fe33c514e5cdea/blosc-1.11.1-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:8907404c3058ac4a767a0a8b279c4c5aaf90431b7238f5b9b464eebe50b91010", size = 1917885, upload-time = "2022-12-15T22:09:16.757Z" },
+    { url = "https://files.pythonhosted.org/packages/e1/e6/525f6d4052aa325586398e526ebf369a8baf43fb6bc1581aaf1f70abc0c8/blosc-1.11.1-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:41578759a913122ba63c24750cb53f861a557a0946f5bb80ad62625e95c7f45a", size = 2377998, upload-time = "2022-12-15T22:09:19.017Z" },
+    { url = "https://files.pythonhosted.org/packages/e0/94/5a108b480913fc088658f44b208d18a0dea1a847763b50ad2ccc7e032424/blosc-1.11.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:bba4cfbc0a86788eb38acc05eb35ba97e2897441416c5f927f243ed7b4b406b6", size = 2532427, upload-time = "2022-12-15T22:09:21.429Z" },
+    { url = "https://files.pythonhosted.org/packages/1e/14/eee8ed3b56b509669c4721f8df0588a07f3550fc6b5fd5321259d405866a/blosc-1.11.1-cp310-cp310-musllinux_1_1_aarch64.whl", hash = "sha256:705df0302ba73293b6109800110994841d5de4491318a3b06c5bbcec32756939", size = 2547598, upload-time = "2022-12-15T22:09:23.472Z" },
+    { url = "https://files.pythonhosted.org/packages/b3/c1/7ca8ede615217b1c407ba433437c5fc015c9ed665d8eac6f6de75d6de6fa/blosc-1.11.1-cp310-cp310-musllinux_1_1_x86_64.whl", hash = "sha256:bef546a039a1d984c6d2ed516ffcbc2a09dbbba61a0951c5197fad3f718095b1", size = 2645571, upload-time = "2022-12-15T22:09:25.32Z" },
+    { url = "https://files.pythonhosted.org/packages/5b/6a/862390290df928d092b2f5285c5827b751609be54ac33ee546eabac1963e/blosc-1.11.1-cp310-cp310-win32.whl", hash = "sha256:5d0ceff7a19f3c5c42d9d5ec13a90ae0b69cb2731e797a58ca0e3b25018cbb69", size = 1409940, upload-time = "2022-12-15T22:09:27.261Z" },
+    { url = "https://files.pythonhosted.org/packages/d7/1c/ff8014057f7f569fd77e998a9b4595aa6408dbef91d362c74d19bf68fbde/blosc-1.11.1-cp310-cp310-win_amd64.whl", hash = "sha256:f889715e28bbdc2f927a546f8debf403947cea1e3dd8f15e1428b66701416ee6", size = 1661360, upload-time = "2022-12-15T22:09:29.153Z" },
+    { url = "https://files.pythonhosted.org/packages/7e/33/fb4707aab932d8aff9ca8a3bc10cc1818e66f54643c90fbd47d5ed2f8c78/blosc-1.11.1-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:88c2eba2c9c013e44d5841660f7832425ebdc0bcfce9e11c59a8eb732f28cf9d", size = 2570680, upload-time = "2022-12-15T22:09:30.754Z" },
+    { url = "https://files.pythonhosted.org/packages/62/a9/41bcfd69d243a94c2a6b7ed867dc89a97daa5db5f0cb55825dfd82d35dd0/blosc-1.11.1-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:8321241c37f25ad4a21e3e0731246753b557dd8910eaee32bf7510eeee03648a", size = 1917893, upload-time = "2022-12-15T22:09:32.96Z" },
+    { url = "https://files.pythonhosted.org/packages/7c/1d/68ab78e56c055e027638227d7c16f27091f47aeb09218c263d79d2d0e459/blosc-1.11.1-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:417fb44fd50887e4b3e2f8fc91f350c791bf0e39a1b4d45a41071fc416fb767a", size = 2378000, upload-time = "2022-12-15T22:09:34.773Z" },
+    { url = "https://files.pythonhosted.org/packages/3f/42/f83814c56b1749466c99a833d1177772cc4c7816dbb3d807268759483905/blosc-1.11.1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:a74c7bc804c608de4dc53c873f8ef5b481b9e3b0b6381e7d3fcff92683de9547", size = 2532431, upload-time = "2022-12-15T22:09:36.625Z" },
+    { url = "https://files.pythonhosted.org/packages/dc/ab/99441bdd4eb5e62fbf640b6c7945df551f8e7903fa52a782902381d5aa50/blosc-1.11.1-cp311-cp311-musllinux_1_1_aarch64.whl", hash = "sha256:94010a4fc094dda5a9abd9546e1f97af9a7dbd903a6eee39dd13244c7c419412", size = 2547602, upload-time = "2022-12-15T22:09:39.048Z" },
+    { url = "https://files.pythonhosted.org/packages/fd/85/e10daf6b1280062727864d20a738862c3a442c4e98fbb8bc266041c0d8b8/blosc-1.11.1-cp311-cp311-musllinux_1_1_x86_64.whl", hash = "sha256:dfbb2bb0a3a69006ad0c627247b53e8ed5f844fc5cd5f09979f1e174f6dc4a6e", size = 2645611, upload-time = "2022-12-15T22:09:41.528Z" },
+    { url = "https://files.pythonhosted.org/packages/a0/35/bb47ad5c6065afcbe2ef84decd80c324d265ffe421a1b004a30754b61a68/blosc-1.11.1-cp311-cp311-win32.whl", hash = "sha256:7b40a99add3120a26bc92e7a751a01e4aa854fc1835e0d12e9cf77dbf5498a2a", size = 1409902, upload-time = "2022-12-15T22:09:43.394Z" },
+    { url = "https://files.pythonhosted.org/packages/08/47/07d90bee5e789d1393a18dac72bcc6dd50ead1bbc933c8ecec45432bea47/blosc-1.11.1-cp311-cp311-win_amd64.whl", hash = "sha256:751a4ad8b4696d1c54f05a5255fe911d72f424cd03a9ce97525d67f40946b2ea", size = 1661350, upload-time = "2022-12-15T22:09:44.875Z" },
+    { url = "https://files.pythonhosted.org/packages/fd/7e/db6ec25d626dd4965279c03c0f908e9a252302b96e7e93b61d09643ddf9d/blosc-1.11.1-cp38-cp38-macosx_10_9_x86_64.whl", hash = "sha256:cf25b0aaf209411ad7ff65f42ee6c42e87d2a9161990743cb21ea264a4509e7b", size = 2570647, upload-time = "2022-12-15T22:09:46.493Z" },
+    { url = "https://files.pythonhosted.org/packages/7e/9a/c22d2b07abf45784c743142b0e4929ed56e702155ac8937eae7ddca3601e/blosc-1.11.1-cp38-cp38-macosx_11_0_arm64.whl", hash = "sha256:2078f8d4500c83387a0e1c3f750c9a6d4848a80e1bf07ec1fd9c87bb1e2e2e92", size = 1917865, upload-time = "2022-12-15T22:09:48.146Z" },
+    { url = "https://files.pythonhosted.org/packages/42/fe/4de62b12627c1f82e4f38b0c63a355df9cd791c887403cf9de1c05af38d4/blosc-1.11.1-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:038ab5690c016a15cc5bf47977ae57b9cb4517f5df3eccd895c2d6c6656da6e6", size = 2377995, upload-time = "2022-12-15T22:09:50.317Z" },
+    { url = "https://files.pythonhosted.org/packages/3e/8e/a736c622da08ab7b205dfcf2a1f7a05e0213a28af38dcec0dcc668ddd7dd/blosc-1.11.1-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:8e2283eb29c5938bfc63ae4091e0b3df5ef0492f83b9ffffa184532d1e5e7f8c", size = 2532427, upload-time = "2022-12-15T22:09:52.154Z" },
+    { url = "https://files.pythonhosted.org/packages/1e/dc/ff4821a7d18708855dc4d08e9135ef3be53a22df84b076bf01a173dc6ab8/blosc-1.11.1-cp38-cp38-musllinux_1_1_aarch64.whl", hash = "sha256:1bfc0a2cd115aa6eac75b841840b00fee0dd7bf77793650bdf470e12cf105627", size = 2547594, upload-time = "2022-12-15T22:09:53.969Z" },
+    { url = "https://files.pythonhosted.org/packages/d3/9a/8617ccbda22a457f64c3449cebdb9878ea6d7e30a88e37dd06be511a6bca/blosc-1.11.1-cp38-cp38-musllinux_1_1_x86_64.whl", hash = "sha256:31ed162c9cc916c393eb9dada1beb632b11d4646afdf708c1c3f9d38402a4fab", size = 2645572, upload-time = "2022-12-15T22:09:56.142Z" },
+    { url = "https://files.pythonhosted.org/packages/a7/07/7f6571a8f8ddcb9a513478a1948cbb58721e12ae1df1a292654dfbcef15c/blosc-1.11.1-cp38-cp38-win32.whl", hash = "sha256:b113c900cfb47272b63f0dbee95016e24720d24d46009aa558e131128fb26aa5", size = 1409886, upload-time = "2022-12-15T22:09:58.264Z" },
+    { url = "https://files.pythonhosted.org/packages/8a/89/794b30b506fd6456b46020304f44d66c91c24b1573df3c74ba2e227e3911/blosc-1.11.1-cp38-cp38-win_amd64.whl", hash = "sha256:da627a51bc2947a698097ac0ccf2f6e51a3aed77f2d4297295365ef8a18d748e", size = 1661393, upload-time = "2022-12-15T22:09:59.783Z" },
+    { url = "https://files.pythonhosted.org/packages/e9/22/9fa7ea69ebad49fdd944bd902cc48a434011e64fa9636fbba192dd543fb7/blosc-1.11.1-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:69cf3d2bc196befe4adddc3cca08315fd9e05208887b9fe031942e204d48ed49", size = 2570647, upload-time = "2022-12-15T22:10:02.241Z" },
+    { url = "https://files.pythonhosted.org/packages/a0/62/42c4c70976f9aea64adb6060bd36706556b0b38adbfe23d437bc3c51deb5/blosc-1.11.1-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:270cf6aa4da391950e0140cc9ee9ced8562e04d4eb1473fa42fc454b81eaeb80", size = 1917867, upload-time = "2022-12-15T22:10:04.693Z" },
+    { url = "https://files.pythonhosted.org/packages/66/fa/5d41e35fdf49c5fc181e82650250c6d433361b4fad1438d9061f50ab0c77/blosc-1.11.1-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:24dfeafbbe0b4b6a028fcfd22c3920be738d6ef9e9d2ffcb2b66153f18ad455d", size = 2378001, upload-time = "2022-12-15T22:10:06.534Z" },
+    { url = "https://files.pythonhosted.org/packages/83/1b/e01c07c66c920508a901937e5dc2c0886a30555fed5bee752811f1882dcb/blosc-1.11.1-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:bf07fccaa1d76fdb03d4eed641a71f2f54be1d1bffba9300bab4c8f437017b46", size = 2532427, upload-time = "2022-12-15T22:10:08.317Z" },
+    { url = "https://files.pythonhosted.org/packages/fb/44/a233a636673c626b2fa9bc40ec3efd25a4f160c5f2d5620f7be05b813cc0/blosc-1.11.1-cp39-cp39-musllinux_1_1_aarch64.whl", hash = "sha256:c793b3e33d025161bd3f8dcacc9bdfa011218eafbc607e195360456d3306ebf9", size = 2547593, upload-time = "2022-12-15T22:10:09.961Z" },
+    { url = "https://files.pythonhosted.org/packages/72/f3/67574171a65dbf60c7896c46bd9451107376ef1b68d0be4613739470ac67/blosc-1.11.1-cp39-cp39-musllinux_1_1_x86_64.whl", hash = "sha256:aa129006fabeec63a1e54d30863e0a0330ec72caedbd5a5c282121796e84e1a0", size = 2645572, upload-time = "2022-12-15T22:10:11.775Z" },
+    { url = "https://files.pythonhosted.org/packages/5f/9e/ee45016b7daf5217dc17c09fcc6a2484c037c99695e6ebe9715a793fcc0c/blosc-1.11.1-cp39-cp39-win32.whl", hash = "sha256:213ce859c89625c64776c8a59c6b235bca6dea81c185a273703366e733880ff5", size = 1409876, upload-time = "2022-12-15T22:10:13.497Z" },
+    { url = "https://files.pythonhosted.org/packages/25/a4/edeb3ed7e9f80f860ed642ea6c5cdb562ced9df69dd14952257a0119de3e/blosc-1.11.1-cp39-cp39-win_amd64.whl", hash = "sha256:9c6371779ca9ec469735b05ee0a119cc431d72008f9f2813ca73d4acf2b39b2f", size = 1661399, upload-time = "2022-12-15T22:10:15.033Z" },
+]
+
+[[package]]
+name = "blosc"
+version = "1.11.3"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/e3/ca/3ec5a5d05e10ad200d887c8cfb9492d9a02e05f9f8f726aa178123b1711b/blosc-1.11.3.tar.gz", hash = "sha256:89ed658eba7814a92e89c44d8c524148d55921595bc133bd1a90f8888a9e088e", size = 1439627, upload-time = "2025-05-17T11:50:03.713Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/f7/3f/23d182b246d1e877f57c21e1136ecc232b6d817015358770424509ad8ec7/blosc-1.11.3-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:6b96333a29cbd7c23811f84afb406eeefde668d1b30b52d8cf97619f1a6e2218", size = 2274740, upload-time = "2025-05-17T11:49:04.869Z" },
+    { url = "https://files.pythonhosted.org/packages/cf/10/d722417e3606c51297490edf3f6b60afb35bba44726925a04be69d18256e/blosc-1.11.3-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:f993509c04335426d140e44d33011604a35aeff48873a86158393cfb4cadba41", size = 1801992, upload-time = "2025-05-17T11:49:06.834Z" },
+    { url = "https://files.pythonhosted.org/packages/3b/50/4e030a8b8f878b047b62e2838528ecf5c120471aa69ec1cc3b78b95d313b/blosc-1.11.3-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:db3593bbe73fd9877feee6b97e12a16973fa16c2e4cb21286b64369724482b5e", size = 2485416, upload-time = "2025-05-17T11:49:08.483Z" },
+    { url = "https://files.pythonhosted.org/packages/c7/e4/20f13078cb0ae69bb59dee170e50fee38c033cede76259066f78572c4444/blosc-1.11.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:ed133aabada36fc04f5b435592a95498277441a0b8d6e106006879ec4d094e05", size = 2619961, upload-time = "2025-05-17T11:49:10.17Z" },
+    { url = "https://files.pythonhosted.org/packages/76/9e/23291ae6ea2ae39815ed6b2a832372a0ac4927975751039ee524a9ea3e6f/blosc-1.11.3-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:1f5aa57e574762fed475daa9172a53053e3eeb1f72979f7dd1739289472c475c", size = 2678244, upload-time = "2025-05-17T11:49:11.857Z" },
+    { url = "https://files.pythonhosted.org/packages/93/be/9db8fadc453ca97ec3b6d0d5274d0dac0b3458e996cc86a99b96eca005ba/blosc-1.11.3-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:0dfed36910623db800ed98c2ef3ba24e2d65aa6972aafd10b9f0db550ec197fc", size = 2752730, upload-time = "2025-05-17T11:49:13.628Z" },
+    { url = "https://files.pythonhosted.org/packages/52/4c/08824d1277441777619d49e3a6b016bd4e82b63a19fad4c51aeb0fcb49fa/blosc-1.11.3-cp310-cp310-win32.whl", hash = "sha256:179e7030cd3088cec9f9235eb54740db8eb6abfca2f3f80d62921dc5fe56d2dd", size = 1530970, upload-time = "2025-05-17T11:49:15.274Z" },
+    { url = "https://files.pythonhosted.org/packages/29/60/ef9fd034a4c9027cc2e19392acd70749e90f615754230588c702994e1a2d/blosc-1.11.3-cp310-cp310-win_amd64.whl", hash = "sha256:b70a2f7ccbbc7b8c37f16816947ae3f15e05e1cb443b37c3bb21c4a472e7de0c", size = 1815667, upload-time = "2025-05-17T11:49:17.912Z" },
+    { url = "https://files.pythonhosted.org/packages/27/bd/887108b6d3f50f1fbfc796470630920197635a27856ea0c097867780b827/blosc-1.11.3-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:8e235534e09d428e3665d9bec8655913e1bd095b55436a11b5bc9a196e07d477", size = 2274751, upload-time = "2025-05-17T11:49:19.579Z" },
+    { url = "https://files.pythonhosted.org/packages/77/c2/a6fbc2d29c95b09f18fa92a2cbb59cfab62c1c21535420faac7e22a9715e/blosc-1.11.3-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:953fa3bd263d0a23838598a91aaf623f3faa20160289ab5c53404d95814283ae", size = 1801974, upload-time = "2025-05-17T11:49:21.301Z" },
+    { url = "https://files.pythonhosted.org/packages/e5/d4/c98f6ada26b31ecdf827c407f1069c44ea7a2626de8afaabdc134dc57147/blosc-1.11.3-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:89b57f7428e40329d2e2caa1c439078cef265b3bd91b64f05fd76ee845ec7b25", size = 2485416, upload-time = "2025-05-17T11:49:22.442Z" },
+    { url = "https://files.pythonhosted.org/packages/38/d5/6be838160326ff13a5e10aca0a82a33dd5eda2298574553247c2963f1c20/blosc-1.11.3-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:7c3e148519bec17e05e5fa390d55d8c4270d18edba430bca7949ae1493fa79d4", size = 2619996, upload-time = "2025-05-17T11:49:24.098Z" },
+    { url = "https://files.pythonhosted.org/packages/78/c0/a5229545f63c48a7ff1dee4182745509785471ab3d000e9984f0573e000f/blosc-1.11.3-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:8014b760e051fbbf6c4c75f342721d908494c4631fdfc738b177849966f38526", size = 2678244, upload-time = "2025-05-17T11:49:25.792Z" },
+    { url = "https://files.pythonhosted.org/packages/39/23/25a2caedac53a5fe60c6a240f98684b95331ab8f3fe0eeb009d5feb34881/blosc-1.11.3-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:e9ded3af5b49d1912dc087a700a20c001e5992bb9a31b1b6eb22d3c4372d3d02", size = 2752740, upload-time = "2025-05-17T11:49:27.595Z" },
+    { url = "https://files.pythonhosted.org/packages/13/41/d0d7d7b8aa1fc1d7526aa8deed79a3dd2bc80d882d41d1659ec711df52e7/blosc-1.11.3-cp311-cp311-win32.whl", hash = "sha256:5c8586f13caf8848c676101259842d77f49fa0ba83e3e4e8fdd6a7f6f7b34b3e", size = 1530967, upload-time = "2025-05-17T11:49:28.814Z" },
+    { url = "https://files.pythonhosted.org/packages/ea/78/901d41c86ba0dccf5f422aa4e484f0be6fb643b73d7b83cdd2474f6b2ef6/blosc-1.11.3-cp311-cp311-win_amd64.whl", hash = "sha256:171a3a6e9ce365b43978de65e93732c4d30dbf478f532cf41cfcc4d4a68e120a", size = 1815692, upload-time = "2025-05-17T11:49:30.15Z" },
+    { url = "https://files.pythonhosted.org/packages/32/ca/b7447cc735c5b5e364a74f33b2af1c3a5ca939f915d03045a021c3279152/blosc-1.11.3-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:075f7b57576e8197c3febbb0317a198b18911a6b882ac114de8c9e90d9058acb", size = 2291581, upload-time = "2025-05-17T11:49:31.313Z" },
+    { url = "https://files.pythonhosted.org/packages/86/e8/1679a35c079f0b42d973cf4411152975710ff190273ddb507ee8a9d1baf0/blosc-1.11.3-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:d5a63601d24bd722b2daa20b86380bc147969466471ea8bf7950ad2f5da19834", size = 1801978, upload-time = "2025-05-17T11:49:32.45Z" },
+    { url = "https://files.pythonhosted.org/packages/2d/ed/b01be8d05f970d48a3837a1e22796e934a72ad657ba1383f8e6d7893ae51/blosc-1.11.3-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:f9ec958830a22a20fea66f4d7f491e0993959974d68d104d3798c88f543dda14", size = 2485404, upload-time = "2025-05-17T11:49:33.724Z" },
+    { url = "https://files.pythonhosted.org/packages/59/08/9c133c628932bbaca9429a1a82759c5f07d8bbb0d856ca25ce9863f808c4/blosc-1.11.3-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:47dbe4ad431a773699a5779a98a982d8241eb412e4ddd1f19a4a869106d7a8d9", size = 2619988, upload-time = "2025-05-17T11:49:35.347Z" },
+    { url = "https://files.pythonhosted.org/packages/64/f2/18353bdfa9cd7af34f2b40c7da0ba919200688f41f4ebe7d4e9720af545d/blosc-1.11.3-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:f41e9202cd2d73238f2620725e84f668338aa45a53549a807d4c09fcf74e901f", size = 2678188, upload-time = "2025-05-17T11:49:36.784Z" },
+    { url = "https://files.pythonhosted.org/packages/87/59/77ea209329c7d1ed692dd7b44a81bc66817588940341372bdb3282a232ce/blosc-1.11.3-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:52edad6b839b9ae2a7f1268fabe1570fd64bc5ba25c3f4f7aba5c5e555dd4a8a", size = 2752726, upload-time = "2025-05-17T11:49:38.59Z" },
+    { url = "https://files.pythonhosted.org/packages/0a/a9/53b1ecb81f0332ab6538e43555644e19ea08184b3ed3d36242847147103c/blosc-1.11.3-cp312-cp312-win_amd64.whl", hash = "sha256:1a5cbcaa68d73e1115fed9ff09c20d35ab34d3b5e9bc6f0a2865156c363c0168", size = 1815691, upload-time = "2025-05-17T11:49:39.767Z" },
+    { url = "https://files.pythonhosted.org/packages/a5/23/6ee0e7270ad6299e73483dfad31b17f8acf66f7768094316a35ee0534f1d/blosc-1.11.3-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:9b474c70b9765587323dd1d7ff8e9fa9e9b35ccb3bee77e7658ce9faf2e05f7f", size = 2291576, upload-time = "2025-05-17T11:49:41.013Z" },
+    { url = "https://files.pythonhosted.org/packages/51/8f/d8097dd6bf952d4bc1a31852f717d5a1157b32c1bea50dac723ed8e6bc8d/blosc-1.11.3-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:291d153864f53960861a48c2a5f6706adc2a84a2bdd9c3d1c5353d9c32748a03", size = 1801973, upload-time = "2025-05-17T11:49:42.259Z" },
+    { url = "https://files.pythonhosted.org/packages/1e/cb/7fdf0756e6a38d6a28c5063bc8ba8a8c8b1a1ab6980d777c52ca7dd942b1/blosc-1.11.3-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:ece67bb34741a147e4120cff3ee3784121709a112d16795716b8f4239aaddfa4", size = 2485043, upload-time = "2025-05-17T11:49:44.034Z" },
+    { url = "https://files.pythonhosted.org/packages/7c/b8/d21a1305356312ca0fc6bd54ad6fb91e7434f0efef545972eb72f040c815/blosc-1.11.3-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:e70216dbddb85b69a8d0f62a4a5c09b7a1fce9ca2f329793e799f8b6f9fa3ab0", size = 2619988, upload-time = "2025-05-17T11:49:45.346Z" },
+    { url = "https://files.pythonhosted.org/packages/a0/79/9ed273c9493e02f0bc5deacd3854ecabd6c6ba5371ed04b6c7702fd16f77/blosc-1.11.3-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:220865ffcac638f8f0f4b51259d4e4f3236165e5b43fffd1e836cd7cd29b9367", size = 2678176, upload-time = "2025-05-17T11:49:47.12Z" },
+    { url = "https://files.pythonhosted.org/packages/79/0e/c50458a1e038c0f0da70c3223d2a34ad702b86a79d0921f23a8ffaae035f/blosc-1.11.3-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:d57dde8c335378e8443757b69d0b29e90dfc53047d01311e952aecc815167dec", size = 2752740, upload-time = "2025-05-17T11:49:48.909Z" },
+    { url = "https://files.pythonhosted.org/packages/f1/0e/3a5ed949e0e23eb576c08017bb39e8612607cf8f591d8149b0fb82469a03/blosc-1.11.3-cp313-cp313-win32.whl", hash = "sha256:d3d72046580a50177811916c78130d6ae7307420733de6e950cb567c896b1ca5", size = 1530991, upload-time = "2025-05-17T11:49:50.121Z" },
+    { url = "https://files.pythonhosted.org/packages/06/d4/0c3cdaf34b3ef705fdab465ad8df4a3bce5bbdf2bca8f2515eae90ae28a0/blosc-1.11.3-cp313-cp313-win_amd64.whl", hash = "sha256:73721c1949f2b8d2f4168cababbfe6280511f0da9a971ba7ec9c56eab9603824", size = 1815688, upload-time = "2025-05-17T11:49:51.434Z" },
+    { url = "https://files.pythonhosted.org/packages/1d/7d/8f5c2db6851ceb0d7e1d908c9564ad3c8bf1509f663a4c7091e4e2608312/blosc-1.11.3-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:d894ed85184ca02b29d291a7c944a10b587fa1962f8e9341dc99253e01fe343e", size = 2274737, upload-time = "2025-05-17T11:49:52.627Z" },
+    { url = "https://files.pythonhosted.org/packages/35/ed/ef55fec7b6db0a69d61d141e5f7603b17e9e435d6822eefbe89b689201b9/blosc-1.11.3-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:6a8dc50e2532be15d77f0b4a66c54fa778f997ada1cfad38b6b7b93806b54b7e", size = 1801985, upload-time = "2025-05-17T11:49:53.856Z" },
+    { url = "https://files.pythonhosted.org/packages/f2/f5/2abe49ef66b08452f7d68fed108b9160ec57c4cc01cb6835bfddaf37db31/blosc-1.11.3-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:d02137c38493013e7f7eee27fa9f7637d7efa72d03b2c985a1a9fb59887db7a0", size = 2485422, upload-time = "2025-05-17T11:49:55.008Z" },
+    { url = "https://files.pythonhosted.org/packages/da/48/f0396b994d898fe1270c80487b89983f8c8e1620ad4ee7c844968afbb2ff/blosc-1.11.3-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:a2eea36ebcd89e4f263224f51ac2135e5e669f2ba33dc0757e88c34ae1cd4950", size = 2619971, upload-time = "2025-05-17T11:49:56.251Z" },
+    { url = "https://files.pythonhosted.org/packages/cc/f7/3ae3acb4cd49a4cecf63d7603c930e2a7667a950cd3e4be2cb8f85b37874/blosc-1.11.3-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:72dbe1dcadf7703019465937713cb7144491d834564a17af0a971a7916274922", size = 2678239, upload-time = "2025-05-17T11:49:57.489Z" },
+    { url = "https://files.pythonhosted.org/packages/d2/a6/ecdd0c6648e335adb49e01d4145d74a2f2eb77bd47cff7dc0043f6a13afa/blosc-1.11.3-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:9a1b22b0ea2c5d9e9cacf7d1105dd2238058955570ca5d172fb9b77a746256dc", size = 2752723, upload-time = "2025-05-17T11:49:59.106Z" },
+    { url = "https://files.pythonhosted.org/packages/08/e2/309c30ff004caac6a744ebb165c95757532cc5bfb0e675853b489a03362d/blosc-1.11.3-cp39-cp39-win32.whl", hash = "sha256:cbaa7c3be6ce86c7e5845530976f80536d0334a62d85e03509c21afefe22abec", size = 1531006, upload-time = "2025-05-17T11:50:00.854Z" },
+    { url = "https://files.pythonhosted.org/packages/74/c3/88df94aba52d8d1e2960b9d137ceb4e48d0393bdf57a426557f4ad0c363e/blosc-1.11.3-cp39-cp39-win_amd64.whl", hash = "sha256:1edf02436f7fb3220ff377e11c6973af33f4ce85f213d42e876662daaa9c5320", size = 1815672, upload-time = "2025-05-17T11:50:02.046Z" },
+]
+
+[[package]]
+name = "certifi"
+version = "2025.8.3"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/dc/67/960ebe6bf230a96cda2e0abcf73af550ec4f090005363542f0765df162e0/certifi-2025.8.3.tar.gz", hash = "sha256:e564105f78ded564e3ae7c923924435e1daa7463faeab5bb932bc53ffae63407", size = 162386, upload-time = "2025-08-03T03:07:47.08Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/e5/48/1549795ba7742c948d2ad169c1c8cdbae65bc450d6cd753d124b17c8cd32/certifi-2025.8.3-py3-none-any.whl", hash = "sha256:f6c12493cfb1b06ba2ff328595af9350c65d6644968e5d3a2ffd78699af217a5", size = 161216, upload-time = "2025-08-03T03:07:45.777Z" },
+]
+
+[[package]]
+name = "cfgv"
+version = "3.4.0"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/11/74/539e56497d9bd1d484fd863dd69cbbfa653cd2aa27abfe35653494d85e94/cfgv-3.4.0.tar.gz", hash = "sha256:e52591d4c5f5dead8e0f673fb16db7949d2cfb3f7da4582893288f0ded8fe560", size = 7114, upload-time = "2023-08-12T20:38:17.776Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/c5/55/51844dd50c4fc7a33b653bfaba4c2456f06955289ca770a5dbd5fd267374/cfgv-3.4.0-py2.py3-none-any.whl", hash = "sha256:b7265b1f29fd3316bfcd2b330d63d024f2bfd8bcb8b0272f8e19a504856c48f9", size = 7249, upload-time = "2023-08-12T20:38:16.269Z" },
+]
+
+[[package]]
+name = "charset-normalizer"
+version = "3.4.3"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/83/2d/5fd176ceb9b2fc619e63405525573493ca23441330fcdaee6bef9460e924/charset_normalizer-3.4.3.tar.gz", hash = "sha256:6fce4b8500244f6fcb71465d4a4930d132ba9ab8e71a7859e6a5d59851068d14", size = 122371, upload-time = "2025-08-09T07:57:28.46Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/d6/98/f3b8013223728a99b908c9344da3aa04ee6e3fa235f19409033eda92fb78/charset_normalizer-3.4.3-cp310-cp310-macosx_10_9_universal2.whl", hash = "sha256:fb7f67a1bfa6e40b438170ebdc8158b78dc465a5a67b6dde178a46987b244a72", size = 207695, upload-time = "2025-08-09T07:55:36.452Z" },
+    { url = "https://files.pythonhosted.org/packages/21/40/5188be1e3118c82dcb7c2a5ba101b783822cfb413a0268ed3be0468532de/charset_normalizer-3.4.3-cp310-cp310-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:cc9370a2da1ac13f0153780040f465839e6cccb4a1e44810124b4e22483c93fe", size = 147153, upload-time = "2025-08-09T07:55:38.467Z" },
+    { url = "https://files.pythonhosted.org/packages/37/60/5d0d74bc1e1380f0b72c327948d9c2aca14b46a9efd87604e724260f384c/charset_normalizer-3.4.3-cp310-cp310-manylinux2014_ppc64le.manylinux_2_17_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:07a0eae9e2787b586e129fdcbe1af6997f8d0e5abaa0bc98c0e20e124d67e601", size = 160428, upload-time = "2025-08-09T07:55:40.072Z" },
+    { url = "https://files.pythonhosted.org/packages/85/9a/d891f63722d9158688de58d050c59dc3da560ea7f04f4c53e769de5140f5/charset_normalizer-3.4.3-cp310-cp310-manylinux2014_s390x.manylinux_2_17_s390x.manylinux_2_28_s390x.whl", hash = "sha256:74d77e25adda8581ffc1c720f1c81ca082921329452eba58b16233ab1842141c", size = 157627, upload-time = "2025-08-09T07:55:41.706Z" },
+    { url = "https://files.pythonhosted.org/packages/65/1a/7425c952944a6521a9cfa7e675343f83fd82085b8af2b1373a2409c683dc/charset_normalizer-3.4.3-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:d0e909868420b7049dafd3a31d45125b31143eec59235311fc4c57ea26a4acd2", size = 152388, upload-time = "2025-08-09T07:55:43.262Z" },
+    { url = "https://files.pythonhosted.org/packages/f0/c9/a2c9c2a355a8594ce2446085e2ec97fd44d323c684ff32042e2a6b718e1d/charset_normalizer-3.4.3-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:c6f162aabe9a91a309510d74eeb6507fab5fff92337a15acbe77753d88d9dcf0", size = 150077, upload-time = "2025-08-09T07:55:44.903Z" },
+    { url = "https://files.pythonhosted.org/packages/3b/38/20a1f44e4851aa1c9105d6e7110c9d020e093dfa5836d712a5f074a12bf7/charset_normalizer-3.4.3-cp310-cp310-musllinux_1_2_ppc64le.whl", hash = "sha256:4ca4c094de7771a98d7fbd67d9e5dbf1eb73efa4f744a730437d8a3a5cf994f0", size = 161631, upload-time = "2025-08-09T07:55:46.346Z" },
+    { url = "https://files.pythonhosted.org/packages/a4/fa/384d2c0f57edad03d7bec3ebefb462090d8905b4ff5a2d2525f3bb711fac/charset_normalizer-3.4.3-cp310-cp310-musllinux_1_2_s390x.whl", hash = "sha256:02425242e96bcf29a49711b0ca9f37e451da7c70562bc10e8ed992a5a7a25cc0", size = 159210, upload-time = "2025-08-09T07:55:47.539Z" },
+    { url = "https://files.pythonhosted.org/packages/33/9e/eca49d35867ca2db336b6ca27617deed4653b97ebf45dfc21311ce473c37/charset_normalizer-3.4.3-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:78deba4d8f9590fe4dae384aeff04082510a709957e968753ff3c48399f6f92a", size = 153739, upload-time = "2025-08-09T07:55:48.744Z" },
+    { url = "https://files.pythonhosted.org/packages/2a/91/26c3036e62dfe8de8061182d33be5025e2424002125c9500faff74a6735e/charset_normalizer-3.4.3-cp310-cp310-win32.whl", hash = "sha256:d79c198e27580c8e958906f803e63cddb77653731be08851c7df0b1a14a8fc0f", size = 99825, upload-time = "2025-08-09T07:55:50.305Z" },
+    { url = "https://files.pythonhosted.org/packages/e2/c6/f05db471f81af1fa01839d44ae2a8bfeec8d2a8b4590f16c4e7393afd323/charset_normalizer-3.4.3-cp310-cp310-win_amd64.whl", hash = "sha256:c6e490913a46fa054e03699c70019ab869e990270597018cef1d8562132c2669", size = 107452, upload-time = "2025-08-09T07:55:51.461Z" },
+    { url = "https://files.pythonhosted.org/packages/7f/b5/991245018615474a60965a7c9cd2b4efbaabd16d582a5547c47ee1c7730b/charset_normalizer-3.4.3-cp311-cp311-macosx_10_9_universal2.whl", hash = "sha256:b256ee2e749283ef3ddcff51a675ff43798d92d746d1a6e4631bf8c707d22d0b", size = 204483, upload-time = "2025-08-09T07:55:53.12Z" },
+    { url = "https://files.pythonhosted.org/packages/c7/2a/ae245c41c06299ec18262825c1569c5d3298fc920e4ddf56ab011b417efd/charset_normalizer-3.4.3-cp311-cp311-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:13faeacfe61784e2559e690fc53fa4c5ae97c6fcedb8eb6fb8d0a15b475d2c64", size = 145520, upload-time = "2025-08-09T07:55:54.712Z" },
+    { url = "https://files.pythonhosted.org/packages/3a/a4/b3b6c76e7a635748c4421d2b92c7b8f90a432f98bda5082049af37ffc8e3/charset_normalizer-3.4.3-cp311-cp311-manylinux2014_ppc64le.manylinux_2_17_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:00237675befef519d9af72169d8604a067d92755e84fe76492fef5441db05b91", size = 158876, upload-time = "2025-08-09T07:55:56.024Z" },
+    { url = "https://files.pythonhosted.org/packages/e2/e6/63bb0e10f90a8243c5def74b5b105b3bbbfb3e7bb753915fe333fb0c11ea/charset_normalizer-3.4.3-cp311-cp311-manylinux2014_s390x.manylinux_2_17_s390x.manylinux_2_28_s390x.whl", hash = "sha256:585f3b2a80fbd26b048a0be90c5aae8f06605d3c92615911c3a2b03a8a3b796f", size = 156083, upload-time = "2025-08-09T07:55:57.582Z" },
+    { url = "https://files.pythonhosted.org/packages/87/df/b7737ff046c974b183ea9aa111b74185ac8c3a326c6262d413bd5a1b8c69/charset_normalizer-3.4.3-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:0e78314bdc32fa80696f72fa16dc61168fda4d6a0c014e0380f9d02f0e5d8a07", size = 150295, upload-time = "2025-08-09T07:55:59.147Z" },
+    { url = "https://files.pythonhosted.org/packages/61/f1/190d9977e0084d3f1dc169acd060d479bbbc71b90bf3e7bf7b9927dec3eb/charset_normalizer-3.4.3-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:96b2b3d1a83ad55310de8c7b4a2d04d9277d5591f40761274856635acc5fcb30", size = 148379, upload-time = "2025-08-09T07:56:00.364Z" },
+    { url = "https://files.pythonhosted.org/packages/4c/92/27dbe365d34c68cfe0ca76f1edd70e8705d82b378cb54ebbaeabc2e3029d/charset_normalizer-3.4.3-cp311-cp311-musllinux_1_2_ppc64le.whl", hash = "sha256:939578d9d8fd4299220161fdd76e86c6a251987476f5243e8864a7844476ba14", size = 160018, upload-time = "2025-08-09T07:56:01.678Z" },
+    { url = "https://files.pythonhosted.org/packages/99/04/baae2a1ea1893a01635d475b9261c889a18fd48393634b6270827869fa34/charset_normalizer-3.4.3-cp311-cp311-musllinux_1_2_s390x.whl", hash = "sha256:fd10de089bcdcd1be95a2f73dbe6254798ec1bda9f450d5828c96f93e2536b9c", size = 157430, upload-time = "2025-08-09T07:56:02.87Z" },
+    { url = "https://files.pythonhosted.org/packages/2f/36/77da9c6a328c54d17b960c89eccacfab8271fdaaa228305330915b88afa9/charset_normalizer-3.4.3-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:1e8ac75d72fa3775e0b7cb7e4629cec13b7514d928d15ef8ea06bca03ef01cae", size = 151600, upload-time = "2025-08-09T07:56:04.089Z" },
+    { url = "https://files.pythonhosted.org/packages/64/d4/9eb4ff2c167edbbf08cdd28e19078bf195762e9bd63371689cab5ecd3d0d/charset_normalizer-3.4.3-cp311-cp311-win32.whl", hash = "sha256:6cf8fd4c04756b6b60146d98cd8a77d0cdae0e1ca20329da2ac85eed779b6849", size = 99616, upload-time = "2025-08-09T07:56:05.658Z" },
+    { url = "https://files.pythonhosted.org/packages/f4/9c/996a4a028222e7761a96634d1820de8a744ff4327a00ada9c8942033089b/charset_normalizer-3.4.3-cp311-cp311-win_amd64.whl", hash = "sha256:31a9a6f775f9bcd865d88ee350f0ffb0e25936a7f930ca98995c05abf1faf21c", size = 107108, upload-time = "2025-08-09T07:56:07.176Z" },
+    { url = "https://files.pythonhosted.org/packages/e9/5e/14c94999e418d9b87682734589404a25854d5f5d0408df68bc15b6ff54bb/charset_normalizer-3.4.3-cp312-cp312-macosx_10_13_universal2.whl", hash = "sha256:e28e334d3ff134e88989d90ba04b47d84382a828c061d0d1027b1b12a62b39b1", size = 205655, upload-time = "2025-08-09T07:56:08.475Z" },
+    { url = "https://files.pythonhosted.org/packages/7d/a8/c6ec5d389672521f644505a257f50544c074cf5fc292d5390331cd6fc9c3/charset_normalizer-3.4.3-cp312-cp312-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:0cacf8f7297b0c4fcb74227692ca46b4a5852f8f4f24b3c766dd94a1075c4884", size = 146223, upload-time = "2025-08-09T07:56:09.708Z" },
+    { url = "https://files.pythonhosted.org/packages/fc/eb/a2ffb08547f4e1e5415fb69eb7db25932c52a52bed371429648db4d84fb1/charset_normalizer-3.4.3-cp312-cp312-manylinux2014_ppc64le.manylinux_2_17_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:c6fd51128a41297f5409deab284fecbe5305ebd7e5a1f959bee1c054622b7018", size = 159366, upload-time = "2025-08-09T07:56:11.326Z" },
+    { url = "https://files.pythonhosted.org/packages/82/10/0fd19f20c624b278dddaf83b8464dcddc2456cb4b02bb902a6da126b87a1/charset_normalizer-3.4.3-cp312-cp312-manylinux2014_s390x.manylinux_2_17_s390x.manylinux_2_28_s390x.whl", hash = "sha256:3cfb2aad70f2c6debfbcb717f23b7eb55febc0bb23dcffc0f076009da10c6392", size = 157104, upload-time = "2025-08-09T07:56:13.014Z" },
+    { url = "https://files.pythonhosted.org/packages/16/ab/0233c3231af734f5dfcf0844aa9582d5a1466c985bbed6cedab85af9bfe3/charset_normalizer-3.4.3-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:1606f4a55c0fd363d754049cdf400175ee96c992b1f8018b993941f221221c5f", size = 151830, upload-time = "2025-08-09T07:56:14.428Z" },
+    { url = "https://files.pythonhosted.org/packages/ae/02/e29e22b4e02839a0e4a06557b1999d0a47db3567e82989b5bb21f3fbbd9f/charset_normalizer-3.4.3-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:027b776c26d38b7f15b26a5da1044f376455fb3766df8fc38563b4efbc515154", size = 148854, upload-time = "2025-08-09T07:56:16.051Z" },
+    { url = "https://files.pythonhosted.org/packages/05/6b/e2539a0a4be302b481e8cafb5af8792da8093b486885a1ae4d15d452bcec/charset_normalizer-3.4.3-cp312-cp312-musllinux_1_2_ppc64le.whl", hash = "sha256:42e5088973e56e31e4fa58eb6bd709e42fc03799c11c42929592889a2e54c491", size = 160670, upload-time = "2025-08-09T07:56:17.314Z" },
+    { url = "https://files.pythonhosted.org/packages/31/e7/883ee5676a2ef217a40ce0bffcc3d0dfbf9e64cbcfbdf822c52981c3304b/charset_normalizer-3.4.3-cp312-cp312-musllinux_1_2_s390x.whl", hash = "sha256:cc34f233c9e71701040d772aa7490318673aa7164a0efe3172b2981218c26d93", size = 158501, upload-time = "2025-08-09T07:56:18.641Z" },
+    { url = "https://files.pythonhosted.org/packages/c1/35/6525b21aa0db614cf8b5792d232021dca3df7f90a1944db934efa5d20bb1/charset_normalizer-3.4.3-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:320e8e66157cc4e247d9ddca8e21f427efc7a04bbd0ac8a9faf56583fa543f9f", size = 153173, upload-time = "2025-08-09T07:56:20.289Z" },
+    { url = "https://files.pythonhosted.org/packages/50/ee/f4704bad8201de513fdc8aac1cabc87e38c5818c93857140e06e772b5892/charset_normalizer-3.4.3-cp312-cp312-win32.whl", hash = "sha256:fb6fecfd65564f208cbf0fba07f107fb661bcd1a7c389edbced3f7a493f70e37", size = 99822, upload-time = "2025-08-09T07:56:21.551Z" },
+    { url = "https://files.pythonhosted.org/packages/39/f5/3b3836ca6064d0992c58c7561c6b6eee1b3892e9665d650c803bd5614522/charset_normalizer-3.4.3-cp312-cp312-win_amd64.whl", hash = "sha256:86df271bf921c2ee3818f0522e9a5b8092ca2ad8b065ece5d7d9d0e9f4849bcc", size = 107543, upload-time = "2025-08-09T07:56:23.115Z" },
+    { url = "https://files.pythonhosted.org/packages/65/ca/2135ac97709b400c7654b4b764daf5c5567c2da45a30cdd20f9eefe2d658/charset_normalizer-3.4.3-cp313-cp313-macosx_10_13_universal2.whl", hash = "sha256:14c2a87c65b351109f6abfc424cab3927b3bdece6f706e4d12faaf3d52ee5efe", size = 205326, upload-time = "2025-08-09T07:56:24.721Z" },
+    { url = "https://files.pythonhosted.org/packages/71/11/98a04c3c97dd34e49c7d247083af03645ca3730809a5509443f3c37f7c99/charset_normalizer-3.4.3-cp313-cp313-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:41d1fc408ff5fdfb910200ec0e74abc40387bccb3252f3f27c0676731df2b2c8", size = 146008, upload-time = "2025-08-09T07:56:26.004Z" },
+    { url = "https://files.pythonhosted.org/packages/60/f5/4659a4cb3c4ec146bec80c32d8bb16033752574c20b1252ee842a95d1a1e/charset_normalizer-3.4.3-cp313-cp313-manylinux2014_ppc64le.manylinux_2_17_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:1bb60174149316da1c35fa5233681f7c0f9f514509b8e399ab70fea5f17e45c9", size = 159196, upload-time = "2025-08-09T07:56:27.25Z" },
+    { url = "https://files.pythonhosted.org/packages/86/9e/f552f7a00611f168b9a5865a1414179b2c6de8235a4fa40189f6f79a1753/charset_normalizer-3.4.3-cp313-cp313-manylinux2014_s390x.manylinux_2_17_s390x.manylinux_2_28_s390x.whl", hash = "sha256:30d006f98569de3459c2fc1f2acde170b7b2bd265dc1943e87e1a4efe1b67c31", size = 156819, upload-time = "2025-08-09T07:56:28.515Z" },
+    { url = "https://files.pythonhosted.org/packages/7e/95/42aa2156235cbc8fa61208aded06ef46111c4d3f0de233107b3f38631803/charset_normalizer-3.4.3-cp313-cp313-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:416175faf02e4b0810f1f38bcb54682878a4af94059a1cd63b8747244420801f", size = 151350, upload-time = "2025-08-09T07:56:29.716Z" },
+    { url = "https://files.pythonhosted.org/packages/c2/a9/3865b02c56f300a6f94fc631ef54f0a8a29da74fb45a773dfd3dcd380af7/charset_normalizer-3.4.3-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:6aab0f181c486f973bc7262a97f5aca3ee7e1437011ef0c2ec04b5a11d16c927", size = 148644, upload-time = "2025-08-09T07:56:30.984Z" },
+    { url = "https://files.pythonhosted.org/packages/77/d9/cbcf1a2a5c7d7856f11e7ac2d782aec12bdfea60d104e60e0aa1c97849dc/charset_normalizer-3.4.3-cp313-cp313-musllinux_1_2_ppc64le.whl", hash = "sha256:fdabf8315679312cfa71302f9bd509ded4f2f263fb5b765cf1433b39106c3cc9", size = 160468, upload-time = "2025-08-09T07:56:32.252Z" },
+    { url = "https://files.pythonhosted.org/packages/f6/42/6f45efee8697b89fda4d50580f292b8f7f9306cb2971d4b53f8914e4d890/charset_normalizer-3.4.3-cp313-cp313-musllinux_1_2_s390x.whl", hash = "sha256:bd28b817ea8c70215401f657edef3a8aa83c29d447fb0b622c35403780ba11d5", size = 158187, upload-time = "2025-08-09T07:56:33.481Z" },
+    { url = "https://files.pythonhosted.org/packages/70/99/f1c3bdcfaa9c45b3ce96f70b14f070411366fa19549c1d4832c935d8e2c3/charset_normalizer-3.4.3-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:18343b2d246dc6761a249ba1fb13f9ee9a2bcd95decc767319506056ea4ad4dc", size = 152699, upload-time = "2025-08-09T07:56:34.739Z" },
+    { url = "https://files.pythonhosted.org/packages/a3/ad/b0081f2f99a4b194bcbb1934ef3b12aa4d9702ced80a37026b7607c72e58/charset_normalizer-3.4.3-cp313-cp313-win32.whl", hash = "sha256:6fb70de56f1859a3f71261cbe41005f56a7842cc348d3aeb26237560bfa5e0ce", size = 99580, upload-time = "2025-08-09T07:56:35.981Z" },
+    { url = "https://files.pythonhosted.org/packages/9a/8f/ae790790c7b64f925e5c953b924aaa42a243fb778fed9e41f147b2a5715a/charset_normalizer-3.4.3-cp313-cp313-win_amd64.whl", hash = "sha256:cf1ebb7d78e1ad8ec2a8c4732c7be2e736f6e5123a4146c5b89c9d1f585f8cef", size = 107366, upload-time = "2025-08-09T07:56:37.339Z" },
+    { url = "https://files.pythonhosted.org/packages/8e/91/b5a06ad970ddc7a0e513112d40113e834638f4ca1120eb727a249fb2715e/charset_normalizer-3.4.3-cp314-cp314-macosx_10_13_universal2.whl", hash = "sha256:3cd35b7e8aedeb9e34c41385fda4f73ba609e561faedfae0a9e75e44ac558a15", size = 204342, upload-time = "2025-08-09T07:56:38.687Z" },
+    { url = "https://files.pythonhosted.org/packages/ce/ec/1edc30a377f0a02689342f214455c3f6c2fbedd896a1d2f856c002fc3062/charset_normalizer-3.4.3-cp314-cp314-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:b89bc04de1d83006373429975f8ef9e7932534b8cc9ca582e4db7d20d91816db", size = 145995, upload-time = "2025-08-09T07:56:40.048Z" },
+    { url = "https://files.pythonhosted.org/packages/17/e5/5e67ab85e6d22b04641acb5399c8684f4d37caf7558a53859f0283a650e9/charset_normalizer-3.4.3-cp314-cp314-manylinux2014_ppc64le.manylinux_2_17_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:2001a39612b241dae17b4687898843f254f8748b796a2e16f1051a17078d991d", size = 158640, upload-time = "2025-08-09T07:56:41.311Z" },
+    { url = "https://files.pythonhosted.org/packages/f1/e5/38421987f6c697ee3722981289d554957c4be652f963d71c5e46a262e135/charset_normalizer-3.4.3-cp314-cp314-manylinux2014_s390x.manylinux_2_17_s390x.manylinux_2_28_s390x.whl", hash = "sha256:8dcfc373f888e4fb39a7bc57e93e3b845e7f462dacc008d9749568b1c4ece096", size = 156636, upload-time = "2025-08-09T07:56:43.195Z" },
+    { url = "https://files.pythonhosted.org/packages/a0/e4/5a075de8daa3ec0745a9a3b54467e0c2967daaaf2cec04c845f73493e9a1/charset_normalizer-3.4.3-cp314-cp314-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:18b97b8404387b96cdbd30ad660f6407799126d26a39ca65729162fd810a99aa", size = 150939, upload-time = "2025-08-09T07:56:44.819Z" },
+    { url = "https://files.pythonhosted.org/packages/02/f7/3611b32318b30974131db62b4043f335861d4d9b49adc6d57c1149cc49d4/charset_normalizer-3.4.3-cp314-cp314-musllinux_1_2_aarch64.whl", hash = "sha256:ccf600859c183d70eb47e05a44cd80a4ce77394d1ac0f79dbd2dd90a69a3a049", size = 148580, upload-time = "2025-08-09T07:56:46.684Z" },
+    { url = "https://files.pythonhosted.org/packages/7e/61/19b36f4bd67f2793ab6a99b979b4e4f3d8fc754cbdffb805335df4337126/charset_normalizer-3.4.3-cp314-cp314-musllinux_1_2_ppc64le.whl", hash = "sha256:53cd68b185d98dde4ad8990e56a58dea83a4162161b1ea9272e5c9182ce415e0", size = 159870, upload-time = "2025-08-09T07:56:47.941Z" },
+    { url = "https://files.pythonhosted.org/packages/06/57/84722eefdd338c04cf3030ada66889298eaedf3e7a30a624201e0cbe424a/charset_normalizer-3.4.3-cp314-cp314-musllinux_1_2_s390x.whl", hash = "sha256:30a96e1e1f865f78b030d65241c1ee850cdf422d869e9028e2fc1d5e4db73b92", size = 157797, upload-time = "2025-08-09T07:56:49.756Z" },
+    { url = "https://files.pythonhosted.org/packages/72/2a/aff5dd112b2f14bcc3462c312dce5445806bfc8ab3a7328555da95330e4b/charset_normalizer-3.4.3-cp314-cp314-musllinux_1_2_x86_64.whl", hash = "sha256:d716a916938e03231e86e43782ca7878fb602a125a91e7acb8b5112e2e96ac16", size = 152224, upload-time = "2025-08-09T07:56:51.369Z" },
+    { url = "https://files.pythonhosted.org/packages/b7/8c/9839225320046ed279c6e839d51f028342eb77c91c89b8ef2549f951f3ec/charset_normalizer-3.4.3-cp314-cp314-win32.whl", hash = "sha256:c6dbd0ccdda3a2ba7c2ecd9d77b37f3b5831687d8dc1b6ca5f56a4880cc7b7ce", size = 100086, upload-time = "2025-08-09T07:56:52.722Z" },
+    { url = "https://files.pythonhosted.org/packages/ee/7a/36fbcf646e41f710ce0a563c1c9a343c6edf9be80786edeb15b6f62e17db/charset_normalizer-3.4.3-cp314-cp314-win_amd64.whl", hash = "sha256:73dc19b562516fc9bcf6e5d6e596df0b4eb98d87e4f79f3ae71840e6ed21361c", size = 107400, upload-time = "2025-08-09T07:56:55.172Z" },
+    { url = "https://files.pythonhosted.org/packages/22/82/63a45bfc36f73efe46731a3a71cb84e2112f7e0b049507025ce477f0f052/charset_normalizer-3.4.3-cp38-cp38-macosx_10_9_universal2.whl", hash = "sha256:0f2be7e0cf7754b9a30eb01f4295cc3d4358a479843b31f328afd210e2c7598c", size = 198805, upload-time = "2025-08-09T07:56:56.496Z" },
+    { url = "https://files.pythonhosted.org/packages/0c/52/8b0c6c3e53f7e546a5e49b9edb876f379725914e1130297f3b423c7b71c5/charset_normalizer-3.4.3-cp38-cp38-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:c60e092517a73c632ec38e290eba714e9627abe9d301c8c8a12ec32c314a2a4b", size = 142862, upload-time = "2025-08-09T07:56:57.751Z" },
+    { url = "https://files.pythonhosted.org/packages/59/c0/a74f3bd167d311365e7973990243f32c35e7a94e45103125275b9e6c479f/charset_normalizer-3.4.3-cp38-cp38-manylinux2014_ppc64le.manylinux_2_17_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:252098c8c7a873e17dd696ed98bbe91dbacd571da4b87df3736768efa7a792e4", size = 155104, upload-time = "2025-08-09T07:56:58.984Z" },
+    { url = "https://files.pythonhosted.org/packages/1a/79/ae516e678d6e32df2e7e740a7be51dc80b700e2697cb70054a0f1ac2c955/charset_normalizer-3.4.3-cp38-cp38-manylinux2014_s390x.manylinux_2_17_s390x.manylinux_2_28_s390x.whl", hash = "sha256:3653fad4fe3ed447a596ae8638b437f827234f01a8cd801842e43f3d0a6b281b", size = 152598, upload-time = "2025-08-09T07:57:00.201Z" },
+    { url = "https://files.pythonhosted.org/packages/00/bd/ef9c88464b126fa176f4ef4a317ad9b6f4d30b2cffbc43386062367c3e2c/charset_normalizer-3.4.3-cp38-cp38-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:8999f965f922ae054125286faf9f11bc6932184b93011d138925a1773830bbe9", size = 147391, upload-time = "2025-08-09T07:57:01.441Z" },
+    { url = "https://files.pythonhosted.org/packages/7a/03/cbb6fac9d3e57f7e07ce062712ee80d80a5ab46614684078461917426279/charset_normalizer-3.4.3-cp38-cp38-musllinux_1_2_aarch64.whl", hash = "sha256:d95bfb53c211b57198bb91c46dd5a2d8018b3af446583aab40074bf7988401cb", size = 145037, upload-time = "2025-08-09T07:57:02.638Z" },
+    { url = "https://files.pythonhosted.org/packages/64/d1/f9d141c893ef5d4243bc75c130e95af8fd4bc355beff06e9b1e941daad6e/charset_normalizer-3.4.3-cp38-cp38-musllinux_1_2_ppc64le.whl", hash = "sha256:5b413b0b1bfd94dbf4023ad6945889f374cd24e3f62de58d6bb102c4d9ae534a", size = 156425, upload-time = "2025-08-09T07:57:03.898Z" },
+    { url = "https://files.pythonhosted.org/packages/c5/35/9c99739250742375167bc1b1319cd1cec2bf67438a70d84b2e1ec4c9daa3/charset_normalizer-3.4.3-cp38-cp38-musllinux_1_2_s390x.whl", hash = "sha256:b5e3b2d152e74e100a9e9573837aba24aab611d39428ded46f4e4022ea7d1942", size = 153734, upload-time = "2025-08-09T07:57:05.549Z" },
+    { url = "https://files.pythonhosted.org/packages/50/10/c117806094d2c956ba88958dab680574019abc0c02bcf57b32287afca544/charset_normalizer-3.4.3-cp38-cp38-musllinux_1_2_x86_64.whl", hash = "sha256:a2d08ac246bb48479170408d6c19f6385fa743e7157d716e144cad849b2dd94b", size = 148551, upload-time = "2025-08-09T07:57:06.823Z" },
+    { url = "https://files.pythonhosted.org/packages/61/c5/dc3ba772489c453621ffc27e8978a98fe7e41a93e787e5e5bde797f1dddb/charset_normalizer-3.4.3-cp38-cp38-win32.whl", hash = "sha256:ec557499516fc90fd374bf2e32349a2887a876fbf162c160e3c01b6849eaf557", size = 98459, upload-time = "2025-08-09T07:57:08.031Z" },
+    { url = "https://files.pythonhosted.org/packages/05/35/bb59b1cd012d7196fc81c2f5879113971efc226a63812c9cf7f89fe97c40/charset_normalizer-3.4.3-cp38-cp38-win_amd64.whl", hash = "sha256:5d8d01eac18c423815ed4f4a2ec3b439d654e55ee4ad610e153cf02faf67ea40", size = 105887, upload-time = "2025-08-09T07:57:09.401Z" },
+    { url = "https://files.pythonhosted.org/packages/c2/ca/9a0983dd5c8e9733565cf3db4df2b0a2e9a82659fd8aa2a868ac6e4a991f/charset_normalizer-3.4.3-cp39-cp39-macosx_10_9_universal2.whl", hash = "sha256:70bfc5f2c318afece2f5838ea5e4c3febada0be750fcf4775641052bbba14d05", size = 207520, upload-time = "2025-08-09T07:57:11.026Z" },
+    { url = "https://files.pythonhosted.org/packages/39/c6/99271dc37243a4f925b09090493fb96c9333d7992c6187f5cfe5312008d2/charset_normalizer-3.4.3-cp39-cp39-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:23b6b24d74478dc833444cbd927c338349d6ae852ba53a0d02a2de1fce45b96e", size = 147307, upload-time = "2025-08-09T07:57:12.4Z" },
+    { url = "https://files.pythonhosted.org/packages/e4/69/132eab043356bba06eb333cc2cc60c6340857d0a2e4ca6dc2b51312886b3/charset_normalizer-3.4.3-cp39-cp39-manylinux2014_ppc64le.manylinux_2_17_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:34a7f768e3f985abdb42841e20e17b330ad3aaf4bb7e7aeeb73db2e70f077b99", size = 160448, upload-time = "2025-08-09T07:57:13.712Z" },
+    { url = "https://files.pythonhosted.org/packages/04/9a/914d294daa4809c57667b77470533e65def9c0be1ef8b4c1183a99170e9d/charset_normalizer-3.4.3-cp39-cp39-manylinux2014_s390x.manylinux_2_17_s390x.manylinux_2_28_s390x.whl", hash = "sha256:fb731e5deb0c7ef82d698b0f4c5bb724633ee2a489401594c5c88b02e6cb15f7", size = 157758, upload-time = "2025-08-09T07:57:14.979Z" },
+    { url = "https://files.pythonhosted.org/packages/b0/a8/6f5bcf1bcf63cb45625f7c5cadca026121ff8a6c8a3256d8d8cd59302663/charset_normalizer-3.4.3-cp39-cp39-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:257f26fed7d7ff59921b78244f3cd93ed2af1800ff048c33f624c87475819dd7", size = 152487, upload-time = "2025-08-09T07:57:16.332Z" },
+    { url = "https://files.pythonhosted.org/packages/c4/72/d3d0e9592f4e504f9dea08b8db270821c909558c353dc3b457ed2509f2fb/charset_normalizer-3.4.3-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:1ef99f0456d3d46a50945c98de1774da86f8e992ab5c77865ea8b8195341fc19", size = 150054, upload-time = "2025-08-09T07:57:17.576Z" },
+    { url = "https://files.pythonhosted.org/packages/20/30/5f64fe3981677fe63fa987b80e6c01042eb5ff653ff7cec1b7bd9268e54e/charset_normalizer-3.4.3-cp39-cp39-musllinux_1_2_ppc64le.whl", hash = "sha256:2c322db9c8c89009a990ef07c3bcc9f011a3269bc06782f916cd3d9eed7c9312", size = 161703, upload-time = "2025-08-09T07:57:20.012Z" },
+    { url = "https://files.pythonhosted.org/packages/e1/ef/dd08b2cac9284fd59e70f7d97382c33a3d0a926e45b15fc21b3308324ffd/charset_normalizer-3.4.3-cp39-cp39-musllinux_1_2_s390x.whl", hash = "sha256:511729f456829ef86ac41ca78c63a5cb55240ed23b4b737faca0eb1abb1c41bc", size = 159096, upload-time = "2025-08-09T07:57:21.329Z" },
+    { url = "https://files.pythonhosted.org/packages/45/8c/dcef87cfc2b3f002a6478f38906f9040302c68aebe21468090e39cde1445/charset_normalizer-3.4.3-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:88ab34806dea0671532d3f82d82b85e8fc23d7b2dd12fa837978dad9bb392a34", size = 153852, upload-time = "2025-08-09T07:57:22.608Z" },
+    { url = "https://files.pythonhosted.org/packages/63/86/9cbd533bd37883d467fcd1bd491b3547a3532d0fbb46de2b99feeebf185e/charset_normalizer-3.4.3-cp39-cp39-win32.whl", hash = "sha256:16a8770207946ac75703458e2c743631c79c59c5890c80011d536248f8eaa432", size = 99840, upload-time = "2025-08-09T07:57:23.883Z" },
+    { url = "https://files.pythonhosted.org/packages/ce/d6/7e805c8e5c46ff9729c49950acc4ee0aeb55efb8b3a56687658ad10c3216/charset_normalizer-3.4.3-cp39-cp39-win_amd64.whl", hash = "sha256:d22dbedd33326a4a5190dd4fe9e9e693ef12160c77382d9e87919bce54f3d4ca", size = 107438, upload-time = "2025-08-09T07:57:25.287Z" },
+    { url = "https://files.pythonhosted.org/packages/8a/1f/f041989e93b001bc4e44bb1669ccdcf54d3f00e628229a85b08d330615c5/charset_normalizer-3.4.3-py3-none-any.whl", hash = "sha256:ce571ab16d890d23b5c278547ba694193a45011ff86a9162a71307ed9f86759a", size = 53175, upload-time = "2025-08-09T07:57:26.864Z" },
+]
+
+[[package]]
+name = "colorama"
+version = "0.4.6"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/d8/53/6f443c9a4a8358a93a6792e2acffb9d9d5cb0a5cfd8802644b7b1c9a02e4/colorama-0.4.6.tar.gz", hash = "sha256:08695f5cb7ed6e0531a20572697297273c47b8cae5a63ffc6d6ed5c201be6e44", size = 27697, upload-time = "2022-10-25T02:36:22.414Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/d1/d6/3965ed04c63042e047cb6a3e6ed1a63a35087b6a609aa3a15ed8ac56c221/colorama-0.4.6-py2.py3-none-any.whl", hash = "sha256:4f1d9991f5acc0ca119f9d443620b77f9d6b33703e51011c16baf57afb285fc6", size = 25335, upload-time = "2022-10-25T02:36:20.889Z" },
+]
+
+[[package]]
+name = "contourpy"
+version = "1.1.1"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "numpy", version = "1.24.4", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/b1/7d/087ee4295e7580d3f7eb8a8a4e0ec8c7847e60f34135248ccf831cf5bbfc/contourpy-1.1.1.tar.gz", hash = "sha256:96ba37c2e24b7212a77da85004c38e7c4d155d3e72a45eeaf22c1f03f607e8ab", size = 13433167, upload-time = "2023-09-16T10:25:49.501Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/fb/7f/c44a51a83a093bf5c84e07dd1e3cfe9f68c47b6499bd05a9de0c6dbdc2bc/contourpy-1.1.1-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:46e24f5412c948d81736509377e255f6040e94216bf1a9b5ea1eaa9d29f6ec1b", size = 247207, upload-time = "2023-09-16T10:20:32.848Z" },
+    { url = "https://files.pythonhosted.org/packages/a9/65/544d66da0716b20084874297ff7596704e435cf011512f8e576638e83db2/contourpy-1.1.1-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:0e48694d6a9c5a26ee85b10130c77a011a4fedf50a7279fa0bdaf44bafb4299d", size = 232428, upload-time = "2023-09-16T10:20:36.337Z" },
+    { url = "https://files.pythonhosted.org/packages/5b/e6/697085cc34a294bd399548fd99562537a75408f113e3a815807e206246f0/contourpy-1.1.1-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:a66045af6cf00e19d02191ab578a50cb93b2028c3eefed999793698e9ea768ae", size = 285304, upload-time = "2023-09-16T10:20:40.182Z" },
+    { url = "https://files.pythonhosted.org/packages/69/4b/52d0d2e85c59f00f6ddbd6fea819f267008c58ee7708da96d112a293e91c/contourpy-1.1.1-cp310-cp310-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:4ebf42695f75ee1a952f98ce9775c873e4971732a87334b099dde90b6af6a916", size = 322655, upload-time = "2023-09-16T10:20:44.175Z" },
+    { url = "https://files.pythonhosted.org/packages/82/fc/3decc656a547a6d5d5b4249f81c72668a1f3259a62b2def2504120d38746/contourpy-1.1.1-cp310-cp310-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:f6aec19457617ef468ff091669cca01fa7ea557b12b59a7908b9474bb9674cf0", size = 296430, upload-time = "2023-09-16T10:20:47.767Z" },
+    { url = "https://files.pythonhosted.org/packages/f1/6b/e4b0f8708f22dd7c321f87eadbb98708975e115ac6582eb46d1f32197ce6/contourpy-1.1.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:462c59914dc6d81e0b11f37e560b8a7c2dbab6aca4f38be31519d442d6cde1a1", size = 301672, upload-time = "2023-09-16T10:20:51.395Z" },
+    { url = "https://files.pythonhosted.org/packages/c3/87/201410522a756e605069078833d806147cad8532fdc164a96689d05c5afc/contourpy-1.1.1-cp310-cp310-musllinux_1_1_x86_64.whl", hash = "sha256:6d0a8efc258659edc5299f9ef32d8d81de8b53b45d67bf4bfa3067f31366764d", size = 820145, upload-time = "2023-09-16T10:20:58.426Z" },
+    { url = "https://files.pythonhosted.org/packages/b4/d9/42680a17d43edda04ab2b3f11125cf97b61bce5d3b52721a42960bf748bd/contourpy-1.1.1-cp310-cp310-win32.whl", hash = "sha256:d6ab42f223e58b7dac1bb0af32194a7b9311065583cc75ff59dcf301afd8a431", size = 399542, upload-time = "2023-09-16T10:21:02.719Z" },
+    { url = "https://files.pythonhosted.org/packages/55/14/0dc1884e3c04f9b073a47283f5d424926644250891db392a07c56f05e5c5/contourpy-1.1.1-cp310-cp310-win_amd64.whl", hash = "sha256:549174b0713d49871c6dee90a4b499d3f12f5e5f69641cd23c50a4542e2ca1eb", size = 477974, upload-time = "2023-09-16T10:21:07.565Z" },
+    { url = "https://files.pythonhosted.org/packages/8b/4f/be28a39cd5e988b8d3c2cc642c2c7ffeeb28fe80a86df71b6d1e473c5038/contourpy-1.1.1-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:407d864db716a067cc696d61fa1ef6637fedf03606e8417fe2aeed20a061e6b2", size = 248613, upload-time = "2023-09-16T10:21:10.695Z" },
+    { url = "https://files.pythonhosted.org/packages/2c/8e/656f8e7cd316aa68d9824744773e90dbd71f847429d10c82001e927480a2/contourpy-1.1.1-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:dfe80c017973e6a4c367e037cb31601044dd55e6bfacd57370674867d15a899b", size = 233603, upload-time = "2023-09-16T10:21:13.771Z" },
+    { url = "https://files.pythonhosted.org/packages/60/2a/4d4bd4541212ab98f3411f21bf58b0b246f333ae996e9f57e1acf12bcc45/contourpy-1.1.1-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:e30aaf2b8a2bac57eb7e1650df1b3a4130e8d0c66fc2f861039d507a11760e1b", size = 287037, upload-time = "2023-09-16T10:21:17.622Z" },
+    { url = "https://files.pythonhosted.org/packages/24/67/8abf919443381585a4eee74069e311c736350549dae02d3d014fef93d50a/contourpy-1.1.1-cp311-cp311-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:3de23ca4f381c3770dee6d10ead6fff524d540c0f662e763ad1530bde5112532", size = 323274, upload-time = "2023-09-16T10:21:21.404Z" },
+    { url = "https://files.pythonhosted.org/packages/2a/e5/6da11329dd35a2f2e404a95e5374b5702de6ac52e776e8b87dd6ea4b29d0/contourpy-1.1.1-cp311-cp311-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:566f0e41df06dfef2431defcfaa155f0acfa1ca4acbf8fd80895b1e7e2ada40e", size = 297801, upload-time = "2023-09-16T10:21:25.155Z" },
+    { url = "https://files.pythonhosted.org/packages/b7/f6/78f60fa0b6ae64971178e2542e8b3ad3ba5f4f379b918ab7b18038a3f897/contourpy-1.1.1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:b04c2f0adaf255bf756cf08ebef1be132d3c7a06fe6f9877d55640c5e60c72c5", size = 302821, upload-time = "2023-09-16T10:21:28.663Z" },
+    { url = "https://files.pythonhosted.org/packages/da/25/6062395a1c6a06f46a577da821318886b8b939453a098b9cd61671bb497b/contourpy-1.1.1-cp311-cp311-musllinux_1_1_x86_64.whl", hash = "sha256:d0c188ae66b772d9d61d43c6030500344c13e3f73a00d1dc241da896f379bb62", size = 820121, upload-time = "2023-09-16T10:21:36.251Z" },
+    { url = "https://files.pythonhosted.org/packages/41/5e/64e78b1e8682cbab10c13fc1a2c070d30acedb805ab2f42afbd3d88f7225/contourpy-1.1.1-cp311-cp311-win32.whl", hash = "sha256:0683e1ae20dc038075d92e0e0148f09ffcefab120e57f6b4c9c0f477ec171f33", size = 401590, upload-time = "2023-09-16T10:21:40.42Z" },
+    { url = "https://files.pythonhosted.org/packages/e5/76/94bc17eb868f8c7397f8fdfdeae7661c1b9a35f3a7219da308596e8c252a/contourpy-1.1.1-cp311-cp311-win_amd64.whl", hash = "sha256:8636cd2fc5da0fb102a2504fa2c4bea3cbc149533b345d72cdf0e7a924decc45", size = 480534, upload-time = "2023-09-16T10:21:45.724Z" },
+    { url = "https://files.pythonhosted.org/packages/94/0f/07a5e26fec7176658f6aecffc615900ff1d303baa2b67bc37fd98ce67c87/contourpy-1.1.1-cp312-cp312-macosx_10_9_x86_64.whl", hash = "sha256:560f1d68a33e89c62da5da4077ba98137a5e4d3a271b29f2f195d0fba2adcb6a", size = 249799, upload-time = "2023-09-16T10:21:48.797Z" },
+    { url = "https://files.pythonhosted.org/packages/32/0b/d7baca3f60d3b3a77c9ba1307c7792befd3c1c775a26c649dca1bfa9b6ba/contourpy-1.1.1-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:24216552104ae8f3b34120ef84825400b16eb6133af2e27a190fdc13529f023e", size = 232739, upload-time = "2023-09-16T10:21:51.854Z" },
+    { url = "https://files.pythonhosted.org/packages/6d/62/a385b4d4b5718e3a933de5791528f45f1f5b364d3c79172ad0309c832041/contourpy-1.1.1-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:56de98a2fb23025882a18b60c7f0ea2d2d70bbbcfcf878f9067234b1c4818442", size = 282171, upload-time = "2023-09-16T10:21:55.794Z" },
+    { url = "https://files.pythonhosted.org/packages/91/21/8c6819747fea53557f3963ca936035b3e8bed87d591f5278ad62516a059d/contourpy-1.1.1-cp312-cp312-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:07d6f11dfaf80a84c97f1a5ba50d129d9303c5b4206f776e94037332e298dda8", size = 321182, upload-time = "2023-09-16T10:21:59.576Z" },
+    { url = "https://files.pythonhosted.org/packages/22/29/d75da9002f9df09c755b12cf0357eb91b081c858e604f4e92b4b8bfc3c15/contourpy-1.1.1-cp312-cp312-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:f1eaac5257a8f8a047248d60e8f9315c6cff58f7803971170d952555ef6344a7", size = 295869, upload-time = "2023-09-16T10:22:03.248Z" },
+    { url = "https://files.pythonhosted.org/packages/a7/47/4e7e66159f881c131e3b97d1cc5c0ea72be62bdd292c7f63fd13937d07f4/contourpy-1.1.1-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:19557fa407e70f20bfaba7d55b4d97b14f9480856c4fb65812e8a05fe1c6f9bf", size = 298756, upload-time = "2023-09-16T10:22:06.663Z" },
+    { url = "https://files.pythonhosted.org/packages/d3/bb/bffc99bc3172942b5eda8027ca0cb80ddd336fcdd634d68adce957d37231/contourpy-1.1.1-cp312-cp312-musllinux_1_1_x86_64.whl", hash = "sha256:081f3c0880712e40effc5f4c3b08feca6d064cb8cfbb372ca548105b86fd6c3d", size = 818441, upload-time = "2023-09-16T10:22:13.805Z" },
+    { url = "https://files.pythonhosted.org/packages/da/1b/904baf0aaaf6c6e2247801dcd1ff0d7bf84352839927d356b28ae804cbb0/contourpy-1.1.1-cp312-cp312-win32.whl", hash = "sha256:059c3d2a94b930f4dafe8105bcdc1b21de99b30b51b5bce74c753686de858cb6", size = 410294, upload-time = "2023-09-16T10:22:18.055Z" },
+    { url = "https://files.pythonhosted.org/packages/75/d4/c3b7a9a0d1f99b528e5a46266b0b9f13aad5a0dd1156d071418df314c427/contourpy-1.1.1-cp312-cp312-win_amd64.whl", hash = "sha256:f44d78b61740e4e8c71db1cf1fd56d9050a4747681c59ec1094750a658ceb970", size = 486678, upload-time = "2023-09-16T10:22:23.249Z" },
+    { url = "https://files.pythonhosted.org/packages/02/7e/ffaba1bf3719088be3ad6983a5e85e1fc9edccd7b406b98e433436ecef74/contourpy-1.1.1-cp38-cp38-macosx_10_9_x86_64.whl", hash = "sha256:70e5a10f8093d228bb2b552beeb318b8928b8a94763ef03b858ef3612b29395d", size = 247023, upload-time = "2023-09-16T10:22:26.954Z" },
+    { url = "https://files.pythonhosted.org/packages/a6/82/29f5ff4ae074c3230e266bc9efef449ebde43721a727b989dd8ef8f97d73/contourpy-1.1.1-cp38-cp38-macosx_11_0_arm64.whl", hash = "sha256:8394e652925a18ef0091115e3cc191fef350ab6dc3cc417f06da66bf98071ae9", size = 232380, upload-time = "2023-09-16T10:22:30.423Z" },
+    { url = "https://files.pythonhosted.org/packages/9b/cb/08f884c4c2efd433a38876b1b8069bfecef3f2d21ff0ce635d455962f70f/contourpy-1.1.1-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:c5bd5680f844c3ff0008523a71949a3ff5e4953eb7701b28760805bc9bcff217", size = 285830, upload-time = "2023-09-16T10:22:33.787Z" },
+    { url = "https://files.pythonhosted.org/packages/8e/57/cd4d4c99d999a25e9d518f628b4793e64b1ecb8ad3147f8469d8d4a80678/contourpy-1.1.1-cp38-cp38-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:66544f853bfa85c0d07a68f6c648b2ec81dafd30f272565c37ab47a33b220684", size = 322038, upload-time = "2023-09-16T10:22:37.627Z" },
+    { url = "https://files.pythonhosted.org/packages/32/b6/c57ed305a6f86731107fc183e97c7e6a6005d145f5c5228a44718082ad12/contourpy-1.1.1-cp38-cp38-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:e0c02b75acfea5cab07585d25069207e478d12309557f90a61b5a3b4f77f46ce", size = 295797, upload-time = "2023-09-16T10:22:41.952Z" },
+    { url = "https://files.pythonhosted.org/packages/8e/71/7f20855592cc929bc206810432b991ec4c702dc26b0567b132e52c85536f/contourpy-1.1.1-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:41339b24471c58dc1499e56783fedc1afa4bb018bcd035cfb0ee2ad2a7501ef8", size = 301124, upload-time = "2023-09-16T10:22:45.993Z" },
+    { url = "https://files.pythonhosted.org/packages/86/6d/52c2fc80f433e7cdc8624d82e1422ad83ad461463cf16a1953bbc7d10eb1/contourpy-1.1.1-cp38-cp38-musllinux_1_1_x86_64.whl", hash = "sha256:f29fb0b3f1217dfe9362ec55440d0743fe868497359f2cf93293f4b2701b8251", size = 819787, upload-time = "2023-09-16T10:22:53.511Z" },
+    { url = "https://files.pythonhosted.org/packages/d0/b0/f8d4548e89f929d6c5ca329df9afad6190af60079ec77d8c31eb48cf6f82/contourpy-1.1.1-cp38-cp38-win32.whl", hash = "sha256:f9dc7f933975367251c1b34da882c4f0e0b2e24bb35dc906d2f598a40b72bfc7", size = 400031, upload-time = "2023-09-16T10:22:57.78Z" },
+    { url = "https://files.pythonhosted.org/packages/96/1b/b05cd42c8d21767a0488b883b38658fb9a45f86c293b7b42521a8113dc5d/contourpy-1.1.1-cp38-cp38-win_amd64.whl", hash = "sha256:498e53573e8b94b1caeb9e62d7c2d053c263ebb6aa259c81050766beb50ff8d9", size = 477949, upload-time = "2023-09-16T10:23:02.587Z" },
+    { url = "https://files.pythonhosted.org/packages/16/d9/8a15ff67fc27c65939e454512955e1b240ec75cd201d82e115b3b63ef76d/contourpy-1.1.1-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:ba42e3810999a0ddd0439e6e5dbf6d034055cdc72b7c5c839f37a7c274cb4eba", size = 247396, upload-time = "2023-09-16T10:23:06.429Z" },
+    { url = "https://files.pythonhosted.org/packages/09/fe/086e6847ee53da10ddf0b6c5e5f877ab43e68e355d2f4c85f67561ee8a57/contourpy-1.1.1-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:6c06e4c6e234fcc65435223c7b2a90f286b7f1b2733058bdf1345d218cc59e34", size = 232598, upload-time = "2023-09-16T10:23:11.009Z" },
+    { url = "https://files.pythonhosted.org/packages/a3/9c/662925239e1185c6cf1da8c334e4c61bddcfa8e528f4b51083b613003170/contourpy-1.1.1-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:ca6fab080484e419528e98624fb5c4282148b847e3602dc8dbe0cb0669469887", size = 286436, upload-time = "2023-09-16T10:23:14.624Z" },
+    { url = "https://files.pythonhosted.org/packages/d3/7e/417cdf65da7140981079eda6a81ecd593ae0239bf8c738f2e2b3f6df8920/contourpy-1.1.1-cp39-cp39-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:93df44ab351119d14cd1e6b52a5063d3336f0754b72736cc63db59307dabb718", size = 322629, upload-time = "2023-09-16T10:23:18.203Z" },
+    { url = "https://files.pythonhosted.org/packages/a8/22/ffd88aef74cc045698c5e5c400e8b7cd62311199c109245ac7827290df2c/contourpy-1.1.1-cp39-cp39-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:eafbef886566dc1047d7b3d4b14db0d5b7deb99638d8e1be4e23a7c7ac59ff0f", size = 297117, upload-time = "2023-09-16T10:23:21.586Z" },
+    { url = "https://files.pythonhosted.org/packages/2b/c0/24c34c41a180f875419b536125799c61e2330b997d77a5a818a3bc3e08cd/contourpy-1.1.1-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:efe0fab26d598e1ec07d72cf03eaeeba8e42b4ecf6b9ccb5a356fde60ff08b85", size = 301855, upload-time = "2023-09-16T10:23:25.584Z" },
+    { url = "https://files.pythonhosted.org/packages/bf/ec/f9877f6378a580cd683bd76c8a781dcd972e82965e0da951a739d3364677/contourpy-1.1.1-cp39-cp39-musllinux_1_1_x86_64.whl", hash = "sha256:f08e469821a5e4751c97fcd34bcb586bc243c39c2e39321822060ba902eac49e", size = 820597, upload-time = "2023-09-16T10:23:33.133Z" },
+    { url = "https://files.pythonhosted.org/packages/e1/3a/c41f4bc7122d3a06388acae1bed6f50a665c1031863ca42bd701094dcb1f/contourpy-1.1.1-cp39-cp39-win32.whl", hash = "sha256:bfc8a5e9238232a45ebc5cb3bfee71f1167064c8d382cadd6076f0d51cff1da0", size = 400031, upload-time = "2023-09-16T10:23:37.546Z" },
+    { url = "https://files.pythonhosted.org/packages/87/2b/9b49451f7412cc1a79198e94a771a4e52d65c479aae610b1161c0290ef2c/contourpy-1.1.1-cp39-cp39-win_amd64.whl", hash = "sha256:c84fdf3da00c2827d634de4fcf17e3e067490c4aea82833625c4c8e6cdea0887", size = 435965, upload-time = "2023-09-16T10:23:42.512Z" },
+    { url = "https://files.pythonhosted.org/packages/e6/3c/fc36884b6793e2066a6ff25c86e21b8bd62553456b07e964c260bcf22711/contourpy-1.1.1-pp38-pypy38_pp73-macosx_10_9_x86_64.whl", hash = "sha256:229a25f68046c5cf8067d6d6351c8b99e40da11b04d8416bf8d2b1d75922521e", size = 246493, upload-time = "2023-09-16T10:23:45.721Z" },
+    { url = "https://files.pythonhosted.org/packages/3d/85/f4c5b09ce79828ed4553a8ae2ebdf937794f57b45848b1f5c95d9744ecc2/contourpy-1.1.1-pp38-pypy38_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:a10dab5ea1bd4401c9483450b5b0ba5416be799bbd50fc7a6cc5e2a15e03e8a3", size = 289240, upload-time = "2023-09-16T10:23:49.207Z" },
+    { url = "https://files.pythonhosted.org/packages/18/d3/9d7c0a372baf5130c1417a4b8275079d5379c11355436cb9fc78af7d7559/contourpy-1.1.1-pp38-pypy38_pp73-win_amd64.whl", hash = "sha256:4f9147051cb8fdb29a51dc2482d792b3b23e50f8f57e3720ca2e3d438b7adf23", size = 476043, upload-time = "2023-09-16T10:23:54.495Z" },
+    { url = "https://files.pythonhosted.org/packages/e7/12/643242c3d9b031ca19f9a440f63e568dd883a04711056ca5d607f9bda888/contourpy-1.1.1-pp39-pypy39_pp73-macosx_10_9_x86_64.whl", hash = "sha256:a75cc163a5f4531a256f2c523bd80db509a49fc23721b36dd1ef2f60ff41c3cb", size = 246247, upload-time = "2023-09-16T10:23:58.204Z" },
+    { url = "https://files.pythonhosted.org/packages/e1/37/95716fe235bf441422059e4afcd4b9b7c5821851c2aee992a06d1e9f831a/contourpy-1.1.1-pp39-pypy39_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:3b53d5769aa1f2d4ea407c65f2d1d08002952fac1d9e9d307aa2e1023554a163", size = 289029, upload-time = "2023-09-16T10:24:02.085Z" },
+    { url = "https://files.pythonhosted.org/packages/e5/fd/14852c4a688031e0d8a20d9a1b60078d45507186ef17042093835be2f01a/contourpy-1.1.1-pp39-pypy39_pp73-win_amd64.whl", hash = "sha256:11b836b7dbfb74e049c302bbf74b4b8f6cb9d0b6ca1bf86cfa8ba144aedadd9c", size = 476043, upload-time = "2023-09-16T10:24:07.292Z" },
+]
+
+[[package]]
+name = "contourpy"
+version = "1.3.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "numpy", version = "2.0.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/f5/f6/31a8f28b4a2a4fa0e01085e542f3081ab0588eff8e589d39d775172c9792/contourpy-1.3.0.tar.gz", hash = "sha256:7ffa0db17717a8ffb127efd0c95a4362d996b892c2904db72428d5b52e1938a4", size = 13464370, upload-time = "2024-08-27T21:00:03.328Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/6c/e0/be8dcc796cfdd96708933e0e2da99ba4bb8f9b2caa9d560a50f3f09a65f3/contourpy-1.3.0-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:880ea32e5c774634f9fcd46504bf9f080a41ad855f4fef54f5380f5133d343c7", size = 265366, upload-time = "2024-08-27T20:50:09.947Z" },
+    { url = "https://files.pythonhosted.org/packages/50/d6/c953b400219443535d412fcbbc42e7a5e823291236bc0bb88936e3cc9317/contourpy-1.3.0-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:76c905ef940a4474a6289c71d53122a4f77766eef23c03cd57016ce19d0f7b42", size = 249226, upload-time = "2024-08-27T20:50:16.1Z" },
+    { url = "https://files.pythonhosted.org/packages/6f/b4/6fffdf213ffccc28483c524b9dad46bb78332851133b36ad354b856ddc7c/contourpy-1.3.0-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:92f8557cbb07415a4d6fa191f20fd9d2d9eb9c0b61d1b2f52a8926e43c6e9af7", size = 308460, upload-time = "2024-08-27T20:50:22.536Z" },
+    { url = "https://files.pythonhosted.org/packages/cf/6c/118fc917b4050f0afe07179a6dcbe4f3f4ec69b94f36c9e128c4af480fb8/contourpy-1.3.0-cp310-cp310-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:36f965570cff02b874773c49bfe85562b47030805d7d8360748f3eca570f4cab", size = 347623, upload-time = "2024-08-27T20:50:28.806Z" },
+    { url = "https://files.pythonhosted.org/packages/f9/a4/30ff110a81bfe3abf7b9673284d21ddce8cc1278f6f77393c91199da4c90/contourpy-1.3.0-cp310-cp310-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:cacd81e2d4b6f89c9f8a5b69b86490152ff39afc58a95af002a398273e5ce589", size = 317761, upload-time = "2024-08-27T20:50:35.126Z" },
+    { url = "https://files.pythonhosted.org/packages/99/e6/d11966962b1aa515f5586d3907ad019f4b812c04e4546cc19ebf62b5178e/contourpy-1.3.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:69375194457ad0fad3a839b9e29aa0b0ed53bb54db1bfb6c3ae43d111c31ce41", size = 322015, upload-time = "2024-08-27T20:50:40.318Z" },
+    { url = "https://files.pythonhosted.org/packages/4d/e3/182383743751d22b7b59c3c753277b6aee3637049197624f333dac5b4c80/contourpy-1.3.0-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:7a52040312b1a858b5e31ef28c2e865376a386c60c0e248370bbea2d3f3b760d", size = 1262672, upload-time = "2024-08-27T20:50:55.643Z" },
+    { url = "https://files.pythonhosted.org/packages/78/53/974400c815b2e605f252c8fb9297e2204347d1755a5374354ee77b1ea259/contourpy-1.3.0-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:3faeb2998e4fcb256542e8a926d08da08977f7f5e62cf733f3c211c2a5586223", size = 1321688, upload-time = "2024-08-27T20:51:11.293Z" },
+    { url = "https://files.pythonhosted.org/packages/52/29/99f849faed5593b2926a68a31882af98afbeac39c7fdf7de491d9c85ec6a/contourpy-1.3.0-cp310-cp310-win32.whl", hash = "sha256:36e0cff201bcb17a0a8ecc7f454fe078437fa6bda730e695a92f2d9932bd507f", size = 171145, upload-time = "2024-08-27T20:51:15.2Z" },
+    { url = "https://files.pythonhosted.org/packages/a9/97/3f89bba79ff6ff2b07a3cbc40aa693c360d5efa90d66e914f0ff03b95ec7/contourpy-1.3.0-cp310-cp310-win_amd64.whl", hash = "sha256:87ddffef1dbe5e669b5c2440b643d3fdd8622a348fe1983fad7a0f0ccb1cd67b", size = 216019, upload-time = "2024-08-27T20:51:19.365Z" },
+    { url = "https://files.pythonhosted.org/packages/b3/1f/9375917786cb39270b0ee6634536c0e22abf225825602688990d8f5c6c19/contourpy-1.3.0-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:0fa4c02abe6c446ba70d96ece336e621efa4aecae43eaa9b030ae5fb92b309ad", size = 266356, upload-time = "2024-08-27T20:51:24.146Z" },
+    { url = "https://files.pythonhosted.org/packages/05/46/9256dd162ea52790c127cb58cfc3b9e3413a6e3478917d1f811d420772ec/contourpy-1.3.0-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:834e0cfe17ba12f79963861e0f908556b2cedd52e1f75e6578801febcc6a9f49", size = 250915, upload-time = "2024-08-27T20:51:28.683Z" },
+    { url = "https://files.pythonhosted.org/packages/e1/5d/3056c167fa4486900dfbd7e26a2fdc2338dc58eee36d490a0ed3ddda5ded/contourpy-1.3.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:dbc4c3217eee163fa3984fd1567632b48d6dfd29216da3ded3d7b844a8014a66", size = 310443, upload-time = "2024-08-27T20:51:33.675Z" },
+    { url = "https://files.pythonhosted.org/packages/ca/c2/1a612e475492e07f11c8e267ea5ec1ce0d89971be496c195e27afa97e14a/contourpy-1.3.0-cp311-cp311-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:4865cd1d419e0c7a7bf6de1777b185eebdc51470800a9f42b9e9decf17762081", size = 348548, upload-time = "2024-08-27T20:51:39.322Z" },
+    { url = "https://files.pythonhosted.org/packages/45/cf/2c2fc6bb5874158277b4faf136847f0689e1b1a1f640a36d76d52e78907c/contourpy-1.3.0-cp311-cp311-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:303c252947ab4b14c08afeb52375b26781ccd6a5ccd81abcdfc1fafd14cf93c1", size = 319118, upload-time = "2024-08-27T20:51:44.717Z" },
+    { url = "https://files.pythonhosted.org/packages/03/33/003065374f38894cdf1040cef474ad0546368eea7e3a51d48b8a423961f8/contourpy-1.3.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:637f674226be46f6ba372fd29d9523dd977a291f66ab2a74fbeb5530bb3f445d", size = 323162, upload-time = "2024-08-27T20:51:49.683Z" },
+    { url = "https://files.pythonhosted.org/packages/42/80/e637326e85e4105a802e42959f56cff2cd39a6b5ef68d5d9aee3ea5f0e4c/contourpy-1.3.0-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:76a896b2f195b57db25d6b44e7e03f221d32fe318d03ede41f8b4d9ba1bff53c", size = 1265396, upload-time = "2024-08-27T20:52:04.926Z" },
+    { url = "https://files.pythonhosted.org/packages/7c/3b/8cbd6416ca1bbc0202b50f9c13b2e0b922b64be888f9d9ee88e6cfabfb51/contourpy-1.3.0-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:e1fd23e9d01591bab45546c089ae89d926917a66dceb3abcf01f6105d927e2cb", size = 1324297, upload-time = "2024-08-27T20:52:21.843Z" },
+    { url = "https://files.pythonhosted.org/packages/4d/2c/021a7afaa52fe891f25535506cc861c30c3c4e5a1c1ce94215e04b293e72/contourpy-1.3.0-cp311-cp311-win32.whl", hash = "sha256:d402880b84df3bec6eab53cd0cf802cae6a2ef9537e70cf75e91618a3801c20c", size = 171808, upload-time = "2024-08-27T20:52:25.163Z" },
+    { url = "https://files.pythonhosted.org/packages/8d/2f/804f02ff30a7fae21f98198828d0857439ec4c91a96e20cf2d6c49372966/contourpy-1.3.0-cp311-cp311-win_amd64.whl", hash = "sha256:6cb6cc968059db9c62cb35fbf70248f40994dfcd7aa10444bbf8b3faeb7c2d67", size = 217181, upload-time = "2024-08-27T20:52:29.13Z" },
+    { url = "https://files.pythonhosted.org/packages/c9/92/8e0bbfe6b70c0e2d3d81272b58c98ac69ff1a4329f18c73bd64824d8b12e/contourpy-1.3.0-cp312-cp312-macosx_10_9_x86_64.whl", hash = "sha256:570ef7cf892f0afbe5b2ee410c507ce12e15a5fa91017a0009f79f7d93a1268f", size = 267838, upload-time = "2024-08-27T20:52:33.911Z" },
+    { url = "https://files.pythonhosted.org/packages/e3/04/33351c5d5108460a8ce6d512307690b023f0cfcad5899499f5c83b9d63b1/contourpy-1.3.0-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:da84c537cb8b97d153e9fb208c221c45605f73147bd4cadd23bdae915042aad6", size = 251549, upload-time = "2024-08-27T20:52:39.179Z" },
+    { url = "https://files.pythonhosted.org/packages/51/3d/aa0fe6ae67e3ef9f178389e4caaaa68daf2f9024092aa3c6032e3d174670/contourpy-1.3.0-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:0be4d8425bfa755e0fd76ee1e019636ccc7c29f77a7c86b4328a9eb6a26d0639", size = 303177, upload-time = "2024-08-27T20:52:44.789Z" },
+    { url = "https://files.pythonhosted.org/packages/56/c3/c85a7e3e0cab635575d3b657f9535443a6f5d20fac1a1911eaa4bbe1aceb/contourpy-1.3.0-cp312-cp312-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:9c0da700bf58f6e0b65312d0a5e695179a71d0163957fa381bb3c1f72972537c", size = 341735, upload-time = "2024-08-27T20:52:51.05Z" },
+    { url = "https://files.pythonhosted.org/packages/dd/8d/20f7a211a7be966a53f474bc90b1a8202e9844b3f1ef85f3ae45a77151ee/contourpy-1.3.0-cp312-cp312-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:eb8b141bb00fa977d9122636b16aa67d37fd40a3d8b52dd837e536d64b9a4d06", size = 314679, upload-time = "2024-08-27T20:52:58.473Z" },
+    { url = "https://files.pythonhosted.org/packages/6e/be/524e377567defac0e21a46e2a529652d165fed130a0d8a863219303cee18/contourpy-1.3.0-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:3634b5385c6716c258d0419c46d05c8aa7dc8cb70326c9a4fb66b69ad2b52e09", size = 320549, upload-time = "2024-08-27T20:53:06.593Z" },
+    { url = "https://files.pythonhosted.org/packages/0f/96/fdb2552a172942d888915f3a6663812e9bc3d359d53dafd4289a0fb462f0/contourpy-1.3.0-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:0dce35502151b6bd35027ac39ba6e5a44be13a68f55735c3612c568cac3805fd", size = 1263068, upload-time = "2024-08-27T20:53:23.442Z" },
+    { url = "https://files.pythonhosted.org/packages/2a/25/632eab595e3140adfa92f1322bf8915f68c932bac468e89eae9974cf1c00/contourpy-1.3.0-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:aea348f053c645100612b333adc5983d87be69acdc6d77d3169c090d3b01dc35", size = 1322833, upload-time = "2024-08-27T20:53:39.243Z" },
+    { url = "https://files.pythonhosted.org/packages/73/e3/69738782e315a1d26d29d71a550dbbe3eb6c653b028b150f70c1a5f4f229/contourpy-1.3.0-cp312-cp312-win32.whl", hash = "sha256:90f73a5116ad1ba7174341ef3ea5c3150ddf20b024b98fb0c3b29034752c8aeb", size = 172681, upload-time = "2024-08-27T20:53:43.05Z" },
+    { url = "https://files.pythonhosted.org/packages/0c/89/9830ba00d88e43d15e53d64931e66b8792b46eb25e2050a88fec4a0df3d5/contourpy-1.3.0-cp312-cp312-win_amd64.whl", hash = "sha256:b11b39aea6be6764f84360fce6c82211a9db32a7c7de8fa6dd5397cf1d079c3b", size = 218283, upload-time = "2024-08-27T20:53:47.232Z" },
+    { url = "https://files.pythonhosted.org/packages/53/a1/d20415febfb2267af2d7f06338e82171824d08614084714fb2c1dac9901f/contourpy-1.3.0-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:3e1c7fa44aaae40a2247e2e8e0627f4bea3dd257014764aa644f319a5f8600e3", size = 267879, upload-time = "2024-08-27T20:53:51.597Z" },
+    { url = "https://files.pythonhosted.org/packages/aa/45/5a28a3570ff6218d8bdfc291a272a20d2648104815f01f0177d103d985e1/contourpy-1.3.0-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:364174c2a76057feef647c802652f00953b575723062560498dc7930fc9b1cb7", size = 251573, upload-time = "2024-08-27T20:53:55.659Z" },
+    { url = "https://files.pythonhosted.org/packages/39/1c/d3f51540108e3affa84f095c8b04f0aa833bb797bc8baa218a952a98117d/contourpy-1.3.0-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:32b238b3b3b649e09ce9aaf51f0c261d38644bdfa35cbaf7b263457850957a84", size = 303184, upload-time = "2024-08-27T20:54:00.225Z" },
+    { url = "https://files.pythonhosted.org/packages/00/56/1348a44fb6c3a558c1a3a0cd23d329d604c99d81bf5a4b58c6b71aab328f/contourpy-1.3.0-cp313-cp313-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:d51fca85f9f7ad0b65b4b9fe800406d0d77017d7270d31ec3fb1cc07358fdea0", size = 340262, upload-time = "2024-08-27T20:54:05.234Z" },
+    { url = "https://files.pythonhosted.org/packages/2b/23/00d665ba67e1bb666152131da07e0f24c95c3632d7722caa97fb61470eca/contourpy-1.3.0-cp313-cp313-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:732896af21716b29ab3e988d4ce14bc5133733b85956316fb0c56355f398099b", size = 313806, upload-time = "2024-08-27T20:54:09.889Z" },
+    { url = "https://files.pythonhosted.org/packages/5a/42/3cf40f7040bb8362aea19af9a5fb7b32ce420f645dd1590edcee2c657cd5/contourpy-1.3.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:d73f659398a0904e125280836ae6f88ba9b178b2fed6884f3b1f95b989d2c8da", size = 319710, upload-time = "2024-08-27T20:54:14.536Z" },
+    { url = "https://files.pythonhosted.org/packages/05/32/f3bfa3fc083b25e1a7ae09197f897476ee68e7386e10404bdf9aac7391f0/contourpy-1.3.0-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:c6c7c2408b7048082932cf4e641fa3b8ca848259212f51c8c59c45aa7ac18f14", size = 1264107, upload-time = "2024-08-27T20:54:29.735Z" },
+    { url = "https://files.pythonhosted.org/packages/1c/1e/1019d34473a736664f2439542b890b2dc4c6245f5c0d8cdfc0ccc2cab80c/contourpy-1.3.0-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:f317576606de89da6b7e0861cf6061f6146ead3528acabff9236458a6ba467f8", size = 1322458, upload-time = "2024-08-27T20:54:45.507Z" },
+    { url = "https://files.pythonhosted.org/packages/22/85/4f8bfd83972cf8909a4d36d16b177f7b8bdd942178ea4bf877d4a380a91c/contourpy-1.3.0-cp313-cp313-win32.whl", hash = "sha256:31cd3a85dbdf1fc002280c65caa7e2b5f65e4a973fcdf70dd2fdcb9868069294", size = 172643, upload-time = "2024-08-27T20:55:52.754Z" },
+    { url = "https://files.pythonhosted.org/packages/cc/4a/fb3c83c1baba64ba90443626c228ca14f19a87c51975d3b1de308dd2cf08/contourpy-1.3.0-cp313-cp313-win_amd64.whl", hash = "sha256:4553c421929ec95fb07b3aaca0fae668b2eb5a5203d1217ca7c34c063c53d087", size = 218301, upload-time = "2024-08-27T20:55:56.509Z" },
+    { url = "https://files.pythonhosted.org/packages/76/65/702f4064f397821fea0cb493f7d3bc95a5d703e20954dce7d6d39bacf378/contourpy-1.3.0-cp313-cp313t-macosx_10_13_x86_64.whl", hash = "sha256:345af746d7766821d05d72cb8f3845dfd08dd137101a2cb9b24de277d716def8", size = 278972, upload-time = "2024-08-27T20:54:50.347Z" },
+    { url = "https://files.pythonhosted.org/packages/80/85/21f5bba56dba75c10a45ec00ad3b8190dbac7fd9a8a8c46c6116c933e9cf/contourpy-1.3.0-cp313-cp313t-macosx_11_0_arm64.whl", hash = "sha256:3bb3808858a9dc68f6f03d319acd5f1b8a337e6cdda197f02f4b8ff67ad2057b", size = 263375, upload-time = "2024-08-27T20:54:54.909Z" },
+    { url = "https://files.pythonhosted.org/packages/0a/64/084c86ab71d43149f91ab3a4054ccf18565f0a8af36abfa92b1467813ed6/contourpy-1.3.0-cp313-cp313t-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:420d39daa61aab1221567b42eecb01112908b2cab7f1b4106a52caaec8d36973", size = 307188, upload-time = "2024-08-27T20:55:00.184Z" },
+    { url = "https://files.pythonhosted.org/packages/3d/ff/d61a4c288dc42da0084b8d9dc2aa219a850767165d7d9a9c364ff530b509/contourpy-1.3.0-cp313-cp313t-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:4d63ee447261e963af02642ffcb864e5a2ee4cbfd78080657a9880b8b1868e18", size = 345644, upload-time = "2024-08-27T20:55:05.673Z" },
+    { url = "https://files.pythonhosted.org/packages/ca/aa/00d2313d35ec03f188e8f0786c2fc61f589306e02fdc158233697546fd58/contourpy-1.3.0-cp313-cp313t-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:167d6c890815e1dac9536dca00828b445d5d0df4d6a8c6adb4a7ec3166812fa8", size = 317141, upload-time = "2024-08-27T20:55:11.047Z" },
+    { url = "https://files.pythonhosted.org/packages/8d/6a/b5242c8cb32d87f6abf4f5e3044ca397cb1a76712e3fa2424772e3ff495f/contourpy-1.3.0-cp313-cp313t-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:710a26b3dc80c0e4febf04555de66f5fd17e9cf7170a7b08000601a10570bda6", size = 323469, upload-time = "2024-08-27T20:55:15.914Z" },
+    { url = "https://files.pythonhosted.org/packages/6f/a6/73e929d43028a9079aca4bde107494864d54f0d72d9db508a51ff0878593/contourpy-1.3.0-cp313-cp313t-musllinux_1_2_aarch64.whl", hash = "sha256:75ee7cb1a14c617f34a51d11fa7524173e56551646828353c4af859c56b766e2", size = 1260894, upload-time = "2024-08-27T20:55:31.553Z" },
+    { url = "https://files.pythonhosted.org/packages/2b/1e/1e726ba66eddf21c940821df8cf1a7d15cb165f0682d62161eaa5e93dae1/contourpy-1.3.0-cp313-cp313t-musllinux_1_2_x86_64.whl", hash = "sha256:33c92cdae89ec5135d036e7218e69b0bb2851206077251f04a6c4e0e21f03927", size = 1314829, upload-time = "2024-08-27T20:55:47.837Z" },
+    { url = "https://files.pythonhosted.org/packages/b3/e3/b9f72758adb6ef7397327ceb8b9c39c75711affb220e4f53c745ea1d5a9a/contourpy-1.3.0-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:a11077e395f67ffc2c44ec2418cfebed032cd6da3022a94fc227b6faf8e2acb8", size = 265518, upload-time = "2024-08-27T20:56:01.333Z" },
+    { url = "https://files.pythonhosted.org/packages/ec/22/19f5b948367ab5260fb41d842c7a78dae645603881ea6bc39738bcfcabf6/contourpy-1.3.0-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:e8134301d7e204c88ed7ab50028ba06c683000040ede1d617298611f9dc6240c", size = 249350, upload-time = "2024-08-27T20:56:05.432Z" },
+    { url = "https://files.pythonhosted.org/packages/26/76/0c7d43263dd00ae21a91a24381b7e813d286a3294d95d179ef3a7b9fb1d7/contourpy-1.3.0-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:e12968fdfd5bb45ffdf6192a590bd8ddd3ba9e58360b29683c6bb71a7b41edca", size = 309167, upload-time = "2024-08-27T20:56:10.034Z" },
+    { url = "https://files.pythonhosted.org/packages/96/3b/cadff6773e89f2a5a492c1a8068e21d3fccaf1a1c1df7d65e7c8e3ef60ba/contourpy-1.3.0-cp39-cp39-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:fd2a0fc506eccaaa7595b7e1418951f213cf8255be2600f1ea1b61e46a60c55f", size = 348279, upload-time = "2024-08-27T20:56:15.41Z" },
+    { url = "https://files.pythonhosted.org/packages/e1/86/158cc43aa549d2081a955ab11c6bdccc7a22caacc2af93186d26f5f48746/contourpy-1.3.0-cp39-cp39-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:4cfb5c62ce023dfc410d6059c936dcf96442ba40814aefbfa575425a3a7f19dc", size = 318519, upload-time = "2024-08-27T20:56:21.813Z" },
+    { url = "https://files.pythonhosted.org/packages/05/11/57335544a3027e9b96a05948c32e566328e3a2f84b7b99a325b7a06d2b06/contourpy-1.3.0-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:68a32389b06b82c2fdd68276148d7b9275b5f5cf13e5417e4252f6d1a34f72a2", size = 321922, upload-time = "2024-08-27T20:56:26.983Z" },
+    { url = "https://files.pythonhosted.org/packages/0b/e3/02114f96543f4a1b694333b92a6dcd4f8eebbefcc3a5f3bbb1316634178f/contourpy-1.3.0-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:94e848a6b83da10898cbf1311a815f770acc9b6a3f2d646f330d57eb4e87592e", size = 1258017, upload-time = "2024-08-27T20:56:42.246Z" },
+    { url = "https://files.pythonhosted.org/packages/f3/3b/bfe4c81c6d5881c1c643dde6620be0b42bf8aab155976dd644595cfab95c/contourpy-1.3.0-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:d78ab28a03c854a873787a0a42254a0ccb3cb133c672f645c9f9c8f3ae9d0800", size = 1316773, upload-time = "2024-08-27T20:56:58.58Z" },
+    { url = "https://files.pythonhosted.org/packages/f1/17/c52d2970784383cafb0bd918b6fb036d98d96bbf0bc1befb5d1e31a07a70/contourpy-1.3.0-cp39-cp39-win32.whl", hash = "sha256:81cb5ed4952aae6014bc9d0421dec7c5835c9c8c31cdf51910b708f548cf58e5", size = 171353, upload-time = "2024-08-27T20:57:02.718Z" },
+    { url = "https://files.pythonhosted.org/packages/53/23/db9f69676308e094d3c45f20cc52e12d10d64f027541c995d89c11ad5c75/contourpy-1.3.0-cp39-cp39-win_amd64.whl", hash = "sha256:14e262f67bd7e6eb6880bc564dcda30b15e351a594657e55b7eec94b6ef72843", size = 211817, upload-time = "2024-08-27T20:57:06.328Z" },
+    { url = "https://files.pythonhosted.org/packages/d1/09/60e486dc2b64c94ed33e58dcfb6f808192c03dfc5574c016218b9b7680dc/contourpy-1.3.0-pp310-pypy310_pp73-macosx_10_15_x86_64.whl", hash = "sha256:fe41b41505a5a33aeaed2a613dccaeaa74e0e3ead6dd6fd3a118fb471644fd6c", size = 261886, upload-time = "2024-08-27T20:57:10.863Z" },
+    { url = "https://files.pythonhosted.org/packages/19/20/b57f9f7174fcd439a7789fb47d764974ab646fa34d1790551de386457a8e/contourpy-1.3.0-pp310-pypy310_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:eca7e17a65f72a5133bdbec9ecf22401c62bcf4821361ef7811faee695799779", size = 311008, upload-time = "2024-08-27T20:57:15.588Z" },
+    { url = "https://files.pythonhosted.org/packages/74/fc/5040d42623a1845d4f17a418e590fd7a79ae8cb2bad2b2f83de63c3bdca4/contourpy-1.3.0-pp310-pypy310_pp73-win_amd64.whl", hash = "sha256:1ec4dc6bf570f5b22ed0d7efba0dfa9c5b9e0431aeea7581aa217542d9e809a4", size = 215690, upload-time = "2024-08-27T20:57:19.321Z" },
+    { url = "https://files.pythonhosted.org/packages/2b/24/dc3dcd77ac7460ab7e9d2b01a618cb31406902e50e605a8d6091f0a8f7cc/contourpy-1.3.0-pp39-pypy39_pp73-macosx_10_15_x86_64.whl", hash = "sha256:00ccd0dbaad6d804ab259820fa7cb0b8036bda0686ef844d24125d8287178ce0", size = 261894, upload-time = "2024-08-27T20:57:23.873Z" },
+    { url = "https://files.pythonhosted.org/packages/b1/db/531642a01cfec39d1682e46b5457b07cf805e3c3c584ec27e2a6223f8f6c/contourpy-1.3.0-pp39-pypy39_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:8ca947601224119117f7c19c9cdf6b3ab54c5726ef1d906aa4a69dfb6dd58102", size = 311099, upload-time = "2024-08-27T20:57:28.58Z" },
+    { url = "https://files.pythonhosted.org/packages/38/1e/94bda024d629f254143a134eead69e21c836429a2a6ce82209a00ddcb79a/contourpy-1.3.0-pp39-pypy39_pp73-win_amd64.whl", hash = "sha256:c6ec93afeb848a0845a18989da3beca3eec2c0f852322efe21af1931147d12cb", size = 215838, upload-time = "2024-08-27T20:57:32.913Z" },
+]
+
+[[package]]
+name = "contourpy"
+version = "1.3.2"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "numpy", version = "2.2.6", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.10.*'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/66/54/eb9bfc647b19f2009dd5c7f5ec51c4e6ca831725f1aea7a993034f483147/contourpy-1.3.2.tar.gz", hash = "sha256:b6945942715a034c671b7fc54f9588126b0b8bf23db2696e3ca8328f3ff0ab54", size = 13466130, upload-time = "2025-04-15T17:47:53.79Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/12/a3/da4153ec8fe25d263aa48c1a4cbde7f49b59af86f0b6f7862788c60da737/contourpy-1.3.2-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:ba38e3f9f330af820c4b27ceb4b9c7feee5fe0493ea53a8720f4792667465934", size = 268551, upload-time = "2025-04-15T17:34:46.581Z" },
+    { url = "https://files.pythonhosted.org/packages/2f/6c/330de89ae1087eb622bfca0177d32a7ece50c3ef07b28002de4757d9d875/contourpy-1.3.2-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:dc41ba0714aa2968d1f8674ec97504a8f7e334f48eeacebcaa6256213acb0989", size = 253399, upload-time = "2025-04-15T17:34:51.427Z" },
+    { url = "https://files.pythonhosted.org/packages/c1/bd/20c6726b1b7f81a8bee5271bed5c165f0a8e1f572578a9d27e2ccb763cb2/contourpy-1.3.2-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:9be002b31c558d1ddf1b9b415b162c603405414bacd6932d031c5b5a8b757f0d", size = 312061, upload-time = "2025-04-15T17:34:55.961Z" },
+    { url = "https://files.pythonhosted.org/packages/22/fc/a9665c88f8a2473f823cf1ec601de9e5375050f1958cbb356cdf06ef1ab6/contourpy-1.3.2-cp310-cp310-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:8d2e74acbcba3bfdb6d9d8384cdc4f9260cae86ed9beee8bd5f54fee49a430b9", size = 351956, upload-time = "2025-04-15T17:35:00.992Z" },
+    { url = "https://files.pythonhosted.org/packages/25/eb/9f0a0238f305ad8fb7ef42481020d6e20cf15e46be99a1fcf939546a177e/contourpy-1.3.2-cp310-cp310-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:e259bced5549ac64410162adc973c5e2fb77f04df4a439d00b478e57a0e65512", size = 320872, upload-time = "2025-04-15T17:35:06.177Z" },
+    { url = "https://files.pythonhosted.org/packages/32/5c/1ee32d1c7956923202f00cf8d2a14a62ed7517bdc0ee1e55301227fc273c/contourpy-1.3.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:ad687a04bc802cbe8b9c399c07162a3c35e227e2daccf1668eb1f278cb698631", size = 325027, upload-time = "2025-04-15T17:35:11.244Z" },
+    { url = "https://files.pythonhosted.org/packages/83/bf/9baed89785ba743ef329c2b07fd0611d12bfecbedbdd3eeecf929d8d3b52/contourpy-1.3.2-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:cdd22595308f53ef2f891040ab2b93d79192513ffccbd7fe19be7aa773a5e09f", size = 1306641, upload-time = "2025-04-15T17:35:26.701Z" },
+    { url = "https://files.pythonhosted.org/packages/d4/cc/74e5e83d1e35de2d28bd97033426b450bc4fd96e092a1f7a63dc7369b55d/contourpy-1.3.2-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:b4f54d6a2defe9f257327b0f243612dd051cc43825587520b1bf74a31e2f6ef2", size = 1374075, upload-time = "2025-04-15T17:35:43.204Z" },
+    { url = "https://files.pythonhosted.org/packages/0c/42/17f3b798fd5e033b46a16f8d9fcb39f1aba051307f5ebf441bad1ecf78f8/contourpy-1.3.2-cp310-cp310-win32.whl", hash = "sha256:f939a054192ddc596e031e50bb13b657ce318cf13d264f095ce9db7dc6ae81c0", size = 177534, upload-time = "2025-04-15T17:35:46.554Z" },
+    { url = "https://files.pythonhosted.org/packages/54/ec/5162b8582f2c994721018d0c9ece9dc6ff769d298a8ac6b6a652c307e7df/contourpy-1.3.2-cp310-cp310-win_amd64.whl", hash = "sha256:c440093bbc8fc21c637c03bafcbef95ccd963bc6e0514ad887932c18ca2a759a", size = 221188, upload-time = "2025-04-15T17:35:50.064Z" },
+    { url = "https://files.pythonhosted.org/packages/b3/b9/ede788a0b56fc5b071639d06c33cb893f68b1178938f3425debebe2dab78/contourpy-1.3.2-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:6a37a2fb93d4df3fc4c0e363ea4d16f83195fc09c891bc8ce072b9d084853445", size = 269636, upload-time = "2025-04-15T17:35:54.473Z" },
+    { url = "https://files.pythonhosted.org/packages/e6/75/3469f011d64b8bbfa04f709bfc23e1dd71be54d05b1b083be9f5b22750d1/contourpy-1.3.2-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:b7cd50c38f500bbcc9b6a46643a40e0913673f869315d8e70de0438817cb7773", size = 254636, upload-time = "2025-04-15T17:35:58.283Z" },
+    { url = "https://files.pythonhosted.org/packages/8d/2f/95adb8dae08ce0ebca4fd8e7ad653159565d9739128b2d5977806656fcd2/contourpy-1.3.2-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:d6658ccc7251a4433eebd89ed2672c2ed96fba367fd25ca9512aa92a4b46c4f1", size = 313053, upload-time = "2025-04-15T17:36:03.235Z" },
+    { url = "https://files.pythonhosted.org/packages/c3/a6/8ccf97a50f31adfa36917707fe39c9a0cbc24b3bbb58185577f119736cc9/contourpy-1.3.2-cp311-cp311-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:70771a461aaeb335df14deb6c97439973d253ae70660ca085eec25241137ef43", size = 352985, upload-time = "2025-04-15T17:36:08.275Z" },
+    { url = "https://files.pythonhosted.org/packages/1d/b6/7925ab9b77386143f39d9c3243fdd101621b4532eb126743201160ffa7e6/contourpy-1.3.2-cp311-cp311-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:65a887a6e8c4cd0897507d814b14c54a8c2e2aa4ac9f7686292f9769fcf9a6ab", size = 323750, upload-time = "2025-04-15T17:36:13.29Z" },
+    { url = "https://files.pythonhosted.org/packages/c2/f3/20c5d1ef4f4748e52d60771b8560cf00b69d5c6368b5c2e9311bcfa2a08b/contourpy-1.3.2-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:3859783aefa2b8355697f16642695a5b9792e7a46ab86da1118a4a23a51a33d7", size = 326246, upload-time = "2025-04-15T17:36:18.329Z" },
+    { url = "https://files.pythonhosted.org/packages/8c/e5/9dae809e7e0b2d9d70c52b3d24cba134dd3dad979eb3e5e71f5df22ed1f5/contourpy-1.3.2-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:eab0f6db315fa4d70f1d8ab514e527f0366ec021ff853d7ed6a2d33605cf4b83", size = 1308728, upload-time = "2025-04-15T17:36:33.878Z" },
+    { url = "https://files.pythonhosted.org/packages/e2/4a/0058ba34aeea35c0b442ae61a4f4d4ca84d6df8f91309bc2d43bb8dd248f/contourpy-1.3.2-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:d91a3ccc7fea94ca0acab82ceb77f396d50a1f67412efe4c526f5d20264e6ecd", size = 1375762, upload-time = "2025-04-15T17:36:51.295Z" },
+    { url = "https://files.pythonhosted.org/packages/09/33/7174bdfc8b7767ef2c08ed81244762d93d5c579336fc0b51ca57b33d1b80/contourpy-1.3.2-cp311-cp311-win32.whl", hash = "sha256:1c48188778d4d2f3d48e4643fb15d8608b1d01e4b4d6b0548d9b336c28fc9b6f", size = 178196, upload-time = "2025-04-15T17:36:55.002Z" },
+    { url = "https://files.pythonhosted.org/packages/5e/fe/4029038b4e1c4485cef18e480b0e2cd2d755448bb071eb9977caac80b77b/contourpy-1.3.2-cp311-cp311-win_amd64.whl", hash = "sha256:5ebac872ba09cb8f2131c46b8739a7ff71de28a24c869bcad554477eb089a878", size = 222017, upload-time = "2025-04-15T17:36:58.576Z" },
+    { url = "https://files.pythonhosted.org/packages/34/f7/44785876384eff370c251d58fd65f6ad7f39adce4a093c934d4a67a7c6b6/contourpy-1.3.2-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:4caf2bcd2969402bf77edc4cb6034c7dd7c0803213b3523f111eb7460a51b8d2", size = 271580, upload-time = "2025-04-15T17:37:03.105Z" },
+    { url = "https://files.pythonhosted.org/packages/93/3b/0004767622a9826ea3d95f0e9d98cd8729015768075d61f9fea8eeca42a8/contourpy-1.3.2-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:82199cb78276249796419fe36b7386bd8d2cc3f28b3bc19fe2454fe2e26c4c15", size = 255530, upload-time = "2025-04-15T17:37:07.026Z" },
+    { url = "https://files.pythonhosted.org/packages/e7/bb/7bd49e1f4fa805772d9fd130e0d375554ebc771ed7172f48dfcd4ca61549/contourpy-1.3.2-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:106fab697af11456fcba3e352ad50effe493a90f893fca6c2ca5c033820cea92", size = 307688, upload-time = "2025-04-15T17:37:11.481Z" },
+    { url = "https://files.pythonhosted.org/packages/fc/97/e1d5dbbfa170725ef78357a9a0edc996b09ae4af170927ba8ce977e60a5f/contourpy-1.3.2-cp312-cp312-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:d14f12932a8d620e307f715857107b1d1845cc44fdb5da2bc8e850f5ceba9f87", size = 347331, upload-time = "2025-04-15T17:37:18.212Z" },
+    { url = "https://files.pythonhosted.org/packages/6f/66/e69e6e904f5ecf6901be3dd16e7e54d41b6ec6ae3405a535286d4418ffb4/contourpy-1.3.2-cp312-cp312-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:532fd26e715560721bb0d5fc7610fce279b3699b018600ab999d1be895b09415", size = 318963, upload-time = "2025-04-15T17:37:22.76Z" },
+    { url = "https://files.pythonhosted.org/packages/a8/32/b8a1c8965e4f72482ff2d1ac2cd670ce0b542f203c8e1d34e7c3e6925da7/contourpy-1.3.2-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:f26b383144cf2d2c29f01a1e8170f50dacf0eac02d64139dcd709a8ac4eb3cfe", size = 323681, upload-time = "2025-04-15T17:37:33.001Z" },
+    { url = "https://files.pythonhosted.org/packages/30/c6/12a7e6811d08757c7162a541ca4c5c6a34c0f4e98ef2b338791093518e40/contourpy-1.3.2-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:c49f73e61f1f774650a55d221803b101d966ca0c5a2d6d5e4320ec3997489441", size = 1308674, upload-time = "2025-04-15T17:37:48.64Z" },
+    { url = "https://files.pythonhosted.org/packages/2a/8a/bebe5a3f68b484d3a2b8ffaf84704b3e343ef1addea528132ef148e22b3b/contourpy-1.3.2-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:3d80b2c0300583228ac98d0a927a1ba6a2ba6b8a742463c564f1d419ee5b211e", size = 1380480, upload-time = "2025-04-15T17:38:06.7Z" },
+    { url = "https://files.pythonhosted.org/packages/34/db/fcd325f19b5978fb509a7d55e06d99f5f856294c1991097534360b307cf1/contourpy-1.3.2-cp312-cp312-win32.whl", hash = "sha256:90df94c89a91b7362e1142cbee7568f86514412ab8a2c0d0fca72d7e91b62912", size = 178489, upload-time = "2025-04-15T17:38:10.338Z" },
+    { url = "https://files.pythonhosted.org/packages/01/c8/fadd0b92ffa7b5eb5949bf340a63a4a496a6930a6c37a7ba0f12acb076d6/contourpy-1.3.2-cp312-cp312-win_amd64.whl", hash = "sha256:8c942a01d9163e2e5cfb05cb66110121b8d07ad438a17f9e766317bcb62abf73", size = 223042, upload-time = "2025-04-15T17:38:14.239Z" },
+    { url = "https://files.pythonhosted.org/packages/2e/61/5673f7e364b31e4e7ef6f61a4b5121c5f170f941895912f773d95270f3a2/contourpy-1.3.2-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:de39db2604ae755316cb5967728f4bea92685884b1e767b7c24e983ef5f771cb", size = 271630, upload-time = "2025-04-15T17:38:19.142Z" },
+    { url = "https://files.pythonhosted.org/packages/ff/66/a40badddd1223822c95798c55292844b7e871e50f6bfd9f158cb25e0bd39/contourpy-1.3.2-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:3f9e896f447c5c8618f1edb2bafa9a4030f22a575ec418ad70611450720b5b08", size = 255670, upload-time = "2025-04-15T17:38:23.688Z" },
+    { url = "https://files.pythonhosted.org/packages/1e/c7/cf9fdee8200805c9bc3b148f49cb9482a4e3ea2719e772602a425c9b09f8/contourpy-1.3.2-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:71e2bd4a1c4188f5c2b8d274da78faab884b59df20df63c34f74aa1813c4427c", size = 306694, upload-time = "2025-04-15T17:38:28.238Z" },
+    { url = "https://files.pythonhosted.org/packages/dd/e7/ccb9bec80e1ba121efbffad7f38021021cda5be87532ec16fd96533bb2e0/contourpy-1.3.2-cp313-cp313-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:de425af81b6cea33101ae95ece1f696af39446db9682a0b56daaa48cfc29f38f", size = 345986, upload-time = "2025-04-15T17:38:33.502Z" },
+    { url = "https://files.pythonhosted.org/packages/dc/49/ca13bb2da90391fa4219fdb23b078d6065ada886658ac7818e5441448b78/contourpy-1.3.2-cp313-cp313-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:977e98a0e0480d3fe292246417239d2d45435904afd6d7332d8455981c408b85", size = 318060, upload-time = "2025-04-15T17:38:38.672Z" },
+    { url = "https://files.pythonhosted.org/packages/c8/65/5245ce8c548a8422236c13ffcdcdada6a2a812c361e9e0c70548bb40b661/contourpy-1.3.2-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:434f0adf84911c924519d2b08fc10491dd282b20bdd3fa8f60fd816ea0b48841", size = 322747, upload-time = "2025-04-15T17:38:43.712Z" },
+    { url = "https://files.pythonhosted.org/packages/72/30/669b8eb48e0a01c660ead3752a25b44fdb2e5ebc13a55782f639170772f9/contourpy-1.3.2-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:c66c4906cdbc50e9cba65978823e6e00b45682eb09adbb78c9775b74eb222422", size = 1308895, upload-time = "2025-04-15T17:39:00.224Z" },
+    { url = "https://files.pythonhosted.org/packages/05/5a/b569f4250decee6e8d54498be7bdf29021a4c256e77fe8138c8319ef8eb3/contourpy-1.3.2-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:8b7fc0cd78ba2f4695fd0a6ad81a19e7e3ab825c31b577f384aa9d7817dc3bef", size = 1379098, upload-time = "2025-04-15T17:43:29.649Z" },
+    { url = "https://files.pythonhosted.org/packages/19/ba/b227c3886d120e60e41b28740ac3617b2f2b971b9f601c835661194579f1/contourpy-1.3.2-cp313-cp313-win32.whl", hash = "sha256:15ce6ab60957ca74cff444fe66d9045c1fd3e92c8936894ebd1f3eef2fff075f", size = 178535, upload-time = "2025-04-15T17:44:44.532Z" },
+    { url = "https://files.pythonhosted.org/packages/12/6e/2fed56cd47ca739b43e892707ae9a13790a486a3173be063681ca67d2262/contourpy-1.3.2-cp313-cp313-win_amd64.whl", hash = "sha256:e1578f7eafce927b168752ed7e22646dad6cd9bca673c60bff55889fa236ebf9", size = 223096, upload-time = "2025-04-15T17:44:48.194Z" },
+    { url = "https://files.pythonhosted.org/packages/54/4c/e76fe2a03014a7c767d79ea35c86a747e9325537a8b7627e0e5b3ba266b4/contourpy-1.3.2-cp313-cp313t-macosx_10_13_x86_64.whl", hash = "sha256:0475b1f6604896bc7c53bb070e355e9321e1bc0d381735421a2d2068ec56531f", size = 285090, upload-time = "2025-04-15T17:43:34.084Z" },
+    { url = "https://files.pythonhosted.org/packages/7b/e2/5aba47debd55d668e00baf9651b721e7733975dc9fc27264a62b0dd26eb8/contourpy-1.3.2-cp313-cp313t-macosx_11_0_arm64.whl", hash = "sha256:c85bb486e9be652314bb5b9e2e3b0d1b2e643d5eec4992c0fbe8ac71775da739", size = 268643, upload-time = "2025-04-15T17:43:38.626Z" },
+    { url = "https://files.pythonhosted.org/packages/a1/37/cd45f1f051fe6230f751cc5cdd2728bb3a203f5619510ef11e732109593c/contourpy-1.3.2-cp313-cp313t-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:745b57db7758f3ffc05a10254edd3182a2a83402a89c00957a8e8a22f5582823", size = 310443, upload-time = "2025-04-15T17:43:44.522Z" },
+    { url = "https://files.pythonhosted.org/packages/8b/a2/36ea6140c306c9ff6dd38e3bcec80b3b018474ef4d17eb68ceecd26675f4/contourpy-1.3.2-cp313-cp313t-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:970e9173dbd7eba9b4e01aab19215a48ee5dd3f43cef736eebde064a171f89a5", size = 349865, upload-time = "2025-04-15T17:43:49.545Z" },
+    { url = "https://files.pythonhosted.org/packages/95/b7/2fc76bc539693180488f7b6cc518da7acbbb9e3b931fd9280504128bf956/contourpy-1.3.2-cp313-cp313t-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:c6c4639a9c22230276b7bffb6a850dfc8258a2521305e1faefe804d006b2e532", size = 321162, upload-time = "2025-04-15T17:43:54.203Z" },
+    { url = "https://files.pythonhosted.org/packages/f4/10/76d4f778458b0aa83f96e59d65ece72a060bacb20cfbee46cf6cd5ceba41/contourpy-1.3.2-cp313-cp313t-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:cc829960f34ba36aad4302e78eabf3ef16a3a100863f0d4eeddf30e8a485a03b", size = 327355, upload-time = "2025-04-15T17:44:01.025Z" },
+    { url = "https://files.pythonhosted.org/packages/43/a3/10cf483ea683f9f8ab096c24bad3cce20e0d1dd9a4baa0e2093c1c962d9d/contourpy-1.3.2-cp313-cp313t-musllinux_1_2_aarch64.whl", hash = "sha256:d32530b534e986374fc19eaa77fcb87e8a99e5431499949b828312bdcd20ac52", size = 1307935, upload-time = "2025-04-15T17:44:17.322Z" },
+    { url = "https://files.pythonhosted.org/packages/78/73/69dd9a024444489e22d86108e7b913f3528f56cfc312b5c5727a44188471/contourpy-1.3.2-cp313-cp313t-musllinux_1_2_x86_64.whl", hash = "sha256:e298e7e70cf4eb179cc1077be1c725b5fd131ebc81181bf0c03525c8abc297fd", size = 1372168, upload-time = "2025-04-15T17:44:33.43Z" },
+    { url = "https://files.pythonhosted.org/packages/0f/1b/96d586ccf1b1a9d2004dd519b25fbf104a11589abfd05484ff12199cca21/contourpy-1.3.2-cp313-cp313t-win32.whl", hash = "sha256:d0e589ae0d55204991450bb5c23f571c64fe43adaa53f93fc902a84c96f52fe1", size = 189550, upload-time = "2025-04-15T17:44:37.092Z" },
+    { url = "https://files.pythonhosted.org/packages/b0/e6/6000d0094e8a5e32ad62591c8609e269febb6e4db83a1c75ff8868b42731/contourpy-1.3.2-cp313-cp313t-win_amd64.whl", hash = "sha256:78e9253c3de756b3f6a5174d024c4835acd59eb3f8e2ca13e775dbffe1558f69", size = 238214, upload-time = "2025-04-15T17:44:40.827Z" },
+    { url = "https://files.pythonhosted.org/packages/33/05/b26e3c6ecc05f349ee0013f0bb850a761016d89cec528a98193a48c34033/contourpy-1.3.2-pp310-pypy310_pp73-macosx_10_15_x86_64.whl", hash = "sha256:fd93cc7f3139b6dd7aab2f26a90dde0aa9fc264dbf70f6740d498a70b860b82c", size = 265681, upload-time = "2025-04-15T17:44:59.314Z" },
+    { url = "https://files.pythonhosted.org/packages/2b/25/ac07d6ad12affa7d1ffed11b77417d0a6308170f44ff20fa1d5aa6333f03/contourpy-1.3.2-pp310-pypy310_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:107ba8a6a7eec58bb475329e6d3b95deba9440667c4d62b9b6063942b61d7f16", size = 315101, upload-time = "2025-04-15T17:45:04.165Z" },
+    { url = "https://files.pythonhosted.org/packages/8f/4d/5bb3192bbe9d3f27e3061a6a8e7733c9120e203cb8515767d30973f71030/contourpy-1.3.2-pp310-pypy310_pp73-win_amd64.whl", hash = "sha256:ded1706ed0c1049224531b81128efbd5084598f18d8a2d9efae833edbd2b40ad", size = 220599, upload-time = "2025-04-15T17:45:08.456Z" },
+    { url = "https://files.pythonhosted.org/packages/ff/c0/91f1215d0d9f9f343e4773ba6c9b89e8c0cc7a64a6263f21139da639d848/contourpy-1.3.2-pp311-pypy311_pp73-macosx_10_15_x86_64.whl", hash = "sha256:5f5964cdad279256c084b69c3f412b7801e15356b16efa9d78aa974041903da0", size = 266807, upload-time = "2025-04-15T17:45:15.535Z" },
+    { url = "https://files.pythonhosted.org/packages/d4/79/6be7e90c955c0487e7712660d6cead01fa17bff98e0ea275737cc2bc8e71/contourpy-1.3.2-pp311-pypy311_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:49b65a95d642d4efa8f64ba12558fcb83407e58a2dfba9d796d77b63ccfcaff5", size = 318729, upload-time = "2025-04-15T17:45:20.166Z" },
+    { url = "https://files.pythonhosted.org/packages/87/68/7f46fb537958e87427d98a4074bcde4b67a70b04900cfc5ce29bc2f556c1/contourpy-1.3.2-pp311-pypy311_pp73-win_amd64.whl", hash = "sha256:8c5acb8dddb0752bf252e01a3035b21443158910ac16a3b0d20e7fed7d534ce5", size = 221791, upload-time = "2025-04-15T17:45:24.794Z" },
+]
+
+[[package]]
+name = "contourpy"
+version = "1.3.3"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "numpy", version = "2.3.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.11'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/58/01/1253e6698a07380cd31a736d248a3f2a50a7c88779a1813da27503cadc2a/contourpy-1.3.3.tar.gz", hash = "sha256:083e12155b210502d0bca491432bb04d56dc3432f95a979b429f2848c3dbe880", size = 13466174, upload-time = "2025-07-26T12:03:12.549Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/91/2e/c4390a31919d8a78b90e8ecf87cd4b4c4f05a5b48d05ec17db8e5404c6f4/contourpy-1.3.3-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:709a48ef9a690e1343202916450bc48b9e51c049b089c7f79a267b46cffcdaa1", size = 288773, upload-time = "2025-07-26T12:01:02.277Z" },
+    { url = "https://files.pythonhosted.org/packages/0d/44/c4b0b6095fef4dc9c420e041799591e3b63e9619e3044f7f4f6c21c0ab24/contourpy-1.3.3-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:23416f38bfd74d5d28ab8429cc4d63fa67d5068bd711a85edb1c3fb0c3e2f381", size = 270149, upload-time = "2025-07-26T12:01:04.072Z" },
+    { url = "https://files.pythonhosted.org/packages/30/2e/dd4ced42fefac8470661d7cb7e264808425e6c5d56d175291e93890cce09/contourpy-1.3.3-cp311-cp311-manylinux_2_26_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:929ddf8c4c7f348e4c0a5a3a714b5c8542ffaa8c22954862a46ca1813b667ee7", size = 329222, upload-time = "2025-07-26T12:01:05.688Z" },
+    { url = "https://files.pythonhosted.org/packages/f2/74/cc6ec2548e3d276c71389ea4802a774b7aa3558223b7bade3f25787fafc2/contourpy-1.3.3-cp311-cp311-manylinux_2_26_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:9e999574eddae35f1312c2b4b717b7885d4edd6cb46700e04f7f02db454e67c1", size = 377234, upload-time = "2025-07-26T12:01:07.054Z" },
+    { url = "https://files.pythonhosted.org/packages/03/b3/64ef723029f917410f75c09da54254c5f9ea90ef89b143ccadb09df14c15/contourpy-1.3.3-cp311-cp311-manylinux_2_26_s390x.manylinux_2_28_s390x.whl", hash = "sha256:0bf67e0e3f482cb69779dd3061b534eb35ac9b17f163d851e2a547d56dba0a3a", size = 380555, upload-time = "2025-07-26T12:01:08.801Z" },
+    { url = "https://files.pythonhosted.org/packages/5f/4b/6157f24ca425b89fe2eb7e7be642375711ab671135be21e6faa100f7448c/contourpy-1.3.3-cp311-cp311-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:51e79c1f7470158e838808d4a996fa9bac72c498e93d8ebe5119bc1e6becb0db", size = 355238, upload-time = "2025-07-26T12:01:10.319Z" },
+    { url = "https://files.pythonhosted.org/packages/98/56/f914f0dd678480708a04cfd2206e7c382533249bc5001eb9f58aa693e200/contourpy-1.3.3-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:598c3aaece21c503615fd59c92a3598b428b2f01bfb4b8ca9c4edeecc2438620", size = 1326218, upload-time = "2025-07-26T12:01:12.659Z" },
+    { url = "https://files.pythonhosted.org/packages/fb/d7/4a972334a0c971acd5172389671113ae82aa7527073980c38d5868ff1161/contourpy-1.3.3-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:322ab1c99b008dad206d406bb61d014cf0174df491ae9d9d0fac6a6fda4f977f", size = 1392867, upload-time = "2025-07-26T12:01:15.533Z" },
+    { url = "https://files.pythonhosted.org/packages/75/3e/f2cc6cd56dc8cff46b1a56232eabc6feea52720083ea71ab15523daab796/contourpy-1.3.3-cp311-cp311-win32.whl", hash = "sha256:fd907ae12cd483cd83e414b12941c632a969171bf90fc937d0c9f268a31cafff", size = 183677, upload-time = "2025-07-26T12:01:17.088Z" },
+    { url = "https://files.pythonhosted.org/packages/98/4b/9bd370b004b5c9d8045c6c33cf65bae018b27aca550a3f657cdc99acdbd8/contourpy-1.3.3-cp311-cp311-win_amd64.whl", hash = "sha256:3519428f6be58431c56581f1694ba8e50626f2dd550af225f82fb5f5814d2a42", size = 225234, upload-time = "2025-07-26T12:01:18.256Z" },
+    { url = "https://files.pythonhosted.org/packages/d9/b6/71771e02c2e004450c12b1120a5f488cad2e4d5b590b1af8bad060360fe4/contourpy-1.3.3-cp311-cp311-win_arm64.whl", hash = "sha256:15ff10bfada4bf92ec8b31c62bf7c1834c244019b4a33095a68000d7075df470", size = 193123, upload-time = "2025-07-26T12:01:19.848Z" },
+    { url = "https://files.pythonhosted.org/packages/be/45/adfee365d9ea3d853550b2e735f9d66366701c65db7855cd07621732ccfc/contourpy-1.3.3-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:b08a32ea2f8e42cf1d4be3169a98dd4be32bafe4f22b6c4cb4ba810fa9e5d2cb", size = 293419, upload-time = "2025-07-26T12:01:21.16Z" },
+    { url = "https://files.pythonhosted.org/packages/53/3e/405b59cfa13021a56bba395a6b3aca8cec012b45bf177b0eaf7a202cde2c/contourpy-1.3.3-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:556dba8fb6f5d8742f2923fe9457dbdd51e1049c4a43fd3986a0b14a1d815fc6", size = 273979, upload-time = "2025-07-26T12:01:22.448Z" },
+    { url = "https://files.pythonhosted.org/packages/d4/1c/a12359b9b2ca3a845e8f7f9ac08bdf776114eb931392fcad91743e2ea17b/contourpy-1.3.3-cp312-cp312-manylinux_2_26_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:92d9abc807cf7d0e047b95ca5d957cf4792fcd04e920ca70d48add15c1a90ea7", size = 332653, upload-time = "2025-07-26T12:01:24.155Z" },
+    { url = "https://files.pythonhosted.org/packages/63/12/897aeebfb475b7748ea67b61e045accdfcf0d971f8a588b67108ed7f5512/contourpy-1.3.3-cp312-cp312-manylinux_2_26_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:b2e8faa0ed68cb29af51edd8e24798bb661eac3bd9f65420c1887b6ca89987c8", size = 379536, upload-time = "2025-07-26T12:01:25.91Z" },
+    { url = "https://files.pythonhosted.org/packages/43/8a/a8c584b82deb248930ce069e71576fc09bd7174bbd35183b7943fb1064fd/contourpy-1.3.3-cp312-cp312-manylinux_2_26_s390x.manylinux_2_28_s390x.whl", hash = "sha256:626d60935cf668e70a5ce6ff184fd713e9683fb458898e4249b63be9e28286ea", size = 384397, upload-time = "2025-07-26T12:01:27.152Z" },
+    { url = "https://files.pythonhosted.org/packages/cc/8f/ec6289987824b29529d0dfda0d74a07cec60e54b9c92f3c9da4c0ac732de/contourpy-1.3.3-cp312-cp312-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:4d00e655fcef08aba35ec9610536bfe90267d7ab5ba944f7032549c55a146da1", size = 362601, upload-time = "2025-07-26T12:01:28.808Z" },
+    { url = "https://files.pythonhosted.org/packages/05/0a/a3fe3be3ee2dceb3e615ebb4df97ae6f3828aa915d3e10549ce016302bd1/contourpy-1.3.3-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:451e71b5a7d597379ef572de31eeb909a87246974d960049a9848c3bc6c41bf7", size = 1331288, upload-time = "2025-07-26T12:01:31.198Z" },
+    { url = "https://files.pythonhosted.org/packages/33/1d/acad9bd4e97f13f3e2b18a3977fe1b4a37ecf3d38d815333980c6c72e963/contourpy-1.3.3-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:459c1f020cd59fcfe6650180678a9993932d80d44ccde1fa1868977438f0b411", size = 1403386, upload-time = "2025-07-26T12:01:33.947Z" },
+    { url = "https://files.pythonhosted.org/packages/cf/8f/5847f44a7fddf859704217a99a23a4f6417b10e5ab1256a179264561540e/contourpy-1.3.3-cp312-cp312-win32.whl", hash = "sha256:023b44101dfe49d7d53932be418477dba359649246075c996866106da069af69", size = 185018, upload-time = "2025-07-26T12:01:35.64Z" },
+    { url = "https://files.pythonhosted.org/packages/19/e8/6026ed58a64563186a9ee3f29f41261fd1828f527dd93d33b60feca63352/contourpy-1.3.3-cp312-cp312-win_amd64.whl", hash = "sha256:8153b8bfc11e1e4d75bcb0bff1db232f9e10b274e0929de9d608027e0d34ff8b", size = 226567, upload-time = "2025-07-26T12:01:36.804Z" },
+    { url = "https://files.pythonhosted.org/packages/d1/e2/f05240d2c39a1ed228d8328a78b6f44cd695f7ef47beb3e684cf93604f86/contourpy-1.3.3-cp312-cp312-win_arm64.whl", hash = "sha256:07ce5ed73ecdc4a03ffe3e1b3e3c1166db35ae7584be76f65dbbe28a7791b0cc", size = 193655, upload-time = "2025-07-26T12:01:37.999Z" },
+    { url = "https://files.pythonhosted.org/packages/68/35/0167aad910bbdb9599272bd96d01a9ec6852f36b9455cf2ca67bd4cc2d23/contourpy-1.3.3-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:177fb367556747a686509d6fef71d221a4b198a3905fe824430e5ea0fda54eb5", size = 293257, upload-time = "2025-07-26T12:01:39.367Z" },
+    { url = "https://files.pythonhosted.org/packages/96/e4/7adcd9c8362745b2210728f209bfbcf7d91ba868a2c5f40d8b58f54c509b/contourpy-1.3.3-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:d002b6f00d73d69333dac9d0b8d5e84d9724ff9ef044fd63c5986e62b7c9e1b1", size = 274034, upload-time = "2025-07-26T12:01:40.645Z" },
+    { url = "https://files.pythonhosted.org/packages/73/23/90e31ceeed1de63058a02cb04b12f2de4b40e3bef5e082a7c18d9c8ae281/contourpy-1.3.3-cp313-cp313-manylinux_2_26_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:348ac1f5d4f1d66d3322420f01d42e43122f43616e0f194fc1c9f5d830c5b286", size = 334672, upload-time = "2025-07-26T12:01:41.942Z" },
+    { url = "https://files.pythonhosted.org/packages/ed/93/b43d8acbe67392e659e1d984700e79eb67e2acb2bd7f62012b583a7f1b55/contourpy-1.3.3-cp313-cp313-manylinux_2_26_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:655456777ff65c2c548b7c454af9c6f33f16c8884f11083244b5819cc214f1b5", size = 381234, upload-time = "2025-07-26T12:01:43.499Z" },
+    { url = "https://files.pythonhosted.org/packages/46/3b/bec82a3ea06f66711520f75a40c8fc0b113b2a75edb36aa633eb11c4f50f/contourpy-1.3.3-cp313-cp313-manylinux_2_26_s390x.manylinux_2_28_s390x.whl", hash = "sha256:644a6853d15b2512d67881586bd03f462c7ab755db95f16f14d7e238f2852c67", size = 385169, upload-time = "2025-07-26T12:01:45.219Z" },
+    { url = "https://files.pythonhosted.org/packages/4b/32/e0f13a1c5b0f8572d0ec6ae2f6c677b7991fafd95da523159c19eff0696a/contourpy-1.3.3-cp313-cp313-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:4debd64f124ca62069f313a9cb86656ff087786016d76927ae2cf37846b006c9", size = 362859, upload-time = "2025-07-26T12:01:46.519Z" },
+    { url = "https://files.pythonhosted.org/packages/33/71/e2a7945b7de4e58af42d708a219f3b2f4cff7386e6b6ab0a0fa0033c49a9/contourpy-1.3.3-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:a15459b0f4615b00bbd1e91f1b9e19b7e63aea7483d03d804186f278c0af2659", size = 1332062, upload-time = "2025-07-26T12:01:48.964Z" },
+    { url = "https://files.pythonhosted.org/packages/12/fc/4e87ac754220ccc0e807284f88e943d6d43b43843614f0a8afa469801db0/contourpy-1.3.3-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:ca0fdcd73925568ca027e0b17ab07aad764be4706d0a925b89227e447d9737b7", size = 1403932, upload-time = "2025-07-26T12:01:51.979Z" },
+    { url = "https://files.pythonhosted.org/packages/a6/2e/adc197a37443f934594112222ac1aa7dc9a98faf9c3842884df9a9d8751d/contourpy-1.3.3-cp313-cp313-win32.whl", hash = "sha256:b20c7c9a3bf701366556e1b1984ed2d0cedf999903c51311417cf5f591d8c78d", size = 185024, upload-time = "2025-07-26T12:01:53.245Z" },
+    { url = "https://files.pythonhosted.org/packages/18/0b/0098c214843213759692cc638fce7de5c289200a830e5035d1791d7a2338/contourpy-1.3.3-cp313-cp313-win_amd64.whl", hash = "sha256:1cadd8b8969f060ba45ed7c1b714fe69185812ab43bd6b86a9123fe8f99c3263", size = 226578, upload-time = "2025-07-26T12:01:54.422Z" },
+    { url = "https://files.pythonhosted.org/packages/8a/9a/2f6024a0c5995243cd63afdeb3651c984f0d2bc727fd98066d40e141ad73/contourpy-1.3.3-cp313-cp313-win_arm64.whl", hash = "sha256:fd914713266421b7536de2bfa8181aa8c699432b6763a0ea64195ebe28bff6a9", size = 193524, upload-time = "2025-07-26T12:01:55.73Z" },
+    { url = "https://files.pythonhosted.org/packages/c0/b3/f8a1a86bd3298513f500e5b1f5fd92b69896449f6cab6a146a5d52715479/contourpy-1.3.3-cp313-cp313t-macosx_10_13_x86_64.whl", hash = "sha256:88df9880d507169449d434c293467418b9f6cbe82edd19284aa0409e7fdb933d", size = 306730, upload-time = "2025-07-26T12:01:57.051Z" },
+    { url = "https://files.pythonhosted.org/packages/3f/11/4780db94ae62fc0c2053909b65dc3246bd7cecfc4f8a20d957ad43aa4ad8/contourpy-1.3.3-cp313-cp313t-macosx_11_0_arm64.whl", hash = "sha256:d06bb1f751ba5d417047db62bca3c8fde202b8c11fb50742ab3ab962c81e8216", size = 287897, upload-time = "2025-07-26T12:01:58.663Z" },
+    { url = "https://files.pythonhosted.org/packages/ae/15/e59f5f3ffdd6f3d4daa3e47114c53daabcb18574a26c21f03dc9e4e42ff0/contourpy-1.3.3-cp313-cp313t-manylinux_2_26_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:e4e6b05a45525357e382909a4c1600444e2a45b4795163d3b22669285591c1ae", size = 326751, upload-time = "2025-07-26T12:02:00.343Z" },
+    { url = "https://files.pythonhosted.org/packages/0f/81/03b45cfad088e4770b1dcf72ea78d3802d04200009fb364d18a493857210/contourpy-1.3.3-cp313-cp313t-manylinux_2_26_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:ab3074b48c4e2cf1a960e6bbeb7f04566bf36b1861d5c9d4d8ac04b82e38ba20", size = 375486, upload-time = "2025-07-26T12:02:02.128Z" },
+    { url = "https://files.pythonhosted.org/packages/0c/ba/49923366492ffbdd4486e970d421b289a670ae8cf539c1ea9a09822b371a/contourpy-1.3.3-cp313-cp313t-manylinux_2_26_s390x.manylinux_2_28_s390x.whl", hash = "sha256:6c3d53c796f8647d6deb1abe867daeb66dcc8a97e8455efa729516b997b8ed99", size = 388106, upload-time = "2025-07-26T12:02:03.615Z" },
+    { url = "https://files.pythonhosted.org/packages/9f/52/5b00ea89525f8f143651f9f03a0df371d3cbd2fccd21ca9b768c7a6500c2/contourpy-1.3.3-cp313-cp313t-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:50ed930df7289ff2a8d7afeb9603f8289e5704755c7e5c3bbd929c90c817164b", size = 352548, upload-time = "2025-07-26T12:02:05.165Z" },
+    { url = "https://files.pythonhosted.org/packages/32/1d/a209ec1a3a3452d490f6b14dd92e72280c99ae3d1e73da74f8277d4ee08f/contourpy-1.3.3-cp313-cp313t-musllinux_1_2_aarch64.whl", hash = "sha256:4feffb6537d64b84877da813a5c30f1422ea5739566abf0bd18065ac040e120a", size = 1322297, upload-time = "2025-07-26T12:02:07.379Z" },
+    { url = "https://files.pythonhosted.org/packages/bc/9e/46f0e8ebdd884ca0e8877e46a3f4e633f6c9c8c4f3f6e72be3fe075994aa/contourpy-1.3.3-cp313-cp313t-musllinux_1_2_x86_64.whl", hash = "sha256:2b7e9480ffe2b0cd2e787e4df64270e3a0440d9db8dc823312e2c940c167df7e", size = 1391023, upload-time = "2025-07-26T12:02:10.171Z" },
+    { url = "https://files.pythonhosted.org/packages/b9/70/f308384a3ae9cd2209e0849f33c913f658d3326900d0ff5d378d6a1422d2/contourpy-1.3.3-cp313-cp313t-win32.whl", hash = "sha256:283edd842a01e3dcd435b1c5116798d661378d83d36d337b8dde1d16a5fc9ba3", size = 196157, upload-time = "2025-07-26T12:02:11.488Z" },
+    { url = "https://files.pythonhosted.org/packages/b2/dd/880f890a6663b84d9e34a6f88cded89d78f0091e0045a284427cb6b18521/contourpy-1.3.3-cp313-cp313t-win_amd64.whl", hash = "sha256:87acf5963fc2b34825e5b6b048f40e3635dd547f590b04d2ab317c2619ef7ae8", size = 240570, upload-time = "2025-07-26T12:02:12.754Z" },
+    { url = "https://files.pythonhosted.org/packages/80/99/2adc7d8ffead633234817ef8e9a87115c8a11927a94478f6bb3d3f4d4f7d/contourpy-1.3.3-cp313-cp313t-win_arm64.whl", hash = "sha256:3c30273eb2a55024ff31ba7d052dde990d7d8e5450f4bbb6e913558b3d6c2301", size = 199713, upload-time = "2025-07-26T12:02:14.4Z" },
+    { url = "https://files.pythonhosted.org/packages/72/8b/4546f3ab60f78c514ffb7d01a0bd743f90de36f0019d1be84d0a708a580a/contourpy-1.3.3-cp314-cp314-macosx_10_13_x86_64.whl", hash = "sha256:fde6c716d51c04b1c25d0b90364d0be954624a0ee9d60e23e850e8d48353d07a", size = 292189, upload-time = "2025-07-26T12:02:16.095Z" },
+    { url = "https://files.pythonhosted.org/packages/fd/e1/3542a9cb596cadd76fcef413f19c79216e002623158befe6daa03dbfa88c/contourpy-1.3.3-cp314-cp314-macosx_11_0_arm64.whl", hash = "sha256:cbedb772ed74ff5be440fa8eee9bd49f64f6e3fc09436d9c7d8f1c287b121d77", size = 273251, upload-time = "2025-07-26T12:02:17.524Z" },
+    { url = "https://files.pythonhosted.org/packages/b1/71/f93e1e9471d189f79d0ce2497007731c1e6bf9ef6d1d61b911430c3db4e5/contourpy-1.3.3-cp314-cp314-manylinux_2_26_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:22e9b1bd7a9b1d652cd77388465dc358dafcd2e217d35552424aa4f996f524f5", size = 335810, upload-time = "2025-07-26T12:02:18.9Z" },
+    { url = "https://files.pythonhosted.org/packages/91/f9/e35f4c1c93f9275d4e38681a80506b5510e9327350c51f8d4a5a724d178c/contourpy-1.3.3-cp314-cp314-manylinux_2_26_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:a22738912262aa3e254e4f3cb079a95a67132fc5a063890e224393596902f5a4", size = 382871, upload-time = "2025-07-26T12:02:20.418Z" },
+    { url = "https://files.pythonhosted.org/packages/b5/71/47b512f936f66a0a900d81c396a7e60d73419868fba959c61efed7a8ab46/contourpy-1.3.3-cp314-cp314-manylinux_2_26_s390x.manylinux_2_28_s390x.whl", hash = "sha256:afe5a512f31ee6bd7d0dda52ec9864c984ca3d66664444f2d72e0dc4eb832e36", size = 386264, upload-time = "2025-07-26T12:02:21.916Z" },
+    { url = "https://files.pythonhosted.org/packages/04/5f/9ff93450ba96b09c7c2b3f81c94de31c89f92292f1380261bd7195bea4ea/contourpy-1.3.3-cp314-cp314-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:f64836de09927cba6f79dcd00fdd7d5329f3fccc633468507079c829ca4db4e3", size = 363819, upload-time = "2025-07-26T12:02:23.759Z" },
+    { url = "https://files.pythonhosted.org/packages/3e/a6/0b185d4cc480ee494945cde102cb0149ae830b5fa17bf855b95f2e70ad13/contourpy-1.3.3-cp314-cp314-musllinux_1_2_aarch64.whl", hash = "sha256:1fd43c3be4c8e5fd6e4f2baeae35ae18176cf2e5cced681cca908addf1cdd53b", size = 1333650, upload-time = "2025-07-26T12:02:26.181Z" },
+    { url = "https://files.pythonhosted.org/packages/43/d7/afdc95580ca56f30fbcd3060250f66cedbde69b4547028863abd8aa3b47e/contourpy-1.3.3-cp314-cp314-musllinux_1_2_x86_64.whl", hash = "sha256:6afc576f7b33cf00996e5c1102dc2a8f7cc89e39c0b55df93a0b78c1bd992b36", size = 1404833, upload-time = "2025-07-26T12:02:28.782Z" },
+    { url = "https://files.pythonhosted.org/packages/e2/e2/366af18a6d386f41132a48f033cbd2102e9b0cf6345d35ff0826cd984566/contourpy-1.3.3-cp314-cp314-win32.whl", hash = "sha256:66c8a43a4f7b8df8b71ee1840e4211a3c8d93b214b213f590e18a1beca458f7d", size = 189692, upload-time = "2025-07-26T12:02:30.128Z" },
+    { url = "https://files.pythonhosted.org/packages/7d/c2/57f54b03d0f22d4044b8afb9ca0e184f8b1afd57b4f735c2fa70883dc601/contourpy-1.3.3-cp314-cp314-win_amd64.whl", hash = "sha256:cf9022ef053f2694e31d630feaacb21ea24224be1c3ad0520b13d844274614fd", size = 232424, upload-time = "2025-07-26T12:02:31.395Z" },
+    { url = "https://files.pythonhosted.org/packages/18/79/a9416650df9b525737ab521aa181ccc42d56016d2123ddcb7b58e926a42c/contourpy-1.3.3-cp314-cp314-win_arm64.whl", hash = "sha256:95b181891b4c71de4bb404c6621e7e2390745f887f2a026b2d99e92c17892339", size = 198300, upload-time = "2025-07-26T12:02:32.956Z" },
+    { url = "https://files.pythonhosted.org/packages/1f/42/38c159a7d0f2b7b9c04c64ab317042bb6952b713ba875c1681529a2932fe/contourpy-1.3.3-cp314-cp314t-macosx_10_13_x86_64.whl", hash = "sha256:33c82d0138c0a062380332c861387650c82e4cf1747aaa6938b9b6516762e772", size = 306769, upload-time = "2025-07-26T12:02:34.2Z" },
+    { url = "https://files.pythonhosted.org/packages/c3/6c/26a8205f24bca10974e77460de68d3d7c63e282e23782f1239f226fcae6f/contourpy-1.3.3-cp314-cp314t-macosx_11_0_arm64.whl", hash = "sha256:ea37e7b45949df430fe649e5de8351c423430046a2af20b1c1961cae3afcda77", size = 287892, upload-time = "2025-07-26T12:02:35.807Z" },
+    { url = "https://files.pythonhosted.org/packages/66/06/8a475c8ab718ebfd7925661747dbb3c3ee9c82ac834ccb3570be49d129f4/contourpy-1.3.3-cp314-cp314t-manylinux_2_26_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:d304906ecc71672e9c89e87c4675dc5c2645e1f4269a5063b99b0bb29f232d13", size = 326748, upload-time = "2025-07-26T12:02:37.193Z" },
+    { url = "https://files.pythonhosted.org/packages/b4/a3/c5ca9f010a44c223f098fccd8b158bb1cb287378a31ac141f04730dc49be/contourpy-1.3.3-cp314-cp314t-manylinux_2_26_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:ca658cd1a680a5c9ea96dc61cdbae1e85c8f25849843aa799dfd3cb370ad4fbe", size = 375554, upload-time = "2025-07-26T12:02:38.894Z" },
+    { url = "https://files.pythonhosted.org/packages/80/5b/68bd33ae63fac658a4145088c1e894405e07584a316738710b636c6d0333/contourpy-1.3.3-cp314-cp314t-manylinux_2_26_s390x.manylinux_2_28_s390x.whl", hash = "sha256:ab2fd90904c503739a75b7c8c5c01160130ba67944a7b77bbf36ef8054576e7f", size = 388118, upload-time = "2025-07-26T12:02:40.642Z" },
+    { url = "https://files.pythonhosted.org/packages/40/52/4c285a6435940ae25d7410a6c36bda5145839bc3f0beb20c707cda18b9d2/contourpy-1.3.3-cp314-cp314t-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:b7301b89040075c30e5768810bc96a8e8d78085b47d8be6e4c3f5a0b4ed478a0", size = 352555, upload-time = "2025-07-26T12:02:42.25Z" },
+    { url = "https://files.pythonhosted.org/packages/24/ee/3e81e1dd174f5c7fefe50e85d0892de05ca4e26ef1c9a59c2a57e43b865a/contourpy-1.3.3-cp314-cp314t-musllinux_1_2_aarch64.whl", hash = "sha256:2a2a8b627d5cc6b7c41a4beff6c5ad5eb848c88255fda4a8745f7e901b32d8e4", size = 1322295, upload-time = "2025-07-26T12:02:44.668Z" },
+    { url = "https://files.pythonhosted.org/packages/3c/b2/6d913d4d04e14379de429057cd169e5e00f6c2af3bb13e1710bcbdb5da12/contourpy-1.3.3-cp314-cp314t-musllinux_1_2_x86_64.whl", hash = "sha256:fd6ec6be509c787f1caf6b247f0b1ca598bef13f4ddeaa126b7658215529ba0f", size = 1391027, upload-time = "2025-07-26T12:02:47.09Z" },
+    { url = "https://files.pythonhosted.org/packages/93/8a/68a4ec5c55a2971213d29a9374913f7e9f18581945a7a31d1a39b5d2dfe5/contourpy-1.3.3-cp314-cp314t-win32.whl", hash = "sha256:e74a9a0f5e3fff48fb5a7f2fd2b9b70a3fe014a67522f79b7cca4c0c7e43c9ae", size = 202428, upload-time = "2025-07-26T12:02:48.691Z" },
+    { url = "https://files.pythonhosted.org/packages/fa/96/fd9f641ffedc4fa3ace923af73b9d07e869496c9cc7a459103e6e978992f/contourpy-1.3.3-cp314-cp314t-win_amd64.whl", hash = "sha256:13b68d6a62db8eafaebb8039218921399baf6e47bf85006fd8529f2a08ef33fc", size = 250331, upload-time = "2025-07-26T12:02:50.137Z" },
+    { url = "https://files.pythonhosted.org/packages/ae/8c/469afb6465b853afff216f9528ffda78a915ff880ed58813ba4faf4ba0b6/contourpy-1.3.3-cp314-cp314t-win_arm64.whl", hash = "sha256:b7448cb5a725bb1e35ce88771b86fba35ef418952474492cf7c764059933ff8b", size = 203831, upload-time = "2025-07-26T12:02:51.449Z" },
+    { url = "https://files.pythonhosted.org/packages/a5/29/8dcfe16f0107943fa92388c23f6e05cff0ba58058c4c95b00280d4c75a14/contourpy-1.3.3-pp311-pypy311_pp73-macosx_10_15_x86_64.whl", hash = "sha256:cd5dfcaeb10f7b7f9dc8941717c6c2ade08f587be2226222c12b25f0483ed497", size = 278809, upload-time = "2025-07-26T12:02:52.74Z" },
+    { url = "https://files.pythonhosted.org/packages/85/a9/8b37ef4f7dafeb335daee3c8254645ef5725be4d9c6aa70b50ec46ef2f7e/contourpy-1.3.3-pp311-pypy311_pp73-macosx_11_0_arm64.whl", hash = "sha256:0c1fc238306b35f246d61a1d416a627348b5cf0648648a031e14bb8705fcdfe8", size = 261593, upload-time = "2025-07-26T12:02:54.037Z" },
+    { url = "https://files.pythonhosted.org/packages/0a/59/ebfb8c677c75605cc27f7122c90313fd2f375ff3c8d19a1694bda74aaa63/contourpy-1.3.3-pp311-pypy311_pp73-manylinux_2_26_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:70f9aad7de812d6541d29d2bbf8feb22ff7e1c299523db288004e3157ff4674e", size = 302202, upload-time = "2025-07-26T12:02:55.947Z" },
+    { url = "https://files.pythonhosted.org/packages/3c/37/21972a15834d90bfbfb009b9d004779bd5a07a0ec0234e5ba8f64d5736f4/contourpy-1.3.3-pp311-pypy311_pp73-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:5ed3657edf08512fc3fe81b510e35c2012fbd3081d2e26160f27ca28affec989", size = 329207, upload-time = "2025-07-26T12:02:57.468Z" },
+    { url = "https://files.pythonhosted.org/packages/0c/58/bd257695f39d05594ca4ad60df5bcb7e32247f9951fd09a9b8edb82d1daa/contourpy-1.3.3-pp311-pypy311_pp73-win_amd64.whl", hash = "sha256:3d1a3799d62d45c18bafd41c5fa05120b96a28079f2393af559b843d1a966a77", size = 225315, upload-time = "2025-07-26T12:02:58.801Z" },
+]
+
+[[package]]
+name = "coverage"
+version = "7.6.1"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/f7/08/7e37f82e4d1aead42a7443ff06a1e406aabf7302c4f00a546e4b320b994c/coverage-7.6.1.tar.gz", hash = "sha256:953510dfb7b12ab69d20135a0662397f077c59b1e6379a768e97c59d852ee51d", size = 798791, upload-time = "2024-08-04T19:45:30.9Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/7e/61/eb7ce5ed62bacf21beca4937a90fe32545c91a3c8a42a30c6616d48fc70d/coverage-7.6.1-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:b06079abebbc0e89e6163b8e8f0e16270124c154dc6e4a47b413dd538859af16", size = 206690, upload-time = "2024-08-04T19:43:07.695Z" },
+    { url = "https://files.pythonhosted.org/packages/7d/73/041928e434442bd3afde5584bdc3f932fb4562b1597629f537387cec6f3d/coverage-7.6.1-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:cf4b19715bccd7ee27b6b120e7e9dd56037b9c0681dcc1adc9ba9db3d417fa36", size = 207127, upload-time = "2024-08-04T19:43:10.15Z" },
+    { url = "https://files.pythonhosted.org/packages/c7/c8/6ca52b5147828e45ad0242388477fdb90df2c6cbb9a441701a12b3c71bc8/coverage-7.6.1-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:e61c0abb4c85b095a784ef23fdd4aede7a2628478e7baba7c5e3deba61070a02", size = 235654, upload-time = "2024-08-04T19:43:12.405Z" },
+    { url = "https://files.pythonhosted.org/packages/d5/da/9ac2b62557f4340270942011d6efeab9833648380109e897d48ab7c1035d/coverage-7.6.1-cp310-cp310-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:fd21f6ae3f08b41004dfb433fa895d858f3f5979e7762d052b12aef444e29afc", size = 233598, upload-time = "2024-08-04T19:43:14.078Z" },
+    { url = "https://files.pythonhosted.org/packages/53/23/9e2c114d0178abc42b6d8d5281f651a8e6519abfa0ef460a00a91f80879d/coverage-7.6.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:8f59d57baca39b32db42b83b2a7ba6f47ad9c394ec2076b084c3f029b7afca23", size = 234732, upload-time = "2024-08-04T19:43:16.632Z" },
+    { url = "https://files.pythonhosted.org/packages/0f/7e/a0230756fb133343a52716e8b855045f13342b70e48e8ad41d8a0d60ab98/coverage-7.6.1-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:a1ac0ae2b8bd743b88ed0502544847c3053d7171a3cff9228af618a068ed9c34", size = 233816, upload-time = "2024-08-04T19:43:19.049Z" },
+    { url = "https://files.pythonhosted.org/packages/28/7c/3753c8b40d232b1e5eeaed798c875537cf3cb183fb5041017c1fdb7ec14e/coverage-7.6.1-cp310-cp310-musllinux_1_2_i686.whl", hash = "sha256:e6a08c0be454c3b3beb105c0596ebdc2371fab6bb90c0c0297f4e58fd7e1012c", size = 232325, upload-time = "2024-08-04T19:43:21.246Z" },
+    { url = "https://files.pythonhosted.org/packages/57/e3/818a2b2af5b7573b4b82cf3e9f137ab158c90ea750a8f053716a32f20f06/coverage-7.6.1-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:f5796e664fe802da4f57a168c85359a8fbf3eab5e55cd4e4569fbacecc903959", size = 233418, upload-time = "2024-08-04T19:43:22.945Z" },
+    { url = "https://files.pythonhosted.org/packages/c8/fb/4532b0b0cefb3f06d201648715e03b0feb822907edab3935112b61b885e2/coverage-7.6.1-cp310-cp310-win32.whl", hash = "sha256:7bb65125fcbef8d989fa1dd0e8a060999497629ca5b0efbca209588a73356232", size = 209343, upload-time = "2024-08-04T19:43:25.121Z" },
+    { url = "https://files.pythonhosted.org/packages/5a/25/af337cc7421eca1c187cc9c315f0a755d48e755d2853715bfe8c418a45fa/coverage-7.6.1-cp310-cp310-win_amd64.whl", hash = "sha256:3115a95daa9bdba70aea750db7b96b37259a81a709223c8448fa97727d546fe0", size = 210136, upload-time = "2024-08-04T19:43:26.851Z" },
+    { url = "https://files.pythonhosted.org/packages/ad/5f/67af7d60d7e8ce61a4e2ddcd1bd5fb787180c8d0ae0fbd073f903b3dd95d/coverage-7.6.1-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:7dea0889685db8550f839fa202744652e87c60015029ce3f60e006f8c4462c93", size = 206796, upload-time = "2024-08-04T19:43:29.115Z" },
+    { url = "https://files.pythonhosted.org/packages/e1/0e/e52332389e057daa2e03be1fbfef25bb4d626b37d12ed42ae6281d0a274c/coverage-7.6.1-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:ed37bd3c3b063412f7620464a9ac1314d33100329f39799255fb8d3027da50d3", size = 207244, upload-time = "2024-08-04T19:43:31.285Z" },
+    { url = "https://files.pythonhosted.org/packages/aa/cd/766b45fb6e090f20f8927d9c7cb34237d41c73a939358bc881883fd3a40d/coverage-7.6.1-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:d85f5e9a5f8b73e2350097c3756ef7e785f55bd71205defa0bfdaf96c31616ff", size = 239279, upload-time = "2024-08-04T19:43:33.581Z" },
+    { url = "https://files.pythonhosted.org/packages/70/6c/a9ccd6fe50ddaf13442a1e2dd519ca805cbe0f1fcd377fba6d8339b98ccb/coverage-7.6.1-cp311-cp311-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:9bc572be474cafb617672c43fe989d6e48d3c83af02ce8de73fff1c6bb3c198d", size = 236859, upload-time = "2024-08-04T19:43:35.301Z" },
+    { url = "https://files.pythonhosted.org/packages/14/6f/8351b465febb4dbc1ca9929505202db909c5a635c6fdf33e089bbc3d7d85/coverage-7.6.1-cp311-cp311-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:0c0420b573964c760df9e9e86d1a9a622d0d27f417e1a949a8a66dd7bcee7bc6", size = 238549, upload-time = "2024-08-04T19:43:37.578Z" },
+    { url = "https://files.pythonhosted.org/packages/68/3c/289b81fa18ad72138e6d78c4c11a82b5378a312c0e467e2f6b495c260907/coverage-7.6.1-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:1f4aa8219db826ce6be7099d559f8ec311549bfc4046f7f9fe9b5cea5c581c56", size = 237477, upload-time = "2024-08-04T19:43:39.92Z" },
+    { url = "https://files.pythonhosted.org/packages/ed/1c/aa1efa6459d822bd72c4abc0b9418cf268de3f60eeccd65dc4988553bd8d/coverage-7.6.1-cp311-cp311-musllinux_1_2_i686.whl", hash = "sha256:fc5a77d0c516700ebad189b587de289a20a78324bc54baee03dd486f0855d234", size = 236134, upload-time = "2024-08-04T19:43:41.453Z" },
+    { url = "https://files.pythonhosted.org/packages/fb/c8/521c698f2d2796565fe9c789c2ee1ccdae610b3aa20b9b2ef980cc253640/coverage-7.6.1-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:b48f312cca9621272ae49008c7f613337c53fadca647d6384cc129d2996d1133", size = 236910, upload-time = "2024-08-04T19:43:43.037Z" },
+    { url = "https://files.pythonhosted.org/packages/7d/30/033e663399ff17dca90d793ee8a2ea2890e7fdf085da58d82468b4220bf7/coverage-7.6.1-cp311-cp311-win32.whl", hash = "sha256:1125ca0e5fd475cbbba3bb67ae20bd2c23a98fac4e32412883f9bcbaa81c314c", size = 209348, upload-time = "2024-08-04T19:43:44.787Z" },
+    { url = "https://files.pythonhosted.org/packages/20/05/0d1ccbb52727ccdadaa3ff37e4d2dc1cd4d47f0c3df9eb58d9ec8508ca88/coverage-7.6.1-cp311-cp311-win_amd64.whl", hash = "sha256:8ae539519c4c040c5ffd0632784e21b2f03fc1340752af711f33e5be83a9d6c6", size = 210230, upload-time = "2024-08-04T19:43:46.707Z" },
+    { url = "https://files.pythonhosted.org/packages/7e/d4/300fc921dff243cd518c7db3a4c614b7e4b2431b0d1145c1e274fd99bd70/coverage-7.6.1-cp312-cp312-macosx_10_9_x86_64.whl", hash = "sha256:95cae0efeb032af8458fc27d191f85d1717b1d4e49f7cb226cf526ff28179778", size = 206983, upload-time = "2024-08-04T19:43:49.082Z" },
+    { url = "https://files.pythonhosted.org/packages/e1/ab/6bf00de5327ecb8db205f9ae596885417a31535eeda6e7b99463108782e1/coverage-7.6.1-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:5621a9175cf9d0b0c84c2ef2b12e9f5f5071357c4d2ea6ca1cf01814f45d2391", size = 207221, upload-time = "2024-08-04T19:43:52.15Z" },
+    { url = "https://files.pythonhosted.org/packages/92/8f/2ead05e735022d1a7f3a0a683ac7f737de14850395a826192f0288703472/coverage-7.6.1-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:260933720fdcd75340e7dbe9060655aff3af1f0c5d20f46b57f262ab6c86a5e8", size = 240342, upload-time = "2024-08-04T19:43:53.746Z" },
+    { url = "https://files.pythonhosted.org/packages/0f/ef/94043e478201ffa85b8ae2d2c79b4081e5a1b73438aafafccf3e9bafb6b5/coverage-7.6.1-cp312-cp312-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:07e2ca0ad381b91350c0ed49d52699b625aab2b44b65e1b4e02fa9df0e92ad2d", size = 237371, upload-time = "2024-08-04T19:43:55.993Z" },
+    { url = "https://files.pythonhosted.org/packages/1f/0f/c890339dd605f3ebc269543247bdd43b703cce6825b5ed42ff5f2d6122c7/coverage-7.6.1-cp312-cp312-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:c44fee9975f04b33331cb8eb272827111efc8930cfd582e0320613263ca849ca", size = 239455, upload-time = "2024-08-04T19:43:57.618Z" },
+    { url = "https://files.pythonhosted.org/packages/d1/04/7fd7b39ec7372a04efb0f70c70e35857a99b6a9188b5205efb4c77d6a57a/coverage-7.6.1-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:877abb17e6339d96bf08e7a622d05095e72b71f8afd8a9fefc82cf30ed944163", size = 238924, upload-time = "2024-08-04T19:44:00.012Z" },
+    { url = "https://files.pythonhosted.org/packages/ed/bf/73ce346a9d32a09cf369f14d2a06651329c984e106f5992c89579d25b27e/coverage-7.6.1-cp312-cp312-musllinux_1_2_i686.whl", hash = "sha256:3e0cadcf6733c09154b461f1ca72d5416635e5e4ec4e536192180d34ec160f8a", size = 237252, upload-time = "2024-08-04T19:44:01.713Z" },
+    { url = "https://files.pythonhosted.org/packages/86/74/1dc7a20969725e917b1e07fe71a955eb34bc606b938316bcc799f228374b/coverage-7.6.1-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:c3c02d12f837d9683e5ab2f3d9844dc57655b92c74e286c262e0fc54213c216d", size = 238897, upload-time = "2024-08-04T19:44:03.898Z" },
+    { url = "https://files.pythonhosted.org/packages/b6/e9/d9cc3deceb361c491b81005c668578b0dfa51eed02cd081620e9a62f24ec/coverage-7.6.1-cp312-cp312-win32.whl", hash = "sha256:e05882b70b87a18d937ca6768ff33cc3f72847cbc4de4491c8e73880766718e5", size = 209606, upload-time = "2024-08-04T19:44:05.532Z" },
+    { url = "https://files.pythonhosted.org/packages/47/c8/5a2e41922ea6740f77d555c4d47544acd7dc3f251fe14199c09c0f5958d3/coverage-7.6.1-cp312-cp312-win_amd64.whl", hash = "sha256:b5d7b556859dd85f3a541db6a4e0167b86e7273e1cdc973e5b175166bb634fdb", size = 210373, upload-time = "2024-08-04T19:44:07.079Z" },
+    { url = "https://files.pythonhosted.org/packages/8c/f9/9aa4dfb751cb01c949c990d136a0f92027fbcc5781c6e921df1cb1563f20/coverage-7.6.1-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:a4acd025ecc06185ba2b801f2de85546e0b8ac787cf9d3b06e7e2a69f925b106", size = 207007, upload-time = "2024-08-04T19:44:09.453Z" },
+    { url = "https://files.pythonhosted.org/packages/b9/67/e1413d5a8591622a46dd04ff80873b04c849268831ed5c304c16433e7e30/coverage-7.6.1-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:a6d3adcf24b624a7b778533480e32434a39ad8fa30c315208f6d3e5542aeb6e9", size = 207269, upload-time = "2024-08-04T19:44:11.045Z" },
+    { url = "https://files.pythonhosted.org/packages/14/5b/9dec847b305e44a5634d0fb8498d135ab1d88330482b74065fcec0622224/coverage-7.6.1-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:d0c212c49b6c10e6951362f7c6df3329f04c2b1c28499563d4035d964ab8e08c", size = 239886, upload-time = "2024-08-04T19:44:12.83Z" },
+    { url = "https://files.pythonhosted.org/packages/7b/b7/35760a67c168e29f454928f51f970342d23cf75a2bb0323e0f07334c85f3/coverage-7.6.1-cp313-cp313-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:6e81d7a3e58882450ec4186ca59a3f20a5d4440f25b1cff6f0902ad890e6748a", size = 237037, upload-time = "2024-08-04T19:44:15.393Z" },
+    { url = "https://files.pythonhosted.org/packages/f7/95/d2fd31f1d638df806cae59d7daea5abf2b15b5234016a5ebb502c2f3f7ee/coverage-7.6.1-cp313-cp313-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:78b260de9790fd81e69401c2dc8b17da47c8038176a79092a89cb2b7d945d060", size = 239038, upload-time = "2024-08-04T19:44:17.466Z" },
+    { url = "https://files.pythonhosted.org/packages/6e/bd/110689ff5752b67924efd5e2aedf5190cbbe245fc81b8dec1abaffba619d/coverage-7.6.1-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:a78d169acd38300060b28d600344a803628c3fd585c912cacc9ea8790fe96862", size = 238690, upload-time = "2024-08-04T19:44:19.336Z" },
+    { url = "https://files.pythonhosted.org/packages/d3/a8/08d7b38e6ff8df52331c83130d0ab92d9c9a8b5462f9e99c9f051a4ae206/coverage-7.6.1-cp313-cp313-musllinux_1_2_i686.whl", hash = "sha256:2c09f4ce52cb99dd7505cd0fc8e0e37c77b87f46bc9c1eb03fe3bc9991085388", size = 236765, upload-time = "2024-08-04T19:44:20.994Z" },
+    { url = "https://files.pythonhosted.org/packages/d6/6a/9cf96839d3147d55ae713eb2d877f4d777e7dc5ba2bce227167d0118dfe8/coverage-7.6.1-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:6878ef48d4227aace338d88c48738a4258213cd7b74fd9a3d4d7582bb1d8a155", size = 238611, upload-time = "2024-08-04T19:44:22.616Z" },
+    { url = "https://files.pythonhosted.org/packages/74/e4/7ff20d6a0b59eeaab40b3140a71e38cf52547ba21dbcf1d79c5a32bba61b/coverage-7.6.1-cp313-cp313-win32.whl", hash = "sha256:44df346d5215a8c0e360307d46ffaabe0f5d3502c8a1cefd700b34baf31d411a", size = 209671, upload-time = "2024-08-04T19:44:24.418Z" },
+    { url = "https://files.pythonhosted.org/packages/35/59/1812f08a85b57c9fdb6d0b383d779e47b6f643bc278ed682859512517e83/coverage-7.6.1-cp313-cp313-win_amd64.whl", hash = "sha256:8284cf8c0dd272a247bc154eb6c95548722dce90d098c17a883ed36e67cdb129", size = 210368, upload-time = "2024-08-04T19:44:26.276Z" },
+    { url = "https://files.pythonhosted.org/packages/9c/15/08913be1c59d7562a3e39fce20661a98c0a3f59d5754312899acc6cb8a2d/coverage-7.6.1-cp313-cp313t-macosx_10_13_x86_64.whl", hash = "sha256:d3296782ca4eab572a1a4eca686d8bfb00226300dcefdf43faa25b5242ab8a3e", size = 207758, upload-time = "2024-08-04T19:44:29.028Z" },
+    { url = "https://files.pythonhosted.org/packages/c4/ae/b5d58dff26cade02ada6ca612a76447acd69dccdbb3a478e9e088eb3d4b9/coverage-7.6.1-cp313-cp313t-macosx_11_0_arm64.whl", hash = "sha256:502753043567491d3ff6d08629270127e0c31d4184c4c8d98f92c26f65019962", size = 208035, upload-time = "2024-08-04T19:44:30.673Z" },
+    { url = "https://files.pythonhosted.org/packages/b8/d7/62095e355ec0613b08dfb19206ce3033a0eedb6f4a67af5ed267a8800642/coverage-7.6.1-cp313-cp313t-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:6a89ecca80709d4076b95f89f308544ec8f7b4727e8a547913a35f16717856cb", size = 250839, upload-time = "2024-08-04T19:44:32.412Z" },
+    { url = "https://files.pythonhosted.org/packages/7c/1e/c2967cb7991b112ba3766df0d9c21de46b476d103e32bb401b1b2adf3380/coverage-7.6.1-cp313-cp313t-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:a318d68e92e80af8b00fa99609796fdbcdfef3629c77c6283566c6f02c6d6704", size = 246569, upload-time = "2024-08-04T19:44:34.547Z" },
+    { url = "https://files.pythonhosted.org/packages/8b/61/a7a6a55dd266007ed3b1df7a3386a0d760d014542d72f7c2c6938483b7bd/coverage-7.6.1-cp313-cp313t-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:13b0a73a0896988f053e4fbb7de6d93388e6dd292b0d87ee51d106f2c11b465b", size = 248927, upload-time = "2024-08-04T19:44:36.313Z" },
+    { url = "https://files.pythonhosted.org/packages/c8/fa/13a6f56d72b429f56ef612eb3bc5ce1b75b7ee12864b3bd12526ab794847/coverage-7.6.1-cp313-cp313t-musllinux_1_2_aarch64.whl", hash = "sha256:4421712dbfc5562150f7554f13dde997a2e932a6b5f352edcce948a815efee6f", size = 248401, upload-time = "2024-08-04T19:44:38.155Z" },
+    { url = "https://files.pythonhosted.org/packages/75/06/0429c652aa0fb761fc60e8c6b291338c9173c6aa0f4e40e1902345b42830/coverage-7.6.1-cp313-cp313t-musllinux_1_2_i686.whl", hash = "sha256:166811d20dfea725e2e4baa71fffd6c968a958577848d2131f39b60043400223", size = 246301, upload-time = "2024-08-04T19:44:39.883Z" },
+    { url = "https://files.pythonhosted.org/packages/52/76/1766bb8b803a88f93c3a2d07e30ffa359467810e5cbc68e375ebe6906efb/coverage-7.6.1-cp313-cp313t-musllinux_1_2_x86_64.whl", hash = "sha256:225667980479a17db1048cb2bf8bfb39b8e5be8f164b8f6628b64f78a72cf9d3", size = 247598, upload-time = "2024-08-04T19:44:41.59Z" },
+    { url = "https://files.pythonhosted.org/packages/66/8b/f54f8db2ae17188be9566e8166ac6df105c1c611e25da755738025708d54/coverage-7.6.1-cp313-cp313t-win32.whl", hash = "sha256:170d444ab405852903b7d04ea9ae9b98f98ab6d7e63e1115e82620807519797f", size = 210307, upload-time = "2024-08-04T19:44:43.301Z" },
+    { url = "https://files.pythonhosted.org/packages/9f/b0/e0dca6da9170aefc07515cce067b97178cefafb512d00a87a1c717d2efd5/coverage-7.6.1-cp313-cp313t-win_amd64.whl", hash = "sha256:b9f222de8cded79c49bf184bdbc06630d4c58eec9459b939b4a690c82ed05657", size = 211453, upload-time = "2024-08-04T19:44:45.677Z" },
+    { url = "https://files.pythonhosted.org/packages/81/d0/d9e3d554e38beea5a2e22178ddb16587dbcbe9a1ef3211f55733924bf7fa/coverage-7.6.1-cp38-cp38-macosx_10_9_x86_64.whl", hash = "sha256:6db04803b6c7291985a761004e9060b2bca08da6d04f26a7f2294b8623a0c1a0", size = 206674, upload-time = "2024-08-04T19:44:47.694Z" },
+    { url = "https://files.pythonhosted.org/packages/38/ea/cab2dc248d9f45b2b7f9f1f596a4d75a435cb364437c61b51d2eb33ceb0e/coverage-7.6.1-cp38-cp38-macosx_11_0_arm64.whl", hash = "sha256:f1adfc8ac319e1a348af294106bc6a8458a0f1633cc62a1446aebc30c5fa186a", size = 207101, upload-time = "2024-08-04T19:44:49.32Z" },
+    { url = "https://files.pythonhosted.org/packages/ca/6f/f82f9a500c7c5722368978a5390c418d2a4d083ef955309a8748ecaa8920/coverage-7.6.1-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:a95324a9de9650a729239daea117df21f4b9868ce32e63f8b650ebe6cef5595b", size = 236554, upload-time = "2024-08-04T19:44:51.631Z" },
+    { url = "https://files.pythonhosted.org/packages/a6/94/d3055aa33d4e7e733d8fa309d9adf147b4b06a82c1346366fc15a2b1d5fa/coverage-7.6.1-cp38-cp38-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:b43c03669dc4618ec25270b06ecd3ee4fa94c7f9b3c14bae6571ca00ef98b0d3", size = 234440, upload-time = "2024-08-04T19:44:53.464Z" },
+    { url = "https://files.pythonhosted.org/packages/e4/6e/885bcd787d9dd674de4a7d8ec83faf729534c63d05d51d45d4fa168f7102/coverage-7.6.1-cp38-cp38-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:8929543a7192c13d177b770008bc4e8119f2e1f881d563fc6b6305d2d0ebe9de", size = 235889, upload-time = "2024-08-04T19:44:55.165Z" },
+    { url = "https://files.pythonhosted.org/packages/f4/63/df50120a7744492710854860783d6819ff23e482dee15462c9a833cc428a/coverage-7.6.1-cp38-cp38-musllinux_1_2_aarch64.whl", hash = "sha256:a09ece4a69cf399510c8ab25e0950d9cf2b42f7b3cb0374f95d2e2ff594478a6", size = 235142, upload-time = "2024-08-04T19:44:57.269Z" },
+    { url = "https://files.pythonhosted.org/packages/3a/5d/9d0acfcded2b3e9ce1c7923ca52ccc00c78a74e112fc2aee661125b7843b/coverage-7.6.1-cp38-cp38-musllinux_1_2_i686.whl", hash = "sha256:9054a0754de38d9dbd01a46621636689124d666bad1936d76c0341f7d71bf569", size = 233805, upload-time = "2024-08-04T19:44:59.033Z" },
+    { url = "https://files.pythonhosted.org/packages/c4/56/50abf070cb3cd9b1dd32f2c88f083aab561ecbffbcd783275cb51c17f11d/coverage-7.6.1-cp38-cp38-musllinux_1_2_x86_64.whl", hash = "sha256:0dbde0f4aa9a16fa4d754356a8f2e36296ff4d83994b2c9d8398aa32f222f989", size = 234655, upload-time = "2024-08-04T19:45:01.398Z" },
+    { url = "https://files.pythonhosted.org/packages/25/ee/b4c246048b8485f85a2426ef4abab88e48c6e80c74e964bea5cd4cd4b115/coverage-7.6.1-cp38-cp38-win32.whl", hash = "sha256:da511e6ad4f7323ee5702e6633085fb76c2f893aaf8ce4c51a0ba4fc07580ea7", size = 209296, upload-time = "2024-08-04T19:45:03.819Z" },
+    { url = "https://files.pythonhosted.org/packages/5c/1c/96cf86b70b69ea2b12924cdf7cabb8ad10e6130eab8d767a1099fbd2a44f/coverage-7.6.1-cp38-cp38-win_amd64.whl", hash = "sha256:3f1156e3e8f2872197af3840d8ad307a9dd18e615dc64d9ee41696f287c57ad8", size = 210137, upload-time = "2024-08-04T19:45:06.25Z" },
+    { url = "https://files.pythonhosted.org/packages/19/d3/d54c5aa83268779d54c86deb39c1c4566e5d45c155369ca152765f8db413/coverage-7.6.1-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:abd5fd0db5f4dc9289408aaf34908072f805ff7792632250dcb36dc591d24255", size = 206688, upload-time = "2024-08-04T19:45:08.358Z" },
+    { url = "https://files.pythonhosted.org/packages/a5/fe/137d5dca72e4a258b1bc17bb04f2e0196898fe495843402ce826a7419fe3/coverage-7.6.1-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:547f45fa1a93154bd82050a7f3cddbc1a7a4dd2a9bf5cb7d06f4ae29fe94eaf8", size = 207120, upload-time = "2024-08-04T19:45:11.526Z" },
+    { url = "https://files.pythonhosted.org/packages/78/5b/a0a796983f3201ff5485323b225d7c8b74ce30c11f456017e23d8e8d1945/coverage-7.6.1-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:645786266c8f18a931b65bfcefdbf6952dd0dea98feee39bd188607a9d307ed2", size = 235249, upload-time = "2024-08-04T19:45:13.202Z" },
+    { url = "https://files.pythonhosted.org/packages/4e/e1/76089d6a5ef9d68f018f65411fcdaaeb0141b504587b901d74e8587606ad/coverage-7.6.1-cp39-cp39-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:9e0b2df163b8ed01d515807af24f63de04bebcecbd6c3bfeff88385789fdf75a", size = 233237, upload-time = "2024-08-04T19:45:14.961Z" },
+    { url = "https://files.pythonhosted.org/packages/9a/6f/eef79b779a540326fee9520e5542a8b428cc3bfa8b7c8f1022c1ee4fc66c/coverage-7.6.1-cp39-cp39-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:609b06f178fe8e9f89ef676532760ec0b4deea15e9969bf754b37f7c40326dbc", size = 234311, upload-time = "2024-08-04T19:45:16.924Z" },
+    { url = "https://files.pythonhosted.org/packages/75/e1/656d65fb126c29a494ef964005702b012f3498db1a30dd562958e85a4049/coverage-7.6.1-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:702855feff378050ae4f741045e19a32d57d19f3e0676d589df0575008ea5004", size = 233453, upload-time = "2024-08-04T19:45:18.672Z" },
+    { url = "https://files.pythonhosted.org/packages/68/6a/45f108f137941a4a1238c85f28fd9d048cc46b5466d6b8dda3aba1bb9d4f/coverage-7.6.1-cp39-cp39-musllinux_1_2_i686.whl", hash = "sha256:2bdb062ea438f22d99cba0d7829c2ef0af1d768d1e4a4f528087224c90b132cb", size = 231958, upload-time = "2024-08-04T19:45:20.63Z" },
+    { url = "https://files.pythonhosted.org/packages/9b/e7/47b809099168b8b8c72ae311efc3e88c8d8a1162b3ba4b8da3cfcdb85743/coverage-7.6.1-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:9c56863d44bd1c4fe2abb8a4d6f5371d197f1ac0ebdee542f07f35895fc07f36", size = 232938, upload-time = "2024-08-04T19:45:23.062Z" },
+    { url = "https://files.pythonhosted.org/packages/52/80/052222ba7058071f905435bad0ba392cc12006380731c37afaf3fe749b88/coverage-7.6.1-cp39-cp39-win32.whl", hash = "sha256:6e2cd258d7d927d09493c8df1ce9174ad01b381d4729a9d8d4e38670ca24774c", size = 209352, upload-time = "2024-08-04T19:45:25.042Z" },
+    { url = "https://files.pythonhosted.org/packages/b8/d8/1b92e0b3adcf384e98770a00ca095da1b5f7b483e6563ae4eb5e935d24a1/coverage-7.6.1-cp39-cp39-win_amd64.whl", hash = "sha256:06a737c882bd26d0d6ee7269b20b12f14a8704807a01056c80bb881a4b2ce6ca", size = 210153, upload-time = "2024-08-04T19:45:27.079Z" },
+    { url = "https://files.pythonhosted.org/packages/a5/2b/0354ed096bca64dc8e32a7cbcae28b34cb5ad0b1fe2125d6d99583313ac0/coverage-7.6.1-pp38.pp39.pp310-none-any.whl", hash = "sha256:e9a6e0eb86070e8ccaedfbd9d38fec54864f3125ab95419970575b42af7541df", size = 198926, upload-time = "2024-08-04T19:45:28.875Z" },
+]
+
+[package.optional-dependencies]
+toml = [
+    { name = "tomli", marker = "python_full_version < '3.9'" },
+]
+
+[[package]]
+name = "coverage"
+version = "7.10.7"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/51/26/d22c300112504f5f9a9fd2297ce33c35f3d353e4aeb987c8419453b2a7c2/coverage-7.10.7.tar.gz", hash = "sha256:f4ab143ab113be368a3e9b795f9cd7906c5ef407d6173fe9675a902e1fffc239", size = 827704, upload-time = "2025-09-21T20:03:56.815Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/e5/6c/3a3f7a46888e69d18abe3ccc6fe4cb16cccb1e6a2f99698931dafca489e6/coverage-7.10.7-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:fc04cc7a3db33664e0c2d10eb8990ff6b3536f6842c9590ae8da4c614b9ed05a", size = 217987, upload-time = "2025-09-21T20:00:57.218Z" },
+    { url = "https://files.pythonhosted.org/packages/03/94/952d30f180b1a916c11a56f5c22d3535e943aa22430e9e3322447e520e1c/coverage-7.10.7-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:e201e015644e207139f7e2351980feb7040e6f4b2c2978892f3e3789d1c125e5", size = 218388, upload-time = "2025-09-21T20:01:00.081Z" },
+    { url = "https://files.pythonhosted.org/packages/50/2b/9e0cf8ded1e114bcd8b2fd42792b57f1c4e9e4ea1824cde2af93a67305be/coverage-7.10.7-cp310-cp310-manylinux1_i686.manylinux_2_28_i686.manylinux_2_5_i686.whl", hash = "sha256:240af60539987ced2c399809bd34f7c78e8abe0736af91c3d7d0e795df633d17", size = 245148, upload-time = "2025-09-21T20:01:01.768Z" },
+    { url = "https://files.pythonhosted.org/packages/19/20/d0384ac06a6f908783d9b6aa6135e41b093971499ec488e47279f5b846e6/coverage-7.10.7-cp310-cp310-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:8421e088bc051361b01c4b3a50fd39a4b9133079a2229978d9d30511fd05231b", size = 246958, upload-time = "2025-09-21T20:01:03.355Z" },
+    { url = "https://files.pythonhosted.org/packages/60/83/5c283cff3d41285f8eab897651585db908a909c572bdc014bcfaf8a8b6ae/coverage-7.10.7-cp310-cp310-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:6be8ed3039ae7f7ac5ce058c308484787c86e8437e72b30bf5e88b8ea10f3c87", size = 248819, upload-time = "2025-09-21T20:01:04.968Z" },
+    { url = "https://files.pythonhosted.org/packages/60/22/02eb98fdc5ff79f423e990d877693e5310ae1eab6cb20ae0b0b9ac45b23b/coverage-7.10.7-cp310-cp310-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:e28299d9f2e889e6d51b1f043f58d5f997c373cc12e6403b90df95b8b047c13e", size = 245754, upload-time = "2025-09-21T20:01:06.321Z" },
+    { url = "https://files.pythonhosted.org/packages/b4/bc/25c83bcf3ad141b32cd7dc45485ef3c01a776ca3aa8ef0a93e77e8b5bc43/coverage-7.10.7-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:c4e16bd7761c5e454f4efd36f345286d6f7c5fa111623c355691e2755cae3b9e", size = 246860, upload-time = "2025-09-21T20:01:07.605Z" },
+    { url = "https://files.pythonhosted.org/packages/3c/b7/95574702888b58c0928a6e982038c596f9c34d52c5e5107f1eef729399b5/coverage-7.10.7-cp310-cp310-musllinux_1_2_i686.whl", hash = "sha256:b1c81d0e5e160651879755c9c675b974276f135558cf4ba79fee7b8413a515df", size = 244877, upload-time = "2025-09-21T20:01:08.829Z" },
+    { url = "https://files.pythonhosted.org/packages/47/b6/40095c185f235e085df0e0b158f6bd68cc6e1d80ba6c7721dc81d97ec318/coverage-7.10.7-cp310-cp310-musllinux_1_2_riscv64.whl", hash = "sha256:606cc265adc9aaedcc84f1f064f0e8736bc45814f15a357e30fca7ecc01504e0", size = 245108, upload-time = "2025-09-21T20:01:10.527Z" },
+    { url = "https://files.pythonhosted.org/packages/c8/50/4aea0556da7a4b93ec9168420d170b55e2eb50ae21b25062513d020c6861/coverage-7.10.7-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:10b24412692df990dbc34f8fb1b6b13d236ace9dfdd68df5b28c2e39cafbba13", size = 245752, upload-time = "2025-09-21T20:01:11.857Z" },
+    { url = "https://files.pythonhosted.org/packages/6a/28/ea1a84a60828177ae3b100cb6723838523369a44ec5742313ed7db3da160/coverage-7.10.7-cp310-cp310-win32.whl", hash = "sha256:b51dcd060f18c19290d9b8a9dd1e0181538df2ce0717f562fff6cf74d9fc0b5b", size = 220497, upload-time = "2025-09-21T20:01:13.459Z" },
+    { url = "https://files.pythonhosted.org/packages/fc/1a/a81d46bbeb3c3fd97b9602ebaa411e076219a150489bcc2c025f151bd52d/coverage-7.10.7-cp310-cp310-win_amd64.whl", hash = "sha256:3a622ac801b17198020f09af3eaf45666b344a0d69fc2a6ffe2ea83aeef1d807", size = 221392, upload-time = "2025-09-21T20:01:14.722Z" },
+    { url = "https://files.pythonhosted.org/packages/d2/5d/c1a17867b0456f2e9ce2d8d4708a4c3a089947d0bec9c66cdf60c9e7739f/coverage-7.10.7-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:a609f9c93113be646f44c2a0256d6ea375ad047005d7f57a5c15f614dc1b2f59", size = 218102, upload-time = "2025-09-21T20:01:16.089Z" },
+    { url = "https://files.pythonhosted.org/packages/54/f0/514dcf4b4e3698b9a9077f084429681bf3aad2b4a72578f89d7f643eb506/coverage-7.10.7-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:65646bb0359386e07639c367a22cf9b5bf6304e8630b565d0626e2bdf329227a", size = 218505, upload-time = "2025-09-21T20:01:17.788Z" },
+    { url = "https://files.pythonhosted.org/packages/20/f6/9626b81d17e2a4b25c63ac1b425ff307ecdeef03d67c9a147673ae40dc36/coverage-7.10.7-cp311-cp311-manylinux1_i686.manylinux_2_28_i686.manylinux_2_5_i686.whl", hash = "sha256:5f33166f0dfcce728191f520bd2692914ec70fac2713f6bf3ce59c3deacb4699", size = 248898, upload-time = "2025-09-21T20:01:19.488Z" },
+    { url = "https://files.pythonhosted.org/packages/b0/ef/bd8e719c2f7417ba03239052e099b76ea1130ac0cbb183ee1fcaa58aaff3/coverage-7.10.7-cp311-cp311-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:35f5e3f9e455bb17831876048355dca0f758b6df22f49258cb5a91da23ef437d", size = 250831, upload-time = "2025-09-21T20:01:20.817Z" },
+    { url = "https://files.pythonhosted.org/packages/a5/b6/bf054de41ec948b151ae2b79a55c107f5760979538f5fb80c195f2517718/coverage-7.10.7-cp311-cp311-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:4da86b6d62a496e908ac2898243920c7992499c1712ff7c2b6d837cc69d9467e", size = 252937, upload-time = "2025-09-21T20:01:22.171Z" },
+    { url = "https://files.pythonhosted.org/packages/0f/e5/3860756aa6f9318227443c6ce4ed7bf9e70bb7f1447a0353f45ac5c7974b/coverage-7.10.7-cp311-cp311-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:6b8b09c1fad947c84bbbc95eca841350fad9cbfa5a2d7ca88ac9f8d836c92e23", size = 249021, upload-time = "2025-09-21T20:01:23.907Z" },
+    { url = "https://files.pythonhosted.org/packages/26/0f/bd08bd042854f7fd07b45808927ebcce99a7ed0f2f412d11629883517ac2/coverage-7.10.7-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:4376538f36b533b46f8971d3a3e63464f2c7905c9800db97361c43a2b14792ab", size = 250626, upload-time = "2025-09-21T20:01:25.721Z" },
+    { url = "https://files.pythonhosted.org/packages/8e/a7/4777b14de4abcc2e80c6b1d430f5d51eb18ed1d75fca56cbce5f2db9b36e/coverage-7.10.7-cp311-cp311-musllinux_1_2_i686.whl", hash = "sha256:121da30abb574f6ce6ae09840dae322bef734480ceafe410117627aa54f76d82", size = 248682, upload-time = "2025-09-21T20:01:27.105Z" },
+    { url = "https://files.pythonhosted.org/packages/34/72/17d082b00b53cd45679bad682fac058b87f011fd8b9fe31d77f5f8d3a4e4/coverage-7.10.7-cp311-cp311-musllinux_1_2_riscv64.whl", hash = "sha256:88127d40df529336a9836870436fc2751c339fbaed3a836d42c93f3e4bd1d0a2", size = 248402, upload-time = "2025-09-21T20:01:28.629Z" },
+    { url = "https://files.pythonhosted.org/packages/81/7a/92367572eb5bdd6a84bfa278cc7e97db192f9f45b28c94a9ca1a921c3577/coverage-7.10.7-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:ba58bbcd1b72f136080c0bccc2400d66cc6115f3f906c499013d065ac33a4b61", size = 249320, upload-time = "2025-09-21T20:01:30.004Z" },
+    { url = "https://files.pythonhosted.org/packages/2f/88/a23cc185f6a805dfc4fdf14a94016835eeb85e22ac3a0e66d5e89acd6462/coverage-7.10.7-cp311-cp311-win32.whl", hash = "sha256:972b9e3a4094b053a4e46832b4bc829fc8a8d347160eb39d03f1690316a99c14", size = 220536, upload-time = "2025-09-21T20:01:32.184Z" },
+    { url = "https://files.pythonhosted.org/packages/fe/ef/0b510a399dfca17cec7bc2f05ad8bd78cf55f15c8bc9a73ab20c5c913c2e/coverage-7.10.7-cp311-cp311-win_amd64.whl", hash = "sha256:a7b55a944a7f43892e28ad4bc0561dfd5f0d73e605d1aa5c3c976b52aea121d2", size = 221425, upload-time = "2025-09-21T20:01:33.557Z" },
+    { url = "https://files.pythonhosted.org/packages/51/7f/023657f301a276e4ba1850f82749bc136f5a7e8768060c2e5d9744a22951/coverage-7.10.7-cp311-cp311-win_arm64.whl", hash = "sha256:736f227fb490f03c6488f9b6d45855f8e0fd749c007f9303ad30efab0e73c05a", size = 220103, upload-time = "2025-09-21T20:01:34.929Z" },
+    { url = "https://files.pythonhosted.org/packages/13/e4/eb12450f71b542a53972d19117ea5a5cea1cab3ac9e31b0b5d498df1bd5a/coverage-7.10.7-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:7bb3b9ddb87ef7725056572368040c32775036472d5a033679d1fa6c8dc08417", size = 218290, upload-time = "2025-09-21T20:01:36.455Z" },
+    { url = "https://files.pythonhosted.org/packages/37/66/593f9be12fc19fb36711f19a5371af79a718537204d16ea1d36f16bd78d2/coverage-7.10.7-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:18afb24843cbc175687225cab1138c95d262337f5473512010e46831aa0c2973", size = 218515, upload-time = "2025-09-21T20:01:37.982Z" },
+    { url = "https://files.pythonhosted.org/packages/66/80/4c49f7ae09cafdacc73fbc30949ffe77359635c168f4e9ff33c9ebb07838/coverage-7.10.7-cp312-cp312-manylinux1_i686.manylinux_2_28_i686.manylinux_2_5_i686.whl", hash = "sha256:399a0b6347bcd3822be369392932884b8216d0944049ae22925631a9b3d4ba4c", size = 250020, upload-time = "2025-09-21T20:01:39.617Z" },
+    { url = "https://files.pythonhosted.org/packages/a6/90/a64aaacab3b37a17aaedd83e8000142561a29eb262cede42d94a67f7556b/coverage-7.10.7-cp312-cp312-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:314f2c326ded3f4b09be11bc282eb2fc861184bc95748ae67b360ac962770be7", size = 252769, upload-time = "2025-09-21T20:01:41.341Z" },
+    { url = "https://files.pythonhosted.org/packages/98/2e/2dda59afd6103b342e096f246ebc5f87a3363b5412609946c120f4e7750d/coverage-7.10.7-cp312-cp312-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:c41e71c9cfb854789dee6fc51e46743a6d138b1803fab6cb860af43265b42ea6", size = 253901, upload-time = "2025-09-21T20:01:43.042Z" },
+    { url = "https://files.pythonhosted.org/packages/53/dc/8d8119c9051d50f3119bb4a75f29f1e4a6ab9415cd1fa8bf22fcc3fb3b5f/coverage-7.10.7-cp312-cp312-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:bc01f57ca26269c2c706e838f6422e2a8788e41b3e3c65e2f41148212e57cd59", size = 250413, upload-time = "2025-09-21T20:01:44.469Z" },
+    { url = "https://files.pythonhosted.org/packages/98/b3/edaff9c5d79ee4d4b6d3fe046f2b1d799850425695b789d491a64225d493/coverage-7.10.7-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:a6442c59a8ac8b85812ce33bc4d05bde3fb22321fa8294e2a5b487c3505f611b", size = 251820, upload-time = "2025-09-21T20:01:45.915Z" },
+    { url = "https://files.pythonhosted.org/packages/11/25/9a0728564bb05863f7e513e5a594fe5ffef091b325437f5430e8cfb0d530/coverage-7.10.7-cp312-cp312-musllinux_1_2_i686.whl", hash = "sha256:78a384e49f46b80fb4c901d52d92abe098e78768ed829c673fbb53c498bef73a", size = 249941, upload-time = "2025-09-21T20:01:47.296Z" },
+    { url = "https://files.pythonhosted.org/packages/e0/fd/ca2650443bfbef5b0e74373aac4df67b08180d2f184b482c41499668e258/coverage-7.10.7-cp312-cp312-musllinux_1_2_riscv64.whl", hash = "sha256:5e1e9802121405ede4b0133aa4340ad8186a1d2526de5b7c3eca519db7bb89fb", size = 249519, upload-time = "2025-09-21T20:01:48.73Z" },
+    { url = "https://files.pythonhosted.org/packages/24/79/f692f125fb4299b6f963b0745124998ebb8e73ecdfce4ceceb06a8c6bec5/coverage-7.10.7-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:d41213ea25a86f69efd1575073d34ea11aabe075604ddf3d148ecfec9e1e96a1", size = 251375, upload-time = "2025-09-21T20:01:50.529Z" },
+    { url = "https://files.pythonhosted.org/packages/5e/75/61b9bbd6c7d24d896bfeec57acba78e0f8deac68e6baf2d4804f7aae1f88/coverage-7.10.7-cp312-cp312-win32.whl", hash = "sha256:77eb4c747061a6af8d0f7bdb31f1e108d172762ef579166ec84542f711d90256", size = 220699, upload-time = "2025-09-21T20:01:51.941Z" },
+    { url = "https://files.pythonhosted.org/packages/ca/f3/3bf7905288b45b075918d372498f1cf845b5b579b723c8fd17168018d5f5/coverage-7.10.7-cp312-cp312-win_amd64.whl", hash = "sha256:f51328ffe987aecf6d09f3cd9d979face89a617eacdaea43e7b3080777f647ba", size = 221512, upload-time = "2025-09-21T20:01:53.481Z" },
+    { url = "https://files.pythonhosted.org/packages/5c/44/3e32dbe933979d05cf2dac5e697c8599cfe038aaf51223ab901e208d5a62/coverage-7.10.7-cp312-cp312-win_arm64.whl", hash = "sha256:bda5e34f8a75721c96085903c6f2197dc398c20ffd98df33f866a9c8fd95f4bf", size = 220147, upload-time = "2025-09-21T20:01:55.2Z" },
+    { url = "https://files.pythonhosted.org/packages/9a/94/b765c1abcb613d103b64fcf10395f54d69b0ef8be6a0dd9c524384892cc7/coverage-7.10.7-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:981a651f543f2854abd3b5fcb3263aac581b18209be49863ba575de6edf4c14d", size = 218320, upload-time = "2025-09-21T20:01:56.629Z" },
+    { url = "https://files.pythonhosted.org/packages/72/4f/732fff31c119bb73b35236dd333030f32c4bfe909f445b423e6c7594f9a2/coverage-7.10.7-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:73ab1601f84dc804f7812dc297e93cd99381162da39c47040a827d4e8dafe63b", size = 218575, upload-time = "2025-09-21T20:01:58.203Z" },
+    { url = "https://files.pythonhosted.org/packages/87/02/ae7e0af4b674be47566707777db1aa375474f02a1d64b9323e5813a6cdd5/coverage-7.10.7-cp313-cp313-manylinux1_i686.manylinux_2_28_i686.manylinux_2_5_i686.whl", hash = "sha256:a8b6f03672aa6734e700bbcd65ff050fd19cddfec4b031cc8cf1c6967de5a68e", size = 249568, upload-time = "2025-09-21T20:01:59.748Z" },
+    { url = "https://files.pythonhosted.org/packages/a2/77/8c6d22bf61921a59bce5471c2f1f7ac30cd4ac50aadde72b8c48d5727902/coverage-7.10.7-cp313-cp313-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:10b6ba00ab1132a0ce4428ff68cf50a25efd6840a42cdf4239c9b99aad83be8b", size = 252174, upload-time = "2025-09-21T20:02:01.192Z" },
+    { url = "https://files.pythonhosted.org/packages/b1/20/b6ea4f69bbb52dac0aebd62157ba6a9dddbfe664f5af8122dac296c3ee15/coverage-7.10.7-cp313-cp313-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:c79124f70465a150e89340de5963f936ee97097d2ef76c869708c4248c63ca49", size = 253447, upload-time = "2025-09-21T20:02:02.701Z" },
+    { url = "https://files.pythonhosted.org/packages/f9/28/4831523ba483a7f90f7b259d2018fef02cb4d5b90bc7c1505d6e5a84883c/coverage-7.10.7-cp313-cp313-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:69212fbccdbd5b0e39eac4067e20a4a5256609e209547d86f740d68ad4f04911", size = 249779, upload-time = "2025-09-21T20:02:04.185Z" },
+    { url = "https://files.pythonhosted.org/packages/a7/9f/4331142bc98c10ca6436d2d620c3e165f31e6c58d43479985afce6f3191c/coverage-7.10.7-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:7ea7c6c9d0d286d04ed3541747e6597cbe4971f22648b68248f7ddcd329207f0", size = 251604, upload-time = "2025-09-21T20:02:06.034Z" },
+    { url = "https://files.pythonhosted.org/packages/ce/60/bda83b96602036b77ecf34e6393a3836365481b69f7ed7079ab85048202b/coverage-7.10.7-cp313-cp313-musllinux_1_2_i686.whl", hash = "sha256:b9be91986841a75042b3e3243d0b3cb0b2434252b977baaf0cd56e960fe1e46f", size = 249497, upload-time = "2025-09-21T20:02:07.619Z" },
+    { url = "https://files.pythonhosted.org/packages/5f/af/152633ff35b2af63977edd835d8e6430f0caef27d171edf2fc76c270ef31/coverage-7.10.7-cp313-cp313-musllinux_1_2_riscv64.whl", hash = "sha256:b281d5eca50189325cfe1f365fafade89b14b4a78d9b40b05ddd1fc7d2a10a9c", size = 249350, upload-time = "2025-09-21T20:02:10.34Z" },
+    { url = "https://files.pythonhosted.org/packages/9d/71/d92105d122bd21cebba877228990e1646d862e34a98bb3374d3fece5a794/coverage-7.10.7-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:99e4aa63097ab1118e75a848a28e40d68b08a5e19ce587891ab7fd04475e780f", size = 251111, upload-time = "2025-09-21T20:02:12.122Z" },
+    { url = "https://files.pythonhosted.org/packages/a2/9e/9fdb08f4bf476c912f0c3ca292e019aab6712c93c9344a1653986c3fd305/coverage-7.10.7-cp313-cp313-win32.whl", hash = "sha256:dc7c389dce432500273eaf48f410b37886be9208b2dd5710aaf7c57fd442c698", size = 220746, upload-time = "2025-09-21T20:02:13.919Z" },
+    { url = "https://files.pythonhosted.org/packages/b1/b1/a75fd25df44eab52d1931e89980d1ada46824c7a3210be0d3c88a44aaa99/coverage-7.10.7-cp313-cp313-win_amd64.whl", hash = "sha256:cac0fdca17b036af3881a9d2729a850b76553f3f716ccb0360ad4dbc06b3b843", size = 221541, upload-time = "2025-09-21T20:02:15.57Z" },
+    { url = "https://files.pythonhosted.org/packages/14/3a/d720d7c989562a6e9a14b2c9f5f2876bdb38e9367126d118495b89c99c37/coverage-7.10.7-cp313-cp313-win_arm64.whl", hash = "sha256:4b6f236edf6e2f9ae8fcd1332da4e791c1b6ba0dc16a2dc94590ceccb482e546", size = 220170, upload-time = "2025-09-21T20:02:17.395Z" },
+    { url = "https://files.pythonhosted.org/packages/bb/22/e04514bf2a735d8b0add31d2b4ab636fc02370730787c576bb995390d2d5/coverage-7.10.7-cp313-cp313t-macosx_10_13_x86_64.whl", hash = "sha256:a0ec07fd264d0745ee396b666d47cef20875f4ff2375d7c4f58235886cc1ef0c", size = 219029, upload-time = "2025-09-21T20:02:18.936Z" },
+    { url = "https://files.pythonhosted.org/packages/11/0b/91128e099035ece15da3445d9015e4b4153a6059403452d324cbb0a575fa/coverage-7.10.7-cp313-cp313t-macosx_11_0_arm64.whl", hash = "sha256:dd5e856ebb7bfb7672b0086846db5afb4567a7b9714b8a0ebafd211ec7ce6a15", size = 219259, upload-time = "2025-09-21T20:02:20.44Z" },
+    { url = "https://files.pythonhosted.org/packages/8b/51/66420081e72801536a091a0c8f8c1f88a5c4bf7b9b1bdc6222c7afe6dc9b/coverage-7.10.7-cp313-cp313t-manylinux1_i686.manylinux_2_28_i686.manylinux_2_5_i686.whl", hash = "sha256:f57b2a3c8353d3e04acf75b3fed57ba41f5c0646bbf1d10c7c282291c97936b4", size = 260592, upload-time = "2025-09-21T20:02:22.313Z" },
+    { url = "https://files.pythonhosted.org/packages/5d/22/9b8d458c2881b22df3db5bb3e7369e63d527d986decb6c11a591ba2364f7/coverage-7.10.7-cp313-cp313t-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:1ef2319dd15a0b009667301a3f84452a4dc6fddfd06b0c5c53ea472d3989fbf0", size = 262768, upload-time = "2025-09-21T20:02:24.287Z" },
+    { url = "https://files.pythonhosted.org/packages/f7/08/16bee2c433e60913c610ea200b276e8eeef084b0d200bdcff69920bd5828/coverage-7.10.7-cp313-cp313t-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:83082a57783239717ceb0ad584de3c69cf581b2a95ed6bf81ea66034f00401c0", size = 264995, upload-time = "2025-09-21T20:02:26.133Z" },
+    { url = "https://files.pythonhosted.org/packages/20/9d/e53eb9771d154859b084b90201e5221bca7674ba449a17c101a5031d4054/coverage-7.10.7-cp313-cp313t-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:50aa94fb1fb9a397eaa19c0d5ec15a5edd03a47bf1a3a6111a16b36e190cff65", size = 259546, upload-time = "2025-09-21T20:02:27.716Z" },
+    { url = "https://files.pythonhosted.org/packages/ad/b0/69bc7050f8d4e56a89fb550a1577d5d0d1db2278106f6f626464067b3817/coverage-7.10.7-cp313-cp313t-musllinux_1_2_aarch64.whl", hash = "sha256:2120043f147bebb41c85b97ac45dd173595ff14f2a584f2963891cbcc3091541", size = 262544, upload-time = "2025-09-21T20:02:29.216Z" },
+    { url = "https://files.pythonhosted.org/packages/ef/4b/2514b060dbd1bc0aaf23b852c14bb5818f244c664cb16517feff6bb3a5ab/coverage-7.10.7-cp313-cp313t-musllinux_1_2_i686.whl", hash = "sha256:2fafd773231dd0378fdba66d339f84904a8e57a262f583530f4f156ab83863e6", size = 260308, upload-time = "2025-09-21T20:02:31.226Z" },
+    { url = "https://files.pythonhosted.org/packages/54/78/7ba2175007c246d75e496f64c06e94122bdb914790a1285d627a918bd271/coverage-7.10.7-cp313-cp313t-musllinux_1_2_riscv64.whl", hash = "sha256:0b944ee8459f515f28b851728ad224fa2d068f1513ef6b7ff1efafeb2185f999", size = 258920, upload-time = "2025-09-21T20:02:32.823Z" },
+    { url = "https://files.pythonhosted.org/packages/c0/b3/fac9f7abbc841409b9a410309d73bfa6cfb2e51c3fada738cb607ce174f8/coverage-7.10.7-cp313-cp313t-musllinux_1_2_x86_64.whl", hash = "sha256:4b583b97ab2e3efe1b3e75248a9b333bd3f8b0b1b8e5b45578e05e5850dfb2c2", size = 261434, upload-time = "2025-09-21T20:02:34.86Z" },
+    { url = "https://files.pythonhosted.org/packages/ee/51/a03bec00d37faaa891b3ff7387192cef20f01604e5283a5fabc95346befa/coverage-7.10.7-cp313-cp313t-win32.whl", hash = "sha256:2a78cd46550081a7909b3329e2266204d584866e8d97b898cd7fb5ac8d888b1a", size = 221403, upload-time = "2025-09-21T20:02:37.034Z" },
+    { url = "https://files.pythonhosted.org/packages/53/22/3cf25d614e64bf6d8e59c7c669b20d6d940bb337bdee5900b9ca41c820bb/coverage-7.10.7-cp313-cp313t-win_amd64.whl", hash = "sha256:33a5e6396ab684cb43dc7befa386258acb2d7fae7f67330ebb85ba4ea27938eb", size = 222469, upload-time = "2025-09-21T20:02:39.011Z" },
+    { url = "https://files.pythonhosted.org/packages/49/a1/00164f6d30d8a01c3c9c48418a7a5be394de5349b421b9ee019f380df2a0/coverage-7.10.7-cp313-cp313t-win_arm64.whl", hash = "sha256:86b0e7308289ddde73d863b7683f596d8d21c7d8664ce1dee061d0bcf3fbb4bb", size = 220731, upload-time = "2025-09-21T20:02:40.939Z" },
+    { url = "https://files.pythonhosted.org/packages/23/9c/5844ab4ca6a4dd97a1850e030a15ec7d292b5c5cb93082979225126e35dd/coverage-7.10.7-cp314-cp314-macosx_10_13_x86_64.whl", hash = "sha256:b06f260b16ead11643a5a9f955bd4b5fd76c1a4c6796aeade8520095b75de520", size = 218302, upload-time = "2025-09-21T20:02:42.527Z" },
+    { url = "https://files.pythonhosted.org/packages/f0/89/673f6514b0961d1f0e20ddc242e9342f6da21eaba3489901b565c0689f34/coverage-7.10.7-cp314-cp314-macosx_11_0_arm64.whl", hash = "sha256:212f8f2e0612778f09c55dd4872cb1f64a1f2b074393d139278ce902064d5b32", size = 218578, upload-time = "2025-09-21T20:02:44.468Z" },
+    { url = "https://files.pythonhosted.org/packages/05/e8/261cae479e85232828fb17ad536765c88dd818c8470aca690b0ac6feeaa3/coverage-7.10.7-cp314-cp314-manylinux1_i686.manylinux_2_28_i686.manylinux_2_5_i686.whl", hash = "sha256:3445258bcded7d4aa630ab8296dea4d3f15a255588dd535f980c193ab6b95f3f", size = 249629, upload-time = "2025-09-21T20:02:46.503Z" },
+    { url = "https://files.pythonhosted.org/packages/82/62/14ed6546d0207e6eda876434e3e8475a3e9adbe32110ce896c9e0c06bb9a/coverage-7.10.7-cp314-cp314-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:bb45474711ba385c46a0bfe696c695a929ae69ac636cda8f532be9e8c93d720a", size = 252162, upload-time = "2025-09-21T20:02:48.689Z" },
+    { url = "https://files.pythonhosted.org/packages/ff/49/07f00db9ac6478e4358165a08fb41b469a1b053212e8a00cb02f0d27a05f/coverage-7.10.7-cp314-cp314-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:813922f35bd800dca9994c5971883cbc0d291128a5de6b167c7aa697fcf59360", size = 253517, upload-time = "2025-09-21T20:02:50.31Z" },
+    { url = "https://files.pythonhosted.org/packages/a2/59/c5201c62dbf165dfbc91460f6dbbaa85a8b82cfa6131ac45d6c1bfb52deb/coverage-7.10.7-cp314-cp314-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:93c1b03552081b2a4423091d6fb3787265b8f86af404cff98d1b5342713bdd69", size = 249632, upload-time = "2025-09-21T20:02:51.971Z" },
+    { url = "https://files.pythonhosted.org/packages/07/ae/5920097195291a51fb00b3a70b9bbd2edbfe3c84876a1762bd1ef1565ebc/coverage-7.10.7-cp314-cp314-musllinux_1_2_aarch64.whl", hash = "sha256:cc87dd1b6eaf0b848eebb1c86469b9f72a1891cb42ac7adcfbce75eadb13dd14", size = 251520, upload-time = "2025-09-21T20:02:53.858Z" },
+    { url = "https://files.pythonhosted.org/packages/b9/3c/a815dde77a2981f5743a60b63df31cb322c944843e57dbd579326625a413/coverage-7.10.7-cp314-cp314-musllinux_1_2_i686.whl", hash = "sha256:39508ffda4f343c35f3236fe8d1a6634a51f4581226a1262769d7f970e73bffe", size = 249455, upload-time = "2025-09-21T20:02:55.807Z" },
+    { url = "https://files.pythonhosted.org/packages/aa/99/f5cdd8421ea656abefb6c0ce92556709db2265c41e8f9fc6c8ae0f7824c9/coverage-7.10.7-cp314-cp314-musllinux_1_2_riscv64.whl", hash = "sha256:925a1edf3d810537c5a3abe78ec5530160c5f9a26b1f4270b40e62cc79304a1e", size = 249287, upload-time = "2025-09-21T20:02:57.784Z" },
+    { url = "https://files.pythonhosted.org/packages/c3/7a/e9a2da6a1fc5d007dd51fca083a663ab930a8c4d149c087732a5dbaa0029/coverage-7.10.7-cp314-cp314-musllinux_1_2_x86_64.whl", hash = "sha256:2c8b9a0636f94c43cd3576811e05b89aa9bc2d0a85137affc544ae5cb0e4bfbd", size = 250946, upload-time = "2025-09-21T20:02:59.431Z" },
+    { url = "https://files.pythonhosted.org/packages/ef/5b/0b5799aa30380a949005a353715095d6d1da81927d6dbed5def2200a4e25/coverage-7.10.7-cp314-cp314-win32.whl", hash = "sha256:b7b8288eb7cdd268b0304632da8cb0bb93fadcfec2fe5712f7b9cc8f4d487be2", size = 221009, upload-time = "2025-09-21T20:03:01.324Z" },
+    { url = "https://files.pythonhosted.org/packages/da/b0/e802fbb6eb746de006490abc9bb554b708918b6774b722bb3a0e6aa1b7de/coverage-7.10.7-cp314-cp314-win_amd64.whl", hash = "sha256:1ca6db7c8807fb9e755d0379ccc39017ce0a84dcd26d14b5a03b78563776f681", size = 221804, upload-time = "2025-09-21T20:03:03.4Z" },
+    { url = "https://files.pythonhosted.org/packages/9e/e8/71d0c8e374e31f39e3389bb0bd19e527d46f00ea8571ec7ec8fd261d8b44/coverage-7.10.7-cp314-cp314-win_arm64.whl", hash = "sha256:097c1591f5af4496226d5783d036bf6fd6cd0cbc132e071b33861de756efb880", size = 220384, upload-time = "2025-09-21T20:03:05.111Z" },
+    { url = "https://files.pythonhosted.org/packages/62/09/9a5608d319fa3eba7a2019addeacb8c746fb50872b57a724c9f79f146969/coverage-7.10.7-cp314-cp314t-macosx_10_13_x86_64.whl", hash = "sha256:a62c6ef0d50e6de320c270ff91d9dd0a05e7250cac2a800b7784bae474506e63", size = 219047, upload-time = "2025-09-21T20:03:06.795Z" },
+    { url = "https://files.pythonhosted.org/packages/f5/6f/f58d46f33db9f2e3647b2d0764704548c184e6f5e014bef528b7f979ef84/coverage-7.10.7-cp314-cp314t-macosx_11_0_arm64.whl", hash = "sha256:9fa6e4dd51fe15d8738708a973470f67a855ca50002294852e9571cdbd9433f2", size = 219266, upload-time = "2025-09-21T20:03:08.495Z" },
+    { url = "https://files.pythonhosted.org/packages/74/5c/183ffc817ba68e0b443b8c934c8795553eb0c14573813415bd59941ee165/coverage-7.10.7-cp314-cp314t-manylinux1_i686.manylinux_2_28_i686.manylinux_2_5_i686.whl", hash = "sha256:8fb190658865565c549b6b4706856d6a7b09302c797eb2cf8e7fe9dabb043f0d", size = 260767, upload-time = "2025-09-21T20:03:10.172Z" },
+    { url = "https://files.pythonhosted.org/packages/0f/48/71a8abe9c1ad7e97548835e3cc1adbf361e743e9d60310c5f75c9e7bf847/coverage-7.10.7-cp314-cp314t-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:affef7c76a9ef259187ef31599a9260330e0335a3011732c4b9effa01e1cd6e0", size = 262931, upload-time = "2025-09-21T20:03:11.861Z" },
+    { url = "https://files.pythonhosted.org/packages/84/fd/193a8fb132acfc0a901f72020e54be5e48021e1575bb327d8ee1097a28fd/coverage-7.10.7-cp314-cp314t-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:6e16e07d85ca0cf8bafe5f5d23a0b850064e8e945d5677492b06bbe6f09cc699", size = 265186, upload-time = "2025-09-21T20:03:13.539Z" },
+    { url = "https://files.pythonhosted.org/packages/b1/8f/74ecc30607dd95ad50e3034221113ccb1c6d4e8085cc761134782995daae/coverage-7.10.7-cp314-cp314t-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:03ffc58aacdf65d2a82bbeb1ffe4d01ead4017a21bfd0454983b88ca73af94b9", size = 259470, upload-time = "2025-09-21T20:03:15.584Z" },
+    { url = "https://files.pythonhosted.org/packages/0f/55/79ff53a769f20d71b07023ea115c9167c0bb56f281320520cf64c5298a96/coverage-7.10.7-cp314-cp314t-musllinux_1_2_aarch64.whl", hash = "sha256:1b4fd784344d4e52647fd7857b2af5b3fbe6c239b0b5fa63e94eb67320770e0f", size = 262626, upload-time = "2025-09-21T20:03:17.673Z" },
+    { url = "https://files.pythonhosted.org/packages/88/e2/dac66c140009b61ac3fc13af673a574b00c16efdf04f9b5c740703e953c0/coverage-7.10.7-cp314-cp314t-musllinux_1_2_i686.whl", hash = "sha256:0ebbaddb2c19b71912c6f2518e791aa8b9f054985a0769bdb3a53ebbc765c6a1", size = 260386, upload-time = "2025-09-21T20:03:19.36Z" },
+    { url = "https://files.pythonhosted.org/packages/a2/f1/f48f645e3f33bb9ca8a496bc4a9671b52f2f353146233ebd7c1df6160440/coverage-7.10.7-cp314-cp314t-musllinux_1_2_riscv64.whl", hash = "sha256:a2d9a3b260cc1d1dbdb1c582e63ddcf5363426a1a68faa0f5da28d8ee3c722a0", size = 258852, upload-time = "2025-09-21T20:03:21.007Z" },
+    { url = "https://files.pythonhosted.org/packages/bb/3b/8442618972c51a7affeead957995cfa8323c0c9bcf8fa5a027421f720ff4/coverage-7.10.7-cp314-cp314t-musllinux_1_2_x86_64.whl", hash = "sha256:a3cc8638b2480865eaa3926d192e64ce6c51e3d29c849e09d5b4ad95efae5399", size = 261534, upload-time = "2025-09-21T20:03:23.12Z" },
+    { url = "https://files.pythonhosted.org/packages/b2/dc/101f3fa3a45146db0cb03f5b4376e24c0aac818309da23e2de0c75295a91/coverage-7.10.7-cp314-cp314t-win32.whl", hash = "sha256:67f8c5cbcd3deb7a60b3345dffc89a961a484ed0af1f6f73de91705cc6e31235", size = 221784, upload-time = "2025-09-21T20:03:24.769Z" },
+    { url = "https://files.pythonhosted.org/packages/4c/a1/74c51803fc70a8a40d7346660379e144be772bab4ac7bb6e6b905152345c/coverage-7.10.7-cp314-cp314t-win_amd64.whl", hash = "sha256:e1ed71194ef6dea7ed2d5cb5f7243d4bcd334bfb63e59878519be558078f848d", size = 222905, upload-time = "2025-09-21T20:03:26.93Z" },
+    { url = "https://files.pythonhosted.org/packages/12/65/f116a6d2127df30bcafbceef0302d8a64ba87488bf6f73a6d8eebf060873/coverage-7.10.7-cp314-cp314t-win_arm64.whl", hash = "sha256:7fe650342addd8524ca63d77b2362b02345e5f1a093266787d210c70a50b471a", size = 220922, upload-time = "2025-09-21T20:03:28.672Z" },
+    { url = "https://files.pythonhosted.org/packages/a3/ad/d1c25053764b4c42eb294aae92ab617d2e4f803397f9c7c8295caa77a260/coverage-7.10.7-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:fff7b9c3f19957020cac546c70025331113d2e61537f6e2441bc7657913de7d3", size = 217978, upload-time = "2025-09-21T20:03:30.362Z" },
+    { url = "https://files.pythonhosted.org/packages/52/2f/b9f9daa39b80ece0b9548bbb723381e29bc664822d9a12c2135f8922c22b/coverage-7.10.7-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:bc91b314cef27742da486d6839b677b3f2793dfe52b51bbbb7cf736d5c29281c", size = 218370, upload-time = "2025-09-21T20:03:32.147Z" },
+    { url = "https://files.pythonhosted.org/packages/dd/6e/30d006c3b469e58449650642383dddf1c8fb63d44fdf92994bfd46570695/coverage-7.10.7-cp39-cp39-manylinux1_i686.manylinux_2_28_i686.manylinux_2_5_i686.whl", hash = "sha256:567f5c155eda8df1d3d439d40a45a6a5f029b429b06648235f1e7e51b522b396", size = 244802, upload-time = "2025-09-21T20:03:33.919Z" },
+    { url = "https://files.pythonhosted.org/packages/b0/49/8a070782ce7e6b94ff6a0b6d7c65ba6bc3091d92a92cef4cd4eb0767965c/coverage-7.10.7-cp39-cp39-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:2af88deffcc8a4d5974cf2d502251bc3b2db8461f0b66d80a449c33757aa9f40", size = 246625, upload-time = "2025-09-21T20:03:36.09Z" },
+    { url = "https://files.pythonhosted.org/packages/6a/92/1c1c5a9e8677ce56d42b97bdaca337b2d4d9ebe703d8c174ede52dbabd5f/coverage-7.10.7-cp39-cp39-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:c7315339eae3b24c2d2fa1ed7d7a38654cba34a13ef19fbcb9425da46d3dc594", size = 248399, upload-time = "2025-09-21T20:03:38.342Z" },
+    { url = "https://files.pythonhosted.org/packages/c0/54/b140edee7257e815de7426d5d9846b58505dffc29795fff2dfb7f8a1c5a0/coverage-7.10.7-cp39-cp39-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:912e6ebc7a6e4adfdbb1aec371ad04c68854cd3bf3608b3514e7ff9062931d8a", size = 245142, upload-time = "2025-09-21T20:03:40.591Z" },
+    { url = "https://files.pythonhosted.org/packages/e4/9e/6d6b8295940b118e8b7083b29226c71f6154f7ff41e9ca431f03de2eac0d/coverage-7.10.7-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:f49a05acd3dfe1ce9715b657e28d138578bc40126760efb962322c56e9ca344b", size = 246284, upload-time = "2025-09-21T20:03:42.355Z" },
+    { url = "https://files.pythonhosted.org/packages/db/e5/5e957ca747d43dbe4d9714358375c7546cb3cb533007b6813fc20fce37ad/coverage-7.10.7-cp39-cp39-musllinux_1_2_i686.whl", hash = "sha256:cce2109b6219f22ece99db7644b9622f54a4e915dad65660ec435e89a3ea7cc3", size = 244353, upload-time = "2025-09-21T20:03:44.218Z" },
+    { url = "https://files.pythonhosted.org/packages/9a/45/540fc5cc92536a1b783b7ef99450bd55a4b3af234aae35a18a339973ce30/coverage-7.10.7-cp39-cp39-musllinux_1_2_riscv64.whl", hash = "sha256:f3c887f96407cea3916294046fc7dab611c2552beadbed4ea901cbc6a40cc7a0", size = 244430, upload-time = "2025-09-21T20:03:46.065Z" },
+    { url = "https://files.pythonhosted.org/packages/75/0b/8287b2e5b38c8fe15d7e3398849bb58d382aedc0864ea0fa1820e8630491/coverage-7.10.7-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:635adb9a4507c9fd2ed65f39693fa31c9a3ee3a8e6dc64df033e8fdf52a7003f", size = 245311, upload-time = "2025-09-21T20:03:48.19Z" },
+    { url = "https://files.pythonhosted.org/packages/0c/1d/29724999984740f0c86d03e6420b942439bf5bd7f54d4382cae386a9d1e9/coverage-7.10.7-cp39-cp39-win32.whl", hash = "sha256:5a02d5a850e2979b0a014c412573953995174743a3f7fa4ea5a6e9a3c5617431", size = 220500, upload-time = "2025-09-21T20:03:50.024Z" },
+    { url = "https://files.pythonhosted.org/packages/43/11/4b1e6b129943f905ca54c339f343877b55b365ae2558806c1be4f7476ed5/coverage-7.10.7-cp39-cp39-win_amd64.whl", hash = "sha256:c134869d5ffe34547d14e174c866fd8fe2254918cc0a95e99052903bc1543e07", size = 221408, upload-time = "2025-09-21T20:03:51.803Z" },
+    { url = "https://files.pythonhosted.org/packages/ec/16/114df1c291c22cac3b0c127a73e0af5c12ed7bbb6558d310429a0ae24023/coverage-7.10.7-py3-none-any.whl", hash = "sha256:f7941f6f2fe6dd6807a1208737b8a0cbcf1cc6d7b07d24998ad2d63590868260", size = 209952, upload-time = "2025-09-21T20:03:53.918Z" },
+]
+
+[package.optional-dependencies]
+toml = [
+    { name = "tomli", marker = "python_full_version >= '3.9' and python_full_version <= '3.11'" },
+]
+
+[[package]]
+name = "cycler"
+version = "0.12.1"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/a9/95/a3dbbb5028f35eafb79008e7522a75244477d2838f38cbb722248dabc2a8/cycler-0.12.1.tar.gz", hash = "sha256:88bb128f02ba341da8ef447245a9e138fae777f6a23943da4540077d3601eb1c", size = 7615, upload-time = "2023-10-07T05:32:18.335Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/e7/05/c19819d5e3d95294a6f5947fb9b9629efb316b96de511b418c53d245aae6/cycler-0.12.1-py3-none-any.whl", hash = "sha256:85cef7cff222d8644161529808465972e51340599459b8ac3ccbac5a854e0d30", size = 8321, upload-time = "2023-10-07T05:32:16.783Z" },
+]
+
+[[package]]
+name = "distlib"
+version = "0.4.0"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/96/8e/709914eb2b5749865801041647dc7f4e6d00b549cfe88b65ca192995f07c/distlib-0.4.0.tar.gz", hash = "sha256:feec40075be03a04501a973d81f633735b4b69f98b05450592310c0f401a4e0d", size = 614605, upload-time = "2025-07-17T16:52:00.465Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/33/6b/e0547afaf41bf2c42e52430072fa5658766e3d65bd4b03a563d1b6336f57/distlib-0.4.0-py2.py3-none-any.whl", hash = "sha256:9659f7d87e46584a30b5780e43ac7a2143098441670ff0a49d5f9034c54a6c16", size = 469047, upload-time = "2025-07-17T16:51:58.613Z" },
+]
+
+[[package]]
+name = "docutils"
+version = "0.20.1"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/1f/53/a5da4f2c5739cf66290fac1431ee52aff6851c7c8ffd8264f13affd7bcdd/docutils-0.20.1.tar.gz", hash = "sha256:f08a4e276c3a1583a86dce3e34aba3fe04d02bba2dd51ed16106244e8a923e3b", size = 2058365, upload-time = "2023-05-16T23:39:19.748Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/26/87/f238c0670b94533ac0353a4e2a1a771a0cc73277b88bff23d3ae35a256c1/docutils-0.20.1-py3-none-any.whl", hash = "sha256:96f387a2c5562db4476f09f13bbab2192e764cac08ebbf3a34a95d9b1e4a59d6", size = 572666, upload-time = "2023-05-16T23:39:15.976Z" },
+]
+
+[[package]]
+name = "docutils"
+version = "0.21.2"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/ae/ed/aefcc8cd0ba62a0560c3c18c33925362d46c6075480bfa4df87b28e169a9/docutils-0.21.2.tar.gz", hash = "sha256:3a6b18732edf182daa3cd12775bbb338cf5691468f91eeeb109deff6ebfa986f", size = 2204444, upload-time = "2024-04-23T18:57:18.24Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/8f/d7/9322c609343d929e75e7e5e6255e614fcc67572cfd083959cdef3b7aad79/docutils-0.21.2-py3-none-any.whl", hash = "sha256:dafca5b9e384f0e419294eb4d2ff9fa826435bf15f15b7bd45723e8ad76811b2", size = 587408, upload-time = "2024-04-23T18:57:14.835Z" },
+]
+
+[[package]]
+name = "filelock"
+version = "3.16.1"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/9d/db/3ef5bb276dae18d6ec2124224403d1d67bccdbefc17af4cc8f553e341ab1/filelock-3.16.1.tar.gz", hash = "sha256:c249fbfcd5db47e5e2d6d62198e565475ee65e4831e2561c8e313fa7eb961435", size = 18037, upload-time = "2024-09-17T19:02:01.779Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/b9/f8/feced7779d755758a52d1f6635d990b8d98dc0a29fa568bbe0625f18fdf3/filelock-3.16.1-py3-none-any.whl", hash = "sha256:2082e5703d51fbf98ea75855d9d5527e33d8ff23099bec374a134febee6946b0", size = 16163, upload-time = "2024-09-17T19:02:00.268Z" },
+]
+
+[[package]]
+name = "filelock"
+version = "3.19.1"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/40/bb/0ab3e58d22305b6f5440629d20683af28959bf793d98d11950e305c1c326/filelock-3.19.1.tar.gz", hash = "sha256:66eda1888b0171c998b35be2bcc0f6d75c388a7ce20c3f3f37aa8e96c2dddf58", size = 17687, upload-time = "2025-08-14T16:56:03.016Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/42/14/42b2651a2f46b022ccd948bca9f2d5af0fd8929c4eec235b8d6d844fbe67/filelock-3.19.1-py3-none-any.whl", hash = "sha256:d38e30481def20772f5baf097c122c3babc4fcdb7e14e57049eb9d88c6dc017d", size = 15988, upload-time = "2025-08-14T16:56:01.633Z" },
+]
+
+[[package]]
+name = "fonttools"
+version = "4.57.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/03/2d/a9a0b6e3a0cf6bd502e64fc16d894269011930cabfc89aee20d1635b1441/fonttools-4.57.0.tar.gz", hash = "sha256:727ece10e065be2f9dd239d15dd5d60a66e17eac11aea47d447f9f03fdbc42de", size = 3492448, upload-time = "2025-04-03T11:07:13.898Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/db/17/3ddfd1881878b3f856065130bb603f5922e81ae8a4eb53bce0ea78f765a8/fonttools-4.57.0-cp310-cp310-macosx_10_9_universal2.whl", hash = "sha256:babe8d1eb059a53e560e7bf29f8e8f4accc8b6cfb9b5fd10e485bde77e71ef41", size = 2756260, upload-time = "2025-04-03T11:05:28.582Z" },
+    { url = "https://files.pythonhosted.org/packages/26/2b/6957890c52c030b0bf9e0add53e5badab4682c6ff024fac9a332bb2ae063/fonttools-4.57.0-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:81aa97669cd726349eb7bd43ca540cf418b279ee3caba5e2e295fb4e8f841c02", size = 2284691, upload-time = "2025-04-03T11:05:31.526Z" },
+    { url = "https://files.pythonhosted.org/packages/cc/8e/c043b4081774e5eb06a834cedfdb7d432b4935bc8c4acf27207bdc34dfc4/fonttools-4.57.0-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:f0e9618630edd1910ad4f07f60d77c184b2f572c8ee43305ea3265675cbbfe7e", size = 4566077, upload-time = "2025-04-03T11:05:33.559Z" },
+    { url = "https://files.pythonhosted.org/packages/59/bc/e16ae5d9eee6c70830ce11d1e0b23d6018ddfeb28025fda092cae7889c8b/fonttools-4.57.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:34687a5d21f1d688d7d8d416cb4c5b9c87fca8a1797ec0d74b9fdebfa55c09ab", size = 4608729, upload-time = "2025-04-03T11:05:35.49Z" },
+    { url = "https://files.pythonhosted.org/packages/25/13/e557bf10bb38e4e4c436d3a9627aadf691bc7392ae460910447fda5fad2b/fonttools-4.57.0-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:69ab81b66ebaa8d430ba56c7a5f9abe0183afefd3a2d6e483060343398b13fb1", size = 4759646, upload-time = "2025-04-03T11:05:37.963Z" },
+    { url = "https://files.pythonhosted.org/packages/bc/c9/5e2952214d4a8e31026bf80beb18187199b7001e60e99a6ce19773249124/fonttools-4.57.0-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:d639397de852f2ccfb3134b152c741406752640a266d9c1365b0f23d7b88077f", size = 4941652, upload-time = "2025-04-03T11:05:40.089Z" },
+    { url = "https://files.pythonhosted.org/packages/df/04/e80242b3d9ec91a1f785d949edc277a13ecfdcfae744de4b170df9ed77d8/fonttools-4.57.0-cp310-cp310-win32.whl", hash = "sha256:cc066cb98b912f525ae901a24cd381a656f024f76203bc85f78fcc9e66ae5aec", size = 2159432, upload-time = "2025-04-03T11:05:41.754Z" },
+    { url = "https://files.pythonhosted.org/packages/33/ba/e858cdca275daf16e03c0362aa43734ea71104c3b356b2100b98543dba1b/fonttools-4.57.0-cp310-cp310-win_amd64.whl", hash = "sha256:7a64edd3ff6a7f711a15bd70b4458611fb240176ec11ad8845ccbab4fe6745db", size = 2203869, upload-time = "2025-04-03T11:05:43.712Z" },
+    { url = "https://files.pythonhosted.org/packages/81/1f/e67c99aa3c6d3d2f93d956627e62a57ae0d35dc42f26611ea2a91053f6d6/fonttools-4.57.0-cp311-cp311-macosx_10_9_universal2.whl", hash = "sha256:3871349303bdec958360eedb619169a779956503ffb4543bb3e6211e09b647c4", size = 2757392, upload-time = "2025-04-03T11:05:45.715Z" },
+    { url = "https://files.pythonhosted.org/packages/aa/f1/f75770d0ddc67db504850898d96d75adde238c35313409bfcd8db4e4a5fe/fonttools-4.57.0-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:c59375e85126b15a90fcba3443eaac58f3073ba091f02410eaa286da9ad80ed8", size = 2285609, upload-time = "2025-04-03T11:05:47.977Z" },
+    { url = "https://files.pythonhosted.org/packages/f5/d3/bc34e4953cb204bae0c50b527307dce559b810e624a733351a654cfc318e/fonttools-4.57.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:967b65232e104f4b0f6370a62eb33089e00024f2ce143aecbf9755649421c683", size = 4873292, upload-time = "2025-04-03T11:05:49.921Z" },
+    { url = "https://files.pythonhosted.org/packages/41/b8/d5933559303a4ab18c799105f4c91ee0318cc95db4a2a09e300116625e7a/fonttools-4.57.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:39acf68abdfc74e19de7485f8f7396fa4d2418efea239b7061d6ed6a2510c746", size = 4902503, upload-time = "2025-04-03T11:05:52.17Z" },
+    { url = "https://files.pythonhosted.org/packages/32/13/acb36bfaa316f481153ce78de1fa3926a8bad42162caa3b049e1afe2408b/fonttools-4.57.0-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:9d077f909f2343daf4495ba22bb0e23b62886e8ec7c109ee8234bdbd678cf344", size = 5077351, upload-time = "2025-04-03T11:05:54.162Z" },
+    { url = "https://files.pythonhosted.org/packages/b5/23/6d383a2ca83b7516d73975d8cca9d81a01acdcaa5e4db8579e4f3de78518/fonttools-4.57.0-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:46370ac47a1e91895d40e9ad48effbe8e9d9db1a4b80888095bc00e7beaa042f", size = 5275067, upload-time = "2025-04-03T11:05:57.375Z" },
+    { url = "https://files.pythonhosted.org/packages/bc/ca/31b8919c6da0198d5d522f1d26c980201378c087bdd733a359a1e7485769/fonttools-4.57.0-cp311-cp311-win32.whl", hash = "sha256:ca2aed95855506b7ae94e8f1f6217b7673c929e4f4f1217bcaa236253055cb36", size = 2158263, upload-time = "2025-04-03T11:05:59.567Z" },
+    { url = "https://files.pythonhosted.org/packages/13/4c/de2612ea2216eb45cfc8eb91a8501615dd87716feaf5f8fb65cbca576289/fonttools-4.57.0-cp311-cp311-win_amd64.whl", hash = "sha256:17168a4670bbe3775f3f3f72d23ee786bd965395381dfbb70111e25e81505b9d", size = 2204968, upload-time = "2025-04-03T11:06:02.16Z" },
+    { url = "https://files.pythonhosted.org/packages/cb/98/d4bc42d43392982eecaaca117d79845734d675219680cd43070bb001bc1f/fonttools-4.57.0-cp312-cp312-macosx_10_13_universal2.whl", hash = "sha256:889e45e976c74abc7256d3064aa7c1295aa283c6bb19810b9f8b604dfe5c7f31", size = 2751824, upload-time = "2025-04-03T11:06:03.782Z" },
+    { url = "https://files.pythonhosted.org/packages/1a/62/7168030eeca3742fecf45f31e63b5ef48969fa230a672216b805f1d61548/fonttools-4.57.0-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:0425c2e052a5f1516c94e5855dbda706ae5a768631e9fcc34e57d074d1b65b92", size = 2283072, upload-time = "2025-04-03T11:06:05.533Z" },
+    { url = "https://files.pythonhosted.org/packages/5d/82/121a26d9646f0986ddb35fbbaf58ef791c25b59ecb63ffea2aab0099044f/fonttools-4.57.0-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:44c26a311be2ac130f40a96769264809d3b0cb297518669db437d1cc82974888", size = 4788020, upload-time = "2025-04-03T11:06:07.249Z" },
+    { url = "https://files.pythonhosted.org/packages/5b/26/e0f2fb662e022d565bbe280a3cfe6dafdaabf58889ff86fdef2d31ff1dde/fonttools-4.57.0-cp312-cp312-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:84c41ba992df5b8d680b89fd84c6a1f2aca2b9f1ae8a67400c8930cd4ea115f6", size = 4859096, upload-time = "2025-04-03T11:06:09.469Z" },
+    { url = "https://files.pythonhosted.org/packages/9e/44/9075e323347b1891cdece4b3f10a3b84a8f4c42a7684077429d9ce842056/fonttools-4.57.0-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:ea1e9e43ca56b0c12440a7c689b1350066595bebcaa83baad05b8b2675129d98", size = 4964356, upload-time = "2025-04-03T11:06:11.294Z" },
+    { url = "https://files.pythonhosted.org/packages/48/28/caa8df32743462fb966be6de6a79d7f30393859636d7732e82efa09fbbb4/fonttools-4.57.0-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:84fd56c78d431606332a0627c16e2a63d243d0d8b05521257d77c6529abe14d8", size = 5226546, upload-time = "2025-04-03T11:06:13.6Z" },
+    { url = "https://files.pythonhosted.org/packages/f6/46/95ab0f0d2e33c5b1a4fc1c0efe5e286ba9359602c0a9907adb1faca44175/fonttools-4.57.0-cp312-cp312-win32.whl", hash = "sha256:f4376819c1c778d59e0a31db5dc6ede854e9edf28bbfa5b756604727f7f800ac", size = 2146776, upload-time = "2025-04-03T11:06:15.643Z" },
+    { url = "https://files.pythonhosted.org/packages/06/5d/1be5424bb305880e1113631f49a55ea7c7da3a5fe02608ca7c16a03a21da/fonttools-4.57.0-cp312-cp312-win_amd64.whl", hash = "sha256:57e30241524879ea10cdf79c737037221f77cc126a8cdc8ff2c94d4a522504b9", size = 2193956, upload-time = "2025-04-03T11:06:17.534Z" },
+    { url = "https://files.pythonhosted.org/packages/e9/2f/11439f3af51e4bb75ac9598c29f8601aa501902dcedf034bdc41f47dd799/fonttools-4.57.0-cp313-cp313-macosx_10_13_universal2.whl", hash = "sha256:408ce299696012d503b714778d89aa476f032414ae57e57b42e4b92363e0b8ef", size = 2739175, upload-time = "2025-04-03T11:06:19.583Z" },
+    { url = "https://files.pythonhosted.org/packages/25/52/677b55a4c0972dc3820c8dba20a29c358197a78229daa2ea219fdb19e5d5/fonttools-4.57.0-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:bbceffc80aa02d9e8b99f2a7491ed8c4a783b2fc4020119dc405ca14fb5c758c", size = 2276583, upload-time = "2025-04-03T11:06:21.753Z" },
+    { url = "https://files.pythonhosted.org/packages/64/79/184555f8fa77b827b9460a4acdbbc0b5952bb6915332b84c615c3a236826/fonttools-4.57.0-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:f022601f3ee9e1f6658ed6d184ce27fa5216cee5b82d279e0f0bde5deebece72", size = 4766437, upload-time = "2025-04-03T11:06:23.521Z" },
+    { url = "https://files.pythonhosted.org/packages/f8/ad/c25116352f456c0d1287545a7aa24e98987b6d99c5b0456c4bd14321f20f/fonttools-4.57.0-cp313-cp313-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:4dea5893b58d4637ffa925536462ba626f8a1b9ffbe2f5c272cdf2c6ebadb817", size = 4838431, upload-time = "2025-04-03T11:06:25.423Z" },
+    { url = "https://files.pythonhosted.org/packages/53/ae/398b2a833897297797a44f519c9af911c2136eb7aa27d3f1352c6d1129fa/fonttools-4.57.0-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:dff02c5c8423a657c550b48231d0a48d7e2b2e131088e55983cfe74ccc2c7cc9", size = 4951011, upload-time = "2025-04-03T11:06:27.41Z" },
+    { url = "https://files.pythonhosted.org/packages/b7/5d/7cb31c4bc9ffb9a2bbe8b08f8f53bad94aeb158efad75da645b40b62cb73/fonttools-4.57.0-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:767604f244dc17c68d3e2dbf98e038d11a18abc078f2d0f84b6c24571d9c0b13", size = 5205679, upload-time = "2025-04-03T11:06:29.804Z" },
+    { url = "https://files.pythonhosted.org/packages/4c/e4/6934513ec2c4d3d69ca1bc3bd34d5c69dafcbf68c15388dd3bb062daf345/fonttools-4.57.0-cp313-cp313-win32.whl", hash = "sha256:8e2e12d0d862f43d51e5afb8b9751c77e6bec7d2dc00aad80641364e9df5b199", size = 2144833, upload-time = "2025-04-03T11:06:31.737Z" },
+    { url = "https://files.pythonhosted.org/packages/c4/0d/2177b7fdd23d017bcfb702fd41e47d4573766b9114da2fddbac20dcc4957/fonttools-4.57.0-cp313-cp313-win_amd64.whl", hash = "sha256:f1d6bc9c23356908db712d282acb3eebd4ae5ec6d8b696aa40342b1d84f8e9e3", size = 2190799, upload-time = "2025-04-03T11:06:34.784Z" },
+    { url = "https://files.pythonhosted.org/packages/8a/3f/c16dbbec7221783f37dcc2022d5a55f0d704ffc9feef67930f6eb517e8ce/fonttools-4.57.0-cp38-cp38-macosx_10_9_universal2.whl", hash = "sha256:9d57b4e23ebbe985125d3f0cabbf286efa191ab60bbadb9326091050d88e8213", size = 2753756, upload-time = "2025-04-03T11:06:36.875Z" },
+    { url = "https://files.pythonhosted.org/packages/48/9f/5b4a3d6aed5430b159dd3494bb992d4e45102affa3725f208e4f0aedc6a3/fonttools-4.57.0-cp38-cp38-macosx_10_9_x86_64.whl", hash = "sha256:579ba873d7f2a96f78b2e11028f7472146ae181cae0e4d814a37a09e93d5c5cc", size = 2283179, upload-time = "2025-04-03T11:06:39.095Z" },
+    { url = "https://files.pythonhosted.org/packages/17/b2/4e887b674938b4c3848029a4134ac90dd8653ea80b4f464fa1edeae37f25/fonttools-4.57.0-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:6e3e1ec10c29bae0ea826b61f265ec5c858c5ba2ce2e69a71a62f285cf8e4595", size = 4647139, upload-time = "2025-04-03T11:06:41.315Z" },
+    { url = "https://files.pythonhosted.org/packages/a5/0e/b6314a09a4d561aaa7e09de43fa700917be91e701f07df6178865962666c/fonttools-4.57.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:a1968f2a2003c97c4ce6308dc2498d5fd4364ad309900930aa5a503c9851aec8", size = 4691211, upload-time = "2025-04-03T11:06:43.566Z" },
+    { url = "https://files.pythonhosted.org/packages/bf/1d/b9f4b70d165c25f5c9aee61eb6ae90b0e9b5787b2c0a45e4f3e50a839274/fonttools-4.57.0-cp38-cp38-musllinux_1_2_aarch64.whl", hash = "sha256:aff40f8ac6763d05c2c8f6d240c6dac4bb92640a86d9b0c3f3fff4404f34095c", size = 4873755, upload-time = "2025-04-03T11:06:45.457Z" },
+    { url = "https://files.pythonhosted.org/packages/3b/fa/a731c8f42ae2c6761d1c22bd3c90241d5b2b13cabb70598abc74a828b51f/fonttools-4.57.0-cp38-cp38-musllinux_1_2_x86_64.whl", hash = "sha256:d07f1b64008e39fceae7aa99e38df8385d7d24a474a8c9872645c4397b674481", size = 5070072, upload-time = "2025-04-03T11:06:47.853Z" },
+    { url = "https://files.pythonhosted.org/packages/1f/1e/6a988230109a2ba472e5de0a4c3936d49718cfc4b700b6bad53eca414bcf/fonttools-4.57.0-cp38-cp38-win32.whl", hash = "sha256:51d8482e96b28fb28aa8e50b5706f3cee06de85cbe2dce80dbd1917ae22ec5a6", size = 1484098, upload-time = "2025-04-03T11:06:50.167Z" },
+    { url = "https://files.pythonhosted.org/packages/dc/7a/2b3666e8c13d035adf656a8ae391380656144760353c97f74747c64fd3e5/fonttools-4.57.0-cp38-cp38-win_amd64.whl", hash = "sha256:03290e818782e7edb159474144fca11e36a8ed6663d1fcbd5268eb550594fd8e", size = 1529536, upload-time = "2025-04-03T11:06:52.468Z" },
+    { url = "https://files.pythonhosted.org/packages/d2/c7/3bddafbb95447f6fbabdd0b399bf468649321fd4029e356b4f6bd70fbc1b/fonttools-4.57.0-cp39-cp39-macosx_10_9_universal2.whl", hash = "sha256:7339e6a3283e4b0ade99cade51e97cde3d54cd6d1c3744459e886b66d630c8b3", size = 2758942, upload-time = "2025-04-03T11:06:54.679Z" },
+    { url = "https://files.pythonhosted.org/packages/d4/a2/8dd7771022e365c90e428b1607174c3297d5c0a2cc2cf4cdccb2221945b7/fonttools-4.57.0-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:05efceb2cb5f6ec92a4180fcb7a64aa8d3385fd49cfbbe459350229d1974f0b1", size = 2285959, upload-time = "2025-04-03T11:06:56.792Z" },
+    { url = "https://files.pythonhosted.org/packages/58/5a/2fd29c5e38b14afe1fae7d472373e66688e7c7a98554252f3cf44371e033/fonttools-4.57.0-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:a97bb05eb24637714a04dee85bdf0ad1941df64fe3b802ee4ac1c284a5f97b7c", size = 4571677, upload-time = "2025-04-03T11:06:59.002Z" },
+    { url = "https://files.pythonhosted.org/packages/bf/30/b77cf81923f1a67ff35d6765a9db4718c0688eb8466c464c96a23a2e28d4/fonttools-4.57.0-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:541cb48191a19ceb1a2a4b90c1fcebd22a1ff7491010d3cf840dd3a68aebd654", size = 4616644, upload-time = "2025-04-03T11:07:01.238Z" },
+    { url = "https://files.pythonhosted.org/packages/06/33/376605898d8d553134144dff167506a49694cb0e0cf684c14920fbc1e99f/fonttools-4.57.0-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:cdef9a056c222d0479a1fdb721430f9efd68268014c54e8166133d2643cb05d9", size = 4761314, upload-time = "2025-04-03T11:07:03.162Z" },
+    { url = "https://files.pythonhosted.org/packages/48/e4/e0e48f5bae04bc1a1c6b4fcd7d1ca12b29f1fe74221534b7ff83ed0db8fe/fonttools-4.57.0-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:3cf97236b192a50a4bf200dc5ba405aa78d4f537a2c6e4c624bb60466d5b03bd", size = 4945563, upload-time = "2025-04-03T11:07:05.313Z" },
+    { url = "https://files.pythonhosted.org/packages/61/98/2dacfc6d70f2d93bde1bbf814286be343cb17f53057130ad3b843144dd00/fonttools-4.57.0-cp39-cp39-win32.whl", hash = "sha256:e952c684274a7714b3160f57ec1d78309f955c6335c04433f07d36c5eb27b1f9", size = 2159997, upload-time = "2025-04-03T11:07:07.467Z" },
+    { url = "https://files.pythonhosted.org/packages/93/fa/e61cc236f40d504532d2becf90c297bfed8e40abc0c8b08375fbb83eff29/fonttools-4.57.0-cp39-cp39-win_amd64.whl", hash = "sha256:a2a722c0e4bfd9966a11ff55c895c817158fcce1b2b6700205a376403b546ad9", size = 2204508, upload-time = "2025-04-03T11:07:09.632Z" },
+    { url = "https://files.pythonhosted.org/packages/90/27/45f8957c3132917f91aaa56b700bcfc2396be1253f685bd5c68529b6f610/fonttools-4.57.0-py3-none-any.whl", hash = "sha256:3122c604a675513c68bd24c6a8f9091f1c2376d18e8f5fe5a101746c81b3e98f", size = 1093605, upload-time = "2025-04-03T11:07:11.341Z" },
+]
+
+[[package]]
+name = "fonttools"
+version = "4.60.1"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/4b/42/97a13e47a1e51a5a7142475bbcf5107fe3a68fc34aef331c897d5fb98ad0/fonttools-4.60.1.tar.gz", hash = "sha256:ef00af0439ebfee806b25f24c8f92109157ff3fac5731dc7867957812e87b8d9", size = 3559823, upload-time = "2025-09-29T21:13:27.129Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/26/70/03e9d89a053caff6ae46053890eba8e4a5665a7c5638279ed4492e6d4b8b/fonttools-4.60.1-cp310-cp310-macosx_10_9_universal2.whl", hash = "sha256:9a52f254ce051e196b8fe2af4634c2d2f02c981756c6464dc192f1b6050b4e28", size = 2810747, upload-time = "2025-09-29T21:10:59.653Z" },
+    { url = "https://files.pythonhosted.org/packages/6f/41/449ad5aff9670ab0df0f61ee593906b67a36d7e0b4d0cd7fa41ac0325bf5/fonttools-4.60.1-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:c7420a2696a44650120cdd269a5d2e56a477e2bfa9d95e86229059beb1c19e15", size = 2346909, upload-time = "2025-09-29T21:11:02.882Z" },
+    { url = "https://files.pythonhosted.org/packages/9a/18/e5970aa96c8fad1cb19a9479cc3b7602c0c98d250fcdc06a5da994309c50/fonttools-4.60.1-cp310-cp310-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:ee0c0b3b35b34f782afc673d503167157094a16f442ace7c6c5e0ca80b08f50c", size = 4864572, upload-time = "2025-09-29T21:11:05.096Z" },
+    { url = "https://files.pythonhosted.org/packages/ce/20/9b2b4051b6ec6689480787d506b5003f72648f50972a92d04527a456192c/fonttools-4.60.1-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:282dafa55f9659e8999110bd8ed422ebe1c8aecd0dc396550b038e6c9a08b8ea", size = 4794635, upload-time = "2025-09-29T21:11:08.651Z" },
+    { url = "https://files.pythonhosted.org/packages/10/52/c791f57347c1be98f8345e3dca4ac483eb97666dd7c47f3059aeffab8b59/fonttools-4.60.1-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:4ba4bd646e86de16160f0fb72e31c3b9b7d0721c3e5b26b9fa2fc931dfdb2652", size = 4843878, upload-time = "2025-09-29T21:11:10.893Z" },
+    { url = "https://files.pythonhosted.org/packages/69/e9/35c24a8d01644cee8c090a22fad34d5b61d1e0a8ecbc9945ad785ebf2e9e/fonttools-4.60.1-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:0b0835ed15dd5b40d726bb61c846a688f5b4ce2208ec68779bc81860adb5851a", size = 4954555, upload-time = "2025-09-29T21:11:13.24Z" },
+    { url = "https://files.pythonhosted.org/packages/f7/86/fb1e994971be4bdfe3a307de6373ef69a9df83fb66e3faa9c8114893d4cc/fonttools-4.60.1-cp310-cp310-win32.whl", hash = "sha256:1525796c3ffe27bb6268ed2a1bb0dcf214d561dfaf04728abf01489eb5339dce", size = 2232019, upload-time = "2025-09-29T21:11:15.73Z" },
+    { url = "https://files.pythonhosted.org/packages/40/84/62a19e2bd56f0e9fb347486a5b26376bade4bf6bbba64dda2c103bd08c94/fonttools-4.60.1-cp310-cp310-win_amd64.whl", hash = "sha256:268ecda8ca6cb5c4f044b1fb9b3b376e8cd1b361cef275082429dc4174907038", size = 2276803, upload-time = "2025-09-29T21:11:18.152Z" },
+    { url = "https://files.pythonhosted.org/packages/ea/85/639aa9bface1537e0fb0f643690672dde0695a5bbbc90736bc571b0b1941/fonttools-4.60.1-cp311-cp311-macosx_10_9_universal2.whl", hash = "sha256:7b4c32e232a71f63a5d00259ca3d88345ce2a43295bb049d21061f338124246f", size = 2831872, upload-time = "2025-09-29T21:11:20.329Z" },
+    { url = "https://files.pythonhosted.org/packages/6b/47/3c63158459c95093be9618794acb1067b3f4d30dcc5c3e8114b70e67a092/fonttools-4.60.1-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:3630e86c484263eaac71d117085d509cbcf7b18f677906824e4bace598fb70d2", size = 2356990, upload-time = "2025-09-29T21:11:22.754Z" },
+    { url = "https://files.pythonhosted.org/packages/94/dd/1934b537c86fcf99f9761823f1fc37a98fbd54568e8e613f29a90fed95a9/fonttools-4.60.1-cp311-cp311-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:5c1015318e4fec75dd4943ad5f6a206d9727adf97410d58b7e32ab644a807914", size = 5042189, upload-time = "2025-09-29T21:11:25.061Z" },
+    { url = "https://files.pythonhosted.org/packages/d2/d2/9f4e4c4374dd1daa8367784e1bd910f18ba886db1d6b825b12edf6db3edc/fonttools-4.60.1-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:e6c58beb17380f7c2ea181ea11e7db8c0ceb474c9dd45f48e71e2cb577d146a1", size = 4978683, upload-time = "2025-09-29T21:11:27.693Z" },
+    { url = "https://files.pythonhosted.org/packages/cc/c4/0fb2dfd1ecbe9a07954cc13414713ed1eab17b1c0214ef07fc93df234a47/fonttools-4.60.1-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:ec3681a0cb34c255d76dd9d865a55f260164adb9fa02628415cdc2d43ee2c05d", size = 5021372, upload-time = "2025-09-29T21:11:30.257Z" },
+    { url = "https://files.pythonhosted.org/packages/0c/d5/495fc7ae2fab20223cc87179a8f50f40f9a6f821f271ba8301ae12bb580f/fonttools-4.60.1-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:f4b5c37a5f40e4d733d3bbaaef082149bee5a5ea3156a785ff64d949bd1353fa", size = 5132562, upload-time = "2025-09-29T21:11:32.737Z" },
+    { url = "https://files.pythonhosted.org/packages/bc/fa/021dab618526323c744e0206b3f5c8596a2e7ae9aa38db5948a131123e83/fonttools-4.60.1-cp311-cp311-win32.whl", hash = "sha256:398447f3d8c0c786cbf1209711e79080a40761eb44b27cdafffb48f52bcec258", size = 2230288, upload-time = "2025-09-29T21:11:35.015Z" },
+    { url = "https://files.pythonhosted.org/packages/bb/78/0e1a6d22b427579ea5c8273e1c07def2f325b977faaf60bb7ddc01456cb1/fonttools-4.60.1-cp311-cp311-win_amd64.whl", hash = "sha256:d066ea419f719ed87bc2c99a4a4bfd77c2e5949cb724588b9dd58f3fd90b92bf", size = 2278184, upload-time = "2025-09-29T21:11:37.434Z" },
+    { url = "https://files.pythonhosted.org/packages/e3/f7/a10b101b7a6f8836a5adb47f2791f2075d044a6ca123f35985c42edc82d8/fonttools-4.60.1-cp312-cp312-macosx_10_13_universal2.whl", hash = "sha256:7b0c6d57ab00dae9529f3faf187f2254ea0aa1e04215cf2f1a8ec277c96661bc", size = 2832953, upload-time = "2025-09-29T21:11:39.616Z" },
+    { url = "https://files.pythonhosted.org/packages/ed/fe/7bd094b59c926acf2304d2151354ddbeb74b94812f3dc943c231db09cb41/fonttools-4.60.1-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:839565cbf14645952d933853e8ade66a463684ed6ed6c9345d0faf1f0e868877", size = 2352706, upload-time = "2025-09-29T21:11:41.826Z" },
+    { url = "https://files.pythonhosted.org/packages/c0/ca/4bb48a26ed95a1e7eba175535fe5805887682140ee0a0d10a88e1de84208/fonttools-4.60.1-cp312-cp312-manylinux1_x86_64.manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:8177ec9676ea6e1793c8a084a90b65a9f778771998eb919d05db6d4b1c0b114c", size = 4923716, upload-time = "2025-09-29T21:11:43.893Z" },
+    { url = "https://files.pythonhosted.org/packages/b8/9f/2cb82999f686c1d1ddf06f6ae1a9117a880adbec113611cc9d22b2fdd465/fonttools-4.60.1-cp312-cp312-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:996a4d1834524adbb423385d5a629b868ef9d774670856c63c9a0408a3063401", size = 4968175, upload-time = "2025-09-29T21:11:46.439Z" },
+    { url = "https://files.pythonhosted.org/packages/18/79/be569699e37d166b78e6218f2cde8c550204f2505038cdd83b42edc469b9/fonttools-4.60.1-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:a46b2f450bc79e06ef3b6394f0c68660529ed51692606ad7f953fc2e448bc903", size = 4911031, upload-time = "2025-09-29T21:11:48.977Z" },
+    { url = "https://files.pythonhosted.org/packages/cc/9f/89411cc116effaec5260ad519162f64f9c150e5522a27cbb05eb62d0c05b/fonttools-4.60.1-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:6ec722ee589e89a89f5b7574f5c45604030aa6ae24cb2c751e2707193b466fed", size = 5062966, upload-time = "2025-09-29T21:11:54.344Z" },
+    { url = "https://files.pythonhosted.org/packages/62/a1/f888221934b5731d46cb9991c7a71f30cb1f97c0ef5fcf37f8da8fce6c8e/fonttools-4.60.1-cp312-cp312-win32.whl", hash = "sha256:b2cf105cee600d2de04ca3cfa1f74f1127f8455b71dbad02b9da6ec266e116d6", size = 2218750, upload-time = "2025-09-29T21:11:56.601Z" },
+    { url = "https://files.pythonhosted.org/packages/88/8f/a55b5550cd33cd1028601df41acd057d4be20efa5c958f417b0c0613924d/fonttools-4.60.1-cp312-cp312-win_amd64.whl", hash = "sha256:992775c9fbe2cf794786fa0ffca7f09f564ba3499b8fe9f2f80bd7197db60383", size = 2267026, upload-time = "2025-09-29T21:11:58.852Z" },
+    { url = "https://files.pythonhosted.org/packages/7c/5b/cdd2c612277b7ac7ec8c0c9bc41812c43dc7b2d5f2b0897e15fdf5a1f915/fonttools-4.60.1-cp313-cp313-macosx_10_13_universal2.whl", hash = "sha256:6f68576bb4bbf6060c7ab047b1574a1ebe5c50a17de62830079967b211059ebb", size = 2825777, upload-time = "2025-09-29T21:12:01.22Z" },
+    { url = "https://files.pythonhosted.org/packages/d6/8a/de9cc0540f542963ba5e8f3a1f6ad48fa211badc3177783b9d5cadf79b5d/fonttools-4.60.1-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:eedacb5c5d22b7097482fa834bda0dafa3d914a4e829ec83cdea2a01f8c813c4", size = 2348080, upload-time = "2025-09-29T21:12:03.785Z" },
+    { url = "https://files.pythonhosted.org/packages/2d/8b/371ab3cec97ee3fe1126b3406b7abd60c8fec8975fd79a3c75cdea0c3d83/fonttools-4.60.1-cp313-cp313-manylinux1_x86_64.manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:b33a7884fabd72bdf5f910d0cf46be50dce86a0362a65cfc746a4168c67eb96c", size = 4903082, upload-time = "2025-09-29T21:12:06.382Z" },
+    { url = "https://files.pythonhosted.org/packages/04/05/06b1455e4bc653fcb2117ac3ef5fa3a8a14919b93c60742d04440605d058/fonttools-4.60.1-cp313-cp313-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:2409d5fb7b55fd70f715e6d34e7a6e4f7511b8ad29a49d6df225ee76da76dd77", size = 4960125, upload-time = "2025-09-29T21:12:09.314Z" },
+    { url = "https://files.pythonhosted.org/packages/8e/37/f3b840fcb2666f6cb97038793606bdd83488dca2d0b0fc542ccc20afa668/fonttools-4.60.1-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:c8651e0d4b3bdeda6602b85fdc2abbefc1b41e573ecb37b6779c4ca50753a199", size = 4901454, upload-time = "2025-09-29T21:12:11.931Z" },
+    { url = "https://files.pythonhosted.org/packages/fd/9e/eb76f77e82f8d4a46420aadff12cec6237751b0fb9ef1de373186dcffb5f/fonttools-4.60.1-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:145daa14bf24824b677b9357c5e44fd8895c2a8f53596e1b9ea3496081dc692c", size = 5044495, upload-time = "2025-09-29T21:12:15.241Z" },
+    { url = "https://files.pythonhosted.org/packages/f8/b3/cede8f8235d42ff7ae891bae8d619d02c8ac9fd0cfc450c5927a6200c70d/fonttools-4.60.1-cp313-cp313-win32.whl", hash = "sha256:2299df884c11162617a66b7c316957d74a18e3758c0274762d2cc87df7bc0272", size = 2217028, upload-time = "2025-09-29T21:12:17.96Z" },
+    { url = "https://files.pythonhosted.org/packages/75/4d/b022c1577807ce8b31ffe055306ec13a866f2337ecee96e75b24b9b753ea/fonttools-4.60.1-cp313-cp313-win_amd64.whl", hash = "sha256:a3db56f153bd4c5c2b619ab02c5db5192e222150ce5a1bc10f16164714bc39ac", size = 2266200, upload-time = "2025-09-29T21:12:20.14Z" },
+    { url = "https://files.pythonhosted.org/packages/9a/83/752ca11c1aa9a899b793a130f2e466b79ea0cf7279c8d79c178fc954a07b/fonttools-4.60.1-cp314-cp314-macosx_10_13_universal2.whl", hash = "sha256:a884aef09d45ba1206712c7dbda5829562d3fea7726935d3289d343232ecb0d3", size = 2822830, upload-time = "2025-09-29T21:12:24.406Z" },
+    { url = "https://files.pythonhosted.org/packages/57/17/bbeab391100331950a96ce55cfbbff27d781c1b85ebafb4167eae50d9fe3/fonttools-4.60.1-cp314-cp314-macosx_10_13_x86_64.whl", hash = "sha256:8a44788d9d91df72d1a5eac49b31aeb887a5f4aab761b4cffc4196c74907ea85", size = 2345524, upload-time = "2025-09-29T21:12:26.819Z" },
+    { url = "https://files.pythonhosted.org/packages/3d/2e/d4831caa96d85a84dd0da1d9f90d81cec081f551e0ea216df684092c6c97/fonttools-4.60.1-cp314-cp314-manylinux1_x86_64.manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:e852d9dda9f93ad3651ae1e3bb770eac544ec93c3807888798eccddf84596537", size = 4843490, upload-time = "2025-09-29T21:12:29.123Z" },
+    { url = "https://files.pythonhosted.org/packages/49/13/5e2ea7c7a101b6fc3941be65307ef8df92cbbfa6ec4804032baf1893b434/fonttools-4.60.1-cp314-cp314-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:154cb6ee417e417bf5f7c42fe25858c9140c26f647c7347c06f0cc2d47eff003", size = 4944184, upload-time = "2025-09-29T21:12:31.414Z" },
+    { url = "https://files.pythonhosted.org/packages/0c/2b/cf9603551c525b73fc47c52ee0b82a891579a93d9651ed694e4e2cd08bb8/fonttools-4.60.1-cp314-cp314-musllinux_1_2_aarch64.whl", hash = "sha256:5664fd1a9ea7f244487ac8f10340c4e37664675e8667d6fee420766e0fb3cf08", size = 4890218, upload-time = "2025-09-29T21:12:33.936Z" },
+    { url = "https://files.pythonhosted.org/packages/fd/2f/933d2352422e25f2376aae74f79eaa882a50fb3bfef3c0d4f50501267101/fonttools-4.60.1-cp314-cp314-musllinux_1_2_x86_64.whl", hash = "sha256:583b7f8e3c49486e4d489ad1deacfb8d5be54a8ef34d6df824f6a171f8511d99", size = 4999324, upload-time = "2025-09-29T21:12:36.637Z" },
+    { url = "https://files.pythonhosted.org/packages/38/99/234594c0391221f66216bc2c886923513b3399a148defaccf81dc3be6560/fonttools-4.60.1-cp314-cp314-win32.whl", hash = "sha256:66929e2ea2810c6533a5184f938502cfdaea4bc3efb7130d8cc02e1c1b4108d6", size = 2220861, upload-time = "2025-09-29T21:12:39.108Z" },
+    { url = "https://files.pythonhosted.org/packages/3e/1d/edb5b23726dde50fc4068e1493e4fc7658eeefcaf75d4c5ffce067d07ae5/fonttools-4.60.1-cp314-cp314-win_amd64.whl", hash = "sha256:f3d5be054c461d6a2268831f04091dc82753176f6ea06dc6047a5e168265a987", size = 2270934, upload-time = "2025-09-29T21:12:41.339Z" },
+    { url = "https://files.pythonhosted.org/packages/fb/da/1392aaa2170adc7071fe7f9cfd181a5684a7afcde605aebddf1fb4d76df5/fonttools-4.60.1-cp314-cp314t-macosx_10_13_universal2.whl", hash = "sha256:b6379e7546ba4ae4b18f8ae2b9bc5960936007a1c0e30b342f662577e8bc3299", size = 2894340, upload-time = "2025-09-29T21:12:43.774Z" },
+    { url = "https://files.pythonhosted.org/packages/bf/a7/3b9f16e010d536ce567058b931a20b590d8f3177b2eda09edd92e392375d/fonttools-4.60.1-cp314-cp314t-macosx_10_13_x86_64.whl", hash = "sha256:9d0ced62b59e0430b3690dbc5373df1c2aa7585e9a8ce38eff87f0fd993c5b01", size = 2375073, upload-time = "2025-09-29T21:12:46.437Z" },
+    { url = "https://files.pythonhosted.org/packages/9b/b5/e9bcf51980f98e59bb5bb7c382a63c6f6cac0eec5f67de6d8f2322382065/fonttools-4.60.1-cp314-cp314t-manylinux1_x86_64.manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:875cb7764708b3132637f6c5fb385b16eeba0f7ac9fa45a69d35e09b47045801", size = 4849758, upload-time = "2025-09-29T21:12:48.694Z" },
+    { url = "https://files.pythonhosted.org/packages/e3/dc/1d2cf7d1cba82264b2f8385db3f5960e3d8ce756b4dc65b700d2c496f7e9/fonttools-4.60.1-cp314-cp314t-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:a184b2ea57b13680ab6d5fbde99ccef152c95c06746cb7718c583abd8f945ccc", size = 5085598, upload-time = "2025-09-29T21:12:51.081Z" },
+    { url = "https://files.pythonhosted.org/packages/5d/4d/279e28ba87fb20e0c69baf72b60bbf1c4d873af1476806a7b5f2b7fac1ff/fonttools-4.60.1-cp314-cp314t-musllinux_1_2_aarch64.whl", hash = "sha256:026290e4ec76583881763fac284aca67365e0be9f13a7fb137257096114cb3bc", size = 4957603, upload-time = "2025-09-29T21:12:53.423Z" },
+    { url = "https://files.pythonhosted.org/packages/78/d4/ff19976305e0c05aa3340c805475abb00224c954d3c65e82c0a69633d55d/fonttools-4.60.1-cp314-cp314t-musllinux_1_2_x86_64.whl", hash = "sha256:f0e8817c7d1a0c2eedebf57ef9a9896f3ea23324769a9a2061a80fe8852705ed", size = 4974184, upload-time = "2025-09-29T21:12:55.962Z" },
+    { url = "https://files.pythonhosted.org/packages/63/22/8553ff6166f5cd21cfaa115aaacaa0dc73b91c079a8cfd54a482cbc0f4f5/fonttools-4.60.1-cp314-cp314t-win32.whl", hash = "sha256:1410155d0e764a4615774e5c2c6fc516259fe3eca5882f034eb9bfdbee056259", size = 2282241, upload-time = "2025-09-29T21:12:58.179Z" },
+    { url = "https://files.pythonhosted.org/packages/8a/cb/fa7b4d148e11d5a72761a22e595344133e83a9507a4c231df972e657579b/fonttools-4.60.1-cp314-cp314t-win_amd64.whl", hash = "sha256:022beaea4b73a70295b688f817ddc24ed3e3418b5036ffcd5658141184ef0d0c", size = 2345760, upload-time = "2025-09-29T21:13:00.375Z" },
+    { url = "https://files.pythonhosted.org/packages/a4/7f/1c9a6cc6e7374ab59bbe91cb3b8a65ce0907c59f8f35368bb3bf941bd458/fonttools-4.60.1-cp39-cp39-macosx_10_9_universal2.whl", hash = "sha256:122e1a8ada290423c493491d002f622b1992b1ab0b488c68e31c413390dc7eb2", size = 2816178, upload-time = "2025-09-29T21:13:02.915Z" },
+    { url = "https://files.pythonhosted.org/packages/ca/ac/acb4dcf1932566c0b57b5261f93a8b97cb3ebae08d07aff1288e7c9d7faa/fonttools-4.60.1-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:a140761c4ff63d0cb9256ac752f230460ee225ccef4ad8f68affc723c88e2036", size = 2349175, upload-time = "2025-09-29T21:13:05.432Z" },
+    { url = "https://files.pythonhosted.org/packages/3e/ac/0b2f8d62c857adfe96551d56abbbc3d2eda2e4715a2e91c5eb7815bb38e1/fonttools-4.60.1-cp39-cp39-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:0eae96373e4b7c9e45d099d7a523444e3554360927225c1cdae221a58a45b856", size = 4840452, upload-time = "2025-09-29T21:13:08.679Z" },
+    { url = "https://files.pythonhosted.org/packages/2d/e1/b2e2ae805f263507e050f1ebfc2fb3654124161f3bea466a1b2a4485c705/fonttools-4.60.1-cp39-cp39-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:596ecaca36367027d525b3b426d8a8208169d09edcf8c7506aceb3a38bfb55c7", size = 4774040, upload-time = "2025-09-29T21:13:11.424Z" },
+    { url = "https://files.pythonhosted.org/packages/9d/91/05949ba6f757014f343632b142543576eb100aeb261c036b86e7d1fc50f0/fonttools-4.60.1-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:2ee06fc57512144d8b0445194c2da9f190f61ad51e230f14836286470c99f854", size = 4823746, upload-time = "2025-09-29T21:13:14.08Z" },
+    { url = "https://files.pythonhosted.org/packages/1b/cf/db9a1bd8d835dc17f09104f83b9d8c078d7bebbaaa9bd41378bf10f025de/fonttools-4.60.1-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:b42d86938e8dda1cd9a1a87a6d82f1818eaf933348429653559a458d027446da", size = 4934001, upload-time = "2025-09-29T21:13:16.435Z" },
+    { url = "https://files.pythonhosted.org/packages/87/4a/c58503524f7e6c73eb33b944f27535460e1050a58c99bd5b441242fcca86/fonttools-4.60.1-cp39-cp39-win32.whl", hash = "sha256:8b4eb332f9501cb1cd3d4d099374a1e1306783ff95489a1026bde9eb02ccc34a", size = 1499091, upload-time = "2025-09-29T21:13:19.072Z" },
+    { url = "https://files.pythonhosted.org/packages/69/8f/3394936411aec5f26a1fdf8d7fdc1da7c276e0c627cd71b7b266b2431681/fonttools-4.60.1-cp39-cp39-win_amd64.whl", hash = "sha256:7473a8ed9ed09aeaa191301244a5a9dbe46fe0bf54f9d6cd21d83044c3321217", size = 1543835, upload-time = "2025-09-29T21:13:21.606Z" },
+    { url = "https://files.pythonhosted.org/packages/c7/93/0dd45cd283c32dea1545151d8c3637b4b8c53cdb3a625aeb2885b184d74d/fonttools-4.60.1-py3-none-any.whl", hash = "sha256:906306ac7afe2156fcf0042173d6ebbb05416af70f6b370967b47f8f00103bbb", size = 1143175, upload-time = "2025-09-29T21:13:24.134Z" },
+]
+
+[[package]]
+name = "fsspec"
+version = "2025.9.0"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/de/e0/bab50af11c2d75c9c4a2a26a5254573c0bd97cea152254401510950486fa/fsspec-2025.9.0.tar.gz", hash = "sha256:19fd429483d25d28b65ec68f9f4adc16c17ea2c7c7bf54ec61360d478fb19c19", size = 304847, upload-time = "2025-09-02T19:10:49.215Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/47/71/70db47e4f6ce3e5c37a607355f80da8860a33226be640226ac52cb05ef2e/fsspec-2025.9.0-py3-none-any.whl", hash = "sha256:530dc2a2af60a414a832059574df4a6e10cce927f6f4a78209390fe38955cfb7", size = 199289, upload-time = "2025-09-02T19:10:47.708Z" },
+]
+
+[[package]]
+name = "identify"
+version = "2.6.1"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/29/bb/25024dbcc93516c492b75919e76f389bac754a3e4248682fba32b250c880/identify-2.6.1.tar.gz", hash = "sha256:91478c5fb7c3aac5ff7bf9b4344f803843dc586832d5f110d672b19aa1984c98", size = 99097, upload-time = "2024-09-14T23:50:32.513Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/7d/0c/4ef72754c050979fdcc06c744715ae70ea37e734816bb6514f79df77a42f/identify-2.6.1-py2.py3-none-any.whl", hash = "sha256:53863bcac7caf8d2ed85bd20312ea5dcfc22226800f6d6881f232d861db5a8f0", size = 98972, upload-time = "2024-09-14T23:50:30.747Z" },
+]
+
+[[package]]
+name = "identify"
+version = "2.6.15"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/ff/e7/685de97986c916a6d93b3876139e00eef26ad5bbbd61925d670ae8013449/identify-2.6.15.tar.gz", hash = "sha256:e4f4864b96c6557ef2a1e1c951771838f4edc9df3a72ec7118b338801b11c7bf", size = 99311, upload-time = "2025-10-02T17:43:40.631Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/0f/1c/e5fd8f973d4f375adb21565739498e2e9a1e54c858a97b9a8ccfdc81da9b/identify-2.6.15-py2.py3-none-any.whl", hash = "sha256:1181ef7608e00704db228516541eb83a88a9f94433a8c80bb9b5bd54b1d81757", size = 99183, upload-time = "2025-10-02T17:43:39.137Z" },
+]
+
+[[package]]
+name = "idna"
+version = "3.10"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/f1/70/7703c29685631f5a7590aa73f1f1d3fa9a380e654b86af429e0934a32f7d/idna-3.10.tar.gz", hash = "sha256:12f65c9b470abda6dc35cf8e63cc574b1c52b11df2c86030af0ac09b01b13ea9", size = 190490, upload-time = "2024-09-15T18:07:39.745Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/76/c6/c88e154df9c4e1a2a66ccf0005a88dfb2650c1dffb6f5ce603dfbd452ce3/idna-3.10-py3-none-any.whl", hash = "sha256:946d195a0d259cbba61165e88e65941f16e9b36ea6ddb97f00452bae8b1287d3", size = 70442, upload-time = "2024-09-15T18:07:37.964Z" },
+]
+
+[[package]]
+name = "imagesize"
+version = "1.4.1"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/a7/84/62473fb57d61e31fef6e36d64a179c8781605429fd927b5dd608c997be31/imagesize-1.4.1.tar.gz", hash = "sha256:69150444affb9cb0d5cc5a92b3676f0b2fb7cd9ae39e947a5e11a36b4497cd4a", size = 1280026, upload-time = "2022-07-01T12:21:05.687Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/ff/62/85c4c919272577931d407be5ba5d71c20f0b616d31a0befe0ae45bb79abd/imagesize-1.4.1-py2.py3-none-any.whl", hash = "sha256:0d8d18d08f840c19d0ee7ca1fd82490fdc3729b7ac93f49870406ddde8ef8d8b", size = 8769, upload-time = "2022-07-01T12:21:02.467Z" },
+]
+
+[[package]]
+name = "importlib-metadata"
+version = "8.5.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "zipp", version = "3.20.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/cd/12/33e59336dca5be0c398a7482335911a33aa0e20776128f038019f1a95f1b/importlib_metadata-8.5.0.tar.gz", hash = "sha256:71522656f0abace1d072b9e5481a48f07c138e00f079c38c8f883823f9c26bd7", size = 55304, upload-time = "2024-09-11T14:56:08.937Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/a0/d9/a1e041c5e7caa9a05c925f4bdbdfb7f006d1f74996af53467bc394c97be7/importlib_metadata-8.5.0-py3-none-any.whl", hash = "sha256:45e54197d28b7a7f1559e60b95e7c567032b602131fbd588f1497f47880aa68b", size = 26514, upload-time = "2024-09-11T14:56:07.019Z" },
+]
+
+[[package]]
+name = "importlib-metadata"
+version = "8.7.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "zipp", version = "3.23.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/76/66/650a33bd90f786193e4de4b3ad86ea60b53c89b669a5c7be931fac31cdb0/importlib_metadata-8.7.0.tar.gz", hash = "sha256:d13b81ad223b890aa16c5471f2ac3056cf76c5f10f82d6f9292f0b415f389000", size = 56641, upload-time = "2025-04-27T15:29:01.736Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/20/b0/36bd937216ec521246249be3bf9855081de4c5e06a0c9b4219dbeda50373/importlib_metadata-8.7.0-py3-none-any.whl", hash = "sha256:e5dd1551894c77868a30651cef00984d50e1002d06942a7101d34870c5f02afd", size = 27656, upload-time = "2025-04-27T15:29:00.214Z" },
+]
+
+[[package]]
+name = "importlib-resources"
+version = "6.4.5"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "zipp", version = "3.20.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/98/be/f3e8c6081b684f176b761e6a2fef02a0be939740ed6f54109a2951d806f3/importlib_resources-6.4.5.tar.gz", hash = "sha256:980862a1d16c9e147a59603677fa2aa5fd82b87f223b6cb870695bcfce830065", size = 43372, upload-time = "2024-09-09T17:03:14.677Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/e1/6a/4604f9ae2fa62ef47b9de2fa5ad599589d28c9fd1d335f32759813dfa91e/importlib_resources-6.4.5-py3-none-any.whl", hash = "sha256:ac29d5f956f01d5e4bb63102a5a19957f1b9175e45649977264a1416783bb717", size = 36115, upload-time = "2024-09-09T17:03:13.39Z" },
+]
+
+[[package]]
+name = "importlib-resources"
+version = "6.5.2"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "zipp", version = "3.23.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/cf/8c/f834fbf984f691b4f7ff60f50b514cc3de5cc08abfc3295564dd89c5e2e7/importlib_resources-6.5.2.tar.gz", hash = "sha256:185f87adef5bcc288449d98fb4fba07cea78bc036455dd44c5fc4a2fe78fed2c", size = 44693, upload-time = "2025-01-03T18:51:56.698Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/a4/ed/1f1afb2e9e7f38a545d628f864d562a5ae64fe6f7a10e28ffb9b185b4e89/importlib_resources-6.5.2-py3-none-any.whl", hash = "sha256:789cfdc3ed28c78b67a06acb8126751ced69a3d5f79c095a98298cd8a760ccec", size = 37461, upload-time = "2025-01-03T18:51:54.306Z" },
+]
+
+[[package]]
+name = "jinja2"
+version = "3.1.6"
+source = { registry = "https://pypi.org/simple" }
+dependencies = [
+    { name = "markupsafe", version = "2.1.5", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "markupsafe", version = "3.0.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/df/bf/f7da0350254c0ed7c72f3e33cef02e048281fec7ecec5f032d4aac52226b/jinja2-3.1.6.tar.gz", hash = "sha256:0137fb05990d35f1275a587e9aee6d56da821fc83491a0fb838183be43f66d6d", size = 245115, upload-time = "2025-03-05T20:05:02.478Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/62/a1/3d680cbfd5f4b8f15abc1d571870c5fc3e594bb582bc3b64ea099db13e56/jinja2-3.1.6-py3-none-any.whl", hash = "sha256:85ece4451f492d0c13c5dd7c13a64681a86afae63a5f347908daf103ce6d2f67", size = 134899, upload-time = "2025-03-05T20:05:00.369Z" },
+]
+
+[[package]]
+name = "kiwisolver"
+version = "1.4.7"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/85/4d/2255e1c76304cbd60b48cee302b66d1dde4468dc5b1160e4b7cb43778f2a/kiwisolver-1.4.7.tar.gz", hash = "sha256:9893ff81bd7107f7b685d3017cc6583daadb4fc26e4a888350df530e41980a60", size = 97286, upload-time = "2024-09-04T09:39:44.302Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/97/14/fc943dd65268a96347472b4fbe5dcc2f6f55034516f80576cd0dd3a8930f/kiwisolver-1.4.7-cp310-cp310-macosx_10_9_universal2.whl", hash = "sha256:8a9c83f75223d5e48b0bc9cb1bf2776cf01563e00ade8775ffe13b0b6e1af3a6", size = 122440, upload-time = "2024-09-04T09:03:44.9Z" },
+    { url = "https://files.pythonhosted.org/packages/1e/46/e68fed66236b69dd02fcdb506218c05ac0e39745d696d22709498896875d/kiwisolver-1.4.7-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:58370b1ffbd35407444d57057b57da5d6549d2d854fa30249771775c63b5fe17", size = 65758, upload-time = "2024-09-04T09:03:46.582Z" },
+    { url = "https://files.pythonhosted.org/packages/ef/fa/65de49c85838681fc9cb05de2a68067a683717321e01ddafb5b8024286f0/kiwisolver-1.4.7-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:aa0abdf853e09aff551db11fce173e2177d00786c688203f52c87ad7fcd91ef9", size = 64311, upload-time = "2024-09-04T09:03:47.973Z" },
+    { url = "https://files.pythonhosted.org/packages/42/9c/cc8d90f6ef550f65443bad5872ffa68f3dee36de4974768628bea7c14979/kiwisolver-1.4.7-cp310-cp310-manylinux_2_12_i686.manylinux2010_i686.whl", hash = "sha256:8d53103597a252fb3ab8b5845af04c7a26d5e7ea8122303dd7a021176a87e8b9", size = 1637109, upload-time = "2024-09-04T09:03:49.281Z" },
+    { url = "https://files.pythonhosted.org/packages/55/91/0a57ce324caf2ff5403edab71c508dd8f648094b18cfbb4c8cc0fde4a6ac/kiwisolver-1.4.7-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.whl", hash = "sha256:88f17c5ffa8e9462fb79f62746428dd57b46eb931698e42e990ad63103f35e6c", size = 1617814, upload-time = "2024-09-04T09:03:51.444Z" },
+    { url = "https://files.pythonhosted.org/packages/12/5d/c36140313f2510e20207708adf36ae4919416d697ee0236b0ddfb6fd1050/kiwisolver-1.4.7-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:88a9ca9c710d598fd75ee5de59d5bda2684d9db36a9f50b6125eaea3969c2599", size = 1400881, upload-time = "2024-09-04T09:03:53.357Z" },
+    { url = "https://files.pythonhosted.org/packages/56/d0/786e524f9ed648324a466ca8df86298780ef2b29c25313d9a4f16992d3cf/kiwisolver-1.4.7-cp310-cp310-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:f4d742cb7af1c28303a51b7a27aaee540e71bb8e24f68c736f6f2ffc82f2bf05", size = 1512972, upload-time = "2024-09-04T09:03:55.082Z" },
+    { url = "https://files.pythonhosted.org/packages/67/5a/77851f2f201e6141d63c10a0708e996a1363efaf9e1609ad0441b343763b/kiwisolver-1.4.7-cp310-cp310-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:e28c7fea2196bf4c2f8d46a0415c77a1c480cc0724722f23d7410ffe9842c407", size = 1444787, upload-time = "2024-09-04T09:03:56.588Z" },
+    { url = "https://files.pythonhosted.org/packages/06/5f/1f5eaab84355885e224a6fc8d73089e8713dc7e91c121f00b9a1c58a2195/kiwisolver-1.4.7-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:e968b84db54f9d42046cf154e02911e39c0435c9801681e3fc9ce8a3c4130278", size = 2199212, upload-time = "2024-09-04T09:03:58.557Z" },
+    { url = "https://files.pythonhosted.org/packages/b5/28/9152a3bfe976a0ae21d445415defc9d1cd8614b2910b7614b30b27a47270/kiwisolver-1.4.7-cp310-cp310-musllinux_1_2_i686.whl", hash = "sha256:0c18ec74c0472de033e1bebb2911c3c310eef5649133dd0bedf2a169a1b269e5", size = 2346399, upload-time = "2024-09-04T09:04:00.178Z" },
+    { url = "https://files.pythonhosted.org/packages/26/f6/453d1904c52ac3b400f4d5e240ac5fec25263716723e44be65f4d7149d13/kiwisolver-1.4.7-cp310-cp310-musllinux_1_2_ppc64le.whl", hash = "sha256:8f0ea6da6d393d8b2e187e6a5e3fb81f5862010a40c3945e2c6d12ae45cfb2ad", size = 2308688, upload-time = "2024-09-04T09:04:02.216Z" },
+    { url = "https://files.pythonhosted.org/packages/5a/9a/d4968499441b9ae187e81745e3277a8b4d7c60840a52dc9d535a7909fac3/kiwisolver-1.4.7-cp310-cp310-musllinux_1_2_s390x.whl", hash = "sha256:f106407dda69ae456dd1227966bf445b157ccc80ba0dff3802bb63f30b74e895", size = 2445493, upload-time = "2024-09-04T09:04:04.571Z" },
+    { url = "https://files.pythonhosted.org/packages/07/c9/032267192e7828520dacb64dfdb1d74f292765f179e467c1cba97687f17d/kiwisolver-1.4.7-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:84ec80df401cfee1457063732d90022f93951944b5b58975d34ab56bb150dfb3", size = 2262191, upload-time = "2024-09-04T09:04:05.969Z" },
+    { url = "https://files.pythonhosted.org/packages/6c/ad/db0aedb638a58b2951da46ddaeecf204be8b4f5454df020d850c7fa8dca8/kiwisolver-1.4.7-cp310-cp310-win32.whl", hash = "sha256:71bb308552200fb2c195e35ef05de12f0c878c07fc91c270eb3d6e41698c3bcc", size = 46644, upload-time = "2024-09-04T09:04:07.408Z" },
+    { url = "https://files.pythonhosted.org/packages/12/ca/d0f7b7ffbb0be1e7c2258b53554efec1fd652921f10d7d85045aff93ab61/kiwisolver-1.4.7-cp310-cp310-win_amd64.whl", hash = "sha256:44756f9fd339de0fb6ee4f8c1696cfd19b2422e0d70b4cefc1cc7f1f64045a8c", size = 55877, upload-time = "2024-09-04T09:04:08.869Z" },
+    { url = "https://files.pythonhosted.org/packages/97/6c/cfcc128672f47a3e3c0d918ecb67830600078b025bfc32d858f2e2d5c6a4/kiwisolver-1.4.7-cp310-cp310-win_arm64.whl", hash = "sha256:78a42513018c41c2ffd262eb676442315cbfe3c44eed82385c2ed043bc63210a", size = 48347, upload-time = "2024-09-04T09:04:10.106Z" },
+    { url = "https://files.pythonhosted.org/packages/e9/44/77429fa0a58f941d6e1c58da9efe08597d2e86bf2b2cce6626834f49d07b/kiwisolver-1.4.7-cp311-cp311-macosx_10_9_universal2.whl", hash = "sha256:d2b0e12a42fb4e72d509fc994713d099cbb15ebf1103545e8a45f14da2dfca54", size = 122442, upload-time = "2024-09-04T09:04:11.432Z" },
+    { url = "https://files.pythonhosted.org/packages/e5/20/8c75caed8f2462d63c7fd65e16c832b8f76cda331ac9e615e914ee80bac9/kiwisolver-1.4.7-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:2a8781ac3edc42ea4b90bc23e7d37b665d89423818e26eb6df90698aa2287c95", size = 65762, upload-time = "2024-09-04T09:04:12.468Z" },
+    { url = "https://files.pythonhosted.org/packages/f4/98/fe010f15dc7230f45bc4cf367b012d651367fd203caaa992fd1f5963560e/kiwisolver-1.4.7-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:46707a10836894b559e04b0fd143e343945c97fd170d69a2d26d640b4e297935", size = 64319, upload-time = "2024-09-04T09:04:13.635Z" },
+    { url = "https://files.pythonhosted.org/packages/8b/1b/b5d618f4e58c0675654c1e5051bcf42c776703edb21c02b8c74135541f60/kiwisolver-1.4.7-cp311-cp311-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:ef97b8df011141c9b0f6caf23b29379f87dd13183c978a30a3c546d2c47314cb", size = 1334260, upload-time = "2024-09-04T09:04:14.878Z" },
+    { url = "https://files.pythonhosted.org/packages/b8/01/946852b13057a162a8c32c4c8d2e9ed79f0bb5d86569a40c0b5fb103e373/kiwisolver-1.4.7-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:3ab58c12a2cd0fc769089e6d38466c46d7f76aced0a1f54c77652446733d2d02", size = 1426589, upload-time = "2024-09-04T09:04:16.514Z" },
+    { url = "https://files.pythonhosted.org/packages/70/d1/c9f96df26b459e15cf8a965304e6e6f4eb291e0f7a9460b4ad97b047561e/kiwisolver-1.4.7-cp311-cp311-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:803b8e1459341c1bb56d1c5c010406d5edec8a0713a0945851290a7930679b51", size = 1541080, upload-time = "2024-09-04T09:04:18.322Z" },
+    { url = "https://files.pythonhosted.org/packages/d3/73/2686990eb8b02d05f3de759d6a23a4ee7d491e659007dd4c075fede4b5d0/kiwisolver-1.4.7-cp311-cp311-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:f9a9e8a507420fe35992ee9ecb302dab68550dedc0da9e2880dd88071c5fb052", size = 1470049, upload-time = "2024-09-04T09:04:20.266Z" },
+    { url = "https://files.pythonhosted.org/packages/a7/4b/2db7af3ed3af7c35f388d5f53c28e155cd402a55432d800c543dc6deb731/kiwisolver-1.4.7-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:18077b53dc3bb490e330669a99920c5e6a496889ae8c63b58fbc57c3d7f33a18", size = 1426376, upload-time = "2024-09-04T09:04:22.419Z" },
+    { url = "https://files.pythonhosted.org/packages/05/83/2857317d04ea46dc5d115f0df7e676997bbd968ced8e2bd6f7f19cfc8d7f/kiwisolver-1.4.7-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:6af936f79086a89b3680a280c47ea90b4df7047b5bdf3aa5c524bbedddb9e545", size = 2222231, upload-time = "2024-09-04T09:04:24.526Z" },
+    { url = "https://files.pythonhosted.org/packages/0d/b5/866f86f5897cd4ab6d25d22e403404766a123f138bd6a02ecb2cdde52c18/kiwisolver-1.4.7-cp311-cp311-musllinux_1_2_i686.whl", hash = "sha256:3abc5b19d24af4b77d1598a585b8a719beb8569a71568b66f4ebe1fb0449460b", size = 2368634, upload-time = "2024-09-04T09:04:25.899Z" },
+    { url = "https://files.pythonhosted.org/packages/c1/ee/73de8385403faba55f782a41260210528fe3273d0cddcf6d51648202d6d0/kiwisolver-1.4.7-cp311-cp311-musllinux_1_2_ppc64le.whl", hash = "sha256:933d4de052939d90afbe6e9d5273ae05fb836cc86c15b686edd4b3560cc0ee36", size = 2329024, upload-time = "2024-09-04T09:04:28.523Z" },
+    { url = "https://files.pythonhosted.org/packages/a1/e7/cd101d8cd2cdfaa42dc06c433df17c8303d31129c9fdd16c0ea37672af91/kiwisolver-1.4.7-cp311-cp311-musllinux_1_2_s390x.whl", hash = "sha256:65e720d2ab2b53f1f72fb5da5fb477455905ce2c88aaa671ff0a447c2c80e8e3", size = 2468484, upload-time = "2024-09-04T09:04:30.547Z" },
+    { url = "https://files.pythonhosted.org/packages/e1/72/84f09d45a10bc57a40bb58b81b99d8f22b58b2040c912b7eb97ebf625bf2/kiwisolver-1.4.7-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:3bf1ed55088f214ba6427484c59553123fdd9b218a42bbc8c6496d6754b1e523", size = 2284078, upload-time = "2024-09-04T09:04:33.218Z" },
+    { url = "https://files.pythonhosted.org/packages/d2/d4/71828f32b956612dc36efd7be1788980cb1e66bfb3706e6dec9acad9b4f9/kiwisolver-1.4.7-cp311-cp311-win32.whl", hash = "sha256:4c00336b9dd5ad96d0a558fd18a8b6f711b7449acce4c157e7343ba92dd0cf3d", size = 46645, upload-time = "2024-09-04T09:04:34.371Z" },
+    { url = "https://files.pythonhosted.org/packages/a1/65/d43e9a20aabcf2e798ad1aff6c143ae3a42cf506754bcb6a7ed8259c8425/kiwisolver-1.4.7-cp311-cp311-win_amd64.whl", hash = "sha256:929e294c1ac1e9f615c62a4e4313ca1823ba37326c164ec720a803287c4c499b", size = 56022, upload-time = "2024-09-04T09:04:35.786Z" },
+    { url = "https://files.pythonhosted.org/packages/35/b3/9f75a2e06f1b4ca00b2b192bc2b739334127d27f1d0625627ff8479302ba/kiwisolver-1.4.7-cp311-cp311-win_arm64.whl", hash = "sha256:e33e8fbd440c917106b237ef1a2f1449dfbb9b6f6e1ce17c94cd6a1e0d438376", size = 48536, upload-time = "2024-09-04T09:04:37.525Z" },
+    { url = "https://files.pythonhosted.org/packages/97/9c/0a11c714cf8b6ef91001c8212c4ef207f772dd84540104952c45c1f0a249/kiwisolver-1.4.7-cp312-cp312-macosx_10_9_universal2.whl", hash = "sha256:5360cc32706dab3931f738d3079652d20982511f7c0ac5711483e6eab08efff2", size = 121808, upload-time = "2024-09-04T09:04:38.637Z" },
+    { url = "https://files.pythonhosted.org/packages/f2/d8/0fe8c5f5d35878ddd135f44f2af0e4e1d379e1c7b0716f97cdcb88d4fd27/kiwisolver-1.4.7-cp312-cp312-macosx_10_9_x86_64.whl", hash = "sha256:942216596dc64ddb25adb215c3c783215b23626f8d84e8eff8d6d45c3f29f75a", size = 65531, upload-time = "2024-09-04T09:04:39.694Z" },
+    { url = "https://files.pythonhosted.org/packages/80/c5/57fa58276dfdfa612241d640a64ca2f76adc6ffcebdbd135b4ef60095098/kiwisolver-1.4.7-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:48b571ecd8bae15702e4f22d3ff6a0f13e54d3d00cd25216d5e7f658242065ee", size = 63894, upload-time = "2024-09-04T09:04:41.6Z" },
+    { url = "https://files.pythonhosted.org/packages/8b/e9/26d3edd4c4ad1c5b891d8747a4f81b1b0aba9fb9721de6600a4adc09773b/kiwisolver-1.4.7-cp312-cp312-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:ad42ba922c67c5f219097b28fae965e10045ddf145d2928bfac2eb2e17673640", size = 1369296, upload-time = "2024-09-04T09:04:42.886Z" },
+    { url = "https://files.pythonhosted.org/packages/b6/67/3f4850b5e6cffb75ec40577ddf54f7b82b15269cc5097ff2e968ee32ea7d/kiwisolver-1.4.7-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:612a10bdae23404a72941a0fc8fa2660c6ea1217c4ce0dbcab8a8f6543ea9e7f", size = 1461450, upload-time = "2024-09-04T09:04:46.284Z" },
+    { url = "https://files.pythonhosted.org/packages/52/be/86cbb9c9a315e98a8dc6b1d23c43cffd91d97d49318854f9c37b0e41cd68/kiwisolver-1.4.7-cp312-cp312-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:9e838bba3a3bac0fe06d849d29772eb1afb9745a59710762e4ba3f4cb8424483", size = 1579168, upload-time = "2024-09-04T09:04:47.91Z" },
+    { url = "https://files.pythonhosted.org/packages/0f/00/65061acf64bd5fd34c1f4ae53f20b43b0a017a541f242a60b135b9d1e301/kiwisolver-1.4.7-cp312-cp312-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:22f499f6157236c19f4bbbd472fa55b063db77a16cd74d49afe28992dff8c258", size = 1507308, upload-time = "2024-09-04T09:04:49.465Z" },
+    { url = "https://files.pythonhosted.org/packages/21/e4/c0b6746fd2eb62fe702118b3ca0cb384ce95e1261cfada58ff693aeec08a/kiwisolver-1.4.7-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:693902d433cf585133699972b6d7c42a8b9f8f826ebcaf0132ff55200afc599e", size = 1464186, upload-time = "2024-09-04T09:04:50.949Z" },
+    { url = "https://files.pythonhosted.org/packages/0a/0f/529d0a9fffb4d514f2782c829b0b4b371f7f441d61aa55f1de1c614c4ef3/kiwisolver-1.4.7-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:4e77f2126c3e0b0d055f44513ed349038ac180371ed9b52fe96a32aa071a5107", size = 2247877, upload-time = "2024-09-04T09:04:52.388Z" },
+    { url = "https://files.pythonhosted.org/packages/d1/e1/66603ad779258843036d45adcbe1af0d1a889a07af4635f8b4ec7dccda35/kiwisolver-1.4.7-cp312-cp312-musllinux_1_2_i686.whl", hash = "sha256:657a05857bda581c3656bfc3b20e353c232e9193eb167766ad2dc58b56504948", size = 2404204, upload-time = "2024-09-04T09:04:54.385Z" },
+    { url = "https://files.pythonhosted.org/packages/8d/61/de5fb1ca7ad1f9ab7970e340a5b833d735df24689047de6ae71ab9d8d0e7/kiwisolver-1.4.7-cp312-cp312-musllinux_1_2_ppc64le.whl", hash = "sha256:4bfa75a048c056a411f9705856abfc872558e33c055d80af6a380e3658766038", size = 2352461, upload-time = "2024-09-04T09:04:56.307Z" },
+    { url = "https://files.pythonhosted.org/packages/ba/d2/0edc00a852e369827f7e05fd008275f550353f1f9bcd55db9363d779fc63/kiwisolver-1.4.7-cp312-cp312-musllinux_1_2_s390x.whl", hash = "sha256:34ea1de54beef1c104422d210c47c7d2a4999bdecf42c7b5718fbe59a4cac383", size = 2501358, upload-time = "2024-09-04T09:04:57.922Z" },
+    { url = "https://files.pythonhosted.org/packages/84/15/adc15a483506aec6986c01fb7f237c3aec4d9ed4ac10b756e98a76835933/kiwisolver-1.4.7-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:90da3b5f694b85231cf93586dad5e90e2d71b9428f9aad96952c99055582f520", size = 2314119, upload-time = "2024-09-04T09:04:59.332Z" },
+    { url = "https://files.pythonhosted.org/packages/36/08/3a5bb2c53c89660863a5aa1ee236912269f2af8762af04a2e11df851d7b2/kiwisolver-1.4.7-cp312-cp312-win32.whl", hash = "sha256:18e0cca3e008e17fe9b164b55735a325140a5a35faad8de92dd80265cd5eb80b", size = 46367, upload-time = "2024-09-04T09:05:00.804Z" },
+    { url = "https://files.pythonhosted.org/packages/19/93/c05f0a6d825c643779fc3c70876bff1ac221f0e31e6f701f0e9578690d70/kiwisolver-1.4.7-cp312-cp312-win_amd64.whl", hash = "sha256:58cb20602b18f86f83a5c87d3ee1c766a79c0d452f8def86d925e6c60fbf7bfb", size = 55884, upload-time = "2024-09-04T09:05:01.924Z" },
+    { url = "https://files.pythonhosted.org/packages/d2/f9/3828d8f21b6de4279f0667fb50a9f5215e6fe57d5ec0d61905914f5b6099/kiwisolver-1.4.7-cp312-cp312-win_arm64.whl", hash = "sha256:f5a8b53bdc0b3961f8b6125e198617c40aeed638b387913bf1ce78afb1b0be2a", size = 48528, upload-time = "2024-09-04T09:05:02.983Z" },
+    { url = "https://files.pythonhosted.org/packages/c4/06/7da99b04259b0f18b557a4effd1b9c901a747f7fdd84cf834ccf520cb0b2/kiwisolver-1.4.7-cp313-cp313-macosx_10_13_universal2.whl", hash = "sha256:2e6039dcbe79a8e0f044f1c39db1986a1b8071051efba3ee4d74f5b365f5226e", size = 121913, upload-time = "2024-09-04T09:05:04.072Z" },
+    { url = "https://files.pythonhosted.org/packages/97/f5/b8a370d1aa593c17882af0a6f6755aaecd643640c0ed72dcfd2eafc388b9/kiwisolver-1.4.7-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:a1ecf0ac1c518487d9d23b1cd7139a6a65bc460cd101ab01f1be82ecf09794b6", size = 65627, upload-time = "2024-09-04T09:05:05.119Z" },
+    { url = "https://files.pythonhosted.org/packages/2a/fc/6c0374f7503522539e2d4d1b497f5ebad3f8ed07ab51aed2af988dd0fb65/kiwisolver-1.4.7-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:7ab9ccab2b5bd5702ab0803676a580fffa2aa178c2badc5557a84cc943fcf750", size = 63888, upload-time = "2024-09-04T09:05:06.191Z" },
+    { url = "https://files.pythonhosted.org/packages/bf/3e/0b7172793d0f41cae5c923492da89a2ffcd1adf764c16159ca047463ebd3/kiwisolver-1.4.7-cp313-cp313-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:f816dd2277f8d63d79f9c8473a79fe54047bc0467754962840782c575522224d", size = 1369145, upload-time = "2024-09-04T09:05:07.919Z" },
+    { url = "https://files.pythonhosted.org/packages/77/92/47d050d6f6aced2d634258123f2688fbfef8ded3c5baf2c79d94d91f1f58/kiwisolver-1.4.7-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:cf8bcc23ceb5a1b624572a1623b9f79d2c3b337c8c455405ef231933a10da379", size = 1461448, upload-time = "2024-09-04T09:05:10.01Z" },
+    { url = "https://files.pythonhosted.org/packages/9c/1b/8f80b18e20b3b294546a1adb41701e79ae21915f4175f311a90d042301cf/kiwisolver-1.4.7-cp313-cp313-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:dea0bf229319828467d7fca8c7c189780aa9ff679c94539eed7532ebe33ed37c", size = 1578750, upload-time = "2024-09-04T09:05:11.598Z" },
+    { url = "https://files.pythonhosted.org/packages/a4/fe/fe8e72f3be0a844f257cadd72689c0848c6d5c51bc1d60429e2d14ad776e/kiwisolver-1.4.7-cp313-cp313-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:7c06a4c7cf15ec739ce0e5971b26c93638730090add60e183530d70848ebdd34", size = 1507175, upload-time = "2024-09-04T09:05:13.22Z" },
+    { url = "https://files.pythonhosted.org/packages/39/fa/cdc0b6105d90eadc3bee525fecc9179e2b41e1ce0293caaf49cb631a6aaf/kiwisolver-1.4.7-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:913983ad2deb14e66d83c28b632fd35ba2b825031f2fa4ca29675e665dfecbe1", size = 1463963, upload-time = "2024-09-04T09:05:15.925Z" },
+    { url = "https://files.pythonhosted.org/packages/6e/5c/0c03c4e542720c6177d4f408e56d1c8315899db72d46261a4e15b8b33a41/kiwisolver-1.4.7-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:5337ec7809bcd0f424c6b705ecf97941c46279cf5ed92311782c7c9c2026f07f", size = 2248220, upload-time = "2024-09-04T09:05:17.434Z" },
+    { url = "https://files.pythonhosted.org/packages/3d/ee/55ef86d5a574f4e767df7da3a3a7ff4954c996e12d4fbe9c408170cd7dcc/kiwisolver-1.4.7-cp313-cp313-musllinux_1_2_i686.whl", hash = "sha256:4c26ed10c4f6fa6ddb329a5120ba3b6db349ca192ae211e882970bfc9d91420b", size = 2404463, upload-time = "2024-09-04T09:05:18.997Z" },
+    { url = "https://files.pythonhosted.org/packages/0f/6d/73ad36170b4bff4825dc588acf4f3e6319cb97cd1fb3eb04d9faa6b6f212/kiwisolver-1.4.7-cp313-cp313-musllinux_1_2_ppc64le.whl", hash = "sha256:c619b101e6de2222c1fcb0531e1b17bbffbe54294bfba43ea0d411d428618c27", size = 2352842, upload-time = "2024-09-04T09:05:21.299Z" },
+    { url = "https://files.pythonhosted.org/packages/0b/16/fa531ff9199d3b6473bb4d0f47416cdb08d556c03b8bc1cccf04e756b56d/kiwisolver-1.4.7-cp313-cp313-musllinux_1_2_s390x.whl", hash = "sha256:073a36c8273647592ea332e816e75ef8da5c303236ec0167196793eb1e34657a", size = 2501635, upload-time = "2024-09-04T09:05:23.588Z" },
+    { url = "https://files.pythonhosted.org/packages/78/7e/aa9422e78419db0cbe75fb86d8e72b433818f2e62e2e394992d23d23a583/kiwisolver-1.4.7-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:3ce6b2b0231bda412463e152fc18335ba32faf4e8c23a754ad50ffa70e4091ee", size = 2314556, upload-time = "2024-09-04T09:05:25.907Z" },
+    { url = "https://files.pythonhosted.org/packages/a8/b2/15f7f556df0a6e5b3772a1e076a9d9f6c538ce5f05bd590eca8106508e06/kiwisolver-1.4.7-cp313-cp313-win32.whl", hash = "sha256:f4c9aee212bc89d4e13f58be11a56cc8036cabad119259d12ace14b34476fd07", size = 46364, upload-time = "2024-09-04T09:05:27.184Z" },
+    { url = "https://files.pythonhosted.org/packages/0b/db/32e897e43a330eee8e4770bfd2737a9584b23e33587a0812b8e20aac38f7/kiwisolver-1.4.7-cp313-cp313-win_amd64.whl", hash = "sha256:8a3ec5aa8e38fc4c8af308917ce12c536f1c88452ce554027e55b22cbbfbff76", size = 55887, upload-time = "2024-09-04T09:05:28.372Z" },
+    { url = "https://files.pythonhosted.org/packages/c8/a4/df2bdca5270ca85fd25253049eb6708d4127be2ed0e5c2650217450b59e9/kiwisolver-1.4.7-cp313-cp313-win_arm64.whl", hash = "sha256:76c8094ac20ec259471ac53e774623eb62e6e1f56cd8690c67ce6ce4fcb05650", size = 48530, upload-time = "2024-09-04T09:05:30.225Z" },
+    { url = "https://files.pythonhosted.org/packages/57/d6/620247574d9e26fe24384087879e8399e309f0051782f95238090afa6ccc/kiwisolver-1.4.7-cp38-cp38-macosx_10_9_universal2.whl", hash = "sha256:5d5abf8f8ec1f4e22882273c423e16cae834c36856cac348cfbfa68e01c40f3a", size = 122325, upload-time = "2024-09-04T09:05:31.648Z" },
+    { url = "https://files.pythonhosted.org/packages/bd/c6/572ad7d73dbd898cffa9050ffd7ff7e78a055a1d9b7accd6b4d1f50ec858/kiwisolver-1.4.7-cp38-cp38-macosx_10_9_x86_64.whl", hash = "sha256:aeb3531b196ef6f11776c21674dba836aeea9d5bd1cf630f869e3d90b16cfade", size = 65679, upload-time = "2024-09-04T09:05:32.934Z" },
+    { url = "https://files.pythonhosted.org/packages/14/a7/bb8ab10e12cc8764f4da0245d72dee4731cc720bdec0f085d5e9c6005b98/kiwisolver-1.4.7-cp38-cp38-macosx_11_0_arm64.whl", hash = "sha256:b7d755065e4e866a8086c9bdada157133ff466476a2ad7861828e17b6026e22c", size = 64267, upload-time = "2024-09-04T09:05:34.11Z" },
+    { url = "https://files.pythonhosted.org/packages/54/a4/3b5a2542429e182a4df0528214e76803f79d016110f5e67c414a0357cd7d/kiwisolver-1.4.7-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:08471d4d86cbaec61f86b217dd938a83d85e03785f51121e791a6e6689a3be95", size = 1387236, upload-time = "2024-09-04T09:05:35.97Z" },
+    { url = "https://files.pythonhosted.org/packages/a6/d7/bc3005e906c1673953a3e31ee4f828157d5e07a62778d835dd937d624ea0/kiwisolver-1.4.7-cp38-cp38-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:7bbfcb7165ce3d54a3dfbe731e470f65739c4c1f85bb1018ee912bae139e263b", size = 1500555, upload-time = "2024-09-04T09:05:37.552Z" },
+    { url = "https://files.pythonhosted.org/packages/09/a7/87cb30741f13b7af08446795dca6003491755805edc9c321fe996c1320b8/kiwisolver-1.4.7-cp38-cp38-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:5d34eb8494bea691a1a450141ebb5385e4b69d38bb8403b5146ad279f4b30fa3", size = 1431684, upload-time = "2024-09-04T09:05:39.75Z" },
+    { url = "https://files.pythonhosted.org/packages/37/a4/1e4e2d8cdaa42c73d523413498445247e615334e39401ae49dae74885429/kiwisolver-1.4.7-cp38-cp38-manylinux_2_5_i686.manylinux1_i686.whl", hash = "sha256:9242795d174daa40105c1d86aba618e8eab7bf96ba8c3ee614da8302a9f95503", size = 1125811, upload-time = "2024-09-04T09:05:41.31Z" },
+    { url = "https://files.pythonhosted.org/packages/76/36/ae40d7a3171e06f55ac77fe5536079e7be1d8be2a8210e08975c7f9b4d54/kiwisolver-1.4.7-cp38-cp38-manylinux_2_5_x86_64.manylinux1_x86_64.whl", hash = "sha256:a0f64a48bb81af7450e641e3fe0b0394d7381e342805479178b3d335d60ca7cf", size = 1179987, upload-time = "2024-09-04T09:05:42.893Z" },
+    { url = "https://files.pythonhosted.org/packages/d8/5d/6e4894b9fdf836d8bd095729dff123bbbe6ad0346289287b45c800fae656/kiwisolver-1.4.7-cp38-cp38-musllinux_1_2_aarch64.whl", hash = "sha256:8e045731a5416357638d1700927529e2b8ab304811671f665b225f8bf8d8f933", size = 2186817, upload-time = "2024-09-04T09:05:44.474Z" },
+    { url = "https://files.pythonhosted.org/packages/f0/2d/603079b2c2fd62890be0b0ebfc8bb6dda8a5253ca0758885596565b0dfc1/kiwisolver-1.4.7-cp38-cp38-musllinux_1_2_i686.whl", hash = "sha256:4322872d5772cae7369f8351da1edf255a604ea7087fe295411397d0cfd9655e", size = 2332538, upload-time = "2024-09-04T09:05:46.206Z" },
+    { url = "https://files.pythonhosted.org/packages/bb/2a/9a28279c865c38a27960db38b07179143aafc94877945c209bfc553d9dd3/kiwisolver-1.4.7-cp38-cp38-musllinux_1_2_ppc64le.whl", hash = "sha256:e1631290ee9271dffe3062d2634c3ecac02c83890ada077d225e081aca8aab89", size = 2293890, upload-time = "2024-09-04T09:05:47.819Z" },
+    { url = "https://files.pythonhosted.org/packages/1a/4d/4da8967f3bf13c764984b8fbae330683ee5fbd555b4a5624ad2b9decc0ab/kiwisolver-1.4.7-cp38-cp38-musllinux_1_2_s390x.whl", hash = "sha256:edcfc407e4eb17e037bca59be0e85a2031a2ac87e4fed26d3e9df88b4165f92d", size = 2434677, upload-time = "2024-09-04T09:05:49.459Z" },
+    { url = "https://files.pythonhosted.org/packages/08/e9/a97a2b6b74dd850fa5974309367e025c06093a143befe9b962d0baebb4f0/kiwisolver-1.4.7-cp38-cp38-musllinux_1_2_x86_64.whl", hash = "sha256:4d05d81ecb47d11e7f8932bd8b61b720bf0b41199358f3f5e36d38e28f0532c5", size = 2250339, upload-time = "2024-09-04T09:05:51.165Z" },
+    { url = "https://files.pythonhosted.org/packages/8a/e7/55507a387ba1766e69f5e13a79e1aefabdafe0532bee5d1972dfc42b3d16/kiwisolver-1.4.7-cp38-cp38-win32.whl", hash = "sha256:b38ac83d5f04b15e515fd86f312479d950d05ce2368d5413d46c088dda7de90a", size = 46932, upload-time = "2024-09-04T09:05:52.49Z" },
+    { url = "https://files.pythonhosted.org/packages/52/77/7e04cca2ff1dc6ee6b7654cebe233de72b7a3ec5616501b6f3144fb70740/kiwisolver-1.4.7-cp38-cp38-win_amd64.whl", hash = "sha256:d83db7cde68459fc803052a55ace60bea2bae361fc3b7a6d5da07e11954e4b09", size = 55836, upload-time = "2024-09-04T09:05:54.078Z" },
+    { url = "https://files.pythonhosted.org/packages/11/88/37ea0ea64512997b13d69772db8dcdc3bfca5442cda3a5e4bb943652ee3e/kiwisolver-1.4.7-cp39-cp39-macosx_10_9_universal2.whl", hash = "sha256:3f9362ecfca44c863569d3d3c033dbe8ba452ff8eed6f6b5806382741a1334bd", size = 122449, upload-time = "2024-09-04T09:05:55.311Z" },
+    { url = "https://files.pythonhosted.org/packages/4e/45/5a5c46078362cb3882dcacad687c503089263c017ca1241e0483857791eb/kiwisolver-1.4.7-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:e8df2eb9b2bac43ef8b082e06f750350fbbaf2887534a5be97f6cf07b19d9583", size = 65757, upload-time = "2024-09-04T09:05:56.906Z" },
+    { url = "https://files.pythonhosted.org/packages/8a/be/a6ae58978772f685d48dd2e84460937761c53c4bbd84e42b0336473d9775/kiwisolver-1.4.7-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:f32d6edbc638cde7652bd690c3e728b25332acbadd7cad670cc4a02558d9c417", size = 64312, upload-time = "2024-09-04T09:05:58.384Z" },
+    { url = "https://files.pythonhosted.org/packages/f4/04/18ef6f452d311e1e1eb180c9bf5589187fa1f042db877e6fe443ef10099c/kiwisolver-1.4.7-cp39-cp39-manylinux_2_12_i686.manylinux2010_i686.whl", hash = "sha256:e2e6c39bd7b9372b0be21456caab138e8e69cc0fc1190a9dfa92bd45a1e6e904", size = 1626966, upload-time = "2024-09-04T09:05:59.855Z" },
+    { url = "https://files.pythonhosted.org/packages/21/b1/40655f6c3fa11ce740e8a964fa8e4c0479c87d6a7944b95af799c7a55dfe/kiwisolver-1.4.7-cp39-cp39-manylinux_2_12_x86_64.manylinux2010_x86_64.whl", hash = "sha256:dda56c24d869b1193fcc763f1284b9126550eaf84b88bbc7256e15028f19188a", size = 1607044, upload-time = "2024-09-04T09:06:02.16Z" },
+    { url = "https://files.pythonhosted.org/packages/fd/93/af67dbcfb9b3323bbd2c2db1385a7139d8f77630e4a37bb945b57188eb2d/kiwisolver-1.4.7-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:79849239c39b5e1fd906556c474d9b0439ea6792b637511f3fe3a41158d89ca8", size = 1391879, upload-time = "2024-09-04T09:06:03.908Z" },
+    { url = "https://files.pythonhosted.org/packages/40/6f/d60770ef98e77b365d96061d090c0cd9e23418121c55fff188fa4bdf0b54/kiwisolver-1.4.7-cp39-cp39-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:5e3bc157fed2a4c02ec468de4ecd12a6e22818d4f09cde2c31ee3226ffbefab2", size = 1504751, upload-time = "2024-09-04T09:06:05.58Z" },
+    { url = "https://files.pythonhosted.org/packages/fa/3a/5f38667d313e983c432f3fcd86932177519ed8790c724e07d77d1de0188a/kiwisolver-1.4.7-cp39-cp39-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:3da53da805b71e41053dc670f9a820d1157aae77b6b944e08024d17bcd51ef88", size = 1436990, upload-time = "2024-09-04T09:06:08.126Z" },
+    { url = "https://files.pythonhosted.org/packages/cb/3b/1520301a47326e6a6043b502647e42892be33b3f051e9791cc8bb43f1a32/kiwisolver-1.4.7-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:8705f17dfeb43139a692298cb6637ee2e59c0194538153e83e9ee0c75c2eddde", size = 2191122, upload-time = "2024-09-04T09:06:10.345Z" },
+    { url = "https://files.pythonhosted.org/packages/cf/c4/eb52da300c166239a2233f1f9c4a1b767dfab98fae27681bfb7ea4873cb6/kiwisolver-1.4.7-cp39-cp39-musllinux_1_2_i686.whl", hash = "sha256:82a5c2f4b87c26bb1a0ef3d16b5c4753434633b83d365cc0ddf2770c93829e3c", size = 2338126, upload-time = "2024-09-04T09:06:12.321Z" },
+    { url = "https://files.pythonhosted.org/packages/1a/cb/42b92fd5eadd708dd9107c089e817945500685f3437ce1fd387efebc6d6e/kiwisolver-1.4.7-cp39-cp39-musllinux_1_2_ppc64le.whl", hash = "sha256:ce8be0466f4c0d585cdb6c1e2ed07232221df101a4c6f28821d2aa754ca2d9e2", size = 2298313, upload-time = "2024-09-04T09:06:14.562Z" },
+    { url = "https://files.pythonhosted.org/packages/4f/eb/be25aa791fe5fc75a8b1e0c965e00f942496bc04635c9aae8035f6b76dcd/kiwisolver-1.4.7-cp39-cp39-musllinux_1_2_s390x.whl", hash = "sha256:409afdfe1e2e90e6ee7fc896f3df9a7fec8e793e58bfa0d052c8a82f99c37abb", size = 2437784, upload-time = "2024-09-04T09:06:16.767Z" },
+    { url = "https://files.pythonhosted.org/packages/c5/22/30a66be7f3368d76ff95689e1c2e28d382383952964ab15330a15d8bfd03/kiwisolver-1.4.7-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:5b9c3f4ee0b9a439d2415012bd1b1cc2df59e4d6a9939f4d669241d30b414327", size = 2253988, upload-time = "2024-09-04T09:06:18.705Z" },
+    { url = "https://files.pythonhosted.org/packages/35/d3/5f2ecb94b5211c8a04f218a76133cc8d6d153b0f9cd0b45fad79907f0689/kiwisolver-1.4.7-cp39-cp39-win32.whl", hash = "sha256:a79ae34384df2b615eefca647a2873842ac3b596418032bef9a7283675962644", size = 46980, upload-time = "2024-09-04T09:06:20.106Z" },
+    { url = "https://files.pythonhosted.org/packages/ef/17/cd10d020578764ea91740204edc6b3236ed8106228a46f568d716b11feb2/kiwisolver-1.4.7-cp39-cp39-win_amd64.whl", hash = "sha256:cf0438b42121a66a3a667de17e779330fc0f20b0d97d59d2f2121e182b0505e4", size = 55847, upload-time = "2024-09-04T09:06:21.407Z" },
+    { url = "https://files.pythonhosted.org/packages/91/84/32232502020bd78d1d12be7afde15811c64a95ed1f606c10456db4e4c3ac/kiwisolver-1.4.7-cp39-cp39-win_arm64.whl", hash = "sha256:764202cc7e70f767dab49e8df52c7455e8de0df5d858fa801a11aa0d882ccf3f", size = 48494, upload-time = "2024-09-04T09:06:22.648Z" },
+    { url = "https://files.pythonhosted.org/packages/ac/59/741b79775d67ab67ced9bb38552da688c0305c16e7ee24bba7a2be253fb7/kiwisolver-1.4.7-pp310-pypy310_pp73-macosx_10_15_x86_64.whl", hash = "sha256:94252291e3fe68001b1dd747b4c0b3be12582839b95ad4d1b641924d68fd4643", size = 59491, upload-time = "2024-09-04T09:06:24.188Z" },
+    { url = "https://files.pythonhosted.org/packages/58/cc/fb239294c29a5656e99e3527f7369b174dd9cc7c3ef2dea7cb3c54a8737b/kiwisolver-1.4.7-pp310-pypy310_pp73-macosx_11_0_arm64.whl", hash = "sha256:5b7dfa3b546da08a9f622bb6becdb14b3e24aaa30adba66749d38f3cc7ea9706", size = 57648, upload-time = "2024-09-04T09:06:25.559Z" },
+    { url = "https://files.pythonhosted.org/packages/3b/ef/2f009ac1f7aab9f81efb2d837301d255279d618d27b6015780115ac64bdd/kiwisolver-1.4.7-pp310-pypy310_pp73-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:bd3de6481f4ed8b734da5df134cd5a6a64fe32124fe83dde1e5b5f29fe30b1e6", size = 84257, upload-time = "2024-09-04T09:06:27.038Z" },
+    { url = "https://files.pythonhosted.org/packages/81/e1/c64f50987f85b68b1c52b464bb5bf73e71570c0f7782d626d1eb283ad620/kiwisolver-1.4.7-pp310-pypy310_pp73-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:a91b5f9f1205845d488c928e8570dcb62b893372f63b8b6e98b863ebd2368ff2", size = 80906, upload-time = "2024-09-04T09:06:28.48Z" },
+    { url = "https://files.pythonhosted.org/packages/fd/71/1687c5c0a0be2cee39a5c9c389e546f9c6e215e46b691d00d9f646892083/kiwisolver-1.4.7-pp310-pypy310_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:40fa14dbd66b8b8f470d5fc79c089a66185619d31645f9b0773b88b19f7223c4", size = 79951, upload-time = "2024-09-04T09:06:29.966Z" },
+    { url = "https://files.pythonhosted.org/packages/ea/8b/d7497df4a1cae9367adf21665dd1f896c2a7aeb8769ad77b662c5e2bcce7/kiwisolver-1.4.7-pp310-pypy310_pp73-win_amd64.whl", hash = "sha256:eb542fe7933aa09d8d8f9d9097ef37532a7df6497819d16efe4359890a2f417a", size = 55715, upload-time = "2024-09-04T09:06:31.489Z" },
+    { url = "https://files.pythonhosted.org/packages/64/f3/2403d90821fffe496df16f6996cb328b90b0d80c06d2938a930a7732b4f1/kiwisolver-1.4.7-pp38-pypy38_pp73-macosx_10_9_x86_64.whl", hash = "sha256:bfa1acfa0c54932d5607e19a2c24646fb4c1ae2694437789129cf099789a3b00", size = 59662, upload-time = "2024-09-04T09:06:33.551Z" },
+    { url = "https://files.pythonhosted.org/packages/fa/7d/8f409736a4a6ac04354fa530ebf46682ddb1539b0bae15f4731ff2c575bc/kiwisolver-1.4.7-pp38-pypy38_pp73-macosx_11_0_arm64.whl", hash = "sha256:eee3ea935c3d227d49b4eb85660ff631556841f6e567f0f7bda972df6c2c9935", size = 57753, upload-time = "2024-09-04T09:06:35.095Z" },
+    { url = "https://files.pythonhosted.org/packages/4c/a5/3937c9abe8eedb1356071739ad437a0b486cbad27d54f4ec4733d24882ac/kiwisolver-1.4.7-pp38-pypy38_pp73-manylinux_2_12_i686.manylinux2010_i686.whl", hash = "sha256:f3160309af4396e0ed04db259c3ccbfdc3621b5559b5453075e5de555e1f3a1b", size = 103564, upload-time = "2024-09-04T09:06:36.756Z" },
+    { url = "https://files.pythonhosted.org/packages/b2/18/a5ae23888f010b90d5eb8d196fed30e268056b2ded54d25b38a193bb70e9/kiwisolver-1.4.7-pp38-pypy38_pp73-manylinux_2_12_x86_64.manylinux2010_x86_64.whl", hash = "sha256:a17f6a29cf8935e587cc8a4dbfc8368c55edc645283db0ce9801016f83526c2d", size = 95264, upload-time = "2024-09-04T09:06:38.786Z" },
+    { url = "https://files.pythonhosted.org/packages/f9/d0/c4240ae86306d4395e9701f1d7e6ddcc6d60c28cb0127139176cfcfc9ebe/kiwisolver-1.4.7-pp38-pypy38_pp73-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:10849fb2c1ecbfae45a693c070e0320a91b35dd4bcf58172c023b994283a124d", size = 78197, upload-time = "2024-09-04T09:06:40.453Z" },
+    { url = "https://files.pythonhosted.org/packages/62/db/62423f0ab66813376a35c1e7da488ebdb4e808fcb54b7cec33959717bda1/kiwisolver-1.4.7-pp38-pypy38_pp73-win_amd64.whl", hash = "sha256:ac542bf38a8a4be2dc6b15248d36315ccc65f0743f7b1a76688ffb6b5129a5c2", size = 56080, upload-time = "2024-09-04T09:06:42.061Z" },
+    { url = "https://files.pythonhosted.org/packages/d5/df/ce37d9b26f07ab90880923c94d12a6ff4d27447096b4c849bfc4339ccfdf/kiwisolver-1.4.7-pp39-pypy39_pp73-macosx_10_15_x86_64.whl", hash = "sha256:8b01aac285f91ca889c800042c35ad3b239e704b150cfd3382adfc9dcc780e39", size = 58666, upload-time = "2024-09-04T09:06:43.756Z" },
+    { url = "https://files.pythonhosted.org/packages/b0/d3/e4b04f43bc629ac8e186b77b2b1a251cdfa5b7610fa189dc0db622672ce6/kiwisolver-1.4.7-pp39-pypy39_pp73-macosx_11_0_arm64.whl", hash = "sha256:48be928f59a1f5c8207154f935334d374e79f2b5d212826307d072595ad76a2e", size = 57088, upload-time = "2024-09-04T09:06:45.406Z" },
+    { url = "https://files.pythonhosted.org/packages/30/1c/752df58e2d339e670a535514d2db4fe8c842ce459776b8080fbe08ebb98e/kiwisolver-1.4.7-pp39-pypy39_pp73-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:f37cfe618a117e50d8c240555331160d73d0411422b59b5ee217843d7b693608", size = 84321, upload-time = "2024-09-04T09:06:47.557Z" },
+    { url = "https://files.pythonhosted.org/packages/f0/f8/fe6484e847bc6e238ec9f9828089fb2c0bb53f2f5f3a79351fde5b565e4f/kiwisolver-1.4.7-pp39-pypy39_pp73-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:599b5c873c63a1f6ed7eead644a8a380cfbdf5db91dcb6f85707aaab213b1674", size = 80776, upload-time = "2024-09-04T09:06:49.235Z" },
+    { url = "https://files.pythonhosted.org/packages/9b/57/d7163c0379f250ef763aba85330a19feefb5ce6cb541ade853aaba881524/kiwisolver-1.4.7-pp39-pypy39_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:801fa7802e5cfabe3ab0c81a34c323a319b097dfb5004be950482d882f3d7225", size = 79984, upload-time = "2024-09-04T09:06:51.336Z" },
+    { url = "https://files.pythonhosted.org/packages/8c/95/4a103776c265d13b3d2cd24fb0494d4e04ea435a8ef97e1b2c026d43250b/kiwisolver-1.4.7-pp39-pypy39_pp73-win_amd64.whl", hash = "sha256:0c6c43471bc764fad4bc99c5c2d6d16a676b1abf844ca7c8702bdae92df01ee0", size = 55811, upload-time = "2024-09-04T09:06:53.078Z" },
+]
+
+[[package]]
+name = "kiwisolver"
+version = "1.4.9"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/5c/3c/85844f1b0feb11ee581ac23fe5fce65cd049a200c1446708cc1b7f922875/kiwisolver-1.4.9.tar.gz", hash = "sha256:c3b22c26c6fd6811b0ae8363b95ca8ce4ea3c202d3d0975b2914310ceb1bcc4d", size = 97564, upload-time = "2025-08-10T21:27:49.279Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/c6/5d/8ce64e36d4e3aac5ca96996457dcf33e34e6051492399a3f1fec5657f30b/kiwisolver-1.4.9-cp310-cp310-macosx_10_9_universal2.whl", hash = "sha256:b4b4d74bda2b8ebf4da5bd42af11d02d04428b2c32846e4c2c93219df8a7987b", size = 124159, upload-time = "2025-08-10T21:25:35.472Z" },
+    { url = "https://files.pythonhosted.org/packages/96/1e/22f63ec454874378175a5f435d6ea1363dd33fb2af832c6643e4ccea0dc8/kiwisolver-1.4.9-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:fb3b8132019ea572f4611d770991000d7f58127560c4889729248eb5852a102f", size = 66578, upload-time = "2025-08-10T21:25:36.73Z" },
+    { url = "https://files.pythonhosted.org/packages/41/4c/1925dcfff47a02d465121967b95151c82d11027d5ec5242771e580e731bd/kiwisolver-1.4.9-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:84fd60810829c27ae375114cd379da1fa65e6918e1da405f356a775d49a62bcf", size = 65312, upload-time = "2025-08-10T21:25:37.658Z" },
+    { url = "https://files.pythonhosted.org/packages/d4/42/0f333164e6307a0687d1eb9ad256215aae2f4bd5d28f4653d6cd319a3ba3/kiwisolver-1.4.9-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.whl", hash = "sha256:b78efa4c6e804ecdf727e580dbb9cba85624d2e1c6b5cb059c66290063bd99a9", size = 1628458, upload-time = "2025-08-10T21:25:39.067Z" },
+    { url = "https://files.pythonhosted.org/packages/86/b6/2dccb977d651943995a90bfe3495c2ab2ba5cd77093d9f2318a20c9a6f59/kiwisolver-1.4.9-cp310-cp310-manylinux_2_24_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:d4efec7bcf21671db6a3294ff301d2fc861c31faa3c8740d1a94689234d1b415", size = 1225640, upload-time = "2025-08-10T21:25:40.489Z" },
+    { url = "https://files.pythonhosted.org/packages/50/2b/362ebd3eec46c850ccf2bfe3e30f2fc4c008750011f38a850f088c56a1c6/kiwisolver-1.4.9-cp310-cp310-manylinux_2_24_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:90f47e70293fc3688b71271100a1a5453aa9944a81d27ff779c108372cf5567b", size = 1244074, upload-time = "2025-08-10T21:25:42.221Z" },
+    { url = "https://files.pythonhosted.org/packages/6f/bb/f09a1e66dab8984773d13184a10a29fe67125337649d26bdef547024ed6b/kiwisolver-1.4.9-cp310-cp310-manylinux_2_24_s390x.manylinux_2_28_s390x.whl", hash = "sha256:8fdca1def57a2e88ef339de1737a1449d6dbf5fab184c54a1fca01d541317154", size = 1293036, upload-time = "2025-08-10T21:25:43.801Z" },
+    { url = "https://files.pythonhosted.org/packages/ea/01/11ecf892f201cafda0f68fa59212edaea93e96c37884b747c181303fccd1/kiwisolver-1.4.9-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:9cf554f21be770f5111a1690d42313e140355e687e05cf82cb23d0a721a64a48", size = 2175310, upload-time = "2025-08-10T21:25:45.045Z" },
+    { url = "https://files.pythonhosted.org/packages/7f/5f/bfe11d5b934f500cc004314819ea92427e6e5462706a498c1d4fc052e08f/kiwisolver-1.4.9-cp310-cp310-musllinux_1_2_ppc64le.whl", hash = "sha256:fc1795ac5cd0510207482c3d1d3ed781143383b8cfd36f5c645f3897ce066220", size = 2270943, upload-time = "2025-08-10T21:25:46.393Z" },
+    { url = "https://files.pythonhosted.org/packages/3d/de/259f786bf71f1e03e73d87e2db1a9a3bcab64d7b4fd780167123161630ad/kiwisolver-1.4.9-cp310-cp310-musllinux_1_2_s390x.whl", hash = "sha256:ccd09f20ccdbbd341b21a67ab50a119b64a403b09288c27481575105283c1586", size = 2440488, upload-time = "2025-08-10T21:25:48.074Z" },
+    { url = "https://files.pythonhosted.org/packages/1b/76/c989c278faf037c4d3421ec07a5c452cd3e09545d6dae7f87c15f54e4edf/kiwisolver-1.4.9-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:540c7c72324d864406a009d72f5d6856f49693db95d1fbb46cf86febef873634", size = 2246787, upload-time = "2025-08-10T21:25:49.442Z" },
+    { url = "https://files.pythonhosted.org/packages/a2/55/c2898d84ca440852e560ca9f2a0d28e6e931ac0849b896d77231929900e7/kiwisolver-1.4.9-cp310-cp310-win_amd64.whl", hash = "sha256:ede8c6d533bc6601a47ad4046080d36b8fc99f81e6f1c17b0ac3c2dc91ac7611", size = 73730, upload-time = "2025-08-10T21:25:51.102Z" },
+    { url = "https://files.pythonhosted.org/packages/e8/09/486d6ac523dd33b80b368247f238125d027964cfacb45c654841e88fb2ae/kiwisolver-1.4.9-cp310-cp310-win_arm64.whl", hash = "sha256:7b4da0d01ac866a57dd61ac258c5607b4cd677f63abaec7b148354d2b2cdd536", size = 65036, upload-time = "2025-08-10T21:25:52.063Z" },
+    { url = "https://files.pythonhosted.org/packages/6f/ab/c80b0d5a9d8a1a65f4f815f2afff9798b12c3b9f31f1d304dd233dd920e2/kiwisolver-1.4.9-cp311-cp311-macosx_10_9_universal2.whl", hash = "sha256:eb14a5da6dc7642b0f3a18f13654847cd8b7a2550e2645a5bda677862b03ba16", size = 124167, upload-time = "2025-08-10T21:25:53.403Z" },
+    { url = "https://files.pythonhosted.org/packages/a0/c0/27fe1a68a39cf62472a300e2879ffc13c0538546c359b86f149cc19f6ac3/kiwisolver-1.4.9-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:39a219e1c81ae3b103643d2aedb90f1ef22650deb266ff12a19e7773f3e5f089", size = 66579, upload-time = "2025-08-10T21:25:54.79Z" },
+    { url = "https://files.pythonhosted.org/packages/31/a2/a12a503ac1fd4943c50f9822678e8015a790a13b5490354c68afb8489814/kiwisolver-1.4.9-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:2405a7d98604b87f3fc28b1716783534b1b4b8510d8142adca34ee0bc3c87543", size = 65309, upload-time = "2025-08-10T21:25:55.76Z" },
+    { url = "https://files.pythonhosted.org/packages/66/e1/e533435c0be77c3f64040d68d7a657771194a63c279f55573188161e81ca/kiwisolver-1.4.9-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:dc1ae486f9abcef254b5618dfb4113dd49f94c68e3e027d03cf0143f3f772b61", size = 1435596, upload-time = "2025-08-10T21:25:56.861Z" },
+    { url = "https://files.pythonhosted.org/packages/67/1e/51b73c7347f9aabdc7215aa79e8b15299097dc2f8e67dee2b095faca9cb0/kiwisolver-1.4.9-cp311-cp311-manylinux_2_24_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:8a1f570ce4d62d718dce3f179ee78dac3b545ac16c0c04bb363b7607a949c0d1", size = 1246548, upload-time = "2025-08-10T21:25:58.246Z" },
+    { url = "https://files.pythonhosted.org/packages/21/aa/72a1c5d1e430294f2d32adb9542719cfb441b5da368d09d268c7757af46c/kiwisolver-1.4.9-cp311-cp311-manylinux_2_24_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:cb27e7b78d716c591e88e0a09a2139c6577865d7f2e152488c2cc6257f460872", size = 1263618, upload-time = "2025-08-10T21:25:59.857Z" },
+    { url = "https://files.pythonhosted.org/packages/a3/af/db1509a9e79dbf4c260ce0cfa3903ea8945f6240e9e59d1e4deb731b1a40/kiwisolver-1.4.9-cp311-cp311-manylinux_2_24_s390x.manylinux_2_28_s390x.whl", hash = "sha256:15163165efc2f627eb9687ea5f3a28137217d217ac4024893d753f46bce9de26", size = 1317437, upload-time = "2025-08-10T21:26:01.105Z" },
+    { url = "https://files.pythonhosted.org/packages/e0/f2/3ea5ee5d52abacdd12013a94130436e19969fa183faa1e7c7fbc89e9a42f/kiwisolver-1.4.9-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:bdee92c56a71d2b24c33a7d4c2856bd6419d017e08caa7802d2963870e315028", size = 2195742, upload-time = "2025-08-10T21:26:02.675Z" },
+    { url = "https://files.pythonhosted.org/packages/6f/9b/1efdd3013c2d9a2566aa6a337e9923a00590c516add9a1e89a768a3eb2fc/kiwisolver-1.4.9-cp311-cp311-musllinux_1_2_ppc64le.whl", hash = "sha256:412f287c55a6f54b0650bd9b6dce5aceddb95864a1a90c87af16979d37c89771", size = 2290810, upload-time = "2025-08-10T21:26:04.009Z" },
+    { url = "https://files.pythonhosted.org/packages/fb/e5/cfdc36109ae4e67361f9bc5b41323648cb24a01b9ade18784657e022e65f/kiwisolver-1.4.9-cp311-cp311-musllinux_1_2_s390x.whl", hash = "sha256:2c93f00dcba2eea70af2be5f11a830a742fe6b579a1d4e00f47760ef13be247a", size = 2461579, upload-time = "2025-08-10T21:26:05.317Z" },
+    { url = "https://files.pythonhosted.org/packages/62/86/b589e5e86c7610842213994cdea5add00960076bef4ae290c5fa68589cac/kiwisolver-1.4.9-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:f117e1a089d9411663a3207ba874f31be9ac8eaa5b533787024dc07aeb74f464", size = 2268071, upload-time = "2025-08-10T21:26:06.686Z" },
+    { url = "https://files.pythonhosted.org/packages/3b/c6/f8df8509fd1eee6c622febe54384a96cfaf4d43bf2ccec7a0cc17e4715c9/kiwisolver-1.4.9-cp311-cp311-win_amd64.whl", hash = "sha256:be6a04e6c79819c9a8c2373317d19a96048e5a3f90bec587787e86a1153883c2", size = 73840, upload-time = "2025-08-10T21:26:07.94Z" },
+    { url = "https://files.pythonhosted.org/packages/e2/2d/16e0581daafd147bc11ac53f032a2b45eabac897f42a338d0a13c1e5c436/kiwisolver-1.4.9-cp311-cp311-win_arm64.whl", hash = "sha256:0ae37737256ba2de764ddc12aed4956460277f00c4996d51a197e72f62f5eec7", size = 65159, upload-time = "2025-08-10T21:26:09.048Z" },
+    { url = "https://files.pythonhosted.org/packages/86/c9/13573a747838aeb1c76e3267620daa054f4152444d1f3d1a2324b78255b5/kiwisolver-1.4.9-cp312-cp312-macosx_10_13_universal2.whl", hash = "sha256:ac5a486ac389dddcc5bef4f365b6ae3ffff2c433324fb38dd35e3fab7c957999", size = 123686, upload-time = "2025-08-10T21:26:10.034Z" },
+    { url = "https://files.pythonhosted.org/packages/51/ea/2ecf727927f103ffd1739271ca19c424d0e65ea473fbaeea1c014aea93f6/kiwisolver-1.4.9-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:f2ba92255faa7309d06fe44c3a4a97efe1c8d640c2a79a5ef728b685762a6fd2", size = 66460, upload-time = "2025-08-10T21:26:11.083Z" },
+    { url = "https://files.pythonhosted.org/packages/5b/5a/51f5464373ce2aeb5194508298a508b6f21d3867f499556263c64c621914/kiwisolver-1.4.9-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:4a2899935e724dd1074cb568ce7ac0dce28b2cd6ab539c8e001a8578eb106d14", size = 64952, upload-time = "2025-08-10T21:26:12.058Z" },
+    { url = "https://files.pythonhosted.org/packages/70/90/6d240beb0f24b74371762873e9b7f499f1e02166a2d9c5801f4dbf8fa12e/kiwisolver-1.4.9-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:f6008a4919fdbc0b0097089f67a1eb55d950ed7e90ce2cc3e640abadd2757a04", size = 1474756, upload-time = "2025-08-10T21:26:13.096Z" },
+    { url = "https://files.pythonhosted.org/packages/12/42/f36816eaf465220f683fb711efdd1bbf7a7005a2473d0e4ed421389bd26c/kiwisolver-1.4.9-cp312-cp312-manylinux_2_24_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:67bb8b474b4181770f926f7b7d2f8c0248cbcb78b660fdd41a47054b28d2a752", size = 1276404, upload-time = "2025-08-10T21:26:14.457Z" },
+    { url = "https://files.pythonhosted.org/packages/2e/64/bc2de94800adc830c476dce44e9b40fd0809cddeef1fde9fcf0f73da301f/kiwisolver-1.4.9-cp312-cp312-manylinux_2_24_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:2327a4a30d3ee07d2fbe2e7933e8a37c591663b96ce42a00bc67461a87d7df77", size = 1294410, upload-time = "2025-08-10T21:26:15.73Z" },
+    { url = "https://files.pythonhosted.org/packages/5f/42/2dc82330a70aa8e55b6d395b11018045e58d0bb00834502bf11509f79091/kiwisolver-1.4.9-cp312-cp312-manylinux_2_24_s390x.manylinux_2_28_s390x.whl", hash = "sha256:7a08b491ec91b1d5053ac177afe5290adacf1f0f6307d771ccac5de30592d198", size = 1343631, upload-time = "2025-08-10T21:26:17.045Z" },
+    { url = "https://files.pythonhosted.org/packages/22/fd/f4c67a6ed1aab149ec5a8a401c323cee7a1cbe364381bb6c9c0d564e0e20/kiwisolver-1.4.9-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:d8fc5c867c22b828001b6a38d2eaeb88160bf5783c6cb4a5e440efc981ce286d", size = 2224963, upload-time = "2025-08-10T21:26:18.737Z" },
+    { url = "https://files.pythonhosted.org/packages/45/aa/76720bd4cb3713314677d9ec94dcc21ced3f1baf4830adde5bb9b2430a5f/kiwisolver-1.4.9-cp312-cp312-musllinux_1_2_ppc64le.whl", hash = "sha256:3b3115b2581ea35bb6d1f24a4c90af37e5d9b49dcff267eeed14c3893c5b86ab", size = 2321295, upload-time = "2025-08-10T21:26:20.11Z" },
+    { url = "https://files.pythonhosted.org/packages/80/19/d3ec0d9ab711242f56ae0dc2fc5d70e298bb4a1f9dfab44c027668c673a1/kiwisolver-1.4.9-cp312-cp312-musllinux_1_2_s390x.whl", hash = "sha256:858e4c22fb075920b96a291928cb7dea5644e94c0ee4fcd5af7e865655e4ccf2", size = 2487987, upload-time = "2025-08-10T21:26:21.49Z" },
+    { url = "https://files.pythonhosted.org/packages/39/e9/61e4813b2c97e86b6fdbd4dd824bf72d28bcd8d4849b8084a357bc0dd64d/kiwisolver-1.4.9-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:ed0fecd28cc62c54b262e3736f8bb2512d8dcfdc2bcf08be5f47f96bf405b145", size = 2291817, upload-time = "2025-08-10T21:26:22.812Z" },
+    { url = "https://files.pythonhosted.org/packages/a0/41/85d82b0291db7504da3c2defe35c9a8a5c9803a730f297bd823d11d5fb77/kiwisolver-1.4.9-cp312-cp312-win_amd64.whl", hash = "sha256:f68208a520c3d86ea51acf688a3e3002615a7f0238002cccc17affecc86a8a54", size = 73895, upload-time = "2025-08-10T21:26:24.37Z" },
+    { url = "https://files.pythonhosted.org/packages/e2/92/5f3068cf15ee5cb624a0c7596e67e2a0bb2adee33f71c379054a491d07da/kiwisolver-1.4.9-cp312-cp312-win_arm64.whl", hash = "sha256:2c1a4f57df73965f3f14df20b80ee29e6a7930a57d2d9e8491a25f676e197c60", size = 64992, upload-time = "2025-08-10T21:26:25.732Z" },
+    { url = "https://files.pythonhosted.org/packages/31/c1/c2686cda909742ab66c7388e9a1a8521a59eb89f8bcfbee28fc980d07e24/kiwisolver-1.4.9-cp313-cp313-macosx_10_13_universal2.whl", hash = "sha256:a5d0432ccf1c7ab14f9949eec60c5d1f924f17c037e9f8b33352fa05799359b8", size = 123681, upload-time = "2025-08-10T21:26:26.725Z" },
+    { url = "https://files.pythonhosted.org/packages/ca/f0/f44f50c9f5b1a1860261092e3bc91ecdc9acda848a8b8c6abfda4a24dd5c/kiwisolver-1.4.9-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:efb3a45b35622bb6c16dbfab491a8f5a391fe0e9d45ef32f4df85658232ca0e2", size = 66464, upload-time = "2025-08-10T21:26:27.733Z" },
+    { url = "https://files.pythonhosted.org/packages/2d/7a/9d90a151f558e29c3936b8a47ac770235f436f2120aca41a6d5f3d62ae8d/kiwisolver-1.4.9-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:1a12cf6398e8a0a001a059747a1cbf24705e18fe413bc22de7b3d15c67cffe3f", size = 64961, upload-time = "2025-08-10T21:26:28.729Z" },
+    { url = "https://files.pythonhosted.org/packages/e9/e9/f218a2cb3a9ffbe324ca29a9e399fa2d2866d7f348ec3a88df87fc248fc5/kiwisolver-1.4.9-cp313-cp313-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:b67e6efbf68e077dd71d1a6b37e43e1a99d0bff1a3d51867d45ee8908b931098", size = 1474607, upload-time = "2025-08-10T21:26:29.798Z" },
+    { url = "https://files.pythonhosted.org/packages/d9/28/aac26d4c882f14de59041636292bc838db8961373825df23b8eeb807e198/kiwisolver-1.4.9-cp313-cp313-manylinux_2_24_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:5656aa670507437af0207645273ccdfee4f14bacd7f7c67a4306d0dcaeaf6eed", size = 1276546, upload-time = "2025-08-10T21:26:31.401Z" },
+    { url = "https://files.pythonhosted.org/packages/8b/ad/8bfc1c93d4cc565e5069162f610ba2f48ff39b7de4b5b8d93f69f30c4bed/kiwisolver-1.4.9-cp313-cp313-manylinux_2_24_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:bfc08add558155345129c7803b3671cf195e6a56e7a12f3dde7c57d9b417f525", size = 1294482, upload-time = "2025-08-10T21:26:32.721Z" },
+    { url = "https://files.pythonhosted.org/packages/da/f1/6aca55ff798901d8ce403206d00e033191f63d82dd708a186e0ed2067e9c/kiwisolver-1.4.9-cp313-cp313-manylinux_2_24_s390x.manylinux_2_28_s390x.whl", hash = "sha256:40092754720b174e6ccf9e845d0d8c7d8e12c3d71e7fc35f55f3813e96376f78", size = 1343720, upload-time = "2025-08-10T21:26:34.032Z" },
+    { url = "https://files.pythonhosted.org/packages/d1/91/eed031876c595c81d90d0f6fc681ece250e14bf6998c3d7c419466b523b7/kiwisolver-1.4.9-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:497d05f29a1300d14e02e6441cf0f5ee81c1ff5a304b0d9fb77423974684e08b", size = 2224907, upload-time = "2025-08-10T21:26:35.824Z" },
+    { url = "https://files.pythonhosted.org/packages/e9/ec/4d1925f2e49617b9cca9c34bfa11adefad49d00db038e692a559454dfb2e/kiwisolver-1.4.9-cp313-cp313-musllinux_1_2_ppc64le.whl", hash = "sha256:bdd1a81a1860476eb41ac4bc1e07b3f07259e6d55bbf739b79c8aaedcf512799", size = 2321334, upload-time = "2025-08-10T21:26:37.534Z" },
+    { url = "https://files.pythonhosted.org/packages/43/cb/450cd4499356f68802750c6ddc18647b8ea01ffa28f50d20598e0befe6e9/kiwisolver-1.4.9-cp313-cp313-musllinux_1_2_s390x.whl", hash = "sha256:e6b93f13371d341afee3be9f7c5964e3fe61d5fa30f6a30eb49856935dfe4fc3", size = 2488313, upload-time = "2025-08-10T21:26:39.191Z" },
+    { url = "https://files.pythonhosted.org/packages/71/67/fc76242bd99f885651128a5d4fa6083e5524694b7c88b489b1b55fdc491d/kiwisolver-1.4.9-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:d75aa530ccfaa593da12834b86a0724f58bff12706659baa9227c2ccaa06264c", size = 2291970, upload-time = "2025-08-10T21:26:40.828Z" },
+    { url = "https://files.pythonhosted.org/packages/75/bd/f1a5d894000941739f2ae1b65a32892349423ad49c2e6d0771d0bad3fae4/kiwisolver-1.4.9-cp313-cp313-win_amd64.whl", hash = "sha256:dd0a578400839256df88c16abddf9ba14813ec5f21362e1fe65022e00c883d4d", size = 73894, upload-time = "2025-08-10T21:26:42.33Z" },
+    { url = "https://files.pythonhosted.org/packages/95/38/dce480814d25b99a391abbddadc78f7c117c6da34be68ca8b02d5848b424/kiwisolver-1.4.9-cp313-cp313-win_arm64.whl", hash = "sha256:d4188e73af84ca82468f09cadc5ac4db578109e52acb4518d8154698d3a87ca2", size = 64995, upload-time = "2025-08-10T21:26:43.889Z" },
+    { url = "https://files.pythonhosted.org/packages/e2/37/7d218ce5d92dadc5ebdd9070d903e0c7cf7edfe03f179433ac4d13ce659c/kiwisolver-1.4.9-cp313-cp313t-macosx_10_13_universal2.whl", hash = "sha256:5a0f2724dfd4e3b3ac5a82436a8e6fd16baa7d507117e4279b660fe8ca38a3a1", size = 126510, upload-time = "2025-08-10T21:26:44.915Z" },
+    { url = "https://files.pythonhosted.org/packages/23/b0/e85a2b48233daef4b648fb657ebbb6f8367696a2d9548a00b4ee0eb67803/kiwisolver-1.4.9-cp313-cp313t-macosx_10_13_x86_64.whl", hash = "sha256:1b11d6a633e4ed84fc0ddafd4ebfd8ea49b3f25082c04ad12b8315c11d504dc1", size = 67903, upload-time = "2025-08-10T21:26:45.934Z" },
+    { url = "https://files.pythonhosted.org/packages/44/98/f2425bc0113ad7de24da6bb4dae1343476e95e1d738be7c04d31a5d037fd/kiwisolver-1.4.9-cp313-cp313t-macosx_11_0_arm64.whl", hash = "sha256:61874cdb0a36016354853593cffc38e56fc9ca5aa97d2c05d3dcf6922cd55a11", size = 66402, upload-time = "2025-08-10T21:26:47.101Z" },
+    { url = "https://files.pythonhosted.org/packages/98/d8/594657886df9f34c4177cc353cc28ca7e6e5eb562d37ccc233bff43bbe2a/kiwisolver-1.4.9-cp313-cp313t-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:60c439763a969a6af93b4881db0eed8fadf93ee98e18cbc35bc8da868d0c4f0c", size = 1582135, upload-time = "2025-08-10T21:26:48.665Z" },
+    { url = "https://files.pythonhosted.org/packages/5c/c6/38a115b7170f8b306fc929e166340c24958347308ea3012c2b44e7e295db/kiwisolver-1.4.9-cp313-cp313t-manylinux_2_24_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:92a2f997387a1b79a75e7803aa7ded2cfbe2823852ccf1ba3bcf613b62ae3197", size = 1389409, upload-time = "2025-08-10T21:26:50.335Z" },
+    { url = "https://files.pythonhosted.org/packages/bf/3b/e04883dace81f24a568bcee6eb3001da4ba05114afa622ec9b6fafdc1f5e/kiwisolver-1.4.9-cp313-cp313t-manylinux_2_24_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:a31d512c812daea6d8b3be3b2bfcbeb091dbb09177706569bcfc6240dcf8b41c", size = 1401763, upload-time = "2025-08-10T21:26:51.867Z" },
+    { url = "https://files.pythonhosted.org/packages/9f/80/20ace48e33408947af49d7d15c341eaee69e4e0304aab4b7660e234d6288/kiwisolver-1.4.9-cp313-cp313t-manylinux_2_24_s390x.manylinux_2_28_s390x.whl", hash = "sha256:52a15b0f35dad39862d376df10c5230155243a2c1a436e39eb55623ccbd68185", size = 1453643, upload-time = "2025-08-10T21:26:53.592Z" },
+    { url = "https://files.pythonhosted.org/packages/64/31/6ce4380a4cd1f515bdda976a1e90e547ccd47b67a1546d63884463c92ca9/kiwisolver-1.4.9-cp313-cp313t-musllinux_1_2_aarch64.whl", hash = "sha256:a30fd6fdef1430fd9e1ba7b3398b5ee4e2887783917a687d86ba69985fb08748", size = 2330818, upload-time = "2025-08-10T21:26:55.051Z" },
+    { url = "https://files.pythonhosted.org/packages/fa/e9/3f3fcba3bcc7432c795b82646306e822f3fd74df0ee81f0fa067a1f95668/kiwisolver-1.4.9-cp313-cp313t-musllinux_1_2_ppc64le.whl", hash = "sha256:cc9617b46837c6468197b5945e196ee9ca43057bb7d9d1ae688101e4e1dddf64", size = 2419963, upload-time = "2025-08-10T21:26:56.421Z" },
+    { url = "https://files.pythonhosted.org/packages/99/43/7320c50e4133575c66e9f7dadead35ab22d7c012a3b09bb35647792b2a6d/kiwisolver-1.4.9-cp313-cp313t-musllinux_1_2_s390x.whl", hash = "sha256:0ab74e19f6a2b027ea4f845a78827969af45ce790e6cb3e1ebab71bdf9f215ff", size = 2594639, upload-time = "2025-08-10T21:26:57.882Z" },
+    { url = "https://files.pythonhosted.org/packages/65/d6/17ae4a270d4a987ef8a385b906d2bdfc9fce502d6dc0d3aea865b47f548c/kiwisolver-1.4.9-cp313-cp313t-musllinux_1_2_x86_64.whl", hash = "sha256:dba5ee5d3981160c28d5490f0d1b7ed730c22470ff7f6cc26cfcfaacb9896a07", size = 2391741, upload-time = "2025-08-10T21:26:59.237Z" },
+    { url = "https://files.pythonhosted.org/packages/2a/8f/8f6f491d595a9e5912971f3f863d81baddccc8a4d0c3749d6a0dd9ffc9df/kiwisolver-1.4.9-cp313-cp313t-win_arm64.whl", hash = "sha256:0749fd8f4218ad2e851e11cc4dc05c7cbc0cbc4267bdfdb31782e65aace4ee9c", size = 68646, upload-time = "2025-08-10T21:27:00.52Z" },
+    { url = "https://files.pythonhosted.org/packages/6b/32/6cc0fbc9c54d06c2969faa9c1d29f5751a2e51809dd55c69055e62d9b426/kiwisolver-1.4.9-cp314-cp314-macosx_10_13_universal2.whl", hash = "sha256:9928fe1eb816d11ae170885a74d074f57af3a0d65777ca47e9aeb854a1fba386", size = 123806, upload-time = "2025-08-10T21:27:01.537Z" },
+    { url = "https://files.pythonhosted.org/packages/b2/dd/2bfb1d4a4823d92e8cbb420fe024b8d2167f72079b3bb941207c42570bdf/kiwisolver-1.4.9-cp314-cp314-macosx_10_13_x86_64.whl", hash = "sha256:d0005b053977e7b43388ddec89fa567f43d4f6d5c2c0affe57de5ebf290dc552", size = 66605, upload-time = "2025-08-10T21:27:03.335Z" },
+    { url = "https://files.pythonhosted.org/packages/f7/69/00aafdb4e4509c2ca6064646cba9cd4b37933898f426756adb2cb92ebbed/kiwisolver-1.4.9-cp314-cp314-macosx_11_0_arm64.whl", hash = "sha256:2635d352d67458b66fd0667c14cb1d4145e9560d503219034a18a87e971ce4f3", size = 64925, upload-time = "2025-08-10T21:27:04.339Z" },
+    { url = "https://files.pythonhosted.org/packages/43/dc/51acc6791aa14e5cb6d8a2e28cefb0dc2886d8862795449d021334c0df20/kiwisolver-1.4.9-cp314-cp314-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:767c23ad1c58c9e827b649a9ab7809fd5fd9db266a9cf02b0e926ddc2c680d58", size = 1472414, upload-time = "2025-08-10T21:27:05.437Z" },
+    { url = "https://files.pythonhosted.org/packages/3d/bb/93fa64a81db304ac8a246f834d5094fae4b13baf53c839d6bb6e81177129/kiwisolver-1.4.9-cp314-cp314-manylinux_2_24_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:72d0eb9fba308b8311685c2268cf7d0a0639a6cd027d8128659f72bdd8a024b4", size = 1281272, upload-time = "2025-08-10T21:27:07.063Z" },
+    { url = "https://files.pythonhosted.org/packages/70/e6/6df102916960fb8d05069d4bd92d6d9a8202d5a3e2444494e7cd50f65b7a/kiwisolver-1.4.9-cp314-cp314-manylinux_2_24_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:f68e4f3eeca8fb22cc3d731f9715a13b652795ef657a13df1ad0c7dc0e9731df", size = 1298578, upload-time = "2025-08-10T21:27:08.452Z" },
+    { url = "https://files.pythonhosted.org/packages/7c/47/e142aaa612f5343736b087864dbaebc53ea8831453fb47e7521fa8658f30/kiwisolver-1.4.9-cp314-cp314-manylinux_2_24_s390x.manylinux_2_28_s390x.whl", hash = "sha256:d84cd4061ae292d8ac367b2c3fa3aad11cb8625a95d135fe93f286f914f3f5a6", size = 1345607, upload-time = "2025-08-10T21:27:10.125Z" },
+    { url = "https://files.pythonhosted.org/packages/54/89/d641a746194a0f4d1a3670fb900d0dbaa786fb98341056814bc3f058fa52/kiwisolver-1.4.9-cp314-cp314-musllinux_1_2_aarch64.whl", hash = "sha256:a60ea74330b91bd22a29638940d115df9dc00af5035a9a2a6ad9399ffb4ceca5", size = 2230150, upload-time = "2025-08-10T21:27:11.484Z" },
+    { url = "https://files.pythonhosted.org/packages/aa/6b/5ee1207198febdf16ac11f78c5ae40861b809cbe0e6d2a8d5b0b3044b199/kiwisolver-1.4.9-cp314-cp314-musllinux_1_2_ppc64le.whl", hash = "sha256:ce6a3a4e106cf35c2d9c4fa17c05ce0b180db622736845d4315519397a77beaf", size = 2325979, upload-time = "2025-08-10T21:27:12.917Z" },
+    { url = "https://files.pythonhosted.org/packages/fc/ff/b269eefd90f4ae14dcc74973d5a0f6d28d3b9bb1afd8c0340513afe6b39a/kiwisolver-1.4.9-cp314-cp314-musllinux_1_2_s390x.whl", hash = "sha256:77937e5e2a38a7b48eef0585114fe7930346993a88060d0bf886086d2aa49ef5", size = 2491456, upload-time = "2025-08-10T21:27:14.353Z" },
+    { url = "https://files.pythonhosted.org/packages/fc/d4/10303190bd4d30de547534601e259a4fbf014eed94aae3e5521129215086/kiwisolver-1.4.9-cp314-cp314-musllinux_1_2_x86_64.whl", hash = "sha256:24c175051354f4a28c5d6a31c93906dc653e2bf234e8a4bbfb964892078898ce", size = 2294621, upload-time = "2025-08-10T21:27:15.808Z" },
+    { url = "https://files.pythonhosted.org/packages/28/e0/a9a90416fce5c0be25742729c2ea52105d62eda6c4be4d803c2a7be1fa50/kiwisolver-1.4.9-cp314-cp314-win_amd64.whl", hash = "sha256:0763515d4df10edf6d06a3c19734e2566368980d21ebec439f33f9eb936c07b7", size = 75417, upload-time = "2025-08-10T21:27:17.436Z" },
+    { url = "https://files.pythonhosted.org/packages/1f/10/6949958215b7a9a264299a7db195564e87900f709db9245e4ebdd3c70779/kiwisolver-1.4.9-cp314-cp314-win_arm64.whl", hash = "sha256:0e4e2bf29574a6a7b7f6cb5fa69293b9f96c928949ac4a53ba3f525dffb87f9c", size = 66582, upload-time = "2025-08-10T21:27:18.436Z" },
+    { url = "https://files.pythonhosted.org/packages/ec/79/60e53067903d3bc5469b369fe0dfc6b3482e2133e85dae9daa9527535991/kiwisolver-1.4.9-cp314-cp314t-macosx_10_13_universal2.whl", hash = "sha256:d976bbb382b202f71c67f77b0ac11244021cfa3f7dfd9e562eefcea2df711548", size = 126514, upload-time = "2025-08-10T21:27:19.465Z" },
+    { url = "https://files.pythonhosted.org/packages/25/d1/4843d3e8d46b072c12a38c97c57fab4608d36e13fe47d47ee96b4d61ba6f/kiwisolver-1.4.9-cp314-cp314t-macosx_10_13_x86_64.whl", hash = "sha256:2489e4e5d7ef9a1c300a5e0196e43d9c739f066ef23270607d45aba368b91f2d", size = 67905, upload-time = "2025-08-10T21:27:20.51Z" },
+    { url = "https://files.pythonhosted.org/packages/8c/ae/29ffcbd239aea8b93108de1278271ae764dfc0d803a5693914975f200596/kiwisolver-1.4.9-cp314-cp314t-macosx_11_0_arm64.whl", hash = "sha256:e2ea9f7ab7fbf18fffb1b5434ce7c69a07582f7acc7717720f1d69f3e806f90c", size = 66399, upload-time = "2025-08-10T21:27:21.496Z" },
+    { url = "https://files.pythonhosted.org/packages/a1/ae/d7ba902aa604152c2ceba5d352d7b62106bedbccc8e95c3934d94472bfa3/kiwisolver-1.4.9-cp314-cp314t-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:b34e51affded8faee0dfdb705416153819d8ea9250bbbf7ea1b249bdeb5f1122", size = 1582197, upload-time = "2025-08-10T21:27:22.604Z" },
+    { url = "https://files.pythonhosted.org/packages/f2/41/27c70d427eddb8bc7e4f16420a20fefc6f480312122a59a959fdfe0445ad/kiwisolver-1.4.9-cp314-cp314t-manylinux_2_24_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:d8aacd3d4b33b772542b2e01beb50187536967b514b00003bdda7589722d2a64", size = 1390125, upload-time = "2025-08-10T21:27:24.036Z" },
+    { url = "https://files.pythonhosted.org/packages/41/42/b3799a12bafc76d962ad69083f8b43b12bf4fe78b097b12e105d75c9b8f1/kiwisolver-1.4.9-cp314-cp314t-manylinux_2_24_ppc64le.manylinux_2_28_ppc64le.whl", hash = "sha256:7cf974dd4e35fa315563ac99d6287a1024e4dc2077b8a7d7cd3d2fb65d283134", size = 1402612, upload-time = "2025-08-10T21:27:25.773Z" },
+    { url = "https://files.pythonhosted.org/packages/d2/b5/a210ea073ea1cfaca1bb5c55a62307d8252f531beb364e18aa1e0888b5a0/kiwisolver-1.4.9-cp314-cp314t-manylinux_2_24_s390x.manylinux_2_28_s390x.whl", hash = "sha256:85bd218b5ecfbee8c8a82e121802dcb519a86044c9c3b2e4aef02fa05c6da370", size = 1453990, upload-time = "2025-08-10T21:27:27.089Z" },
+    { url = "https://files.pythonhosted.org/packages/5f/ce/a829eb8c033e977d7ea03ed32fb3c1781b4fa0433fbadfff29e39c676f32/kiwisolver-1.4.9-cp314-cp314t-musllinux_1_2_aarch64.whl", hash = "sha256:0856e241c2d3df4efef7c04a1e46b1936b6120c9bcf36dd216e3acd84bc4fb21", size = 2331601, upload-time = "2025-08-10T21:27:29.343Z" },
+    { url = "https://files.pythonhosted.org/packages/e0/4b/b5e97eb142eb9cd0072dacfcdcd31b1c66dc7352b0f7c7255d339c0edf00/kiwisolver-1.4.9-cp314-cp314t-musllinux_1_2_ppc64le.whl", hash = "sha256:9af39d6551f97d31a4deebeac6f45b156f9755ddc59c07b402c148f5dbb6482a", size = 2422041, upload-time = "2025-08-10T21:27:30.754Z" },
+    { url = "https://files.pythonhosted.org/packages/40/be/8eb4cd53e1b85ba4edc3a9321666f12b83113a178845593307a3e7891f44/kiwisolver-1.4.9-cp314-cp314t-musllinux_1_2_s390x.whl", hash = "sha256:bb4ae2b57fc1d8cbd1cf7b1d9913803681ffa903e7488012be5b76dedf49297f", size = 2594897, upload-time = "2025-08-10T21:27:32.803Z" },
+    { url = "https://files.pythonhosted.org/packages/99/dd/841e9a66c4715477ea0abc78da039832fbb09dac5c35c58dc4c41a407b8a/kiwisolver-1.4.9-cp314-cp314t-musllinux_1_2_x86_64.whl", hash = "sha256:aedff62918805fb62d43a4aa2ecd4482c380dc76cd31bd7c8878588a61bd0369", size = 2391835, upload-time = "2025-08-10T21:27:34.23Z" },
+    { url = "https://files.pythonhosted.org/packages/0c/28/4b2e5c47a0da96896fdfdb006340ade064afa1e63675d01ea5ac222b6d52/kiwisolver-1.4.9-cp314-cp314t-win_amd64.whl", hash = "sha256:1fa333e8b2ce4d9660f2cda9c0e1b6bafcfb2457a9d259faa82289e73ec24891", size = 79988, upload-time = "2025-08-10T21:27:35.587Z" },
+    { url = "https://files.pythonhosted.org/packages/80/be/3578e8afd18c88cdf9cb4cffde75a96d2be38c5a903f1ed0ceec061bd09e/kiwisolver-1.4.9-cp314-cp314t-win_arm64.whl", hash = "sha256:4a48a2ce79d65d363597ef7b567ce3d14d68783d2b2263d98db3d9477805ba32", size = 70260, upload-time = "2025-08-10T21:27:36.606Z" },
+    { url = "https://files.pythonhosted.org/packages/a2/63/fde392691690f55b38d5dd7b3710f5353bf7a8e52de93a22968801ab8978/kiwisolver-1.4.9-pp310-pypy310_pp73-macosx_10_15_x86_64.whl", hash = "sha256:4d1d9e582ad4d63062d34077a9a1e9f3c34088a2ec5135b1f7190c07cf366527", size = 60183, upload-time = "2025-08-10T21:27:37.669Z" },
+    { url = "https://files.pythonhosted.org/packages/27/b1/6aad34edfdb7cced27f371866f211332bba215bfd918ad3322a58f480d8b/kiwisolver-1.4.9-pp310-pypy310_pp73-macosx_11_0_arm64.whl", hash = "sha256:deed0c7258ceb4c44ad5ec7d9918f9f14fd05b2be86378d86cf50e63d1e7b771", size = 58675, upload-time = "2025-08-10T21:27:39.031Z" },
+    { url = "https://files.pythonhosted.org/packages/9d/1a/23d855a702bb35a76faed5ae2ba3de57d323f48b1f6b17ee2176c4849463/kiwisolver-1.4.9-pp310-pypy310_pp73-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:0a590506f303f512dff6b7f75fd2fd18e16943efee932008fe7140e5fa91d80e", size = 80277, upload-time = "2025-08-10T21:27:40.129Z" },
+    { url = "https://files.pythonhosted.org/packages/5a/5b/5239e3c2b8fb5afa1e8508f721bb77325f740ab6994d963e61b2b7abcc1e/kiwisolver-1.4.9-pp310-pypy310_pp73-manylinux_2_24_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:e09c2279a4d01f099f52d5c4b3d9e208e91edcbd1a175c9662a8b16e000fece9", size = 77994, upload-time = "2025-08-10T21:27:41.181Z" },
+    { url = "https://files.pythonhosted.org/packages/f9/1c/5d4d468fb16f8410e596ed0eac02d2c68752aa7dc92997fe9d60a7147665/kiwisolver-1.4.9-pp310-pypy310_pp73-win_amd64.whl", hash = "sha256:c9e7cdf45d594ee04d5be1b24dd9d49f3d1590959b2271fb30b5ca2b262c00fb", size = 73744, upload-time = "2025-08-10T21:27:42.254Z" },
+    { url = "https://files.pythonhosted.org/packages/a3/0f/36d89194b5a32c054ce93e586d4049b6c2c22887b0eb229c61c68afd3078/kiwisolver-1.4.9-pp311-pypy311_pp73-macosx_10_15_x86_64.whl", hash = "sha256:720e05574713db64c356e86732c0f3c5252818d05f9df320f0ad8380641acea5", size = 60104, upload-time = "2025-08-10T21:27:43.287Z" },
+    { url = "https://files.pythonhosted.org/packages/52/ba/4ed75f59e4658fd21fe7dde1fee0ac397c678ec3befba3fe6482d987af87/kiwisolver-1.4.9-pp311-pypy311_pp73-macosx_11_0_arm64.whl", hash = "sha256:17680d737d5335b552994a2008fab4c851bcd7de33094a82067ef3a576ff02fa", size = 58592, upload-time = "2025-08-10T21:27:44.314Z" },
+    { url = "https://files.pythonhosted.org/packages/33/01/a8ea7c5ea32a9b45ceeaee051a04c8ed4320f5add3c51bfa20879b765b70/kiwisolver-1.4.9-pp311-pypy311_pp73-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:85b5352f94e490c028926ea567fc569c52ec79ce131dadb968d3853e809518c2", size = 80281, upload-time = "2025-08-10T21:27:45.369Z" },
+    { url = "https://files.pythonhosted.org/packages/da/e3/dbd2ecdce306f1d07a1aaf324817ee993aab7aee9db47ceac757deabafbe/kiwisolver-1.4.9-pp311-pypy311_pp73-manylinux_2_24_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:464415881e4801295659462c49461a24fb107c140de781d55518c4b80cb6790f", size = 78009, upload-time = "2025-08-10T21:27:46.376Z" },
+    { url = "https://files.pythonhosted.org/packages/da/e9/0d4add7873a73e462aeb45c036a2dead2562b825aa46ba326727b3f31016/kiwisolver-1.4.9-pp311-pypy311_pp73-win_amd64.whl", hash = "sha256:fb940820c63a9590d31d88b815e7a3aa5915cad3ce735ab45f0c730b39547de1", size = 73929, upload-time = "2025-08-10T21:27:48.236Z" },
+]
+
+[[package]]
+name = "markdown-it-py"
+version = "3.0.0"
+source = { registry = "https://pypi.org/simple" }
+dependencies = [
+    { name = "mdurl" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/38/71/3b932df36c1a044d397a1f92d1cf91ee0a503d91e470cbd670aa66b07ed0/markdown-it-py-3.0.0.tar.gz", hash = "sha256:e3f60a94fa066dc52ec76661e37c851cb232d92f9886b15cb560aaada2df8feb", size = 74596, upload-time = "2023-06-03T06:41:14.443Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/42/d7/1ec15b46af6af88f19b8e5ffea08fa375d433c998b8a7639e76935c14f1f/markdown_it_py-3.0.0-py3-none-any.whl", hash = "sha256:355216845c60bd96232cd8d8c40e8f9765cc86f46880e43a8fd22dc1a1a8cab1", size = 87528, upload-time = "2023-06-03T06:41:11.019Z" },
+]
+
+[[package]]
+name = "markupsafe"
+version = "2.1.5"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/87/5b/aae44c6655f3801e81aa3eef09dbbf012431987ba564d7231722f68df02d/MarkupSafe-2.1.5.tar.gz", hash = "sha256:d283d37a890ba4c1ae73ffadf8046435c76e7bc2247bbb63c00bd1a709c6544b", size = 19384, upload-time = "2024-02-02T16:31:22.863Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/e4/54/ad5eb37bf9d51800010a74e4665425831a9db4e7c4e0fde4352e391e808e/MarkupSafe-2.1.5-cp310-cp310-macosx_10_9_universal2.whl", hash = "sha256:a17a92de5231666cfbe003f0e4b9b3a7ae3afb1ec2845aadc2bacc93ff85febc", size = 18206, upload-time = "2024-02-02T16:30:04.105Z" },
+    { url = "https://files.pythonhosted.org/packages/6a/4a/a4d49415e600bacae038c67f9fecc1d5433b9d3c71a4de6f33537b89654c/MarkupSafe-2.1.5-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:72b6be590cc35924b02c78ef34b467da4ba07e4e0f0454a2c5907f473fc50ce5", size = 14079, upload-time = "2024-02-02T16:30:06.5Z" },
+    { url = "https://files.pythonhosted.org/packages/0a/7b/85681ae3c33c385b10ac0f8dd025c30af83c78cec1c37a6aa3b55e67f5ec/MarkupSafe-2.1.5-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:e61659ba32cf2cf1481e575d0462554625196a1f2fc06a1c777d3f48e8865d46", size = 26620, upload-time = "2024-02-02T16:30:08.31Z" },
+    { url = "https://files.pythonhosted.org/packages/7c/52/2b1b570f6b8b803cef5ac28fdf78c0da318916c7d2fe9402a84d591b394c/MarkupSafe-2.1.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:2174c595a0d73a3080ca3257b40096db99799265e1c27cc5a610743acd86d62f", size = 25818, upload-time = "2024-02-02T16:30:09.577Z" },
+    { url = "https://files.pythonhosted.org/packages/29/fe/a36ba8c7ca55621620b2d7c585313efd10729e63ef81e4e61f52330da781/MarkupSafe-2.1.5-cp310-cp310-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:ae2ad8ae6ebee9d2d94b17fb62763125f3f374c25618198f40cbb8b525411900", size = 25493, upload-time = "2024-02-02T16:30:11.488Z" },
+    { url = "https://files.pythonhosted.org/packages/60/ae/9c60231cdfda003434e8bd27282b1f4e197ad5a710c14bee8bea8a9ca4f0/MarkupSafe-2.1.5-cp310-cp310-musllinux_1_1_aarch64.whl", hash = "sha256:075202fa5b72c86ad32dc7d0b56024ebdbcf2048c0ba09f1cde31bfdd57bcfff", size = 30630, upload-time = "2024-02-02T16:30:13.144Z" },
+    { url = "https://files.pythonhosted.org/packages/65/dc/1510be4d179869f5dafe071aecb3f1f41b45d37c02329dfba01ff59e5ac5/MarkupSafe-2.1.5-cp310-cp310-musllinux_1_1_i686.whl", hash = "sha256:598e3276b64aff0e7b3451b72e94fa3c238d452e7ddcd893c3ab324717456bad", size = 29745, upload-time = "2024-02-02T16:30:14.222Z" },
+    { url = "https://files.pythonhosted.org/packages/30/39/8d845dd7d0b0613d86e0ef89549bfb5f61ed781f59af45fc96496e897f3a/MarkupSafe-2.1.5-cp310-cp310-musllinux_1_1_x86_64.whl", hash = "sha256:fce659a462a1be54d2ffcacea5e3ba2d74daa74f30f5f143fe0c58636e355fdd", size = 30021, upload-time = "2024-02-02T16:30:16.032Z" },
+    { url = "https://files.pythonhosted.org/packages/c7/5c/356a6f62e4f3c5fbf2602b4771376af22a3b16efa74eb8716fb4e328e01e/MarkupSafe-2.1.5-cp310-cp310-win32.whl", hash = "sha256:d9fad5155d72433c921b782e58892377c44bd6252b5af2f67f16b194987338a4", size = 16659, upload-time = "2024-02-02T16:30:17.079Z" },
+    { url = "https://files.pythonhosted.org/packages/69/48/acbf292615c65f0604a0c6fc402ce6d8c991276e16c80c46a8f758fbd30c/MarkupSafe-2.1.5-cp310-cp310-win_amd64.whl", hash = "sha256:bf50cd79a75d181c9181df03572cdce0fbb75cc353bc350712073108cba98de5", size = 17213, upload-time = "2024-02-02T16:30:18.251Z" },
+    { url = "https://files.pythonhosted.org/packages/11/e7/291e55127bb2ae67c64d66cef01432b5933859dfb7d6949daa721b89d0b3/MarkupSafe-2.1.5-cp311-cp311-macosx_10_9_universal2.whl", hash = "sha256:629ddd2ca402ae6dbedfceeba9c46d5f7b2a61d9749597d4307f943ef198fc1f", size = 18219, upload-time = "2024-02-02T16:30:19.988Z" },
+    { url = "https://files.pythonhosted.org/packages/6b/cb/aed7a284c00dfa7c0682d14df85ad4955a350a21d2e3b06d8240497359bf/MarkupSafe-2.1.5-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:5b7b716f97b52c5a14bffdf688f971b2d5ef4029127f1ad7a513973cfd818df2", size = 14098, upload-time = "2024-02-02T16:30:21.063Z" },
+    { url = "https://files.pythonhosted.org/packages/1c/cf/35fe557e53709e93feb65575c93927942087e9b97213eabc3fe9d5b25a55/MarkupSafe-2.1.5-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:6ec585f69cec0aa07d945b20805be741395e28ac1627333b1c5b0105962ffced", size = 29014, upload-time = "2024-02-02T16:30:22.926Z" },
+    { url = "https://files.pythonhosted.org/packages/97/18/c30da5e7a0e7f4603abfc6780574131221d9148f323752c2755d48abad30/MarkupSafe-2.1.5-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:b91c037585eba9095565a3556f611e3cbfaa42ca1e865f7b8015fe5c7336d5a5", size = 28220, upload-time = "2024-02-02T16:30:24.76Z" },
+    { url = "https://files.pythonhosted.org/packages/0c/40/2e73e7d532d030b1e41180807a80d564eda53babaf04d65e15c1cf897e40/MarkupSafe-2.1.5-cp311-cp311-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:7502934a33b54030eaf1194c21c692a534196063db72176b0c4028e140f8f32c", size = 27756, upload-time = "2024-02-02T16:30:25.877Z" },
+    { url = "https://files.pythonhosted.org/packages/18/46/5dca760547e8c59c5311b332f70605d24c99d1303dd9a6e1fc3ed0d73561/MarkupSafe-2.1.5-cp311-cp311-musllinux_1_1_aarch64.whl", hash = "sha256:0e397ac966fdf721b2c528cf028494e86172b4feba51d65f81ffd65c63798f3f", size = 33988, upload-time = "2024-02-02T16:30:26.935Z" },
+    { url = "https://files.pythonhosted.org/packages/6d/c5/27febe918ac36397919cd4a67d5579cbbfa8da027fa1238af6285bb368ea/MarkupSafe-2.1.5-cp311-cp311-musllinux_1_1_i686.whl", hash = "sha256:c061bb86a71b42465156a3ee7bd58c8c2ceacdbeb95d05a99893e08b8467359a", size = 32718, upload-time = "2024-02-02T16:30:28.111Z" },
+    { url = "https://files.pythonhosted.org/packages/f8/81/56e567126a2c2bc2684d6391332e357589a96a76cb9f8e5052d85cb0ead8/MarkupSafe-2.1.5-cp311-cp311-musllinux_1_1_x86_64.whl", hash = "sha256:3a57fdd7ce31c7ff06cdfbf31dafa96cc533c21e443d57f5b1ecc6cdc668ec7f", size = 33317, upload-time = "2024-02-02T16:30:29.214Z" },
+    { url = "https://files.pythonhosted.org/packages/00/0b/23f4b2470accb53285c613a3ab9ec19dc944eaf53592cb6d9e2af8aa24cc/MarkupSafe-2.1.5-cp311-cp311-win32.whl", hash = "sha256:397081c1a0bfb5124355710fe79478cdbeb39626492b15d399526ae53422b906", size = 16670, upload-time = "2024-02-02T16:30:30.915Z" },
+    { url = "https://files.pythonhosted.org/packages/b7/a2/c78a06a9ec6d04b3445a949615c4c7ed86a0b2eb68e44e7541b9d57067cc/MarkupSafe-2.1.5-cp311-cp311-win_amd64.whl", hash = "sha256:2b7c57a4dfc4f16f7142221afe5ba4e093e09e728ca65c51f5620c9aaeb9a617", size = 17224, upload-time = "2024-02-02T16:30:32.09Z" },
+    { url = "https://files.pythonhosted.org/packages/53/bd/583bf3e4c8d6a321938c13f49d44024dbe5ed63e0a7ba127e454a66da974/MarkupSafe-2.1.5-cp312-cp312-macosx_10_9_universal2.whl", hash = "sha256:8dec4936e9c3100156f8a2dc89c4b88d5c435175ff03413b443469c7c8c5f4d1", size = 18215, upload-time = "2024-02-02T16:30:33.081Z" },
+    { url = "https://files.pythonhosted.org/packages/48/d6/e7cd795fc710292c3af3a06d80868ce4b02bfbbf370b7cee11d282815a2a/MarkupSafe-2.1.5-cp312-cp312-macosx_10_9_x86_64.whl", hash = "sha256:3c6b973f22eb18a789b1460b4b91bf04ae3f0c4234a0a6aa6b0a92f6f7b951d4", size = 14069, upload-time = "2024-02-02T16:30:34.148Z" },
+    { url = "https://files.pythonhosted.org/packages/51/b5/5d8ec796e2a08fc814a2c7d2584b55f889a55cf17dd1a90f2beb70744e5c/MarkupSafe-2.1.5-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:ac07bad82163452a6884fe8fa0963fb98c2346ba78d779ec06bd7a6262132aee", size = 29452, upload-time = "2024-02-02T16:30:35.149Z" },
+    { url = "https://files.pythonhosted.org/packages/0a/0d/2454f072fae3b5a137c119abf15465d1771319dfe9e4acbb31722a0fff91/MarkupSafe-2.1.5-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:f5dfb42c4604dddc8e4305050aa6deb084540643ed5804d7455b5df8fe16f5e5", size = 28462, upload-time = "2024-02-02T16:30:36.166Z" },
+    { url = "https://files.pythonhosted.org/packages/2d/75/fd6cb2e68780f72d47e6671840ca517bda5ef663d30ada7616b0462ad1e3/MarkupSafe-2.1.5-cp312-cp312-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:ea3d8a3d18833cf4304cd2fc9cbb1efe188ca9b5efef2bdac7adc20594a0e46b", size = 27869, upload-time = "2024-02-02T16:30:37.834Z" },
+    { url = "https://files.pythonhosted.org/packages/b0/81/147c477391c2750e8fc7705829f7351cf1cd3be64406edcf900dc633feb2/MarkupSafe-2.1.5-cp312-cp312-musllinux_1_1_aarch64.whl", hash = "sha256:d050b3361367a06d752db6ead6e7edeb0009be66bc3bae0ee9d97fb326badc2a", size = 33906, upload-time = "2024-02-02T16:30:39.366Z" },
+    { url = "https://files.pythonhosted.org/packages/8b/ff/9a52b71839d7a256b563e85d11050e307121000dcebc97df120176b3ad93/MarkupSafe-2.1.5-cp312-cp312-musllinux_1_1_i686.whl", hash = "sha256:bec0a414d016ac1a18862a519e54b2fd0fc8bbfd6890376898a6c0891dd82e9f", size = 32296, upload-time = "2024-02-02T16:30:40.413Z" },
+    { url = "https://files.pythonhosted.org/packages/88/07/2dc76aa51b481eb96a4c3198894f38b480490e834479611a4053fbf08623/MarkupSafe-2.1.5-cp312-cp312-musllinux_1_1_x86_64.whl", hash = "sha256:58c98fee265677f63a4385256a6d7683ab1832f3ddd1e66fe948d5880c21a169", size = 33038, upload-time = "2024-02-02T16:30:42.243Z" },
+    { url = "https://files.pythonhosted.org/packages/96/0c/620c1fb3661858c0e37eb3cbffd8c6f732a67cd97296f725789679801b31/MarkupSafe-2.1.5-cp312-cp312-win32.whl", hash = "sha256:8590b4ae07a35970728874632fed7bd57b26b0102df2d2b233b6d9d82f6c62ad", size = 16572, upload-time = "2024-02-02T16:30:43.326Z" },
+    { url = "https://files.pythonhosted.org/packages/3f/14/c3554d512d5f9100a95e737502f4a2323a1959f6d0d01e0d0997b35f7b10/MarkupSafe-2.1.5-cp312-cp312-win_amd64.whl", hash = "sha256:823b65d8706e32ad2df51ed89496147a42a2a6e01c13cfb6ffb8b1e92bc910bb", size = 17127, upload-time = "2024-02-02T16:30:44.418Z" },
+    { url = "https://files.pythonhosted.org/packages/f8/ff/2c942a82c35a49df5de3a630ce0a8456ac2969691b230e530ac12314364c/MarkupSafe-2.1.5-cp38-cp38-macosx_10_9_universal2.whl", hash = "sha256:656f7526c69fac7f600bd1f400991cc282b417d17539a1b228617081106feb4a", size = 18192, upload-time = "2024-02-02T16:30:57.715Z" },
+    { url = "https://files.pythonhosted.org/packages/4f/14/6f294b9c4f969d0c801a4615e221c1e084722ea6114ab2114189c5b8cbe0/MarkupSafe-2.1.5-cp38-cp38-macosx_10_9_x86_64.whl", hash = "sha256:97cafb1f3cbcd3fd2b6fbfb99ae11cdb14deea0736fc2b0952ee177f2b813a46", size = 14072, upload-time = "2024-02-02T16:30:58.844Z" },
+    { url = "https://files.pythonhosted.org/packages/81/d4/fd74714ed30a1dedd0b82427c02fa4deec64f173831ec716da11c51a50aa/MarkupSafe-2.1.5-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:1f3fbcb7ef1f16e48246f704ab79d79da8a46891e2da03f8783a5b6fa41a9532", size = 26928, upload-time = "2024-02-02T16:30:59.922Z" },
+    { url = "https://files.pythonhosted.org/packages/c7/bd/50319665ce81bb10e90d1cf76f9e1aa269ea6f7fa30ab4521f14d122a3df/MarkupSafe-2.1.5-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:fa9db3f79de01457b03d4f01b34cf91bc0048eb2c3846ff26f66687c2f6d16ab", size = 26106, upload-time = "2024-02-02T16:31:01.582Z" },
+    { url = "https://files.pythonhosted.org/packages/4c/6f/f2b0f675635b05f6afd5ea03c094557bdb8622fa8e673387444fe8d8e787/MarkupSafe-2.1.5-cp38-cp38-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:ffee1f21e5ef0d712f9033568f8344d5da8cc2869dbd08d87c84656e6a2d2f68", size = 25781, upload-time = "2024-02-02T16:31:02.71Z" },
+    { url = "https://files.pythonhosted.org/packages/51/e0/393467cf899b34a9d3678e78961c2c8cdf49fb902a959ba54ece01273fb1/MarkupSafe-2.1.5-cp38-cp38-musllinux_1_1_aarch64.whl", hash = "sha256:5dedb4db619ba5a2787a94d877bc8ffc0566f92a01c0ef214865e54ecc9ee5e0", size = 30518, upload-time = "2024-02-02T16:31:04.392Z" },
+    { url = "https://files.pythonhosted.org/packages/f6/02/5437e2ad33047290dafced9df741d9efc3e716b75583bbd73a9984f1b6f7/MarkupSafe-2.1.5-cp38-cp38-musllinux_1_1_i686.whl", hash = "sha256:30b600cf0a7ac9234b2638fbc0fb6158ba5bdcdf46aeb631ead21248b9affbc4", size = 29669, upload-time = "2024-02-02T16:31:05.53Z" },
+    { url = "https://files.pythonhosted.org/packages/0e/7d/968284145ffd9d726183ed6237c77938c021abacde4e073020f920e060b2/MarkupSafe-2.1.5-cp38-cp38-musllinux_1_1_x86_64.whl", hash = "sha256:8dd717634f5a044f860435c1d8c16a270ddf0ef8588d4887037c5028b859b0c3", size = 29933, upload-time = "2024-02-02T16:31:06.636Z" },
+    { url = "https://files.pythonhosted.org/packages/bf/f3/ecb00fc8ab02b7beae8699f34db9357ae49d9f21d4d3de6f305f34fa949e/MarkupSafe-2.1.5-cp38-cp38-win32.whl", hash = "sha256:daa4ee5a243f0f20d528d939d06670a298dd39b1ad5f8a72a4275124a7819eff", size = 16656, upload-time = "2024-02-02T16:31:07.767Z" },
+    { url = "https://files.pythonhosted.org/packages/92/21/357205f03514a49b293e214ac39de01fadd0970a6e05e4bf1ddd0ffd0881/MarkupSafe-2.1.5-cp38-cp38-win_amd64.whl", hash = "sha256:619bc166c4f2de5caa5a633b8b7326fbe98e0ccbfacabd87268a2b15ff73a029", size = 17206, upload-time = "2024-02-02T16:31:08.843Z" },
+    { url = "https://files.pythonhosted.org/packages/0f/31/780bb297db036ba7b7bbede5e1d7f1e14d704ad4beb3ce53fb495d22bc62/MarkupSafe-2.1.5-cp39-cp39-macosx_10_9_universal2.whl", hash = "sha256:7a68b554d356a91cce1236aa7682dc01df0edba8d043fd1ce607c49dd3c1edcf", size = 18193, upload-time = "2024-02-02T16:31:10.155Z" },
+    { url = "https://files.pythonhosted.org/packages/6c/77/d77701bbef72892affe060cdacb7a2ed7fd68dae3b477a8642f15ad3b132/MarkupSafe-2.1.5-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:db0b55e0f3cc0be60c1f19efdde9a637c32740486004f20d1cff53c3c0ece4d2", size = 14073, upload-time = "2024-02-02T16:31:11.442Z" },
+    { url = "https://files.pythonhosted.org/packages/d9/a7/1e558b4f78454c8a3a0199292d96159eb4d091f983bc35ef258314fe7269/MarkupSafe-2.1.5-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:3e53af139f8579a6d5f7b76549125f0d94d7e630761a2111bc431fd820e163b8", size = 26486, upload-time = "2024-02-02T16:31:12.488Z" },
+    { url = "https://files.pythonhosted.org/packages/5f/5a/360da85076688755ea0cceb92472923086993e86b5613bbae9fbc14136b0/MarkupSafe-2.1.5-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:17b950fccb810b3293638215058e432159d2b71005c74371d784862b7e4683f3", size = 25685, upload-time = "2024-02-02T16:31:13.726Z" },
+    { url = "https://files.pythonhosted.org/packages/6a/18/ae5a258e3401f9b8312f92b028c54d7026a97ec3ab20bfaddbdfa7d8cce8/MarkupSafe-2.1.5-cp39-cp39-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:4c31f53cdae6ecfa91a77820e8b151dba54ab528ba65dfd235c80b086d68a465", size = 25338, upload-time = "2024-02-02T16:31:14.812Z" },
+    { url = "https://files.pythonhosted.org/packages/0b/cc/48206bd61c5b9d0129f4d75243b156929b04c94c09041321456fd06a876d/MarkupSafe-2.1.5-cp39-cp39-musllinux_1_1_aarch64.whl", hash = "sha256:bff1b4290a66b490a2f4719358c0cdcd9bafb6b8f061e45c7a2460866bf50c2e", size = 30439, upload-time = "2024-02-02T16:31:15.946Z" },
+    { url = "https://files.pythonhosted.org/packages/d1/06/a41c112ab9ffdeeb5f77bc3e331fdadf97fa65e52e44ba31880f4e7f983c/MarkupSafe-2.1.5-cp39-cp39-musllinux_1_1_i686.whl", hash = "sha256:bc1667f8b83f48511b94671e0e441401371dfd0f0a795c7daa4a3cd1dde55bea", size = 29531, upload-time = "2024-02-02T16:31:17.13Z" },
+    { url = "https://files.pythonhosted.org/packages/02/8c/ab9a463301a50dab04d5472e998acbd4080597abc048166ded5c7aa768c8/MarkupSafe-2.1.5-cp39-cp39-musllinux_1_1_x86_64.whl", hash = "sha256:5049256f536511ee3f7e1b3f87d1d1209d327e818e6ae1365e8653d7e3abb6a6", size = 29823, upload-time = "2024-02-02T16:31:18.247Z" },
+    { url = "https://files.pythonhosted.org/packages/bc/29/9bc18da763496b055d8e98ce476c8e718dcfd78157e17f555ce6dd7d0895/MarkupSafe-2.1.5-cp39-cp39-win32.whl", hash = "sha256:00e046b6dd71aa03a41079792f8473dc494d564611a8f89bbbd7cb93295ebdcf", size = 16658, upload-time = "2024-02-02T16:31:19.583Z" },
+    { url = "https://files.pythonhosted.org/packages/f6/f8/4da07de16f10551ca1f640c92b5f316f9394088b183c6a57183df6de5ae4/MarkupSafe-2.1.5-cp39-cp39-win_amd64.whl", hash = "sha256:fa173ec60341d6bb97a89f5ea19c85c5643c1e7dedebc22f5181eb73573142c5", size = 17211, upload-time = "2024-02-02T16:31:20.96Z" },
+]
+
+[[package]]
+name = "markupsafe"
+version = "3.0.3"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/7e/99/7690b6d4034fffd95959cbe0c02de8deb3098cc577c67bb6a24fe5d7caa7/markupsafe-3.0.3.tar.gz", hash = "sha256:722695808f4b6457b320fdc131280796bdceb04ab50fe1795cd540799ebe1698", size = 80313, upload-time = "2025-09-27T18:37:40.426Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/e8/4b/3541d44f3937ba468b75da9eebcae497dcf67adb65caa16760b0a6807ebb/markupsafe-3.0.3-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:2f981d352f04553a7171b8e44369f2af4055f888dfb147d55e42d29e29e74559", size = 11631, upload-time = "2025-09-27T18:36:05.558Z" },
+    { url = "https://files.pythonhosted.org/packages/98/1b/fbd8eed11021cabd9226c37342fa6ca4e8a98d8188a8d9b66740494960e4/markupsafe-3.0.3-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:e1c1493fb6e50ab01d20a22826e57520f1284df32f2d8601fdd90b6304601419", size = 12057, upload-time = "2025-09-27T18:36:07.165Z" },
+    { url = "https://files.pythonhosted.org/packages/40/01/e560d658dc0bb8ab762670ece35281dec7b6c1b33f5fbc09ebb57a185519/markupsafe-3.0.3-cp310-cp310-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:1ba88449deb3de88bd40044603fafffb7bc2b055d626a330323a9ed736661695", size = 22050, upload-time = "2025-09-27T18:36:08.005Z" },
+    { url = "https://files.pythonhosted.org/packages/af/cd/ce6e848bbf2c32314c9b237839119c5a564a59725b53157c856e90937b7a/markupsafe-3.0.3-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:f42d0984e947b8adf7dd6dde396e720934d12c506ce84eea8476409563607591", size = 20681, upload-time = "2025-09-27T18:36:08.881Z" },
+    { url = "https://files.pythonhosted.org/packages/c9/2a/b5c12c809f1c3045c4d580b035a743d12fcde53cf685dbc44660826308da/markupsafe-3.0.3-cp310-cp310-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:c0c0b3ade1c0b13b936d7970b1d37a57acde9199dc2aecc4c336773e1d86049c", size = 20705, upload-time = "2025-09-27T18:36:10.131Z" },
+    { url = "https://files.pythonhosted.org/packages/cf/e3/9427a68c82728d0a88c50f890d0fc072a1484de2f3ac1ad0bfc1a7214fd5/markupsafe-3.0.3-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:0303439a41979d9e74d18ff5e2dd8c43ed6c6001fd40e5bf2e43f7bd9bbc523f", size = 21524, upload-time = "2025-09-27T18:36:11.324Z" },
+    { url = "https://files.pythonhosted.org/packages/bc/36/23578f29e9e582a4d0278e009b38081dbe363c5e7165113fad546918a232/markupsafe-3.0.3-cp310-cp310-musllinux_1_2_riscv64.whl", hash = "sha256:d2ee202e79d8ed691ceebae8e0486bd9a2cd4794cec4824e1c99b6f5009502f6", size = 20282, upload-time = "2025-09-27T18:36:12.573Z" },
+    { url = "https://files.pythonhosted.org/packages/56/21/dca11354e756ebd03e036bd8ad58d6d7168c80ce1fe5e75218e4945cbab7/markupsafe-3.0.3-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:177b5253b2834fe3678cb4a5f0059808258584c559193998be2601324fdeafb1", size = 20745, upload-time = "2025-09-27T18:36:13.504Z" },
+    { url = "https://files.pythonhosted.org/packages/87/99/faba9369a7ad6e4d10b6a5fbf71fa2a188fe4a593b15f0963b73859a1bbd/markupsafe-3.0.3-cp310-cp310-win32.whl", hash = "sha256:2a15a08b17dd94c53a1da0438822d70ebcd13f8c3a95abe3a9ef9f11a94830aa", size = 14571, upload-time = "2025-09-27T18:36:14.779Z" },
+    { url = "https://files.pythonhosted.org/packages/d6/25/55dc3ab959917602c96985cb1253efaa4ff42f71194bddeb61eb7278b8be/markupsafe-3.0.3-cp310-cp310-win_amd64.whl", hash = "sha256:c4ffb7ebf07cfe8931028e3e4c85f0357459a3f9f9490886198848f4fa002ec8", size = 15056, upload-time = "2025-09-27T18:36:16.125Z" },
+    { url = "https://files.pythonhosted.org/packages/d0/9e/0a02226640c255d1da0b8d12e24ac2aa6734da68bff14c05dd53b94a0fc3/markupsafe-3.0.3-cp310-cp310-win_arm64.whl", hash = "sha256:e2103a929dfa2fcaf9bb4e7c091983a49c9ac3b19c9061b6d5427dd7d14d81a1", size = 13932, upload-time = "2025-09-27T18:36:17.311Z" },
+    { url = "https://files.pythonhosted.org/packages/08/db/fefacb2136439fc8dd20e797950e749aa1f4997ed584c62cfb8ef7c2be0e/markupsafe-3.0.3-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:1cc7ea17a6824959616c525620e387f6dd30fec8cb44f649e31712db02123dad", size = 11631, upload-time = "2025-09-27T18:36:18.185Z" },
+    { url = "https://files.pythonhosted.org/packages/e1/2e/5898933336b61975ce9dc04decbc0a7f2fee78c30353c5efba7f2d6ff27a/markupsafe-3.0.3-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:4bd4cd07944443f5a265608cc6aab442e4f74dff8088b0dfc8238647b8f6ae9a", size = 12058, upload-time = "2025-09-27T18:36:19.444Z" },
+    { url = "https://files.pythonhosted.org/packages/1d/09/adf2df3699d87d1d8184038df46a9c80d78c0148492323f4693df54e17bb/markupsafe-3.0.3-cp311-cp311-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:6b5420a1d9450023228968e7e6a9ce57f65d148ab56d2313fcd589eee96a7a50", size = 24287, upload-time = "2025-09-27T18:36:20.768Z" },
+    { url = "https://files.pythonhosted.org/packages/30/ac/0273f6fcb5f42e314c6d8cd99effae6a5354604d461b8d392b5ec9530a54/markupsafe-3.0.3-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:0bf2a864d67e76e5c9a34dc26ec616a66b9888e25e7b9460e1c76d3293bd9dbf", size = 22940, upload-time = "2025-09-27T18:36:22.249Z" },
+    { url = "https://files.pythonhosted.org/packages/19/ae/31c1be199ef767124c042c6c3e904da327a2f7f0cd63a0337e1eca2967a8/markupsafe-3.0.3-cp311-cp311-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:bc51efed119bc9cfdf792cdeaa4d67e8f6fcccab66ed4bfdd6bde3e59bfcbb2f", size = 21887, upload-time = "2025-09-27T18:36:23.535Z" },
+    { url = "https://files.pythonhosted.org/packages/b2/76/7edcab99d5349a4532a459e1fe64f0b0467a3365056ae550d3bcf3f79e1e/markupsafe-3.0.3-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:068f375c472b3e7acbe2d5318dea141359e6900156b5b2ba06a30b169086b91a", size = 23692, upload-time = "2025-09-27T18:36:24.823Z" },
+    { url = "https://files.pythonhosted.org/packages/a4/28/6e74cdd26d7514849143d69f0bf2399f929c37dc2b31e6829fd2045b2765/markupsafe-3.0.3-cp311-cp311-musllinux_1_2_riscv64.whl", hash = "sha256:7be7b61bb172e1ed687f1754f8e7484f1c8019780f6f6b0786e76bb01c2ae115", size = 21471, upload-time = "2025-09-27T18:36:25.95Z" },
+    { url = "https://files.pythonhosted.org/packages/62/7e/a145f36a5c2945673e590850a6f8014318d5577ed7e5920a4b3448e0865d/markupsafe-3.0.3-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:f9e130248f4462aaa8e2552d547f36ddadbeaa573879158d721bbd33dfe4743a", size = 22923, upload-time = "2025-09-27T18:36:27.109Z" },
+    { url = "https://files.pythonhosted.org/packages/0f/62/d9c46a7f5c9adbeeeda52f5b8d802e1094e9717705a645efc71b0913a0a8/markupsafe-3.0.3-cp311-cp311-win32.whl", hash = "sha256:0db14f5dafddbb6d9208827849fad01f1a2609380add406671a26386cdf15a19", size = 14572, upload-time = "2025-09-27T18:36:28.045Z" },
+    { url = "https://files.pythonhosted.org/packages/83/8a/4414c03d3f891739326e1783338e48fb49781cc915b2e0ee052aa490d586/markupsafe-3.0.3-cp311-cp311-win_amd64.whl", hash = "sha256:de8a88e63464af587c950061a5e6a67d3632e36df62b986892331d4620a35c01", size = 15077, upload-time = "2025-09-27T18:36:29.025Z" },
+    { url = "https://files.pythonhosted.org/packages/35/73/893072b42e6862f319b5207adc9ae06070f095b358655f077f69a35601f0/markupsafe-3.0.3-cp311-cp311-win_arm64.whl", hash = "sha256:3b562dd9e9ea93f13d53989d23a7e775fdfd1066c33494ff43f5418bc8c58a5c", size = 13876, upload-time = "2025-09-27T18:36:29.954Z" },
+    { url = "https://files.pythonhosted.org/packages/5a/72/147da192e38635ada20e0a2e1a51cf8823d2119ce8883f7053879c2199b5/markupsafe-3.0.3-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:d53197da72cc091b024dd97249dfc7794d6a56530370992a5e1a08983ad9230e", size = 11615, upload-time = "2025-09-27T18:36:30.854Z" },
+    { url = "https://files.pythonhosted.org/packages/9a/81/7e4e08678a1f98521201c3079f77db69fb552acd56067661f8c2f534a718/markupsafe-3.0.3-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:1872df69a4de6aead3491198eaf13810b565bdbeec3ae2dc8780f14458ec73ce", size = 12020, upload-time = "2025-09-27T18:36:31.971Z" },
+    { url = "https://files.pythonhosted.org/packages/1e/2c/799f4742efc39633a1b54a92eec4082e4f815314869865d876824c257c1e/markupsafe-3.0.3-cp312-cp312-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:3a7e8ae81ae39e62a41ec302f972ba6ae23a5c5396c8e60113e9066ef893da0d", size = 24332, upload-time = "2025-09-27T18:36:32.813Z" },
+    { url = "https://files.pythonhosted.org/packages/3c/2e/8d0c2ab90a8c1d9a24f0399058ab8519a3279d1bd4289511d74e909f060e/markupsafe-3.0.3-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:d6dd0be5b5b189d31db7cda48b91d7e0a9795f31430b7f271219ab30f1d3ac9d", size = 22947, upload-time = "2025-09-27T18:36:33.86Z" },
+    { url = "https://files.pythonhosted.org/packages/2c/54/887f3092a85238093a0b2154bd629c89444f395618842e8b0c41783898ea/markupsafe-3.0.3-cp312-cp312-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:94c6f0bb423f739146aec64595853541634bde58b2135f27f61c1ffd1cd4d16a", size = 21962, upload-time = "2025-09-27T18:36:35.099Z" },
+    { url = "https://files.pythonhosted.org/packages/c9/2f/336b8c7b6f4a4d95e91119dc8521402461b74a485558d8f238a68312f11c/markupsafe-3.0.3-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:be8813b57049a7dc738189df53d69395eba14fb99345e0a5994914a3864c8a4b", size = 23760, upload-time = "2025-09-27T18:36:36.001Z" },
+    { url = "https://files.pythonhosted.org/packages/32/43/67935f2b7e4982ffb50a4d169b724d74b62a3964bc1a9a527f5ac4f1ee2b/markupsafe-3.0.3-cp312-cp312-musllinux_1_2_riscv64.whl", hash = "sha256:83891d0e9fb81a825d9a6d61e3f07550ca70a076484292a70fde82c4b807286f", size = 21529, upload-time = "2025-09-27T18:36:36.906Z" },
+    { url = "https://files.pythonhosted.org/packages/89/e0/4486f11e51bbba8b0c041098859e869e304d1c261e59244baa3d295d47b7/markupsafe-3.0.3-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:77f0643abe7495da77fb436f50f8dab76dbc6e5fd25d39589a0f1fe6548bfa2b", size = 23015, upload-time = "2025-09-27T18:36:37.868Z" },
+    { url = "https://files.pythonhosted.org/packages/2f/e1/78ee7a023dac597a5825441ebd17170785a9dab23de95d2c7508ade94e0e/markupsafe-3.0.3-cp312-cp312-win32.whl", hash = "sha256:d88b440e37a16e651bda4c7c2b930eb586fd15ca7406cb39e211fcff3bf3017d", size = 14540, upload-time = "2025-09-27T18:36:38.761Z" },
+    { url = "https://files.pythonhosted.org/packages/aa/5b/bec5aa9bbbb2c946ca2733ef9c4ca91c91b6a24580193e891b5f7dbe8e1e/markupsafe-3.0.3-cp312-cp312-win_amd64.whl", hash = "sha256:26a5784ded40c9e318cfc2bdb30fe164bdb8665ded9cd64d500a34fb42067b1c", size = 15105, upload-time = "2025-09-27T18:36:39.701Z" },
+    { url = "https://files.pythonhosted.org/packages/e5/f1/216fc1bbfd74011693a4fd837e7026152e89c4bcf3e77b6692fba9923123/markupsafe-3.0.3-cp312-cp312-win_arm64.whl", hash = "sha256:35add3b638a5d900e807944a078b51922212fb3dedb01633a8defc4b01a3c85f", size = 13906, upload-time = "2025-09-27T18:36:40.689Z" },
+    { url = "https://files.pythonhosted.org/packages/38/2f/907b9c7bbba283e68f20259574b13d005c121a0fa4c175f9bed27c4597ff/markupsafe-3.0.3-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:e1cf1972137e83c5d4c136c43ced9ac51d0e124706ee1c8aa8532c1287fa8795", size = 11622, upload-time = "2025-09-27T18:36:41.777Z" },
+    { url = "https://files.pythonhosted.org/packages/9c/d9/5f7756922cdd676869eca1c4e3c0cd0df60ed30199ffd775e319089cb3ed/markupsafe-3.0.3-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:116bb52f642a37c115f517494ea5feb03889e04df47eeff5b130b1808ce7c219", size = 12029, upload-time = "2025-09-27T18:36:43.257Z" },
+    { url = "https://files.pythonhosted.org/packages/00/07/575a68c754943058c78f30db02ee03a64b3c638586fba6a6dd56830b30a3/markupsafe-3.0.3-cp313-cp313-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:133a43e73a802c5562be9bbcd03d090aa5a1fe899db609c29e8c8d815c5f6de6", size = 24374, upload-time = "2025-09-27T18:36:44.508Z" },
+    { url = "https://files.pythonhosted.org/packages/a9/21/9b05698b46f218fc0e118e1f8168395c65c8a2c750ae2bab54fc4bd4e0e8/markupsafe-3.0.3-cp313-cp313-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:ccfcd093f13f0f0b7fdd0f198b90053bf7b2f02a3927a30e63f3ccc9df56b676", size = 22980, upload-time = "2025-09-27T18:36:45.385Z" },
+    { url = "https://files.pythonhosted.org/packages/7f/71/544260864f893f18b6827315b988c146b559391e6e7e8f7252839b1b846a/markupsafe-3.0.3-cp313-cp313-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:509fa21c6deb7a7a273d629cf5ec029bc209d1a51178615ddf718f5918992ab9", size = 21990, upload-time = "2025-09-27T18:36:46.916Z" },
+    { url = "https://files.pythonhosted.org/packages/c2/28/b50fc2f74d1ad761af2f5dcce7492648b983d00a65b8c0e0cb457c82ebbe/markupsafe-3.0.3-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:a4afe79fb3de0b7097d81da19090f4df4f8d3a2b3adaa8764138aac2e44f3af1", size = 23784, upload-time = "2025-09-27T18:36:47.884Z" },
+    { url = "https://files.pythonhosted.org/packages/ed/76/104b2aa106a208da8b17a2fb72e033a5a9d7073c68f7e508b94916ed47a9/markupsafe-3.0.3-cp313-cp313-musllinux_1_2_riscv64.whl", hash = "sha256:795e7751525cae078558e679d646ae45574b47ed6e7771863fcc079a6171a0fc", size = 21588, upload-time = "2025-09-27T18:36:48.82Z" },
+    { url = "https://files.pythonhosted.org/packages/b5/99/16a5eb2d140087ebd97180d95249b00a03aa87e29cc224056274f2e45fd6/markupsafe-3.0.3-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:8485f406a96febb5140bfeca44a73e3ce5116b2501ac54fe953e488fb1d03b12", size = 23041, upload-time = "2025-09-27T18:36:49.797Z" },
+    { url = "https://files.pythonhosted.org/packages/19/bc/e7140ed90c5d61d77cea142eed9f9c303f4c4806f60a1044c13e3f1471d0/markupsafe-3.0.3-cp313-cp313-win32.whl", hash = "sha256:bdd37121970bfd8be76c5fb069c7751683bdf373db1ed6c010162b2a130248ed", size = 14543, upload-time = "2025-09-27T18:36:51.584Z" },
+    { url = "https://files.pythonhosted.org/packages/05/73/c4abe620b841b6b791f2edc248f556900667a5a1cf023a6646967ae98335/markupsafe-3.0.3-cp313-cp313-win_amd64.whl", hash = "sha256:9a1abfdc021a164803f4d485104931fb8f8c1efd55bc6b748d2f5774e78b62c5", size = 15113, upload-time = "2025-09-27T18:36:52.537Z" },
+    { url = "https://files.pythonhosted.org/packages/f0/3a/fa34a0f7cfef23cf9500d68cb7c32dd64ffd58a12b09225fb03dd37d5b80/markupsafe-3.0.3-cp313-cp313-win_arm64.whl", hash = "sha256:7e68f88e5b8799aa49c85cd116c932a1ac15caaa3f5db09087854d218359e485", size = 13911, upload-time = "2025-09-27T18:36:53.513Z" },
+    { url = "https://files.pythonhosted.org/packages/e4/d7/e05cd7efe43a88a17a37b3ae96e79a19e846f3f456fe79c57ca61356ef01/markupsafe-3.0.3-cp313-cp313t-macosx_10_13_x86_64.whl", hash = "sha256:218551f6df4868a8d527e3062d0fb968682fe92054e89978594c28e642c43a73", size = 11658, upload-time = "2025-09-27T18:36:54.819Z" },
+    { url = "https://files.pythonhosted.org/packages/99/9e/e412117548182ce2148bdeacdda3bb494260c0b0184360fe0d56389b523b/markupsafe-3.0.3-cp313-cp313t-macosx_11_0_arm64.whl", hash = "sha256:3524b778fe5cfb3452a09d31e7b5adefeea8c5be1d43c4f810ba09f2ceb29d37", size = 12066, upload-time = "2025-09-27T18:36:55.714Z" },
+    { url = "https://files.pythonhosted.org/packages/bc/e6/fa0ffcda717ef64a5108eaa7b4f5ed28d56122c9a6d70ab8b72f9f715c80/markupsafe-3.0.3-cp313-cp313t-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:4e885a3d1efa2eadc93c894a21770e4bc67899e3543680313b09f139e149ab19", size = 25639, upload-time = "2025-09-27T18:36:56.908Z" },
+    { url = "https://files.pythonhosted.org/packages/96/ec/2102e881fe9d25fc16cb4b25d5f5cde50970967ffa5dddafdb771237062d/markupsafe-3.0.3-cp313-cp313t-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:8709b08f4a89aa7586de0aadc8da56180242ee0ada3999749b183aa23df95025", size = 23569, upload-time = "2025-09-27T18:36:57.913Z" },
+    { url = "https://files.pythonhosted.org/packages/4b/30/6f2fce1f1f205fc9323255b216ca8a235b15860c34b6798f810f05828e32/markupsafe-3.0.3-cp313-cp313t-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:b8512a91625c9b3da6f127803b166b629725e68af71f8184ae7e7d54686a56d6", size = 23284, upload-time = "2025-09-27T18:36:58.833Z" },
+    { url = "https://files.pythonhosted.org/packages/58/47/4a0ccea4ab9f5dcb6f79c0236d954acb382202721e704223a8aafa38b5c8/markupsafe-3.0.3-cp313-cp313t-musllinux_1_2_aarch64.whl", hash = "sha256:9b79b7a16f7fedff2495d684f2b59b0457c3b493778c9eed31111be64d58279f", size = 24801, upload-time = "2025-09-27T18:36:59.739Z" },
+    { url = "https://files.pythonhosted.org/packages/6a/70/3780e9b72180b6fecb83a4814d84c3bf4b4ae4bf0b19c27196104149734c/markupsafe-3.0.3-cp313-cp313t-musllinux_1_2_riscv64.whl", hash = "sha256:12c63dfb4a98206f045aa9563db46507995f7ef6d83b2f68eda65c307c6829eb", size = 22769, upload-time = "2025-09-27T18:37:00.719Z" },
+    { url = "https://files.pythonhosted.org/packages/98/c5/c03c7f4125180fc215220c035beac6b9cb684bc7a067c84fc69414d315f5/markupsafe-3.0.3-cp313-cp313t-musllinux_1_2_x86_64.whl", hash = "sha256:8f71bc33915be5186016f675cd83a1e08523649b0e33efdb898db577ef5bb009", size = 23642, upload-time = "2025-09-27T18:37:01.673Z" },
+    { url = "https://files.pythonhosted.org/packages/80/d6/2d1b89f6ca4bff1036499b1e29a1d02d282259f3681540e16563f27ebc23/markupsafe-3.0.3-cp313-cp313t-win32.whl", hash = "sha256:69c0b73548bc525c8cb9a251cddf1931d1db4d2258e9599c28c07ef3580ef354", size = 14612, upload-time = "2025-09-27T18:37:02.639Z" },
+    { url = "https://files.pythonhosted.org/packages/2b/98/e48a4bfba0a0ffcf9925fe2d69240bfaa19c6f7507b8cd09c70684a53c1e/markupsafe-3.0.3-cp313-cp313t-win_amd64.whl", hash = "sha256:1b4b79e8ebf6b55351f0d91fe80f893b4743f104bff22e90697db1590e47a218", size = 15200, upload-time = "2025-09-27T18:37:03.582Z" },
+    { url = "https://files.pythonhosted.org/packages/0e/72/e3cc540f351f316e9ed0f092757459afbc595824ca724cbc5a5d4263713f/markupsafe-3.0.3-cp313-cp313t-win_arm64.whl", hash = "sha256:ad2cf8aa28b8c020ab2fc8287b0f823d0a7d8630784c31e9ee5edea20f406287", size = 13973, upload-time = "2025-09-27T18:37:04.929Z" },
+    { url = "https://files.pythonhosted.org/packages/33/8a/8e42d4838cd89b7dde187011e97fe6c3af66d8c044997d2183fbd6d31352/markupsafe-3.0.3-cp314-cp314-macosx_10_13_x86_64.whl", hash = "sha256:eaa9599de571d72e2daf60164784109f19978b327a3910d3e9de8c97b5b70cfe", size = 11619, upload-time = "2025-09-27T18:37:06.342Z" },
+    { url = "https://files.pythonhosted.org/packages/b5/64/7660f8a4a8e53c924d0fa05dc3a55c9cee10bbd82b11c5afb27d44b096ce/markupsafe-3.0.3-cp314-cp314-macosx_11_0_arm64.whl", hash = "sha256:c47a551199eb8eb2121d4f0f15ae0f923d31350ab9280078d1e5f12b249e0026", size = 12029, upload-time = "2025-09-27T18:37:07.213Z" },
+    { url = "https://files.pythonhosted.org/packages/da/ef/e648bfd021127bef5fa12e1720ffed0c6cbb8310c8d9bea7266337ff06de/markupsafe-3.0.3-cp314-cp314-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:f34c41761022dd093b4b6896d4810782ffbabe30f2d443ff5f083e0cbbb8c737", size = 24408, upload-time = "2025-09-27T18:37:09.572Z" },
+    { url = "https://files.pythonhosted.org/packages/41/3c/a36c2450754618e62008bf7435ccb0f88053e07592e6028a34776213d877/markupsafe-3.0.3-cp314-cp314-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:457a69a9577064c05a97c41f4e65148652db078a3a509039e64d3467b9e7ef97", size = 23005, upload-time = "2025-09-27T18:37:10.58Z" },
+    { url = "https://files.pythonhosted.org/packages/bc/20/b7fdf89a8456b099837cd1dc21974632a02a999ec9bf7ca3e490aacd98e7/markupsafe-3.0.3-cp314-cp314-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:e8afc3f2ccfa24215f8cb28dcf43f0113ac3c37c2f0f0806d8c70e4228c5cf4d", size = 22048, upload-time = "2025-09-27T18:37:11.547Z" },
+    { url = "https://files.pythonhosted.org/packages/9a/a7/591f592afdc734f47db08a75793a55d7fbcc6902a723ae4cfbab61010cc5/markupsafe-3.0.3-cp314-cp314-musllinux_1_2_aarch64.whl", hash = "sha256:ec15a59cf5af7be74194f7ab02d0f59a62bdcf1a537677ce67a2537c9b87fcda", size = 23821, upload-time = "2025-09-27T18:37:12.48Z" },
+    { url = "https://files.pythonhosted.org/packages/7d/33/45b24e4f44195b26521bc6f1a82197118f74df348556594bd2262bda1038/markupsafe-3.0.3-cp314-cp314-musllinux_1_2_riscv64.whl", hash = "sha256:0eb9ff8191e8498cca014656ae6b8d61f39da5f95b488805da4bb029cccbfbaf", size = 21606, upload-time = "2025-09-27T18:37:13.485Z" },
+    { url = "https://files.pythonhosted.org/packages/ff/0e/53dfaca23a69fbfbbf17a4b64072090e70717344c52eaaaa9c5ddff1e5f0/markupsafe-3.0.3-cp314-cp314-musllinux_1_2_x86_64.whl", hash = "sha256:2713baf880df847f2bece4230d4d094280f4e67b1e813eec43b4c0e144a34ffe", size = 23043, upload-time = "2025-09-27T18:37:14.408Z" },
+    { url = "https://files.pythonhosted.org/packages/46/11/f333a06fc16236d5238bfe74daccbca41459dcd8d1fa952e8fbd5dccfb70/markupsafe-3.0.3-cp314-cp314-win32.whl", hash = "sha256:729586769a26dbceff69f7a7dbbf59ab6572b99d94576a5592625d5b411576b9", size = 14747, upload-time = "2025-09-27T18:37:15.36Z" },
+    { url = "https://files.pythonhosted.org/packages/28/52/182836104b33b444e400b14f797212f720cbc9ed6ba34c800639d154e821/markupsafe-3.0.3-cp314-cp314-win_amd64.whl", hash = "sha256:bdc919ead48f234740ad807933cdf545180bfbe9342c2bb451556db2ed958581", size = 15341, upload-time = "2025-09-27T18:37:16.496Z" },
+    { url = "https://files.pythonhosted.org/packages/6f/18/acf23e91bd94fd7b3031558b1f013adfa21a8e407a3fdb32745538730382/markupsafe-3.0.3-cp314-cp314-win_arm64.whl", hash = "sha256:5a7d5dc5140555cf21a6fefbdbf8723f06fcd2f63ef108f2854de715e4422cb4", size = 14073, upload-time = "2025-09-27T18:37:17.476Z" },
+    { url = "https://files.pythonhosted.org/packages/3c/f0/57689aa4076e1b43b15fdfa646b04653969d50cf30c32a102762be2485da/markupsafe-3.0.3-cp314-cp314t-macosx_10_13_x86_64.whl", hash = "sha256:1353ef0c1b138e1907ae78e2f6c63ff67501122006b0f9abad68fda5f4ffc6ab", size = 11661, upload-time = "2025-09-27T18:37:18.453Z" },
+    { url = "https://files.pythonhosted.org/packages/89/c3/2e67a7ca217c6912985ec766c6393b636fb0c2344443ff9d91404dc4c79f/markupsafe-3.0.3-cp314-cp314t-macosx_11_0_arm64.whl", hash = "sha256:1085e7fbddd3be5f89cc898938f42c0b3c711fdcb37d75221de2666af647c175", size = 12069, upload-time = "2025-09-27T18:37:19.332Z" },
+    { url = "https://files.pythonhosted.org/packages/f0/00/be561dce4e6ca66b15276e184ce4b8aec61fe83662cce2f7d72bd3249d28/markupsafe-3.0.3-cp314-cp314t-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:1b52b4fb9df4eb9ae465f8d0c228a00624de2334f216f178a995ccdcf82c4634", size = 25670, upload-time = "2025-09-27T18:37:20.245Z" },
+    { url = "https://files.pythonhosted.org/packages/50/09/c419f6f5a92e5fadde27efd190eca90f05e1261b10dbd8cbcb39cd8ea1dc/markupsafe-3.0.3-cp314-cp314t-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:fed51ac40f757d41b7c48425901843666a6677e3e8eb0abcff09e4ba6e664f50", size = 23598, upload-time = "2025-09-27T18:37:21.177Z" },
+    { url = "https://files.pythonhosted.org/packages/22/44/a0681611106e0b2921b3033fc19bc53323e0b50bc70cffdd19f7d679bb66/markupsafe-3.0.3-cp314-cp314t-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:f190daf01f13c72eac4efd5c430a8de82489d9cff23c364c3ea822545032993e", size = 23261, upload-time = "2025-09-27T18:37:22.167Z" },
+    { url = "https://files.pythonhosted.org/packages/5f/57/1b0b3f100259dc9fffe780cfb60d4be71375510e435efec3d116b6436d43/markupsafe-3.0.3-cp314-cp314t-musllinux_1_2_aarch64.whl", hash = "sha256:e56b7d45a839a697b5eb268c82a71bd8c7f6c94d6fd50c3d577fa39a9f1409f5", size = 24835, upload-time = "2025-09-27T18:37:23.296Z" },
+    { url = "https://files.pythonhosted.org/packages/26/6a/4bf6d0c97c4920f1597cc14dd720705eca0bf7c787aebc6bb4d1bead5388/markupsafe-3.0.3-cp314-cp314t-musllinux_1_2_riscv64.whl", hash = "sha256:f3e98bb3798ead92273dc0e5fd0f31ade220f59a266ffd8a4f6065e0a3ce0523", size = 22733, upload-time = "2025-09-27T18:37:24.237Z" },
+    { url = "https://files.pythonhosted.org/packages/14/c7/ca723101509b518797fedc2fdf79ba57f886b4aca8a7d31857ba3ee8281f/markupsafe-3.0.3-cp314-cp314t-musllinux_1_2_x86_64.whl", hash = "sha256:5678211cb9333a6468fb8d8be0305520aa073f50d17f089b5b4b477ea6e67fdc", size = 23672, upload-time = "2025-09-27T18:37:25.271Z" },
+    { url = "https://files.pythonhosted.org/packages/fb/df/5bd7a48c256faecd1d36edc13133e51397e41b73bb77e1a69deab746ebac/markupsafe-3.0.3-cp314-cp314t-win32.whl", hash = "sha256:915c04ba3851909ce68ccc2b8e2cd691618c4dc4c4232fb7982bca3f41fd8c3d", size = 14819, upload-time = "2025-09-27T18:37:26.285Z" },
+    { url = "https://files.pythonhosted.org/packages/1a/8a/0402ba61a2f16038b48b39bccca271134be00c5c9f0f623208399333c448/markupsafe-3.0.3-cp314-cp314t-win_amd64.whl", hash = "sha256:4faffd047e07c38848ce017e8725090413cd80cbc23d86e55c587bf979e579c9", size = 15426, upload-time = "2025-09-27T18:37:27.316Z" },
+    { url = "https://files.pythonhosted.org/packages/70/bc/6f1c2f612465f5fa89b95bead1f44dcb607670fd42891d8fdcd5d039f4f4/markupsafe-3.0.3-cp314-cp314t-win_arm64.whl", hash = "sha256:32001d6a8fc98c8cb5c947787c5d08b0a50663d139f1305bac5885d98d9b40fa", size = 14146, upload-time = "2025-09-27T18:37:28.327Z" },
+    { url = "https://files.pythonhosted.org/packages/56/23/0d8c13a44bde9154821586520840643467aee574d8ce79a17da539ee7fed/markupsafe-3.0.3-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:15d939a21d546304880945ca1ecb8a039db6b4dc49b2c5a400387cdae6a62e26", size = 11623, upload-time = "2025-09-27T18:37:29.296Z" },
+    { url = "https://files.pythonhosted.org/packages/fd/23/07a2cb9a8045d5f3f0890a8c3bc0859d7a47bfd9a560b563899bec7b72ed/markupsafe-3.0.3-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:f71a396b3bf33ecaa1626c255855702aca4d3d9fea5e051b41ac59a9c1c41edc", size = 12049, upload-time = "2025-09-27T18:37:30.234Z" },
+    { url = "https://files.pythonhosted.org/packages/bc/e4/6be85eb81503f8e11b61c0b6369b6e077dcf0a74adbd9ebf6b349937b4e9/markupsafe-3.0.3-cp39-cp39-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:0f4b68347f8c5eab4a13419215bdfd7f8c9b19f2b25520968adfad23eb0ce60c", size = 21923, upload-time = "2025-09-27T18:37:31.177Z" },
+    { url = "https://files.pythonhosted.org/packages/6f/bc/4dc914ead3fe6ddaef035341fee0fc956949bbd27335b611829292b89ee2/markupsafe-3.0.3-cp39-cp39-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:e8fc20152abba6b83724d7ff268c249fa196d8259ff481f3b1476383f8f24e42", size = 20543, upload-time = "2025-09-27T18:37:32.168Z" },
+    { url = "https://files.pythonhosted.org/packages/89/6e/5fe81fbcfba4aef4093d5f856e5c774ec2057946052d18d168219b7bd9f9/markupsafe-3.0.3-cp39-cp39-manylinux_2_31_riscv64.manylinux_2_39_riscv64.whl", hash = "sha256:949b8d66bc381ee8b007cd945914c721d9aba8e27f71959d750a46f7c282b20b", size = 20585, upload-time = "2025-09-27T18:37:33.166Z" },
+    { url = "https://files.pythonhosted.org/packages/f6/f6/e0e5a3d3ae9c4020f696cd055f940ef86b64fe88de26f3a0308b9d3d048c/markupsafe-3.0.3-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:3537e01efc9d4dccdf77221fb1cb3b8e1a38d5428920e0657ce299b20324d758", size = 21387, upload-time = "2025-09-27T18:37:34.185Z" },
+    { url = "https://files.pythonhosted.org/packages/c8/25/651753ef4dea08ea790f4fbb65146a9a44a014986996ca40102e237aa49a/markupsafe-3.0.3-cp39-cp39-musllinux_1_2_riscv64.whl", hash = "sha256:591ae9f2a647529ca990bc681daebdd52c8791ff06c2bfa05b65163e28102ef2", size = 20133, upload-time = "2025-09-27T18:37:35.138Z" },
+    { url = "https://files.pythonhosted.org/packages/dc/0a/c3cf2b4fef5f0426e8a6d7fce3cb966a17817c568ce59d76b92a233fdbec/markupsafe-3.0.3-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:a320721ab5a1aba0a233739394eb907f8c8da5c98c9181d1161e77a0c8e36f2d", size = 20588, upload-time = "2025-09-27T18:37:36.096Z" },
+    { url = "https://files.pythonhosted.org/packages/cd/1b/a7782984844bd519ad4ffdbebbba2671ec5d0ebbeac34736c15fb86399e8/markupsafe-3.0.3-cp39-cp39-win32.whl", hash = "sha256:df2449253ef108a379b8b5d6b43f4b1a8e81a061d6537becd5582fba5f9196d7", size = 14566, upload-time = "2025-09-27T18:37:37.09Z" },
+    { url = "https://files.pythonhosted.org/packages/18/1f/8d9c20e1c9440e215a44be5ab64359e207fcb4f675543f1cf9a2a7f648d0/markupsafe-3.0.3-cp39-cp39-win_amd64.whl", hash = "sha256:7c3fb7d25180895632e5d3148dbdc29ea38ccb7fd210aa27acbd1201a1902c6e", size = 15053, upload-time = "2025-09-27T18:37:38.054Z" },
+    { url = "https://files.pythonhosted.org/packages/4e/d3/fe08482b5cd995033556d45041a4f4e76e7f0521112a9c9991d40d39825f/markupsafe-3.0.3-cp39-cp39-win_arm64.whl", hash = "sha256:38664109c14ffc9e7437e86b4dceb442b0096dfe3541d7864d9cbe1da4cf36c8", size = 13928, upload-time = "2025-09-27T18:37:39.037Z" },
+]
+
+[[package]]
+name = "matplotlib"
+version = "3.7.5"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "contourpy", version = "1.1.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "cycler", marker = "python_full_version < '3.9'" },
+    { name = "fonttools", version = "4.57.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "importlib-resources", version = "6.4.5", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "kiwisolver", version = "1.4.7", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "numpy", version = "1.24.4", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "packaging", marker = "python_full_version < '3.9'" },
+    { name = "pillow", version = "10.4.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "pyparsing", version = "3.1.4", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "python-dateutil", marker = "python_full_version < '3.9'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/b6/f0/3836719cc3982fbba3b840d18a59db1d0ee9ac7986f24e8c0a092851b67b/matplotlib-3.7.5.tar.gz", hash = "sha256:1e5c971558ebc811aa07f54c7b7c677d78aa518ef4c390e14673a09e0860184a", size = 38098611, upload-time = "2024-02-16T10:50:56.19Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/f5/b0/3808e86c41e5d97822d77e89d7f3cb0890725845c050d87ec53732a8b150/matplotlib-3.7.5-cp310-cp310-macosx_10_12_universal2.whl", hash = "sha256:4a87b69cb1cb20943010f63feb0b2901c17a3b435f75349fd9865713bfa63925", size = 8322924, upload-time = "2024-02-16T10:48:06.184Z" },
+    { url = "https://files.pythonhosted.org/packages/5b/05/726623be56391ba1740331ad9f1cd30e1adec61c179ddac134957a6dc2e7/matplotlib-3.7.5-cp310-cp310-macosx_10_12_x86_64.whl", hash = "sha256:d3ce45010fefb028359accebb852ca0c21bd77ec0f281952831d235228f15810", size = 7438436, upload-time = "2024-02-16T10:48:10.294Z" },
+    { url = "https://files.pythonhosted.org/packages/15/83/89cdef49ef1e320060ec951ba33c132df211561d866c3ed144c81fd110b2/matplotlib-3.7.5-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:fbea1e762b28400393d71be1a02144aa16692a3c4c676ba0178ce83fc2928fdd", size = 7341849, upload-time = "2024-02-16T10:48:13.249Z" },
+    { url = "https://files.pythonhosted.org/packages/94/29/39fc4acdc296dd86e09cecb65c14966e1cf18e0f091b9cbd9bd3f0c19ee4/matplotlib-3.7.5-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:ec0e1adc0ad70ba8227e957551e25a9d2995e319c29f94a97575bb90fa1d4469", size = 11354141, upload-time = "2024-02-16T10:48:16.963Z" },
+    { url = "https://files.pythonhosted.org/packages/54/36/44c5eeb0d83ae1e3ed34d264d7adee947c4fd56c4a9464ce822de094995a/matplotlib-3.7.5-cp310-cp310-manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:6738c89a635ced486c8a20e20111d33f6398a9cbebce1ced59c211e12cd61455", size = 11457668, upload-time = "2024-02-16T10:48:21.339Z" },
+    { url = "https://files.pythonhosted.org/packages/b7/e2/f68aeaedf0ef57cbb793637ee82e62e64ea26cee908db0fe4f8e24d502c0/matplotlib-3.7.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:1210b7919b4ed94b5573870f316bca26de3e3b07ffdb563e79327dc0e6bba515", size = 11580088, upload-time = "2024-02-16T10:48:25.415Z" },
+    { url = "https://files.pythonhosted.org/packages/d9/f7/7c88d34afc38943aa5e4e04d27fc9da5289a48c264c0d794f60c9cda0949/matplotlib-3.7.5-cp310-cp310-win32.whl", hash = "sha256:068ebcc59c072781d9dcdb82f0d3f1458271c2de7ca9c78f5bd672141091e9e1", size = 7339332, upload-time = "2024-02-16T10:48:29.319Z" },
+    { url = "https://files.pythonhosted.org/packages/91/99/e5f6f7c9438279581c4a2308d264fe24dc98bb80e3b2719f797227e54ddc/matplotlib-3.7.5-cp310-cp310-win_amd64.whl", hash = "sha256:f098ffbaab9df1e3ef04e5a5586a1e6b1791380698e84938d8640961c79b1fc0", size = 7506405, upload-time = "2024-02-16T10:48:32.499Z" },
+    { url = "https://files.pythonhosted.org/packages/5e/c6/45d0485e59d70b7a6a81eade5d0aed548b42cc65658c0ce0f813b9249165/matplotlib-3.7.5-cp311-cp311-macosx_10_12_universal2.whl", hash = "sha256:f65342c147572673f02a4abec2d5a23ad9c3898167df9b47c149f32ce61ca078", size = 8325506, upload-time = "2024-02-16T10:48:36.192Z" },
+    { url = "https://files.pythonhosted.org/packages/0e/0a/83bd8589f3597745f624fbcc7da1140088b2f4160ca51c71553c561d0df5/matplotlib-3.7.5-cp311-cp311-macosx_10_12_x86_64.whl", hash = "sha256:4ddf7fc0e0dc553891a117aa083039088d8a07686d4c93fb8a810adca68810af", size = 7439905, upload-time = "2024-02-16T10:48:38.951Z" },
+    { url = "https://files.pythonhosted.org/packages/84/c1/a7705b24f8f9b4d7ceea0002c13bae50cf9423f299f56d8c47a5cd2627d2/matplotlib-3.7.5-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:0ccb830fc29442360d91be48527809f23a5dcaee8da5f4d9b2d5b867c1b087b8", size = 7342895, upload-time = "2024-02-16T10:48:41.61Z" },
+    { url = "https://files.pythonhosted.org/packages/94/6e/55d7d8310c96a7459c883aa4be3f5a9338a108278484cbd5c95d480d1cef/matplotlib-3.7.5-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:efc6bb28178e844d1f408dd4d6341ee8a2e906fc9e0fa3dae497da4e0cab775d", size = 11358830, upload-time = "2024-02-16T10:48:44.984Z" },
+    { url = "https://files.pythonhosted.org/packages/55/57/3b36afe104216db1cf2f3889c394b403ea87eda77c4815227c9524462ba8/matplotlib-3.7.5-cp311-cp311-manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:3b15c4c2d374f249f324f46e883340d494c01768dd5287f8bc00b65b625ab56c", size = 11462575, upload-time = "2024-02-16T10:48:48.437Z" },
+    { url = "https://files.pythonhosted.org/packages/f3/0b/fabcf5f66b12fab5c4110d06a6c0fed875c7e63bc446403f58f9dadc9999/matplotlib-3.7.5-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:3d028555421912307845e59e3de328260b26d055c5dac9b182cc9783854e98fb", size = 11584280, upload-time = "2024-02-16T10:48:53.022Z" },
+    { url = "https://files.pythonhosted.org/packages/47/a9/1ad7df27a9da70b62109584632f83fe6ef45774701199c44d5777107c240/matplotlib-3.7.5-cp311-cp311-win32.whl", hash = "sha256:fe184b4625b4052fa88ef350b815559dd90cc6cc8e97b62f966e1ca84074aafa", size = 7340429, upload-time = "2024-02-16T10:48:56.505Z" },
+    { url = "https://files.pythonhosted.org/packages/e3/b1/1b6c34b89173d6c206dc5a4028e8518b4dfee3569c13bdc0c88d0486cae7/matplotlib-3.7.5-cp311-cp311-win_amd64.whl", hash = "sha256:084f1f0f2f1010868c6f1f50b4e1c6f2fb201c58475494f1e5b66fed66093647", size = 7507112, upload-time = "2024-02-16T10:48:59.659Z" },
+    { url = "https://files.pythonhosted.org/packages/75/dc/4e341a3ef36f3e7321aec0741317f12c7a23264be708a97972bf018c34af/matplotlib-3.7.5-cp312-cp312-macosx_10_12_universal2.whl", hash = "sha256:34bceb9d8ddb142055ff27cd7135f539f2f01be2ce0bafbace4117abe58f8fe4", size = 8323797, upload-time = "2024-02-16T10:49:02.872Z" },
+    { url = "https://files.pythonhosted.org/packages/af/83/bbb482d678362ceb68cc59ec4fc705dde636025969361dac77be868541ef/matplotlib-3.7.5-cp312-cp312-macosx_10_12_x86_64.whl", hash = "sha256:c5a2134162273eb8cdfd320ae907bf84d171de948e62180fa372a3ca7cf0f433", size = 7439549, upload-time = "2024-02-16T10:49:05.743Z" },
+    { url = "https://files.pythonhosted.org/packages/1a/ee/e49a92d9e369b2b9e4373894171cb4e641771cd7f81bde1d8b6fb8c60842/matplotlib-3.7.5-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:039ad54683a814002ff37bf7981aa1faa40b91f4ff84149beb53d1eb64617980", size = 7341788, upload-time = "2024-02-16T10:49:09.143Z" },
+    { url = "https://files.pythonhosted.org/packages/48/79/89cb2fc5ddcfc3d440a739df04dbe6e4e72b1153d1ebd32b45d42eb71d27/matplotlib-3.7.5-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:4d742ccd1b09e863b4ca58291728db645b51dab343eebb08d5d4b31b308296ce", size = 11356329, upload-time = "2024-02-16T10:49:12.156Z" },
+    { url = "https://files.pythonhosted.org/packages/ff/25/84f181cdae5c9eba6fd1c2c35642aec47233425fe3b0d6fccdb323fb36e0/matplotlib-3.7.5-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:743b1c488ca6a2bc7f56079d282e44d236bf375968bfd1b7ba701fd4d0fa32d6", size = 11577813, upload-time = "2024-02-16T10:49:15.986Z" },
+    { url = "https://files.pythonhosted.org/packages/9f/24/b2db065d40e58033b3350222fb8bbb0ffcb834029df9c1f9349dd9c7dd45/matplotlib-3.7.5-cp312-cp312-win_amd64.whl", hash = "sha256:fbf730fca3e1f23713bc1fae0a57db386e39dc81ea57dc305c67f628c1d7a342", size = 7507667, upload-time = "2024-02-16T10:49:19.6Z" },
+    { url = "https://files.pythonhosted.org/packages/e3/72/50a38c8fd5dc845b06f8e71c9da802db44b81baabf4af8be78bb8a5622ea/matplotlib-3.7.5-cp38-cp38-macosx_10_12_universal2.whl", hash = "sha256:cfff9b838531698ee40e40ea1a8a9dc2c01edb400b27d38de6ba44c1f9a8e3d2", size = 8322659, upload-time = "2024-02-16T10:49:23.206Z" },
+    { url = "https://files.pythonhosted.org/packages/b1/ea/129163dcd21db6da5d559a8160c4a74c1dc5f96ac246a3d4248b43c7648d/matplotlib-3.7.5-cp38-cp38-macosx_10_12_x86_64.whl", hash = "sha256:1dbcca4508bca7847fe2d64a05b237a3dcaec1f959aedb756d5b1c67b770c5ee", size = 7438408, upload-time = "2024-02-16T10:49:27.462Z" },
+    { url = "https://files.pythonhosted.org/packages/aa/59/4d13e5b6298b1ca5525eea8c68d3806ae93ab6d0bb17ca9846aa3156b92b/matplotlib-3.7.5-cp38-cp38-macosx_11_0_arm64.whl", hash = "sha256:4cdf4ef46c2a1609a50411b66940b31778db1e4b73d4ecc2eaa40bd588979b13", size = 7341782, upload-time = "2024-02-16T10:49:32.173Z" },
+    { url = "https://files.pythonhosted.org/packages/9e/c4/f562df04b08487731743511ff274ae5d31dce2ff3e5621f8b070d20ab54a/matplotlib-3.7.5-cp38-cp38-manylinux_2_12_i686.manylinux2010_i686.whl", hash = "sha256:167200ccfefd1674b60e957186dfd9baf58b324562ad1a28e5d0a6b3bea77905", size = 9196487, upload-time = "2024-02-16T10:49:37.971Z" },
+    { url = "https://files.pythonhosted.org/packages/30/33/cc27211d2ffeee4fd7402dca137b6e8a83f6dcae3d4be8d0ad5068555561/matplotlib-3.7.5-cp38-cp38-manylinux_2_12_x86_64.manylinux2010_x86_64.whl", hash = "sha256:53e64522934df6e1818b25fd48cf3b645b11740d78e6ef765fbb5fa5ce080d02", size = 9213051, upload-time = "2024-02-16T10:49:43.916Z" },
+    { url = "https://files.pythonhosted.org/packages/9b/9d/8bd37c86b79312c9dbcfa379dec32303f9b38e8456e0829d7e666a0e0a05/matplotlib-3.7.5-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:d3e3bc79b2d7d615067bd010caff9243ead1fc95cf735c16e4b2583173f717eb", size = 11370807, upload-time = "2024-02-16T10:49:47.701Z" },
+    { url = "https://files.pythonhosted.org/packages/c0/1e/b24a07a849c8d458f1b3724f49029f0dedf748bdedb4d5f69491314838b6/matplotlib-3.7.5-cp38-cp38-win32.whl", hash = "sha256:6b641b48c6819726ed47c55835cdd330e53747d4efff574109fd79b2d8a13748", size = 7340461, upload-time = "2024-02-16T10:49:51.597Z" },
+    { url = "https://files.pythonhosted.org/packages/16/51/58b0b9de42fe1e665736d9286f88b5f1556a0e22bed8a71f468231761083/matplotlib-3.7.5-cp38-cp38-win_amd64.whl", hash = "sha256:f0b60993ed3488b4532ec6b697059897891927cbfc2b8d458a891b60ec03d9d7", size = 7507471, upload-time = "2024-02-16T10:49:54.353Z" },
+    { url = "https://files.pythonhosted.org/packages/0d/00/17487e9e8949ca623af87f6c8767408efe7530b7e1f4d6897fa7fa940834/matplotlib-3.7.5-cp39-cp39-macosx_10_12_universal2.whl", hash = "sha256:090964d0afaff9c90e4d8de7836757e72ecfb252fb02884016d809239f715651", size = 8323175, upload-time = "2024-02-16T10:49:57.743Z" },
+    { url = "https://files.pythonhosted.org/packages/6a/84/be0acd521fa9d6697657cf35878153f8009a42b4b75237aebc302559a8a9/matplotlib-3.7.5-cp39-cp39-macosx_10_12_x86_64.whl", hash = "sha256:9fc6fcfbc55cd719bc0bfa60bde248eb68cf43876d4c22864603bdd23962ba25", size = 7438737, upload-time = "2024-02-16T10:50:00.683Z" },
+    { url = "https://files.pythonhosted.org/packages/17/39/175f36a6d68d0cf47a4fecbae9728048355df23c9feca8688f1476b198e6/matplotlib-3.7.5-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:5e7cc3078b019bb863752b8b60e8b269423000f1603cb2299608231996bd9d54", size = 7341916, upload-time = "2024-02-16T10:50:05.04Z" },
+    { url = "https://files.pythonhosted.org/packages/36/c0/9a1c2a79f85c15d41b60877cbc333694ed80605e5c97a33880c4ecfd5bf1/matplotlib-3.7.5-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:1e4e9a868e8163abaaa8259842d85f949a919e1ead17644fb77a60427c90473c", size = 11352264, upload-time = "2024-02-16T10:50:08.955Z" },
+    { url = "https://files.pythonhosted.org/packages/a6/39/b0204e0e7a899b0676733366a55ccafa723799b719bc7f2e85e5ecde26a0/matplotlib-3.7.5-cp39-cp39-manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:fa7ebc995a7d747dacf0a717d0eb3aa0f0c6a0e9ea88b0194d3a3cd241a1500f", size = 11454722, upload-time = "2024-02-16T10:50:13.231Z" },
+    { url = "https://files.pythonhosted.org/packages/d8/39/64dd1d36c79e72e614977db338d180cf204cf658927c05a8ef2d47feb4c0/matplotlib-3.7.5-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:3785bfd83b05fc0e0c2ae4c4a90034fe693ef96c679634756c50fe6efcc09856", size = 11576343, upload-time = "2024-02-16T10:50:17.626Z" },
+    { url = "https://files.pythonhosted.org/packages/31/b4/e77bc11394d858bdf15e356980fceb4ac9604b0fa8212ef3ca4f1dc166b8/matplotlib-3.7.5-cp39-cp39-win32.whl", hash = "sha256:29b058738c104d0ca8806395f1c9089dfe4d4f0f78ea765c6c704469f3fffc81", size = 7340455, upload-time = "2024-02-16T10:50:21.448Z" },
+    { url = "https://files.pythonhosted.org/packages/4a/84/081820c596b9555ecffc6819ee71f847f2fbb0d7c70a42c1eeaa54edf3e0/matplotlib-3.7.5-cp39-cp39-win_amd64.whl", hash = "sha256:fd4028d570fa4b31b7b165d4a685942ae9cdc669f33741e388c01857d9723eab", size = 7507711, upload-time = "2024-02-16T10:50:24.387Z" },
+    { url = "https://files.pythonhosted.org/packages/27/6c/1bb10f3d6f337b9faa2e96a251bd87ba5fed85a608df95eb4d69acc109f0/matplotlib-3.7.5-pp38-pypy38_pp73-macosx_10_12_x86_64.whl", hash = "sha256:2a9a3f4d6a7f88a62a6a18c7e6a84aedcaf4faf0708b4ca46d87b19f1b526f88", size = 7397285, upload-time = "2024-02-16T10:50:27.375Z" },
+    { url = "https://files.pythonhosted.org/packages/b2/36/66cfea213e9ba91cda9e257542c249ed235d49021af71c2e8007107d7d4c/matplotlib-3.7.5-pp38-pypy38_pp73-manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:b9b3fd853d4a7f008a938df909b96db0b454225f935d3917520305b90680579c", size = 7552612, upload-time = "2024-02-16T10:50:30.65Z" },
+    { url = "https://files.pythonhosted.org/packages/77/df/16655199bf984c37c6a816b854bc032b56aef521aadc04f27928422f3c91/matplotlib-3.7.5-pp38-pypy38_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:f0ad550da9f160737d7890217c5eeed4337d07e83ca1b2ca6535078f354e7675", size = 7515564, upload-time = "2024-02-16T10:50:33.589Z" },
+    { url = "https://files.pythonhosted.org/packages/5b/c8/3534c3705a677b71abb6be33609ba129fdeae2ea4e76b2fd3ab62c86fab3/matplotlib-3.7.5-pp38-pypy38_pp73-win_amd64.whl", hash = "sha256:20da7924a08306a861b3f2d1da0d1aa9a6678e480cf8eacffe18b565af2813e7", size = 7521336, upload-time = "2024-02-16T10:50:36.4Z" },
+    { url = "https://files.pythonhosted.org/packages/20/a0/c5c0d410798b387ed3a177a5a7eba21055dd9c41d4b15bd0861241a5a60e/matplotlib-3.7.5-pp39-pypy39_pp73-macosx_10_12_x86_64.whl", hash = "sha256:b45c9798ea6bb920cb77eb7306409756a7fab9db9b463e462618e0559aecb30e", size = 7397931, upload-time = "2024-02-16T10:50:39.477Z" },
+    { url = "https://files.pythonhosted.org/packages/c3/2f/9e9509727d4c7d1b8e2c88e9330a97d54a1dd20bd316a0c8d2f8b38c4513/matplotlib-3.7.5-pp39-pypy39_pp73-manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:a99866267da1e561c7776fe12bf4442174b79aac1a47bd7e627c7e4d077ebd83", size = 7553224, upload-time = "2024-02-16T10:50:42.82Z" },
+    { url = "https://files.pythonhosted.org/packages/89/0c/5f3e403dcf5c23799c92b0139dd00e41caf23983e9281f5bfeba3065e7d2/matplotlib-3.7.5-pp39-pypy39_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:2b6aa62adb6c268fc87d80f963aca39c64615c31830b02697743c95590ce3fbb", size = 7513250, upload-time = "2024-02-16T10:50:46.504Z" },
+    { url = "https://files.pythonhosted.org/packages/87/e0/03eba0a8c3775ef910dbb3a287114a64c47abbcaeab2543c59957f155a86/matplotlib-3.7.5-pp39-pypy39_pp73-win_amd64.whl", hash = "sha256:e530ab6a0afd082d2e9c17eb1eb064a63c5b09bb607b2b74fa41adbe3e162286", size = 7521729, upload-time = "2024-02-16T10:50:50.063Z" },
+]
+
+[[package]]
+name = "matplotlib"
+version = "3.9.4"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "contourpy", version = "1.3.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "cycler", marker = "python_full_version == '3.9.*'" },
+    { name = "fonttools", version = "4.60.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "importlib-resources", version = "6.5.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "kiwisolver", version = "1.4.7", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "numpy", version = "2.0.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "packaging", marker = "python_full_version == '3.9.*'" },
+    { name = "pillow", version = "11.3.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "pyparsing", version = "3.2.5", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "python-dateutil", marker = "python_full_version == '3.9.*'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/df/17/1747b4154034befd0ed33b52538f5eb7752d05bb51c5e2a31470c3bc7d52/matplotlib-3.9.4.tar.gz", hash = "sha256:1e00e8be7393cbdc6fedfa8a6fba02cf3e83814b285db1c60b906a023ba41bc3", size = 36106529, upload-time = "2024-12-13T05:56:34.184Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/7e/94/27d2e2c30d54b56c7b764acc1874a909e34d1965a427fc7092bb6a588b63/matplotlib-3.9.4-cp310-cp310-macosx_10_12_x86_64.whl", hash = "sha256:c5fdd7abfb706dfa8d307af64a87f1a862879ec3cd8d0ec8637458f0885b9c50", size = 7885089, upload-time = "2024-12-13T05:54:24.224Z" },
+    { url = "https://files.pythonhosted.org/packages/c6/25/828273307e40a68eb8e9df832b6b2aaad075864fdc1de4b1b81e40b09e48/matplotlib-3.9.4-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:d89bc4e85e40a71d1477780366c27fb7c6494d293e1617788986f74e2a03d7ff", size = 7770600, upload-time = "2024-12-13T05:54:27.214Z" },
+    { url = "https://files.pythonhosted.org/packages/f2/65/f841a422ec994da5123368d76b126acf4fc02ea7459b6e37c4891b555b83/matplotlib-3.9.4-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:ddf9f3c26aae695c5daafbf6b94e4c1a30d6cd617ba594bbbded3b33a1fcfa26", size = 8200138, upload-time = "2024-12-13T05:54:29.497Z" },
+    { url = "https://files.pythonhosted.org/packages/07/06/272aca07a38804d93b6050813de41ca7ab0e29ba7a9dd098e12037c919a9/matplotlib-3.9.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:18ebcf248030173b59a868fda1fe42397253f6698995b55e81e1f57431d85e50", size = 8312711, upload-time = "2024-12-13T05:54:34.396Z" },
+    { url = "https://files.pythonhosted.org/packages/98/37/f13e23b233c526b7e27ad61be0a771894a079e0f7494a10d8d81557e0e9a/matplotlib-3.9.4-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:974896ec43c672ec23f3f8c648981e8bc880ee163146e0312a9b8def2fac66f5", size = 9090622, upload-time = "2024-12-13T05:54:36.808Z" },
+    { url = "https://files.pythonhosted.org/packages/4f/8c/b1f5bd2bd70e60f93b1b54c4d5ba7a992312021d0ddddf572f9a1a6d9348/matplotlib-3.9.4-cp310-cp310-win_amd64.whl", hash = "sha256:4598c394ae9711cec135639374e70871fa36b56afae17bdf032a345be552a88d", size = 7828211, upload-time = "2024-12-13T05:54:40.596Z" },
+    { url = "https://files.pythonhosted.org/packages/74/4b/65be7959a8fa118a3929b49a842de5b78bb55475236fcf64f3e308ff74a0/matplotlib-3.9.4-cp311-cp311-macosx_10_12_x86_64.whl", hash = "sha256:d4dd29641d9fb8bc4492420c5480398dd40a09afd73aebe4eb9d0071a05fbe0c", size = 7894430, upload-time = "2024-12-13T05:54:44.049Z" },
+    { url = "https://files.pythonhosted.org/packages/e9/18/80f70d91896e0a517b4a051c3fd540daa131630fd75e02e250365353b253/matplotlib-3.9.4-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:30e5b22e8bcfb95442bf7d48b0d7f3bdf4a450cbf68986ea45fca3d11ae9d099", size = 7780045, upload-time = "2024-12-13T05:54:46.414Z" },
+    { url = "https://files.pythonhosted.org/packages/a2/73/ccb381026e3238c5c25c3609ba4157b2d1a617ec98d65a8b4ee4e1e74d02/matplotlib-3.9.4-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:2bb0030d1d447fd56dcc23b4c64a26e44e898f0416276cac1ebc25522e0ac249", size = 8209906, upload-time = "2024-12-13T05:54:49.459Z" },
+    { url = "https://files.pythonhosted.org/packages/ab/33/1648da77b74741c89f5ea95cbf42a291b4b364f2660b316318811404ed97/matplotlib-3.9.4-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:aca90ed222ac3565d2752b83dbb27627480d27662671e4d39da72e97f657a423", size = 8322873, upload-time = "2024-12-13T05:54:53.066Z" },
+    { url = "https://files.pythonhosted.org/packages/57/d3/8447ba78bc6593c9044c372d1609f8ea10fb1e071e7a9e0747bea74fc16c/matplotlib-3.9.4-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:a181b2aa2906c608fcae72f977a4a2d76e385578939891b91c2550c39ecf361e", size = 9099566, upload-time = "2024-12-13T05:54:55.522Z" },
+    { url = "https://files.pythonhosted.org/packages/23/e1/4f0e237bf349c02ff9d1b6e7109f1a17f745263809b9714a8576dc17752b/matplotlib-3.9.4-cp311-cp311-win_amd64.whl", hash = "sha256:1f6882828231eca17f501c4dcd98a05abb3f03d157fbc0769c6911fe08b6cfd3", size = 7838065, upload-time = "2024-12-13T05:54:58.337Z" },
+    { url = "https://files.pythonhosted.org/packages/1a/2b/c918bf6c19d6445d1cefe3d2e42cb740fb997e14ab19d4daeb6a7ab8a157/matplotlib-3.9.4-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:dfc48d67e6661378a21c2983200a654b72b5c5cdbd5d2cf6e5e1ece860f0cc70", size = 7891131, upload-time = "2024-12-13T05:55:02.837Z" },
+    { url = "https://files.pythonhosted.org/packages/c1/e5/b4e8fc601ca302afeeabf45f30e706a445c7979a180e3a978b78b2b681a4/matplotlib-3.9.4-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:47aef0fab8332d02d68e786eba8113ffd6f862182ea2999379dec9e237b7e483", size = 7776365, upload-time = "2024-12-13T05:55:05.158Z" },
+    { url = "https://files.pythonhosted.org/packages/99/06/b991886c506506476e5d83625c5970c656a491b9f80161458fed94597808/matplotlib-3.9.4-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:fba1f52c6b7dc764097f52fd9ab627b90db452c9feb653a59945de16752e965f", size = 8200707, upload-time = "2024-12-13T05:55:09.48Z" },
+    { url = "https://files.pythonhosted.org/packages/c3/e2/556b627498cb27e61026f2d1ba86a78ad1b836fef0996bef5440e8bc9559/matplotlib-3.9.4-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:173ac3748acaac21afcc3fa1633924609ba1b87749006bc25051c52c422a5d00", size = 8313761, upload-time = "2024-12-13T05:55:12.95Z" },
+    { url = "https://files.pythonhosted.org/packages/58/ff/165af33ec766ff818306ea88e91f9f60d2a6ed543be1eb122a98acbf3b0d/matplotlib-3.9.4-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:320edea0cadc07007765e33f878b13b3738ffa9745c5f707705692df70ffe0e0", size = 9095284, upload-time = "2024-12-13T05:55:16.199Z" },
+    { url = "https://files.pythonhosted.org/packages/9f/8b/3d0c7a002db3b1ed702731c2a9a06d78d035f1f2fb0fb936a8e43cc1e9f4/matplotlib-3.9.4-cp312-cp312-win_amd64.whl", hash = "sha256:a4a4cfc82330b27042a7169533da7991e8789d180dd5b3daeaee57d75cd5a03b", size = 7841160, upload-time = "2024-12-13T05:55:19.991Z" },
+    { url = "https://files.pythonhosted.org/packages/49/b1/999f89a7556d101b23a2f0b54f1b6e140d73f56804da1398f2f0bc0924bc/matplotlib-3.9.4-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:37eeffeeca3c940985b80f5b9a7b95ea35671e0e7405001f249848d2b62351b6", size = 7891499, upload-time = "2024-12-13T05:55:22.142Z" },
+    { url = "https://files.pythonhosted.org/packages/87/7b/06a32b13a684977653396a1bfcd34d4e7539c5d55c8cbfaa8ae04d47e4a9/matplotlib-3.9.4-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:3e7465ac859ee4abcb0d836137cd8414e7bb7ad330d905abced457217d4f0f45", size = 7776802, upload-time = "2024-12-13T05:55:25.947Z" },
+    { url = "https://files.pythonhosted.org/packages/65/87/ac498451aff739e515891bbb92e566f3c7ef31891aaa878402a71f9b0910/matplotlib-3.9.4-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:f4c12302c34afa0cf061bea23b331e747e5e554b0fa595c96e01c7b75bc3b858", size = 8200802, upload-time = "2024-12-13T05:55:28.461Z" },
+    { url = "https://files.pythonhosted.org/packages/f8/6b/9eb761c00e1cb838f6c92e5f25dcda3f56a87a52f6cb8fdfa561e6cf6a13/matplotlib-3.9.4-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:2b8c97917f21b75e72108b97707ba3d48f171541a74aa2a56df7a40626bafc64", size = 8313880, upload-time = "2024-12-13T05:55:30.965Z" },
+    { url = "https://files.pythonhosted.org/packages/d7/a2/c8eaa600e2085eec7e38cbbcc58a30fc78f8224939d31d3152bdafc01fd1/matplotlib-3.9.4-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:0229803bd7e19271b03cb09f27db76c918c467aa4ce2ae168171bc67c3f508df", size = 9094637, upload-time = "2024-12-13T05:55:33.701Z" },
+    { url = "https://files.pythonhosted.org/packages/71/1f/c6e1daea55b7bfeb3d84c6cb1abc449f6a02b181e7e2a5e4db34c3afb793/matplotlib-3.9.4-cp313-cp313-win_amd64.whl", hash = "sha256:7c0d8ef442ebf56ff5e206f8083d08252ee738e04f3dc88ea882853a05488799", size = 7841311, upload-time = "2024-12-13T05:55:36.737Z" },
+    { url = "https://files.pythonhosted.org/packages/c0/3a/2757d3f7d388b14dd48f5a83bea65b6d69f000e86b8f28f74d86e0d375bd/matplotlib-3.9.4-cp313-cp313t-macosx_10_13_x86_64.whl", hash = "sha256:a04c3b00066a688834356d196136349cb32f5e1003c55ac419e91585168b88fb", size = 7919989, upload-time = "2024-12-13T05:55:39.024Z" },
+    { url = "https://files.pythonhosted.org/packages/24/28/f5077c79a4f521589a37fe1062d6a6ea3534e068213f7357e7cfffc2e17a/matplotlib-3.9.4-cp313-cp313t-macosx_11_0_arm64.whl", hash = "sha256:04c519587f6c210626741a1e9a68eefc05966ede24205db8982841826af5871a", size = 7809417, upload-time = "2024-12-13T05:55:42.412Z" },
+    { url = "https://files.pythonhosted.org/packages/36/c8/c523fd2963156692916a8eb7d4069084cf729359f7955cf09075deddfeaf/matplotlib-3.9.4-cp313-cp313t-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:308afbf1a228b8b525fcd5cec17f246bbbb63b175a3ef6eb7b4d33287ca0cf0c", size = 8226258, upload-time = "2024-12-13T05:55:47.259Z" },
+    { url = "https://files.pythonhosted.org/packages/f6/88/499bf4b8fa9349b6f5c0cf4cead0ebe5da9d67769129f1b5651e5ac51fbc/matplotlib-3.9.4-cp313-cp313t-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:ddb3b02246ddcffd3ce98e88fed5b238bc5faff10dbbaa42090ea13241d15764", size = 8335849, upload-time = "2024-12-13T05:55:49.763Z" },
+    { url = "https://files.pythonhosted.org/packages/b8/9f/20a4156b9726188646a030774ee337d5ff695a965be45ce4dbcb9312c170/matplotlib-3.9.4-cp313-cp313t-musllinux_1_2_x86_64.whl", hash = "sha256:8a75287e9cb9eee48cb79ec1d806f75b29c0fde978cb7223a1f4c5848d696041", size = 9102152, upload-time = "2024-12-13T05:55:51.997Z" },
+    { url = "https://files.pythonhosted.org/packages/10/11/237f9c3a4e8d810b1759b67ff2da7c32c04f9c80aa475e7beb36ed43a8fb/matplotlib-3.9.4-cp313-cp313t-win_amd64.whl", hash = "sha256:488deb7af140f0ba86da003e66e10d55ff915e152c78b4b66d231638400b1965", size = 7896987, upload-time = "2024-12-13T05:55:55.941Z" },
+    { url = "https://files.pythonhosted.org/packages/56/eb/501b465c9fef28f158e414ea3a417913dc2ac748564c7ed41535f23445b4/matplotlib-3.9.4-cp39-cp39-macosx_10_12_x86_64.whl", hash = "sha256:3c3724d89a387ddf78ff88d2a30ca78ac2b4c89cf37f2db4bd453c34799e933c", size = 7885919, upload-time = "2024-12-13T05:55:59.66Z" },
+    { url = "https://files.pythonhosted.org/packages/da/36/236fbd868b6c91309a5206bd90c3f881f4f44b2d997cd1d6239ef652f878/matplotlib-3.9.4-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:d5f0a8430ffe23d7e32cfd86445864ccad141797f7d25b7c41759a5b5d17cfd7", size = 7771486, upload-time = "2024-12-13T05:56:04.264Z" },
+    { url = "https://files.pythonhosted.org/packages/e0/4b/105caf2d54d5ed11d9f4335398f5103001a03515f2126c936a752ccf1461/matplotlib-3.9.4-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:6bb0141a21aef3b64b633dc4d16cbd5fc538b727e4958be82a0e1c92a234160e", size = 8201838, upload-time = "2024-12-13T05:56:06.792Z" },
+    { url = "https://files.pythonhosted.org/packages/5d/a7/bb01188fb4013d34d274caf44a2f8091255b0497438e8b6c0a7c1710c692/matplotlib-3.9.4-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:57aa235109e9eed52e2c2949db17da185383fa71083c00c6c143a60e07e0888c", size = 8314492, upload-time = "2024-12-13T05:56:09.964Z" },
+    { url = "https://files.pythonhosted.org/packages/33/19/02e1a37f7141fc605b193e927d0a9cdf9dc124a20b9e68793f4ffea19695/matplotlib-3.9.4-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:b18c600061477ccfdd1e6fd050c33d8be82431700f3452b297a56d9ed7037abb", size = 9092500, upload-time = "2024-12-13T05:56:13.55Z" },
+    { url = "https://files.pythonhosted.org/packages/57/68/c2feb4667adbf882ffa4b3e0ac9967f848980d9f8b5bebd86644aa67ce6a/matplotlib-3.9.4-cp39-cp39-win_amd64.whl", hash = "sha256:ef5f2d1b67d2d2145ff75e10f8c008bfbf71d45137c4b648c87193e7dd053eac", size = 7822962, upload-time = "2024-12-13T05:56:16.358Z" },
+    { url = "https://files.pythonhosted.org/packages/0c/22/2ef6a364cd3f565442b0b055e0599744f1e4314ec7326cdaaa48a4d864d7/matplotlib-3.9.4-pp39-pypy39_pp73-macosx_10_15_x86_64.whl", hash = "sha256:44e0ed786d769d85bc787b0606a53f2d8d2d1d3c8a2608237365e9121c1a338c", size = 7877995, upload-time = "2024-12-13T05:56:18.805Z" },
+    { url = "https://files.pythonhosted.org/packages/87/b8/2737456e566e9f4d94ae76b8aa0d953d9acb847714f9a7ad80184474f5be/matplotlib-3.9.4-pp39-pypy39_pp73-macosx_11_0_arm64.whl", hash = "sha256:09debb9ce941eb23ecdbe7eab972b1c3e0276dcf01688073faff7b0f61d6c6ca", size = 7769300, upload-time = "2024-12-13T05:56:21.315Z" },
+    { url = "https://files.pythonhosted.org/packages/b2/1f/e709c6ec7b5321e6568769baa288c7178e60a93a9da9e682b39450da0e29/matplotlib-3.9.4-pp39-pypy39_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:bcc53cf157a657bfd03afab14774d54ba73aa84d42cfe2480c91bd94873952db", size = 8313423, upload-time = "2024-12-13T05:56:26.719Z" },
+    { url = "https://files.pythonhosted.org/packages/5e/b6/5a1f868782cd13f053a679984e222007ecff654a9bfbac6b27a65f4eeb05/matplotlib-3.9.4-pp39-pypy39_pp73-win_amd64.whl", hash = "sha256:ad45da51be7ad02387801fd154ef74d942f49fe3fcd26a64c94842ba7ec0d865", size = 7854624, upload-time = "2024-12-13T05:56:29.359Z" },
+]
+
+[[package]]
+name = "matplotlib"
+version = "3.10.6"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "contourpy", version = "1.3.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.10.*'" },
+    { name = "contourpy", version = "1.3.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.11'" },
+    { name = "cycler", marker = "python_full_version >= '3.10'" },
+    { name = "fonttools", version = "4.60.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.10'" },
+    { name = "kiwisolver", version = "1.4.9", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.10'" },
+    { name = "numpy", version = "2.2.6", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.10.*'" },
+    { name = "numpy", version = "2.3.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.11'" },
+    { name = "packaging", marker = "python_full_version >= '3.10'" },
+    { name = "pillow", version = "11.3.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.10'" },
+    { name = "pyparsing", version = "3.2.5", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.10'" },
+    { name = "python-dateutil", marker = "python_full_version >= '3.10'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/a0/59/c3e6453a9676ffba145309a73c462bb407f4400de7de3f2b41af70720a3c/matplotlib-3.10.6.tar.gz", hash = "sha256:ec01b645840dd1996df21ee37f208cd8ba57644779fa20464010638013d3203c", size = 34804264, upload-time = "2025-08-30T00:14:25.137Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/da/dc/ab89f7a5efd0cbaaebf2c3cf1881f4cba20c8925bb43f64511059df76895/matplotlib-3.10.6-cp310-cp310-macosx_10_12_x86_64.whl", hash = "sha256:bc7316c306d97463a9866b89d5cc217824e799fa0de346c8f68f4f3d27c8693d", size = 8247159, upload-time = "2025-08-30T00:12:30.507Z" },
+    { url = "https://files.pythonhosted.org/packages/30/a5/ddaee1a383ab28174093644fff7438eddb87bf8dbd58f7b85f5cdd6b2485/matplotlib-3.10.6-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:d00932b0d160ef03f59f9c0e16d1e3ac89646f7785165ce6ad40c842db16cc2e", size = 8108011, upload-time = "2025-08-30T00:12:32.771Z" },
+    { url = "https://files.pythonhosted.org/packages/75/5b/a53f69bb0522db352b1135bb57cd9fe00fd7252072409392d991d3a755d0/matplotlib-3.10.6-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:8fa4c43d6bfdbfec09c733bca8667de11bfa4970e8324c471f3a3632a0301c15", size = 8680518, upload-time = "2025-08-30T00:12:34.387Z" },
+    { url = "https://files.pythonhosted.org/packages/5f/31/e059ddce95f68819b005a2d6820b2d6ed0307827a04598891f00649bed2d/matplotlib-3.10.6-cp310-cp310-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:ea117a9c1627acaa04dbf36265691921b999cbf515a015298e54e1a12c3af837", size = 9514997, upload-time = "2025-08-30T00:12:36.272Z" },
+    { url = "https://files.pythonhosted.org/packages/66/d5/28b408a7c0f07b41577ee27e4454fe329e78ca21fe46ae7a27d279165fb5/matplotlib-3.10.6-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:08fc803293b4e1694ee325896030de97f74c141ccff0be886bb5915269247676", size = 9566440, upload-time = "2025-08-30T00:12:41.675Z" },
+    { url = "https://files.pythonhosted.org/packages/2d/99/8325b3386b479b1d182ab1a7fd588fd393ff00a99dc04b7cf7d06668cf0f/matplotlib-3.10.6-cp310-cp310-win_amd64.whl", hash = "sha256:2adf92d9b7527fbfb8818e050260f0ebaa460f79d61546374ce73506c9421d09", size = 8108186, upload-time = "2025-08-30T00:12:43.621Z" },
+    { url = "https://files.pythonhosted.org/packages/80/d6/5d3665aa44c49005aaacaa68ddea6fcb27345961cd538a98bb0177934ede/matplotlib-3.10.6-cp311-cp311-macosx_10_12_x86_64.whl", hash = "sha256:905b60d1cb0ee604ce65b297b61cf8be9f4e6cfecf95a3fe1c388b5266bc8f4f", size = 8257527, upload-time = "2025-08-30T00:12:45.31Z" },
+    { url = "https://files.pythonhosted.org/packages/8c/af/30ddefe19ca67eebd70047dabf50f899eaff6f3c5e6a1a7edaecaf63f794/matplotlib-3.10.6-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:7bac38d816637343e53d7185d0c66677ff30ffb131044a81898b5792c956ba76", size = 8119583, upload-time = "2025-08-30T00:12:47.236Z" },
+    { url = "https://files.pythonhosted.org/packages/d3/29/4a8650a3dcae97fa4f375d46efcb25920d67b512186f8a6788b896062a81/matplotlib-3.10.6-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:942a8de2b5bfff1de31d95722f702e2966b8a7e31f4e68f7cd963c7cd8861cf6", size = 8692682, upload-time = "2025-08-30T00:12:48.781Z" },
+    { url = "https://files.pythonhosted.org/packages/aa/d3/b793b9cb061cfd5d42ff0f69d1822f8d5dbc94e004618e48a97a8373179a/matplotlib-3.10.6-cp311-cp311-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:a3276c85370bc0dfca051ec65c5817d1e0f8f5ce1b7787528ec8ed2d524bbc2f", size = 9521065, upload-time = "2025-08-30T00:12:50.602Z" },
+    { url = "https://files.pythonhosted.org/packages/f7/c5/53de5629f223c1c66668d46ac2621961970d21916a4bc3862b174eb2a88f/matplotlib-3.10.6-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:9df5851b219225731f564e4b9e7f2ac1e13c9e6481f941b5631a0f8e2d9387ce", size = 9576888, upload-time = "2025-08-30T00:12:52.92Z" },
+    { url = "https://files.pythonhosted.org/packages/fc/8e/0a18d6d7d2d0a2e66585032a760d13662e5250c784d53ad50434e9560991/matplotlib-3.10.6-cp311-cp311-win_amd64.whl", hash = "sha256:abb5d9478625dd9c9eb51a06d39aae71eda749ae9b3138afb23eb38824026c7e", size = 8115158, upload-time = "2025-08-30T00:12:54.863Z" },
+    { url = "https://files.pythonhosted.org/packages/07/b3/1a5107bb66c261e23b9338070702597a2d374e5aa7004b7adfc754fbed02/matplotlib-3.10.6-cp311-cp311-win_arm64.whl", hash = "sha256:886f989ccfae63659183173bb3fced7fd65e9eb793c3cc21c273add368536951", size = 7992444, upload-time = "2025-08-30T00:12:57.067Z" },
+    { url = "https://files.pythonhosted.org/packages/ea/1a/7042f7430055d567cc3257ac409fcf608599ab27459457f13772c2d9778b/matplotlib-3.10.6-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:31ca662df6a80bd426f871105fdd69db7543e28e73a9f2afe80de7e531eb2347", size = 8272404, upload-time = "2025-08-30T00:12:59.112Z" },
+    { url = "https://files.pythonhosted.org/packages/a9/5d/1d5f33f5b43f4f9e69e6a5fe1fb9090936ae7bc8e2ff6158e7a76542633b/matplotlib-3.10.6-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:1678bb61d897bb4ac4757b5ecfb02bfb3fddf7f808000fb81e09c510712fda75", size = 8128262, upload-time = "2025-08-30T00:13:01.141Z" },
+    { url = "https://files.pythonhosted.org/packages/67/c3/135fdbbbf84e0979712df58e5e22b4f257b3f5e52a3c4aacf1b8abec0d09/matplotlib-3.10.6-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:56cd2d20842f58c03d2d6e6c1f1cf5548ad6f66b91e1e48f814e4fb5abd1cb95", size = 8697008, upload-time = "2025-08-30T00:13:03.24Z" },
+    { url = "https://files.pythonhosted.org/packages/9c/be/c443ea428fb2488a3ea7608714b1bd85a82738c45da21b447dc49e2f8e5d/matplotlib-3.10.6-cp312-cp312-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:662df55604a2f9a45435566d6e2660e41efe83cd94f4288dfbf1e6d1eae4b0bb", size = 9530166, upload-time = "2025-08-30T00:13:05.951Z" },
+    { url = "https://files.pythonhosted.org/packages/a9/35/48441422b044d74034aea2a3e0d1a49023f12150ebc58f16600132b9bbaf/matplotlib-3.10.6-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:08f141d55148cd1fc870c3387d70ca4df16dee10e909b3b038782bd4bda6ea07", size = 9593105, upload-time = "2025-08-30T00:13:08.356Z" },
+    { url = "https://files.pythonhosted.org/packages/45/c3/994ef20eb4154ab84cc08d033834555319e4af970165e6c8894050af0b3c/matplotlib-3.10.6-cp312-cp312-win_amd64.whl", hash = "sha256:590f5925c2d650b5c9d813c5b3b5fc53f2929c3f8ef463e4ecfa7e052044fb2b", size = 8122784, upload-time = "2025-08-30T00:13:10.367Z" },
+    { url = "https://files.pythonhosted.org/packages/57/b8/5c85d9ae0e40f04e71bedb053aada5d6bab1f9b5399a0937afb5d6b02d98/matplotlib-3.10.6-cp312-cp312-win_arm64.whl", hash = "sha256:f44c8d264a71609c79a78d50349e724f5d5fc3684ead7c2a473665ee63d868aa", size = 7992823, upload-time = "2025-08-30T00:13:12.24Z" },
+    { url = "https://files.pythonhosted.org/packages/a0/db/18380e788bb837e724358287b08e223b32bc8dccb3b0c12fa8ca20bc7f3b/matplotlib-3.10.6-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:819e409653c1106c8deaf62e6de6b8611449c2cd9939acb0d7d4e57a3d95cc7a", size = 8273231, upload-time = "2025-08-30T00:13:13.881Z" },
+    { url = "https://files.pythonhosted.org/packages/d3/0f/38dd49445b297e0d4f12a322c30779df0d43cb5873c7847df8a82e82ec67/matplotlib-3.10.6-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:59c8ac8382fefb9cb71308dde16a7c487432f5255d8f1fd32473523abecfecdf", size = 8128730, upload-time = "2025-08-30T00:13:15.556Z" },
+    { url = "https://files.pythonhosted.org/packages/e5/b8/9eea6630198cb303d131d95d285a024b3b8645b1763a2916fddb44ca8760/matplotlib-3.10.6-cp313-cp313-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:84e82d9e0fd70c70bc55739defbd8055c54300750cbacf4740c9673a24d6933a", size = 8698539, upload-time = "2025-08-30T00:13:17.297Z" },
+    { url = "https://files.pythonhosted.org/packages/71/34/44c7b1f075e1ea398f88aeabcc2907c01b9cc99e2afd560c1d49845a1227/matplotlib-3.10.6-cp313-cp313-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:25f7a3eb42d6c1c56e89eacd495661fc815ffc08d9da750bca766771c0fd9110", size = 9529702, upload-time = "2025-08-30T00:13:19.248Z" },
+    { url = "https://files.pythonhosted.org/packages/b5/7f/e5c2dc9950c7facaf8b461858d1b92c09dd0cf174fe14e21953b3dda06f7/matplotlib-3.10.6-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:f9c862d91ec0b7842920a4cfdaaec29662195301914ea54c33e01f1a28d014b2", size = 9593742, upload-time = "2025-08-30T00:13:21.181Z" },
+    { url = "https://files.pythonhosted.org/packages/ff/1d/70c28528794f6410ee2856cd729fa1f1756498b8d3126443b0a94e1a8695/matplotlib-3.10.6-cp313-cp313-win_amd64.whl", hash = "sha256:1b53bd6337eba483e2e7d29c5ab10eee644bc3a2491ec67cc55f7b44583ffb18", size = 8122753, upload-time = "2025-08-30T00:13:23.44Z" },
+    { url = "https://files.pythonhosted.org/packages/e8/74/0e1670501fc7d02d981564caf7c4df42974464625935424ca9654040077c/matplotlib-3.10.6-cp313-cp313-win_arm64.whl", hash = "sha256:cbd5eb50b7058b2892ce45c2f4e92557f395c9991f5c886d1bb74a1582e70fd6", size = 7992973, upload-time = "2025-08-30T00:13:26.632Z" },
+    { url = "https://files.pythonhosted.org/packages/b1/4e/60780e631d73b6b02bd7239f89c451a72970e5e7ec34f621eda55cd9a445/matplotlib-3.10.6-cp313-cp313t-macosx_10_13_x86_64.whl", hash = "sha256:acc86dd6e0e695c095001a7fccff158c49e45e0758fdf5dcdbb0103318b59c9f", size = 8316869, upload-time = "2025-08-30T00:13:28.262Z" },
+    { url = "https://files.pythonhosted.org/packages/f8/15/baa662374a579413210fc2115d40c503b7360a08e9cc254aa0d97d34b0c1/matplotlib-3.10.6-cp313-cp313t-macosx_11_0_arm64.whl", hash = "sha256:e228cd2ffb8f88b7d0b29e37f68ca9aaf83e33821f24a5ccc4f082dd8396bc27", size = 8178240, upload-time = "2025-08-30T00:13:30.007Z" },
+    { url = "https://files.pythonhosted.org/packages/c6/3f/3c38e78d2aafdb8829fcd0857d25aaf9e7dd2dfcf7ec742765b585774931/matplotlib-3.10.6-cp313-cp313t-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:658bc91894adeab669cf4bb4a186d049948262987e80f0857216387d7435d833", size = 8711719, upload-time = "2025-08-30T00:13:31.72Z" },
+    { url = "https://files.pythonhosted.org/packages/96/4b/2ec2bbf8cefaa53207cc56118d1fa8a0f9b80642713ea9390235d331ede4/matplotlib-3.10.6-cp313-cp313t-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:8913b7474f6dd83ac444c9459c91f7f0f2859e839f41d642691b104e0af056aa", size = 9541422, upload-time = "2025-08-30T00:13:33.611Z" },
+    { url = "https://files.pythonhosted.org/packages/83/7d/40255e89b3ef11c7871020563b2dd85f6cb1b4eff17c0f62b6eb14c8fa80/matplotlib-3.10.6-cp313-cp313t-musllinux_1_2_x86_64.whl", hash = "sha256:091cea22e059b89f6d7d1a18e2c33a7376c26eee60e401d92a4d6726c4e12706", size = 9594068, upload-time = "2025-08-30T00:13:35.833Z" },
+    { url = "https://files.pythonhosted.org/packages/f0/a9/0213748d69dc842537a113493e1c27daf9f96bd7cc316f933dc8ec4de985/matplotlib-3.10.6-cp313-cp313t-win_amd64.whl", hash = "sha256:491e25e02a23d7207629d942c666924a6b61e007a48177fdd231a0097b7f507e", size = 8200100, upload-time = "2025-08-30T00:13:37.668Z" },
+    { url = "https://files.pythonhosted.org/packages/be/15/79f9988066ce40b8a6f1759a934ea0cde8dc4adc2262255ee1bc98de6ad0/matplotlib-3.10.6-cp313-cp313t-win_arm64.whl", hash = "sha256:3d80d60d4e54cda462e2cd9a086d85cd9f20943ead92f575ce86885a43a565d5", size = 8042142, upload-time = "2025-08-30T00:13:39.426Z" },
+    { url = "https://files.pythonhosted.org/packages/7c/58/e7b6d292beae6fb4283ca6fb7fa47d7c944a68062d6238c07b497dd35493/matplotlib-3.10.6-cp314-cp314-macosx_10_13_x86_64.whl", hash = "sha256:70aaf890ce1d0efd482df969b28a5b30ea0b891224bb315810a3940f67182899", size = 8273802, upload-time = "2025-08-30T00:13:41.006Z" },
+    { url = "https://files.pythonhosted.org/packages/9f/f6/7882d05aba16a8cdd594fb9a03a9d3cca751dbb6816adf7b102945522ee9/matplotlib-3.10.6-cp314-cp314-macosx_11_0_arm64.whl", hash = "sha256:1565aae810ab79cb72e402b22facfa6501365e73ebab70a0fdfb98488d2c3c0c", size = 8131365, upload-time = "2025-08-30T00:13:42.664Z" },
+    { url = "https://files.pythonhosted.org/packages/94/bf/ff32f6ed76e78514e98775a53715eca4804b12bdcf35902cdd1cf759d324/matplotlib-3.10.6-cp314-cp314-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:f3b23315a01981689aa4e1a179dbf6ef9fbd17143c3eea77548c2ecfb0499438", size = 9533961, upload-time = "2025-08-30T00:13:44.372Z" },
+    { url = "https://files.pythonhosted.org/packages/fe/c3/6bf88c2fc2da7708a2ff8d2eeb5d68943130f50e636d5d3dcf9d4252e971/matplotlib-3.10.6-cp314-cp314-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:30fdd37edf41a4e6785f9b37969de57aea770696cb637d9946eb37470c94a453", size = 9804262, upload-time = "2025-08-30T00:13:46.614Z" },
+    { url = "https://files.pythonhosted.org/packages/0f/7a/e05e6d9446d2d577b459427ad060cd2de5742d0e435db3191fea4fcc7e8b/matplotlib-3.10.6-cp314-cp314-musllinux_1_2_x86_64.whl", hash = "sha256:bc31e693da1c08012c764b053e702c1855378e04102238e6a5ee6a7117c53a47", size = 9595508, upload-time = "2025-08-30T00:13:48.731Z" },
+    { url = "https://files.pythonhosted.org/packages/39/fb/af09c463ced80b801629fd73b96f726c9f6124c3603aa2e480a061d6705b/matplotlib-3.10.6-cp314-cp314-win_amd64.whl", hash = "sha256:05be9bdaa8b242bc6ff96330d18c52f1fc59c6fb3a4dd411d953d67e7e1baf98", size = 8252742, upload-time = "2025-08-30T00:13:50.539Z" },
+    { url = "https://files.pythonhosted.org/packages/b1/f9/b682f6db9396d9ab8f050c0a3bfbb5f14fb0f6518f08507c04cc02f8f229/matplotlib-3.10.6-cp314-cp314-win_arm64.whl", hash = "sha256:f56a0d1ab05d34c628592435781d185cd99630bdfd76822cd686fb5a0aecd43a", size = 8124237, upload-time = "2025-08-30T00:13:54.3Z" },
+    { url = "https://files.pythonhosted.org/packages/b5/d2/b69b4a0923a3c05ab90527c60fdec899ee21ca23ede7f0fb818e6620d6f2/matplotlib-3.10.6-cp314-cp314t-macosx_10_13_x86_64.whl", hash = "sha256:94f0b4cacb23763b64b5dace50d5b7bfe98710fed5f0cef5c08135a03399d98b", size = 8316956, upload-time = "2025-08-30T00:13:55.932Z" },
+    { url = "https://files.pythonhosted.org/packages/28/e9/dc427b6f16457ffaeecb2fc4abf91e5adb8827861b869c7a7a6d1836fa73/matplotlib-3.10.6-cp314-cp314t-macosx_11_0_arm64.whl", hash = "sha256:cc332891306b9fb39462673d8225d1b824c89783fee82840a709f96714f17a5c", size = 8178260, upload-time = "2025-08-30T00:14:00.942Z" },
+    { url = "https://files.pythonhosted.org/packages/c4/89/1fbd5ad611802c34d1c7ad04607e64a1350b7fb9c567c4ec2c19e066ed35/matplotlib-3.10.6-cp314-cp314t-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:ee1d607b3fb1590deb04b69f02ea1d53ed0b0bf75b2b1a5745f269afcbd3cdd3", size = 9541422, upload-time = "2025-08-30T00:14:02.664Z" },
+    { url = "https://files.pythonhosted.org/packages/b0/3b/65fec8716025b22c1d72d5a82ea079934c76a547696eaa55be6866bc89b1/matplotlib-3.10.6-cp314-cp314t-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:376a624a218116461696b27b2bbf7a8945053e6d799f6502fc03226d077807bf", size = 9803678, upload-time = "2025-08-30T00:14:04.741Z" },
+    { url = "https://files.pythonhosted.org/packages/c7/b0/40fb2b3a1ab9381bb39a952e8390357c8be3bdadcf6d5055d9c31e1b35ae/matplotlib-3.10.6-cp314-cp314t-musllinux_1_2_x86_64.whl", hash = "sha256:83847b47f6524c34b4f2d3ce726bb0541c48c8e7692729865c3df75bfa0f495a", size = 9594077, upload-time = "2025-08-30T00:14:07.012Z" },
+    { url = "https://files.pythonhosted.org/packages/76/34/c4b71b69edf5b06e635eee1ed10bfc73cf8df058b66e63e30e6a55e231d5/matplotlib-3.10.6-cp314-cp314t-win_amd64.whl", hash = "sha256:c7e0518e0d223683532a07f4b512e2e0729b62674f1b3a1a69869f98e6b1c7e3", size = 8342822, upload-time = "2025-08-30T00:14:09.041Z" },
+    { url = "https://files.pythonhosted.org/packages/e8/62/aeabeef1a842b6226a30d49dd13e8a7a1e81e9ec98212c0b5169f0a12d83/matplotlib-3.10.6-cp314-cp314t-win_arm64.whl", hash = "sha256:4dd83e029f5b4801eeb87c64efd80e732452781c16a9cf7415b7b63ec8f374d7", size = 8172588, upload-time = "2025-08-30T00:14:11.166Z" },
+    { url = "https://files.pythonhosted.org/packages/17/6f/2551e45bea2938e0363ccdd54fa08dae7605ce782d4332497d31a7b97672/matplotlib-3.10.6-pp310-pypy310_pp73-macosx_10_15_x86_64.whl", hash = "sha256:13fcd07ccf17e354398358e0307a1f53f5325dca22982556ddb9c52837b5af41", size = 8241220, upload-time = "2025-08-30T00:14:12.888Z" },
+    { url = "https://files.pythonhosted.org/packages/54/7e/0f4c6e8b98105fdb162a4efde011af204ca47d7c05d735aff480ebfead1b/matplotlib-3.10.6-pp310-pypy310_pp73-macosx_11_0_arm64.whl", hash = "sha256:470fc846d59d1406e34fa4c32ba371039cd12c2fe86801159a965956f2575bd1", size = 8104624, upload-time = "2025-08-30T00:14:14.511Z" },
+    { url = "https://files.pythonhosted.org/packages/27/27/c29696702b9317a6ade1ba6f8861e02d7423f18501729203d7a80b686f23/matplotlib-3.10.6-pp310-pypy310_pp73-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:f7173f8551b88f4ef810a94adae3128c2530e0d07529f7141be7f8d8c365f051", size = 8682271, upload-time = "2025-08-30T00:14:17.273Z" },
+    { url = "https://files.pythonhosted.org/packages/12/bb/02c35a51484aae5f49bd29f091286e7af5f3f677a9736c58a92b3c78baeb/matplotlib-3.10.6-pp311-pypy311_pp73-macosx_10_15_x86_64.whl", hash = "sha256:f2d684c3204fa62421bbf770ddfebc6b50130f9cad65531eeba19236d73bb488", size = 8252296, upload-time = "2025-08-30T00:14:19.49Z" },
+    { url = "https://files.pythonhosted.org/packages/7d/85/41701e3092005aee9a2445f5ee3904d9dbd4a7df7a45905ffef29b7ef098/matplotlib-3.10.6-pp311-pypy311_pp73-macosx_11_0_arm64.whl", hash = "sha256:6f4a69196e663a41d12a728fab8751177215357906436804217d6d9cf0d4d6cf", size = 8116749, upload-time = "2025-08-30T00:14:21.344Z" },
+    { url = "https://files.pythonhosted.org/packages/16/53/8d8fa0ea32a8c8239e04d022f6c059ee5e1b77517769feccd50f1df43d6d/matplotlib-3.10.6-pp311-pypy311_pp73-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:4d6ca6ef03dfd269f4ead566ec6f3fb9becf8dab146fb999022ed85ee9f6b3eb", size = 8693933, upload-time = "2025-08-30T00:14:22.942Z" },
+]
+
+[[package]]
+name = "mdit-py-plugins"
+version = "0.4.2"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "markdown-it-py", marker = "python_full_version < '3.10'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/19/03/a2ecab526543b152300717cf232bb4bb8605b6edb946c845016fa9c9c9fd/mdit_py_plugins-0.4.2.tar.gz", hash = "sha256:5f2cd1fdb606ddf152d37ec30e46101a60512bc0e5fa1a7002c36647b09e26b5", size = 43542, upload-time = "2024-09-09T20:27:49.564Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/a7/f7/7782a043553ee469c1ff49cfa1cdace2d6bf99a1f333cf38676b3ddf30da/mdit_py_plugins-0.4.2-py3-none-any.whl", hash = "sha256:0c673c3f889399a33b95e88d2f0d111b4447bdfea7f237dab2d488f459835636", size = 55316, upload-time = "2024-09-09T20:27:48.397Z" },
+]
+
+[[package]]
+name = "mdit-py-plugins"
+version = "0.5.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "markdown-it-py", marker = "python_full_version >= '3.10'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/b2/fd/a756d36c0bfba5f6e39a1cdbdbfdd448dc02692467d83816dff4592a1ebc/mdit_py_plugins-0.5.0.tar.gz", hash = "sha256:f4918cb50119f50446560513a8e311d574ff6aaed72606ddae6d35716fe809c6", size = 44655, upload-time = "2025-08-11T07:25:49.083Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/fb/86/dd6e5db36df29e76c7a7699123569a4a18c1623ce68d826ed96c62643cae/mdit_py_plugins-0.5.0-py3-none-any.whl", hash = "sha256:07a08422fc1936a5d26d146759e9155ea466e842f5ab2f7d2266dd084c8dab1f", size = 57205, upload-time = "2025-08-11T07:25:47.597Z" },
+]
+
+[[package]]
+name = "mdurl"
+version = "0.1.2"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/d6/54/cfe61301667036ec958cb99bd3efefba235e65cdeb9c84d24a8293ba1d90/mdurl-0.1.2.tar.gz", hash = "sha256:bb413d29f5eea38f31dd4754dd7377d4465116fb207585f97bf925588687c1ba", size = 8729, upload-time = "2022-08-14T12:40:10.846Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/b3/38/89ba8ad64ae25be8de66a6d463314cf1eb366222074cfda9ee839c56a4b4/mdurl-0.1.2-py3-none-any.whl", hash = "sha256:84008a41e51615a49fc9966191ff91509e3c40b939176e643fd50a5c2196b8f8", size = 9979, upload-time = "2022-08-14T12:40:09.779Z" },
+]
+
+[[package]]
+name = "mpmath"
+version = "1.3.0"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/e0/47/dd32fa426cc72114383ac549964eecb20ecfd886d1e5ccf5340b55b02f57/mpmath-1.3.0.tar.gz", hash = "sha256:7a28eb2a9774d00c7bc92411c19a89209d5da7c4c9a9e227be8330a23a25b91f", size = 508106, upload-time = "2023-03-07T16:47:11.061Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/43/e3/7d92a15f894aa0c9c4b49b8ee9ac9850d6e63b03c9c32c0367a13ae62209/mpmath-1.3.0-py3-none-any.whl", hash = "sha256:a0b2b9fe80bbcd81a6647ff13108738cfb482d481d826cc0e02f5b35e5c88d2c", size = 536198, upload-time = "2023-03-07T16:47:09.197Z" },
+]
+
+[[package]]
+name = "myst-parser"
+version = "3.0.1"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "docutils", version = "0.20.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "docutils", version = "0.21.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "jinja2", marker = "python_full_version < '3.10'" },
+    { name = "markdown-it-py", marker = "python_full_version < '3.10'" },
+    { name = "mdit-py-plugins", version = "0.4.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.10'" },
+    { name = "pyyaml", marker = "python_full_version < '3.10'" },
+    { name = "sphinx", version = "7.1.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "sphinx", version = "7.4.7", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/49/64/e2f13dac02f599980798c01156393b781aec983b52a6e4057ee58f07c43a/myst_parser-3.0.1.tar.gz", hash = "sha256:88f0cb406cb363b077d176b51c476f62d60604d68a8dcdf4832e080441301a87", size = 92392, upload-time = "2024-04-28T20:22:42.116Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/e2/de/21aa8394f16add8f7427f0a1326ccd2b3a2a8a3245c9252bc5ac034c6155/myst_parser-3.0.1-py3-none-any.whl", hash = "sha256:6457aaa33a5d474aca678b8ead9b3dc298e89c68e67012e73146ea6fd54babf1", size = 83163, upload-time = "2024-04-28T20:22:39.985Z" },
+]
+
+[[package]]
+name = "myst-parser"
+version = "4.0.1"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "docutils", version = "0.21.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.10'" },
+    { name = "jinja2", marker = "python_full_version >= '3.10'" },
+    { name = "markdown-it-py", marker = "python_full_version >= '3.10'" },
+    { name = "mdit-py-plugins", version = "0.5.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.10'" },
+    { name = "pyyaml", marker = "python_full_version >= '3.10'" },
+    { name = "sphinx", version = "8.1.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.10.*'" },
+    { name = "sphinx", version = "8.2.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.11'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/66/a5/9626ba4f73555b3735ad86247a8077d4603aa8628537687c839ab08bfe44/myst_parser-4.0.1.tar.gz", hash = "sha256:5cfea715e4f3574138aecbf7d54132296bfd72bb614d31168f48c477a830a7c4", size = 93985, upload-time = "2025-02-12T10:53:03.833Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/5f/df/76d0321c3797b54b60fef9ec3bd6f4cfd124b9e422182156a1dd418722cf/myst_parser-4.0.1-py3-none-any.whl", hash = "sha256:9134e88959ec3b5780aedf8a99680ea242869d012e8821db3126d427edc9c95d", size = 84579, upload-time = "2025-02-12T10:53:02.078Z" },
+]
+
+[[package]]
+name = "networkx"
+version = "3.2.1"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/c4/80/a84676339aaae2f1cfdf9f418701dd634aef9cc76f708ef55c36ff39c3ca/networkx-3.2.1.tar.gz", hash = "sha256:9f1bb5cf3409bf324e0a722c20bdb4c20ee39bf1c30ce8ae499c8502b0b5e0c6", size = 2073928, upload-time = "2023-10-28T08:41:39.364Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/d5/f0/8fbc882ca80cf077f1b246c0e3c3465f7f415439bdea6b899f6b19f61f70/networkx-3.2.1-py3-none-any.whl", hash = "sha256:f18c69adc97877c42332c170849c96cefa91881c99a7cb3e95b7c659ebdc1ec2", size = 1647772, upload-time = "2023-10-28T08:41:36.945Z" },
+]
+
+[[package]]
+name = "networkx"
+version = "3.4.2"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/fd/1d/06475e1cd5264c0b870ea2cc6fdb3e37177c1e565c43f56ff17a10e3937f/networkx-3.4.2.tar.gz", hash = "sha256:307c3669428c5362aab27c8a1260aa8f47c4e91d3891f48be0141738d8d053e1", size = 2151368, upload-time = "2024-10-21T12:39:38.695Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/b9/54/dd730b32ea14ea797530a4479b2ed46a6fb250f682a9cfb997e968bf0261/networkx-3.4.2-py3-none-any.whl", hash = "sha256:df5d4365b724cf81b8c6a7312509d0c22386097011ad1abe274afd5e9d3bbc5f", size = 1723263, upload-time = "2024-10-21T12:39:36.247Z" },
+]
+
+[[package]]
+name = "networkx"
+version = "3.5"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/6c/4f/ccdb8ad3a38e583f214547fd2f7ff1fc160c43a75af88e6aec213404b96a/networkx-3.5.tar.gz", hash = "sha256:d4c6f9cf81f52d69230866796b82afbccdec3db7ae4fbd1b65ea750feed50037", size = 2471065, upload-time = "2025-05-29T11:35:07.804Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/eb/8d/776adee7bbf76365fdd7f2552710282c79a4ead5d2a46408c9043a2b70ba/networkx-3.5-py3-none-any.whl", hash = "sha256:0030d386a9a06dee3565298b4a734b68589749a544acbb6c412dc9e2489ec6ec", size = 2034406, upload-time = "2025-05-29T11:35:04.961Z" },
+]
+
+[[package]]
+name = "nodeenv"
+version = "1.9.1"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/43/16/fc88b08840de0e0a72a2f9d8c6bae36be573e475a6326ae854bcc549fc45/nodeenv-1.9.1.tar.gz", hash = "sha256:6ec12890a2dab7946721edbfbcd91f3319c6ccc9aec47be7c7e6b7011ee6645f", size = 47437, upload-time = "2024-06-04T18:44:11.171Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/d2/1d/1b658dbd2b9fa9c4c9f32accbfc0205d532c8c6194dc0f2a4c0428e7128a/nodeenv-1.9.1-py2.py3-none-any.whl", hash = "sha256:ba11c9782d29c27c70ffbdda2d7415098754709be8a7056d79a737cd901155c9", size = 22314, upload-time = "2024-06-04T18:44:08.352Z" },
+]
+
+[[package]]
+name = "numpy"
+version = "1.24.4"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/a4/9b/027bec52c633f6556dba6b722d9a0befb40498b9ceddd29cbe67a45a127c/numpy-1.24.4.tar.gz", hash = "sha256:80f5e3a4e498641401868df4208b74581206afbee7cf7b8329daae82676d9463", size = 10911229, upload-time = "2023-06-26T13:39:33.218Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/6b/80/6cdfb3e275d95155a34659163b83c09e3a3ff9f1456880bec6cc63d71083/numpy-1.24.4-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:c0bfb52d2169d58c1cdb8cc1f16989101639b34c7d3ce60ed70b19c63eba0b64", size = 19789140, upload-time = "2023-06-26T13:22:33.184Z" },
+    { url = "https://files.pythonhosted.org/packages/64/5f/3f01d753e2175cfade1013eea08db99ba1ee4bdb147ebcf3623b75d12aa7/numpy-1.24.4-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:ed094d4f0c177b1b8e7aa9cba7d6ceed51c0e569a5318ac0ca9a090680a6a1b1", size = 13854297, upload-time = "2023-06-26T13:22:59.541Z" },
+    { url = "https://files.pythonhosted.org/packages/5a/b3/2f9c21d799fa07053ffa151faccdceeb69beec5a010576b8991f614021f7/numpy-1.24.4-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:79fc682a374c4a8ed08b331bef9c5f582585d1048fa6d80bc6c35bc384eee9b4", size = 13995611, upload-time = "2023-06-26T13:23:22.167Z" },
+    { url = "https://files.pythonhosted.org/packages/10/be/ae5bf4737cb79ba437879915791f6f26d92583c738d7d960ad94e5c36adf/numpy-1.24.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:7ffe43c74893dbf38c2b0a1f5428760a1a9c98285553c89e12d70a96a7f3a4d6", size = 17282357, upload-time = "2023-06-26T13:23:51.446Z" },
+    { url = "https://files.pythonhosted.org/packages/c0/64/908c1087be6285f40e4b3e79454552a701664a079321cff519d8c7051d06/numpy-1.24.4-cp310-cp310-win32.whl", hash = "sha256:4c21decb6ea94057331e111a5bed9a79d335658c27ce2adb580fb4d54f2ad9bc", size = 12429222, upload-time = "2023-06-26T13:24:13.849Z" },
+    { url = "https://files.pythonhosted.org/packages/22/55/3d5a7c1142e0d9329ad27cece17933b0e2ab4e54ddc5c1861fbfeb3f7693/numpy-1.24.4-cp310-cp310-win_amd64.whl", hash = "sha256:b4bea75e47d9586d31e892a7401f76e909712a0fd510f58f5337bea9572c571e", size = 14841514, upload-time = "2023-06-26T13:24:38.129Z" },
+    { url = "https://files.pythonhosted.org/packages/a9/cc/5ed2280a27e5dab12994c884f1f4d8c3bd4d885d02ae9e52a9d213a6a5e2/numpy-1.24.4-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:f136bab9c2cfd8da131132c2cf6cc27331dd6fae65f95f69dcd4ae3c3639c810", size = 19775508, upload-time = "2023-06-26T13:25:08.882Z" },
+    { url = "https://files.pythonhosted.org/packages/c0/bc/77635c657a3668cf652806210b8662e1aff84b818a55ba88257abf6637a8/numpy-1.24.4-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:e2926dac25b313635e4d6cf4dc4e51c8c0ebfed60b801c799ffc4c32bf3d1254", size = 13840033, upload-time = "2023-06-26T13:25:33.417Z" },
+    { url = "https://files.pythonhosted.org/packages/a7/4c/96cdaa34f54c05e97c1c50f39f98d608f96f0677a6589e64e53104e22904/numpy-1.24.4-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:222e40d0e2548690405b0b3c7b21d1169117391c2e82c378467ef9ab4c8f0da7", size = 13991951, upload-time = "2023-06-26T13:25:55.725Z" },
+    { url = "https://files.pythonhosted.org/packages/22/97/dfb1a31bb46686f09e68ea6ac5c63fdee0d22d7b23b8f3f7ea07712869ef/numpy-1.24.4-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:7215847ce88a85ce39baf9e89070cb860c98fdddacbaa6c0da3ffb31b3350bd5", size = 17278923, upload-time = "2023-06-26T13:26:25.658Z" },
+    { url = "https://files.pythonhosted.org/packages/35/e2/76a11e54139654a324d107da1d98f99e7aa2a7ef97cfd7c631fba7dbde71/numpy-1.24.4-cp311-cp311-win32.whl", hash = "sha256:4979217d7de511a8d57f4b4b5b2b965f707768440c17cb70fbf254c4b225238d", size = 12422446, upload-time = "2023-06-26T13:26:49.302Z" },
+    { url = "https://files.pythonhosted.org/packages/d8/ec/ebef2f7d7c28503f958f0f8b992e7ce606fb74f9e891199329d5f5f87404/numpy-1.24.4-cp311-cp311-win_amd64.whl", hash = "sha256:b7b1fc9864d7d39e28f41d089bfd6353cb5f27ecd9905348c24187a768c79694", size = 14834466, upload-time = "2023-06-26T13:27:16.029Z" },
+    { url = "https://files.pythonhosted.org/packages/11/10/943cfb579f1a02909ff96464c69893b1d25be3731b5d3652c2e0cf1281ea/numpy-1.24.4-cp38-cp38-macosx_10_9_x86_64.whl", hash = "sha256:1452241c290f3e2a312c137a9999cdbf63f78864d63c79039bda65ee86943f61", size = 19780722, upload-time = "2023-06-26T13:27:49.573Z" },
+    { url = "https://files.pythonhosted.org/packages/a7/ae/f53b7b265fdc701e663fbb322a8e9d4b14d9cb7b2385f45ddfabfc4327e4/numpy-1.24.4-cp38-cp38-macosx_11_0_arm64.whl", hash = "sha256:04640dab83f7c6c85abf9cd729c5b65f1ebd0ccf9de90b270cd61935eef0197f", size = 13843102, upload-time = "2023-06-26T13:28:12.288Z" },
+    { url = "https://files.pythonhosted.org/packages/25/6f/2586a50ad72e8dbb1d8381f837008a0321a3516dfd7cb57fc8cf7e4bb06b/numpy-1.24.4-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:a5425b114831d1e77e4b5d812b69d11d962e104095a5b9c3b641a218abcc050e", size = 14039616, upload-time = "2023-06-26T13:28:35.659Z" },
+    { url = "https://files.pythonhosted.org/packages/98/5d/5738903efe0ecb73e51eb44feafba32bdba2081263d40c5043568ff60faf/numpy-1.24.4-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:dd80e219fd4c71fc3699fc1dadac5dcf4fd882bfc6f7ec53d30fa197b8ee22dc", size = 17316263, upload-time = "2023-06-26T13:29:09.272Z" },
+    { url = "https://files.pythonhosted.org/packages/d1/57/8d328f0b91c733aa9aa7ee540dbc49b58796c862b4fbcb1146c701e888da/numpy-1.24.4-cp38-cp38-win32.whl", hash = "sha256:4602244f345453db537be5314d3983dbf5834a9701b7723ec28923e2889e0bb2", size = 12455660, upload-time = "2023-06-26T13:29:33.434Z" },
+    { url = "https://files.pythonhosted.org/packages/69/65/0d47953afa0ad569d12de5f65d964321c208492064c38fe3b0b9744f8d44/numpy-1.24.4-cp38-cp38-win_amd64.whl", hash = "sha256:692f2e0f55794943c5bfff12b3f56f99af76f902fc47487bdfe97856de51a706", size = 14868112, upload-time = "2023-06-26T13:29:58.385Z" },
+    { url = "https://files.pythonhosted.org/packages/9a/cd/d5b0402b801c8a8b56b04c1e85c6165efab298d2f0ab741c2406516ede3a/numpy-1.24.4-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:2541312fbf09977f3b3ad449c4e5f4bb55d0dbf79226d7724211acc905049400", size = 19816549, upload-time = "2023-06-26T13:30:36.976Z" },
+    { url = "https://files.pythonhosted.org/packages/14/27/638aaa446f39113a3ed38b37a66243e21b38110d021bfcb940c383e120f2/numpy-1.24.4-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:9667575fb6d13c95f1b36aca12c5ee3356bf001b714fc354eb5465ce1609e62f", size = 13879950, upload-time = "2023-06-26T13:31:01.787Z" },
+    { url = "https://files.pythonhosted.org/packages/8f/27/91894916e50627476cff1a4e4363ab6179d01077d71b9afed41d9e1f18bf/numpy-1.24.4-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:f3a86ed21e4f87050382c7bc96571755193c4c1392490744ac73d660e8f564a9", size = 14030228, upload-time = "2023-06-26T13:31:26.696Z" },
+    { url = "https://files.pythonhosted.org/packages/7a/7c/d7b2a0417af6428440c0ad7cb9799073e507b1a465f827d058b826236964/numpy-1.24.4-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:d11efb4dbecbdf22508d55e48d9c8384db795e1b7b51ea735289ff96613ff74d", size = 17311170, upload-time = "2023-06-26T13:31:56.615Z" },
+    { url = "https://files.pythonhosted.org/packages/18/9d/e02ace5d7dfccee796c37b995c63322674daf88ae2f4a4724c5dd0afcc91/numpy-1.24.4-cp39-cp39-win32.whl", hash = "sha256:6620c0acd41dbcb368610bb2f4d83145674040025e5536954782467100aa8835", size = 12454918, upload-time = "2023-06-26T13:32:16.8Z" },
+    { url = "https://files.pythonhosted.org/packages/63/38/6cc19d6b8bfa1d1a459daf2b3fe325453153ca7019976274b6f33d8b5663/numpy-1.24.4-cp39-cp39-win_amd64.whl", hash = "sha256:befe2bf740fd8373cf56149a5c23a0f601e82869598d41f8e188a0e9869926f8", size = 14867441, upload-time = "2023-06-26T13:32:40.521Z" },
+    { url = "https://files.pythonhosted.org/packages/a4/fd/8dff40e25e937c94257455c237b9b6bf5a30d42dd1cc11555533be099492/numpy-1.24.4-pp38-pypy38_pp73-macosx_10_9_x86_64.whl", hash = "sha256:31f13e25b4e304632a4619d0e0777662c2ffea99fcae2029556b17d8ff958aef", size = 19156590, upload-time = "2023-06-26T13:33:10.36Z" },
+    { url = "https://files.pythonhosted.org/packages/42/e7/4bf953c6e05df90c6d351af69966384fed8e988d0e8c54dad7103b59f3ba/numpy-1.24.4-pp38-pypy38_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:95f7ac6540e95bc440ad77f56e520da5bf877f87dca58bd095288dce8940532a", size = 16705744, upload-time = "2023-06-26T13:33:36.703Z" },
+    { url = "https://files.pythonhosted.org/packages/fc/dd/9106005eb477d022b60b3817ed5937a43dad8fd1f20b0610ea8a32fcb407/numpy-1.24.4-pp38-pypy38_pp73-win_amd64.whl", hash = "sha256:e98f220aa76ca2a977fe435f5b04d7b3470c0a2e6312907b37ba6068f26787f2", size = 14734290, upload-time = "2023-06-26T13:34:05.409Z" },
+]
+
+[[package]]
+name = "numpy"
+version = "2.0.2"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/a9/75/10dd1f8116a8b796cb2c737b674e02d02e80454bda953fa7e65d8c12b016/numpy-2.0.2.tar.gz", hash = "sha256:883c987dee1880e2a864ab0dc9892292582510604156762362d9326444636e78", size = 18902015, upload-time = "2024-08-26T20:19:40.945Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/21/91/3495b3237510f79f5d81f2508f9f13fea78ebfdf07538fc7444badda173d/numpy-2.0.2-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:51129a29dbe56f9ca83438b706e2e69a39892b5eda6cedcb6b0c9fdc9b0d3ece", size = 21165245, upload-time = "2024-08-26T20:04:14.625Z" },
+    { url = "https://files.pythonhosted.org/packages/05/33/26178c7d437a87082d11019292dce6d3fe6f0e9026b7b2309cbf3e489b1d/numpy-2.0.2-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:f15975dfec0cf2239224d80e32c3170b1d168335eaedee69da84fbe9f1f9cd04", size = 13738540, upload-time = "2024-08-26T20:04:36.784Z" },
+    { url = "https://files.pythonhosted.org/packages/ec/31/cc46e13bf07644efc7a4bf68df2df5fb2a1a88d0cd0da9ddc84dc0033e51/numpy-2.0.2-cp310-cp310-macosx_14_0_arm64.whl", hash = "sha256:8c5713284ce4e282544c68d1c3b2c7161d38c256d2eefc93c1d683cf47683e66", size = 5300623, upload-time = "2024-08-26T20:04:46.491Z" },
+    { url = "https://files.pythonhosted.org/packages/6e/16/7bfcebf27bb4f9d7ec67332ffebee4d1bf085c84246552d52dbb548600e7/numpy-2.0.2-cp310-cp310-macosx_14_0_x86_64.whl", hash = "sha256:becfae3ddd30736fe1889a37f1f580e245ba79a5855bff5f2a29cb3ccc22dd7b", size = 6901774, upload-time = "2024-08-26T20:04:58.173Z" },
+    { url = "https://files.pythonhosted.org/packages/f9/a3/561c531c0e8bf082c5bef509d00d56f82e0ea7e1e3e3a7fc8fa78742a6e5/numpy-2.0.2-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:2da5960c3cf0df7eafefd806d4e612c5e19358de82cb3c343631188991566ccd", size = 13907081, upload-time = "2024-08-26T20:05:19.098Z" },
+    { url = "https://files.pythonhosted.org/packages/fa/66/f7177ab331876200ac7563a580140643d1179c8b4b6a6b0fc9838de2a9b8/numpy-2.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:496f71341824ed9f3d2fd36cf3ac57ae2e0165c143b55c3a035ee219413f3318", size = 19523451, upload-time = "2024-08-26T20:05:47.479Z" },
+    { url = "https://files.pythonhosted.org/packages/25/7f/0b209498009ad6453e4efc2c65bcdf0ae08a182b2b7877d7ab38a92dc542/numpy-2.0.2-cp310-cp310-musllinux_1_1_x86_64.whl", hash = "sha256:a61ec659f68ae254e4d237816e33171497e978140353c0c2038d46e63282d0c8", size = 19927572, upload-time = "2024-08-26T20:06:17.137Z" },
+    { url = "https://files.pythonhosted.org/packages/3e/df/2619393b1e1b565cd2d4c4403bdd979621e2c4dea1f8532754b2598ed63b/numpy-2.0.2-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:d731a1c6116ba289c1e9ee714b08a8ff882944d4ad631fd411106a30f083c326", size = 14400722, upload-time = "2024-08-26T20:06:39.16Z" },
+    { url = "https://files.pythonhosted.org/packages/22/ad/77e921b9f256d5da36424ffb711ae79ca3f451ff8489eeca544d0701d74a/numpy-2.0.2-cp310-cp310-win32.whl", hash = "sha256:984d96121c9f9616cd33fbd0618b7f08e0cfc9600a7ee1d6fd9b239186d19d97", size = 6472170, upload-time = "2024-08-26T20:06:50.361Z" },
+    { url = "https://files.pythonhosted.org/packages/10/05/3442317535028bc29cf0c0dd4c191a4481e8376e9f0db6bcf29703cadae6/numpy-2.0.2-cp310-cp310-win_amd64.whl", hash = "sha256:c7b0be4ef08607dd04da4092faee0b86607f111d5ae68036f16cc787e250a131", size = 15905558, upload-time = "2024-08-26T20:07:13.881Z" },
+    { url = "https://files.pythonhosted.org/packages/8b/cf/034500fb83041aa0286e0fb16e7c76e5c8b67c0711bb6e9e9737a717d5fe/numpy-2.0.2-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:49ca4decb342d66018b01932139c0961a8f9ddc7589611158cb3c27cbcf76448", size = 21169137, upload-time = "2024-08-26T20:07:45.345Z" },
+    { url = "https://files.pythonhosted.org/packages/4a/d9/32de45561811a4b87fbdee23b5797394e3d1504b4a7cf40c10199848893e/numpy-2.0.2-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:11a76c372d1d37437857280aa142086476136a8c0f373b2e648ab2c8f18fb195", size = 13703552, upload-time = "2024-08-26T20:08:06.666Z" },
+    { url = "https://files.pythonhosted.org/packages/c1/ca/2f384720020c7b244d22508cb7ab23d95f179fcfff33c31a6eeba8d6c512/numpy-2.0.2-cp311-cp311-macosx_14_0_arm64.whl", hash = "sha256:807ec44583fd708a21d4a11d94aedf2f4f3c3719035c76a2bbe1fe8e217bdc57", size = 5298957, upload-time = "2024-08-26T20:08:15.83Z" },
+    { url = "https://files.pythonhosted.org/packages/0e/78/a3e4f9fb6aa4e6fdca0c5428e8ba039408514388cf62d89651aade838269/numpy-2.0.2-cp311-cp311-macosx_14_0_x86_64.whl", hash = "sha256:8cafab480740e22f8d833acefed5cc87ce276f4ece12fdaa2e8903db2f82897a", size = 6905573, upload-time = "2024-08-26T20:08:27.185Z" },
+    { url = "https://files.pythonhosted.org/packages/a0/72/cfc3a1beb2caf4efc9d0b38a15fe34025230da27e1c08cc2eb9bfb1c7231/numpy-2.0.2-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:a15f476a45e6e5a3a79d8a14e62161d27ad897381fecfa4a09ed5322f2085669", size = 13914330, upload-time = "2024-08-26T20:08:48.058Z" },
+    { url = "https://files.pythonhosted.org/packages/ba/a8/c17acf65a931ce551fee11b72e8de63bf7e8a6f0e21add4c937c83563538/numpy-2.0.2-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:13e689d772146140a252c3a28501da66dfecd77490b498b168b501835041f951", size = 19534895, upload-time = "2024-08-26T20:09:16.536Z" },
+    { url = "https://files.pythonhosted.org/packages/ba/86/8767f3d54f6ae0165749f84648da9dcc8cd78ab65d415494962c86fac80f/numpy-2.0.2-cp311-cp311-musllinux_1_1_x86_64.whl", hash = "sha256:9ea91dfb7c3d1c56a0e55657c0afb38cf1eeae4544c208dc465c3c9f3a7c09f9", size = 19937253, upload-time = "2024-08-26T20:09:46.263Z" },
+    { url = "https://files.pythonhosted.org/packages/df/87/f76450e6e1c14e5bb1eae6836478b1028e096fd02e85c1c37674606ab752/numpy-2.0.2-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:c1c9307701fec8f3f7a1e6711f9089c06e6284b3afbbcd259f7791282d660a15", size = 14414074, upload-time = "2024-08-26T20:10:08.483Z" },
+    { url = "https://files.pythonhosted.org/packages/5c/ca/0f0f328e1e59f73754f06e1adfb909de43726d4f24c6a3f8805f34f2b0fa/numpy-2.0.2-cp311-cp311-win32.whl", hash = "sha256:a392a68bd329eafac5817e5aefeb39038c48b671afd242710b451e76090e81f4", size = 6470640, upload-time = "2024-08-26T20:10:19.732Z" },
+    { url = "https://files.pythonhosted.org/packages/eb/57/3a3f14d3a759dcf9bf6e9eda905794726b758819df4663f217d658a58695/numpy-2.0.2-cp311-cp311-win_amd64.whl", hash = "sha256:286cd40ce2b7d652a6f22efdfc6d1edf879440e53e76a75955bc0c826c7e64dc", size = 15910230, upload-time = "2024-08-26T20:10:43.413Z" },
+    { url = "https://files.pythonhosted.org/packages/45/40/2e117be60ec50d98fa08c2f8c48e09b3edea93cfcabd5a9ff6925d54b1c2/numpy-2.0.2-cp312-cp312-macosx_10_9_x86_64.whl", hash = "sha256:df55d490dea7934f330006d0f81e8551ba6010a5bf035a249ef61a94f21c500b", size = 20895803, upload-time = "2024-08-26T20:11:13.916Z" },
+    { url = "https://files.pythonhosted.org/packages/46/92/1b8b8dee833f53cef3e0a3f69b2374467789e0bb7399689582314df02651/numpy-2.0.2-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:8df823f570d9adf0978347d1f926b2a867d5608f434a7cff7f7908c6570dcf5e", size = 13471835, upload-time = "2024-08-26T20:11:34.779Z" },
+    { url = "https://files.pythonhosted.org/packages/7f/19/e2793bde475f1edaea6945be141aef6c8b4c669b90c90a300a8954d08f0a/numpy-2.0.2-cp312-cp312-macosx_14_0_arm64.whl", hash = "sha256:9a92ae5c14811e390f3767053ff54eaee3bf84576d99a2456391401323f4ec2c", size = 5038499, upload-time = "2024-08-26T20:11:43.902Z" },
+    { url = "https://files.pythonhosted.org/packages/e3/ff/ddf6dac2ff0dd50a7327bcdba45cb0264d0e96bb44d33324853f781a8f3c/numpy-2.0.2-cp312-cp312-macosx_14_0_x86_64.whl", hash = "sha256:a842d573724391493a97a62ebbb8e731f8a5dcc5d285dfc99141ca15a3302d0c", size = 6633497, upload-time = "2024-08-26T20:11:55.09Z" },
+    { url = "https://files.pythonhosted.org/packages/72/21/67f36eac8e2d2cd652a2e69595a54128297cdcb1ff3931cfc87838874bd4/numpy-2.0.2-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:c05e238064fc0610c840d1cf6a13bf63d7e391717d247f1bf0318172e759e692", size = 13621158, upload-time = "2024-08-26T20:12:14.95Z" },
+    { url = "https://files.pythonhosted.org/packages/39/68/e9f1126d757653496dbc096cb429014347a36b228f5a991dae2c6b6cfd40/numpy-2.0.2-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:0123ffdaa88fa4ab64835dcbde75dcdf89c453c922f18dced6e27c90d1d0ec5a", size = 19236173, upload-time = "2024-08-26T20:12:44.049Z" },
+    { url = "https://files.pythonhosted.org/packages/d1/e9/1f5333281e4ebf483ba1c888b1d61ba7e78d7e910fdd8e6499667041cc35/numpy-2.0.2-cp312-cp312-musllinux_1_1_x86_64.whl", hash = "sha256:96a55f64139912d61de9137f11bf39a55ec8faec288c75a54f93dfd39f7eb40c", size = 19634174, upload-time = "2024-08-26T20:13:13.634Z" },
+    { url = "https://files.pythonhosted.org/packages/71/af/a469674070c8d8408384e3012e064299f7a2de540738a8e414dcfd639996/numpy-2.0.2-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:ec9852fb39354b5a45a80bdab5ac02dd02b15f44b3804e9f00c556bf24b4bded", size = 14099701, upload-time = "2024-08-26T20:13:34.851Z" },
+    { url = "https://files.pythonhosted.org/packages/d0/3d/08ea9f239d0e0e939b6ca52ad403c84a2bce1bde301a8eb4888c1c1543f1/numpy-2.0.2-cp312-cp312-win32.whl", hash = "sha256:671bec6496f83202ed2d3c8fdc486a8fc86942f2e69ff0e986140339a63bcbe5", size = 6174313, upload-time = "2024-08-26T20:13:45.653Z" },
+    { url = "https://files.pythonhosted.org/packages/b2/b5/4ac39baebf1fdb2e72585c8352c56d063b6126be9fc95bd2bb5ef5770c20/numpy-2.0.2-cp312-cp312-win_amd64.whl", hash = "sha256:cfd41e13fdc257aa5778496b8caa5e856dc4896d4ccf01841daee1d96465467a", size = 15606179, upload-time = "2024-08-26T20:14:08.786Z" },
+    { url = "https://files.pythonhosted.org/packages/43/c1/41c8f6df3162b0c6ffd4437d729115704bd43363de0090c7f913cfbc2d89/numpy-2.0.2-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:9059e10581ce4093f735ed23f3b9d283b9d517ff46009ddd485f1747eb22653c", size = 21169942, upload-time = "2024-08-26T20:14:40.108Z" },
+    { url = "https://files.pythonhosted.org/packages/39/bc/fd298f308dcd232b56a4031fd6ddf11c43f9917fbc937e53762f7b5a3bb1/numpy-2.0.2-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:423e89b23490805d2a5a96fe40ec507407b8ee786d66f7328be214f9679df6dd", size = 13711512, upload-time = "2024-08-26T20:15:00.985Z" },
+    { url = "https://files.pythonhosted.org/packages/96/ff/06d1aa3eeb1c614eda245c1ba4fb88c483bee6520d361641331872ac4b82/numpy-2.0.2-cp39-cp39-macosx_14_0_arm64.whl", hash = "sha256:2b2955fa6f11907cf7a70dab0d0755159bca87755e831e47932367fc8f2f2d0b", size = 5306976, upload-time = "2024-08-26T20:15:10.876Z" },
+    { url = "https://files.pythonhosted.org/packages/2d/98/121996dcfb10a6087a05e54453e28e58694a7db62c5a5a29cee14c6e047b/numpy-2.0.2-cp39-cp39-macosx_14_0_x86_64.whl", hash = "sha256:97032a27bd9d8988b9a97a8c4d2c9f2c15a81f61e2f21404d7e8ef00cb5be729", size = 6906494, upload-time = "2024-08-26T20:15:22.055Z" },
+    { url = "https://files.pythonhosted.org/packages/15/31/9dffc70da6b9bbf7968f6551967fc21156207366272c2a40b4ed6008dc9b/numpy-2.0.2-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:1e795a8be3ddbac43274f18588329c72939870a16cae810c2b73461c40718ab1", size = 13912596, upload-time = "2024-08-26T20:15:42.452Z" },
+    { url = "https://files.pythonhosted.org/packages/b9/14/78635daab4b07c0930c919d451b8bf8c164774e6a3413aed04a6d95758ce/numpy-2.0.2-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:f26b258c385842546006213344c50655ff1555a9338e2e5e02a0756dc3e803dd", size = 19526099, upload-time = "2024-08-26T20:16:11.048Z" },
+    { url = "https://files.pythonhosted.org/packages/26/4c/0eeca4614003077f68bfe7aac8b7496f04221865b3a5e7cb230c9d055afd/numpy-2.0.2-cp39-cp39-musllinux_1_1_x86_64.whl", hash = "sha256:5fec9451a7789926bcf7c2b8d187292c9f93ea30284802a0ab3f5be8ab36865d", size = 19932823, upload-time = "2024-08-26T20:16:40.171Z" },
+    { url = "https://files.pythonhosted.org/packages/f1/46/ea25b98b13dccaebddf1a803f8c748680d972e00507cd9bc6dcdb5aa2ac1/numpy-2.0.2-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:9189427407d88ff25ecf8f12469d4d39d35bee1db5d39fc5c168c6f088a6956d", size = 14404424, upload-time = "2024-08-26T20:17:02.604Z" },
+    { url = "https://files.pythonhosted.org/packages/c8/a6/177dd88d95ecf07e722d21008b1b40e681a929eb9e329684d449c36586b2/numpy-2.0.2-cp39-cp39-win32.whl", hash = "sha256:905d16e0c60200656500c95b6b8dca5d109e23cb24abc701d41c02d74c6b3afa", size = 6476809, upload-time = "2024-08-26T20:17:13.553Z" },
+    { url = "https://files.pythonhosted.org/packages/ea/2b/7fc9f4e7ae5b507c1a3a21f0f15ed03e794c1242ea8a242ac158beb56034/numpy-2.0.2-cp39-cp39-win_amd64.whl", hash = "sha256:a3f4ab0caa7f053f6797fcd4e1e25caee367db3112ef2b6ef82d749530768c73", size = 15911314, upload-time = "2024-08-26T20:17:36.72Z" },
+    { url = "https://files.pythonhosted.org/packages/8f/3b/df5a870ac6a3be3a86856ce195ef42eec7ae50d2a202be1f5a4b3b340e14/numpy-2.0.2-pp39-pypy39_pp73-macosx_10_9_x86_64.whl", hash = "sha256:7f0a0c6f12e07fa94133c8a67404322845220c06a9e80e85999afe727f7438b8", size = 21025288, upload-time = "2024-08-26T20:18:07.732Z" },
+    { url = "https://files.pythonhosted.org/packages/2c/97/51af92f18d6f6f2d9ad8b482a99fb74e142d71372da5d834b3a2747a446e/numpy-2.0.2-pp39-pypy39_pp73-macosx_14_0_x86_64.whl", hash = "sha256:312950fdd060354350ed123c0e25a71327d3711584beaef30cdaa93320c392d4", size = 6762793, upload-time = "2024-08-26T20:18:19.125Z" },
+    { url = "https://files.pythonhosted.org/packages/12/46/de1fbd0c1b5ccaa7f9a005b66761533e2f6a3e560096682683a223631fe9/numpy-2.0.2-pp39-pypy39_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:26df23238872200f63518dd2aa984cfca675d82469535dc7162dc2ee52d9dd5c", size = 19334885, upload-time = "2024-08-26T20:18:47.237Z" },
+    { url = "https://files.pythonhosted.org/packages/cc/dc/d330a6faefd92b446ec0f0dfea4c3207bb1fef3c4771d19cf4543efd2c78/numpy-2.0.2-pp39-pypy39_pp73-win_amd64.whl", hash = "sha256:a46288ec55ebbd58947d31d72be2c63cbf839f0a63b49cb755022310792a3385", size = 15828784, upload-time = "2024-08-26T20:19:11.19Z" },
+]
+
+[[package]]
+name = "numpy"
+version = "2.2.6"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/76/21/7d2a95e4bba9dc13d043ee156a356c0a8f0c6309dff6b21b4d71a073b8a8/numpy-2.2.6.tar.gz", hash = "sha256:e29554e2bef54a90aa5cc07da6ce955accb83f21ab5de01a62c8478897b264fd", size = 20276440, upload-time = "2025-05-17T22:38:04.611Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/9a/3e/ed6db5be21ce87955c0cbd3009f2803f59fa08df21b5df06862e2d8e2bdd/numpy-2.2.6-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:b412caa66f72040e6d268491a59f2c43bf03eb6c96dd8f0307829feb7fa2b6fb", size = 21165245, upload-time = "2025-05-17T21:27:58.555Z" },
+    { url = "https://files.pythonhosted.org/packages/22/c2/4b9221495b2a132cc9d2eb862e21d42a009f5a60e45fc44b00118c174bff/numpy-2.2.6-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:8e41fd67c52b86603a91c1a505ebaef50b3314de0213461c7a6e99c9a3beff90", size = 14360048, upload-time = "2025-05-17T21:28:21.406Z" },
+    { url = "https://files.pythonhosted.org/packages/fd/77/dc2fcfc66943c6410e2bf598062f5959372735ffda175b39906d54f02349/numpy-2.2.6-cp310-cp310-macosx_14_0_arm64.whl", hash = "sha256:37e990a01ae6ec7fe7fa1c26c55ecb672dd98b19c3d0e1d1f326fa13cb38d163", size = 5340542, upload-time = "2025-05-17T21:28:30.931Z" },
+    { url = "https://files.pythonhosted.org/packages/7a/4f/1cb5fdc353a5f5cc7feb692db9b8ec2c3d6405453f982435efc52561df58/numpy-2.2.6-cp310-cp310-macosx_14_0_x86_64.whl", hash = "sha256:5a6429d4be8ca66d889b7cf70f536a397dc45ba6faeb5f8c5427935d9592e9cf", size = 6878301, upload-time = "2025-05-17T21:28:41.613Z" },
+    { url = "https://files.pythonhosted.org/packages/eb/17/96a3acd228cec142fcb8723bd3cc39c2a474f7dcf0a5d16731980bcafa95/numpy-2.2.6-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:efd28d4e9cd7d7a8d39074a4d44c63eda73401580c5c76acda2ce969e0a38e83", size = 14297320, upload-time = "2025-05-17T21:29:02.78Z" },
+    { url = "https://files.pythonhosted.org/packages/b4/63/3de6a34ad7ad6646ac7d2f55ebc6ad439dbbf9c4370017c50cf403fb19b5/numpy-2.2.6-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:fc7b73d02efb0e18c000e9ad8b83480dfcd5dfd11065997ed4c6747470ae8915", size = 16801050, upload-time = "2025-05-17T21:29:27.675Z" },
+    { url = "https://files.pythonhosted.org/packages/07/b6/89d837eddef52b3d0cec5c6ba0456c1bf1b9ef6a6672fc2b7873c3ec4e2e/numpy-2.2.6-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:74d4531beb257d2c3f4b261bfb0fc09e0f9ebb8842d82a7b4209415896adc680", size = 15807034, upload-time = "2025-05-17T21:29:51.102Z" },
+    { url = "https://files.pythonhosted.org/packages/01/c8/dc6ae86e3c61cfec1f178e5c9f7858584049b6093f843bca541f94120920/numpy-2.2.6-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:8fc377d995680230e83241d8a96def29f204b5782f371c532579b4f20607a289", size = 18614185, upload-time = "2025-05-17T21:30:18.703Z" },
+    { url = "https://files.pythonhosted.org/packages/5b/c5/0064b1b7e7c89137b471ccec1fd2282fceaae0ab3a9550f2568782d80357/numpy-2.2.6-cp310-cp310-win32.whl", hash = "sha256:b093dd74e50a8cba3e873868d9e93a85b78e0daf2e98c6797566ad8044e8363d", size = 6527149, upload-time = "2025-05-17T21:30:29.788Z" },
+    { url = "https://files.pythonhosted.org/packages/a3/dd/4b822569d6b96c39d1215dbae0582fd99954dcbcf0c1a13c61783feaca3f/numpy-2.2.6-cp310-cp310-win_amd64.whl", hash = "sha256:f0fd6321b839904e15c46e0d257fdd101dd7f530fe03fd6359c1ea63738703f3", size = 12904620, upload-time = "2025-05-17T21:30:48.994Z" },
+    { url = "https://files.pythonhosted.org/packages/da/a8/4f83e2aa666a9fbf56d6118faaaf5f1974d456b1823fda0a176eff722839/numpy-2.2.6-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:f9f1adb22318e121c5c69a09142811a201ef17ab257a1e66ca3025065b7f53ae", size = 21176963, upload-time = "2025-05-17T21:31:19.36Z" },
+    { url = "https://files.pythonhosted.org/packages/b3/2b/64e1affc7972decb74c9e29e5649fac940514910960ba25cd9af4488b66c/numpy-2.2.6-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:c820a93b0255bc360f53eca31a0e676fd1101f673dda8da93454a12e23fc5f7a", size = 14406743, upload-time = "2025-05-17T21:31:41.087Z" },
+    { url = "https://files.pythonhosted.org/packages/4a/9f/0121e375000b5e50ffdd8b25bf78d8e1a5aa4cca3f185d41265198c7b834/numpy-2.2.6-cp311-cp311-macosx_14_0_arm64.whl", hash = "sha256:3d70692235e759f260c3d837193090014aebdf026dfd167834bcba43e30c2a42", size = 5352616, upload-time = "2025-05-17T21:31:50.072Z" },
+    { url = "https://files.pythonhosted.org/packages/31/0d/b48c405c91693635fbe2dcd7bc84a33a602add5f63286e024d3b6741411c/numpy-2.2.6-cp311-cp311-macosx_14_0_x86_64.whl", hash = "sha256:481b49095335f8eed42e39e8041327c05b0f6f4780488f61286ed3c01368d491", size = 6889579, upload-time = "2025-05-17T21:32:01.712Z" },
+    { url = "https://files.pythonhosted.org/packages/52/b8/7f0554d49b565d0171eab6e99001846882000883998e7b7d9f0d98b1f934/numpy-2.2.6-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:b64d8d4d17135e00c8e346e0a738deb17e754230d7e0810ac5012750bbd85a5a", size = 14312005, upload-time = "2025-05-17T21:32:23.332Z" },
+    { url = "https://files.pythonhosted.org/packages/b3/dd/2238b898e51bd6d389b7389ffb20d7f4c10066d80351187ec8e303a5a475/numpy-2.2.6-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:ba10f8411898fc418a521833e014a77d3ca01c15b0c6cdcce6a0d2897e6dbbdf", size = 16821570, upload-time = "2025-05-17T21:32:47.991Z" },
+    { url = "https://files.pythonhosted.org/packages/83/6c/44d0325722cf644f191042bf47eedad61c1e6df2432ed65cbe28509d404e/numpy-2.2.6-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:bd48227a919f1bafbdda0583705e547892342c26fb127219d60a5c36882609d1", size = 15818548, upload-time = "2025-05-17T21:33:11.728Z" },
+    { url = "https://files.pythonhosted.org/packages/ae/9d/81e8216030ce66be25279098789b665d49ff19eef08bfa8cb96d4957f422/numpy-2.2.6-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:9551a499bf125c1d4f9e250377c1ee2eddd02e01eac6644c080162c0c51778ab", size = 18620521, upload-time = "2025-05-17T21:33:39.139Z" },
+    { url = "https://files.pythonhosted.org/packages/6a/fd/e19617b9530b031db51b0926eed5345ce8ddc669bb3bc0044b23e275ebe8/numpy-2.2.6-cp311-cp311-win32.whl", hash = "sha256:0678000bb9ac1475cd454c6b8c799206af8107e310843532b04d49649c717a47", size = 6525866, upload-time = "2025-05-17T21:33:50.273Z" },
+    { url = "https://files.pythonhosted.org/packages/31/0a/f354fb7176b81747d870f7991dc763e157a934c717b67b58456bc63da3df/numpy-2.2.6-cp311-cp311-win_amd64.whl", hash = "sha256:e8213002e427c69c45a52bbd94163084025f533a55a59d6f9c5b820774ef3303", size = 12907455, upload-time = "2025-05-17T21:34:09.135Z" },
+    { url = "https://files.pythonhosted.org/packages/82/5d/c00588b6cf18e1da539b45d3598d3557084990dcc4331960c15ee776ee41/numpy-2.2.6-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:41c5a21f4a04fa86436124d388f6ed60a9343a6f767fced1a8a71c3fbca038ff", size = 20875348, upload-time = "2025-05-17T21:34:39.648Z" },
+    { url = "https://files.pythonhosted.org/packages/66/ee/560deadcdde6c2f90200450d5938f63a34b37e27ebff162810f716f6a230/numpy-2.2.6-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:de749064336d37e340f640b05f24e9e3dd678c57318c7289d222a8a2f543e90c", size = 14119362, upload-time = "2025-05-17T21:35:01.241Z" },
+    { url = "https://files.pythonhosted.org/packages/3c/65/4baa99f1c53b30adf0acd9a5519078871ddde8d2339dc5a7fde80d9d87da/numpy-2.2.6-cp312-cp312-macosx_14_0_arm64.whl", hash = "sha256:894b3a42502226a1cac872f840030665f33326fc3dac8e57c607905773cdcde3", size = 5084103, upload-time = "2025-05-17T21:35:10.622Z" },
+    { url = "https://files.pythonhosted.org/packages/cc/89/e5a34c071a0570cc40c9a54eb472d113eea6d002e9ae12bb3a8407fb912e/numpy-2.2.6-cp312-cp312-macosx_14_0_x86_64.whl", hash = "sha256:71594f7c51a18e728451bb50cc60a3ce4e6538822731b2933209a1f3614e9282", size = 6625382, upload-time = "2025-05-17T21:35:21.414Z" },
+    { url = "https://files.pythonhosted.org/packages/f8/35/8c80729f1ff76b3921d5c9487c7ac3de9b2a103b1cd05e905b3090513510/numpy-2.2.6-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:f2618db89be1b4e05f7a1a847a9c1c0abd63e63a1607d892dd54668dd92faf87", size = 14018462, upload-time = "2025-05-17T21:35:42.174Z" },
+    { url = "https://files.pythonhosted.org/packages/8c/3d/1e1db36cfd41f895d266b103df00ca5b3cbe965184df824dec5c08c6b803/numpy-2.2.6-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:fd83c01228a688733f1ded5201c678f0c53ecc1006ffbc404db9f7a899ac6249", size = 16527618, upload-time = "2025-05-17T21:36:06.711Z" },
+    { url = "https://files.pythonhosted.org/packages/61/c6/03ed30992602c85aa3cd95b9070a514f8b3c33e31124694438d88809ae36/numpy-2.2.6-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:37c0ca431f82cd5fa716eca9506aefcabc247fb27ba69c5062a6d3ade8cf8f49", size = 15505511, upload-time = "2025-05-17T21:36:29.965Z" },
+    { url = "https://files.pythonhosted.org/packages/b7/25/5761d832a81df431e260719ec45de696414266613c9ee268394dd5ad8236/numpy-2.2.6-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:fe27749d33bb772c80dcd84ae7e8df2adc920ae8297400dabec45f0dedb3f6de", size = 18313783, upload-time = "2025-05-17T21:36:56.883Z" },
+    { url = "https://files.pythonhosted.org/packages/57/0a/72d5a3527c5ebffcd47bde9162c39fae1f90138c961e5296491ce778e682/numpy-2.2.6-cp312-cp312-win32.whl", hash = "sha256:4eeaae00d789f66c7a25ac5f34b71a7035bb474e679f410e5e1a94deb24cf2d4", size = 6246506, upload-time = "2025-05-17T21:37:07.368Z" },
+    { url = "https://files.pythonhosted.org/packages/36/fa/8c9210162ca1b88529ab76b41ba02d433fd54fecaf6feb70ef9f124683f1/numpy-2.2.6-cp312-cp312-win_amd64.whl", hash = "sha256:c1f9540be57940698ed329904db803cf7a402f3fc200bfe599334c9bd84a40b2", size = 12614190, upload-time = "2025-05-17T21:37:26.213Z" },
+    { url = "https://files.pythonhosted.org/packages/f9/5c/6657823f4f594f72b5471f1db1ab12e26e890bb2e41897522d134d2a3e81/numpy-2.2.6-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:0811bb762109d9708cca4d0b13c4f67146e3c3b7cf8d34018c722adb2d957c84", size = 20867828, upload-time = "2025-05-17T21:37:56.699Z" },
+    { url = "https://files.pythonhosted.org/packages/dc/9e/14520dc3dadf3c803473bd07e9b2bd1b69bc583cb2497b47000fed2fa92f/numpy-2.2.6-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:287cc3162b6f01463ccd86be154f284d0893d2b3ed7292439ea97eafa8170e0b", size = 14143006, upload-time = "2025-05-17T21:38:18.291Z" },
+    { url = "https://files.pythonhosted.org/packages/4f/06/7e96c57d90bebdce9918412087fc22ca9851cceaf5567a45c1f404480e9e/numpy-2.2.6-cp313-cp313-macosx_14_0_arm64.whl", hash = "sha256:f1372f041402e37e5e633e586f62aa53de2eac8d98cbfb822806ce4bbefcb74d", size = 5076765, upload-time = "2025-05-17T21:38:27.319Z" },
+    { url = "https://files.pythonhosted.org/packages/73/ed/63d920c23b4289fdac96ddbdd6132e9427790977d5457cd132f18e76eae0/numpy-2.2.6-cp313-cp313-macosx_14_0_x86_64.whl", hash = "sha256:55a4d33fa519660d69614a9fad433be87e5252f4b03850642f88993f7b2ca566", size = 6617736, upload-time = "2025-05-17T21:38:38.141Z" },
+    { url = "https://files.pythonhosted.org/packages/85/c5/e19c8f99d83fd377ec8c7e0cf627a8049746da54afc24ef0a0cb73d5dfb5/numpy-2.2.6-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:f92729c95468a2f4f15e9bb94c432a9229d0d50de67304399627a943201baa2f", size = 14010719, upload-time = "2025-05-17T21:38:58.433Z" },
+    { url = "https://files.pythonhosted.org/packages/19/49/4df9123aafa7b539317bf6d342cb6d227e49f7a35b99c287a6109b13dd93/numpy-2.2.6-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:1bc23a79bfabc5d056d106f9befb8d50c31ced2fbc70eedb8155aec74a45798f", size = 16526072, upload-time = "2025-05-17T21:39:22.638Z" },
+    { url = "https://files.pythonhosted.org/packages/b2/6c/04b5f47f4f32f7c2b0e7260442a8cbcf8168b0e1a41ff1495da42f42a14f/numpy-2.2.6-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:e3143e4451880bed956e706a3220b4e5cf6172ef05fcc397f6f36a550b1dd868", size = 15503213, upload-time = "2025-05-17T21:39:45.865Z" },
+    { url = "https://files.pythonhosted.org/packages/17/0a/5cd92e352c1307640d5b6fec1b2ffb06cd0dabe7d7b8227f97933d378422/numpy-2.2.6-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:b4f13750ce79751586ae2eb824ba7e1e8dba64784086c98cdbbcc6a42112ce0d", size = 18316632, upload-time = "2025-05-17T21:40:13.331Z" },
+    { url = "https://files.pythonhosted.org/packages/f0/3b/5cba2b1d88760ef86596ad0f3d484b1cbff7c115ae2429678465057c5155/numpy-2.2.6-cp313-cp313-win32.whl", hash = "sha256:5beb72339d9d4fa36522fc63802f469b13cdbe4fdab4a288f0c441b74272ebfd", size = 6244532, upload-time = "2025-05-17T21:43:46.099Z" },
+    { url = "https://files.pythonhosted.org/packages/cb/3b/d58c12eafcb298d4e6d0d40216866ab15f59e55d148a5658bb3132311fcf/numpy-2.2.6-cp313-cp313-win_amd64.whl", hash = "sha256:b0544343a702fa80c95ad5d3d608ea3599dd54d4632df855e4c8d24eb6ecfa1c", size = 12610885, upload-time = "2025-05-17T21:44:05.145Z" },
+    { url = "https://files.pythonhosted.org/packages/6b/9e/4bf918b818e516322db999ac25d00c75788ddfd2d2ade4fa66f1f38097e1/numpy-2.2.6-cp313-cp313t-macosx_10_13_x86_64.whl", hash = "sha256:0bca768cd85ae743b2affdc762d617eddf3bcf8724435498a1e80132d04879e6", size = 20963467, upload-time = "2025-05-17T21:40:44Z" },
+    { url = "https://files.pythonhosted.org/packages/61/66/d2de6b291507517ff2e438e13ff7b1e2cdbdb7cb40b3ed475377aece69f9/numpy-2.2.6-cp313-cp313t-macosx_11_0_arm64.whl", hash = "sha256:fc0c5673685c508a142ca65209b4e79ed6740a4ed6b2267dbba90f34b0b3cfda", size = 14225144, upload-time = "2025-05-17T21:41:05.695Z" },
+    { url = "https://files.pythonhosted.org/packages/e4/25/480387655407ead912e28ba3a820bc69af9adf13bcbe40b299d454ec011f/numpy-2.2.6-cp313-cp313t-macosx_14_0_arm64.whl", hash = "sha256:5bd4fc3ac8926b3819797a7c0e2631eb889b4118a9898c84f585a54d475b7e40", size = 5200217, upload-time = "2025-05-17T21:41:15.903Z" },
+    { url = "https://files.pythonhosted.org/packages/aa/4a/6e313b5108f53dcbf3aca0c0f3e9c92f4c10ce57a0a721851f9785872895/numpy-2.2.6-cp313-cp313t-macosx_14_0_x86_64.whl", hash = "sha256:fee4236c876c4e8369388054d02d0e9bb84821feb1a64dd59e137e6511a551f8", size = 6712014, upload-time = "2025-05-17T21:41:27.321Z" },
+    { url = "https://files.pythonhosted.org/packages/b7/30/172c2d5c4be71fdf476e9de553443cf8e25feddbe185e0bd88b096915bcc/numpy-2.2.6-cp313-cp313t-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:e1dda9c7e08dc141e0247a5b8f49cf05984955246a327d4c48bda16821947b2f", size = 14077935, upload-time = "2025-05-17T21:41:49.738Z" },
+    { url = "https://files.pythonhosted.org/packages/12/fb/9e743f8d4e4d3c710902cf87af3512082ae3d43b945d5d16563f26ec251d/numpy-2.2.6-cp313-cp313t-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:f447e6acb680fd307f40d3da4852208af94afdfab89cf850986c3ca00562f4fa", size = 16600122, upload-time = "2025-05-17T21:42:14.046Z" },
+    { url = "https://files.pythonhosted.org/packages/12/75/ee20da0e58d3a66f204f38916757e01e33a9737d0b22373b3eb5a27358f9/numpy-2.2.6-cp313-cp313t-musllinux_1_2_aarch64.whl", hash = "sha256:389d771b1623ec92636b0786bc4ae56abafad4a4c513d36a55dce14bd9ce8571", size = 15586143, upload-time = "2025-05-17T21:42:37.464Z" },
+    { url = "https://files.pythonhosted.org/packages/76/95/bef5b37f29fc5e739947e9ce5179ad402875633308504a52d188302319c8/numpy-2.2.6-cp313-cp313t-musllinux_1_2_x86_64.whl", hash = "sha256:8e9ace4a37db23421249ed236fdcdd457d671e25146786dfc96835cd951aa7c1", size = 18385260, upload-time = "2025-05-17T21:43:05.189Z" },
+    { url = "https://files.pythonhosted.org/packages/09/04/f2f83279d287407cf36a7a8053a5abe7be3622a4363337338f2585e4afda/numpy-2.2.6-cp313-cp313t-win32.whl", hash = "sha256:038613e9fb8c72b0a41f025a7e4c3f0b7a1b5d768ece4796b674c8f3fe13efff", size = 6377225, upload-time = "2025-05-17T21:43:16.254Z" },
+    { url = "https://files.pythonhosted.org/packages/67/0e/35082d13c09c02c011cf21570543d202ad929d961c02a147493cb0c2bdf5/numpy-2.2.6-cp313-cp313t-win_amd64.whl", hash = "sha256:6031dd6dfecc0cf9f668681a37648373bddd6421fff6c66ec1624eed0180ee06", size = 12771374, upload-time = "2025-05-17T21:43:35.479Z" },
+    { url = "https://files.pythonhosted.org/packages/9e/3b/d94a75f4dbf1ef5d321523ecac21ef23a3cd2ac8b78ae2aac40873590229/numpy-2.2.6-pp310-pypy310_pp73-macosx_10_15_x86_64.whl", hash = "sha256:0b605b275d7bd0c640cad4e5d30fa701a8d59302e127e5f79138ad62762c3e3d", size = 21040391, upload-time = "2025-05-17T21:44:35.948Z" },
+    { url = "https://files.pythonhosted.org/packages/17/f4/09b2fa1b58f0fb4f7c7963a1649c64c4d315752240377ed74d9cd878f7b5/numpy-2.2.6-pp310-pypy310_pp73-macosx_14_0_x86_64.whl", hash = "sha256:7befc596a7dc9da8a337f79802ee8adb30a552a94f792b9c9d18c840055907db", size = 6786754, upload-time = "2025-05-17T21:44:47.446Z" },
+    { url = "https://files.pythonhosted.org/packages/af/30/feba75f143bdc868a1cc3f44ccfa6c4b9ec522b36458e738cd00f67b573f/numpy-2.2.6-pp310-pypy310_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:ce47521a4754c8f4593837384bd3424880629f718d87c5d44f8ed763edd63543", size = 16643476, upload-time = "2025-05-17T21:45:11.871Z" },
+    { url = "https://files.pythonhosted.org/packages/37/48/ac2a9584402fb6c0cd5b5d1a91dcf176b15760130dd386bbafdbfe3640bf/numpy-2.2.6-pp310-pypy310_pp73-win_amd64.whl", hash = "sha256:d042d24c90c41b54fd506da306759e06e568864df8ec17ccc17e9e884634fd00", size = 12812666, upload-time = "2025-05-17T21:45:31.426Z" },
+]
+
+[[package]]
+name = "numpy"
+version = "2.3.3"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/d0/19/95b3d357407220ed24c139018d2518fab0a61a948e68286a25f1a4d049ff/numpy-2.3.3.tar.gz", hash = "sha256:ddc7c39727ba62b80dfdbedf400d1c10ddfa8eefbd7ec8dcb118be8b56d31029", size = 20576648, upload-time = "2025-09-09T16:54:12.543Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/7a/45/e80d203ef6b267aa29b22714fb558930b27960a0c5ce3c19c999232bb3eb/numpy-2.3.3-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:0ffc4f5caba7dfcbe944ed674b7eef683c7e94874046454bb79ed7ee0236f59d", size = 21259253, upload-time = "2025-09-09T15:56:02.094Z" },
+    { url = "https://files.pythonhosted.org/packages/52/18/cf2c648fccf339e59302e00e5f2bc87725a3ce1992f30f3f78c9044d7c43/numpy-2.3.3-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:e7e946c7170858a0295f79a60214424caac2ffdb0063d4d79cb681f9aa0aa569", size = 14450980, upload-time = "2025-09-09T15:56:05.926Z" },
+    { url = "https://files.pythonhosted.org/packages/93/fb/9af1082bec870188c42a1c239839915b74a5099c392389ff04215dcee812/numpy-2.3.3-cp311-cp311-macosx_14_0_arm64.whl", hash = "sha256:cd4260f64bc794c3390a63bf0728220dd1a68170c169088a1e0dfa2fde1be12f", size = 5379709, upload-time = "2025-09-09T15:56:07.95Z" },
+    { url = "https://files.pythonhosted.org/packages/75/0f/bfd7abca52bcbf9a4a65abc83fe18ef01ccdeb37bfb28bbd6ad613447c79/numpy-2.3.3-cp311-cp311-macosx_14_0_x86_64.whl", hash = "sha256:f0ddb4b96a87b6728df9362135e764eac3cfa674499943ebc44ce96c478ab125", size = 6913923, upload-time = "2025-09-09T15:56:09.443Z" },
+    { url = "https://files.pythonhosted.org/packages/79/55/d69adad255e87ab7afda1caf93ca997859092afeb697703e2f010f7c2e55/numpy-2.3.3-cp311-cp311-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:afd07d377f478344ec6ca2b8d4ca08ae8bd44706763d1efb56397de606393f48", size = 14589591, upload-time = "2025-09-09T15:56:11.234Z" },
+    { url = "https://files.pythonhosted.org/packages/10/a2/010b0e27ddeacab7839957d7a8f00e91206e0c2c47abbb5f35a2630e5387/numpy-2.3.3-cp311-cp311-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:bc92a5dedcc53857249ca51ef29f5e5f2f8c513e22cfb90faeb20343b8c6f7a6", size = 16938714, upload-time = "2025-09-09T15:56:14.637Z" },
+    { url = "https://files.pythonhosted.org/packages/1c/6b/12ce8ede632c7126eb2762b9e15e18e204b81725b81f35176eac14dc5b82/numpy-2.3.3-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:7af05ed4dc19f308e1d9fc759f36f21921eb7bbfc82843eeec6b2a2863a0aefa", size = 16370592, upload-time = "2025-09-09T15:56:17.285Z" },
+    { url = "https://files.pythonhosted.org/packages/b4/35/aba8568b2593067bb6a8fe4c52babb23b4c3b9c80e1b49dff03a09925e4a/numpy-2.3.3-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:433bf137e338677cebdd5beac0199ac84712ad9d630b74eceeb759eaa45ddf30", size = 18884474, upload-time = "2025-09-09T15:56:20.943Z" },
+    { url = "https://files.pythonhosted.org/packages/45/fa/7f43ba10c77575e8be7b0138d107e4f44ca4a1ef322cd16980ea3e8b8222/numpy-2.3.3-cp311-cp311-win32.whl", hash = "sha256:eb63d443d7b4ffd1e873f8155260d7f58e7e4b095961b01c91062935c2491e57", size = 6599794, upload-time = "2025-09-09T15:56:23.258Z" },
+    { url = "https://files.pythonhosted.org/packages/0a/a2/a4f78cb2241fe5664a22a10332f2be886dcdea8784c9f6a01c272da9b426/numpy-2.3.3-cp311-cp311-win_amd64.whl", hash = "sha256:ec9d249840f6a565f58d8f913bccac2444235025bbb13e9a4681783572ee3caa", size = 13088104, upload-time = "2025-09-09T15:56:25.476Z" },
+    { url = "https://files.pythonhosted.org/packages/79/64/e424e975adbd38282ebcd4891661965b78783de893b381cbc4832fb9beb2/numpy-2.3.3-cp311-cp311-win_arm64.whl", hash = "sha256:74c2a948d02f88c11a3c075d9733f1ae67d97c6bdb97f2bb542f980458b257e7", size = 10460772, upload-time = "2025-09-09T15:56:27.679Z" },
+    { url = "https://files.pythonhosted.org/packages/51/5d/bb7fc075b762c96329147799e1bcc9176ab07ca6375ea976c475482ad5b3/numpy-2.3.3-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:cfdd09f9c84a1a934cde1eec2267f0a43a7cd44b2cca4ff95b7c0d14d144b0bf", size = 20957014, upload-time = "2025-09-09T15:56:29.966Z" },
+    { url = "https://files.pythonhosted.org/packages/6b/0e/c6211bb92af26517acd52125a237a92afe9c3124c6a68d3b9f81b62a0568/numpy-2.3.3-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:cb32e3cf0f762aee47ad1ddc6672988f7f27045b0783c887190545baba73aa25", size = 14185220, upload-time = "2025-09-09T15:56:32.175Z" },
+    { url = "https://files.pythonhosted.org/packages/22/f2/07bb754eb2ede9073f4054f7c0286b0d9d2e23982e090a80d478b26d35ca/numpy-2.3.3-cp312-cp312-macosx_14_0_arm64.whl", hash = "sha256:396b254daeb0a57b1fe0ecb5e3cff6fa79a380fa97c8f7781a6d08cd429418fe", size = 5113918, upload-time = "2025-09-09T15:56:34.175Z" },
+    { url = "https://files.pythonhosted.org/packages/81/0a/afa51697e9fb74642f231ea36aca80fa17c8fb89f7a82abd5174023c3960/numpy-2.3.3-cp312-cp312-macosx_14_0_x86_64.whl", hash = "sha256:067e3d7159a5d8f8a0b46ee11148fc35ca9b21f61e3c49fbd0a027450e65a33b", size = 6647922, upload-time = "2025-09-09T15:56:36.149Z" },
+    { url = "https://files.pythonhosted.org/packages/5d/f5/122d9cdb3f51c520d150fef6e87df9279e33d19a9611a87c0d2cf78a89f4/numpy-2.3.3-cp312-cp312-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:1c02d0629d25d426585fb2e45a66154081b9fa677bc92a881ff1d216bc9919a8", size = 14281991, upload-time = "2025-09-09T15:56:40.548Z" },
+    { url = "https://files.pythonhosted.org/packages/51/64/7de3c91e821a2debf77c92962ea3fe6ac2bc45d0778c1cbe15d4fce2fd94/numpy-2.3.3-cp312-cp312-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:d9192da52b9745f7f0766531dcfa978b7763916f158bb63bdb8a1eca0068ab20", size = 16641643, upload-time = "2025-09-09T15:56:43.343Z" },
+    { url = "https://files.pythonhosted.org/packages/30/e4/961a5fa681502cd0d68907818b69f67542695b74e3ceaa513918103b7e80/numpy-2.3.3-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:cd7de500a5b66319db419dc3c345244404a164beae0d0937283b907d8152e6ea", size = 16056787, upload-time = "2025-09-09T15:56:46.141Z" },
+    { url = "https://files.pythonhosted.org/packages/99/26/92c912b966e47fbbdf2ad556cb17e3a3088e2e1292b9833be1dfa5361a1a/numpy-2.3.3-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:93d4962d8f82af58f0b2eb85daaf1b3ca23fe0a85d0be8f1f2b7bb46034e56d7", size = 18579598, upload-time = "2025-09-09T15:56:49.844Z" },
+    { url = "https://files.pythonhosted.org/packages/17/b6/fc8f82cb3520768718834f310c37d96380d9dc61bfdaf05fe5c0b7653e01/numpy-2.3.3-cp312-cp312-win32.whl", hash = "sha256:5534ed6b92f9b7dca6c0a19d6df12d41c68b991cef051d108f6dbff3babc4ebf", size = 6320800, upload-time = "2025-09-09T15:56:52.499Z" },
+    { url = "https://files.pythonhosted.org/packages/32/ee/de999f2625b80d043d6d2d628c07d0d5555a677a3cf78fdf868d409b8766/numpy-2.3.3-cp312-cp312-win_amd64.whl", hash = "sha256:497d7cad08e7092dba36e3d296fe4c97708c93daf26643a1ae4b03f6294d30eb", size = 12786615, upload-time = "2025-09-09T15:56:54.422Z" },
+    { url = "https://files.pythonhosted.org/packages/49/6e/b479032f8a43559c383acb20816644f5f91c88f633d9271ee84f3b3a996c/numpy-2.3.3-cp312-cp312-win_arm64.whl", hash = "sha256:ca0309a18d4dfea6fc6262a66d06c26cfe4640c3926ceec90e57791a82b6eee5", size = 10195936, upload-time = "2025-09-09T15:56:56.541Z" },
+    { url = "https://files.pythonhosted.org/packages/7d/b9/984c2b1ee61a8b803bf63582b4ac4242cf76e2dbd663efeafcb620cc0ccb/numpy-2.3.3-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:f5415fb78995644253370985342cd03572ef8620b934da27d77377a2285955bf", size = 20949588, upload-time = "2025-09-09T15:56:59.087Z" },
+    { url = "https://files.pythonhosted.org/packages/a6/e4/07970e3bed0b1384d22af1e9912527ecbeb47d3b26e9b6a3bced068b3bea/numpy-2.3.3-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:d00de139a3324e26ed5b95870ce63be7ec7352171bc69a4cf1f157a48e3eb6b7", size = 14177802, upload-time = "2025-09-09T15:57:01.73Z" },
+    { url = "https://files.pythonhosted.org/packages/35/c7/477a83887f9de61f1203bad89cf208b7c19cc9fef0cebef65d5a1a0619f2/numpy-2.3.3-cp313-cp313-macosx_14_0_arm64.whl", hash = "sha256:9dc13c6a5829610cc07422bc74d3ac083bd8323f14e2827d992f9e52e22cd6a6", size = 5106537, upload-time = "2025-09-09T15:57:03.765Z" },
+    { url = "https://files.pythonhosted.org/packages/52/47/93b953bd5866a6f6986344d045a207d3f1cfbad99db29f534ea9cee5108c/numpy-2.3.3-cp313-cp313-macosx_14_0_x86_64.whl", hash = "sha256:d79715d95f1894771eb4e60fb23f065663b2298f7d22945d66877aadf33d00c7", size = 6640743, upload-time = "2025-09-09T15:57:07.921Z" },
+    { url = "https://files.pythonhosted.org/packages/23/83/377f84aaeb800b64c0ef4de58b08769e782edcefa4fea712910b6f0afd3c/numpy-2.3.3-cp313-cp313-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:952cfd0748514ea7c3afc729a0fc639e61655ce4c55ab9acfab14bda4f402b4c", size = 14278881, upload-time = "2025-09-09T15:57:11.349Z" },
+    { url = "https://files.pythonhosted.org/packages/9a/a5/bf3db6e66c4b160d6ea10b534c381a1955dfab34cb1017ea93aa33c70ed3/numpy-2.3.3-cp313-cp313-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:5b83648633d46f77039c29078751f80da65aa64d5622a3cd62aaef9d835b6c93", size = 16636301, upload-time = "2025-09-09T15:57:14.245Z" },
+    { url = "https://files.pythonhosted.org/packages/a2/59/1287924242eb4fa3f9b3a2c30400f2e17eb2707020d1c5e3086fe7330717/numpy-2.3.3-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:b001bae8cea1c7dfdb2ae2b017ed0a6f2102d7a70059df1e338e307a4c78a8ae", size = 16053645, upload-time = "2025-09-09T15:57:16.534Z" },
+    { url = "https://files.pythonhosted.org/packages/e6/93/b3d47ed882027c35e94ac2320c37e452a549f582a5e801f2d34b56973c97/numpy-2.3.3-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:8e9aced64054739037d42fb84c54dd38b81ee238816c948c8f3ed134665dcd86", size = 18578179, upload-time = "2025-09-09T15:57:18.883Z" },
+    { url = "https://files.pythonhosted.org/packages/20/d9/487a2bccbf7cc9d4bfc5f0f197761a5ef27ba870f1e3bbb9afc4bbe3fcc2/numpy-2.3.3-cp313-cp313-win32.whl", hash = "sha256:9591e1221db3f37751e6442850429b3aabf7026d3b05542d102944ca7f00c8a8", size = 6312250, upload-time = "2025-09-09T15:57:21.296Z" },
+    { url = "https://files.pythonhosted.org/packages/1b/b5/263ebbbbcede85028f30047eab3d58028d7ebe389d6493fc95ae66c636ab/numpy-2.3.3-cp313-cp313-win_amd64.whl", hash = "sha256:f0dadeb302887f07431910f67a14d57209ed91130be0adea2f9793f1a4f817cf", size = 12783269, upload-time = "2025-09-09T15:57:23.034Z" },
+    { url = "https://files.pythonhosted.org/packages/fa/75/67b8ca554bbeaaeb3fac2e8bce46967a5a06544c9108ec0cf5cece559b6c/numpy-2.3.3-cp313-cp313-win_arm64.whl", hash = "sha256:3c7cf302ac6e0b76a64c4aecf1a09e51abd9b01fc7feee80f6c43e3ab1b1dbc5", size = 10195314, upload-time = "2025-09-09T15:57:25.045Z" },
+    { url = "https://files.pythonhosted.org/packages/11/d0/0d1ddec56b162042ddfafeeb293bac672de9b0cfd688383590090963720a/numpy-2.3.3-cp313-cp313t-macosx_10_13_x86_64.whl", hash = "sha256:eda59e44957d272846bb407aad19f89dc6f58fecf3504bd144f4c5cf81a7eacc", size = 21048025, upload-time = "2025-09-09T15:57:27.257Z" },
+    { url = "https://files.pythonhosted.org/packages/36/9e/1996ca6b6d00415b6acbdd3c42f7f03ea256e2c3f158f80bd7436a8a19f3/numpy-2.3.3-cp313-cp313t-macosx_11_0_arm64.whl", hash = "sha256:823d04112bc85ef5c4fda73ba24e6096c8f869931405a80aa8b0e604510a26bc", size = 14301053, upload-time = "2025-09-09T15:57:30.077Z" },
+    { url = "https://files.pythonhosted.org/packages/05/24/43da09aa764c68694b76e84b3d3f0c44cb7c18cdc1ba80e48b0ac1d2cd39/numpy-2.3.3-cp313-cp313t-macosx_14_0_arm64.whl", hash = "sha256:40051003e03db4041aa325da2a0971ba41cf65714e65d296397cc0e32de6018b", size = 5229444, upload-time = "2025-09-09T15:57:32.733Z" },
+    { url = "https://files.pythonhosted.org/packages/bc/14/50ffb0f22f7218ef8af28dd089f79f68289a7a05a208db9a2c5dcbe123c1/numpy-2.3.3-cp313-cp313t-macosx_14_0_x86_64.whl", hash = "sha256:6ee9086235dd6ab7ae75aba5662f582a81ced49f0f1c6de4260a78d8f2d91a19", size = 6738039, upload-time = "2025-09-09T15:57:34.328Z" },
+    { url = "https://files.pythonhosted.org/packages/55/52/af46ac0795e09657d45a7f4db961917314377edecf66db0e39fa7ab5c3d3/numpy-2.3.3-cp313-cp313t-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:94fcaa68757c3e2e668ddadeaa86ab05499a70725811e582b6a9858dd472fb30", size = 14352314, upload-time = "2025-09-09T15:57:36.255Z" },
+    { url = "https://files.pythonhosted.org/packages/a7/b1/dc226b4c90eb9f07a3fff95c2f0db3268e2e54e5cce97c4ac91518aee71b/numpy-2.3.3-cp313-cp313t-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:da1a74b90e7483d6ce5244053399a614b1d6b7bc30a60d2f570e5071f8959d3e", size = 16701722, upload-time = "2025-09-09T15:57:38.622Z" },
+    { url = "https://files.pythonhosted.org/packages/9d/9d/9d8d358f2eb5eced14dba99f110d83b5cd9a4460895230f3b396ad19a323/numpy-2.3.3-cp313-cp313t-musllinux_1_2_aarch64.whl", hash = "sha256:2990adf06d1ecee3b3dcbb4977dfab6e9f09807598d647f04d385d29e7a3c3d3", size = 16132755, upload-time = "2025-09-09T15:57:41.16Z" },
+    { url = "https://files.pythonhosted.org/packages/b6/27/b3922660c45513f9377b3fb42240bec63f203c71416093476ec9aa0719dc/numpy-2.3.3-cp313-cp313t-musllinux_1_2_x86_64.whl", hash = "sha256:ed635ff692483b8e3f0fcaa8e7eb8a75ee71aa6d975388224f70821421800cea", size = 18651560, upload-time = "2025-09-09T15:57:43.459Z" },
+    { url = "https://files.pythonhosted.org/packages/5b/8e/3ab61a730bdbbc201bb245a71102aa609f0008b9ed15255500a99cd7f780/numpy-2.3.3-cp313-cp313t-win32.whl", hash = "sha256:a333b4ed33d8dc2b373cc955ca57babc00cd6f9009991d9edc5ddbc1bac36bcd", size = 6442776, upload-time = "2025-09-09T15:57:45.793Z" },
+    { url = "https://files.pythonhosted.org/packages/1c/3a/e22b766b11f6030dc2decdeff5c2fb1610768055603f9f3be88b6d192fb2/numpy-2.3.3-cp313-cp313t-win_amd64.whl", hash = "sha256:4384a169c4d8f97195980815d6fcad04933a7e1ab3b530921c3fef7a1c63426d", size = 12927281, upload-time = "2025-09-09T15:57:47.492Z" },
+    { url = "https://files.pythonhosted.org/packages/7b/42/c2e2bc48c5e9b2a83423f99733950fbefd86f165b468a3d85d52b30bf782/numpy-2.3.3-cp313-cp313t-win_arm64.whl", hash = "sha256:75370986cc0bc66f4ce5110ad35aae6d182cc4ce6433c40ad151f53690130bf1", size = 10265275, upload-time = "2025-09-09T15:57:49.647Z" },
+    { url = "https://files.pythonhosted.org/packages/6b/01/342ad585ad82419b99bcf7cebe99e61da6bedb89e213c5fd71acc467faee/numpy-2.3.3-cp314-cp314-macosx_10_13_x86_64.whl", hash = "sha256:cd052f1fa6a78dee696b58a914b7229ecfa41f0a6d96dc663c1220a55e137593", size = 20951527, upload-time = "2025-09-09T15:57:52.006Z" },
+    { url = "https://files.pythonhosted.org/packages/ef/d8/204e0d73fc1b7a9ee80ab1fe1983dd33a4d64a4e30a05364b0208e9a241a/numpy-2.3.3-cp314-cp314-macosx_11_0_arm64.whl", hash = "sha256:414a97499480067d305fcac9716c29cf4d0d76db6ebf0bf3cbce666677f12652", size = 14186159, upload-time = "2025-09-09T15:57:54.407Z" },
+    { url = "https://files.pythonhosted.org/packages/22/af/f11c916d08f3a18fb8ba81ab72b5b74a6e42ead4c2846d270eb19845bf74/numpy-2.3.3-cp314-cp314-macosx_14_0_arm64.whl", hash = "sha256:50a5fe69f135f88a2be9b6ca0481a68a136f6febe1916e4920e12f1a34e708a7", size = 5114624, upload-time = "2025-09-09T15:57:56.5Z" },
+    { url = "https://files.pythonhosted.org/packages/fb/11/0ed919c8381ac9d2ffacd63fd1f0c34d27e99cab650f0eb6f110e6ae4858/numpy-2.3.3-cp314-cp314-macosx_14_0_x86_64.whl", hash = "sha256:b912f2ed2b67a129e6a601e9d93d4fa37bef67e54cac442a2f588a54afe5c67a", size = 6642627, upload-time = "2025-09-09T15:57:58.206Z" },
+    { url = "https://files.pythonhosted.org/packages/ee/83/deb5f77cb0f7ba6cb52b91ed388b47f8f3c2e9930d4665c600408d9b90b9/numpy-2.3.3-cp314-cp314-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:9e318ee0596d76d4cb3d78535dc005fa60e5ea348cd131a51e99d0bdbe0b54fe", size = 14296926, upload-time = "2025-09-09T15:58:00.035Z" },
+    { url = "https://files.pythonhosted.org/packages/77/cc/70e59dcb84f2b005d4f306310ff0a892518cc0c8000a33d0e6faf7ca8d80/numpy-2.3.3-cp314-cp314-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:ce020080e4a52426202bdb6f7691c65bb55e49f261f31a8f506c9f6bc7450421", size = 16638958, upload-time = "2025-09-09T15:58:02.738Z" },
+    { url = "https://files.pythonhosted.org/packages/b6/5a/b2ab6c18b4257e099587d5b7f903317bd7115333ad8d4ec4874278eafa61/numpy-2.3.3-cp314-cp314-musllinux_1_2_aarch64.whl", hash = "sha256:e6687dc183aa55dae4a705b35f9c0f8cb178bcaa2f029b241ac5356221d5c021", size = 16071920, upload-time = "2025-09-09T15:58:05.029Z" },
+    { url = "https://files.pythonhosted.org/packages/b8/f1/8b3fdc44324a259298520dd82147ff648979bed085feeacc1250ef1656c0/numpy-2.3.3-cp314-cp314-musllinux_1_2_x86_64.whl", hash = "sha256:d8f3b1080782469fdc1718c4ed1d22549b5fb12af0d57d35e992158a772a37cf", size = 18577076, upload-time = "2025-09-09T15:58:07.745Z" },
+    { url = "https://files.pythonhosted.org/packages/f0/a1/b87a284fb15a42e9274e7fcea0dad259d12ddbf07c1595b26883151ca3b4/numpy-2.3.3-cp314-cp314-win32.whl", hash = "sha256:cb248499b0bc3be66ebd6578b83e5acacf1d6cb2a77f2248ce0e40fbec5a76d0", size = 6366952, upload-time = "2025-09-09T15:58:10.096Z" },
+    { url = "https://files.pythonhosted.org/packages/70/5f/1816f4d08f3b8f66576d8433a66f8fa35a5acfb3bbd0bf6c31183b003f3d/numpy-2.3.3-cp314-cp314-win_amd64.whl", hash = "sha256:691808c2b26b0f002a032c73255d0bd89751425f379f7bcd22d140db593a96e8", size = 12919322, upload-time = "2025-09-09T15:58:12.138Z" },
+    { url = "https://files.pythonhosted.org/packages/8c/de/072420342e46a8ea41c324a555fa90fcc11637583fb8df722936aed1736d/numpy-2.3.3-cp314-cp314-win_arm64.whl", hash = "sha256:9ad12e976ca7b10f1774b03615a2a4bab8addce37ecc77394d8e986927dc0dfe", size = 10478630, upload-time = "2025-09-09T15:58:14.64Z" },
+    { url = "https://files.pythonhosted.org/packages/d5/df/ee2f1c0a9de7347f14da5dd3cd3c3b034d1b8607ccb6883d7dd5c035d631/numpy-2.3.3-cp314-cp314t-macosx_10_13_x86_64.whl", hash = "sha256:9cc48e09feb11e1db00b320e9d30a4151f7369afb96bd0e48d942d09da3a0d00", size = 21047987, upload-time = "2025-09-09T15:58:16.889Z" },
+    { url = "https://files.pythonhosted.org/packages/d6/92/9453bdc5a4e9e69cf4358463f25e8260e2ffc126d52e10038b9077815989/numpy-2.3.3-cp314-cp314t-macosx_11_0_arm64.whl", hash = "sha256:901bf6123879b7f251d3631967fd574690734236075082078e0571977c6a8e6a", size = 14301076, upload-time = "2025-09-09T15:58:20.343Z" },
+    { url = "https://files.pythonhosted.org/packages/13/77/1447b9eb500f028bb44253105bd67534af60499588a5149a94f18f2ca917/numpy-2.3.3-cp314-cp314t-macosx_14_0_arm64.whl", hash = "sha256:7f025652034199c301049296b59fa7d52c7e625017cae4c75d8662e377bf487d", size = 5229491, upload-time = "2025-09-09T15:58:22.481Z" },
+    { url = "https://files.pythonhosted.org/packages/3d/f9/d72221b6ca205f9736cb4b2ce3b002f6e45cd67cd6a6d1c8af11a2f0b649/numpy-2.3.3-cp314-cp314t-macosx_14_0_x86_64.whl", hash = "sha256:533ca5f6d325c80b6007d4d7fb1984c303553534191024ec6a524a4c92a5935a", size = 6737913, upload-time = "2025-09-09T15:58:24.569Z" },
+    { url = "https://files.pythonhosted.org/packages/3c/5f/d12834711962ad9c46af72f79bb31e73e416ee49d17f4c797f72c96b6ca5/numpy-2.3.3-cp314-cp314t-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:0edd58682a399824633b66885d699d7de982800053acf20be1eaa46d92009c54", size = 14352811, upload-time = "2025-09-09T15:58:26.416Z" },
+    { url = "https://files.pythonhosted.org/packages/a1/0d/fdbec6629d97fd1bebed56cd742884e4eead593611bbe1abc3eb40d304b2/numpy-2.3.3-cp314-cp314t-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:367ad5d8fbec5d9296d18478804a530f1191e24ab4d75ab408346ae88045d25e", size = 16702689, upload-time = "2025-09-09T15:58:28.831Z" },
+    { url = "https://files.pythonhosted.org/packages/9b/09/0a35196dc5575adde1eb97ddfbc3e1687a814f905377621d18ca9bc2b7dd/numpy-2.3.3-cp314-cp314t-musllinux_1_2_aarch64.whl", hash = "sha256:8f6ac61a217437946a1fa48d24c47c91a0c4f725237871117dea264982128097", size = 16133855, upload-time = "2025-09-09T15:58:31.349Z" },
+    { url = "https://files.pythonhosted.org/packages/7a/ca/c9de3ea397d576f1b6753eaa906d4cdef1bf97589a6d9825a349b4729cc2/numpy-2.3.3-cp314-cp314t-musllinux_1_2_x86_64.whl", hash = "sha256:179a42101b845a816d464b6fe9a845dfaf308fdfc7925387195570789bb2c970", size = 18652520, upload-time = "2025-09-09T15:58:33.762Z" },
+    { url = "https://files.pythonhosted.org/packages/fd/c2/e5ed830e08cd0196351db55db82f65bc0ab05da6ef2b72a836dcf1936d2f/numpy-2.3.3-cp314-cp314t-win32.whl", hash = "sha256:1250c5d3d2562ec4174bce2e3a1523041595f9b651065e4a4473f5f48a6bc8a5", size = 6515371, upload-time = "2025-09-09T15:58:36.04Z" },
+    { url = "https://files.pythonhosted.org/packages/47/c7/b0f6b5b67f6788a0725f744496badbb604d226bf233ba716683ebb47b570/numpy-2.3.3-cp314-cp314t-win_amd64.whl", hash = "sha256:b37a0b2e5935409daebe82c1e42274d30d9dd355852529eab91dab8dcca7419f", size = 13112576, upload-time = "2025-09-09T15:58:37.927Z" },
+    { url = "https://files.pythonhosted.org/packages/06/b9/33bba5ff6fb679aa0b1f8a07e853f002a6b04b9394db3069a1270a7784ca/numpy-2.3.3-cp314-cp314t-win_arm64.whl", hash = "sha256:78c9f6560dc7e6b3990e32df7ea1a50bbd0e2a111e05209963f5ddcab7073b0b", size = 10545953, upload-time = "2025-09-09T15:58:40.576Z" },
+    { url = "https://files.pythonhosted.org/packages/b8/f2/7e0a37cfced2644c9563c529f29fa28acbd0960dde32ece683aafa6f4949/numpy-2.3.3-pp311-pypy311_pp73-macosx_10_15_x86_64.whl", hash = "sha256:1e02c7159791cd481e1e6d5ddd766b62a4d5acf8df4d4d1afe35ee9c5c33a41e", size = 21131019, upload-time = "2025-09-09T15:58:42.838Z" },
+    { url = "https://files.pythonhosted.org/packages/1a/7e/3291f505297ed63831135a6cc0f474da0c868a1f31b0dd9a9f03a7a0d2ed/numpy-2.3.3-pp311-pypy311_pp73-macosx_11_0_arm64.whl", hash = "sha256:dca2d0fc80b3893ae72197b39f69d55a3cd8b17ea1b50aa4c62de82419936150", size = 14376288, upload-time = "2025-09-09T15:58:45.425Z" },
+    { url = "https://files.pythonhosted.org/packages/bf/4b/ae02e985bdeee73d7b5abdefeb98aef1207e96d4c0621ee0cf228ddfac3c/numpy-2.3.3-pp311-pypy311_pp73-macosx_14_0_arm64.whl", hash = "sha256:99683cbe0658f8271b333a1b1b4bb3173750ad59c0c61f5bbdc5b318918fffe3", size = 5305425, upload-time = "2025-09-09T15:58:48.6Z" },
+    { url = "https://files.pythonhosted.org/packages/8b/eb/9df215d6d7250db32007941500dc51c48190be25f2401d5b2b564e467247/numpy-2.3.3-pp311-pypy311_pp73-macosx_14_0_x86_64.whl", hash = "sha256:d9d537a39cc9de668e5cd0e25affb17aec17b577c6b3ae8a3d866b479fbe88d0", size = 6819053, upload-time = "2025-09-09T15:58:50.401Z" },
+    { url = "https://files.pythonhosted.org/packages/57/62/208293d7d6b2a8998a4a1f23ac758648c3c32182d4ce4346062018362e29/numpy-2.3.3-pp311-pypy311_pp73-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:8596ba2f8af5f93b01d97563832686d20206d303024777f6dfc2e7c7c3f1850e", size = 14420354, upload-time = "2025-09-09T15:58:52.704Z" },
+    { url = "https://files.pythonhosted.org/packages/ed/0c/8e86e0ff7072e14a71b4c6af63175e40d1e7e933ce9b9e9f765a95b4e0c3/numpy-2.3.3-pp311-pypy311_pp73-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:e1ec5615b05369925bd1125f27df33f3b6c8bc10d788d5999ecd8769a1fa04db", size = 16760413, upload-time = "2025-09-09T15:58:55.027Z" },
+    { url = "https://files.pythonhosted.org/packages/af/11/0cc63f9f321ccf63886ac203336777140011fb669e739da36d8db3c53b98/numpy-2.3.3-pp311-pypy311_pp73-win_amd64.whl", hash = "sha256:2e267c7da5bf7309670523896df97f93f6e469fb931161f483cd6882b3b1a5dc", size = 12971844, upload-time = "2025-09-09T15:58:57.359Z" },
+]
+
+[[package]]
+name = "nvidia-cublas-cu12"
+version = "12.9.1.4"
+source = { registry = "https://pypi.org/simple" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/77/3c/aa88abe01f3be3d1f8f787d1d33dc83e76fec05945f9a28fbb41cfb99cd5/nvidia_cublas_cu12-12.9.1.4-py3-none-manylinux_2_27_x86_64.whl", hash = "sha256:453611eb21a7c1f2c2156ed9f3a45b691deda0440ec550860290dc901af5b4c2", size = 581242350, upload-time = "2025-06-05T20:04:51.979Z" },
+]
+
+[[package]]
+name = "nvidia-cuda-cupti-cu12"
+version = "12.9.79"
+source = { registry = "https://pypi.org/simple" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/c1/2e/b84e32197e33f39907b455b83395a017e697c07a449a2b15fd07fc1c9981/nvidia_cuda_cupti_cu12-12.9.79-py3-none-manylinux_2_25_x86_64.whl", hash = "sha256:096bcf334f13e1984ba36685ad4c1d6347db214de03dbb6eebb237b41d9d934f", size = 10814997, upload-time = "2025-06-05T20:01:10.168Z" },
+]
+
+[[package]]
+name = "nvidia-cuda-nvrtc-cu12"
+version = "12.9.86"
+source = { registry = "https://pypi.org/simple" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/b8/85/e4af82cc9202023862090bfca4ea827d533329e925c758f0cde964cb54b7/nvidia_cuda_nvrtc_cu12-12.9.86-py3-none-manylinux2010_x86_64.manylinux_2_12_x86_64.whl", hash = "sha256:210cf05005a447e29214e9ce50851e83fc5f4358df8b453155d5e1918094dcb4", size = 89568129, upload-time = "2025-06-05T20:02:41.973Z" },
+]
+
+[[package]]
+name = "nvidia-cuda-runtime-cu12"
+version = "12.9.79"
+source = { registry = "https://pypi.org/simple" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/bc/46/a92db19b8309581092a3add7e6fceb4c301a3fd233969856a8cbf042cd3c/nvidia_cuda_runtime_cu12-12.9.79-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:25bba2dfb01d48a9b59ca474a1ac43c6ebf7011f1b0b8cc44f54eb6ac48a96c3", size = 3493179, upload-time = "2025-06-05T20:00:53.735Z" },
+]
+
+[[package]]
+name = "nvidia-cudnn-cu12"
+version = "9.10.2.21"
+source = { registry = "https://pypi.org/simple" }
+dependencies = [
+    { name = "nvidia-cublas-cu12", marker = "python_full_version >= '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'" },
+]
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/ba/51/e123d997aa098c61d029f76663dedbfb9bc8dcf8c60cbd6adbe42f76d049/nvidia_cudnn_cu12-9.10.2.21-py3-none-manylinux_2_27_x86_64.whl", hash = "sha256:949452be657fa16687d0930933f032835951ef0892b37d2d53824d1a84dc97a8", size = 706758467, upload-time = "2025-06-06T21:54:08.597Z" },
+]
+
+[[package]]
+name = "nvidia-cufft-cu12"
+version = "11.4.1.4"
+source = { registry = "https://pypi.org/simple" }
+dependencies = [
+    { name = "nvidia-nvjitlink-cu12", marker = "python_full_version >= '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'" },
+]
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/95/f4/61e6996dd20481ee834f57a8e9dca28b1869366a135e0d42e2aa8493bdd4/nvidia_cufft_cu12-11.4.1.4-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:c67884f2a7d276b4b80eb56a79322a95df592ae5e765cf1243693365ccab4e28", size = 200877592, upload-time = "2025-06-05T20:05:45.862Z" },
+]
+
+[[package]]
+name = "nvidia-cufile-cu12"
+version = "1.14.1.1"
+source = { registry = "https://pypi.org/simple" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/ad/28/b960e06d705a440c030edd84e16888ee14c743390bdb2a6368e92ffe8ef8/nvidia_cufile_cu12-1.14.1.1-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:9552e2231792e94b1ff17bc99e958cc0e6bbbaa4a9d91fa2dbeed97716628fe6", size = 1210714, upload-time = "2025-06-05T20:06:11.898Z" },
+]
+
+[[package]]
+name = "nvidia-curand-cu12"
+version = "10.3.10.19"
+source = { registry = "https://pypi.org/simple" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/31/44/193a0e171750ca9f8320626e8a1f2381e4077a65e69e2fb9708bd479e34a/nvidia_curand_cu12-10.3.10.19-py3-none-manylinux_2_27_x86_64.whl", hash = "sha256:49b274db4780d421bd2ccd362e1415c13887c53c214f0d4b761752b8f9f6aa1e", size = 68295626, upload-time = "2025-05-01T19:39:38.885Z" },
+]
+
+[[package]]
+name = "nvidia-cusolver-cu12"
+version = "11.7.5.82"
+source = { registry = "https://pypi.org/simple" }
+dependencies = [
+    { name = "nvidia-cublas-cu12", marker = "python_full_version >= '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'" },
+    { name = "nvidia-cusparse-cu12", marker = "python_full_version >= '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'" },
+    { name = "nvidia-nvjitlink-cu12", marker = "python_full_version >= '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'" },
+]
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/33/40/79b0c64d44d6c166c0964ec1d803d067f4a145cca23e23925fd351d0e642/nvidia_cusolver_cu12-11.7.5.82-py3-none-manylinux_2_27_x86_64.whl", hash = "sha256:15da72d1340d29b5b3cf3fd100e3cd53421dde36002eda6ed93811af63c40d88", size = 338117415, upload-time = "2025-06-05T20:07:16.809Z" },
+]
+
+[[package]]
+name = "nvidia-cusparse-cu12"
+version = "12.5.10.65"
+source = { registry = "https://pypi.org/simple" }
+dependencies = [
+    { name = "nvidia-nvjitlink-cu12", marker = "python_full_version >= '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'" },
+]
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/12/46/b0fd4b04f86577921feb97d8e2cf028afe04f614d17fb5013de9282c9216/nvidia_cusparse_cu12-12.5.10.65-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:73060ce019ac064a057267c585bf1fd5a353734151f87472ff02b2c5c9984e78", size = 366465088, upload-time = "2025-06-05T20:08:20.413Z" },
+]
+
+[[package]]
+name = "nvidia-cusparselt-cu12"
+version = "0.7.1"
+source = { registry = "https://pypi.org/simple" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/56/79/12978b96bd44274fe38b5dde5cfb660b1d114f70a65ef962bcbbed99b549/nvidia_cusparselt_cu12-0.7.1-py3-none-manylinux2014_x86_64.whl", hash = "sha256:f1bb701d6b930d5a7cea44c19ceb973311500847f81b634d802b7b539dc55623", size = 287193691, upload-time = "2025-02-26T00:15:44.104Z" },
+]
+
+[[package]]
+name = "nvidia-nccl-cu12"
+version = "2.27.3"
+source = { registry = "https://pypi.org/simple" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/5c/5b/4e4fff7bad39adf89f735f2bc87248c81db71205b62bcc0d5ca5b606b3c3/nvidia_nccl_cu12-2.27.3-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:adf27ccf4238253e0b826bce3ff5fa532d65fc42322c8bfdfaf28024c0fbe039", size = 322364134, upload-time = "2025-06-03T21:58:04.013Z" },
+]
+
+[[package]]
+name = "nvidia-nvjitlink-cu12"
+version = "12.9.86"
+source = { registry = "https://pypi.org/simple" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/46/0c/c75bbfb967457a0b7670b8ad267bfc4fffdf341c074e0a80db06c24ccfd4/nvidia_nvjitlink_cu12-12.9.86-py3-none-manylinux2010_x86_64.manylinux_2_12_x86_64.whl", hash = "sha256:e3f1171dbdc83c5932a45f0f4c99180a70de9bd2718c1ab77d14104f6d7147f9", size = 39748338, upload-time = "2025-06-05T20:10:25.613Z" },
+]
+
+[[package]]
+name = "nvidia-nvtx-cu12"
+version = "12.9.79"
+source = { registry = "https://pypi.org/simple" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/86/ed/bb230dce7741f2778ba2ae3e8778fdb8bc58eee9fd95f07bf7b2d18e8081/nvidia_nvtx_cu12-12.9.79-py3-none-manylinux1_x86_64.manylinux_2_5_x86_64.whl", hash = "sha256:fec150986817f2b4e7eed72ed059f2dcb9ba3856b9a96134e448eac946a6952f", size = 85504, upload-time = "2025-06-05T20:03:10.21Z" },
+]
+
+[[package]]
+name = "nvidia-sphinx-theme"
+version = "0.0.5.post1"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "pydata-sphinx-theme", marker = "python_full_version == '3.9.*'" },
+    { name = "sphinx", version = "7.4.7", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+]
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/5b/3f/d5234ab4d186097782d4a9a1980d17912564eeb4d05f7587064c7956f034/nvidia_sphinx_theme-0.0.5.post1-py3-none-any.whl", hash = "sha256:16f4d7e69b2cd25db3bbdaae7daadbf7f49fafa060f6897582cf35a57f12d379", size = 134159, upload-time = "2024-11-04T16:36:27.127Z" },
+]
+
+[[package]]
+name = "nvidia-sphinx-theme"
+version = "0.0.8"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "pydata-sphinx-theme", marker = "python_full_version >= '3.10'" },
+    { name = "sphinx", version = "8.1.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.10.*'" },
+    { name = "sphinx", version = "8.2.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.11'" },
+]
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/dd/74/996dbc314da8ed670cd5e040d0b4b5be79ff1fc3db3fe25e63134deebe9a/nvidia_sphinx_theme-0.0.8-py3-none-any.whl", hash = "sha256:18f117aa154a3a156251a75647279c541464f3e75f7df2ae283e720cc7d0bc2c", size = 140678, upload-time = "2025-03-24T21:56:25.621Z" },
+]
+
+[[package]]
+name = "nvtx"
+version = "0.2.13"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/97/02/b3fd3da4ba51764cfc0e4d2b22d5a61511fa79d825344d4704f8429c0bd6/nvtx-0.2.13.tar.gz", hash = "sha256:9db7ba135168e14e1f038866100bf8ed42d3e00b404e9bc7b6280ee3af828b92", size = 112104, upload-time = "2025-08-05T03:27:16.383Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/53/64/d27e344632116da937100a81054c88b0fd6a259de09d6778e03e8231216b/nvtx-0.2.13-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:462bdcc65a12b53bfa3e7df564ddfb72092a030a923dccd1cf88c4b771ecae3f", size = 470534, upload-time = "2025-08-04T19:36:19.389Z" },
+    { url = "https://files.pythonhosted.org/packages/34/15/0b56e9b3020613d7d167bc4cdee3ba8686f6320c6aa62e85ed17b54c4dcb/nvtx-0.2.13-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:7874534af889ab7c2c63554c73119d193d2beb7671b551b7f43de5b97ceb5971", size = 474158, upload-time = "2025-08-04T19:39:39.801Z" },
+    { url = "https://files.pythonhosted.org/packages/2b/be/e00ab0d21f4fb46ad66b0eae89d9e9f7d53af65a37c3db2414a590e05e97/nvtx-0.2.13-cp310-cp310-win_amd64.whl", hash = "sha256:4f26d04b5ea5b96096941cb9a7115a73454e9e9d5c247bfcd34ec584559cf9dd", size = 99104, upload-time = "2025-08-04T19:24:01.775Z" },
+    { url = "https://files.pythonhosted.org/packages/22/02/f74e26cedbdb136440d1234a646cedfddf9a43d19586e1ee466d6275e6b6/nvtx-0.2.13-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:1ad794a0c046ef268b2fb3b6812a35bb3bce5cd19207d164689943f0031ac45f", size = 522330, upload-time = "2025-08-04T19:34:49.075Z" },
+    { url = "https://files.pythonhosted.org/packages/1d/55/e1e43201959dd854005c72b8a13ec86b775c349cdcb1d23423d841bbad58/nvtx-0.2.13-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:5640ca4b8be2c19a8fc4ca8403d3c2598165ea27541940b4897138a7b0a717fe", size = 522841, upload-time = "2025-08-04T19:38:27.819Z" },
+    { url = "https://files.pythonhosted.org/packages/a9/8c/89d1f499a4880e30e0b5bdf429cbd1d8c612d09c49c13016384ce9cd156d/nvtx-0.2.13-cp311-cp311-win_amd64.whl", hash = "sha256:be6d53143cb2bd44e04aecdb7f3b34b48ded96f3673ae41362239d9f54bcfe27", size = 99106, upload-time = "2025-08-04T19:22:49.181Z" },
+    { url = "https://files.pythonhosted.org/packages/c5/73/ad21e09dc2534f1e9723bbe5871fa5f03361ac51ca4d411fea6f765b5b6a/nvtx-0.2.13-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:3435cbbffa132f6aaba3abdb01e71a1b961a20858b4cb791883895a25b9305d6", size = 539358, upload-time = "2025-08-04T19:33:16.494Z" },
+    { url = "https://files.pythonhosted.org/packages/12/ab/762da984e7671f7c34ae87e5b70523c3eeb4563759268bfaea07c97f32a6/nvtx-0.2.13-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:453d838dd1424a04303281ee57a73e2b8dca0e03039bc609a945861b8fe7d7d9", size = 545588, upload-time = "2025-08-04T19:37:40.64Z" },
+    { url = "https://files.pythonhosted.org/packages/2a/b6/55bc5916386db70b93cbf543b1e880ead786d9ff0cdcfa262f5a2af46c74/nvtx-0.2.13-cp312-cp312-win_amd64.whl", hash = "sha256:0722d743e0e41e1fb866ebe6446e0cd0d268ca8671313f8da4f8c969956b74d3", size = 99123, upload-time = "2025-08-04T19:24:24.391Z" },
+    { url = "https://files.pythonhosted.org/packages/41/73/98c0669d5f9387a36d56b0e62ea3919124dd8dd7582d896ed1cae2998f57/nvtx-0.2.13-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:a1561d2111c698b1b1075899ff9c3fa7ba83603fc27c2e8ef567de6bbbe85ce1", size = 519840, upload-time = "2025-08-04T19:34:00.877Z" },
+    { url = "https://files.pythonhosted.org/packages/14/4b/21e975997def8a387543ba2bbe227551ad466781c39fc67f37f53555f37e/nvtx-0.2.13-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:edd7b729ed0211350258a21dd13422f59bc521de2b2fd21feb6c177af492f4e1", size = 524711, upload-time = "2025-08-04T19:38:03.559Z" },
+    { url = "https://files.pythonhosted.org/packages/21/d7/0ca146afd875f1e02636323840960071f768b5d8ba3e7d37f2ac9192bfd9/nvtx-0.2.13-cp313-cp313-win_amd64.whl", hash = "sha256:f0524bb71443d5a1f19a6409a9a81405fc437e53c5edfc4c44b6f4504ccf46e3", size = 97317, upload-time = "2025-08-04T19:24:46.391Z" },
+    { url = "https://files.pythonhosted.org/packages/75/af/4d474ba546dc344e80df906ab3af61882eb8a7fa2e3c568f6e2b6be36a26/nvtx-0.2.13-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:88286e7f1bb098704b8fd58a08a1b0c0fd41843275bf23badb5e32f59e0b38b9", size = 478309, upload-time = "2025-08-04T19:35:32.145Z" },
+    { url = "https://files.pythonhosted.org/packages/e7/f8/85a2411fc500f081526a201e66c31510432a64621d1357154a0d219f1482/nvtx-0.2.13-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:3ae27d5a2049f72b53bf6c061c3c8badeb8c33758b3eb31a888cca7afbbe3114", size = 481812, upload-time = "2025-08-04T19:39:15.221Z" },
+    { url = "https://files.pythonhosted.org/packages/dc/6f/60894b3a20662d9c899a53fad153462195f112623676e4d5c159bf60b136/nvtx-0.2.13-cp38-cp38-win_amd64.whl", hash = "sha256:e759bf6d97ff7a134cf290b251c4d55154a707d80131a00c043942e22caab089", size = 100275, upload-time = "2025-08-04T19:23:35.492Z" },
+    { url = "https://files.pythonhosted.org/packages/d3/f3/d788df3c077ad02906ee98c789a75082f81ae687b55450d059e1ef8b4218/nvtx-0.2.13-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:18634cffbcebd535c8e7c2cbac86a3e3313bd23975d7c3e811e063fbc0b6cb88", size = 476916, upload-time = "2025-08-04T19:37:04.942Z" },
+    { url = "https://files.pythonhosted.org/packages/9e/d5/e7a24077fbfb3ac28620fc06b07a9ef3dbc44d3a17b7c57756b70ea19f48/nvtx-0.2.13-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:9ffa37591353296c1a81130d8231c6550ba5faf2f8e2fc87b851f69446a836cf", size = 479947, upload-time = "2025-08-04T19:38:51.362Z" },
+    { url = "https://files.pythonhosted.org/packages/bd/66/7aadfc045e6199d44e3103c7f5c8ea83185a562970d1d3d383acef3eee7c/nvtx-0.2.13-cp39-cp39-win_amd64.whl", hash = "sha256:65ba8e3d81bf34cb363042787b8e2189cda6af38749374997a36262e2219105e", size = 100154, upload-time = "2025-08-04T19:23:12.672Z" },
+]
+
+[[package]]
+name = "packaging"
+version = "25.0"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/a1/d4/1fc4078c65507b51b96ca8f8c3ba19e6a61c8253c72794544580a7b6c24d/packaging-25.0.tar.gz", hash = "sha256:d443872c98d677bf60f6a1f2f8c1cb748e8fe762d2bf9d3148b5599295b0fc4f", size = 165727, upload-time = "2025-04-19T11:48:59.673Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/20/12/38679034af332785aac8774540895e234f4d07f7545804097de4b666afd8/packaging-25.0-py3-none-any.whl", hash = "sha256:29572ef2b1f17581046b3a2227d5c611fb25ec70ca1ba8554b24b0e69331a484", size = 66469, upload-time = "2025-04-19T11:48:57.875Z" },
+]
+
+[[package]]
+name = "pillow"
+version = "10.4.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/cd/74/ad3d526f3bf7b6d3f408b73fde271ec69dfac8b81341a318ce825f2b3812/pillow-10.4.0.tar.gz", hash = "sha256:166c1cd4d24309b30d61f79f4a9114b7b2313d7450912277855ff5dfd7cd4a06", size = 46555059, upload-time = "2024-07-01T09:48:43.583Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/0e/69/a31cccd538ca0b5272be2a38347f8839b97a14be104ea08b0db92f749c74/pillow-10.4.0-cp310-cp310-macosx_10_10_x86_64.whl", hash = "sha256:4d9667937cfa347525b319ae34375c37b9ee6b525440f3ef48542fcf66f2731e", size = 3509271, upload-time = "2024-07-01T09:45:22.07Z" },
+    { url = "https://files.pythonhosted.org/packages/9a/9e/4143b907be8ea0bce215f2ae4f7480027473f8b61fcedfda9d851082a5d2/pillow-10.4.0-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:543f3dc61c18dafb755773efc89aae60d06b6596a63914107f75459cf984164d", size = 3375658, upload-time = "2024-07-01T09:45:25.292Z" },
+    { url = "https://files.pythonhosted.org/packages/8a/25/1fc45761955f9359b1169aa75e241551e74ac01a09f487adaaf4c3472d11/pillow-10.4.0-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:7928ecbf1ece13956b95d9cbcfc77137652b02763ba384d9ab508099a2eca856", size = 4332075, upload-time = "2024-07-01T09:45:27.94Z" },
+    { url = "https://files.pythonhosted.org/packages/5e/dd/425b95d0151e1d6c951f45051112394f130df3da67363b6bc75dc4c27aba/pillow-10.4.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:e4d49b85c4348ea0b31ea63bc75a9f3857869174e2bf17e7aba02945cd218e6f", size = 4444808, upload-time = "2024-07-01T09:45:30.305Z" },
+    { url = "https://files.pythonhosted.org/packages/b1/84/9a15cc5726cbbfe7f9f90bfb11f5d028586595907cd093815ca6644932e3/pillow-10.4.0-cp310-cp310-manylinux_2_28_aarch64.whl", hash = "sha256:6c762a5b0997f5659a5ef2266abc1d8851ad7749ad9a6a5506eb23d314e4f46b", size = 4356290, upload-time = "2024-07-01T09:45:32.868Z" },
+    { url = "https://files.pythonhosted.org/packages/b5/5b/6651c288b08df3b8c1e2f8c1152201e0b25d240e22ddade0f1e242fc9fa0/pillow-10.4.0-cp310-cp310-manylinux_2_28_x86_64.whl", hash = "sha256:a985e028fc183bf12a77a8bbf36318db4238a3ded7fa9df1b9a133f1cb79f8fc", size = 4525163, upload-time = "2024-07-01T09:45:35.279Z" },
+    { url = "https://files.pythonhosted.org/packages/07/8b/34854bf11a83c248505c8cb0fcf8d3d0b459a2246c8809b967963b6b12ae/pillow-10.4.0-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:812f7342b0eee081eaec84d91423d1b4650bb9828eb53d8511bcef8ce5aecf1e", size = 4463100, upload-time = "2024-07-01T09:45:37.74Z" },
+    { url = "https://files.pythonhosted.org/packages/78/63/0632aee4e82476d9cbe5200c0cdf9ba41ee04ed77887432845264d81116d/pillow-10.4.0-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:ac1452d2fbe4978c2eec89fb5a23b8387aba707ac72810d9490118817d9c0b46", size = 4592880, upload-time = "2024-07-01T09:45:39.89Z" },
+    { url = "https://files.pythonhosted.org/packages/df/56/b8663d7520671b4398b9d97e1ed9f583d4afcbefbda3c6188325e8c297bd/pillow-10.4.0-cp310-cp310-win32.whl", hash = "sha256:bcd5e41a859bf2e84fdc42f4edb7d9aba0a13d29a2abadccafad99de3feff984", size = 2235218, upload-time = "2024-07-01T09:45:42.771Z" },
+    { url = "https://files.pythonhosted.org/packages/f4/72/0203e94a91ddb4a9d5238434ae6c1ca10e610e8487036132ea9bf806ca2a/pillow-10.4.0-cp310-cp310-win_amd64.whl", hash = "sha256:ecd85a8d3e79cd7158dec1c9e5808e821feea088e2f69a974db5edf84dc53141", size = 2554487, upload-time = "2024-07-01T09:45:45.176Z" },
+    { url = "https://files.pythonhosted.org/packages/bd/52/7e7e93d7a6e4290543f17dc6f7d3af4bd0b3dd9926e2e8a35ac2282bc5f4/pillow-10.4.0-cp310-cp310-win_arm64.whl", hash = "sha256:ff337c552345e95702c5fde3158acb0625111017d0e5f24bf3acdb9cc16b90d1", size = 2243219, upload-time = "2024-07-01T09:45:47.274Z" },
+    { url = "https://files.pythonhosted.org/packages/a7/62/c9449f9c3043c37f73e7487ec4ef0c03eb9c9afc91a92b977a67b3c0bbc5/pillow-10.4.0-cp311-cp311-macosx_10_10_x86_64.whl", hash = "sha256:0a9ec697746f268507404647e531e92889890a087e03681a3606d9b920fbee3c", size = 3509265, upload-time = "2024-07-01T09:45:49.812Z" },
+    { url = "https://files.pythonhosted.org/packages/f4/5f/491dafc7bbf5a3cc1845dc0430872e8096eb9e2b6f8161509d124594ec2d/pillow-10.4.0-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:dfe91cb65544a1321e631e696759491ae04a2ea11d36715eca01ce07284738be", size = 3375655, upload-time = "2024-07-01T09:45:52.462Z" },
+    { url = "https://files.pythonhosted.org/packages/73/d5/c4011a76f4207a3c151134cd22a1415741e42fa5ddecec7c0182887deb3d/pillow-10.4.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:5dc6761a6efc781e6a1544206f22c80c3af4c8cf461206d46a1e6006e4429ff3", size = 4340304, upload-time = "2024-07-01T09:45:55.006Z" },
+    { url = "https://files.pythonhosted.org/packages/ac/10/c67e20445a707f7a610699bba4fe050583b688d8cd2d202572b257f46600/pillow-10.4.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:5e84b6cc6a4a3d76c153a6b19270b3526a5a8ed6b09501d3af891daa2a9de7d6", size = 4452804, upload-time = "2024-07-01T09:45:58.437Z" },
+    { url = "https://files.pythonhosted.org/packages/a9/83/6523837906d1da2b269dee787e31df3b0acb12e3d08f024965a3e7f64665/pillow-10.4.0-cp311-cp311-manylinux_2_28_aarch64.whl", hash = "sha256:bbc527b519bd3aa9d7f429d152fea69f9ad37c95f0b02aebddff592688998abe", size = 4365126, upload-time = "2024-07-01T09:46:00.713Z" },
+    { url = "https://files.pythonhosted.org/packages/ba/e5/8c68ff608a4203085158cff5cc2a3c534ec384536d9438c405ed6370d080/pillow-10.4.0-cp311-cp311-manylinux_2_28_x86_64.whl", hash = "sha256:76a911dfe51a36041f2e756b00f96ed84677cdeb75d25c767f296c1c1eda1319", size = 4533541, upload-time = "2024-07-01T09:46:03.235Z" },
+    { url = "https://files.pythonhosted.org/packages/f4/7c/01b8dbdca5bc6785573f4cee96e2358b0918b7b2c7b60d8b6f3abf87a070/pillow-10.4.0-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:59291fb29317122398786c2d44427bbd1a6d7ff54017075b22be9d21aa59bd8d", size = 4471616, upload-time = "2024-07-01T09:46:05.356Z" },
+    { url = "https://files.pythonhosted.org/packages/c8/57/2899b82394a35a0fbfd352e290945440e3b3785655a03365c0ca8279f351/pillow-10.4.0-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:416d3a5d0e8cfe4f27f574362435bc9bae57f679a7158e0096ad2beb427b8696", size = 4600802, upload-time = "2024-07-01T09:46:08.145Z" },
+    { url = "https://files.pythonhosted.org/packages/4d/d7/a44f193d4c26e58ee5d2d9db3d4854b2cfb5b5e08d360a5e03fe987c0086/pillow-10.4.0-cp311-cp311-win32.whl", hash = "sha256:7086cc1d5eebb91ad24ded9f58bec6c688e9f0ed7eb3dbbf1e4800280a896496", size = 2235213, upload-time = "2024-07-01T09:46:10.211Z" },
+    { url = "https://files.pythonhosted.org/packages/c1/d0/5866318eec2b801cdb8c82abf190c8343d8a1cd8bf5a0c17444a6f268291/pillow-10.4.0-cp311-cp311-win_amd64.whl", hash = "sha256:cbed61494057c0f83b83eb3a310f0bf774b09513307c434d4366ed64f4128a91", size = 2554498, upload-time = "2024-07-01T09:46:12.685Z" },
+    { url = "https://files.pythonhosted.org/packages/d4/c8/310ac16ac2b97e902d9eb438688de0d961660a87703ad1561fd3dfbd2aa0/pillow-10.4.0-cp311-cp311-win_arm64.whl", hash = "sha256:f5f0c3e969c8f12dd2bb7e0b15d5c468b51e5017e01e2e867335c81903046a22", size = 2243219, upload-time = "2024-07-01T09:46:14.83Z" },
+    { url = "https://files.pythonhosted.org/packages/05/cb/0353013dc30c02a8be34eb91d25e4e4cf594b59e5a55ea1128fde1e5f8ea/pillow-10.4.0-cp312-cp312-macosx_10_10_x86_64.whl", hash = "sha256:673655af3eadf4df6b5457033f086e90299fdd7a47983a13827acf7459c15d94", size = 3509350, upload-time = "2024-07-01T09:46:17.177Z" },
+    { url = "https://files.pythonhosted.org/packages/e7/cf/5c558a0f247e0bf9cec92bff9b46ae6474dd736f6d906315e60e4075f737/pillow-10.4.0-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:866b6942a92f56300012f5fbac71f2d610312ee65e22f1aa2609e491284e5597", size = 3374980, upload-time = "2024-07-01T09:46:19.169Z" },
+    { url = "https://files.pythonhosted.org/packages/84/48/6e394b86369a4eb68b8a1382c78dc092245af517385c086c5094e3b34428/pillow-10.4.0-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:29dbdc4207642ea6aad70fbde1a9338753d33fb23ed6956e706936706f52dd80", size = 4343799, upload-time = "2024-07-01T09:46:21.883Z" },
+    { url = "https://files.pythonhosted.org/packages/3b/f3/a8c6c11fa84b59b9df0cd5694492da8c039a24cd159f0f6918690105c3be/pillow-10.4.0-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:bf2342ac639c4cf38799a44950bbc2dfcb685f052b9e262f446482afaf4bffca", size = 4459973, upload-time = "2024-07-01T09:46:24.321Z" },
+    { url = "https://files.pythonhosted.org/packages/7d/1b/c14b4197b80150fb64453585247e6fb2e1d93761fa0fa9cf63b102fde822/pillow-10.4.0-cp312-cp312-manylinux_2_28_aarch64.whl", hash = "sha256:f5b92f4d70791b4a67157321c4e8225d60b119c5cc9aee8ecf153aace4aad4ef", size = 4370054, upload-time = "2024-07-01T09:46:26.825Z" },
+    { url = "https://files.pythonhosted.org/packages/55/77/40daddf677897a923d5d33329acd52a2144d54a9644f2a5422c028c6bf2d/pillow-10.4.0-cp312-cp312-manylinux_2_28_x86_64.whl", hash = "sha256:86dcb5a1eb778d8b25659d5e4341269e8590ad6b4e8b44d9f4b07f8d136c414a", size = 4539484, upload-time = "2024-07-01T09:46:29.355Z" },
+    { url = "https://files.pythonhosted.org/packages/40/54/90de3e4256b1207300fb2b1d7168dd912a2fb4b2401e439ba23c2b2cabde/pillow-10.4.0-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:780c072c2e11c9b2c7ca37f9a2ee8ba66f44367ac3e5c7832afcfe5104fd6d1b", size = 4477375, upload-time = "2024-07-01T09:46:31.756Z" },
+    { url = "https://files.pythonhosted.org/packages/13/24/1bfba52f44193860918ff7c93d03d95e3f8748ca1de3ceaf11157a14cf16/pillow-10.4.0-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:37fb69d905be665f68f28a8bba3c6d3223c8efe1edf14cc4cfa06c241f8c81d9", size = 4608773, upload-time = "2024-07-01T09:46:33.73Z" },
+    { url = "https://files.pythonhosted.org/packages/55/04/5e6de6e6120451ec0c24516c41dbaf80cce1b6451f96561235ef2429da2e/pillow-10.4.0-cp312-cp312-win32.whl", hash = "sha256:7dfecdbad5c301d7b5bde160150b4db4c659cee2b69589705b6f8a0c509d9f42", size = 2235690, upload-time = "2024-07-01T09:46:36.587Z" },
+    { url = "https://files.pythonhosted.org/packages/74/0a/d4ce3c44bca8635bd29a2eab5aa181b654a734a29b263ca8efe013beea98/pillow-10.4.0-cp312-cp312-win_amd64.whl", hash = "sha256:1d846aea995ad352d4bdcc847535bd56e0fd88d36829d2c90be880ef1ee4668a", size = 2554951, upload-time = "2024-07-01T09:46:38.777Z" },
+    { url = "https://files.pythonhosted.org/packages/b5/ca/184349ee40f2e92439be9b3502ae6cfc43ac4b50bc4fc6b3de7957563894/pillow-10.4.0-cp312-cp312-win_arm64.whl", hash = "sha256:e553cad5179a66ba15bb18b353a19020e73a7921296a7979c4a2b7f6a5cd57f9", size = 2243427, upload-time = "2024-07-01T09:46:43.15Z" },
+    { url = "https://files.pythonhosted.org/packages/c3/00/706cebe7c2c12a6318aabe5d354836f54adff7156fd9e1bd6c89f4ba0e98/pillow-10.4.0-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:8bc1a764ed8c957a2e9cacf97c8b2b053b70307cf2996aafd70e91a082e70df3", size = 3525685, upload-time = "2024-07-01T09:46:45.194Z" },
+    { url = "https://files.pythonhosted.org/packages/cf/76/f658cbfa49405e5ecbfb9ba42d07074ad9792031267e782d409fd8fe7c69/pillow-10.4.0-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:6209bb41dc692ddfee4942517c19ee81b86c864b626dbfca272ec0f7cff5d9fb", size = 3374883, upload-time = "2024-07-01T09:46:47.331Z" },
+    { url = "https://files.pythonhosted.org/packages/46/2b/99c28c4379a85e65378211971c0b430d9c7234b1ec4d59b2668f6299e011/pillow-10.4.0-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:bee197b30783295d2eb680b311af15a20a8b24024a19c3a26431ff83eb8d1f70", size = 4339837, upload-time = "2024-07-01T09:46:49.647Z" },
+    { url = "https://files.pythonhosted.org/packages/f1/74/b1ec314f624c0c43711fdf0d8076f82d9d802afd58f1d62c2a86878e8615/pillow-10.4.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:1ef61f5dd14c300786318482456481463b9d6b91ebe5ef12f405afbba77ed0be", size = 4455562, upload-time = "2024-07-01T09:46:51.811Z" },
+    { url = "https://files.pythonhosted.org/packages/4a/2a/4b04157cb7b9c74372fa867096a1607e6fedad93a44deeff553ccd307868/pillow-10.4.0-cp313-cp313-manylinux_2_28_aarch64.whl", hash = "sha256:297e388da6e248c98bc4a02e018966af0c5f92dfacf5a5ca22fa01cb3179bca0", size = 4366761, upload-time = "2024-07-01T09:46:53.961Z" },
+    { url = "https://files.pythonhosted.org/packages/ac/7b/8f1d815c1a6a268fe90481232c98dd0e5fa8c75e341a75f060037bd5ceae/pillow-10.4.0-cp313-cp313-manylinux_2_28_x86_64.whl", hash = "sha256:e4db64794ccdf6cb83a59d73405f63adbe2a1887012e308828596100a0b2f6cc", size = 4536767, upload-time = "2024-07-01T09:46:56.664Z" },
+    { url = "https://files.pythonhosted.org/packages/e5/77/05fa64d1f45d12c22c314e7b97398ffb28ef2813a485465017b7978b3ce7/pillow-10.4.0-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:bd2880a07482090a3bcb01f4265f1936a903d70bc740bfcb1fd4e8a2ffe5cf5a", size = 4477989, upload-time = "2024-07-01T09:46:58.977Z" },
+    { url = "https://files.pythonhosted.org/packages/12/63/b0397cfc2caae05c3fb2f4ed1b4fc4fc878f0243510a7a6034ca59726494/pillow-10.4.0-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:4b35b21b819ac1dbd1233317adeecd63495f6babf21b7b2512d244ff6c6ce309", size = 4610255, upload-time = "2024-07-01T09:47:01.189Z" },
+    { url = "https://files.pythonhosted.org/packages/7b/f9/cfaa5082ca9bc4a6de66ffe1c12c2d90bf09c309a5f52b27759a596900e7/pillow-10.4.0-cp313-cp313-win32.whl", hash = "sha256:551d3fd6e9dc15e4c1eb6fc4ba2b39c0c7933fa113b220057a34f4bb3268a060", size = 2235603, upload-time = "2024-07-01T09:47:03.918Z" },
+    { url = "https://files.pythonhosted.org/packages/01/6a/30ff0eef6e0c0e71e55ded56a38d4859bf9d3634a94a88743897b5f96936/pillow-10.4.0-cp313-cp313-win_amd64.whl", hash = "sha256:030abdbe43ee02e0de642aee345efa443740aa4d828bfe8e2eb11922ea6a21ea", size = 2554972, upload-time = "2024-07-01T09:47:06.152Z" },
+    { url = "https://files.pythonhosted.org/packages/48/2c/2e0a52890f269435eee38b21c8218e102c621fe8d8df8b9dd06fabf879ba/pillow-10.4.0-cp313-cp313-win_arm64.whl", hash = "sha256:5b001114dd152cfd6b23befeb28d7aee43553e2402c9f159807bf55f33af8a8d", size = 2243375, upload-time = "2024-07-01T09:47:09.065Z" },
+    { url = "https://files.pythonhosted.org/packages/56/70/f40009702a477ce87d8d9faaa4de51d6562b3445d7a314accd06e4ffb01d/pillow-10.4.0-cp38-cp38-macosx_10_10_x86_64.whl", hash = "sha256:8d4d5063501b6dd4024b8ac2f04962d661222d120381272deea52e3fc52d3736", size = 3509213, upload-time = "2024-07-01T09:47:11.662Z" },
+    { url = "https://files.pythonhosted.org/packages/10/43/105823d233c5e5d31cea13428f4474ded9d961652307800979a59d6a4276/pillow-10.4.0-cp38-cp38-macosx_11_0_arm64.whl", hash = "sha256:7c1ee6f42250df403c5f103cbd2768a28fe1a0ea1f0f03fe151c8741e1469c8b", size = 3375883, upload-time = "2024-07-01T09:47:14.453Z" },
+    { url = "https://files.pythonhosted.org/packages/3c/ad/7850c10bac468a20c918f6a5dbba9ecd106ea1cdc5db3c35e33a60570408/pillow-10.4.0-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:b15e02e9bb4c21e39876698abf233c8c579127986f8207200bc8a8f6bb27acf2", size = 4330810, upload-time = "2024-07-01T09:47:16.695Z" },
+    { url = "https://files.pythonhosted.org/packages/84/4c/69bbed9e436ac22f9ed193a2b64f64d68fcfbc9f4106249dc7ed4889907b/pillow-10.4.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:7a8d4bade9952ea9a77d0c3e49cbd8b2890a399422258a77f357b9cc9be8d680", size = 4444341, upload-time = "2024-07-01T09:47:19.334Z" },
+    { url = "https://files.pythonhosted.org/packages/8f/4f/c183c63828a3f37bf09644ce94cbf72d4929b033b109160a5379c2885932/pillow-10.4.0-cp38-cp38-manylinux_2_28_aarch64.whl", hash = "sha256:43efea75eb06b95d1631cb784aa40156177bf9dd5b4b03ff38979e048258bc6b", size = 4356005, upload-time = "2024-07-01T09:47:21.805Z" },
+    { url = "https://files.pythonhosted.org/packages/fb/ad/435fe29865f98a8fbdc64add8875a6e4f8c97749a93577a8919ec6f32c64/pillow-10.4.0-cp38-cp38-manylinux_2_28_x86_64.whl", hash = "sha256:950be4d8ba92aca4b2bb0741285a46bfae3ca699ef913ec8416c1b78eadd64cd", size = 4525201, upload-time = "2024-07-01T09:47:24.457Z" },
+    { url = "https://files.pythonhosted.org/packages/80/74/be8bf8acdfd70e91f905a12ae13cfb2e17c0f1da745c40141e26d0971ff5/pillow-10.4.0-cp38-cp38-musllinux_1_2_aarch64.whl", hash = "sha256:d7480af14364494365e89d6fddc510a13e5a2c3584cb19ef65415ca57252fb84", size = 4460635, upload-time = "2024-07-01T09:47:26.841Z" },
+    { url = "https://files.pythonhosted.org/packages/e4/90/763616e66dc9ad59c9b7fb58f863755e7934ef122e52349f62c7742b82d3/pillow-10.4.0-cp38-cp38-musllinux_1_2_x86_64.whl", hash = "sha256:73664fe514b34c8f02452ffb73b7a92c6774e39a647087f83d67f010eb9a0cf0", size = 4590283, upload-time = "2024-07-01T09:47:29.247Z" },
+    { url = "https://files.pythonhosted.org/packages/69/66/03002cb5b2c27bb519cba63b9f9aa3709c6f7a5d3b285406c01f03fb77e5/pillow-10.4.0-cp38-cp38-win32.whl", hash = "sha256:e88d5e6ad0d026fba7bdab8c3f225a69f063f116462c49892b0149e21b6c0a0e", size = 2235185, upload-time = "2024-07-01T09:47:32.205Z" },
+    { url = "https://files.pythonhosted.org/packages/f2/75/3cb820b2812405fc7feb3d0deb701ef0c3de93dc02597115e00704591bc9/pillow-10.4.0-cp38-cp38-win_amd64.whl", hash = "sha256:5161eef006d335e46895297f642341111945e2c1c899eb406882a6c61a4357ab", size = 2554594, upload-time = "2024-07-01T09:47:34.285Z" },
+    { url = "https://files.pythonhosted.org/packages/31/85/955fa5400fa8039921f630372cfe5056eed6e1b8e0430ee4507d7de48832/pillow-10.4.0-cp39-cp39-macosx_10_10_x86_64.whl", hash = "sha256:0ae24a547e8b711ccaaf99c9ae3cd975470e1a30caa80a6aaee9a2f19c05701d", size = 3509283, upload-time = "2024-07-01T09:47:36.394Z" },
+    { url = "https://files.pythonhosted.org/packages/23/9c/343827267eb28d41cd82b4180d33b10d868af9077abcec0af9793aa77d2d/pillow-10.4.0-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:298478fe4f77a4408895605f3482b6cc6222c018b2ce565c2b6b9c354ac3229b", size = 3375691, upload-time = "2024-07-01T09:47:38.853Z" },
+    { url = "https://files.pythonhosted.org/packages/60/a3/7ebbeabcd341eab722896d1a5b59a3df98c4b4d26cf4b0385f8aa94296f7/pillow-10.4.0-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:134ace6dc392116566980ee7436477d844520a26a4b1bd4053f6f47d096997fd", size = 4328295, upload-time = "2024-07-01T09:47:41.765Z" },
+    { url = "https://files.pythonhosted.org/packages/32/3f/c02268d0c6fb6b3958bdda673c17b315c821d97df29ae6969f20fb49388a/pillow-10.4.0-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:930044bb7679ab003b14023138b50181899da3f25de50e9dbee23b61b4de2126", size = 4440810, upload-time = "2024-07-01T09:47:44.27Z" },
+    { url = "https://files.pythonhosted.org/packages/67/5d/1c93c8cc35f2fdd3d6cc7e4ad72d203902859a2867de6ad957d9b708eb8d/pillow-10.4.0-cp39-cp39-manylinux_2_28_aarch64.whl", hash = "sha256:c76e5786951e72ed3686e122d14c5d7012f16c8303a674d18cdcd6d89557fc5b", size = 4352283, upload-time = "2024-07-01T09:47:46.673Z" },
+    { url = "https://files.pythonhosted.org/packages/bc/a8/8655557c9c7202b8abbd001f61ff36711cefaf750debcaa1c24d154ef602/pillow-10.4.0-cp39-cp39-manylinux_2_28_x86_64.whl", hash = "sha256:b2724fdb354a868ddf9a880cb84d102da914e99119211ef7ecbdc613b8c96b3c", size = 4521800, upload-time = "2024-07-01T09:47:48.813Z" },
+    { url = "https://files.pythonhosted.org/packages/58/78/6f95797af64d137124f68af1bdaa13b5332da282b86031f6fa70cf368261/pillow-10.4.0-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:dbc6ae66518ab3c5847659e9988c3b60dc94ffb48ef9168656e0019a93dbf8a1", size = 4459177, upload-time = "2024-07-01T09:47:52.104Z" },
+    { url = "https://files.pythonhosted.org/packages/8a/6d/2b3ce34f1c4266d79a78c9a51d1289a33c3c02833fe294ef0dcbb9cba4ed/pillow-10.4.0-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:06b2f7898047ae93fad74467ec3d28fe84f7831370e3c258afa533f81ef7f3df", size = 4589079, upload-time = "2024-07-01T09:47:54.999Z" },
+    { url = "https://files.pythonhosted.org/packages/e3/e0/456258c74da1ff5bf8ef1eab06a95ca994d8b9ed44c01d45c3f8cbd1db7e/pillow-10.4.0-cp39-cp39-win32.whl", hash = "sha256:7970285ab628a3779aecc35823296a7869f889b8329c16ad5a71e4901a3dc4ef", size = 2235247, upload-time = "2024-07-01T09:47:57.666Z" },
+    { url = "https://files.pythonhosted.org/packages/37/f8/bef952bdb32aa53741f58bf21798642209e994edc3f6598f337f23d5400a/pillow-10.4.0-cp39-cp39-win_amd64.whl", hash = "sha256:961a7293b2457b405967af9c77dcaa43cc1a8cd50d23c532e62d48ab6cdd56f5", size = 2554479, upload-time = "2024-07-01T09:47:59.881Z" },
+    { url = "https://files.pythonhosted.org/packages/bb/8e/805201619cad6651eef5fc1fdef913804baf00053461522fabbc5588ea12/pillow-10.4.0-cp39-cp39-win_arm64.whl", hash = "sha256:32cda9e3d601a52baccb2856b8ea1fc213c90b340c542dcef77140dfa3278a9e", size = 2243226, upload-time = "2024-07-01T09:48:02.508Z" },
+    { url = "https://files.pythonhosted.org/packages/38/30/095d4f55f3a053392f75e2eae45eba3228452783bab3d9a920b951ac495c/pillow-10.4.0-pp310-pypy310_pp73-macosx_10_15_x86_64.whl", hash = "sha256:5b4815f2e65b30f5fbae9dfffa8636d992d49705723fe86a3661806e069352d4", size = 3493889, upload-time = "2024-07-01T09:48:04.815Z" },
+    { url = "https://files.pythonhosted.org/packages/f3/e8/4ff79788803a5fcd5dc35efdc9386af153569853767bff74540725b45863/pillow-10.4.0-pp310-pypy310_pp73-macosx_11_0_arm64.whl", hash = "sha256:8f0aef4ef59694b12cadee839e2ba6afeab89c0f39a3adc02ed51d109117b8da", size = 3346160, upload-time = "2024-07-01T09:48:07.206Z" },
+    { url = "https://files.pythonhosted.org/packages/d7/ac/4184edd511b14f760c73f5bb8a5d6fd85c591c8aff7c2229677a355c4179/pillow-10.4.0-pp310-pypy310_pp73-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:9f4727572e2918acaa9077c919cbbeb73bd2b3ebcfe033b72f858fc9fbef0026", size = 3435020, upload-time = "2024-07-01T09:48:09.66Z" },
+    { url = "https://files.pythonhosted.org/packages/da/21/1749cd09160149c0a246a81d646e05f35041619ce76f6493d6a96e8d1103/pillow-10.4.0-pp310-pypy310_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:ff25afb18123cea58a591ea0244b92eb1e61a1fd497bf6d6384f09bc3262ec3e", size = 3490539, upload-time = "2024-07-01T09:48:12.529Z" },
+    { url = "https://files.pythonhosted.org/packages/b6/f5/f71fe1888b96083b3f6dfa0709101f61fc9e972c0c8d04e9d93ccef2a045/pillow-10.4.0-pp310-pypy310_pp73-manylinux_2_28_aarch64.whl", hash = "sha256:dc3e2db6ba09ffd7d02ae9141cfa0ae23393ee7687248d46a7507b75d610f4f5", size = 3476125, upload-time = "2024-07-01T09:48:14.891Z" },
+    { url = "https://files.pythonhosted.org/packages/96/b9/c0362c54290a31866c3526848583a2f45a535aa9d725fd31e25d318c805f/pillow-10.4.0-pp310-pypy310_pp73-manylinux_2_28_x86_64.whl", hash = "sha256:02a2be69f9c9b8c1e97cf2713e789d4e398c751ecfd9967c18d0ce304efbf885", size = 3579373, upload-time = "2024-07-01T09:48:17.601Z" },
+    { url = "https://files.pythonhosted.org/packages/52/3b/ce7a01026a7cf46e5452afa86f97a5e88ca97f562cafa76570178ab56d8d/pillow-10.4.0-pp310-pypy310_pp73-win_amd64.whl", hash = "sha256:0755ffd4a0c6f267cccbae2e9903d95477ca2f77c4fcf3a3a09570001856c8a5", size = 2554661, upload-time = "2024-07-01T09:48:20.293Z" },
+    { url = "https://files.pythonhosted.org/packages/e1/1f/5a9fcd6ced51633c22481417e11b1b47d723f64fb536dfd67c015eb7f0ab/pillow-10.4.0-pp39-pypy39_pp73-macosx_10_15_x86_64.whl", hash = "sha256:a02364621fe369e06200d4a16558e056fe2805d3468350df3aef21e00d26214b", size = 3493850, upload-time = "2024-07-01T09:48:23.03Z" },
+    { url = "https://files.pythonhosted.org/packages/cb/e6/3ea4755ed5320cb62aa6be2f6de47b058c6550f752dd050e86f694c59798/pillow-10.4.0-pp39-pypy39_pp73-macosx_11_0_arm64.whl", hash = "sha256:1b5dea9831a90e9d0721ec417a80d4cbd7022093ac38a568db2dd78363b00908", size = 3346118, upload-time = "2024-07-01T09:48:25.256Z" },
+    { url = "https://files.pythonhosted.org/packages/0a/22/492f9f61e4648422b6ca39268ec8139277a5b34648d28f400faac14e0f48/pillow-10.4.0-pp39-pypy39_pp73-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:9b885f89040bb8c4a1573566bbb2f44f5c505ef6e74cec7ab9068c900047f04b", size = 3434958, upload-time = "2024-07-01T09:48:28.078Z" },
+    { url = "https://files.pythonhosted.org/packages/f9/19/559a48ad4045704bb0547965b9a9345f5cd461347d977a56d178db28819e/pillow-10.4.0-pp39-pypy39_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:87dd88ded2e6d74d31e1e0a99a726a6765cda32d00ba72dc37f0651f306daaa8", size = 3490340, upload-time = "2024-07-01T09:48:30.734Z" },
+    { url = "https://files.pythonhosted.org/packages/d9/de/cebaca6fb79905b3a1aa0281d238769df3fb2ede34fd7c0caa286575915a/pillow-10.4.0-pp39-pypy39_pp73-manylinux_2_28_aarch64.whl", hash = "sha256:2db98790afc70118bd0255c2eeb465e9767ecf1f3c25f9a1abb8ffc8cfd1fe0a", size = 3476048, upload-time = "2024-07-01T09:48:33.292Z" },
+    { url = "https://files.pythonhosted.org/packages/71/f0/86d5b2f04693b0116a01d75302b0a307800a90d6c351a8aa4f8ae76cd499/pillow-10.4.0-pp39-pypy39_pp73-manylinux_2_28_x86_64.whl", hash = "sha256:f7baece4ce06bade126fb84b8af1c33439a76d8a6fd818970215e0560ca28c27", size = 3579366, upload-time = "2024-07-01T09:48:36.527Z" },
+    { url = "https://files.pythonhosted.org/packages/37/ae/2dbfc38cc4fd14aceea14bc440d5151b21f64c4c3ba3f6f4191610b7ee5d/pillow-10.4.0-pp39-pypy39_pp73-win_amd64.whl", hash = "sha256:cfdd747216947628af7b259d274771d84db2268ca062dd5faf373639d00113a3", size = 2554652, upload-time = "2024-07-01T09:48:38.789Z" },
+]
+
+[[package]]
+name = "pillow"
+version = "11.3.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/f3/0d/d0d6dea55cd152ce3d6767bb38a8fc10e33796ba4ba210cbab9354b6d238/pillow-11.3.0.tar.gz", hash = "sha256:3828ee7586cd0b2091b6209e5ad53e20d0649bbe87164a459d0676e035e8f523", size = 47113069, upload-time = "2025-07-01T09:16:30.666Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/4c/5d/45a3553a253ac8763f3561371432a90bdbe6000fbdcf1397ffe502aa206c/pillow-11.3.0-cp310-cp310-macosx_10_10_x86_64.whl", hash = "sha256:1b9c17fd4ace828b3003dfd1e30bff24863e0eb59b535e8f80194d9cc7ecf860", size = 5316554, upload-time = "2025-07-01T09:13:39.342Z" },
+    { url = "https://files.pythonhosted.org/packages/7c/c8/67c12ab069ef586a25a4a79ced553586748fad100c77c0ce59bb4983ac98/pillow-11.3.0-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:65dc69160114cdd0ca0f35cb434633c75e8e7fad4cf855177a05bf38678f73ad", size = 4686548, upload-time = "2025-07-01T09:13:41.835Z" },
+    { url = "https://files.pythonhosted.org/packages/2f/bd/6741ebd56263390b382ae4c5de02979af7f8bd9807346d068700dd6d5cf9/pillow-11.3.0-cp310-cp310-manylinux2014_aarch64.manylinux_2_17_aarch64.whl", hash = "sha256:7107195ddc914f656c7fc8e4a5e1c25f32e9236ea3ea860f257b0436011fddd0", size = 5859742, upload-time = "2025-07-03T13:09:47.439Z" },
+    { url = "https://files.pythonhosted.org/packages/ca/0b/c412a9e27e1e6a829e6ab6c2dca52dd563efbedf4c9c6aa453d9a9b77359/pillow-11.3.0-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:cc3e831b563b3114baac7ec2ee86819eb03caa1a2cef0b481a5675b59c4fe23b", size = 7633087, upload-time = "2025-07-03T13:09:51.796Z" },
+    { url = "https://files.pythonhosted.org/packages/59/9d/9b7076aaf30f5dd17e5e5589b2d2f5a5d7e30ff67a171eb686e4eecc2adf/pillow-11.3.0-cp310-cp310-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:f1f182ebd2303acf8c380a54f615ec883322593320a9b00438eb842c1f37ae50", size = 5963350, upload-time = "2025-07-01T09:13:43.865Z" },
+    { url = "https://files.pythonhosted.org/packages/f0/16/1a6bf01fb622fb9cf5c91683823f073f053005c849b1f52ed613afcf8dae/pillow-11.3.0-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:4445fa62e15936a028672fd48c4c11a66d641d2c05726c7ec1f8ba6a572036ae", size = 6631840, upload-time = "2025-07-01T09:13:46.161Z" },
+    { url = "https://files.pythonhosted.org/packages/7b/e6/6ff7077077eb47fde78739e7d570bdcd7c10495666b6afcd23ab56b19a43/pillow-11.3.0-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:71f511f6b3b91dd543282477be45a033e4845a40278fa8dcdbfdb07109bf18f9", size = 6074005, upload-time = "2025-07-01T09:13:47.829Z" },
+    { url = "https://files.pythonhosted.org/packages/c3/3a/b13f36832ea6d279a697231658199e0a03cd87ef12048016bdcc84131601/pillow-11.3.0-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:040a5b691b0713e1f6cbe222e0f4f74cd233421e105850ae3b3c0ceda520f42e", size = 6708372, upload-time = "2025-07-01T09:13:52.145Z" },
+    { url = "https://files.pythonhosted.org/packages/6c/e4/61b2e1a7528740efbc70b3d581f33937e38e98ef3d50b05007267a55bcb2/pillow-11.3.0-cp310-cp310-win32.whl", hash = "sha256:89bd777bc6624fe4115e9fac3352c79ed60f3bb18651420635f26e643e3dd1f6", size = 6277090, upload-time = "2025-07-01T09:13:53.915Z" },
+    { url = "https://files.pythonhosted.org/packages/a9/d3/60c781c83a785d6afbd6a326ed4d759d141de43aa7365725cbcd65ce5e54/pillow-11.3.0-cp310-cp310-win_amd64.whl", hash = "sha256:19d2ff547c75b8e3ff46f4d9ef969a06c30ab2d4263a9e287733aa8b2429ce8f", size = 6985988, upload-time = "2025-07-01T09:13:55.699Z" },
+    { url = "https://files.pythonhosted.org/packages/9f/28/4f4a0203165eefb3763939c6789ba31013a2e90adffb456610f30f613850/pillow-11.3.0-cp310-cp310-win_arm64.whl", hash = "sha256:819931d25e57b513242859ce1876c58c59dc31587847bf74cfe06b2e0cb22d2f", size = 2422899, upload-time = "2025-07-01T09:13:57.497Z" },
+    { url = "https://files.pythonhosted.org/packages/db/26/77f8ed17ca4ffd60e1dcd220a6ec6d71210ba398cfa33a13a1cd614c5613/pillow-11.3.0-cp311-cp311-macosx_10_10_x86_64.whl", hash = "sha256:1cd110edf822773368b396281a2293aeb91c90a2db00d78ea43e7e861631b722", size = 5316531, upload-time = "2025-07-01T09:13:59.203Z" },
+    { url = "https://files.pythonhosted.org/packages/cb/39/ee475903197ce709322a17a866892efb560f57900d9af2e55f86db51b0a5/pillow-11.3.0-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:9c412fddd1b77a75aa904615ebaa6001f169b26fd467b4be93aded278266b288", size = 4686560, upload-time = "2025-07-01T09:14:01.101Z" },
+    { url = "https://files.pythonhosted.org/packages/d5/90/442068a160fd179938ba55ec8c97050a612426fae5ec0a764e345839f76d/pillow-11.3.0-cp311-cp311-manylinux2014_aarch64.manylinux_2_17_aarch64.whl", hash = "sha256:7d1aa4de119a0ecac0a34a9c8bde33f34022e2e8f99104e47a3ca392fd60e37d", size = 5870978, upload-time = "2025-07-03T13:09:55.638Z" },
+    { url = "https://files.pythonhosted.org/packages/13/92/dcdd147ab02daf405387f0218dcf792dc6dd5b14d2573d40b4caeef01059/pillow-11.3.0-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:91da1d88226663594e3f6b4b8c3c8d85bd504117d043740a8e0ec449087cc494", size = 7641168, upload-time = "2025-07-03T13:10:00.37Z" },
+    { url = "https://files.pythonhosted.org/packages/6e/db/839d6ba7fd38b51af641aa904e2960e7a5644d60ec754c046b7d2aee00e5/pillow-11.3.0-cp311-cp311-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:643f189248837533073c405ec2f0bb250ba54598cf80e8c1e043381a60632f58", size = 5973053, upload-time = "2025-07-01T09:14:04.491Z" },
+    { url = "https://files.pythonhosted.org/packages/f2/2f/d7675ecae6c43e9f12aa8d58b6012683b20b6edfbdac7abcb4e6af7a3784/pillow-11.3.0-cp311-cp311-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:106064daa23a745510dabce1d84f29137a37224831d88eb4ce94bb187b1d7e5f", size = 6640273, upload-time = "2025-07-01T09:14:06.235Z" },
+    { url = "https://files.pythonhosted.org/packages/45/ad/931694675ede172e15b2ff03c8144a0ddaea1d87adb72bb07655eaffb654/pillow-11.3.0-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:cd8ff254faf15591e724dc7c4ddb6bf4793efcbe13802a4ae3e863cd300b493e", size = 6082043, upload-time = "2025-07-01T09:14:07.978Z" },
+    { url = "https://files.pythonhosted.org/packages/3a/04/ba8f2b11fc80d2dd462d7abec16351b45ec99cbbaea4387648a44190351a/pillow-11.3.0-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:932c754c2d51ad2b2271fd01c3d121daaa35e27efae2a616f77bf164bc0b3e94", size = 6715516, upload-time = "2025-07-01T09:14:10.233Z" },
+    { url = "https://files.pythonhosted.org/packages/48/59/8cd06d7f3944cc7d892e8533c56b0acb68399f640786313275faec1e3b6f/pillow-11.3.0-cp311-cp311-win32.whl", hash = "sha256:b4b8f3efc8d530a1544e5962bd6b403d5f7fe8b9e08227c6b255f98ad82b4ba0", size = 6274768, upload-time = "2025-07-01T09:14:11.921Z" },
+    { url = "https://files.pythonhosted.org/packages/f1/cc/29c0f5d64ab8eae20f3232da8f8571660aa0ab4b8f1331da5c2f5f9a938e/pillow-11.3.0-cp311-cp311-win_amd64.whl", hash = "sha256:1a992e86b0dd7aeb1f053cd506508c0999d710a8f07b4c791c63843fc6a807ac", size = 6986055, upload-time = "2025-07-01T09:14:13.623Z" },
+    { url = "https://files.pythonhosted.org/packages/c6/df/90bd886fabd544c25addd63e5ca6932c86f2b701d5da6c7839387a076b4a/pillow-11.3.0-cp311-cp311-win_arm64.whl", hash = "sha256:30807c931ff7c095620fe04448e2c2fc673fcbb1ffe2a7da3fb39613489b1ddd", size = 2423079, upload-time = "2025-07-01T09:14:15.268Z" },
+    { url = "https://files.pythonhosted.org/packages/40/fe/1bc9b3ee13f68487a99ac9529968035cca2f0a51ec36892060edcc51d06a/pillow-11.3.0-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:fdae223722da47b024b867c1ea0be64e0df702c5e0a60e27daad39bf960dd1e4", size = 5278800, upload-time = "2025-07-01T09:14:17.648Z" },
+    { url = "https://files.pythonhosted.org/packages/2c/32/7e2ac19b5713657384cec55f89065fb306b06af008cfd87e572035b27119/pillow-11.3.0-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:921bd305b10e82b4d1f5e802b6850677f965d8394203d182f078873851dada69", size = 4686296, upload-time = "2025-07-01T09:14:19.828Z" },
+    { url = "https://files.pythonhosted.org/packages/8e/1e/b9e12bbe6e4c2220effebc09ea0923a07a6da1e1f1bfbc8d7d29a01ce32b/pillow-11.3.0-cp312-cp312-manylinux2014_aarch64.manylinux_2_17_aarch64.whl", hash = "sha256:eb76541cba2f958032d79d143b98a3a6b3ea87f0959bbe256c0b5e416599fd5d", size = 5871726, upload-time = "2025-07-03T13:10:04.448Z" },
+    { url = "https://files.pythonhosted.org/packages/8d/33/e9200d2bd7ba00dc3ddb78df1198a6e80d7669cce6c2bdbeb2530a74ec58/pillow-11.3.0-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:67172f2944ebba3d4a7b54f2e95c786a3a50c21b88456329314caaa28cda70f6", size = 7644652, upload-time = "2025-07-03T13:10:10.391Z" },
+    { url = "https://files.pythonhosted.org/packages/41/f1/6f2427a26fc683e00d985bc391bdd76d8dd4e92fac33d841127eb8fb2313/pillow-11.3.0-cp312-cp312-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:97f07ed9f56a3b9b5f49d3661dc9607484e85c67e27f3e8be2c7d28ca032fec7", size = 5977787, upload-time = "2025-07-01T09:14:21.63Z" },
+    { url = "https://files.pythonhosted.org/packages/e4/c9/06dd4a38974e24f932ff5f98ea3c546ce3f8c995d3f0985f8e5ba48bba19/pillow-11.3.0-cp312-cp312-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:676b2815362456b5b3216b4fd5bd89d362100dc6f4945154ff172e206a22c024", size = 6645236, upload-time = "2025-07-01T09:14:23.321Z" },
+    { url = "https://files.pythonhosted.org/packages/40/e7/848f69fb79843b3d91241bad658e9c14f39a32f71a301bcd1d139416d1be/pillow-11.3.0-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:3e184b2f26ff146363dd07bde8b711833d7b0202e27d13540bfe2e35a323a809", size = 6086950, upload-time = "2025-07-01T09:14:25.237Z" },
+    { url = "https://files.pythonhosted.org/packages/0b/1a/7cff92e695a2a29ac1958c2a0fe4c0b2393b60aac13b04a4fe2735cad52d/pillow-11.3.0-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:6be31e3fc9a621e071bc17bb7de63b85cbe0bfae91bb0363c893cbe67247780d", size = 6723358, upload-time = "2025-07-01T09:14:27.053Z" },
+    { url = "https://files.pythonhosted.org/packages/26/7d/73699ad77895f69edff76b0f332acc3d497f22f5d75e5360f78cbcaff248/pillow-11.3.0-cp312-cp312-win32.whl", hash = "sha256:7b161756381f0918e05e7cb8a371fff367e807770f8fe92ecb20d905d0e1c149", size = 6275079, upload-time = "2025-07-01T09:14:30.104Z" },
+    { url = "https://files.pythonhosted.org/packages/8c/ce/e7dfc873bdd9828f3b6e5c2bbb74e47a98ec23cc5c74fc4e54462f0d9204/pillow-11.3.0-cp312-cp312-win_amd64.whl", hash = "sha256:a6444696fce635783440b7f7a9fc24b3ad10a9ea3f0ab66c5905be1c19ccf17d", size = 6986324, upload-time = "2025-07-01T09:14:31.899Z" },
+    { url = "https://files.pythonhosted.org/packages/16/8f/b13447d1bf0b1f7467ce7d86f6e6edf66c0ad7cf44cf5c87a37f9bed9936/pillow-11.3.0-cp312-cp312-win_arm64.whl", hash = "sha256:2aceea54f957dd4448264f9bf40875da0415c83eb85f55069d89c0ed436e3542", size = 2423067, upload-time = "2025-07-01T09:14:33.709Z" },
+    { url = "https://files.pythonhosted.org/packages/1e/93/0952f2ed8db3a5a4c7a11f91965d6184ebc8cd7cbb7941a260d5f018cd2d/pillow-11.3.0-cp313-cp313-ios_13_0_arm64_iphoneos.whl", hash = "sha256:1c627742b539bba4309df89171356fcb3cc5a9178355b2727d1b74a6cf155fbd", size = 2128328, upload-time = "2025-07-01T09:14:35.276Z" },
+    { url = "https://files.pythonhosted.org/packages/4b/e8/100c3d114b1a0bf4042f27e0f87d2f25e857e838034e98ca98fe7b8c0a9c/pillow-11.3.0-cp313-cp313-ios_13_0_arm64_iphonesimulator.whl", hash = "sha256:30b7c02f3899d10f13d7a48163c8969e4e653f8b43416d23d13d1bbfdc93b9f8", size = 2170652, upload-time = "2025-07-01T09:14:37.203Z" },
+    { url = "https://files.pythonhosted.org/packages/aa/86/3f758a28a6e381758545f7cdb4942e1cb79abd271bea932998fc0db93cb6/pillow-11.3.0-cp313-cp313-ios_13_0_x86_64_iphonesimulator.whl", hash = "sha256:7859a4cc7c9295f5838015d8cc0a9c215b77e43d07a25e460f35cf516df8626f", size = 2227443, upload-time = "2025-07-01T09:14:39.344Z" },
+    { url = "https://files.pythonhosted.org/packages/01/f4/91d5b3ffa718df2f53b0dc109877993e511f4fd055d7e9508682e8aba092/pillow-11.3.0-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:ec1ee50470b0d050984394423d96325b744d55c701a439d2bd66089bff963d3c", size = 5278474, upload-time = "2025-07-01T09:14:41.843Z" },
+    { url = "https://files.pythonhosted.org/packages/f9/0e/37d7d3eca6c879fbd9dba21268427dffda1ab00d4eb05b32923d4fbe3b12/pillow-11.3.0-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:7db51d222548ccfd274e4572fdbf3e810a5e66b00608862f947b163e613b67dd", size = 4686038, upload-time = "2025-07-01T09:14:44.008Z" },
+    { url = "https://files.pythonhosted.org/packages/ff/b0/3426e5c7f6565e752d81221af9d3676fdbb4f352317ceafd42899aaf5d8a/pillow-11.3.0-cp313-cp313-manylinux2014_aarch64.manylinux_2_17_aarch64.whl", hash = "sha256:2d6fcc902a24ac74495df63faad1884282239265c6839a0a6416d33faedfae7e", size = 5864407, upload-time = "2025-07-03T13:10:15.628Z" },
+    { url = "https://files.pythonhosted.org/packages/fc/c1/c6c423134229f2a221ee53f838d4be9d82bab86f7e2f8e75e47b6bf6cd77/pillow-11.3.0-cp313-cp313-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:f0f5d8f4a08090c6d6d578351a2b91acf519a54986c055af27e7a93feae6d3f1", size = 7639094, upload-time = "2025-07-03T13:10:21.857Z" },
+    { url = "https://files.pythonhosted.org/packages/ba/c9/09e6746630fe6372c67c648ff9deae52a2bc20897d51fa293571977ceb5d/pillow-11.3.0-cp313-cp313-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:c37d8ba9411d6003bba9e518db0db0c58a680ab9fe5179f040b0463644bc9805", size = 5973503, upload-time = "2025-07-01T09:14:45.698Z" },
+    { url = "https://files.pythonhosted.org/packages/d5/1c/a2a29649c0b1983d3ef57ee87a66487fdeb45132df66ab30dd37f7dbe162/pillow-11.3.0-cp313-cp313-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:13f87d581e71d9189ab21fe0efb5a23e9f28552d5be6979e84001d3b8505abe8", size = 6642574, upload-time = "2025-07-01T09:14:47.415Z" },
+    { url = "https://files.pythonhosted.org/packages/36/de/d5cc31cc4b055b6c6fd990e3e7f0f8aaf36229a2698501bcb0cdf67c7146/pillow-11.3.0-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:023f6d2d11784a465f09fd09a34b150ea4672e85fb3d05931d89f373ab14abb2", size = 6084060, upload-time = "2025-07-01T09:14:49.636Z" },
+    { url = "https://files.pythonhosted.org/packages/d5/ea/502d938cbaeec836ac28a9b730193716f0114c41325db428e6b280513f09/pillow-11.3.0-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:45dfc51ac5975b938e9809451c51734124e73b04d0f0ac621649821a63852e7b", size = 6721407, upload-time = "2025-07-01T09:14:51.962Z" },
+    { url = "https://files.pythonhosted.org/packages/45/9c/9c5e2a73f125f6cbc59cc7087c8f2d649a7ae453f83bd0362ff7c9e2aee2/pillow-11.3.0-cp313-cp313-win32.whl", hash = "sha256:a4d336baed65d50d37b88ca5b60c0fa9d81e3a87d4a7930d3880d1624d5b31f3", size = 6273841, upload-time = "2025-07-01T09:14:54.142Z" },
+    { url = "https://files.pythonhosted.org/packages/23/85/397c73524e0cd212067e0c969aa245b01d50183439550d24d9f55781b776/pillow-11.3.0-cp313-cp313-win_amd64.whl", hash = "sha256:0bce5c4fd0921f99d2e858dc4d4d64193407e1b99478bc5cacecba2311abde51", size = 6978450, upload-time = "2025-07-01T09:14:56.436Z" },
+    { url = "https://files.pythonhosted.org/packages/17/d2/622f4547f69cd173955194b78e4d19ca4935a1b0f03a302d655c9f6aae65/pillow-11.3.0-cp313-cp313-win_arm64.whl", hash = "sha256:1904e1264881f682f02b7f8167935cce37bc97db457f8e7849dc3a6a52b99580", size = 2423055, upload-time = "2025-07-01T09:14:58.072Z" },
+    { url = "https://files.pythonhosted.org/packages/dd/80/a8a2ac21dda2e82480852978416cfacd439a4b490a501a288ecf4fe2532d/pillow-11.3.0-cp313-cp313t-macosx_10_13_x86_64.whl", hash = "sha256:4c834a3921375c48ee6b9624061076bc0a32a60b5532b322cc0ea64e639dd50e", size = 5281110, upload-time = "2025-07-01T09:14:59.79Z" },
+    { url = "https://files.pythonhosted.org/packages/44/d6/b79754ca790f315918732e18f82a8146d33bcd7f4494380457ea89eb883d/pillow-11.3.0-cp313-cp313t-macosx_11_0_arm64.whl", hash = "sha256:5e05688ccef30ea69b9317a9ead994b93975104a677a36a8ed8106be9260aa6d", size = 4689547, upload-time = "2025-07-01T09:15:01.648Z" },
+    { url = "https://files.pythonhosted.org/packages/49/20/716b8717d331150cb00f7fdd78169c01e8e0c219732a78b0e59b6bdb2fd6/pillow-11.3.0-cp313-cp313t-manylinux2014_aarch64.manylinux_2_17_aarch64.whl", hash = "sha256:1019b04af07fc0163e2810167918cb5add8d74674b6267616021ab558dc98ced", size = 5901554, upload-time = "2025-07-03T13:10:27.018Z" },
+    { url = "https://files.pythonhosted.org/packages/74/cf/a9f3a2514a65bb071075063a96f0a5cf949c2f2fce683c15ccc83b1c1cab/pillow-11.3.0-cp313-cp313t-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:f944255db153ebb2b19c51fe85dd99ef0ce494123f21b9db4877ffdfc5590c7c", size = 7669132, upload-time = "2025-07-03T13:10:33.01Z" },
+    { url = "https://files.pythonhosted.org/packages/98/3c/da78805cbdbee9cb43efe8261dd7cc0b4b93f2ac79b676c03159e9db2187/pillow-11.3.0-cp313-cp313t-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:1f85acb69adf2aaee8b7da124efebbdb959a104db34d3a2cb0f3793dbae422a8", size = 6005001, upload-time = "2025-07-01T09:15:03.365Z" },
+    { url = "https://files.pythonhosted.org/packages/6c/fa/ce044b91faecf30e635321351bba32bab5a7e034c60187fe9698191aef4f/pillow-11.3.0-cp313-cp313t-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:05f6ecbeff5005399bb48d198f098a9b4b6bdf27b8487c7f38ca16eeb070cd59", size = 6668814, upload-time = "2025-07-01T09:15:05.655Z" },
+    { url = "https://files.pythonhosted.org/packages/7b/51/90f9291406d09bf93686434f9183aba27b831c10c87746ff49f127ee80cb/pillow-11.3.0-cp313-cp313t-musllinux_1_2_aarch64.whl", hash = "sha256:a7bc6e6fd0395bc052f16b1a8670859964dbd7003bd0af2ff08342eb6e442cfe", size = 6113124, upload-time = "2025-07-01T09:15:07.358Z" },
+    { url = "https://files.pythonhosted.org/packages/cd/5a/6fec59b1dfb619234f7636d4157d11fb4e196caeee220232a8d2ec48488d/pillow-11.3.0-cp313-cp313t-musllinux_1_2_x86_64.whl", hash = "sha256:83e1b0161c9d148125083a35c1c5a89db5b7054834fd4387499e06552035236c", size = 6747186, upload-time = "2025-07-01T09:15:09.317Z" },
+    { url = "https://files.pythonhosted.org/packages/49/6b/00187a044f98255225f172de653941e61da37104a9ea60e4f6887717e2b5/pillow-11.3.0-cp313-cp313t-win32.whl", hash = "sha256:2a3117c06b8fb646639dce83694f2f9eac405472713fcb1ae887469c0d4f6788", size = 6277546, upload-time = "2025-07-01T09:15:11.311Z" },
+    { url = "https://files.pythonhosted.org/packages/e8/5c/6caaba7e261c0d75bab23be79f1d06b5ad2a2ae49f028ccec801b0e853d6/pillow-11.3.0-cp313-cp313t-win_amd64.whl", hash = "sha256:857844335c95bea93fb39e0fa2726b4d9d758850b34075a7e3ff4f4fa3aa3b31", size = 6985102, upload-time = "2025-07-01T09:15:13.164Z" },
+    { url = "https://files.pythonhosted.org/packages/f3/7e/b623008460c09a0cb38263c93b828c666493caee2eb34ff67f778b87e58c/pillow-11.3.0-cp313-cp313t-win_arm64.whl", hash = "sha256:8797edc41f3e8536ae4b10897ee2f637235c94f27404cac7297f7b607dd0716e", size = 2424803, upload-time = "2025-07-01T09:15:15.695Z" },
+    { url = "https://files.pythonhosted.org/packages/73/f4/04905af42837292ed86cb1b1dabe03dce1edc008ef14c473c5c7e1443c5d/pillow-11.3.0-cp314-cp314-macosx_10_13_x86_64.whl", hash = "sha256:d9da3df5f9ea2a89b81bb6087177fb1f4d1c7146d583a3fe5c672c0d94e55e12", size = 5278520, upload-time = "2025-07-01T09:15:17.429Z" },
+    { url = "https://files.pythonhosted.org/packages/41/b0/33d79e377a336247df6348a54e6d2a2b85d644ca202555e3faa0cf811ecc/pillow-11.3.0-cp314-cp314-macosx_11_0_arm64.whl", hash = "sha256:0b275ff9b04df7b640c59ec5a3cb113eefd3795a8df80bac69646ef699c6981a", size = 4686116, upload-time = "2025-07-01T09:15:19.423Z" },
+    { url = "https://files.pythonhosted.org/packages/49/2d/ed8bc0ab219ae8768f529597d9509d184fe8a6c4741a6864fea334d25f3f/pillow-11.3.0-cp314-cp314-manylinux2014_aarch64.manylinux_2_17_aarch64.whl", hash = "sha256:0743841cabd3dba6a83f38a92672cccbd69af56e3e91777b0ee7f4dba4385632", size = 5864597, upload-time = "2025-07-03T13:10:38.404Z" },
+    { url = "https://files.pythonhosted.org/packages/b5/3d/b932bb4225c80b58dfadaca9d42d08d0b7064d2d1791b6a237f87f661834/pillow-11.3.0-cp314-cp314-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:2465a69cf967b8b49ee1b96d76718cd98c4e925414ead59fdf75cf0fd07df673", size = 7638246, upload-time = "2025-07-03T13:10:44.987Z" },
+    { url = "https://files.pythonhosted.org/packages/09/b5/0487044b7c096f1b48f0d7ad416472c02e0e4bf6919541b111efd3cae690/pillow-11.3.0-cp314-cp314-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:41742638139424703b4d01665b807c6468e23e699e8e90cffefe291c5832b027", size = 5973336, upload-time = "2025-07-01T09:15:21.237Z" },
+    { url = "https://files.pythonhosted.org/packages/a8/2d/524f9318f6cbfcc79fbc004801ea6b607ec3f843977652fdee4857a7568b/pillow-11.3.0-cp314-cp314-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:93efb0b4de7e340d99057415c749175e24c8864302369e05914682ba642e5d77", size = 6642699, upload-time = "2025-07-01T09:15:23.186Z" },
+    { url = "https://files.pythonhosted.org/packages/6f/d2/a9a4f280c6aefedce1e8f615baaa5474e0701d86dd6f1dede66726462bbd/pillow-11.3.0-cp314-cp314-musllinux_1_2_aarch64.whl", hash = "sha256:7966e38dcd0fa11ca390aed7c6f20454443581d758242023cf36fcb319b1a874", size = 6083789, upload-time = "2025-07-01T09:15:25.1Z" },
+    { url = "https://files.pythonhosted.org/packages/fe/54/86b0cd9dbb683a9d5e960b66c7379e821a19be4ac5810e2e5a715c09a0c0/pillow-11.3.0-cp314-cp314-musllinux_1_2_x86_64.whl", hash = "sha256:98a9afa7b9007c67ed84c57c9e0ad86a6000da96eaa638e4f8abe5b65ff83f0a", size = 6720386, upload-time = "2025-07-01T09:15:27.378Z" },
+    { url = "https://files.pythonhosted.org/packages/e7/95/88efcaf384c3588e24259c4203b909cbe3e3c2d887af9e938c2022c9dd48/pillow-11.3.0-cp314-cp314-win32.whl", hash = "sha256:02a723e6bf909e7cea0dac1b0e0310be9d7650cd66222a5f1c571455c0a45214", size = 6370911, upload-time = "2025-07-01T09:15:29.294Z" },
+    { url = "https://files.pythonhosted.org/packages/2e/cc/934e5820850ec5eb107e7b1a72dd278140731c669f396110ebc326f2a503/pillow-11.3.0-cp314-cp314-win_amd64.whl", hash = "sha256:a418486160228f64dd9e9efcd132679b7a02a5f22c982c78b6fc7dab3fefb635", size = 7117383, upload-time = "2025-07-01T09:15:31.128Z" },
+    { url = "https://files.pythonhosted.org/packages/d6/e9/9c0a616a71da2a5d163aa37405e8aced9a906d574b4a214bede134e731bc/pillow-11.3.0-cp314-cp314-win_arm64.whl", hash = "sha256:155658efb5e044669c08896c0c44231c5e9abcaadbc5cd3648df2f7c0b96b9a6", size = 2511385, upload-time = "2025-07-01T09:15:33.328Z" },
+    { url = "https://files.pythonhosted.org/packages/1a/33/c88376898aff369658b225262cd4f2659b13e8178e7534df9e6e1fa289f6/pillow-11.3.0-cp314-cp314t-macosx_10_13_x86_64.whl", hash = "sha256:59a03cdf019efbfeeed910bf79c7c93255c3d54bc45898ac2a4140071b02b4ae", size = 5281129, upload-time = "2025-07-01T09:15:35.194Z" },
+    { url = "https://files.pythonhosted.org/packages/1f/70/d376247fb36f1844b42910911c83a02d5544ebd2a8bad9efcc0f707ea774/pillow-11.3.0-cp314-cp314t-macosx_11_0_arm64.whl", hash = "sha256:f8a5827f84d973d8636e9dc5764af4f0cf2318d26744b3d902931701b0d46653", size = 4689580, upload-time = "2025-07-01T09:15:37.114Z" },
+    { url = "https://files.pythonhosted.org/packages/eb/1c/537e930496149fbac69efd2fc4329035bbe2e5475b4165439e3be9cb183b/pillow-11.3.0-cp314-cp314t-manylinux2014_aarch64.manylinux_2_17_aarch64.whl", hash = "sha256:ee92f2fd10f4adc4b43d07ec5e779932b4eb3dbfbc34790ada5a6669bc095aa6", size = 5902860, upload-time = "2025-07-03T13:10:50.248Z" },
+    { url = "https://files.pythonhosted.org/packages/bd/57/80f53264954dcefeebcf9dae6e3eb1daea1b488f0be8b8fef12f79a3eb10/pillow-11.3.0-cp314-cp314t-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:c96d333dcf42d01f47b37e0979b6bd73ec91eae18614864622d9b87bbd5bbf36", size = 7670694, upload-time = "2025-07-03T13:10:56.432Z" },
+    { url = "https://files.pythonhosted.org/packages/70/ff/4727d3b71a8578b4587d9c276e90efad2d6fe0335fd76742a6da08132e8c/pillow-11.3.0-cp314-cp314t-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:4c96f993ab8c98460cd0c001447bff6194403e8b1d7e149ade5f00594918128b", size = 6005888, upload-time = "2025-07-01T09:15:39.436Z" },
+    { url = "https://files.pythonhosted.org/packages/05/ae/716592277934f85d3be51d7256f3636672d7b1abfafdc42cf3f8cbd4b4c8/pillow-11.3.0-cp314-cp314t-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:41342b64afeba938edb034d122b2dda5db2139b9a4af999729ba8818e0056477", size = 6670330, upload-time = "2025-07-01T09:15:41.269Z" },
+    { url = "https://files.pythonhosted.org/packages/e7/bb/7fe6cddcc8827b01b1a9766f5fdeb7418680744f9082035bdbabecf1d57f/pillow-11.3.0-cp314-cp314t-musllinux_1_2_aarch64.whl", hash = "sha256:068d9c39a2d1b358eb9f245ce7ab1b5c3246c7c8c7d9ba58cfa5b43146c06e50", size = 6114089, upload-time = "2025-07-01T09:15:43.13Z" },
+    { url = "https://files.pythonhosted.org/packages/8b/f5/06bfaa444c8e80f1a8e4bff98da9c83b37b5be3b1deaa43d27a0db37ef84/pillow-11.3.0-cp314-cp314t-musllinux_1_2_x86_64.whl", hash = "sha256:a1bc6ba083b145187f648b667e05a2534ecc4b9f2784c2cbe3089e44868f2b9b", size = 6748206, upload-time = "2025-07-01T09:15:44.937Z" },
+    { url = "https://files.pythonhosted.org/packages/f0/77/bc6f92a3e8e6e46c0ca78abfffec0037845800ea38c73483760362804c41/pillow-11.3.0-cp314-cp314t-win32.whl", hash = "sha256:118ca10c0d60b06d006be10a501fd6bbdfef559251ed31b794668ed569c87e12", size = 6377370, upload-time = "2025-07-01T09:15:46.673Z" },
+    { url = "https://files.pythonhosted.org/packages/4a/82/3a721f7d69dca802befb8af08b7c79ebcab461007ce1c18bd91a5d5896f9/pillow-11.3.0-cp314-cp314t-win_amd64.whl", hash = "sha256:8924748b688aa210d79883357d102cd64690e56b923a186f35a82cbc10f997db", size = 7121500, upload-time = "2025-07-01T09:15:48.512Z" },
+    { url = "https://files.pythonhosted.org/packages/89/c7/5572fa4a3f45740eaab6ae86fcdf7195b55beac1371ac8c619d880cfe948/pillow-11.3.0-cp314-cp314t-win_arm64.whl", hash = "sha256:79ea0d14d3ebad43ec77ad5272e6ff9bba5b679ef73375ea760261207fa8e0aa", size = 2512835, upload-time = "2025-07-01T09:15:50.399Z" },
+    { url = "https://files.pythonhosted.org/packages/9e/8e/9c089f01677d1264ab8648352dcb7773f37da6ad002542760c80107da816/pillow-11.3.0-cp39-cp39-macosx_10_10_x86_64.whl", hash = "sha256:48d254f8a4c776de343051023eb61ffe818299eeac478da55227d96e241de53f", size = 5316478, upload-time = "2025-07-01T09:15:52.209Z" },
+    { url = "https://files.pythonhosted.org/packages/b5/a9/5749930caf674695867eb56a581e78eb5f524b7583ff10b01b6e5048acb3/pillow-11.3.0-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:7aee118e30a4cf54fdd873bd3a29de51e29105ab11f9aad8c32123f58c8f8081", size = 4686522, upload-time = "2025-07-01T09:15:54.162Z" },
+    { url = "https://files.pythonhosted.org/packages/43/46/0b85b763eb292b691030795f9f6bb6fcaf8948c39413c81696a01c3577f7/pillow-11.3.0-cp39-cp39-manylinux2014_aarch64.manylinux_2_17_aarch64.whl", hash = "sha256:23cff760a9049c502721bdb743a7cb3e03365fafcdfc2ef9784610714166e5a4", size = 5853376, upload-time = "2025-07-03T13:11:01.066Z" },
+    { url = "https://files.pythonhosted.org/packages/5e/c6/1a230ec0067243cbd60bc2dad5dc3ab46a8a41e21c15f5c9b52b26873069/pillow-11.3.0-cp39-cp39-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:6359a3bc43f57d5b375d1ad54a0074318a0844d11b76abccf478c37c986d3cfc", size = 7626020, upload-time = "2025-07-03T13:11:06.479Z" },
+    { url = "https://files.pythonhosted.org/packages/63/dd/f296c27ffba447bfad76c6a0c44c1ea97a90cb9472b9304c94a732e8dbfb/pillow-11.3.0-cp39-cp39-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:092c80c76635f5ecb10f3f83d76716165c96f5229addbd1ec2bdbbda7d496e06", size = 5956732, upload-time = "2025-07-01T09:15:56.111Z" },
+    { url = "https://files.pythonhosted.org/packages/a5/a0/98a3630f0b57f77bae67716562513d3032ae70414fcaf02750279c389a9e/pillow-11.3.0-cp39-cp39-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:cadc9e0ea0a2431124cde7e1697106471fc4c1da01530e679b2391c37d3fbb3a", size = 6624404, upload-time = "2025-07-01T09:15:58.245Z" },
+    { url = "https://files.pythonhosted.org/packages/de/e6/83dfba5646a290edd9a21964da07674409e410579c341fc5b8f7abd81620/pillow-11.3.0-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:6a418691000f2a418c9135a7cf0d797c1bb7d9a485e61fe8e7722845b95ef978", size = 6067760, upload-time = "2025-07-01T09:16:00.003Z" },
+    { url = "https://files.pythonhosted.org/packages/bc/41/15ab268fe6ee9a2bc7391e2bbb20a98d3974304ab1a406a992dcb297a370/pillow-11.3.0-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:97afb3a00b65cc0804d1c7abddbf090a81eaac02768af58cbdcaaa0a931e0b6d", size = 6700534, upload-time = "2025-07-01T09:16:02.29Z" },
+    { url = "https://files.pythonhosted.org/packages/64/79/6d4f638b288300bed727ff29f2a3cb63db054b33518a95f27724915e3fbc/pillow-11.3.0-cp39-cp39-win32.whl", hash = "sha256:ea944117a7974ae78059fcc1800e5d3295172bb97035c0c1d9345fca1419da71", size = 6277091, upload-time = "2025-07-01T09:16:04.4Z" },
+    { url = "https://files.pythonhosted.org/packages/46/05/4106422f45a05716fd34ed21763f8ec182e8ea00af6e9cb05b93a247361a/pillow-11.3.0-cp39-cp39-win_amd64.whl", hash = "sha256:e5c5858ad8ec655450a7c7df532e9842cf8df7cc349df7225c60d5d348c8aada", size = 6986091, upload-time = "2025-07-01T09:16:06.342Z" },
+    { url = "https://files.pythonhosted.org/packages/63/c6/287fd55c2c12761d0591549d48885187579b7c257bef0c6660755b0b59ae/pillow-11.3.0-cp39-cp39-win_arm64.whl", hash = "sha256:6abdbfd3aea42be05702a8dd98832329c167ee84400a1d1f61ab11437f1717eb", size = 2422632, upload-time = "2025-07-01T09:16:08.142Z" },
+    { url = "https://files.pythonhosted.org/packages/6f/8b/209bd6b62ce8367f47e68a218bffac88888fdf2c9fcf1ecadc6c3ec1ebc7/pillow-11.3.0-pp310-pypy310_pp73-macosx_10_15_x86_64.whl", hash = "sha256:3cee80663f29e3843b68199b9d6f4f54bd1d4a6b59bdd91bceefc51238bcb967", size = 5270556, upload-time = "2025-07-01T09:16:09.961Z" },
+    { url = "https://files.pythonhosted.org/packages/2e/e6/231a0b76070c2cfd9e260a7a5b504fb72da0a95279410fa7afd99d9751d6/pillow-11.3.0-pp310-pypy310_pp73-macosx_11_0_arm64.whl", hash = "sha256:b5f56c3f344f2ccaf0dd875d3e180f631dc60a51b314295a3e681fe8cf851fbe", size = 4654625, upload-time = "2025-07-01T09:16:11.913Z" },
+    { url = "https://files.pythonhosted.org/packages/13/f4/10cf94fda33cb12765f2397fc285fa6d8eb9c29de7f3185165b702fc7386/pillow-11.3.0-pp310-pypy310_pp73-manylinux2014_aarch64.manylinux_2_17_aarch64.whl", hash = "sha256:e67d793d180c9df62f1f40aee3accca4829d3794c95098887edc18af4b8b780c", size = 4874207, upload-time = "2025-07-03T13:11:10.201Z" },
+    { url = "https://files.pythonhosted.org/packages/72/c9/583821097dc691880c92892e8e2d41fe0a5a3d6021f4963371d2f6d57250/pillow-11.3.0-pp310-pypy310_pp73-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:d000f46e2917c705e9fb93a3606ee4a819d1e3aa7a9b442f6444f07e77cf5e25", size = 6583939, upload-time = "2025-07-03T13:11:15.68Z" },
+    { url = "https://files.pythonhosted.org/packages/3b/8e/5c9d410f9217b12320efc7c413e72693f48468979a013ad17fd690397b9a/pillow-11.3.0-pp310-pypy310_pp73-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:527b37216b6ac3a12d7838dc3bd75208ec57c1c6d11ef01902266a5a0c14fc27", size = 4957166, upload-time = "2025-07-01T09:16:13.74Z" },
+    { url = "https://files.pythonhosted.org/packages/62/bb/78347dbe13219991877ffb3a91bf09da8317fbfcd4b5f9140aeae020ad71/pillow-11.3.0-pp310-pypy310_pp73-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:be5463ac478b623b9dd3937afd7fb7ab3d79dd290a28e2b6df292dc75063eb8a", size = 5581482, upload-time = "2025-07-01T09:16:16.107Z" },
+    { url = "https://files.pythonhosted.org/packages/d9/28/1000353d5e61498aaeaaf7f1e4b49ddb05f2c6575f9d4f9f914a3538b6e1/pillow-11.3.0-pp310-pypy310_pp73-win_amd64.whl", hash = "sha256:8dc70ca24c110503e16918a658b869019126ecfe03109b754c402daff12b3d9f", size = 6984596, upload-time = "2025-07-01T09:16:18.07Z" },
+    { url = "https://files.pythonhosted.org/packages/9e/e3/6fa84033758276fb31da12e5fb66ad747ae83b93c67af17f8c6ff4cc8f34/pillow-11.3.0-pp311-pypy311_pp73-macosx_10_15_x86_64.whl", hash = "sha256:7c8ec7a017ad1bd562f93dbd8505763e688d388cde6e4a010ae1486916e713e6", size = 5270566, upload-time = "2025-07-01T09:16:19.801Z" },
+    { url = "https://files.pythonhosted.org/packages/5b/ee/e8d2e1ab4892970b561e1ba96cbd59c0d28cf66737fc44abb2aec3795a4e/pillow-11.3.0-pp311-pypy311_pp73-macosx_11_0_arm64.whl", hash = "sha256:9ab6ae226de48019caa8074894544af5b53a117ccb9d3b3dcb2871464c829438", size = 4654618, upload-time = "2025-07-01T09:16:21.818Z" },
+    { url = "https://files.pythonhosted.org/packages/f2/6d/17f80f4e1f0761f02160fc433abd4109fa1548dcfdca46cfdadaf9efa565/pillow-11.3.0-pp311-pypy311_pp73-manylinux2014_aarch64.manylinux_2_17_aarch64.whl", hash = "sha256:fe27fb049cdcca11f11a7bfda64043c37b30e6b91f10cb5bab275806c32f6ab3", size = 4874248, upload-time = "2025-07-03T13:11:20.738Z" },
+    { url = "https://files.pythonhosted.org/packages/de/5f/c22340acd61cef960130585bbe2120e2fd8434c214802f07e8c03596b17e/pillow-11.3.0-pp311-pypy311_pp73-manylinux2014_x86_64.manylinux_2_17_x86_64.whl", hash = "sha256:465b9e8844e3c3519a983d58b80be3f668e2a7a5db97f2784e7079fbc9f9822c", size = 6583963, upload-time = "2025-07-03T13:11:26.283Z" },
+    { url = "https://files.pythonhosted.org/packages/31/5e/03966aedfbfcbb4d5f8aa042452d3361f325b963ebbadddac05b122e47dd/pillow-11.3.0-pp311-pypy311_pp73-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:5418b53c0d59b3824d05e029669efa023bbef0f3e92e75ec8428f3799487f361", size = 4957170, upload-time = "2025-07-01T09:16:23.762Z" },
+    { url = "https://files.pythonhosted.org/packages/cc/2d/e082982aacc927fc2cab48e1e731bdb1643a1406acace8bed0900a61464e/pillow-11.3.0-pp311-pypy311_pp73-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:504b6f59505f08ae014f724b6207ff6222662aab5cc9542577fb084ed0676ac7", size = 5581505, upload-time = "2025-07-01T09:16:25.593Z" },
+    { url = "https://files.pythonhosted.org/packages/34/e7/ae39f538fd6844e982063c3a5e4598b8ced43b9633baa3a85ef33af8c05c/pillow-11.3.0-pp311-pypy311_pp73-win_amd64.whl", hash = "sha256:c84d689db21a1c397d001aa08241044aa2069e7587b398c8cc63020390b1c1b8", size = 6984598, upload-time = "2025-07-01T09:16:27.732Z" },
+]
+
+[[package]]
+name = "platformdirs"
+version = "4.3.6"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/13/fc/128cc9cb8f03208bdbf93d3aa862e16d376844a14f9a0ce5cf4507372de4/platformdirs-4.3.6.tar.gz", hash = "sha256:357fb2acbc885b0419afd3ce3ed34564c13c9b95c89360cd9563f73aa5e2b907", size = 21302, upload-time = "2024-09-17T19:06:50.688Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/3c/a6/bc1012356d8ece4d66dd75c4b9fc6c1f6650ddd5991e421177d9f8f671be/platformdirs-4.3.6-py3-none-any.whl", hash = "sha256:73e575e1408ab8103900836b97580d5307456908a03e92031bab39e4554cc3fb", size = 18439, upload-time = "2024-09-17T19:06:49.212Z" },
+]
+
+[[package]]
+name = "platformdirs"
+version = "4.4.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/23/e8/21db9c9987b0e728855bd57bff6984f67952bea55d6f75e055c46b5383e8/platformdirs-4.4.0.tar.gz", hash = "sha256:ca753cf4d81dc309bc67b0ea38fd15dc97bc30ce419a7f58d13eb3bf14c4febf", size = 21634, upload-time = "2025-08-26T14:32:04.268Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/40/4b/2028861e724d3bd36227adfa20d3fd24c3fc6d52032f4a93c133be5d17ce/platformdirs-4.4.0-py3-none-any.whl", hash = "sha256:abd01743f24e5287cd7a5db3752faf1a2d65353f38ec26d98e25a6db65958c85", size = 18654, upload-time = "2025-08-26T14:32:02.735Z" },
+]
+
+[[package]]
+name = "pre-commit"
+version = "3.5.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "cfgv", marker = "python_full_version < '3.9'" },
+    { name = "identify", version = "2.6.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "nodeenv", marker = "python_full_version < '3.9'" },
+    { name = "pyyaml", marker = "python_full_version < '3.9'" },
+    { name = "virtualenv", marker = "python_full_version < '3.9'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/04/b3/4ae08d21eb097162f5aad37f4585f8069a86402ed7f5362cc9ae097f9572/pre_commit-3.5.0.tar.gz", hash = "sha256:5804465c675b659b0862f07907f96295d490822a450c4c40e747d0b1c6ebcb32", size = 177079, upload-time = "2023-10-13T15:57:48.334Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/6c/75/526915fedf462e05eeb1c75ceaf7e3f9cde7b5ce6f62740fe5f7f19a0050/pre_commit-3.5.0-py2.py3-none-any.whl", hash = "sha256:841dc9aef25daba9a0238cd27984041fa0467b4199fc4852e27950664919f660", size = 203698, upload-time = "2023-10-13T15:57:46.378Z" },
+]
+
+[[package]]
+name = "pre-commit"
+version = "4.3.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "cfgv", marker = "python_full_version >= '3.9'" },
+    { name = "identify", version = "2.6.15", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+    { name = "nodeenv", marker = "python_full_version >= '3.9'" },
+    { name = "pyyaml", marker = "python_full_version >= '3.9'" },
+    { name = "virtualenv", marker = "python_full_version >= '3.9'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/ff/29/7cf5bbc236333876e4b41f56e06857a87937ce4bf91e117a6991a2dbb02a/pre_commit-4.3.0.tar.gz", hash = "sha256:499fe450cc9d42e9d58e606262795ecb64dd05438943c62b66f6a8673da30b16", size = 193792, upload-time = "2025-08-09T18:56:14.651Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/5b/a5/987a405322d78a73b66e39e4a90e4ef156fd7141bf71df987e50717c321b/pre_commit-4.3.0-py2.py3-none-any.whl", hash = "sha256:2b0747ad7e6e967169136edffee14c16e148a778a54e4f967921aa1ebf2308d8", size = 220965, upload-time = "2025-08-09T18:56:13.192Z" },
+]
+
+[[package]]
+name = "psutil"
+version = "7.1.0"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/b3/31/4723d756b59344b643542936e37a31d1d3204bcdc42a7daa8ee9eb06fb50/psutil-7.1.0.tar.gz", hash = "sha256:655708b3c069387c8b77b072fc429a57d0e214221d01c0a772df7dfedcb3bcd2", size = 497660, upload-time = "2025-09-17T20:14:52.902Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/46/62/ce4051019ee20ce0ed74432dd73a5bb087a6704284a470bb8adff69a0932/psutil-7.1.0-cp36-abi3-macosx_10_9_x86_64.whl", hash = "sha256:76168cef4397494250e9f4e73eb3752b146de1dd950040b29186d0cce1d5ca13", size = 245242, upload-time = "2025-09-17T20:14:56.126Z" },
+    { url = "https://files.pythonhosted.org/packages/38/61/f76959fba841bf5b61123fbf4b650886dc4094c6858008b5bf73d9057216/psutil-7.1.0-cp36-abi3-macosx_11_0_arm64.whl", hash = "sha256:5d007560c8c372efdff9e4579c2846d71de737e4605f611437255e81efcca2c5", size = 246682, upload-time = "2025-09-17T20:14:58.25Z" },
+    { url = "https://files.pythonhosted.org/packages/88/7a/37c99d2e77ec30d63398ffa6a660450b8a62517cabe44b3e9bae97696e8d/psutil-7.1.0-cp36-abi3-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:22e4454970b32472ce7deaa45d045b34d3648ce478e26a04c7e858a0a6e75ff3", size = 287994, upload-time = "2025-09-17T20:14:59.901Z" },
+    { url = "https://files.pythonhosted.org/packages/9d/de/04c8c61232f7244aa0a4b9a9fbd63a89d5aeaf94b2fc9d1d16e2faa5cbb0/psutil-7.1.0-cp36-abi3-manylinux_2_12_x86_64.manylinux2010_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:8c70e113920d51e89f212dd7be06219a9b88014e63a4cec69b684c327bc474e3", size = 291163, upload-time = "2025-09-17T20:15:01.481Z" },
+    { url = "https://files.pythonhosted.org/packages/f4/58/c4f976234bf6d4737bc8c02a81192f045c307b72cf39c9e5c5a2d78927f6/psutil-7.1.0-cp36-abi3-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:7d4a113425c037300de3ac8b331637293da9be9713855c4fc9d2d97436d7259d", size = 293625, upload-time = "2025-09-17T20:15:04.492Z" },
+    { url = "https://files.pythonhosted.org/packages/79/87/157c8e7959ec39ced1b11cc93c730c4fb7f9d408569a6c59dbd92ceb35db/psutil-7.1.0-cp37-abi3-win32.whl", hash = "sha256:09ad740870c8d219ed8daae0ad3b726d3bf9a028a198e7f3080f6a1888b99bca", size = 244812, upload-time = "2025-09-17T20:15:07.462Z" },
+    { url = "https://files.pythonhosted.org/packages/bf/e9/b44c4f697276a7a95b8e94d0e320a7bf7f3318521b23de69035540b39838/psutil-7.1.0-cp37-abi3-win_amd64.whl", hash = "sha256:57f5e987c36d3146c0dd2528cd42151cf96cd359b9d67cfff836995cc5df9a3d", size = 247965, upload-time = "2025-09-17T20:15:09.673Z" },
+    { url = "https://files.pythonhosted.org/packages/26/65/1070a6e3c036f39142c2820c4b52e9243246fcfc3f96239ac84472ba361e/psutil-7.1.0-cp37-abi3-win_arm64.whl", hash = "sha256:6937cb68133e7c97b6cc9649a570c9a18ba0efebed46d8c5dae4c07fa1b67a07", size = 244971, upload-time = "2025-09-17T20:15:12.262Z" },
+]
+
+[[package]]
+name = "pydata-sphinx-theme"
+version = "0.16.1"
+source = { registry = "https://pypi.org/simple" }
+dependencies = [
+    { name = "accessible-pygments", marker = "python_full_version >= '3.9'" },
+    { name = "babel", marker = "python_full_version >= '3.9'" },
+    { name = "beautifulsoup4", marker = "python_full_version >= '3.9'" },
+    { name = "docutils", version = "0.21.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+    { name = "pygments", marker = "python_full_version >= '3.9'" },
+    { name = "sphinx", version = "7.4.7", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "sphinx", version = "8.1.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.10.*'" },
+    { name = "sphinx", version = "8.2.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.11'" },
+    { name = "typing-extensions", version = "4.15.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/00/20/bb50f9de3a6de69e6abd6b087b52fa2418a0418b19597601605f855ad044/pydata_sphinx_theme-0.16.1.tar.gz", hash = "sha256:a08b7f0b7f70387219dc659bff0893a7554d5eb39b59d3b8ef37b8401b7642d7", size = 2412693, upload-time = "2024-12-17T10:53:39.537Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/e2/0d/8ba33fa83a7dcde13eb3c1c2a0c1cc29950a048bfed6d9b0d8b6bd710b4c/pydata_sphinx_theme-0.16.1-py3-none-any.whl", hash = "sha256:225331e8ac4b32682c18fcac5a57a6f717c4e632cea5dd0e247b55155faeccde", size = 6723264, upload-time = "2024-12-17T10:53:35.645Z" },
+]
+
+[[package]]
+name = "pyglet"
+version = "2.1.9"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/1a/98/c8c7c8ac2911ba7c547dfb2be3d9ce69ed0fa98b166d0c8a6cf7c01f44cd/pyglet-2.1.9.tar.gz", hash = "sha256:855bb55ffe05d98e95a7e4ad72969cb2ba8d57edbd6a7515db51a0479287f014", size = 6593094, upload-time = "2025-09-21T09:27:05.403Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/b8/bf/68770984180ce5974e9f89a266db6a5678ff9c8b31c1116352d04be00b54/pyglet-2.1.9-py3-none-any.whl", hash = "sha256:ddd621c97729f8a344822792b4d51a600a8dd2113cde196d46376bdbcb6f1567", size = 1031866, upload-time = "2025-09-21T09:27:01.026Z" },
+]
+
+[[package]]
+name = "pygments"
+version = "2.19.2"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/b0/77/a5b8c569bf593b0140bde72ea885a803b82086995367bf2037de0159d924/pygments-2.19.2.tar.gz", hash = "sha256:636cb2477cec7f8952536970bc533bc43743542f70392ae026374600add5b887", size = 4968631, upload-time = "2025-06-21T13:39:12.283Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/c7/21/705964c7812476f378728bdf590ca4b771ec72385c533964653c68e86bdc/pygments-2.19.2-py3-none-any.whl", hash = "sha256:86540386c03d588bb81d44bc3928634ff26449851e99741617ecb9037ee5ec0b", size = 1225217, upload-time = "2025-06-21T13:39:07.939Z" },
+]
+
+[[package]]
+name = "pyparsing"
+version = "3.1.4"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/83/08/13f3bce01b2061f2bbd582c9df82723de943784cf719a35ac886c652043a/pyparsing-3.1.4.tar.gz", hash = "sha256:f86ec8d1a83f11977c9a6ea7598e8c27fc5cddfa5b07ea2241edbbde1d7bc032", size = 900231, upload-time = "2024-08-25T15:00:47.416Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/e5/0c/0e3c05b1c87bb6a1c76d281b0f35e78d2d80ac91b5f8f524cebf77f51049/pyparsing-3.1.4-py3-none-any.whl", hash = "sha256:a6a7ee4235a3f944aa1fa2249307708f893fe5717dc603503c6c7969c070fb7c", size = 104100, upload-time = "2024-08-25T15:00:45.361Z" },
+]
+
+[[package]]
+name = "pyparsing"
+version = "3.2.5"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/f2/a5/181488fc2b9d093e3972d2a472855aae8a03f000592dbfce716a512b3359/pyparsing-3.2.5.tar.gz", hash = "sha256:2df8d5b7b2802ef88e8d016a2eb9c7aeaa923529cd251ed0fe4608275d4105b6", size = 1099274, upload-time = "2025-09-21T04:11:06.277Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/10/5e/1aa9a93198c6b64513c9d7752de7422c06402de6600a8767da1524f9570b/pyparsing-3.2.5-py3-none-any.whl", hash = "sha256:e38a4f02064cf41fe6593d328d0512495ad1f3d8a91c4f73fc401b3079a59a5e", size = 113890, upload-time = "2025-09-21T04:11:04.117Z" },
+]
+
+[[package]]
+name = "python-dateutil"
+version = "2.9.0.post0"
+source = { registry = "https://pypi.org/simple" }
+dependencies = [
+    { name = "six" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/66/c0/0c8b6ad9f17a802ee498c46e004a0eb49bc148f2fd230864601a86dcf6db/python-dateutil-2.9.0.post0.tar.gz", hash = "sha256:37dd54208da7e1cd875388217d5e00ebd4179249f90fb72437e91a35459a0ad3", size = 342432, upload-time = "2024-03-01T18:36:20.211Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/ec/57/56b9bcc3c9c6a792fcbaf139543cee77261f3651ca9da0c93f5c1221264b/python_dateutil-2.9.0.post0-py2.py3-none-any.whl", hash = "sha256:a8b2bc7bffae282281c8140a97d3aa9c14da0b136dfe83f850eea9a5f7470427", size = 229892, upload-time = "2024-03-01T18:36:18.57Z" },
+]
+
+[[package]]
+name = "pytz"
+version = "2025.2"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/f8/bf/abbd3cdfb8fbc7fb3d4d38d320f2441b1e7cbe29be4f23797b4a2b5d8aac/pytz-2025.2.tar.gz", hash = "sha256:360b9e3dbb49a209c21ad61809c7fb453643e048b38924c765813546746e81c3", size = 320884, upload-time = "2025-03-25T02:25:00.538Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/81/c4/34e93fe5f5429d7570ec1fa436f1986fb1f00c3e0f43a589fe2bbcd22c3f/pytz-2025.2-py2.py3-none-any.whl", hash = "sha256:5ddf76296dd8c44c26eb8f4b6f35488f3ccbf6fbbd7adee0b7262d43f0ec2f00", size = 509225, upload-time = "2025-03-25T02:24:58.468Z" },
+]
+
+[[package]]
+name = "pyyaml"
+version = "6.0.3"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/05/8e/961c0007c59b8dd7729d542c61a4d537767a59645b82a0b521206e1e25c2/pyyaml-6.0.3.tar.gz", hash = "sha256:d76623373421df22fb4cf8817020cbb7ef15c725b9d5e45f17e189bfc384190f", size = 130960, upload-time = "2025-09-25T21:33:16.546Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/0d/a2/09f67a3589cb4320fb5ce90d3fd4c9752636b8b6ad8f34b54d76c5a54693/PyYAML-6.0.3-cp38-cp38-macosx_10_13_x86_64.whl", hash = "sha256:c2514fceb77bc5e7a2f7adfaa1feb2fb311607c9cb518dbc378688ec73d8292f", size = 186824, upload-time = "2025-09-29T20:27:35.918Z" },
+    { url = "https://files.pythonhosted.org/packages/02/72/d972384252432d57f248767556ac083793292a4adf4e2d85dfe785ec2659/PyYAML-6.0.3-cp38-cp38-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:9c57bb8c96f6d1808c030b1687b9b5fb476abaa47f0db9c0101f5e9f394e97f4", size = 795069, upload-time = "2025-09-29T20:27:38.15Z" },
+    { url = "https://files.pythonhosted.org/packages/a7/3b/6c58ac0fa7c4e1b35e48024eb03d00817438310447f93ef4431673c24138/PyYAML-6.0.3-cp38-cp38-manylinux2014_s390x.manylinux_2_17_s390x.manylinux_2_28_s390x.whl", hash = "sha256:efd7b85f94a6f21e4932043973a7ba2613b059c4a000551892ac9f1d11f5baf3", size = 862585, upload-time = "2025-09-29T20:27:39.715Z" },
+    { url = "https://files.pythonhosted.org/packages/25/a2/b725b61ac76a75583ae7104b3209f75ea44b13cfd026aa535ece22b7f22e/PyYAML-6.0.3-cp38-cp38-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:22ba7cfcad58ef3ecddc7ed1db3409af68d023b7f940da23c6c2a1890976eda6", size = 806018, upload-time = "2025-09-29T20:27:41.444Z" },
+    { url = "https://files.pythonhosted.org/packages/6f/b0/b2227677b2d1036d84f5ee95eb948e7af53d59fe3e4328784e4d290607e0/PyYAML-6.0.3-cp38-cp38-musllinux_1_2_x86_64.whl", hash = "sha256:6344df0d5755a2c9a276d4473ae6b90647e216ab4757f8426893b5dd2ac3f369", size = 802822, upload-time = "2025-09-29T20:27:42.885Z" },
+    { url = "https://files.pythonhosted.org/packages/99/a5/718a8ea22521e06ef19f91945766a892c5ceb1855df6adbde67d997ea7ed/PyYAML-6.0.3-cp38-cp38-win32.whl", hash = "sha256:3ff07ec89bae51176c0549bc4c63aa6202991da2d9a6129d7aef7f1407d3f295", size = 143744, upload-time = "2025-09-29T20:27:44.487Z" },
+    { url = "https://files.pythonhosted.org/packages/76/b2/2b69cee94c9eb215216fc05778675c393e3aa541131dc910df8e52c83776/PyYAML-6.0.3-cp38-cp38-win_amd64.whl", hash = "sha256:5cf4e27da7e3fbed4d6c3d8e797387aaad68102272f8f9752883bc32d61cb87b", size = 160082, upload-time = "2025-09-29T20:27:46.049Z" },
+    { url = "https://files.pythonhosted.org/packages/f4/a0/39350dd17dd6d6c6507025c0e53aef67a9293a6d37d3511f23ea510d5800/pyyaml-6.0.3-cp310-cp310-macosx_10_13_x86_64.whl", hash = "sha256:214ed4befebe12df36bcc8bc2b64b396ca31be9304b8f59e25c11cf94a4c033b", size = 184227, upload-time = "2025-09-25T21:31:46.04Z" },
+    { url = "https://files.pythonhosted.org/packages/05/14/52d505b5c59ce73244f59c7a50ecf47093ce4765f116cdb98286a71eeca2/pyyaml-6.0.3-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:02ea2dfa234451bbb8772601d7b8e426c2bfa197136796224e50e35a78777956", size = 174019, upload-time = "2025-09-25T21:31:47.706Z" },
+    { url = "https://files.pythonhosted.org/packages/43/f7/0e6a5ae5599c838c696adb4e6330a59f463265bfa1e116cfd1fbb0abaaae/pyyaml-6.0.3-cp310-cp310-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:b30236e45cf30d2b8e7b3e85881719e98507abed1011bf463a8fa23e9c3e98a8", size = 740646, upload-time = "2025-09-25T21:31:49.21Z" },
+    { url = "https://files.pythonhosted.org/packages/2f/3a/61b9db1d28f00f8fd0ae760459a5c4bf1b941baf714e207b6eb0657d2578/pyyaml-6.0.3-cp310-cp310-manylinux2014_s390x.manylinux_2_17_s390x.manylinux_2_28_s390x.whl", hash = "sha256:66291b10affd76d76f54fad28e22e51719ef9ba22b29e1d7d03d6777a9174198", size = 840793, upload-time = "2025-09-25T21:31:50.735Z" },
+    { url = "https://files.pythonhosted.org/packages/7a/1e/7acc4f0e74c4b3d9531e24739e0ab832a5edf40e64fbae1a9c01941cabd7/pyyaml-6.0.3-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:9c7708761fccb9397fe64bbc0395abcae8c4bf7b0eac081e12b809bf47700d0b", size = 770293, upload-time = "2025-09-25T21:31:51.828Z" },
+    { url = "https://files.pythonhosted.org/packages/8b/ef/abd085f06853af0cd59fa5f913d61a8eab65d7639ff2a658d18a25d6a89d/pyyaml-6.0.3-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:418cf3f2111bc80e0933b2cd8cd04f286338bb88bdc7bc8e6dd775ebde60b5e0", size = 732872, upload-time = "2025-09-25T21:31:53.282Z" },
+    { url = "https://files.pythonhosted.org/packages/1f/15/2bc9c8faf6450a8b3c9fc5448ed869c599c0a74ba2669772b1f3a0040180/pyyaml-6.0.3-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:5e0b74767e5f8c593e8c9b5912019159ed0533c70051e9cce3e8b6aa699fcd69", size = 758828, upload-time = "2025-09-25T21:31:54.807Z" },
+    { url = "https://files.pythonhosted.org/packages/a3/00/531e92e88c00f4333ce359e50c19b8d1de9fe8d581b1534e35ccfbc5f393/pyyaml-6.0.3-cp310-cp310-win32.whl", hash = "sha256:28c8d926f98f432f88adc23edf2e6d4921ac26fb084b028c733d01868d19007e", size = 142415, upload-time = "2025-09-25T21:31:55.885Z" },
+    { url = "https://files.pythonhosted.org/packages/2a/fa/926c003379b19fca39dd4634818b00dec6c62d87faf628d1394e137354d4/pyyaml-6.0.3-cp310-cp310-win_amd64.whl", hash = "sha256:bdb2c67c6c1390b63c6ff89f210c8fd09d9a1217a465701eac7316313c915e4c", size = 158561, upload-time = "2025-09-25T21:31:57.406Z" },
+    { url = "https://files.pythonhosted.org/packages/6d/16/a95b6757765b7b031c9374925bb718d55e0a9ba8a1b6a12d25962ea44347/pyyaml-6.0.3-cp311-cp311-macosx_10_13_x86_64.whl", hash = "sha256:44edc647873928551a01e7a563d7452ccdebee747728c1080d881d68af7b997e", size = 185826, upload-time = "2025-09-25T21:31:58.655Z" },
+    { url = "https://files.pythonhosted.org/packages/16/19/13de8e4377ed53079ee996e1ab0a9c33ec2faf808a4647b7b4c0d46dd239/pyyaml-6.0.3-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:652cb6edd41e718550aad172851962662ff2681490a8a711af6a4d288dd96824", size = 175577, upload-time = "2025-09-25T21:32:00.088Z" },
+    { url = "https://files.pythonhosted.org/packages/0c/62/d2eb46264d4b157dae1275b573017abec435397aa59cbcdab6fc978a8af4/pyyaml-6.0.3-cp311-cp311-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:10892704fc220243f5305762e276552a0395f7beb4dbf9b14ec8fd43b57f126c", size = 775556, upload-time = "2025-09-25T21:32:01.31Z" },
+    { url = "https://files.pythonhosted.org/packages/10/cb/16c3f2cf3266edd25aaa00d6c4350381c8b012ed6f5276675b9eba8d9ff4/pyyaml-6.0.3-cp311-cp311-manylinux2014_s390x.manylinux_2_17_s390x.manylinux_2_28_s390x.whl", hash = "sha256:850774a7879607d3a6f50d36d04f00ee69e7fc816450e5f7e58d7f17f1ae5c00", size = 882114, upload-time = "2025-09-25T21:32:03.376Z" },
+    { url = "https://files.pythonhosted.org/packages/71/60/917329f640924b18ff085ab889a11c763e0b573da888e8404ff486657602/pyyaml-6.0.3-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:b8bb0864c5a28024fac8a632c443c87c5aa6f215c0b126c449ae1a150412f31d", size = 806638, upload-time = "2025-09-25T21:32:04.553Z" },
+    { url = "https://files.pythonhosted.org/packages/dd/6f/529b0f316a9fd167281a6c3826b5583e6192dba792dd55e3203d3f8e655a/pyyaml-6.0.3-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:1d37d57ad971609cf3c53ba6a7e365e40660e3be0e5175fa9f2365a379d6095a", size = 767463, upload-time = "2025-09-25T21:32:06.152Z" },
+    { url = "https://files.pythonhosted.org/packages/f2/6a/b627b4e0c1dd03718543519ffb2f1deea4a1e6d42fbab8021936a4d22589/pyyaml-6.0.3-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:37503bfbfc9d2c40b344d06b2199cf0e96e97957ab1c1b546fd4f87e53e5d3e4", size = 794986, upload-time = "2025-09-25T21:32:07.367Z" },
+    { url = "https://files.pythonhosted.org/packages/45/91/47a6e1c42d9ee337c4839208f30d9f09caa9f720ec7582917b264defc875/pyyaml-6.0.3-cp311-cp311-win32.whl", hash = "sha256:8098f252adfa6c80ab48096053f512f2321f0b998f98150cea9bd23d83e1467b", size = 142543, upload-time = "2025-09-25T21:32:08.95Z" },
+    { url = "https://files.pythonhosted.org/packages/da/e3/ea007450a105ae919a72393cb06f122f288ef60bba2dc64b26e2646fa315/pyyaml-6.0.3-cp311-cp311-win_amd64.whl", hash = "sha256:9f3bfb4965eb874431221a3ff3fdcddc7e74e3b07799e0e84ca4a0f867d449bf", size = 158763, upload-time = "2025-09-25T21:32:09.96Z" },
+    { url = "https://files.pythonhosted.org/packages/d1/33/422b98d2195232ca1826284a76852ad5a86fe23e31b009c9886b2d0fb8b2/pyyaml-6.0.3-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:7f047e29dcae44602496db43be01ad42fc6f1cc0d8cd6c83d342306c32270196", size = 182063, upload-time = "2025-09-25T21:32:11.445Z" },
+    { url = "https://files.pythonhosted.org/packages/89/a0/6cf41a19a1f2f3feab0e9c0b74134aa2ce6849093d5517a0c550fe37a648/pyyaml-6.0.3-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:fc09d0aa354569bc501d4e787133afc08552722d3ab34836a80547331bb5d4a0", size = 173973, upload-time = "2025-09-25T21:32:12.492Z" },
+    { url = "https://files.pythonhosted.org/packages/ed/23/7a778b6bd0b9a8039df8b1b1d80e2e2ad78aa04171592c8a5c43a56a6af4/pyyaml-6.0.3-cp312-cp312-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:9149cad251584d5fb4981be1ecde53a1ca46c891a79788c0df828d2f166bda28", size = 775116, upload-time = "2025-09-25T21:32:13.652Z" },
+    { url = "https://files.pythonhosted.org/packages/65/30/d7353c338e12baef4ecc1b09e877c1970bd3382789c159b4f89d6a70dc09/pyyaml-6.0.3-cp312-cp312-manylinux2014_s390x.manylinux_2_17_s390x.manylinux_2_28_s390x.whl", hash = "sha256:5fdec68f91a0c6739b380c83b951e2c72ac0197ace422360e6d5a959d8d97b2c", size = 844011, upload-time = "2025-09-25T21:32:15.21Z" },
+    { url = "https://files.pythonhosted.org/packages/8b/9d/b3589d3877982d4f2329302ef98a8026e7f4443c765c46cfecc8858c6b4b/pyyaml-6.0.3-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:ba1cc08a7ccde2d2ec775841541641e4548226580ab850948cbfda66a1befcdc", size = 807870, upload-time = "2025-09-25T21:32:16.431Z" },
+    { url = "https://files.pythonhosted.org/packages/05/c0/b3be26a015601b822b97d9149ff8cb5ead58c66f981e04fedf4e762f4bd4/pyyaml-6.0.3-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:8dc52c23056b9ddd46818a57b78404882310fb473d63f17b07d5c40421e47f8e", size = 761089, upload-time = "2025-09-25T21:32:17.56Z" },
+    { url = "https://files.pythonhosted.org/packages/be/8e/98435a21d1d4b46590d5459a22d88128103f8da4c2d4cb8f14f2a96504e1/pyyaml-6.0.3-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:41715c910c881bc081f1e8872880d3c650acf13dfa8214bad49ed4cede7c34ea", size = 790181, upload-time = "2025-09-25T21:32:18.834Z" },
+    { url = "https://files.pythonhosted.org/packages/74/93/7baea19427dcfbe1e5a372d81473250b379f04b1bd3c4c5ff825e2327202/pyyaml-6.0.3-cp312-cp312-win32.whl", hash = "sha256:96b533f0e99f6579b3d4d4995707cf36df9100d67e0c8303a0c55b27b5f99bc5", size = 137658, upload-time = "2025-09-25T21:32:20.209Z" },
+    { url = "https://files.pythonhosted.org/packages/86/bf/899e81e4cce32febab4fb42bb97dcdf66bc135272882d1987881a4b519e9/pyyaml-6.0.3-cp312-cp312-win_amd64.whl", hash = "sha256:5fcd34e47f6e0b794d17de1b4ff496c00986e1c83f7ab2fb8fcfe9616ff7477b", size = 154003, upload-time = "2025-09-25T21:32:21.167Z" },
+    { url = "https://files.pythonhosted.org/packages/1a/08/67bd04656199bbb51dbed1439b7f27601dfb576fb864099c7ef0c3e55531/pyyaml-6.0.3-cp312-cp312-win_arm64.whl", hash = "sha256:64386e5e707d03a7e172c0701abfb7e10f0fb753ee1d773128192742712a98fd", size = 140344, upload-time = "2025-09-25T21:32:22.617Z" },
+    { url = "https://files.pythonhosted.org/packages/d1/11/0fd08f8192109f7169db964b5707a2f1e8b745d4e239b784a5a1dd80d1db/pyyaml-6.0.3-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:8da9669d359f02c0b91ccc01cac4a67f16afec0dac22c2ad09f46bee0697eba8", size = 181669, upload-time = "2025-09-25T21:32:23.673Z" },
+    { url = "https://files.pythonhosted.org/packages/b1/16/95309993f1d3748cd644e02e38b75d50cbc0d9561d21f390a76242ce073f/pyyaml-6.0.3-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:2283a07e2c21a2aa78d9c4442724ec1eb15f5e42a723b99cb3d822d48f5f7ad1", size = 173252, upload-time = "2025-09-25T21:32:25.149Z" },
+    { url = "https://files.pythonhosted.org/packages/50/31/b20f376d3f810b9b2371e72ef5adb33879b25edb7a6d072cb7ca0c486398/pyyaml-6.0.3-cp313-cp313-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:ee2922902c45ae8ccada2c5b501ab86c36525b883eff4255313a253a3160861c", size = 767081, upload-time = "2025-09-25T21:32:26.575Z" },
+    { url = "https://files.pythonhosted.org/packages/49/1e/a55ca81e949270d5d4432fbbd19dfea5321eda7c41a849d443dc92fd1ff7/pyyaml-6.0.3-cp313-cp313-manylinux2014_s390x.manylinux_2_17_s390x.manylinux_2_28_s390x.whl", hash = "sha256:a33284e20b78bd4a18c8c2282d549d10bc8408a2a7ff57653c0cf0b9be0afce5", size = 841159, upload-time = "2025-09-25T21:32:27.727Z" },
+    { url = "https://files.pythonhosted.org/packages/74/27/e5b8f34d02d9995b80abcef563ea1f8b56d20134d8f4e5e81733b1feceb2/pyyaml-6.0.3-cp313-cp313-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:0f29edc409a6392443abf94b9cf89ce99889a1dd5376d94316ae5145dfedd5d6", size = 801626, upload-time = "2025-09-25T21:32:28.878Z" },
+    { url = "https://files.pythonhosted.org/packages/f9/11/ba845c23988798f40e52ba45f34849aa8a1f2d4af4b798588010792ebad6/pyyaml-6.0.3-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:f7057c9a337546edc7973c0d3ba84ddcdf0daa14533c2065749c9075001090e6", size = 753613, upload-time = "2025-09-25T21:32:30.178Z" },
+    { url = "https://files.pythonhosted.org/packages/3d/e0/7966e1a7bfc0a45bf0a7fb6b98ea03fc9b8d84fa7f2229e9659680b69ee3/pyyaml-6.0.3-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:eda16858a3cab07b80edaf74336ece1f986ba330fdb8ee0d6c0d68fe82bc96be", size = 794115, upload-time = "2025-09-25T21:32:31.353Z" },
+    { url = "https://files.pythonhosted.org/packages/de/94/980b50a6531b3019e45ddeada0626d45fa85cbe22300844a7983285bed3b/pyyaml-6.0.3-cp313-cp313-win32.whl", hash = "sha256:d0eae10f8159e8fdad514efdc92d74fd8d682c933a6dd088030f3834bc8e6b26", size = 137427, upload-time = "2025-09-25T21:32:32.58Z" },
+    { url = "https://files.pythonhosted.org/packages/97/c9/39d5b874e8b28845e4ec2202b5da735d0199dbe5b8fb85f91398814a9a46/pyyaml-6.0.3-cp313-cp313-win_amd64.whl", hash = "sha256:79005a0d97d5ddabfeeea4cf676af11e647e41d81c9a7722a193022accdb6b7c", size = 154090, upload-time = "2025-09-25T21:32:33.659Z" },
+    { url = "https://files.pythonhosted.org/packages/73/e8/2bdf3ca2090f68bb3d75b44da7bbc71843b19c9f2b9cb9b0f4ab7a5a4329/pyyaml-6.0.3-cp313-cp313-win_arm64.whl", hash = "sha256:5498cd1645aa724a7c71c8f378eb29ebe23da2fc0d7a08071d89469bf1d2defb", size = 140246, upload-time = "2025-09-25T21:32:34.663Z" },
+    { url = "https://files.pythonhosted.org/packages/9d/8c/f4bd7f6465179953d3ac9bc44ac1a8a3e6122cf8ada906b4f96c60172d43/pyyaml-6.0.3-cp314-cp314-macosx_10_13_x86_64.whl", hash = "sha256:8d1fab6bb153a416f9aeb4b8763bc0f22a5586065f86f7664fc23339fc1c1fac", size = 181814, upload-time = "2025-09-25T21:32:35.712Z" },
+    { url = "https://files.pythonhosted.org/packages/bd/9c/4d95bb87eb2063d20db7b60faa3840c1b18025517ae857371c4dd55a6b3a/pyyaml-6.0.3-cp314-cp314-macosx_11_0_arm64.whl", hash = "sha256:34d5fcd24b8445fadc33f9cf348c1047101756fd760b4dacb5c3e99755703310", size = 173809, upload-time = "2025-09-25T21:32:36.789Z" },
+    { url = "https://files.pythonhosted.org/packages/92/b5/47e807c2623074914e29dabd16cbbdd4bf5e9b2db9f8090fa64411fc5382/pyyaml-6.0.3-cp314-cp314-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:501a031947e3a9025ed4405a168e6ef5ae3126c59f90ce0cd6f2bfc477be31b7", size = 766454, upload-time = "2025-09-25T21:32:37.966Z" },
+    { url = "https://files.pythonhosted.org/packages/02/9e/e5e9b168be58564121efb3de6859c452fccde0ab093d8438905899a3a483/pyyaml-6.0.3-cp314-cp314-manylinux2014_s390x.manylinux_2_17_s390x.manylinux_2_28_s390x.whl", hash = "sha256:b3bc83488de33889877a0f2543ade9f70c67d66d9ebb4ac959502e12de895788", size = 836355, upload-time = "2025-09-25T21:32:39.178Z" },
+    { url = "https://files.pythonhosted.org/packages/88/f9/16491d7ed2a919954993e48aa941b200f38040928474c9e85ea9e64222c3/pyyaml-6.0.3-cp314-cp314-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:c458b6d084f9b935061bc36216e8a69a7e293a2f1e68bf956dcd9e6cbcd143f5", size = 794175, upload-time = "2025-09-25T21:32:40.865Z" },
+    { url = "https://files.pythonhosted.org/packages/dd/3f/5989debef34dc6397317802b527dbbafb2b4760878a53d4166579111411e/pyyaml-6.0.3-cp314-cp314-musllinux_1_2_aarch64.whl", hash = "sha256:7c6610def4f163542a622a73fb39f534f8c101d690126992300bf3207eab9764", size = 755228, upload-time = "2025-09-25T21:32:42.084Z" },
+    { url = "https://files.pythonhosted.org/packages/d7/ce/af88a49043cd2e265be63d083fc75b27b6ed062f5f9fd6cdc223ad62f03e/pyyaml-6.0.3-cp314-cp314-musllinux_1_2_x86_64.whl", hash = "sha256:5190d403f121660ce8d1d2c1bb2ef1bd05b5f68533fc5c2ea899bd15f4399b35", size = 789194, upload-time = "2025-09-25T21:32:43.362Z" },
+    { url = "https://files.pythonhosted.org/packages/23/20/bb6982b26a40bb43951265ba29d4c246ef0ff59c9fdcdf0ed04e0687de4d/pyyaml-6.0.3-cp314-cp314-win_amd64.whl", hash = "sha256:4a2e8cebe2ff6ab7d1050ecd59c25d4c8bd7e6f400f5f82b96557ac0abafd0ac", size = 156429, upload-time = "2025-09-25T21:32:57.844Z" },
+    { url = "https://files.pythonhosted.org/packages/f4/f4/a4541072bb9422c8a883ab55255f918fa378ecf083f5b85e87fc2b4eda1b/pyyaml-6.0.3-cp314-cp314-win_arm64.whl", hash = "sha256:93dda82c9c22deb0a405ea4dc5f2d0cda384168e466364dec6255b293923b2f3", size = 143912, upload-time = "2025-09-25T21:32:59.247Z" },
+    { url = "https://files.pythonhosted.org/packages/7c/f9/07dd09ae774e4616edf6cda684ee78f97777bdd15847253637a6f052a62f/pyyaml-6.0.3-cp314-cp314t-macosx_10_13_x86_64.whl", hash = "sha256:02893d100e99e03eda1c8fd5c441d8c60103fd175728e23e431db1b589cf5ab3", size = 189108, upload-time = "2025-09-25T21:32:44.377Z" },
+    { url = "https://files.pythonhosted.org/packages/4e/78/8d08c9fb7ce09ad8c38ad533c1191cf27f7ae1effe5bb9400a46d9437fcf/pyyaml-6.0.3-cp314-cp314t-macosx_11_0_arm64.whl", hash = "sha256:c1ff362665ae507275af2853520967820d9124984e0f7466736aea23d8611fba", size = 183641, upload-time = "2025-09-25T21:32:45.407Z" },
+    { url = "https://files.pythonhosted.org/packages/7b/5b/3babb19104a46945cf816d047db2788bcaf8c94527a805610b0289a01c6b/pyyaml-6.0.3-cp314-cp314t-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:6adc77889b628398debc7b65c073bcb99c4a0237b248cacaf3fe8a557563ef6c", size = 831901, upload-time = "2025-09-25T21:32:48.83Z" },
+    { url = "https://files.pythonhosted.org/packages/8b/cc/dff0684d8dc44da4d22a13f35f073d558c268780ce3c6ba1b87055bb0b87/pyyaml-6.0.3-cp314-cp314t-manylinux2014_s390x.manylinux_2_17_s390x.manylinux_2_28_s390x.whl", hash = "sha256:a80cb027f6b349846a3bf6d73b5e95e782175e52f22108cfa17876aaeff93702", size = 861132, upload-time = "2025-09-25T21:32:50.149Z" },
+    { url = "https://files.pythonhosted.org/packages/b1/5e/f77dc6b9036943e285ba76b49e118d9ea929885becb0a29ba8a7c75e29fe/pyyaml-6.0.3-cp314-cp314t-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:00c4bdeba853cc34e7dd471f16b4114f4162dc03e6b7afcc2128711f0eca823c", size = 839261, upload-time = "2025-09-25T21:32:51.808Z" },
+    { url = "https://files.pythonhosted.org/packages/ce/88/a9db1376aa2a228197c58b37302f284b5617f56a5d959fd1763fb1675ce6/pyyaml-6.0.3-cp314-cp314t-musllinux_1_2_aarch64.whl", hash = "sha256:66e1674c3ef6f541c35191caae2d429b967b99e02040f5ba928632d9a7f0f065", size = 805272, upload-time = "2025-09-25T21:32:52.941Z" },
+    { url = "https://files.pythonhosted.org/packages/da/92/1446574745d74df0c92e6aa4a7b0b3130706a4142b2d1a5869f2eaa423c6/pyyaml-6.0.3-cp314-cp314t-musllinux_1_2_x86_64.whl", hash = "sha256:16249ee61e95f858e83976573de0f5b2893b3677ba71c9dd36b9cf8be9ac6d65", size = 829923, upload-time = "2025-09-25T21:32:54.537Z" },
+    { url = "https://files.pythonhosted.org/packages/f0/7a/1c7270340330e575b92f397352af856a8c06f230aa3e76f86b39d01b416a/pyyaml-6.0.3-cp314-cp314t-win_amd64.whl", hash = "sha256:4ad1906908f2f5ae4e5a8ddfce73c320c2a1429ec52eafd27138b7f1cbe341c9", size = 174062, upload-time = "2025-09-25T21:32:55.767Z" },
+    { url = "https://files.pythonhosted.org/packages/f1/12/de94a39c2ef588c7e6455cfbe7343d3b2dc9d6b6b2f40c4c6565744c873d/pyyaml-6.0.3-cp314-cp314t-win_arm64.whl", hash = "sha256:ebc55a14a21cb14062aa4162f906cd962b28e2e9ea38f9b4391244cd8de4ae0b", size = 149341, upload-time = "2025-09-25T21:32:56.828Z" },
+    { url = "https://files.pythonhosted.org/packages/9f/62/67fc8e68a75f738c9200422bf65693fb79a4cd0dc5b23310e5202e978090/pyyaml-6.0.3-cp39-cp39-macosx_10_13_x86_64.whl", hash = "sha256:b865addae83924361678b652338317d1bd7e79b1f4596f96b96c77a5a34b34da", size = 184450, upload-time = "2025-09-25T21:33:00.618Z" },
+    { url = "https://files.pythonhosted.org/packages/ae/92/861f152ce87c452b11b9d0977952259aa7df792d71c1053365cc7b09cc08/pyyaml-6.0.3-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:c3355370a2c156cffb25e876646f149d5d68f5e0a3ce86a5084dd0b64a994917", size = 174319, upload-time = "2025-09-25T21:33:02.086Z" },
+    { url = "https://files.pythonhosted.org/packages/d0/cd/f0cfc8c74f8a030017a2b9c771b7f47e5dd702c3e28e5b2071374bda2948/pyyaml-6.0.3-cp39-cp39-manylinux2014_aarch64.manylinux_2_17_aarch64.manylinux_2_28_aarch64.whl", hash = "sha256:3c5677e12444c15717b902a5798264fa7909e41153cdf9ef7ad571b704a63dd9", size = 737631, upload-time = "2025-09-25T21:33:03.25Z" },
+    { url = "https://files.pythonhosted.org/packages/ef/b2/18f2bd28cd2055a79a46c9b0895c0b3d987ce40ee471cecf58a1a0199805/pyyaml-6.0.3-cp39-cp39-manylinux2014_s390x.manylinux_2_17_s390x.manylinux_2_28_s390x.whl", hash = "sha256:5ed875a24292240029e4483f9d4a4b8a1ae08843b9c54f43fcc11e404532a8a5", size = 836795, upload-time = "2025-09-25T21:33:05.014Z" },
+    { url = "https://files.pythonhosted.org/packages/73/b9/793686b2d54b531203c160ef12bec60228a0109c79bae6c1277961026770/pyyaml-6.0.3-cp39-cp39-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:0150219816b6a1fa26fb4699fb7daa9caf09eb1999f3b70fb6e786805e80375a", size = 750767, upload-time = "2025-09-25T21:33:06.398Z" },
+    { url = "https://files.pythonhosted.org/packages/a9/86/a137b39a611def2ed78b0e66ce2fe13ee701a07c07aebe55c340ed2a050e/pyyaml-6.0.3-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:fa160448684b4e94d80416c0fa4aac48967a969efe22931448d853ada8baf926", size = 727982, upload-time = "2025-09-25T21:33:08.708Z" },
+    { url = "https://files.pythonhosted.org/packages/dd/62/71c27c94f457cf4418ef8ccc71735324c549f7e3ea9d34aba50874563561/pyyaml-6.0.3-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:27c0abcb4a5dac13684a37f76e701e054692a9b2d3064b70f5e4eb54810553d7", size = 755677, upload-time = "2025-09-25T21:33:09.876Z" },
+    { url = "https://files.pythonhosted.org/packages/29/3d/6f5e0d58bd924fb0d06c3a6bad00effbdae2de5adb5cda5648006ffbd8d3/pyyaml-6.0.3-cp39-cp39-win32.whl", hash = "sha256:1ebe39cb5fc479422b83de611d14e2c0d3bb2a18bbcb01f229ab3cfbd8fee7a0", size = 142592, upload-time = "2025-09-25T21:33:10.983Z" },
+    { url = "https://files.pythonhosted.org/packages/f0/0c/25113e0b5e103d7f1490c0e947e303fe4a696c10b501dea7a9f49d4e876c/pyyaml-6.0.3-cp39-cp39-win_amd64.whl", hash = "sha256:2e71d11abed7344e42a8849600193d15b6def118602c4c176f748e4583246007", size = 158777, upload-time = "2025-09-25T21:33:15.55Z" },
+]
+
+[[package]]
+name = "requests"
+version = "2.32.4"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "certifi", marker = "python_full_version < '3.9'" },
+    { name = "charset-normalizer", marker = "python_full_version < '3.9'" },
+    { name = "idna", marker = "python_full_version < '3.9'" },
+    { name = "urllib3", version = "2.2.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/e1/0a/929373653770d8a0d7ea76c37de6e41f11eb07559b103b1c02cafb3f7cf8/requests-2.32.4.tar.gz", hash = "sha256:27d0316682c8a29834d3264820024b62a36942083d52caf2f14c0591336d3422", size = 135258, upload-time = "2025-06-09T16:43:07.34Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/7c/e4/56027c4a6b4ae70ca9de302488c5ca95ad4a39e190093d6c1a8ace08341b/requests-2.32.4-py3-none-any.whl", hash = "sha256:27babd3cda2a6d50b30443204ee89830707d396671944c998b5975b031ac2b2c", size = 64847, upload-time = "2025-06-09T16:43:05.728Z" },
+]
+
+[[package]]
+name = "requests"
+version = "2.32.5"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "certifi", marker = "python_full_version >= '3.9'" },
+    { name = "charset-normalizer", marker = "python_full_version >= '3.9'" },
+    { name = "idna", marker = "python_full_version >= '3.9'" },
+    { name = "urllib3", version = "2.5.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/c9/74/b3ff8e6c8446842c3f5c837e9c3dfcfe2018ea6ecef224c710c85ef728f4/requests-2.32.5.tar.gz", hash = "sha256:dbba0bac56e100853db0ea71b82b4dfd5fe2bf6d3754a8893c3af500cec7d7cf", size = 134517, upload-time = "2025-08-18T20:46:02.573Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/1e/db/4254e3eabe8020b458f1a747140d32277ec7a271daf1d235b70dc0b4e6e3/requests-2.32.5-py3-none-any.whl", hash = "sha256:2462f94637a34fd532264295e186976db0f5d453d1cdd31473c85a6a161affb6", size = 64738, upload-time = "2025-08-18T20:46:00.542Z" },
+]
+
+[[package]]
+name = "roman-numerals-py"
+version = "3.1.0"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/30/76/48fd56d17c5bdbdf65609abbc67288728a98ed4c02919428d4f52d23b24b/roman_numerals_py-3.1.0.tar.gz", hash = "sha256:be4bf804f083a4ce001b5eb7e3c0862479d10f94c936f6c4e5f250aa5ff5bd2d", size = 9017, upload-time = "2025-02-22T07:34:54.333Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/53/97/d2cbbaa10c9b826af0e10fdf836e1bf344d9f0abb873ebc34d1f49642d3f/roman_numerals_py-3.1.0-py3-none-any.whl", hash = "sha256:9da2ad2fb670bcf24e81070ceb3be72f6c11c440d73bd579fbeca1e9f330954c", size = 7742, upload-time = "2025-02-22T07:34:52.422Z" },
+]
+
+[[package]]
+name = "setuptools"
+version = "80.9.0"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/18/5d/3bf57dcd21979b887f014ea83c24ae194cfcd12b9e0fda66b957c69d1fca/setuptools-80.9.0.tar.gz", hash = "sha256:f36b47402ecde768dbfafc46e8e4207b4360c654f1f3bb84475f0a28628fb19c", size = 1319958, upload-time = "2025-05-27T00:56:51.443Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/a3/dc/17031897dae0efacfea57dfd3a82fdd2a2aeb58e0ff71b77b87e44edc772/setuptools-80.9.0-py3-none-any.whl", hash = "sha256:062d34222ad13e0cc312a4c02d73f059e86a4acbfbdea8f8f76b28c99f306922", size = 1201486, upload-time = "2025-05-27T00:56:49.664Z" },
+]
+
+[[package]]
+name = "six"
+version = "1.17.0"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/94/e7/b2c673351809dca68a0e064b6af791aa332cf192da575fd474ed7d6f16a2/six-1.17.0.tar.gz", hash = "sha256:ff70335d468e7eb6ec65b95b99d3a2836546063f63acc5171de367e834932a81", size = 34031, upload-time = "2024-12-04T17:35:28.174Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/b7/ce/149a00dd41f10bc29e5921b496af8b574d8413afcd5e30dfa0ed46c2cc5e/six-1.17.0-py2.py3-none-any.whl", hash = "sha256:4721f391ed90541fddacab5acf947aa0d3dc7d27b2e1e8eda2be8970586c3274", size = 11050, upload-time = "2024-12-04T17:35:26.475Z" },
+]
+
+[[package]]
+name = "snowballstemmer"
+version = "3.0.1"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/75/a7/9810d872919697c9d01295633f5d574fb416d47e535f258272ca1f01f447/snowballstemmer-3.0.1.tar.gz", hash = "sha256:6d5eeeec8e9f84d4d56b847692bacf79bc2c8e90c7f80ca4444ff8b6f2e52895", size = 105575, upload-time = "2025-05-09T16:34:51.843Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/c8/78/3565d011c61f5a43488987ee32b6f3f656e7f107ac2782dd57bdd7d91d9a/snowballstemmer-3.0.1-py3-none-any.whl", hash = "sha256:6cd7b3897da8d6c9ffb968a6781fa6532dce9c3618a4b127d920dab764a19064", size = 103274, upload-time = "2025-05-09T16:34:50.371Z" },
+]
+
+[[package]]
+name = "soupsieve"
+version = "2.8"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/6d/e6/21ccce3262dd4889aa3332e5a119a3491a95e8f60939870a3a035aabac0d/soupsieve-2.8.tar.gz", hash = "sha256:e2dd4a40a628cb5f28f6d4b0db8800b8f581b65bb380b97de22ba5ca8d72572f", size = 103472, upload-time = "2025-08-27T15:39:51.78Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/14/a0/bb38d3b76b8cae341dad93a2dd83ab7462e6dbcdd84d43f54ee60a8dc167/soupsieve-2.8-py3-none-any.whl", hash = "sha256:0cc76456a30e20f5d7f2e14a98a4ae2ee4e5abdc7c5ea0aafe795f344bc7984c", size = 36679, upload-time = "2025-08-27T15:39:50.179Z" },
+]
+
+[[package]]
+name = "sphinx"
+version = "7.1.2"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "alabaster", version = "0.7.13", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "babel", marker = "python_full_version < '3.9'" },
+    { name = "colorama", marker = "python_full_version < '3.9' and sys_platform == 'win32'" },
+    { name = "docutils", version = "0.20.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "imagesize", marker = "python_full_version < '3.9'" },
+    { name = "importlib-metadata", version = "8.5.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "jinja2", marker = "python_full_version < '3.9'" },
+    { name = "packaging", marker = "python_full_version < '3.9'" },
+    { name = "pygments", marker = "python_full_version < '3.9'" },
+    { name = "requests", version = "2.32.4", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "snowballstemmer", marker = "python_full_version < '3.9'" },
+    { name = "sphinxcontrib-applehelp", version = "1.0.4", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "sphinxcontrib-devhelp", version = "1.0.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "sphinxcontrib-htmlhelp", version = "2.0.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "sphinxcontrib-jsmath", marker = "python_full_version < '3.9'" },
+    { name = "sphinxcontrib-qthelp", version = "1.0.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "sphinxcontrib-serializinghtml", version = "1.1.5", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/dc/01/688bdf9282241dca09fe6e3a1110eda399fa9b10d0672db609e37c2e7a39/sphinx-7.1.2.tar.gz", hash = "sha256:780f4d32f1d7d1126576e0e5ecc19dc32ab76cd24e950228dcf7b1f6d3d9e22f", size = 6828258, upload-time = "2023-08-02T02:06:09.375Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/48/17/325cf6a257d84751a48ae90752b3d8fe0be8f9535b6253add61c49d0d9bc/sphinx-7.1.2-py3-none-any.whl", hash = "sha256:d170a81825b2fcacb6dfd5a0d7f578a053e45d3f2b153fecc948c37344eb4cbe", size = 3169543, upload-time = "2023-08-02T02:06:06.816Z" },
+]
+
+[[package]]
+name = "sphinx"
+version = "7.4.7"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "alabaster", version = "0.7.16", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "babel", marker = "python_full_version == '3.9.*'" },
+    { name = "colorama", marker = "python_full_version == '3.9.*' and sys_platform == 'win32'" },
+    { name = "docutils", version = "0.21.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "imagesize", marker = "python_full_version == '3.9.*'" },
+    { name = "importlib-metadata", version = "8.7.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "jinja2", marker = "python_full_version == '3.9.*'" },
+    { name = "packaging", marker = "python_full_version == '3.9.*'" },
+    { name = "pygments", marker = "python_full_version == '3.9.*'" },
+    { name = "requests", version = "2.32.5", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "snowballstemmer", marker = "python_full_version == '3.9.*'" },
+    { name = "sphinxcontrib-applehelp", version = "2.0.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "sphinxcontrib-devhelp", version = "2.0.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "sphinxcontrib-htmlhelp", version = "2.1.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "sphinxcontrib-jsmath", marker = "python_full_version == '3.9.*'" },
+    { name = "sphinxcontrib-qthelp", version = "2.0.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "sphinxcontrib-serializinghtml", version = "2.0.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "tomli", marker = "python_full_version == '3.9.*'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/5b/be/50e50cb4f2eff47df05673d361095cafd95521d2a22521b920c67a372dcb/sphinx-7.4.7.tar.gz", hash = "sha256:242f92a7ea7e6c5b406fdc2615413890ba9f699114a9c09192d7dfead2ee9cfe", size = 8067911, upload-time = "2024-07-20T14:46:56.059Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/0d/ef/153f6803c5d5f8917dbb7f7fcf6d34a871ede3296fa89c2c703f5f8a6c8e/sphinx-7.4.7-py3-none-any.whl", hash = "sha256:c2419e2135d11f1951cd994d6eb18a1835bd8fdd8429f9ca375dc1f3281bd239", size = 3401624, upload-time = "2024-07-20T14:46:52.142Z" },
+]
+
+[[package]]
+name = "sphinx"
+version = "8.1.3"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "alabaster", version = "1.0.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.10.*'" },
+    { name = "babel", marker = "python_full_version == '3.10.*'" },
+    { name = "colorama", marker = "python_full_version == '3.10.*' and sys_platform == 'win32'" },
+    { name = "docutils", version = "0.21.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.10.*'" },
+    { name = "imagesize", marker = "python_full_version == '3.10.*'" },
+    { name = "jinja2", marker = "python_full_version == '3.10.*'" },
+    { name = "packaging", marker = "python_full_version == '3.10.*'" },
+    { name = "pygments", marker = "python_full_version == '3.10.*'" },
+    { name = "requests", version = "2.32.5", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.10.*'" },
+    { name = "snowballstemmer", marker = "python_full_version == '3.10.*'" },
+    { name = "sphinxcontrib-applehelp", version = "2.0.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.10.*'" },
+    { name = "sphinxcontrib-devhelp", version = "2.0.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.10.*'" },
+    { name = "sphinxcontrib-htmlhelp", version = "2.1.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.10.*'" },
+    { name = "sphinxcontrib-jsmath", marker = "python_full_version == '3.10.*'" },
+    { name = "sphinxcontrib-qthelp", version = "2.0.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.10.*'" },
+    { name = "sphinxcontrib-serializinghtml", version = "2.0.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.10.*'" },
+    { name = "tomli", marker = "python_full_version == '3.10.*'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/6f/6d/be0b61178fe2cdcb67e2a92fc9ebb488e3c51c4f74a36a7824c0adf23425/sphinx-8.1.3.tar.gz", hash = "sha256:43c1911eecb0d3e161ad78611bc905d1ad0e523e4ddc202a58a821773dc4c927", size = 8184611, upload-time = "2024-10-13T20:27:13.93Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/26/60/1ddff83a56d33aaf6f10ec8ce84b4c007d9368b21008876fceda7e7381ef/sphinx-8.1.3-py3-none-any.whl", hash = "sha256:09719015511837b76bf6e03e42eb7595ac8c2e41eeb9c29c5b755c6b677992a2", size = 3487125, upload-time = "2024-10-13T20:27:10.448Z" },
+]
+
+[[package]]
+name = "sphinx"
+version = "8.2.3"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+]
+dependencies = [
+    { name = "alabaster", version = "1.0.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.11'" },
+    { name = "babel", marker = "python_full_version >= '3.11'" },
+    { name = "colorama", marker = "python_full_version >= '3.11' and sys_platform == 'win32'" },
+    { name = "docutils", version = "0.21.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.11'" },
+    { name = "imagesize", marker = "python_full_version >= '3.11'" },
+    { name = "jinja2", marker = "python_full_version >= '3.11'" },
+    { name = "packaging", marker = "python_full_version >= '3.11'" },
+    { name = "pygments", marker = "python_full_version >= '3.11'" },
+    { name = "requests", version = "2.32.5", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.11'" },
+    { name = "roman-numerals-py", marker = "python_full_version >= '3.11'" },
+    { name = "snowballstemmer", marker = "python_full_version >= '3.11'" },
+    { name = "sphinxcontrib-applehelp", version = "2.0.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.11'" },
+    { name = "sphinxcontrib-devhelp", version = "2.0.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.11'" },
+    { name = "sphinxcontrib-htmlhelp", version = "2.1.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.11'" },
+    { name = "sphinxcontrib-jsmath", marker = "python_full_version >= '3.11'" },
+    { name = "sphinxcontrib-qthelp", version = "2.0.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.11'" },
+    { name = "sphinxcontrib-serializinghtml", version = "2.0.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.11'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/38/ad/4360e50ed56cb483667b8e6dadf2d3fda62359593faabbe749a27c4eaca6/sphinx-8.2.3.tar.gz", hash = "sha256:398ad29dee7f63a75888314e9424d40f52ce5a6a87ae88e7071e80af296ec348", size = 8321876, upload-time = "2025-03-02T22:31:59.658Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/31/53/136e9eca6e0b9dc0e1962e2c908fbea2e5ac000c2a2fbd9a35797958c48b/sphinx-8.2.3-py3-none-any.whl", hash = "sha256:4405915165f13521d875a8c29c8970800a0141c14cc5416a38feca4ea5d9b9c3", size = 3589741, upload-time = "2025-03-02T22:31:56.836Z" },
+]
+
+[[package]]
+name = "sphinx-copybutton"
+version = "0.5.2"
+source = { registry = "https://pypi.org/simple" }
+dependencies = [
+    { name = "sphinx", version = "7.1.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "sphinx", version = "7.4.7", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "sphinx", version = "8.1.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.10.*'" },
+    { name = "sphinx", version = "8.2.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.11'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/fc/2b/a964715e7f5295f77509e59309959f4125122d648f86b4fe7d70ca1d882c/sphinx-copybutton-0.5.2.tar.gz", hash = "sha256:4cf17c82fb9646d1bc9ca92ac280813a3b605d8c421225fd9913154103ee1fbd", size = 23039, upload-time = "2023-04-14T08:10:22.998Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/9e/48/1ea60e74949eecb12cdd6ac43987f9fd331156388dcc2319b45e2ebb81bf/sphinx_copybutton-0.5.2-py3-none-any.whl", hash = "sha256:fb543fd386d917746c9a2c50360c7905b605726b9355cd26e9974857afeae06e", size = 13343, upload-time = "2023-04-14T08:10:20.844Z" },
+]
+
+[[package]]
+name = "sphinxcontrib-applehelp"
+version = "1.0.4"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/32/df/45e827f4d7e7fcc84e853bcef1d836effd762d63ccb86f43ede4e98b478c/sphinxcontrib-applehelp-1.0.4.tar.gz", hash = "sha256:828f867945bbe39817c210a1abfd1bc4895c8b73fcaade56d45357a348a07d7e", size = 24766, upload-time = "2023-01-23T09:41:54.435Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/06/c1/5e2cafbd03105ce50d8500f9b4e8a6e8d02e22d0475b574c3b3e9451a15f/sphinxcontrib_applehelp-1.0.4-py3-none-any.whl", hash = "sha256:29d341f67fb0f6f586b23ad80e072c8e6ad0b48417db2bde114a4c9746feb228", size = 120601, upload-time = "2023-01-23T09:41:52.364Z" },
+]
+
+[[package]]
+name = "sphinxcontrib-applehelp"
+version = "2.0.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/ba/6e/b837e84a1a704953c62ef8776d45c3e8d759876b4a84fe14eba2859106fe/sphinxcontrib_applehelp-2.0.0.tar.gz", hash = "sha256:2f29ef331735ce958efa4734873f084941970894c6090408b079c61b2e1c06d1", size = 20053, upload-time = "2024-07-29T01:09:00.465Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/5d/85/9ebeae2f76e9e77b952f4b274c27238156eae7979c5421fba91a28f4970d/sphinxcontrib_applehelp-2.0.0-py3-none-any.whl", hash = "sha256:4cd3f0ec4ac5dd9c17ec65e9ab272c9b867ea77425228e68ecf08d6b28ddbdb5", size = 119300, upload-time = "2024-07-29T01:08:58.99Z" },
+]
+
+[[package]]
+name = "sphinxcontrib-devhelp"
+version = "1.0.2"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/98/33/dc28393f16385f722c893cb55539c641c9aaec8d1bc1c15b69ce0ac2dbb3/sphinxcontrib-devhelp-1.0.2.tar.gz", hash = "sha256:ff7f1afa7b9642e7060379360a67e9c41e8f3121f2ce9164266f61b9f4b338e4", size = 17398, upload-time = "2020-02-29T04:14:43.378Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/c5/09/5de5ed43a521387f18bdf5f5af31d099605c992fd25372b2b9b825ce48ee/sphinxcontrib_devhelp-1.0.2-py2.py3-none-any.whl", hash = "sha256:8165223f9a335cc1af7ffe1ed31d2871f325254c0423bc0c4c7cd1c1e4734a2e", size = 84690, upload-time = "2020-02-29T04:14:40.765Z" },
+]
+
+[[package]]
+name = "sphinxcontrib-devhelp"
+version = "2.0.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/f6/d2/5beee64d3e4e747f316bae86b55943f51e82bb86ecd325883ef65741e7da/sphinxcontrib_devhelp-2.0.0.tar.gz", hash = "sha256:411f5d96d445d1d73bb5d52133377b4248ec79db5c793ce7dbe59e074b4dd1ad", size = 12967, upload-time = "2024-07-29T01:09:23.417Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/35/7a/987e583882f985fe4d7323774889ec58049171828b58c2217e7f79cdf44e/sphinxcontrib_devhelp-2.0.0-py3-none-any.whl", hash = "sha256:aefb8b83854e4b0998877524d1029fd3e6879210422ee3780459e28a1f03a8a2", size = 82530, upload-time = "2024-07-29T01:09:21.945Z" },
+]
+
+[[package]]
+name = "sphinxcontrib-htmlhelp"
+version = "2.0.1"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/b3/47/64cff68ea3aa450c373301e5bebfbb9fce0a3e70aca245fcadd4af06cd75/sphinxcontrib-htmlhelp-2.0.1.tar.gz", hash = "sha256:0cbdd302815330058422b98a113195c9249825d681e18f11e8b1f78a2f11efff", size = 27967, upload-time = "2023-01-31T17:29:20.935Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/6e/ee/a1f5e39046cbb5f8bc8fba87d1ddf1c6643fbc9194e58d26e606de4b9074/sphinxcontrib_htmlhelp-2.0.1-py3-none-any.whl", hash = "sha256:c38cb46dccf316c79de6e5515e1770414b797162b23cd3d06e67020e1d2a6903", size = 99833, upload-time = "2023-01-31T17:29:18.489Z" },
+]
+
+[[package]]
+name = "sphinxcontrib-htmlhelp"
+version = "2.1.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/43/93/983afd9aa001e5201eab16b5a444ed5b9b0a7a010541e0ddfbbfd0b2470c/sphinxcontrib_htmlhelp-2.1.0.tar.gz", hash = "sha256:c9e2916ace8aad64cc13a0d233ee22317f2b9025b9cf3295249fa985cc7082e9", size = 22617, upload-time = "2024-07-29T01:09:37.889Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/0a/7b/18a8c0bcec9182c05a0b3ec2a776bba4ead82750a55ff798e8d406dae604/sphinxcontrib_htmlhelp-2.1.0-py3-none-any.whl", hash = "sha256:166759820b47002d22914d64a075ce08f4c46818e17cfc9470a9786b759b19f8", size = 98705, upload-time = "2024-07-29T01:09:36.407Z" },
+]
+
+[[package]]
+name = "sphinxcontrib-jsmath"
+version = "1.0.1"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/b2/e8/9ed3830aeed71f17c026a07a5097edcf44b692850ef215b161b8ad875729/sphinxcontrib-jsmath-1.0.1.tar.gz", hash = "sha256:a9925e4a4587247ed2191a22df5f6970656cb8ca2bd6284309578f2153e0c4b8", size = 5787, upload-time = "2019-01-21T16:10:16.347Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/c2/42/4c8646762ee83602e3fb3fbe774c2fac12f317deb0b5dbeeedd2d3ba4b77/sphinxcontrib_jsmath-1.0.1-py2.py3-none-any.whl", hash = "sha256:2ec2eaebfb78f3f2078e73666b1415417a116cc848b72e5172e596c871103178", size = 5071, upload-time = "2019-01-21T16:10:14.333Z" },
+]
+
+[[package]]
+name = "sphinxcontrib-qthelp"
+version = "1.0.3"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/b1/8e/c4846e59f38a5f2b4a0e3b27af38f2fcf904d4bfd82095bf92de0b114ebd/sphinxcontrib-qthelp-1.0.3.tar.gz", hash = "sha256:4c33767ee058b70dba89a6fc5c1892c0d57a54be67ddd3e7875a18d14cba5a72", size = 21658, upload-time = "2020-02-29T04:19:10.026Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/2b/14/05f9206cf4e9cfca1afb5fd224c7cd434dcc3a433d6d9e4e0264d29c6cdb/sphinxcontrib_qthelp-1.0.3-py2.py3-none-any.whl", hash = "sha256:bd9fc24bcb748a8d51fd4ecaade681350aa63009a347a8c14e637895444dfab6", size = 90609, upload-time = "2020-02-29T04:19:08.451Z" },
+]
+
+[[package]]
+name = "sphinxcontrib-qthelp"
+version = "2.0.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/68/bc/9104308fc285eb3e0b31b67688235db556cd5b0ef31d96f30e45f2e51cae/sphinxcontrib_qthelp-2.0.0.tar.gz", hash = "sha256:4fe7d0ac8fc171045be623aba3e2a8f613f8682731f9153bb2e40ece16b9bbab", size = 17165, upload-time = "2024-07-29T01:09:56.435Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/27/83/859ecdd180cacc13b1f7e857abf8582a64552ea7a061057a6c716e790fce/sphinxcontrib_qthelp-2.0.0-py3-none-any.whl", hash = "sha256:b18a828cdba941ccd6ee8445dbe72ffa3ef8cbe7505d8cd1fa0d42d3f2d5f3eb", size = 88743, upload-time = "2024-07-29T01:09:54.885Z" },
+]
+
+[[package]]
+name = "sphinxcontrib-serializinghtml"
+version = "1.1.5"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/b5/72/835d6fadb9e5d02304cf39b18f93d227cd93abd3c41ebf58e6853eeb1455/sphinxcontrib-serializinghtml-1.1.5.tar.gz", hash = "sha256:aa5f6de5dfdf809ef505c4895e51ef5c9eac17d0f287933eb49ec495280b6952", size = 21019, upload-time = "2021-05-22T16:07:43.043Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/c6/77/5464ec50dd0f1c1037e3c93249b040c8fc8078fdda97530eeb02424b6eea/sphinxcontrib_serializinghtml-1.1.5-py2.py3-none-any.whl", hash = "sha256:352a9a00ae864471d3a7ead8d7d79f5fc0b57e8b3f95e9867eb9eb28999b92fd", size = 94021, upload-time = "2021-05-22T16:07:41.627Z" },
+]
+
+[[package]]
+name = "sphinxcontrib-serializinghtml"
+version = "2.0.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/3b/44/6716b257b0aa6bfd51a1b31665d1c205fb12cb5ad56de752dfa15657de2f/sphinxcontrib_serializinghtml-2.0.0.tar.gz", hash = "sha256:e9d912827f872c029017a53f0ef2180b327c3f7fd23c87229f7a8e8b70031d4d", size = 16080, upload-time = "2024-07-29T01:10:09.332Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/52/a7/d2782e4e3f77c8450f727ba74a8f12756d5ba823d81b941f1b04da9d033a/sphinxcontrib_serializinghtml-2.0.0-py3-none-any.whl", hash = "sha256:6e2cb0eef194e10c27ec0023bfeb25badbbb5868244cf5bc5bdc04e4464bf331", size = 92072, upload-time = "2024-07-29T01:10:08.203Z" },
+]
+
+[[package]]
+name = "sympy"
+version = "1.14.0"
+source = { registry = "https://pypi.org/simple" }
+dependencies = [
+    { name = "mpmath", marker = "python_full_version >= '3.9'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/83/d3/803453b36afefb7c2bb238361cd4ae6125a569b4db67cd9e79846ba2d68c/sympy-1.14.0.tar.gz", hash = "sha256:d3d3fe8df1e5a0b42f0e7bdf50541697dbe7d23746e894990c030e2b05e72517", size = 7793921, upload-time = "2025-04-27T18:05:01.611Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/a2/09/77d55d46fd61b4a135c444fc97158ef34a095e5681d0a6c10b75bf356191/sympy-1.14.0-py3-none-any.whl", hash = "sha256:e091cc3e99d2141a0ba2847328f5479b05d94a6635cb96148ccb3f34671bd8f5", size = 6299353, upload-time = "2025-04-27T18:04:59.103Z" },
+]
+
+[[package]]
+name = "tomli"
+version = "2.2.1"
+source = { registry = "https://pypi.org/simple" }
+sdist = { url = "https://files.pythonhosted.org/packages/18/87/302344fed471e44a87289cf4967697d07e532f2421fdaf868a303cbae4ff/tomli-2.2.1.tar.gz", hash = "sha256:cd45e1dc79c835ce60f7404ec8119f2eb06d38b1deba146f07ced3bbc44505ff", size = 17175, upload-time = "2024-11-27T22:38:36.873Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/43/ca/75707e6efa2b37c77dadb324ae7d9571cb424e61ea73fad7c56c2d14527f/tomli-2.2.1-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:678e4fa69e4575eb77d103de3df8a895e1591b48e740211bd1067378c69e8249", size = 131077, upload-time = "2024-11-27T22:37:54.956Z" },
+    { url = "https://files.pythonhosted.org/packages/c7/16/51ae563a8615d472fdbffc43a3f3d46588c264ac4f024f63f01283becfbb/tomli-2.2.1-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:023aa114dd824ade0100497eb2318602af309e5a55595f76b626d6d9f3b7b0a6", size = 123429, upload-time = "2024-11-27T22:37:56.698Z" },
+    { url = "https://files.pythonhosted.org/packages/f1/dd/4f6cd1e7b160041db83c694abc78e100473c15d54620083dbd5aae7b990e/tomli-2.2.1-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:ece47d672db52ac607a3d9599a9d48dcb2f2f735c6c2d1f34130085bb12b112a", size = 226067, upload-time = "2024-11-27T22:37:57.63Z" },
+    { url = "https://files.pythonhosted.org/packages/a9/6b/c54ede5dc70d648cc6361eaf429304b02f2871a345bbdd51e993d6cdf550/tomli-2.2.1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:6972ca9c9cc9f0acaa56a8ca1ff51e7af152a9f87fb64623e31d5c83700080ee", size = 236030, upload-time = "2024-11-27T22:37:59.344Z" },
+    { url = "https://files.pythonhosted.org/packages/1f/47/999514fa49cfaf7a92c805a86c3c43f4215621855d151b61c602abb38091/tomli-2.2.1-cp311-cp311-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:c954d2250168d28797dd4e3ac5cf812a406cd5a92674ee4c8f123c889786aa8e", size = 240898, upload-time = "2024-11-27T22:38:00.429Z" },
+    { url = "https://files.pythonhosted.org/packages/73/41/0a01279a7ae09ee1573b423318e7934674ce06eb33f50936655071d81a24/tomli-2.2.1-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:8dd28b3e155b80f4d54beb40a441d366adcfe740969820caf156c019fb5c7ec4", size = 229894, upload-time = "2024-11-27T22:38:02.094Z" },
+    { url = "https://files.pythonhosted.org/packages/55/18/5d8bc5b0a0362311ce4d18830a5d28943667599a60d20118074ea1b01bb7/tomli-2.2.1-cp311-cp311-musllinux_1_2_i686.whl", hash = "sha256:e59e304978767a54663af13c07b3d1af22ddee3bb2fb0618ca1593e4f593a106", size = 245319, upload-time = "2024-11-27T22:38:03.206Z" },
+    { url = "https://files.pythonhosted.org/packages/92/a3/7ade0576d17f3cdf5ff44d61390d4b3febb8a9fc2b480c75c47ea048c646/tomli-2.2.1-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:33580bccab0338d00994d7f16f4c4ec25b776af3ffaac1ed74e0b3fc95e885a8", size = 238273, upload-time = "2024-11-27T22:38:04.217Z" },
+    { url = "https://files.pythonhosted.org/packages/72/6f/fa64ef058ac1446a1e51110c375339b3ec6be245af9d14c87c4a6412dd32/tomli-2.2.1-cp311-cp311-win32.whl", hash = "sha256:465af0e0875402f1d226519c9904f37254b3045fc5084697cefb9bdde1ff99ff", size = 98310, upload-time = "2024-11-27T22:38:05.908Z" },
+    { url = "https://files.pythonhosted.org/packages/6a/1c/4a2dcde4a51b81be3530565e92eda625d94dafb46dbeb15069df4caffc34/tomli-2.2.1-cp311-cp311-win_amd64.whl", hash = "sha256:2d0f2fdd22b02c6d81637a3c95f8cd77f995846af7414c5c4b8d0545afa1bc4b", size = 108309, upload-time = "2024-11-27T22:38:06.812Z" },
+    { url = "https://files.pythonhosted.org/packages/52/e1/f8af4c2fcde17500422858155aeb0d7e93477a0d59a98e56cbfe75070fd0/tomli-2.2.1-cp312-cp312-macosx_10_13_x86_64.whl", hash = "sha256:4a8f6e44de52d5e6c657c9fe83b562f5f4256d8ebbfe4ff922c495620a7f6cea", size = 132762, upload-time = "2024-11-27T22:38:07.731Z" },
+    { url = "https://files.pythonhosted.org/packages/03/b8/152c68bb84fc00396b83e7bbddd5ec0bd3dd409db4195e2a9b3e398ad2e3/tomli-2.2.1-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:8d57ca8095a641b8237d5b079147646153d22552f1c637fd3ba7f4b0b29167a8", size = 123453, upload-time = "2024-11-27T22:38:09.384Z" },
+    { url = "https://files.pythonhosted.org/packages/c8/d6/fc9267af9166f79ac528ff7e8c55c8181ded34eb4b0e93daa767b8841573/tomli-2.2.1-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:4e340144ad7ae1533cb897d406382b4b6fede8890a03738ff1683af800d54192", size = 233486, upload-time = "2024-11-27T22:38:10.329Z" },
+    { url = "https://files.pythonhosted.org/packages/5c/51/51c3f2884d7bab89af25f678447ea7d297b53b5a3b5730a7cb2ef6069f07/tomli-2.2.1-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:db2b95f9de79181805df90bedc5a5ab4c165e6ec3fe99f970d0e302f384ad222", size = 242349, upload-time = "2024-11-27T22:38:11.443Z" },
+    { url = "https://files.pythonhosted.org/packages/ab/df/bfa89627d13a5cc22402e441e8a931ef2108403db390ff3345c05253935e/tomli-2.2.1-cp312-cp312-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:40741994320b232529c802f8bc86da4e1aa9f413db394617b9a256ae0f9a7f77", size = 252159, upload-time = "2024-11-27T22:38:13.099Z" },
+    { url = "https://files.pythonhosted.org/packages/9e/6e/fa2b916dced65763a5168c6ccb91066f7639bdc88b48adda990db10c8c0b/tomli-2.2.1-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:400e720fe168c0f8521520190686ef8ef033fb19fc493da09779e592861b78c6", size = 237243, upload-time = "2024-11-27T22:38:14.766Z" },
+    { url = "https://files.pythonhosted.org/packages/b4/04/885d3b1f650e1153cbb93a6a9782c58a972b94ea4483ae4ac5cedd5e4a09/tomli-2.2.1-cp312-cp312-musllinux_1_2_i686.whl", hash = "sha256:02abe224de6ae62c19f090f68da4e27b10af2b93213d36cf44e6e1c5abd19fdd", size = 259645, upload-time = "2024-11-27T22:38:15.843Z" },
+    { url = "https://files.pythonhosted.org/packages/9c/de/6b432d66e986e501586da298e28ebeefd3edc2c780f3ad73d22566034239/tomli-2.2.1-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:b82ebccc8c8a36f2094e969560a1b836758481f3dc360ce9a3277c65f374285e", size = 244584, upload-time = "2024-11-27T22:38:17.645Z" },
+    { url = "https://files.pythonhosted.org/packages/1c/9a/47c0449b98e6e7d1be6cbac02f93dd79003234ddc4aaab6ba07a9a7482e2/tomli-2.2.1-cp312-cp312-win32.whl", hash = "sha256:889f80ef92701b9dbb224e49ec87c645ce5df3fa2cc548664eb8a25e03127a98", size = 98875, upload-time = "2024-11-27T22:38:19.159Z" },
+    { url = "https://files.pythonhosted.org/packages/ef/60/9b9638f081c6f1261e2688bd487625cd1e660d0a85bd469e91d8db969734/tomli-2.2.1-cp312-cp312-win_amd64.whl", hash = "sha256:7fc04e92e1d624a4a63c76474610238576942d6b8950a2d7f908a340494e67e4", size = 109418, upload-time = "2024-11-27T22:38:20.064Z" },
+    { url = "https://files.pythonhosted.org/packages/04/90/2ee5f2e0362cb8a0b6499dc44f4d7d48f8fff06d28ba46e6f1eaa61a1388/tomli-2.2.1-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:f4039b9cbc3048b2416cc57ab3bda989a6fcf9b36cf8937f01a6e731b64f80d7", size = 132708, upload-time = "2024-11-27T22:38:21.659Z" },
+    { url = "https://files.pythonhosted.org/packages/c0/ec/46b4108816de6b385141f082ba99e315501ccd0a2ea23db4a100dd3990ea/tomli-2.2.1-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:286f0ca2ffeeb5b9bd4fcc8d6c330534323ec51b2f52da063b11c502da16f30c", size = 123582, upload-time = "2024-11-27T22:38:22.693Z" },
+    { url = "https://files.pythonhosted.org/packages/a0/bd/b470466d0137b37b68d24556c38a0cc819e8febe392d5b199dcd7f578365/tomli-2.2.1-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:a92ef1a44547e894e2a17d24e7557a5e85a9e1d0048b0b5e7541f76c5032cb13", size = 232543, upload-time = "2024-11-27T22:38:24.367Z" },
+    { url = "https://files.pythonhosted.org/packages/d9/e5/82e80ff3b751373f7cead2815bcbe2d51c895b3c990686741a8e56ec42ab/tomli-2.2.1-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:9316dc65bed1684c9a98ee68759ceaed29d229e985297003e494aa825ebb0281", size = 241691, upload-time = "2024-11-27T22:38:26.081Z" },
+    { url = "https://files.pythonhosted.org/packages/05/7e/2a110bc2713557d6a1bfb06af23dd01e7dde52b6ee7dadc589868f9abfac/tomli-2.2.1-cp313-cp313-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:e85e99945e688e32d5a35c1ff38ed0b3f41f43fad8df0bdf79f72b2ba7bc5272", size = 251170, upload-time = "2024-11-27T22:38:27.921Z" },
+    { url = "https://files.pythonhosted.org/packages/64/7b/22d713946efe00e0adbcdfd6d1aa119ae03fd0b60ebed51ebb3fa9f5a2e5/tomli-2.2.1-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:ac065718db92ca818f8d6141b5f66369833d4a80a9d74435a268c52bdfa73140", size = 236530, upload-time = "2024-11-27T22:38:29.591Z" },
+    { url = "https://files.pythonhosted.org/packages/38/31/3a76f67da4b0cf37b742ca76beaf819dca0ebef26d78fc794a576e08accf/tomli-2.2.1-cp313-cp313-musllinux_1_2_i686.whl", hash = "sha256:d920f33822747519673ee656a4b6ac33e382eca9d331c87770faa3eef562aeb2", size = 258666, upload-time = "2024-11-27T22:38:30.639Z" },
+    { url = "https://files.pythonhosted.org/packages/07/10/5af1293da642aded87e8a988753945d0cf7e00a9452d3911dd3bb354c9e2/tomli-2.2.1-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:a198f10c4d1b1375d7687bc25294306e551bf1abfa4eace6650070a5c1ae2744", size = 243954, upload-time = "2024-11-27T22:38:31.702Z" },
+    { url = "https://files.pythonhosted.org/packages/5b/b9/1ed31d167be802da0fc95020d04cd27b7d7065cc6fbefdd2f9186f60d7bd/tomli-2.2.1-cp313-cp313-win32.whl", hash = "sha256:d3f5614314d758649ab2ab3a62d4f2004c825922f9e370b29416484086b264ec", size = 98724, upload-time = "2024-11-27T22:38:32.837Z" },
+    { url = "https://files.pythonhosted.org/packages/c7/32/b0963458706accd9afcfeb867c0f9175a741bf7b19cd424230714d722198/tomli-2.2.1-cp313-cp313-win_amd64.whl", hash = "sha256:a38aa0308e754b0e3c67e344754dff64999ff9b513e691d0e786265c93583c69", size = 109383, upload-time = "2024-11-27T22:38:34.455Z" },
+    { url = "https://files.pythonhosted.org/packages/6e/c2/61d3e0f47e2b74ef40a68b9e6ad5984f6241a942f7cd3bbfbdbd03861ea9/tomli-2.2.1-py3-none-any.whl", hash = "sha256:cb55c73c5f4408779d0cf3eef9f762b9c9f147a77de7b258bef0a5628adc85cc", size = 14257, upload-time = "2024-11-27T22:38:35.385Z" },
+]
+
+[[package]]
+name = "torch"
+version = "2.8.0+cu129"
+source = { registry = "https://download.pytorch.org/whl/cu129" }
+dependencies = [
+    { name = "filelock", version = "3.19.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+    { name = "fsspec", marker = "python_full_version >= '3.9'" },
+    { name = "jinja2", marker = "python_full_version >= '3.9'" },
+    { name = "networkx", version = "3.2.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "networkx", version = "3.4.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.10.*'" },
+    { name = "networkx", version = "3.5", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.11'" },
+    { name = "nvidia-cublas-cu12", marker = "python_full_version >= '3.9' and platform_machine == 'x86_64' and sys_platform == 'linux'" },
+    { name = "nvidia-cuda-cupti-cu12", marker = "python_full_version >= '3.9' and platform_machine == 'x86_64' and sys_platform == 'linux'" },
+    { name = "nvidia-cuda-nvrtc-cu12", marker = "python_full_version >= '3.9' and platform_machine == 'x86_64' and sys_platform == 'linux'" },
+    { name = "nvidia-cuda-runtime-cu12", marker = "python_full_version >= '3.9' and platform_machine == 'x86_64' and sys_platform == 'linux'" },
+    { name = "nvidia-cudnn-cu12", marker = "python_full_version >= '3.9' and platform_machine == 'x86_64' and sys_platform == 'linux'" },
+    { name = "nvidia-cufft-cu12", marker = "python_full_version >= '3.9' and platform_machine == 'x86_64' and sys_platform == 'linux'" },
+    { name = "nvidia-cufile-cu12", marker = "python_full_version >= '3.9' and platform_machine == 'x86_64' and sys_platform == 'linux'" },
+    { name = "nvidia-curand-cu12", marker = "python_full_version >= '3.9' and platform_machine == 'x86_64' and sys_platform == 'linux'" },
+    { name = "nvidia-cusolver-cu12", marker = "python_full_version >= '3.9' and platform_machine == 'x86_64' and sys_platform == 'linux'" },
+    { name = "nvidia-cusparse-cu12", marker = "python_full_version >= '3.9' and platform_machine == 'x86_64' and sys_platform == 'linux'" },
+    { name = "nvidia-cusparselt-cu12", marker = "python_full_version >= '3.9' and platform_machine == 'x86_64' and sys_platform == 'linux'" },
+    { name = "nvidia-nccl-cu12", marker = "python_full_version >= '3.9' and platform_machine == 'x86_64' and sys_platform == 'linux'" },
+    { name = "nvidia-nvjitlink-cu12", marker = "python_full_version >= '3.9' and platform_machine == 'x86_64' and sys_platform == 'linux'" },
+    { name = "nvidia-nvtx-cu12", marker = "python_full_version >= '3.9' and platform_machine == 'x86_64' and sys_platform == 'linux'" },
+    { name = "setuptools", marker = "python_full_version >= '3.12'" },
+    { name = "sympy", marker = "python_full_version >= '3.9'" },
+    { name = "triton", marker = "python_full_version >= '3.9' and sys_platform == 'linux'" },
+    { name = "typing-extensions", version = "4.15.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+]
+wheels = [
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp310-cp310-manylinux_2_28_aarch64.whl", hash = "sha256:72156354c39c08f3451acb50a6ecd4178d745670ad8651b5c796eaace558ff0f" },
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp310-cp310-manylinux_2_28_x86_64.whl", hash = "sha256:54d240b5d3b1f9075d4ee6179675a22c1974f7bef1885d134c582678d5180cd3" },
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp310-cp310-win_amd64.whl", hash = "sha256:e4adcc3d44089d4a696e6a2ca4233d1ddad7614adc1d48ec8a8cfb95ba235ea1" },
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp311-cp311-manylinux_2_28_aarch64.whl", hash = "sha256:d5a210e351ab0c3acbac18c7397bc66ffd897d5000351e8ce9a21badf7f56b85" },
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp311-cp311-manylinux_2_28_x86_64.whl", hash = "sha256:da19696fd75c4a2d5bc945242619143dfc4cbc3e3deead407f2946d1395c3608" },
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp311-cp311-win_amd64.whl", hash = "sha256:8a92b6ac49be932a8e4f70282d0d396a95a0fc877a9fbe0bd36be5f765707c84" },
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp312-cp312-manylinux_2_28_aarch64.whl", hash = "sha256:692fe6e513b667f789a543fa9b1baba58e77a46d5c8629764ca0c00a56823e1f" },
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp312-cp312-manylinux_2_28_x86_64.whl", hash = "sha256:02c7258e917f3043c978b53acf6f02b818db0d0d85db0e58ae578af333b9b4e2" },
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp312-cp312-win_amd64.whl", hash = "sha256:2bc729898e422b9f3da54349eed98f2f0b5dd415434508ee2ab2a13fb021815d" },
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp313-cp313-manylinux_2_28_aarch64.whl", hash = "sha256:ad2d64316635e7ab06f6c973a252526d59a92a2045825c102f876914a72304d0" },
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp313-cp313-manylinux_2_28_x86_64.whl", hash = "sha256:563740167be2189b71530b503f0c8a8d7a8267dd49d4de6f9c5f1d23fbe237df" },
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp313-cp313-win_amd64.whl", hash = "sha256:2cef066f9759ff4d7868a8c3695aa60d9a878598acb3685bb1ef2fdac29dcd68" },
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp313-cp313t-manylinux_2_28_aarch64.whl", hash = "sha256:2982bf34249cbb38f1090e71ad7097a214a21023ccdc0413961986ab7d0396e6" },
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp313-cp313t-manylinux_2_28_x86_64.whl", hash = "sha256:6344260959ebcfa6dae458e1c4365195bcfdf00f4f1f1ad438cbaf50756829ed" },
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp313-cp313t-win_amd64.whl", hash = "sha256:9c0cd89e54ce44ce3208c5cf4163773b9cda0067e4b48cfcac56a4e04af52040" },
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp39-cp39-manylinux_2_28_aarch64.whl", hash = "sha256:c0253539dc076fa23ab6042e5c4ecd8384c4675ace8d5e13095ce11c5dac1daf" },
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp39-cp39-manylinux_2_28_x86_64.whl", hash = "sha256:217dc008bc7b4e771edb8253f635fb8d076dfd5059c78175734a01db12ce0058" },
+    { url = "https://download.pytorch.org/whl/cu129/torch-2.8.0%2Bcu129-cp39-cp39-win_amd64.whl", hash = "sha256:d852178da46723dab0e2d9f7be570a073bb21c355b3e6b2d3f89e14062198e05" },
+]
+
+[[package]]
+name = "triton"
+version = "3.4.0"
+source = { registry = "https://pypi.org/simple" }
+dependencies = [
+    { name = "importlib-metadata", version = "8.7.0", source = { registry = "https://pypi.org/simple" }, marker = "(python_full_version == '3.9.*' and platform_machine == 'aarch64') or (python_full_version == '3.9.*' and sys_platform != 'win32')" },
+    { name = "setuptools", marker = "(python_full_version >= '3.9' and platform_machine == 'aarch64') or (python_full_version >= '3.9' and sys_platform != 'win32')" },
+]
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/62/ee/0ee5f64a87eeda19bbad9bc54ae5ca5b98186ed00055281fd40fb4beb10e/triton-3.4.0-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:7ff2785de9bc02f500e085420273bb5cc9c9bb767584a4aa28d6e360cec70128", size = 155430069, upload-time = "2025-07-30T19:58:21.715Z" },
+    { url = "https://files.pythonhosted.org/packages/7d/39/43325b3b651d50187e591eefa22e236b2981afcebaefd4f2fc0ea99df191/triton-3.4.0-cp311-cp311-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:7b70f5e6a41e52e48cfc087436c8a28c17ff98db369447bcaff3b887a3ab4467", size = 155531138, upload-time = "2025-07-30T19:58:29.908Z" },
+    { url = "https://files.pythonhosted.org/packages/d0/66/b1eb52839f563623d185f0927eb3530ee4d5ffe9d377cdaf5346b306689e/triton-3.4.0-cp312-cp312-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:31c1d84a5c0ec2c0f8e8a072d7fd150cab84a9c239eaddc6706c081bfae4eb04", size = 155560068, upload-time = "2025-07-30T19:58:37.081Z" },
+    { url = "https://files.pythonhosted.org/packages/30/7b/0a685684ed5322d2af0bddefed7906674f67974aa88b0fae6e82e3b766f6/triton-3.4.0-cp313-cp313-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:00be2964616f4c619193cb0d1b29a99bd4b001d7dc333816073f92cf2a8ccdeb", size = 155569223, upload-time = "2025-07-30T19:58:44.017Z" },
+    { url = "https://files.pythonhosted.org/packages/20/63/8cb444ad5cdb25d999b7d647abac25af0ee37d292afc009940c05b82dda0/triton-3.4.0-cp313-cp313t-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:7936b18a3499ed62059414d7df563e6c163c5e16c3773678a3ee3d417865035d", size = 155659780, upload-time = "2025-07-30T19:58:51.171Z" },
+    { url = "https://files.pythonhosted.org/packages/12/34/1251beb5a3cb93f3950ebe68732752014646003ef6eb11eb5f1a37ca78cd/triton-3.4.0-cp39-cp39-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl", hash = "sha256:98e5c1442eaeabae2e2452ae765801bd53cd4ce873cab0d1bdd59a32ab2d9397", size = 155430799, upload-time = "2025-07-30T19:58:57.664Z" },
+]
+
+[[package]]
+name = "typing-extensions"
+version = "4.13.2"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/f6/37/23083fcd6e35492953e8d2aaaa68b860eb422b34627b13f2ce3eb6106061/typing_extensions-4.13.2.tar.gz", hash = "sha256:e6c81219bd689f51865d9e372991c540bda33a0379d5573cddb9a3a23f7caaef", size = 106967, upload-time = "2025-04-10T14:19:05.416Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/8b/54/b1ae86c0973cc6f0210b53d508ca3641fb6d0c56823f288d108bc7ab3cc8/typing_extensions-4.13.2-py3-none-any.whl", hash = "sha256:a439e7c04b49fec3e5d3e2beaa21755cadbbdc391694e28ccdd36ca4a1408f8c", size = 45806, upload-time = "2025-04-10T14:19:03.967Z" },
+]
+
+[[package]]
+name = "typing-extensions"
+version = "4.15.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/72/94/1a15dd82efb362ac84269196e94cf00f187f7ed21c242792a923cdb1c61f/typing_extensions-4.15.0.tar.gz", hash = "sha256:0cea48d173cc12fa28ecabc3b837ea3cf6f38c6d1136f85cbaaf598984861466", size = 109391, upload-time = "2025-08-25T13:49:26.313Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/18/67/36e9267722cc04a6b9f15c7f3441c2363321a3ea07da7ae0c0707beb2a9c/typing_extensions-4.15.0-py3-none-any.whl", hash = "sha256:f0fa19c6845758ab08074a0cfa8b7aecb71c999ca73d62883bc25cc018c4e548", size = 44614, upload-time = "2025-08-25T13:49:24.86Z" },
+]
+
+[[package]]
+name = "urllib3"
+version = "2.2.3"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/ed/63/22ba4ebfe7430b76388e7cd448d5478814d3032121827c12a2cc287e2260/urllib3-2.2.3.tar.gz", hash = "sha256:e7d814a81dad81e6caf2ec9fdedb284ecc9c73076b62654547cc64ccdcae26e9", size = 300677, upload-time = "2024-09-12T10:52:18.401Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/ce/d9/5f4c13cecde62396b0d3fe530a50ccea91e7dfc1ccf0e09c228841bb5ba8/urllib3-2.2.3-py3-none-any.whl", hash = "sha256:ca899ca043dcb1bafa3e262d73aa25c465bfb49e0bd9dd5d59f1d0acba2f8fac", size = 126338, upload-time = "2024-09-12T10:52:16.589Z" },
+]
+
+[[package]]
+name = "urllib3"
+version = "2.5.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version >= '3.12' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version >= '3.12' and platform_machine == 'aarch64'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.11.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.11.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.10.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.10.*' and platform_machine == 'aarch64'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/15/22/9ee70a2574a4f4599c47dd506532914ce044817c7752a79b6a51286319bc/urllib3-2.5.0.tar.gz", hash = "sha256:3fc47733c7e419d4bc3f6b3dc2b4f890bb743906a30d56ba4a5bfa4bbff92760", size = 393185, upload-time = "2025-06-18T14:07:41.644Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/a7/c2/fe1e52489ae3122415c51f387e221dd0773709bad6c6cdaa599e8a2c5185/urllib3-2.5.0-py3-none-any.whl", hash = "sha256:e6b01673c0fa6a13e374b50871808eb3bf7046c4b125b216f6bf1cc604cff0dc", size = 129795, upload-time = "2025-06-18T14:07:40.39Z" },
+]
+
+[[package]]
+name = "usd-core"
+version = "25.8"
+source = { registry = "https://pypi.org/simple" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/79/51/b36ad9c83092cfb741da7dc8f031026ca39d6e05059c2c7c082e4f8f9575/usd_core-25.8-cp310-none-macosx_10_9_universal2.whl", hash = "sha256:0d97945d2d8474b5a80336bae4aa60f4f31856a2251b1c7547442b1ad969d3ab", size = 37375672, upload-time = "2025-07-31T19:19:48.257Z" },
+    { url = "https://files.pythonhosted.org/packages/d7/a7/ebd57346e28c10dd973e7ac709ccc1c1664930b6428b261eebbf8fc385fe/usd_core-25.8-cp310-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:6a57e253312a26fd87b6884aeb22273a3e40ca3968498f82481f9c13518cffa5", size = 26745874, upload-time = "2025-07-31T19:19:52.259Z" },
+    { url = "https://files.pythonhosted.org/packages/d5/5e/a67c98a6200d3b88d772f3552f22a50fe9b09837cfa77d7b258bb6b14509/usd_core-25.8-cp310-none-win_amd64.whl", hash = "sha256:ab49bf9a81ac91232f1a34064d26f39833eca58418a351fb82049b35355e5dc1", size = 12727831, upload-time = "2025-07-31T19:19:57.189Z" },
+    { url = "https://files.pythonhosted.org/packages/a3/af/8dace54e7471fbdbc970cc3f5ea365d3150cc2a8c57c83afa9852f82fafb/usd_core-25.8-cp311-none-macosx_10_9_universal2.whl", hash = "sha256:b9fe2236205c4324115f73d60ae4f7a7cdab661e5b089bcdf330e5120a7abe5e", size = 37374950, upload-time = "2025-07-31T19:19:59.973Z" },
+    { url = "https://files.pythonhosted.org/packages/d5/a9/0a63ea2a54645e03e71780a5e95fb9f877a0382a24d3b4445fa676e1691b/usd_core-25.8-cp311-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:ec4a897e828e7aa761bbbe48ec24e27be2212467495aa60f293f5097a38b542a", size = 26742066, upload-time = "2025-07-31T19:20:02.969Z" },
+    { url = "https://files.pythonhosted.org/packages/74/a3/bba9bd0527280540eed1e77e87d4e7943a56ea3796f2a574a53a2a32f554/usd_core-25.8-cp311-none-win_amd64.whl", hash = "sha256:44061c4833c4d4044cedf0a70b92b5dda7a3bbedc83b3fe2812976fd328df348", size = 12727802, upload-time = "2025-07-31T19:20:05.674Z" },
+    { url = "https://files.pythonhosted.org/packages/72/b9/2097f0a856c20a9bf952185e0e5ce97f17a1f1a2e6a739e559186a7f77f6/usd_core-25.8-cp312-none-macosx_10_9_universal2.whl", hash = "sha256:0d509e35d4fd56e7119ddde39886debdfafd219abc5584d011fe67e8e383a0a8", size = 37431221, upload-time = "2025-07-31T19:20:08.961Z" },
+    { url = "https://files.pythonhosted.org/packages/1d/27/aac9f2eb7cf3934d990ba6566379662ca4493f7cbb7270aa5f860e60fcbe/usd_core-25.8-cp312-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:cf52c5a77a314681ffb571528dd5e14c0a2e591437606671b90ee4390700e384", size = 26623647, upload-time = "2025-07-31T19:20:18.671Z" },
+    { url = "https://files.pythonhosted.org/packages/c0/2b/7ba6d5f5e8e21c5056f27cc31bd31861d068caf8cb32803b2ae94f787168/usd_core-25.8-cp312-none-win_amd64.whl", hash = "sha256:ddb4845c7a7a42c8bf1bb6fcc4a3d7a3b1fecfdab105ad5e4ed9fa8dcd40ba95", size = 12771730, upload-time = "2025-07-31T19:20:21.34Z" },
+    { url = "https://files.pythonhosted.org/packages/18/b2/f07c4706c4809169ecae0f18da05ff37e47069a6c9978bb3e43c500f2c44/usd_core-25.8-cp313-none-macosx_10_9_universal2.whl", hash = "sha256:992756dac5ea29ad40eaac085126ae22e15b3f37174735d409ee0995420b584e", size = 37431897, upload-time = "2025-07-31T19:20:24.254Z" },
+    { url = "https://files.pythonhosted.org/packages/43/7b/f275eeb308883cf64f5b36a466efe45c12c72e0ddf011feff393ae67f329/usd_core-25.8-cp313-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:e1882ee4821c9dda9e749caf1d7d80ac29b0f4000554cdb35dd4191d4816d3cc", size = 26624317, upload-time = "2025-07-31T19:20:27.689Z" },
+    { url = "https://files.pythonhosted.org/packages/63/5f/c32bf32ae163e6ad5257ec0cfcb58966275de5c55ae0a884bad71cd5f625/usd_core-25.8-cp313-none-win_amd64.whl", hash = "sha256:6d98ad58514afc5c28c9610b4e1017da9b460932192ce564cf311b2451b308de", size = 12771777, upload-time = "2025-07-31T19:20:30.362Z" },
+    { url = "https://files.pythonhosted.org/packages/8c/5b/b598683f449f286d372a9a259e9c70db32553827490d4921751abf1a942a/usd_core-25.8-cp38-none-macosx_10_9_universal2.whl", hash = "sha256:6d0771e0a60dfd0b60b098a77592a43248b6c51cfc946f60717d1b4b49f00dcb", size = 37381151, upload-time = "2025-07-31T19:20:36.051Z" },
+    { url = "https://files.pythonhosted.org/packages/d1/b1/bd9c5be7514232033422daa0318befc0314e3dff1cc3981d5f56184e8175/usd_core-25.8-cp38-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:7970e4f4e354089878c86a9e0e78e4b6dd364de8c82976dda9519fb9b151b200", size = 26750970, upload-time = "2025-07-31T19:20:39.872Z" },
+    { url = "https://files.pythonhosted.org/packages/01/32/b508c931ee006c525379fc350c1e19f43f05636c0aefe9e50f8725c10cdc/usd_core-25.8-cp38-none-win_amd64.whl", hash = "sha256:5e9b2e51afe2a389a321e3dbe2a20296f0d57a9e9d05c7baf4816b4bbf199f63", size = 12729083, upload-time = "2025-07-31T19:20:42.883Z" },
+    { url = "https://files.pythonhosted.org/packages/77/54/05c177a1577668fcaa035816176cf0d35cecae03f55e6bf5a321fbbf174e/usd_core-25.8-cp39-none-macosx_10_9_universal2.whl", hash = "sha256:9fbe5abedf94b051b33efb2f697b084967d8e7ed88adff54f72cc3e48517b562", size = 37379740, upload-time = "2025-07-31T19:20:45.634Z" },
+    { url = "https://files.pythonhosted.org/packages/c6/f2/a1720d96507fe423201bd4b5d0c44f06fffe0f6112a3710d9b8918689d23/usd_core-25.8-cp39-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:e030d62adb7fd7554af415ff16f057a531a779267a36d96522fe30a1e18ab384", size = 26747862, upload-time = "2025-07-31T19:20:48.756Z" },
+    { url = "https://files.pythonhosted.org/packages/4b/24/b96c047d89679d74a8fdbb6ee4d27352a37cba878dff781371c671af6087/usd_core-25.8-cp39-none-win_amd64.whl", hash = "sha256:0c747cdfecc0726e204c0b5073b1ce8144705562eef6657c242c7777ab70a636", size = 12728969, upload-time = "2025-07-31T19:20:51.388Z" },
+]
+
+[[package]]
+name = "usd-exchange"
+version = "2.1.0a3"
+source = { registry = "https://pypi.org/simple" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/5b/98/54628e43c7f37304fd0546e198b4ce1de876854905e991df21db5e340f0d/usd_exchange-2.1.0a3-cp310-cp310-manylinux_2_35_aarch64.whl", hash = "sha256:e8e2e4dc29fb2aba8b6be813969fe7b909eaa625ae2aa955eac526e6f660b952", size = 20238132, upload-time = "2025-09-19T00:52:12.766Z" },
+    { url = "https://files.pythonhosted.org/packages/05/d4/1a2d28acb633c824050097c1c347bb232744f633e9587682217f9120a744/usd_exchange-2.1.0a3-cp311-cp311-manylinux_2_35_aarch64.whl", hash = "sha256:5996b6b1e88ae6b8a31353cd75e23accdc47337d72577e7fee5b74020092f212", size = 20240640, upload-time = "2025-09-19T00:51:23.109Z" },
+    { url = "https://files.pythonhosted.org/packages/ef/98/c1da562a48900eaa3303441d9e48fc84cd1ae567d2027d3a770a82d41f3d/usd_exchange-2.1.0a3-cp312-cp312-manylinux_2_35_aarch64.whl", hash = "sha256:ed59f23ab31bed6877c4fa4493757ca052b5fea2c4658dafcf2277ecf0f1037e", size = 20274655, upload-time = "2025-09-19T00:50:31.173Z" },
+]
+
+[[package]]
+name = "virtualenv"
+version = "20.34.0"
+source = { registry = "https://pypi.org/simple" }
+dependencies = [
+    { name = "distlib" },
+    { name = "filelock", version = "3.16.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "filelock", version = "3.19.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+    { name = "platformdirs", version = "4.3.6", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "platformdirs", version = "4.4.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+    { name = "typing-extensions", version = "4.13.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "typing-extensions", version = "4.15.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9' and python_full_version < '3.11'" },
+]
+sdist = { url = "https://files.pythonhosted.org/packages/1c/14/37fcdba2808a6c615681cd216fecae00413c9dab44fb2e57805ecf3eaee3/virtualenv-20.34.0.tar.gz", hash = "sha256:44815b2c9dee7ed86e387b842a84f20b93f7f417f95886ca1996a72a4138eb1a", size = 6003808, upload-time = "2025-08-13T14:24:07.464Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/76/06/04c8e804f813cf972e3262f3f8584c232de64f0cde9f703b46cf53a45090/virtualenv-20.34.0-py3-none-any.whl", hash = "sha256:341f5afa7eee943e4984a9207c025feedd768baff6753cd660c857ceb3e36026", size = 5983279, upload-time = "2025-08-13T14:24:05.111Z" },
+]
+
+[[package]]
+name = "warp-lang"
+source = { editable = "." }
+dependencies = [
+    { name = "numpy", version = "1.24.4", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "numpy", version = "2.0.2", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "numpy", version = "2.2.6", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.10.*'" },
+    { name = "numpy", version = "2.3.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.11'" },
+]
+
+[package.optional-dependencies]
+benchmark = [
+    { name = "usd-core", marker = "python_full_version < '3.14' and platform_machine != 'aarch64'" },
+    { name = "usd-exchange", marker = "python_full_version >= '3.10' and platform_machine == 'aarch64'" },
+]
+dev = [
+    { name = "blosc", version = "1.11.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "blosc", version = "1.11.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+    { name = "coverage", version = "7.6.1", source = { registry = "https://pypi.org/simple" }, extra = ["toml"], marker = "python_full_version < '3.9'" },
+    { name = "coverage", version = "7.10.7", source = { registry = "https://pypi.org/simple" }, extra = ["toml"], marker = "python_full_version >= '3.9'" },
+    { name = "matplotlib", version = "3.7.5", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "matplotlib", version = "3.9.4", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "matplotlib", version = "3.10.6", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.10'" },
+    { name = "myst-parser", version = "3.0.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.10'" },
+    { name = "myst-parser", version = "4.0.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.10'" },
+    { name = "nvidia-sphinx-theme", version = "0.0.5.post1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "nvidia-sphinx-theme", version = "0.0.8", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.10'" },
+    { name = "nvtx" },
+    { name = "pillow", version = "10.4.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "pillow", version = "11.3.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+    { name = "pre-commit", version = "3.5.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "pre-commit", version = "4.3.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+    { name = "psutil" },
+    { name = "pyglet" },
+    { name = "sphinx-copybutton" },
+    { name = "usd-core", marker = "python_full_version < '3.14' and platform_machine != 'aarch64'" },
+    { name = "usd-exchange", marker = "python_full_version >= '3.10' and platform_machine == 'aarch64'" },
+]
+docs = [
+    { name = "myst-parser", version = "3.0.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.10'" },
+    { name = "myst-parser", version = "4.0.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.10'" },
+    { name = "nvidia-sphinx-theme", version = "0.0.5.post1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "nvidia-sphinx-theme", version = "0.0.8", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.10'" },
+    { name = "pre-commit", version = "3.5.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "pre-commit", version = "4.3.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+    { name = "sphinx-copybutton" },
+]
+examples = [
+    { name = "blosc", version = "1.11.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "blosc", version = "1.11.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+    { name = "matplotlib", version = "3.7.5", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "matplotlib", version = "3.9.4", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "matplotlib", version = "3.10.6", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.10'" },
+    { name = "pillow", version = "10.4.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "pillow", version = "11.3.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+    { name = "psutil" },
+    { name = "pyglet" },
+    { name = "usd-core", marker = "python_full_version < '3.14' and platform_machine != 'aarch64'" },
+    { name = "usd-exchange", marker = "python_full_version >= '3.10' and platform_machine == 'aarch64'" },
+]
+torch-cu12 = [
+    { name = "blosc", version = "1.11.1", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "blosc", version = "1.11.3", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+    { name = "matplotlib", version = "3.7.5", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "matplotlib", version = "3.9.4", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version == '3.9.*'" },
+    { name = "matplotlib", version = "3.10.6", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.10'" },
+    { name = "pillow", version = "10.4.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version < '3.9'" },
+    { name = "pillow", version = "11.3.0", source = { registry = "https://pypi.org/simple" }, marker = "python_full_version >= '3.9'" },
+    { name = "psutil" },
+    { name = "pyglet" },
+    { name = "torch", marker = "python_full_version >= '3.9'" },
+    { name = "usd-core", marker = "python_full_version < '3.14' and platform_machine != 'aarch64'" },
+    { name = "usd-exchange", marker = "python_full_version >= '3.10' and platform_machine == 'aarch64'" },
+]
+
+[package.metadata]
+requires-dist = [
+    { name = "blosc", marker = "extra == 'examples'", specifier = ">=1.11.1" },
+    { name = "coverage", extras = ["toml"], marker = "extra == 'dev'" },
+    { name = "matplotlib", marker = "extra == 'examples'", specifier = ">=3.7.5" },
+    { name = "myst-parser", marker = "extra == 'docs'" },
+    { name = "numpy" },
+    { name = "nvidia-sphinx-theme", marker = "python_full_version >= '3.9' and extra == 'docs'" },
+    { name = "nvtx", marker = "extra == 'dev'" },
+    { name = "pillow", marker = "extra == 'examples'", specifier = ">=10.4.0" },
+    { name = "pre-commit", marker = "extra == 'docs'" },
+    { name = "psutil", marker = "extra == 'examples'", specifier = ">=7.1.0" },
+    { name = "pyglet", marker = "extra == 'examples'", specifier = ">=2.1.9" },
+    { name = "sphinx-copybutton", marker = "extra == 'docs'" },
+    { name = "torch", marker = "python_full_version >= '3.9' and extra == 'torch-cu12'", specifier = ">=2.7.0", index = "https://download.pytorch.org/whl/cu129", conflict = { package = "warp-lang", extra = "torch-cu12" } },
+    { name = "usd-core", marker = "python_full_version < '3.14' and platform_machine != 'aarch64' and extra == 'benchmark'", specifier = ">=25.5" },
+    { name = "usd-core", marker = "python_full_version < '3.14' and platform_machine != 'aarch64' and extra == 'examples'", specifier = ">=25.5" },
+    { name = "usd-exchange", marker = "python_full_version >= '3.10' and platform_machine == 'aarch64' and extra == 'benchmark'", specifier = ">=2.1.0a3" },
+    { name = "usd-exchange", marker = "python_full_version >= '3.10' and platform_machine == 'aarch64' and extra == 'examples'", specifier = ">=2.1.0a3" },
+    { name = "warp-lang", extras = ["docs"], marker = "extra == 'dev'" },
+    { name = "warp-lang", extras = ["examples"], marker = "extra == 'dev'" },
+    { name = "warp-lang", extras = ["examples"], marker = "extra == 'torch-cu12'" },
+]
+provides-extras = ["docs", "benchmark", "examples", "torch-cu12", "dev"]
+
+[[package]]
+name = "zipp"
+version = "3.20.2"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version < '3.9' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version < '3.9' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/54/bf/5c0000c44ebc80123ecbdddba1f5dcd94a5ada602a9c225d84b5aaa55e86/zipp-3.20.2.tar.gz", hash = "sha256:bc9eb26f4506fda01b81bcde0ca78103b6e62f991b381fec825435c836edbc29", size = 24199, upload-time = "2024-09-13T13:44:16.101Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/62/8b/5ba542fa83c90e09eac972fc9baca7a88e7e7ca4b221a89251954019308b/zipp-3.20.2-py3-none-any.whl", hash = "sha256:a817ac80d6cf4b23bf7f2828b7cabf326f15a001bea8b1f9b49631780ba28350", size = 9200, upload-time = "2024-09-13T13:44:14.38Z" },
+]
+
+[[package]]
+name = "zipp"
+version = "3.23.0"
+source = { registry = "https://pypi.org/simple" }
+resolution-markers = [
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform == 'win32'",
+    "python_full_version == '3.9.*' and platform_machine != 'aarch64' and sys_platform != 'win32'",
+    "python_full_version == '3.9.*' and platform_machine == 'aarch64'",
+]
+sdist = { url = "https://files.pythonhosted.org/packages/e3/02/0f2892c661036d50ede074e376733dca2ae7c6eb617489437771209d4180/zipp-3.23.0.tar.gz", hash = "sha256:a07157588a12518c9d4034df3fbbee09c814741a33ff63c05fa29d26a2404166", size = 25547, upload-time = "2025-06-08T17:06:39.4Z" }
+wheels = [
+    { url = "https://files.pythonhosted.org/packages/2e/54/647ade08bf0db230bfea292f893923872fd20be6ac6f53b2b936ba839d75/zipp-3.23.0-py3-none-any.whl", hash = "sha256:071652d6115ed432f5ce1d34c336c0adfd6a884660d1e9712a256d3d3bd4b14e", size = 10276, upload-time = "2025-06-08T17:06:38.034Z" },
+]
diff --git a/warp/__init__.pyi b/warp/__init__.pyi
index abf7a356..e1693e80 100644
--- a/warp/__init__.pyi
+++ b/warp/__init__.pyi
@@ -4523,6 +4523,258 @@ def atomic_exch(arr: IndexedFabricArray[Any], i: Int, j: Int, k: Int, l: Int, va
     """
     ...
 
+@over
+def atomic_and(arr: Array[Any], i: Int, value: Any) -> Any:
+    """Atomically performs a bitwise AND between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i] &= value``.
+    """
+    ...
+
+@over
+def atomic_and(arr: Array[Any], i: Int, j: Int, value: Any) -> Any:
+    """Atomically performs a bitwise AND between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j] &= value``.
+    """
+    ...
+
+@over
+def atomic_and(arr: Array[Any], i: Int, j: Int, k: Int, value: Any) -> Any:
+    """Atomically performs a bitwise AND between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k] &= value``.
+    """
+    ...
+
+@over
+def atomic_and(arr: Array[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any:
+    """Atomically performs a bitwise AND between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k,l] &= value``.
+    """
+    ...
+
+@over
+def atomic_and(arr: FabricArray[Any], i: Int, value: Any) -> Any:
+    """Atomically performs a bitwise AND between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i] &= value``.
+    """
+    ...
+
+@over
+def atomic_and(arr: FabricArray[Any], i: Int, j: Int, value: Any) -> Any:
+    """Atomically performs a bitwise AND between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j] &= value``.
+    """
+    ...
+
+@over
+def atomic_and(arr: FabricArray[Any], i: Int, j: Int, k: Int, value: Any) -> Any:
+    """Atomically performs a bitwise AND between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k] &= value``.
+    """
+    ...
+
+@over
+def atomic_and(arr: FabricArray[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any:
+    """Atomically performs a bitwise AND between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k,l] &= value``.
+    """
+    ...
+
+@over
+def atomic_and(arr: IndexedFabricArray[Any], i: Int, value: Any) -> Any:
+    """Atomically performs a bitwise AND between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i] &= value``.
+    """
+    ...
+
+@over
+def atomic_and(arr: IndexedFabricArray[Any], i: Int, j: Int, value: Any) -> Any:
+    """Atomically performs a bitwise AND between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j] &= value``.
+    """
+    ...
+
+@over
+def atomic_and(arr: IndexedFabricArray[Any], i: Int, j: Int, k: Int, value: Any) -> Any:
+    """Atomically performs a bitwise AND between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k] &= value``.
+    """
+    ...
+
+@over
+def atomic_and(arr: IndexedFabricArray[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any:
+    """Atomically performs a bitwise AND between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k,l] &= value``.
+    """
+    ...
+
+@over
+def atomic_or(arr: Array[Any], i: Int, value: Any) -> Any:
+    """Atomically performs a bitwise OR between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i] |= value``.
+    """
+    ...
+
+@over
+def atomic_or(arr: Array[Any], i: Int, j: Int, value: Any) -> Any:
+    """Atomically performs a bitwise OR between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j] |= value``.
+    """
+    ...
+
+@over
+def atomic_or(arr: Array[Any], i: Int, j: Int, k: Int, value: Any) -> Any:
+    """Atomically performs a bitwise OR between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k] |= value``.
+    """
+    ...
+
+@over
+def atomic_or(arr: Array[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any:
+    """Atomically performs a bitwise OR between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k,l] |= value``.
+    """
+    ...
+
+@over
+def atomic_or(arr: FabricArray[Any], i: Int, value: Any) -> Any:
+    """Atomically performs a bitwise OR between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i] |= value``.
+    """
+    ...
+
+@over
+def atomic_or(arr: FabricArray[Any], i: Int, j: Int, value: Any) -> Any:
+    """Atomically performs a bitwise OR between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j] |= value``.
+    """
+    ...
+
+@over
+def atomic_or(arr: FabricArray[Any], i: Int, j: Int, k: Int, value: Any) -> Any:
+    """Atomically performs a bitwise OR between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k] |= value``.
+    """
+    ...
+
+@over
+def atomic_or(arr: FabricArray[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any:
+    """Atomically performs a bitwise OR between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k,l] |= value``.
+    """
+    ...
+
+@over
+def atomic_or(arr: IndexedFabricArray[Any], i: Int, value: Any) -> Any:
+    """Atomically performs a bitwise OR between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i] |= value``.
+    """
+    ...
+
+@over
+def atomic_or(arr: IndexedFabricArray[Any], i: Int, j: Int, value: Any) -> Any:
+    """Atomically performs a bitwise OR between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j] |= value``.
+    """
+    ...
+
+@over
+def atomic_or(arr: IndexedFabricArray[Any], i: Int, j: Int, k: Int, value: Any) -> Any:
+    """Atomically performs a bitwise OR between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k] |= value``.
+    """
+    ...
+
+@over
+def atomic_or(arr: IndexedFabricArray[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any:
+    """Atomically performs a bitwise OR between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k,l] |= value``.
+    """
+    ...
+
+@over
+def atomic_xor(arr: Array[Any], i: Int, value: Any) -> Any:
+    """Atomically performs a bitwise XOR between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i] ^= value``.
+    """
+    ...
+
+@over
+def atomic_xor(arr: Array[Any], i: Int, j: Int, value: Any) -> Any:
+    """Atomically performs a bitwise XOR between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j] ^= value``.
+    """
+    ...
+
+@over
+def atomic_xor(arr: Array[Any], i: Int, j: Int, k: Int, value: Any) -> Any:
+    """Atomically performs a bitwise XOR between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k] ^= value``.
+    """
+    ...
+
+@over
+def atomic_xor(arr: Array[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any:
+    """Atomically performs a bitwise XOR between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k,l] ^= value``.
+    """
+    ...
+
+@over
+def atomic_xor(arr: FabricArray[Any], i: Int, value: Any) -> Any:
+    """Atomically performs a bitwise XOR between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i] ^= value``.
+    """
+    ...
+
+@over
+def atomic_xor(arr: FabricArray[Any], i: Int, j: Int, value: Any) -> Any:
+    """Atomically performs a bitwise XOR between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j] ^= value``.
+    """
+    ...
+
+@over
+def atomic_xor(arr: FabricArray[Any], i: Int, j: Int, k: Int, value: Any) -> Any:
+    """Atomically performs a bitwise XOR between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k] ^= value``.
+    """
+    ...
+
+@over
+def atomic_xor(arr: FabricArray[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any:
+    """Atomically performs a bitwise XOR between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k,l] ^= value``.
+    """
+    ...
+
+@over
+def atomic_xor(arr: IndexedFabricArray[Any], i: Int, value: Any) -> Any:
+    """Atomically performs a bitwise XOR between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i] ^= value``.
+    """
+    ...
+
+@over
+def atomic_xor(arr: IndexedFabricArray[Any], i: Int, j: Int, value: Any) -> Any:
+    """Atomically performs a bitwise XOR between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j] ^= value``.
+    """
+    ...
+
+@over
+def atomic_xor(arr: IndexedFabricArray[Any], i: Int, j: Int, k: Int, value: Any) -> Any:
+    """Atomically performs a bitwise XOR between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k] ^= value``.
+    """
+    ...
+
+@over
+def atomic_xor(arr: IndexedFabricArray[Any], i: Int, j: Int, k: Int, l: Int, value: Any) -> Any:
+    """Atomically performs a bitwise XOR between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+    This function is automatically invoked when using the syntax ``arr[i,j,k,l] ^= value``.
+    """
+    ...
+
 @over
 def lerp(a: Float, b: Float, t: Float) -> Float:
     """Linearly interpolate two values ``a`` and ``b`` using factor ``t``, computed as ``a*(1-t) + b*t``"""
@@ -4650,31 +4902,106 @@ def bit_and(a: Int, b: Int) -> Int:
     """ """
     ...
 
+@over
+def bit_and(a: Vector[Any, Int], b: Vector[Any, Int]) -> Vector[Any, Int]:
+    """ """
+    ...
+
+@over
+def bit_and(a: Matrix[Any, Any, Int], b: Matrix[Any, Any, Int]) -> Matrix[Any, Any, Int]:
+    """ """
+    ...
+
+@over
+def bit_and(a: Tile[Any, Tuple[int, ...]], b: Tile[Any, Tuple[int, ...]]) -> Tile[Scalar, Tuple[int, ...]]:
+    """Bitwise AND each element of two tiles together"""
+    ...
+
 @over
 def bit_or(a: Int, b: Int) -> Int:
     """ """
     ...
 
+@over
+def bit_or(a: Vector[Any, Int], b: Vector[Any, Int]) -> Vector[Any, Int]:
+    """ """
+    ...
+
+@over
+def bit_or(a: Matrix[Any, Any, Int], b: Matrix[Any, Any, Int]) -> Matrix[Any, Any, Int]:
+    """ """
+    ...
+
+@over
+def bit_or(a: Tile[Any, Tuple[int, ...]], b: Tile[Any, Tuple[int, ...]]) -> Tile[Scalar, Tuple[int, ...]]:
+    """Bitwise OR each element of two tiles together"""
+    ...
+
 @over
 def bit_xor(a: Int, b: Int) -> Int:
     """ """
     ...
 
+@over
+def bit_xor(a: Vector[Any, Int], b: Vector[Any, Int]) -> Vector[Any, Int]:
+    """ """
+    ...
+
+@over
+def bit_xor(a: Matrix[Any, Any, Int], b: Matrix[Any, Any, Int]) -> Matrix[Any, Any, Int]:
+    """ """
+    ...
+
+@over
+def bit_xor(a: Tile[Any, Tuple[int, ...]], b: Tile[Any, Tuple[int, ...]]) -> Tile[Scalar, Tuple[int, ...]]:
+    """Bitwise XOR each element of two tiles together"""
+    ...
+
 @over
 def lshift(a: Int, b: Int) -> Int:
     """ """
     ...
 
+@over
+def lshift(a: Vector[Any, Int], b: Vector[Any, Int]) -> Vector[Any, Int]:
+    """ """
+    ...
+
+@over
+def lshift(a: Matrix[Any, Any, Int], b: Matrix[Any, Any, Int]) -> Matrix[Any, Any, Int]:
+    """ """
+    ...
+
 @over
 def rshift(a: Int, b: Int) -> Int:
     """ """
     ...
 
+@over
+def rshift(a: Vector[Any, Int], b: Vector[Any, Int]) -> Vector[Any, Int]:
+    """ """
+    ...
+
+@over
+def rshift(a: Matrix[Any, Any, Int], b: Matrix[Any, Any, Int]) -> Matrix[Any, Any, Int]:
+    """ """
+    ...
+
 @over
 def invert(a: Int) -> Int:
     """ """
     ...
 
+@over
+def invert(a: Vector[Any, Int]) -> Vector[Any, Int]:
+    """ """
+    ...
+
+@over
+def invert(a: Matrix[Any, Any, Int]) -> Matrix[Any, Any, Int]:
+    """ """
+    ...
+
 @over
 def mul(a: Scalar, b: Scalar) -> Scalar:
     """ """
diff --git a/warp/build.py b/warp/build.py
index 91d82666..5351cbec 100644
--- a/warp/build.py
+++ b/warp/build.py
@@ -155,8 +155,8 @@ def clear_kernel_cache() -> None:
 
     import shutil
 
-    is_intialized = warp.context.runtime is not None
-    assert is_intialized, "The kernel cache directory is not configured; wp.init() has not been called yet or failed."
+    is_initialized = warp.context.runtime is not None
+    assert is_initialized, "The kernel cache directory is not configured; wp.init() has not been called yet or failed."
 
     for item in os.listdir(warp.config.kernel_cache_dir):
         item_path = os.path.join(warp.config.kernel_cache_dir, item)
@@ -176,8 +176,8 @@ def clear_lto_cache() -> None:
 
     import shutil
 
-    is_intialized = warp.context.runtime is not None
-    assert is_intialized, "The kernel cache directory is not configured; wp.init() has not been called yet or failed."
+    is_initialized = warp.context.runtime is not None
+    assert is_initialized, "The kernel cache directory is not configured; wp.init() has not been called yet or failed."
 
     lto_path = os.path.join(warp.config.kernel_cache_dir, "lto")
     if os.path.isdir(lto_path):
diff --git a/warp/build_dll.py b/warp/build_dll.py
index 11d2a898..4703f5fa 100644
--- a/warp/build_dll.py
+++ b/warp/build_dll.py
@@ -15,10 +15,12 @@
 
 from __future__ import annotations
 
+import concurrent.futures
 import os
 import platform
 import subprocess
 import sys
+import time
 
 from warp.utils import ScopedTimer
 
@@ -333,166 +335,7 @@ def _get_architectures_cu13(
     return gencode_opts, clang_arch_flags
 
 
-def _get_architectures_cu12(
-    ctk_version: tuple[int, int], arch: str, target_platform: str, quick_build: bool = False
-) -> tuple[list[str], list[str]]:
-    """Get architecture flags for CUDA 12.x."""
-    gencode_opts = []
-    clang_arch_flags = []
-
-    if quick_build:
-        gencode_opts = ["-gencode=arch=compute_52,code=compute_52", "-gencode=arch=compute_75,code=compute_75"]
-        clang_arch_flags = ["--cuda-gpu-arch=sm_52", "--cuda-gpu-arch=sm_75"]
-    else:
-        if arch == "aarch64" and target_platform == "linux" and ctk_version == (12, 9):
-            # Skip certain architectures for aarch64 with CUDA 12.9 due to CCCL bug
-            print(
-                "[INFO] Skipping sm_52, sm_60, sm_61, and sm_70 targets for ARM due to a CUDA Toolkit bug. "
-                "See https://nvidia.github.io/warp/installation.html#cuda-12-9-limitation-on-linux-arm-platforms "
-                "for details."
-            )
-        else:
-            gencode_opts.extend(
-                [
-                    "-gencode=arch=compute_52,code=sm_52",  # Maxwell
-                    "-gencode=arch=compute_60,code=sm_60",  # Pascal
-                    "-gencode=arch=compute_61,code=sm_61",
-                    "-gencode=arch=compute_70,code=sm_70",  # Volta
-                ]
-            )
-            clang_arch_flags.extend(
-                [
-                    "--cuda-gpu-arch=sm_52",
-                    "--cuda-gpu-arch=sm_60",
-                    "--cuda-gpu-arch=sm_61",
-                    "--cuda-gpu-arch=sm_70",
-                ]
-            )
-
-        # Desktop architectures
-        gencode_opts.extend(
-            [
-                "-gencode=arch=compute_75,code=sm_75",  # Turing
-                "-gencode=arch=compute_75,code=compute_75",  # Turing (PTX)
-                "-gencode=arch=compute_80,code=sm_80",  # Ampere
-                "-gencode=arch=compute_86,code=sm_86",
-                "-gencode=arch=compute_89,code=sm_89",  # Ada
-                "-gencode=arch=compute_90,code=sm_90",  # Hopper
-            ]
-        )
-        clang_arch_flags.extend(
-            [
-                "--cuda-gpu-arch=sm_75",  # Turing
-                "--cuda-gpu-arch=sm_80",  # Ampere
-                "--cuda-gpu-arch=sm_86",
-                "--cuda-gpu-arch=sm_89",  # Ada
-                "--cuda-gpu-arch=sm_90",  # Hopper
-            ]
-        )
-
-        if ctk_version >= (12, 8):
-            gencode_opts.extend(["-gencode=arch=compute_100,code=sm_100", "-gencode=arch=compute_120,code=sm_120"])
-            clang_arch_flags.extend(["--cuda-gpu-arch=sm_100", "--cuda-gpu-arch=sm_120"])
-
-        # Mobile architectures for aarch64 Linux
-        if arch == "aarch64" and target_platform == "linux":
-            gencode_opts.extend(
-                [
-                    "-gencode=arch=compute_87,code=sm_87",  # Orin
-                    "-gencode=arch=compute_53,code=sm_53",  # X1
-                    "-gencode=arch=compute_62,code=sm_62",  # X2
-                    "-gencode=arch=compute_72,code=sm_72",  # Xavier
-                ]
-            )
-            clang_arch_flags.extend(
-                [
-                    "--cuda-gpu-arch=sm_87",
-                    "--cuda-gpu-arch=sm_53",
-                    "--cuda-gpu-arch=sm_62",
-                    "--cuda-gpu-arch=sm_72",
-                ]
-            )
-
-            # Thor support in CUDA 12.8+
-            if ctk_version >= (12, 8):
-                gencode_opts.append("-gencode=arch=compute_101,code=sm_101")  # Thor (CUDA 12 numbering)
-                clang_arch_flags.append("--cuda-gpu-arch=sm_101")
-
-            if ctk_version >= (12, 9):
-                gencode_opts.append("-gencode=arch=compute_121,code=sm_121")
-                clang_arch_flags.append("--cuda-gpu-arch=sm_121")
-
-        # PTX for future hardware (use highest available compute capability)
-        if ctk_version >= (12, 9):
-            gencode_opts.extend(["-gencode=arch=compute_121,code=compute_121"])
-        elif ctk_version >= (12, 8):
-            gencode_opts.extend(["-gencode=arch=compute_120,code=compute_120"])
-        else:
-            gencode_opts.append("-gencode=arch=compute_90,code=compute_90")
-
-    return gencode_opts, clang_arch_flags
-
-
-def _get_architectures_cu13(
-    ctk_version: tuple[int, int], arch: str, target_platform: str, quick_build: bool = False
-) -> tuple[list[str], list[str]]:
-    """Get architecture flags for CUDA 13.x."""
-    gencode_opts = []
-    clang_arch_flags = []
-
-    if quick_build:
-        gencode_opts = ["-gencode=arch=compute_75,code=compute_75"]
-        clang_arch_flags = ["--cuda-gpu-arch=sm_75"]
-    else:
-        # Desktop architectures
-        gencode_opts.extend(
-            [
-                "-gencode=arch=compute_75,code=sm_75",  # Turing
-                "-gencode=arch=compute_75,code=compute_75",  # Turing (PTX)
-                "-gencode=arch=compute_80,code=sm_80",  # Ampere
-                "-gencode=arch=compute_86,code=sm_86",
-                "-gencode=arch=compute_89,code=sm_89",  # Ada
-                "-gencode=arch=compute_90,code=sm_90",  # Hopper
-                "-gencode=arch=compute_100,code=sm_100",  # Blackwell
-                "-gencode=arch=compute_120,code=sm_120",  # Blackwell
-            ]
-        )
-        clang_arch_flags.extend(
-            [
-                "--cuda-gpu-arch=sm_75",  # Turing
-                "--cuda-gpu-arch=sm_80",  # Ampere
-                "--cuda-gpu-arch=sm_86",
-                "--cuda-gpu-arch=sm_89",  # Ada
-                "--cuda-gpu-arch=sm_90",  # Hopper
-                "--cuda-gpu-arch=sm_100",  # Blackwell
-                "--cuda-gpu-arch=sm_120",  # Blackwell
-            ]
-        )
-
-        # Mobile architectures for aarch64 Linux
-        if arch == "aarch64" and target_platform == "linux":
-            gencode_opts.extend(
-                [
-                    "-gencode=arch=compute_87,code=sm_87",  # Orin
-                    "-gencode=arch=compute_110,code=sm_110",  # Thor
-                    "-gencode=arch=compute_121,code=sm_121",  # Spark
-                ]
-            )
-            clang_arch_flags.extend(
-                [
-                    "--cuda-gpu-arch=sm_87",
-                    "--cuda-gpu-arch=sm_110",
-                    "--cuda-gpu-arch=sm_121",
-                ]
-            )
-
-        # PTX for future hardware (use highest available compute capability)
-        gencode_opts.extend(["-gencode=arch=compute_121,code=compute_121"])
-
-    return gencode_opts, clang_arch_flags
-
-
-def build_dll_for_arch(args, dll_path, cpp_paths, cu_path, arch, libs: list[str] | None = None, mode=None):
+def build_dll_for_arch(args, dll_path, cpp_paths, cu_paths, arch, libs: list[str] | None = None, mode=None):
     mode = args.mode if (mode is None) else mode
     cuda_home = args.cuda_path
     cuda_cmd = None
@@ -500,7 +343,7 @@ def build_dll_for_arch(args, dll_path, cpp_paths, cu_path, arch, libs: list[str]
     # Add LLVM bin directory to PATH
     add_llvm_bin_to_path(args)
 
-    if args.quick or cu_path is None:
+    if args.quick or cu_paths is None:
         cuda_compat_enabled = "WP_ENABLE_CUDA_COMPATIBILITY=0"
     else:
         cuda_compat_enabled = "WP_ENABLE_CUDA_COMPATIBILITY=1"
@@ -518,7 +361,7 @@ def build_dll_for_arch(args, dll_path, cpp_paths, cu_path, arch, libs: list[str]
 
     native_dir = os.path.join(warp_home, "native")
 
-    if cu_path:
+    if cu_paths:
         # check CUDA Toolkit version
         ctk_version = get_cuda_toolkit_version(cuda_home)
         if ctk_version < MIN_CTK_VERSION:
@@ -548,7 +391,7 @@ def build_dll_for_arch(args, dll_path, cpp_paths, cu_path, arch, libs: list[str]
 
         if args.compile_time_trace:
             if ctk_version >= (12, 8):
-                nvcc_opts.append("--fdevice-time-trace=build_lib_compile-time-trace")
+                nvcc_opts.append("--fdevice-time-trace=_build/build_lib_@filename@_compile-time-trace")
             else:
                 print("Warp warning: CUDA version is less than 12.8, compile_time_trace is not supported")
 
@@ -556,7 +399,7 @@ def build_dll_for_arch(args, dll_path, cpp_paths, cu_path, arch, libs: list[str]
             nvcc_opts.append("--use_fast_math")
 
     # is the library being built with CUDA enabled?
-    cuda_enabled = "WP_ENABLE_CUDA=1" if (cu_path is not None) else "WP_ENABLE_CUDA=0"
+    cuda_enabled = "WP_ENABLE_CUDA=1" if (cu_paths is not None) else "WP_ENABLE_CUDA=0"
 
     if args.libmathdx_path:
         libmathdx_includes = f' -I"{args.libmathdx_path}/include"'
@@ -573,11 +416,11 @@ def build_dll_for_arch(args, dll_path, cpp_paths, cu_path, arch, libs: list[str]
 
         cpp_includes = f' /I"{warp_home_path.parent}/external/llvm-project/out/install/{mode}-{arch}/include"'
         cpp_includes += f' /I"{warp_home_path.parent}/_build/host-deps/llvm-project/release-{arch}/include"'
-        cuda_includes = f' /I"{cuda_home}/include"' if cu_path else ""
+        cuda_includes = f' /I"{cuda_home}/include"' if cu_paths else ""
         includes = cpp_includes + cuda_includes
 
         # nvrtc_static.lib is built with /MT and _ITERATOR_DEBUG_LEVEL=0 so if we link it in we must match these options
-        if cu_path or mode != "debug":
+        if cu_paths or mode != "debug":
             runtime = "/MT"
             iter_dbg = "_ITERATOR_DEBUG_LEVEL=0"
             debug = "NDEBUG"
@@ -603,26 +446,41 @@ def build_dll_for_arch(args, dll_path, cpp_paths, cu_path, arch, libs: list[str]
         if args.fast_math:
             cpp_flags += " /fp:fast"
 
-        with ScopedTimer("build", active=args.verbose):
+        with concurrent.futures.ThreadPoolExecutor(max_workers=args.jobs) as executor:
+            futures, wall_clock = [], time.perf_counter_ns()
+
+            cpp_cmds = []
             for cpp_path in cpp_paths:
                 cpp_out = cpp_path + ".obj"
                 linkopts.append(quote(cpp_out))
-
                 cpp_cmd = f'"{args.host_compiler}" {cpp_flags} -c "{cpp_path}" /Fo"{cpp_out}"'
-                run_cmd(cpp_cmd)
+                cpp_cmds.append(cpp_cmd)
+
+            if args.jobs <= 1:
+                with ScopedTimer("build", active=args.verbose):
+                    for cpp_cmd in cpp_cmds:
+                        run_cmd(cpp_cmd)
+            else:
+                futures = [executor.submit(run_cmd, cmd=cpp_cmd) for cpp_cmd in cpp_cmds]
+
+            cuda_cmds = []
+            if cu_paths:
+                for cu_path in cu_paths:
+                    cu_out = cu_path + ".o"
 
-        if cu_path:
-            cu_out = cu_path + ".o"
+                    _nvcc_opts = [
+                        opt.replace("@filename@", os.path.basename(cu_path).replace(".", "_")) for opt in nvcc_opts
+                    ]
 
-            if mode == "debug":
-                cuda_cmd = f'"{cuda_home}/bin/nvcc" --std=c++17 --compiler-options=/MT,/Zi,/Od -g -G -O0 -DNDEBUG -D_ITERATOR_DEBUG_LEVEL=0 -I"{native_dir}" -line-info {" ".join(nvcc_opts)} -DWP_ENABLE_CUDA=1 -D{mathdx_enabled} {libmathdx_includes} -o "{cu_out}" -c "{cu_path}"'
+                    if mode == "debug":
+                        cuda_cmd = f'"{cuda_home}/bin/nvcc" --std=c++17 --compiler-options=/MT,/Zi,/Od -g -G -O0 -DNDEBUG -D_ITERATOR_DEBUG_LEVEL=0 -I"{native_dir}" -line-info {" ".join(_nvcc_opts)} -DWP_ENABLE_CUDA=1 -D{mathdx_enabled} {libmathdx_includes} -o "{cu_out}" -c "{cu_path}"'
+                    elif mode == "release":
+                        cuda_cmd = f'"{cuda_home}/bin/nvcc" --std=c++17 -O3 {" ".join(_nvcc_opts)} -I"{native_dir}" -DNDEBUG -DWP_ENABLE_CUDA=1 -D{mathdx_enabled} {libmathdx_includes} -o "{cu_out}" -c "{cu_path}"'
 
-            elif mode == "release":
-                cuda_cmd = f'"{cuda_home}/bin/nvcc" --std=c++17 -O3 {" ".join(nvcc_opts)} -I"{native_dir}" -DNDEBUG -DWP_ENABLE_CUDA=1 -D{mathdx_enabled} {libmathdx_includes} -o "{cu_out}" -c "{cu_path}"'
+                    cuda_cmds.append(cuda_cmd)
+
+                    linkopts.append(quote(cu_out))
 
-            with ScopedTimer("build_cuda", active=args.verbose):
-                run_cmd(cuda_cmd)
-                linkopts.append(quote(cu_out))
                 linkopts.append(
                     f'cudart_static.lib nvrtc_static.lib nvrtc-builtins_static.lib nvptxcompiler_static.lib ws2_32.lib user32.lib /LIBPATH:"{cuda_home}/lib/x64"'
                 )
@@ -630,6 +488,23 @@ def build_dll_for_arch(args, dll_path, cpp_paths, cu_path, arch, libs: list[str]
                 if args.libmathdx_path:
                     linkopts.append(f'nvJitLink_static.lib /LIBPATH:"{args.libmathdx_path}/lib/x64" mathdx_static.lib')
 
+            if args.jobs <= 1:
+                with ScopedTimer("build_cuda", active=args.verbose):
+                    for cuda_cmd in cuda_cmds:
+                        run_cmd(cuda_cmd)
+            else:
+                futures.extend([executor.submit(run_cmd, cmd=cuda_cmd) for cuda_cmd in cuda_cmds])
+
+            if futures:
+                done, pending = concurrent.futures.wait(futures, return_when=concurrent.futures.FIRST_EXCEPTION)
+                for d in done:
+                    if e := d.exception():
+                        for f in pending:
+                            f.cancel()
+                        raise e
+                elapsed = (time.perf_counter_ns() - wall_clock) / 1000000.0
+                print(f"build took {elapsed:.2f} ms ({args.jobs:d} workers)")
+
         with ScopedTimer("link", active=args.verbose):
             link_cmd = f'"{host_linker}" {" ".join(linkopts + libs)} /out:"{dll_path}"'
             run_cmd(link_cmd)
@@ -641,7 +516,7 @@ def build_dll_for_arch(args, dll_path, cpp_paths, cu_path, arch, libs: list[str]
 
         cpp_includes = f' -I"{warp_home_path.parent}/external/llvm-project/out/install/{mode}-{arch}/include"'
         cpp_includes += f' -I"{warp_home_path.parent}/_build/host-deps/llvm-project/release-{arch}/include"'
-        cuda_includes = f' -I"{cuda_home}/include"' if cu_path else ""
+        cuda_includes = f' -I"{cuda_home}/include"' if cu_paths else ""
         includes = cpp_includes + cuda_includes
 
         if sys.platform == "darwin":
@@ -668,33 +543,48 @@ def build_dll_for_arch(args, dll_path, cpp_paths, cu_path, arch, libs: list[str]
 
         ld_inputs = []
 
-        with ScopedTimer("build", active=args.verbose):
+        with concurrent.futures.ThreadPoolExecutor(max_workers=args.jobs) as executor:
+            futures, wall_clock = [], time.perf_counter_ns()
+
+            cpp_cmds = []
             for cpp_path in cpp_paths:
                 cpp_out = cpp_path + ".o"
                 ld_inputs.append(quote(cpp_out))
+                cpp_cmd = f'{cpp_compiler} {cpp_flags} -c "{cpp_path}" -o "{cpp_out}"'
+                cpp_cmds.append(cpp_cmd)
+
+            if args.jobs <= 1:
+                with ScopedTimer("build", active=args.verbose):
+                    for cpp_cmd in cpp_cmds:
+                        run_cmd(cpp_cmd)
+            else:
+                futures = [executor.submit(run_cmd, cmd=cpp_cmd) for cpp_cmd in cpp_cmds]
 
-                build_cmd = f'{cpp_compiler} {cpp_flags} -c "{cpp_path}" -o "{cpp_out}"'
-                run_cmd(build_cmd)
+            cuda_cmds = []
+            if cu_paths:
+                for cu_path in cu_paths:
+                    cu_out = cu_path + ".o"
 
-        if cu_path:
-            cu_out = cu_path + ".o"
+                    _nvcc_opts = [
+                        opt.replace("@filename@", os.path.basename(cu_path).replace(".", "_")) for opt in nvcc_opts
+                    ]
 
-            if cuda_compiler == "nvcc":
-                if mode == "debug":
-                    cuda_cmd = f'"{cuda_home}/bin/nvcc" --std=c++17 -g -G -O0 --compiler-options -fPIC,-fvisibility=hidden -D_DEBUG -D_ITERATOR_DEBUG_LEVEL=0 -line-info {" ".join(nvcc_opts)} -DWP_ENABLE_CUDA=1 -I"{native_dir}" -D{mathdx_enabled} {libmathdx_includes} -o "{cu_out}" -c "{cu_path}"'
-                elif mode == "release":
-                    cuda_cmd = f'"{cuda_home}/bin/nvcc" --std=c++17 -O3 --compiler-options -fPIC,-fvisibility=hidden {" ".join(nvcc_opts)} -DNDEBUG -DWP_ENABLE_CUDA=1 -I"{native_dir}" -D{mathdx_enabled} {libmathdx_includes} -o "{cu_out}" -c "{cu_path}"'
-            else:
-                # Use Clang compiler
-                if mode == "debug":
-                    cuda_cmd = f'clang++ -Werror -Wuninitialized -Wno-unknown-cuda-version {" ".join(clang_opts)} -g -O0 -fPIC -fvisibility=hidden -D_DEBUG -D_ITERATOR_DEBUG_LEVEL=0 -DWP_ENABLE_CUDA=1 -I"{native_dir}" -D{mathdx_enabled} {libmathdx_includes} -o "{cu_out}" -c "{cu_path}"'
-                elif mode == "release":
-                    cuda_cmd = f'clang++ -Werror -Wuninitialized -Wno-unknown-cuda-version {" ".join(clang_opts)} -O3 -fPIC -fvisibility=hidden -DNDEBUG -DWP_ENABLE_CUDA=1 -I"{native_dir}" -D{mathdx_enabled} {libmathdx_includes} -o "{cu_out}" -c "{cu_path}"'
+                    if cuda_compiler == "nvcc":
+                        if mode == "debug":
+                            cuda_cmd = f'"{cuda_home}/bin/nvcc" --std=c++17 -g -G -O0 --compiler-options -fPIC,-fvisibility=hidden -D_DEBUG -D_ITERATOR_DEBUG_LEVEL=0 -line-info {" ".join(_nvcc_opts)} -DWP_ENABLE_CUDA=1 -I"{native_dir}" -D{mathdx_enabled} {libmathdx_includes} -o "{cu_out}" -c "{cu_path}"'
+                        elif mode == "release":
+                            cuda_cmd = f'"{cuda_home}/bin/nvcc" --std=c++17 -O3 --compiler-options -fPIC,-fvisibility=hidden {" ".join(_nvcc_opts)} -DNDEBUG -DWP_ENABLE_CUDA=1 -I"{native_dir}" -D{mathdx_enabled} {libmathdx_includes} -o "{cu_out}" -c "{cu_path}"'
+                    else:
+                        # Use Clang compiler
+                        if mode == "debug":
+                            cuda_cmd = f'clang++ -Werror -Wuninitialized -Wno-unknown-cuda-version {" ".join(clang_opts)} -g -O0 -fPIC -fvisibility=hidden -D_DEBUG -D_ITERATOR_DEBUG_LEVEL=0 -DWP_ENABLE_CUDA=1 -I"{native_dir}" -D{mathdx_enabled} {libmathdx_includes} -o "{cu_out}" -c "{cu_path}"'
+                        elif mode == "release":
+                            cuda_cmd = f'clang++ -Werror -Wuninitialized -Wno-unknown-cuda-version {" ".join(clang_opts)} -O3 -fPIC -fvisibility=hidden -DNDEBUG -DWP_ENABLE_CUDA=1 -I"{native_dir}" -D{mathdx_enabled} {libmathdx_includes} -o "{cu_out}" -c "{cu_path}"'
+
+                    cuda_cmds.append(cuda_cmd)
 
-            with ScopedTimer("build_cuda", active=args.verbose):
-                run_cmd(cuda_cmd)
+                    ld_inputs.append(quote(cu_out))
 
-                ld_inputs.append(quote(cu_out))
                 ld_inputs.append(
                     f'-L"{cuda_home}/lib64" -lcudart_static -lnvrtc_static -lnvrtc-builtins_static -lnvptxcompiler_static -lpthread -ldl -lrt'
                 )
@@ -702,6 +592,23 @@ def build_dll_for_arch(args, dll_path, cpp_paths, cu_path, arch, libs: list[str]
                 if args.libmathdx_path:
                     ld_inputs.append(f"-lnvJitLink_static -L{args.libmathdx_path}/lib -lmathdx_static")
 
+            if args.jobs <= 1:
+                with ScopedTimer("build_cuda", active=args.verbose):
+                    for cuda_cmd in cuda_cmds:
+                        run_cmd(cuda_cmd)
+            else:
+                futures.extend([executor.submit(run_cmd, cmd=cuda_cmd) for cuda_cmd in cuda_cmds])
+
+            if futures:
+                done, pending = concurrent.futures.wait(futures, return_when=concurrent.futures.FIRST_EXCEPTION)
+                for d in done:
+                    if e := d.exception():
+                        for f in pending:
+                            f.cancel()
+                        raise e
+                elapsed = (time.perf_counter_ns() - wall_clock) / 1000000.0
+                print(f"build took {elapsed:.2f} ms ({args.jobs:d} workers)")
+
         if sys.platform == "darwin":
             opt_no_undefined = "-Wl,-undefined,error"
             opt_exclude_libs = ""
@@ -725,15 +632,15 @@ def build_dll_for_arch(args, dll_path, cpp_paths, cu_path, arch, libs: list[str]
                     )
 
 
-def build_dll(args, dll_path, cpp_paths, cu_path, libs=None):
+def build_dll(args, dll_path, cpp_paths, cu_paths, libs=None):
     if sys.platform == "darwin":
         # create a universal binary by combining x86-64 and AArch64 builds
-        build_dll_for_arch(args, dll_path + "-x86_64", cpp_paths, cu_path, "x86_64", libs)
-        build_dll_for_arch(args, dll_path + "-aarch64", cpp_paths, cu_path, "aarch64", libs)
+        build_dll_for_arch(args, dll_path + "-x86_64", cpp_paths, cu_paths, "x86_64", libs)
+        build_dll_for_arch(args, dll_path + "-aarch64", cpp_paths, cu_paths, "aarch64", libs)
 
         run_cmd(f"lipo -create -output {dll_path} {dll_path}-x86_64 {dll_path}-aarch64")
         os.remove(f"{dll_path}-x86_64")
         os.remove(f"{dll_path}-aarch64")
 
     else:
-        build_dll_for_arch(args, dll_path, cpp_paths, cu_path, machine_architecture(), libs)
+        build_dll_for_arch(args, dll_path, cpp_paths, cu_paths, machine_architecture(), libs)
diff --git a/warp/builtins.py b/warp/builtins.py
index e2e20cfc..e1769bc9 100644
--- a/warp/builtins.py
+++ b/warp/builtins.py
@@ -126,7 +126,7 @@ add_builtin(
     value_func=sametypes_create_value_func(Scalar),
     doc="Return -1 if ``x`` < 0, return 1 otherwise.",
     group="Scalar Math",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -135,7 +135,7 @@ add_builtin(
     value_func=sametypes_create_value_func(Scalar),
     doc="Return 1.0 if ``x`` < 0.0, return 0.0 otherwise.",
     group="Scalar Math",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "nonzero",
@@ -143,7 +143,7 @@ add_builtin(
     value_func=sametypes_create_value_func(Scalar),
     doc="Return 1.0 if ``x`` is not equal to zero, return 0.0 otherwise.",
     group="Scalar Math",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -295,7 +295,7 @@ add_builtin(
 
     This is the most intuitive form of rounding in the colloquial sense, but can be slower than other options like :func:`warp.rint()`.
     Differs from :func:`numpy.round()`, which behaves the same way as :func:`numpy.rint()`.""",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -306,7 +306,7 @@ add_builtin(
     doc="""Return the nearest integer value to ``x``, rounding halfway cases to nearest even integer.
 
     It is generally faster than :func:`warp.round()`. Equivalent to :func:`numpy.rint()`.""",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -319,7 +319,7 @@ add_builtin(
     In other words, it discards the fractional part of ``x``.
     It is similar to casting ``float(int(a))``, but preserves the negative sign when ``x`` is in the range [-0.0, -1.0).
     Equivalent to :func:`numpy.trunc()` and :func:`numpy.fix()`.""",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -328,7 +328,7 @@ add_builtin(
     value_func=sametypes_create_value_func(Float),
     group="Scalar Math",
     doc="""Return the largest integer that is less than or equal to ``x``.""",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -337,7 +337,7 @@ add_builtin(
     value_func=sametypes_create_value_func(Float),
     group="Scalar Math",
     doc="""Return the smallest integer that is greater than or equal to ``x``.""",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -348,7 +348,7 @@ add_builtin(
     doc="""Retrieve the fractional part of ``x``.
 
     In other words, it discards the integer part of ``x`` and is equivalent to ``x - trunc(x)``.""",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -357,7 +357,7 @@ add_builtin(
     value_type=builtins.bool,
     group="Scalar Math",
     doc="""Return ``True`` if ``a`` is a finite number, otherwise return ``False``.""",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "isfinite",
@@ -365,7 +365,7 @@ add_builtin(
     value_type=builtins.bool,
     group="Vector Math",
     doc="Return ``True`` if all elements of the vector ``a`` are finite, otherwise return ``False``.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "isfinite",
@@ -373,7 +373,7 @@ add_builtin(
     value_type=builtins.bool,
     group="Vector Math",
     doc="Return ``True`` if all elements of the quaternion ``a`` are finite, otherwise return ``False``.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "isfinite",
@@ -381,7 +381,7 @@ add_builtin(
     value_type=builtins.bool,
     group="Vector Math",
     doc="Return ``True`` if all elements of the matrix ``a`` are finite, otherwise return ``False``.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -390,7 +390,7 @@ add_builtin(
     value_type=builtins.bool,
     doc="Return ``True`` if ``a`` is NaN, otherwise return ``False``.",
     group="Scalar Math",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "isnan",
@@ -398,7 +398,7 @@ add_builtin(
     value_type=builtins.bool,
     group="Vector Math",
     doc="Return ``True`` if any element of the vector ``a`` is NaN, otherwise return ``False``.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "isnan",
@@ -406,7 +406,7 @@ add_builtin(
     value_type=builtins.bool,
     group="Vector Math",
     doc="Return ``True`` if any element of the quaternion ``a`` is NaN, otherwise return ``False``.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "isnan",
@@ -414,7 +414,7 @@ add_builtin(
     value_type=builtins.bool,
     group="Vector Math",
     doc="Return ``True`` if any element of the matrix ``a`` is NaN, otherwise return ``False``.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -423,7 +423,7 @@ add_builtin(
     value_type=builtins.bool,
     group="Scalar Math",
     doc="""Return ``True`` if ``a`` is positive or negative infinity, otherwise return ``False``.""",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "isinf",
@@ -431,7 +431,7 @@ add_builtin(
     value_type=builtins.bool,
     group="Vector Math",
     doc="Return ``True`` if any element of the vector ``a`` is positive or negative infinity, otherwise return ``False``.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "isinf",
@@ -439,7 +439,7 @@ add_builtin(
     value_type=builtins.bool,
     group="Vector Math",
     doc="Return ``True`` if any element of the quaternion ``a`` is positive or negative infinity, otherwise return ``False``.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "isinf",
@@ -447,7 +447,7 @@ add_builtin(
     value_type=builtins.bool,
     group="Vector Math",
     doc="Return ``True`` if any element of the matrix ``a`` is positive or negative infinity, otherwise return ``False``.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -555,7 +555,7 @@ add_builtin(
     value_func=lambda arg_types, arg_values: warp.uint32,
     doc="Return the index of the minimum element of a vector ``a``.",
     group="Vector Math",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "argmax",
@@ -563,7 +563,7 @@ add_builtin(
     value_func=lambda arg_types, arg_values: warp.uint32,
     doc="Return the index of the maximum element of a vector ``a``.",
     group="Vector Math",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -1203,7 +1203,7 @@ add_builtin(
     doc="Create an identity matrix with shape=(n,n) with the type given by ``dtype``.",
     group="Vector Math",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -1568,7 +1568,7 @@ add_builtin(
     group="Quaternion Math",
     doc="Construct an identity quaternion with zero imaginary part and real part of 1.0",
     export=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -1784,7 +1784,7 @@ add_builtin(
     doc="Construct a spatial transform vector of given dtype.",
     group="Spatial Math",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -1819,7 +1819,7 @@ add_builtin(
     group="Transformations",
     doc="Construct an identity transform with zero translation and identity rotation.",
     export=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -2147,7 +2147,7 @@ add_builtin(
     value_func=tile_zeros_value_func,
     dispatch_func=tile_zeros_dispatch_func,
     variadic=False,
-    missing_grad=True,
+    is_differentiable=False,
     doc="""Allocate a tile of zero-initialized items.
 
     :param shape: Shape of the output tile
@@ -2167,7 +2167,7 @@ add_builtin(
     value_func=tile_zeros_value_func,
     dispatch_func=tile_zeros_dispatch_func,
     variadic=False,
-    missing_grad=True,
+    is_differentiable=False,
     hidden=True,
     group="Tile Primitives",
     export=False,
@@ -2219,7 +2219,7 @@ add_builtin(
     defaults={"storage": "register"},
     value_func=tile_ones_value_func,
     dispatch_func=tile_ones_dispatch_func,
-    missing_grad=True,
+    is_differentiable=False,
     doc="""Allocate a tile of one-initialized items.
 
     :param shape: Shape of the output tile
@@ -2238,7 +2238,7 @@ add_builtin(
     defaults={"storage": "register"},
     value_func=tile_ones_value_func,
     dispatch_func=tile_ones_dispatch_func,
-    missing_grad=True,
+    is_differentiable=False,
     hidden=True,
     group="Tile Primitives",
     export=False,
@@ -2329,7 +2329,7 @@ add_builtin(
     value_func=tile_arange_value_func,
     dispatch_func=tile_arange_dispatch_func,
     variadic=True,
-    missing_grad=True,
+    is_differentiable=False,
     doc="""Generate a tile of linearly spaced elements.
 
     :param args: Variable-length positional arguments, interpreted as:
@@ -3124,7 +3124,7 @@ add_builtin(
     :param shape: Shape of the returned slice
     :returns: A tile with dimensions given by the specified shape or the remaining source tile dimensions""",
     group="Tile Primitives",
-    missing_grad=True,
+    is_differentiable=False,
     export=False,
 )
 
@@ -3762,6 +3762,117 @@ add_builtin(
     export=False,
 )
 
+add_builtin(
+    "tile_bit_and_inplace",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "i": int, "value": Any},
+    value_func=tile_inplace_value_func,
+    group="Tile Primitives",
+    hidden=True,
+    export=False,
+    is_differentiable=False,
+)
+add_builtin(
+    "tile_bit_and_inplace",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "i": int, "j": int, "value": Any},
+    value_func=tile_inplace_value_func,
+    group="Tile Primitives",
+    hidden=True,
+    export=False,
+    is_differentiable=False,
+)
+add_builtin(
+    "tile_bit_and_inplace",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "i": int, "j": int, "k": int, "value": Any},
+    value_func=tile_inplace_value_func,
+    group="Tile Primitives",
+    hidden=True,
+    export=False,
+    is_differentiable=False,
+)
+add_builtin(
+    "tile_bit_and_inplace",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "i": int, "j": int, "k": int, "l": int, "value": Any},
+    value_func=tile_inplace_value_func,
+    group="Tile Primitives",
+    hidden=True,
+    export=False,
+    is_differentiable=False,
+)
+
+add_builtin(
+    "tile_bit_or_inplace",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "i": int, "value": Any},
+    value_func=tile_inplace_value_func,
+    group="Tile Primitives",
+    hidden=True,
+    export=False,
+    is_differentiable=False,
+)
+add_builtin(
+    "tile_bit_or_inplace",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "i": int, "j": int, "value": Any},
+    value_func=tile_inplace_value_func,
+    group="Tile Primitives",
+    hidden=True,
+    export=False,
+    is_differentiable=False,
+)
+add_builtin(
+    "tile_bit_or_inplace",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "i": int, "j": int, "k": int, "value": Any},
+    value_func=tile_inplace_value_func,
+    group="Tile Primitives",
+    hidden=True,
+    export=False,
+    is_differentiable=False,
+)
+add_builtin(
+    "tile_bit_or_inplace",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "i": int, "j": int, "k": int, "l": int, "value": Any},
+    value_func=tile_inplace_value_func,
+    group="Tile Primitives",
+    hidden=True,
+    export=False,
+    is_differentiable=False,
+)
+
+add_builtin(
+    "tile_bit_xor_inplace",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "i": int, "value": Any},
+    value_func=tile_inplace_value_func,
+    group="Tile Primitives",
+    hidden=True,
+    export=False,
+    is_differentiable=False,
+)
+add_builtin(
+    "tile_bit_xor_inplace",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "i": int, "j": int, "value": Any},
+    value_func=tile_inplace_value_func,
+    group="Tile Primitives",
+    hidden=True,
+    export=False,
+    is_differentiable=False,
+)
+add_builtin(
+    "tile_bit_xor_inplace",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "i": int, "j": int, "k": int, "value": Any},
+    value_func=tile_inplace_value_func,
+    group="Tile Primitives",
+    hidden=True,
+    export=False,
+    is_differentiable=False,
+)
+add_builtin(
+    "tile_bit_xor_inplace",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "i": int, "j": int, "k": int, "l": int, "value": Any},
+    value_func=tile_inplace_value_func,
+    group="Tile Primitives",
+    hidden=True,
+    export=False,
+    is_differentiable=False,
+)
+
 
 def tile_transpose_value_func(arg_types, arg_values):
     # return generic type (for doc builds)
@@ -4011,7 +4122,7 @@ add_builtin(
     """,
     group="Tile Primitives",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -4065,7 +4176,7 @@ add_builtin(
     """,
     group="Tile Primitives",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -4119,7 +4230,7 @@ add_builtin(
     """,
     group="Tile Primitives",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -4172,7 +4283,7 @@ add_builtin(
     """,
     group="Tile Primitives",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -4225,7 +4336,7 @@ add_builtin(
     """,
     group="Tile Primitives",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -4283,7 +4394,7 @@ add_builtin(
     """,
     group="Tile Primitives",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -4347,7 +4458,7 @@ add_builtin(
     """,
     group="Tile Primitives",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -4411,7 +4522,7 @@ add_builtin(
     """,
     group="Tile Primitives",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -4665,7 +4776,7 @@ add_builtin(
     doc="WIP",
     group="Utility",
     hidden=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -4681,7 +4792,7 @@ add_builtin(
     doc="WIP",
     group="Utility",
     hidden=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -4691,7 +4802,7 @@ add_builtin(
     doc="WIP",
     group="Utility",
     hidden=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -4743,7 +4854,7 @@ add_builtin(
     :param low: The lower bound of the bounding box in BVH space
     :param high: The upper bound of the bounding box in BVH space""",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -4759,7 +4870,7 @@ add_builtin(
     :param start: The start of the ray in BVH space
     :param dir: The direction of the ray in BVH space""",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -4770,7 +4881,7 @@ add_builtin(
     doc="""Move to the next bound returned by the query.
     The index of the current bound is stored in ``index``, returns ``False`` if there are no more overlapping bound.""",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5111,7 +5222,7 @@ add_builtin(
     :param low: The lower bound of the bounding box in mesh space
     :param high: The upper bound of the bounding box in mesh space""",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5123,7 +5234,7 @@ add_builtin(
 
     The index of the current face is stored in ``index``, returns ``False`` if there are no more overlapping triangles.""",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5153,7 +5264,7 @@ add_builtin(
 
     This query can be used to iterate over all neighboring point within a fixed radius from the query point.""",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5165,7 +5276,7 @@ add_builtin(
 
     The index of the current neighbor is stored in ``index``, returns ``False`` if there are no more neighbors.""",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5179,7 +5290,7 @@ add_builtin(
 
     Returns -1 if the :class:`HashGrid` has not been reserved.""",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5191,14 +5302,14 @@ add_builtin(
 
     Returns > 0 if triangles intersect.""",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
     "mesh_get",
     input_types={"id": uint64},
     value_type=Mesh,
-    missing_grad=True,
+    is_differentiable=False,
     group="Geometry",
     doc="""Retrieves the mesh given its index.""",
     export=False,
@@ -5211,7 +5322,7 @@ add_builtin(
     group="Geometry",
     doc="""Evaluates the face normal the mesh given a face index.""",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5221,7 +5332,7 @@ add_builtin(
     group="Geometry",
     doc="""Returns the point of the mesh given a index.""",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5231,7 +5342,7 @@ add_builtin(
     group="Geometry",
     doc="""Returns the velocity of the mesh given a index.""",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5241,7 +5352,7 @@ add_builtin(
     group="Geometry",
     doc="""Returns the point-index of the mesh given a face-vertex index.""",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -5289,7 +5400,7 @@ add_builtin(
     group="Utility",
     export=False,
     hidden=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "iter_next",
@@ -5298,7 +5409,7 @@ add_builtin(
     group="Utility",
     export=False,
     hidden=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "iter_next",
@@ -5307,7 +5418,7 @@ add_builtin(
     group="Utility",
     export=False,
     hidden=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5318,7 +5429,7 @@ add_builtin(
     group="Utility",
     doc="""Returns the range in reversed order.""",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 # ---------------------------------
@@ -5338,8 +5449,8 @@ _volume_supported_value_types = {
 
 
 def _is_volume_type_supported(dtype):
-    for typ in _volume_supported_value_types:
-        if types_equal(typ, dtype):
+    for value_type in _volume_supported_value_types:
+        if types_equal(value_type, dtype):
             return True
     return False
 
@@ -5467,7 +5578,7 @@ add_builtin(
     doc="""Returns the value of voxel with coordinates ``i``, ``j``, ``k`` for a volume of type type `dtype`.
 
     If the voxel at this index does not exist, this function returns the background value.""",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -5488,7 +5599,7 @@ add_builtin(
     export=False,
     group="Volumes",
     doc="""Store ``value`` at the voxel with coordinates ``i``, ``j``, ``k``.""",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5519,7 +5630,7 @@ add_builtin(
     doc="""Returns the value of voxel with coordinates ``i``, ``j``, ``k``.
 
     If the voxel at this index does not exist, this function returns the background value""",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5528,7 +5639,7 @@ add_builtin(
     group="Volumes",
     doc="""Store ``value`` at the voxel with coordinates ``i``, ``j``, ``k``.""",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5549,7 +5660,7 @@ add_builtin(
     doc="""Returns the vector value of voxel with coordinates ``i``, ``j``, ``k``.
 
     If the voxel at this index does not exist, this function returns the background value.""",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5558,7 +5669,7 @@ add_builtin(
     group="Volumes",
     doc="""Store ``value`` at the voxel with coordinates ``i``, ``j``, ``k``.""",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5577,7 +5688,7 @@ add_builtin(
     doc="""Returns the :class:`int32` value of voxel with coordinates ``i``, ``j``, ``k``.
 
     If the voxel at this index does not exist, this function returns the background value.""",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5586,7 +5697,7 @@ add_builtin(
     group="Volumes",
     doc="""Store ``value`` at the voxel with coordinates ``i``, ``j``, ``k``.""",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -5668,7 +5779,7 @@ add_builtin(
     If the voxel at this index does not exist, this function returns -1.
     This function is available for both index grids and classical volumes.
     """,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5710,7 +5821,7 @@ add_builtin(
     value_type=uint32,
     group="Random",
     doc="Initialize a new random number generator given a user-defined seed. Returns a 32-bit integer representing the RNG state.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5722,7 +5833,7 @@ add_builtin(
 
     This alternative constructor can be useful in parallel programs, where a kernel as a whole should share a seed,
     but each thread should generate uncorrelated values. In this case usage should be ``r = rand_init(seed, tid)``""",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5731,7 +5842,7 @@ add_builtin(
     value_type=int,
     group="Random",
     doc="Return a random integer in the range [-2^31, 2^31).",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "randi",
@@ -5739,7 +5850,7 @@ add_builtin(
     value_type=int,
     group="Random",
     doc="Return a random integer between [low, high).",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "randu",
@@ -5747,7 +5858,7 @@ add_builtin(
     value_type=uint32,
     group="Random",
     doc="Return a random unsigned integer in the range [0, 2^32).",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "randu",
@@ -5755,7 +5866,7 @@ add_builtin(
     value_type=uint32,
     group="Random",
     doc="Return a random unsigned integer between [low, high).",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "randf",
@@ -5763,7 +5874,7 @@ add_builtin(
     value_type=float,
     group="Random",
     doc="Return a random float between [0.0, 1.0).",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "randf",
@@ -5771,7 +5882,7 @@ add_builtin(
     value_type=float,
     group="Random",
     doc="Return a random float between [low, high).",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "randn",
@@ -5779,7 +5890,7 @@ add_builtin(
     value_type=float,
     group="Random",
     doc="Sample a normal (Gaussian) distribution of mean 0 and variance 1. ",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5788,7 +5899,7 @@ add_builtin(
     value_type=int,
     group="Random",
     doc="Inverse-transform sample a cumulative distribution function.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "sample_triangle",
@@ -5796,7 +5907,7 @@ add_builtin(
     value_type=vec2,
     group="Random",
     doc="Uniformly sample a triangle. Returns sample barycentric coordinates.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "sample_unit_ring",
@@ -5804,7 +5915,7 @@ add_builtin(
     value_type=vec2,
     group="Random",
     doc="Uniformly sample a ring in the xy plane.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "sample_unit_disk",
@@ -5812,7 +5923,7 @@ add_builtin(
     value_type=vec2,
     group="Random",
     doc="Uniformly sample a disk in the xy plane.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "sample_unit_sphere_surface",
@@ -5820,7 +5931,7 @@ add_builtin(
     value_type=vec3,
     group="Random",
     doc="Uniformly sample a unit sphere surface.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "sample_unit_sphere",
@@ -5828,7 +5939,7 @@ add_builtin(
     value_type=vec3,
     group="Random",
     doc="Uniformly sample a unit sphere.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "sample_unit_hemisphere_surface",
@@ -5836,7 +5947,7 @@ add_builtin(
     value_type=vec3,
     group="Random",
     doc="Uniformly sample a unit hemisphere surface.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "sample_unit_hemisphere",
@@ -5844,7 +5955,7 @@ add_builtin(
     value_type=vec3,
     group="Random",
     doc="Uniformly sample a unit hemisphere.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "sample_unit_square",
@@ -5852,7 +5963,7 @@ add_builtin(
     value_type=vec2,
     group="Random",
     doc="Uniformly sample a unit square.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "sample_unit_cube",
@@ -5860,7 +5971,7 @@ add_builtin(
     value_type=vec3,
     group="Random",
     doc="Uniformly sample a unit cube.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5872,7 +5983,7 @@ add_builtin(
 
     :param state: RNG state
     :param lam: The expected value of the distribution""",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -5940,7 +6051,7 @@ add_builtin(
     value_type=vec2,
     group="Random",
     doc="Divergence-free vector field based on the gradient of a Perlin noise function.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "curlnoise",
@@ -5949,7 +6060,7 @@ add_builtin(
     value_type=vec3,
     group="Random",
     doc="Divergence-free vector field based on the curl of three Perlin noise functions.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "curlnoise",
@@ -5958,7 +6069,7 @@ add_builtin(
     value_type=vec3,
     group="Random",
     doc="Divergence-free vector field based on the curl of three Perlin noise functions.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -5990,7 +6101,7 @@ add_builtin(
     dispatch_func=printf_dispatch_func,
     group="Utility",
     doc="Allows printing formatted strings using C-style format specifiers.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -6009,7 +6120,7 @@ add_builtin(
     group="Utility",
     namespace="",
     native_func="__debugbreak",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 # helpers
@@ -6027,7 +6138,7 @@ add_builtin(
     This function may not be called from user-defined Warp functions.""",
     namespace="",
     native_func="builtin_tid1d",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -6038,7 +6149,7 @@ add_builtin(
     doc="Returns the number of threads in the current block.",
     namespace="",
     native_func="builtin_block_dim",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -6053,7 +6164,7 @@ add_builtin(
     This function may not be called from user-defined Warp functions.""",
     namespace="",
     native_func="builtin_tid2d",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -6068,7 +6179,7 @@ add_builtin(
     This function may not be called from user-defined Warp functions.""",
     namespace="",
     native_func="builtin_tid3d",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -6083,7 +6194,7 @@ add_builtin(
     This function may not be called from user-defined Warp functions.""",
     namespace="",
     native_func="builtin_tid4d",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -6291,7 +6402,7 @@ add_builtin(
     group="Utility",
     hidden=True,
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -6332,7 +6443,7 @@ add_builtin(
     native_func="fixedarray_t",
     group="Utility",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
     hidden=True,  # Unhide once we can document both a built-in and a Python scope function sharing the same name.
 )
 
@@ -6375,14 +6486,13 @@ for array_type in array_types:
 # does argument checking and type propagation for view()
 def view_value_func(arg_types: Mapping[str, type], arg_values: Mapping[str, Any]):
     arr_type = arg_types["arr"]
-    idx_types = tuple(arg_types[x] for x in "ijk" if arg_types.get(x, None) is not None)
+    idx_types = tuple(arg_types[x] for x in "ijkl" if arg_types.get(x, None) is not None)
 
     if not is_array(arr_type):
         raise RuntimeError("view() first argument must be an array")
 
     idx_count = len(idx_types)
-
-    if idx_count >= arr_type.ndim:
+    if idx_count > arr_type.ndim:
         raise RuntimeError(
             f"Trying to create an array view with {idx_count} indices, "
             f"but the array only has {arr_type.ndim} dimension(s). "
@@ -6390,14 +6500,35 @@ def view_value_func(arg_types: Mapping[str, type], arg_values: Mapping[str, Any]
             f"the expected number of dimensions, e.g.: def func(param: wp.array3d(dtype=float): ..."
         )
 
-    # check index types
-    for t in idx_types:
-        if not type_is_int(t):
-            raise RuntimeError(f"view() index arguments must be of integer type, got index of type {type_repr(t)}")
+    has_slice = any(is_slice(x) for x in idx_types)
+    if has_slice:
+        # check index types
+        for t in idx_types:
+            if not (type_is_int(t) or is_slice(t)):
+                raise RuntimeError(
+                    f"view() index arguments must be of integer or slice types, got index of type {type_repr(t)}"
+                )
+
+        # Each integer index collapses one dimension.
+        int_count = sum(x.step == 0 for x in idx_types)
+        ndim = arr_type.ndim - int_count
+        assert ndim > 0
+    else:
+        if idx_count == arr_type.ndim:
+            raise RuntimeError("Expected to call `address()` instead of `view()`")
+
+        # check index types
+        for t in idx_types:
+            if not type_is_int(t):
+                raise RuntimeError(
+                    f"view() index arguments must be of integer or slice types, got index of type {type_repr(t)}"
+                )
+
+        # create an array view with leading dimensions removed
+        ndim = arr_type.ndim - idx_count
+        assert ndim > 0
 
-    # create an array view with leading dimensions removed
     dtype = arr_type.dtype
-    ndim = arr_type.ndim - idx_count
     if isinstance(arr_type, (fabricarray, indexedfabricarray)):
         # fabric array of arrays: return array attribute as a regular array
         return array(dtype=dtype, ndim=ndim)
@@ -6408,8 +6539,18 @@ def view_value_func(arg_types: Mapping[str, type], arg_values: Mapping[str, Any]
 for array_type in array_types:
     add_builtin(
         "view",
-        input_types={"arr": array_type(dtype=Any), "i": Int, "j": Int, "k": Int},
-        defaults={"j": None, "k": None},
+        input_types={
+            "arr": array_type(dtype=Any),
+            "i": Any,
+            "j": Any,
+            "k": Any,
+            "l": Any,
+        },
+        defaults={
+            "j": None,
+            "k": None,
+            "l": None,
+        },
         constraint=sametypes,
         hidden=True,
         value_func=view_value_func,
@@ -6513,7 +6654,7 @@ add_builtin(
     hidden=True,
     skip_replay=True,
     group="Utility",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -6530,7 +6671,7 @@ add_builtin(
     dispatch_func=load_dispatch_func,
     hidden=True,
     group="Utility",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -6606,6 +6747,13 @@ def create_atomic_op_value_func(op: str):
                     f"atomic_{op}() operations only work on arrays with [u]int32, [u]int64, float32, or float64 "
                     f"as the underlying scalar types, but got {type_repr(arr_type.dtype)} (with scalar type {type_repr(scalar_type)})"
                 )
+        elif op in ("and", "or", "xor"):
+            supported_atomic_types = (warp.int32, warp.int64, warp.uint32, warp.uint64)
+            if not any(types_equal(scalar_type, x, match_generic=True) for x in supported_atomic_types):
+                raise RuntimeError(
+                    f"atomic_{op}() operations only work on arrays with [u]int32 or [u]int64 "
+                    f"as the underlying scalar types, but got {type_repr(arr_type.dtype)} (with scalar type {type_repr(scalar_type)})"
+                )
         else:
             raise NotImplementedError
 
@@ -6847,7 +6995,7 @@ for array_type in array_types:
     The operation is only atomic on a per-component basis for vectors and matrices.""",
         group="Utility",
         skip_replay=True,
-        missing_grad=True,
+        is_differentiable=False,
     )
     add_builtin(
         "atomic_cas",
@@ -6861,7 +7009,7 @@ for array_type in array_types:
     The operation is only atomic on a per-component basis for vectors and matrices.""",
         group="Utility",
         skip_replay=True,
-        missing_grad=True,
+        is_differentiable=False,
     )
     add_builtin(
         "atomic_cas",
@@ -6875,7 +7023,7 @@ for array_type in array_types:
     The operation is only atomic on a per-component basis for vectors and matrices.""",
         group="Utility",
         skip_replay=True,
-        missing_grad=True,
+        is_differentiable=False,
     )
     add_builtin(
         "atomic_cas",
@@ -6897,7 +7045,7 @@ for array_type in array_types:
     The operation is only atomic on a per-component basis for vectors and matrices.""",
         group="Utility",
         skip_replay=True,
-        missing_grad=True,
+        is_differentiable=False,
     )
 
     add_builtin(
@@ -6912,7 +7060,7 @@ for array_type in array_types:
     The operation is only atomic on a per-component basis for vectors and matrices.""",
         group="Utility",
         skip_replay=True,
-        missing_grad=True,
+        is_differentiable=False,
     )
     add_builtin(
         "atomic_exch",
@@ -6926,7 +7074,7 @@ for array_type in array_types:
     The operation is only atomic on a per-component basis for vectors and matrices.""",
         group="Utility",
         skip_replay=True,
-        missing_grad=True,
+        is_differentiable=False,
     )
     add_builtin(
         "atomic_exch",
@@ -6940,7 +7088,7 @@ for array_type in array_types:
     The operation is only atomic on a per-component basis for vectors and matrices.""",
         group="Utility",
         skip_replay=True,
-        missing_grad=True,
+        is_differentiable=False,
     )
     add_builtin(
         "atomic_exch",
@@ -6956,6 +7104,165 @@ for array_type in array_types:
         skip_replay=True,
     )
 
+    add_builtin(
+        "atomic_and",
+        hidden=hidden,
+        input_types={"arr": array_type(dtype=Any), "i": Int, "value": Any},
+        constraint=atomic_op_constraint,
+        value_func=create_atomic_op_value_func("and"),
+        dispatch_func=atomic_op_dispatch_func,
+        doc="""Atomically performs a bitwise AND between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i] &= value``.""",
+        group="Utility",
+        skip_replay=True,
+        is_differentiable=False,
+    )
+    add_builtin(
+        "atomic_and",
+        hidden=hidden,
+        input_types={"arr": array_type(dtype=Any), "i": Int, "j": Int, "value": Any},
+        constraint=atomic_op_constraint,
+        value_func=create_atomic_op_value_func("and"),
+        dispatch_func=atomic_op_dispatch_func,
+        doc="""Atomically performs a bitwise AND between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j] &= value``.""",
+        group="Utility",
+        skip_replay=True,
+        is_differentiable=False,
+    )
+    add_builtin(
+        "atomic_and",
+        hidden=hidden,
+        input_types={"arr": array_type(dtype=Any), "i": Int, "j": Int, "k": Int, "value": Any},
+        constraint=atomic_op_constraint,
+        value_func=create_atomic_op_value_func("and"),
+        dispatch_func=atomic_op_dispatch_func,
+        doc="""Atomically performs a bitwise AND between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k] &= value``.""",
+        group="Utility",
+        skip_replay=True,
+        is_differentiable=False,
+    )
+    add_builtin(
+        "atomic_and",
+        hidden=hidden,
+        input_types={"arr": array_type(dtype=Any), "i": Int, "j": Int, "k": Int, "l": Int, "value": Any},
+        constraint=atomic_op_constraint,
+        value_func=create_atomic_op_value_func("and"),
+        dispatch_func=atomic_op_dispatch_func,
+        doc="""Atomically performs a bitwise AND between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k,l] &= value``.""",
+        group="Utility",
+        skip_replay=True,
+        is_differentiable=False,
+    )
+
+    add_builtin(
+        "atomic_or",
+        hidden=hidden,
+        input_types={"arr": array_type(dtype=Any), "i": Int, "value": Any},
+        constraint=atomic_op_constraint,
+        value_func=create_atomic_op_value_func("or"),
+        dispatch_func=atomic_op_dispatch_func,
+        doc="""Atomically performs a bitwise OR between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i] |= value``.""",
+        group="Utility",
+        skip_replay=True,
+        is_differentiable=False,
+    )
+    add_builtin(
+        "atomic_or",
+        hidden=hidden,
+        input_types={"arr": array_type(dtype=Any), "i": Int, "j": Int, "value": Any},
+        constraint=atomic_op_constraint,
+        value_func=create_atomic_op_value_func("or"),
+        dispatch_func=atomic_op_dispatch_func,
+        doc="""Atomically performs a bitwise OR between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j] |= value``.""",
+        group="Utility",
+        skip_replay=True,
+        is_differentiable=False,
+    )
+    add_builtin(
+        "atomic_or",
+        hidden=hidden,
+        input_types={"arr": array_type(dtype=Any), "i": Int, "j": Int, "k": Int, "value": Any},
+        constraint=atomic_op_constraint,
+        value_func=create_atomic_op_value_func("or"),
+        dispatch_func=atomic_op_dispatch_func,
+        doc="""Atomically performs a bitwise OR between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k] |= value``.""",
+        group="Utility",
+        skip_replay=True,
+        is_differentiable=False,
+    )
+    add_builtin(
+        "atomic_or",
+        hidden=hidden,
+        input_types={"arr": array_type(dtype=Any), "i": Int, "j": Int, "k": Int, "l": Int, "value": Any},
+        constraint=atomic_op_constraint,
+        value_func=create_atomic_op_value_func("or"),
+        dispatch_func=atomic_op_dispatch_func,
+        doc="""Atomically performs a bitwise OR between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k,l] |= value``.""",
+        group="Utility",
+        skip_replay=True,
+        is_differentiable=False,
+    )
+
+    add_builtin(
+        "atomic_xor",
+        hidden=hidden,
+        input_types={"arr": array_type(dtype=Any), "i": Int, "value": Any},
+        constraint=atomic_op_constraint,
+        value_func=create_atomic_op_value_func("xor"),
+        dispatch_func=atomic_op_dispatch_func,
+        doc="""Atomically performs a bitwise XOR between ``value`` and ``arr[i]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i] ^= value``.""",
+        group="Utility",
+        skip_replay=True,
+        is_differentiable=False,
+    )
+    add_builtin(
+        "atomic_xor",
+        hidden=hidden,
+        input_types={"arr": array_type(dtype=Any), "i": Int, "j": Int, "value": Any},
+        constraint=atomic_op_constraint,
+        value_func=create_atomic_op_value_func("xor"),
+        dispatch_func=atomic_op_dispatch_func,
+        doc="""Atomically performs a bitwise XOR between ``value`` and ``arr[i,j]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j] ^= value``.""",
+        group="Utility",
+        skip_replay=True,
+        is_differentiable=False,
+    )
+    add_builtin(
+        "atomic_xor",
+        hidden=hidden,
+        input_types={"arr": array_type(dtype=Any), "i": Int, "j": Int, "k": Int, "value": Any},
+        constraint=atomic_op_constraint,
+        value_func=create_atomic_op_value_func("xor"),
+        dispatch_func=atomic_op_dispatch_func,
+        doc="""Atomically performs a bitwise XOR between ``value`` and ``arr[i,j,k]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k] ^= value``.""",
+        group="Utility",
+        skip_replay=True,
+        is_differentiable=False,
+    )
+    add_builtin(
+        "atomic_xor",
+        hidden=hidden,
+        input_types={"arr": array_type(dtype=Any), "i": Int, "j": Int, "k": Int, "l": Int, "value": Any},
+        constraint=atomic_op_constraint,
+        value_func=create_atomic_op_value_func("xor"),
+        dispatch_func=atomic_op_dispatch_func,
+        doc="""Atomically performs a bitwise XOR between ``value`` and ``arr[i,j,k,l]``, atomically update the array, and return the old value.
+        This function is automatically invoked when using the syntax ``arr[i,j,k,l] ^= value``.""",
+        group="Utility",
+        skip_replay=True,
+        is_differentiable=False,
+    )
+
 
 # used to index into builtin types, i.e.: y = vec3[1]
 def vector_extract_value_func(arg_types: Mapping[str, type], arg_values: Mapping[str, Any]):
@@ -7104,7 +7411,7 @@ add_builtin(
     hidden=True,
     group="Utility",
     skip_replay=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 # implements &quaternion[index]
 add_builtin(
@@ -7115,7 +7422,7 @@ add_builtin(
     hidden=True,
     group="Utility",
     skip_replay=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 # implements &transformation[index]
 add_builtin(
@@ -7126,7 +7433,7 @@ add_builtin(
     hidden=True,
     group="Utility",
     skip_replay=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 # implements &(*vector)[index]
 add_builtin(
@@ -7137,7 +7444,7 @@ add_builtin(
     hidden=True,
     group="Utility",
     skip_replay=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 # implements &(*matrix)[i, j]
 add_builtin(
@@ -7148,7 +7455,7 @@ add_builtin(
     hidden=True,
     group="Utility",
     skip_replay=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 # implements &(*quaternion)[index]
 add_builtin(
@@ -7159,7 +7466,7 @@ add_builtin(
     hidden=True,
     group="Utility",
     skip_replay=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 # implements &(*transformation)[index]
 add_builtin(
@@ -7170,7 +7477,7 @@ add_builtin(
     hidden=True,
     group="Utility",
     skip_replay=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -7366,6 +7673,43 @@ add_builtin(
 )
 
 
+# implements vector[idx] &= scalar
+add_builtin(
+    "bit_and_inplace",
+    input_types={"a": vector(length=Any, dtype=Scalar), "i": Any, "value": Any},
+    value_type=None,
+    dispatch_func=vector_assign_dispatch_func,
+    hidden=True,
+    export=False,
+    group="Utility",
+    is_differentiable=False,
+)
+
+# implements vector[idx] |= scalar
+add_builtin(
+    "bit_or_inplace",
+    input_types={"a": vector(length=Any, dtype=Scalar), "i": Any, "value": Any},
+    value_type=None,
+    dispatch_func=vector_assign_dispatch_func,
+    hidden=True,
+    export=False,
+    group="Utility",
+    is_differentiable=False,
+)
+
+# implements vector[idx] ^= scalar
+add_builtin(
+    "bit_xor_inplace",
+    input_types={"a": vector(length=Any, dtype=Scalar), "i": Any, "value": Any},
+    value_type=None,
+    dispatch_func=vector_assign_dispatch_func,
+    hidden=True,
+    export=False,
+    group="Utility",
+    is_differentiable=False,
+)
+
+
 def matrix_index_row_value_func(arg_types: Mapping[str, type], arg_values: Mapping[str, Any]):
     mat_type = arg_types["a"]
     row_type = mat_type._wp_row_type_
@@ -7381,7 +7725,7 @@ add_builtin(
     hidden=True,
     group="Utility",
     skip_replay=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -7400,7 +7744,7 @@ add_builtin(
     hidden=True,
     group="Utility",
     skip_replay=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -7600,6 +7944,78 @@ add_builtin(
 )
 
 
+# implements matrix[i] &= value
+add_builtin(
+    "bit_and_inplace",
+    input_types={"a": matrix(shape=(Any, Any), dtype=Scalar), "i": Any, "value": Any},
+    value_type=None,
+    hidden=True,
+    export=False,
+    group="Utility",
+    is_differentiable=False,
+)
+
+
+# implements matrix[i,j] &= value
+add_builtin(
+    "bit_and_inplace",
+    input_types={"a": matrix(shape=(Any, Any), dtype=Scalar), "i": Any, "j": Any, "value": Any},
+    value_type=None,
+    hidden=True,
+    export=False,
+    group="Utility",
+    is_differentiable=False,
+)
+
+
+# implements matrix[i] |= value
+add_builtin(
+    "bit_or_inplace",
+    input_types={"a": matrix(shape=(Any, Any), dtype=Scalar), "i": Any, "value": Any},
+    value_type=None,
+    hidden=True,
+    export=False,
+    group="Utility",
+    is_differentiable=False,
+)
+
+
+# implements matrix[i,j] |= value
+add_builtin(
+    "bit_or_inplace",
+    input_types={"a": matrix(shape=(Any, Any), dtype=Scalar), "i": Any, "j": Any, "value": Any},
+    value_type=None,
+    hidden=True,
+    export=False,
+    group="Utility",
+    is_differentiable=False,
+)
+
+
+# implements matrix[i] ^= value
+add_builtin(
+    "bit_xor_inplace",
+    input_types={"a": matrix(shape=(Any, Any), dtype=Scalar), "i": Any, "value": Any},
+    value_type=None,
+    hidden=True,
+    export=False,
+    group="Utility",
+    is_differentiable=False,
+)
+
+
+# implements matrix[i,j] ^= value
+add_builtin(
+    "bit_xor_inplace",
+    input_types={"a": matrix(shape=(Any, Any), dtype=Scalar), "i": Any, "j": Any, "value": Any},
+    value_type=None,
+    hidden=True,
+    export=False,
+    group="Utility",
+    is_differentiable=False,
+)
+
+
 for t in scalar_types + vector_types + (bool,):
     if "vec" in t.__name__ or "mat" in t.__name__:
         continue
@@ -7611,7 +8027,7 @@ for t in scalar_types + vector_types + (bool,):
         doc="Prints an error to stdout if ``a`` and ``b`` are not equal",
         group="Utility",
         hidden=True,
-        missing_grad=True,
+        is_differentiable=False,
     )
 
     add_builtin(
@@ -7622,7 +8038,7 @@ for t in scalar_types + vector_types + (bool,):
         group="Utility",
         hidden=True,
         export=False,
-        missing_grad=True,
+        is_differentiable=False,
     )
 
 
@@ -7641,7 +8057,7 @@ add_builtin(
     doc="Prints an error to stdout if ``a`` and ``b`` are not equal",
     group="Utility",
     hidden=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "expect_neq",
@@ -7652,7 +8068,7 @@ add_builtin(
     group="Utility",
     hidden=True,
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -7663,7 +8079,7 @@ add_builtin(
     doc="Prints an error to stdout if ``a`` and ``b`` are not equal",
     group="Utility",
     hidden=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "expect_neq",
@@ -7674,7 +8090,7 @@ add_builtin(
     group="Utility",
     hidden=True,
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -7765,7 +8181,7 @@ add_builtin(
     value_type=None,
     doc="Prints an error to stdout if ``a`` and ``b`` are not closer than tolerance in magnitude",
     group="Utility",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "expect_near",
@@ -7775,7 +8191,7 @@ add_builtin(
     value_type=None,
     doc="Prints an error to stdout if any element of ``a`` and ``b`` are not closer than tolerance in magnitude",
     group="Utility",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "expect_near",
@@ -7785,7 +8201,7 @@ add_builtin(
     value_type=None,
     doc="Prints an error to stdout if any element of ``a`` and ``b`` are not closer than tolerance in magnitude",
     group="Utility",
-    missing_grad=True,
+    is_differentiable=False,
 )
 add_builtin(
     "expect_near",
@@ -7799,7 +8215,7 @@ add_builtin(
     value_type=None,
     doc="Prints an error to stdout if any element of ``a`` and ``b`` are not closer than tolerance in magnitude",
     group="Utility",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 # ---------------------------------
@@ -7810,7 +8226,7 @@ add_builtin(
     input_types={"arr": array(dtype=Scalar), "value": Scalar},
     value_type=int,
     doc="Search a sorted array ``arr`` for the closest element greater than or equal to ``value``.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -7818,7 +8234,7 @@ add_builtin(
     input_types={"arr": array(dtype=Scalar), "arr_begin": int, "arr_end": int, "value": Scalar},
     value_type=int,
     doc="Search a sorted array ``arr`` in the range [arr_begin, arr_end) for the closest element greater than or equal to ``value``.",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 # ---------------------------------
@@ -7899,31 +8315,153 @@ add_builtin(
     input_types={"a": Int, "b": Int},
     value_func=sametypes_create_value_func(Int),
     group="Operators",
-    missing_grad=True,
+    is_differentiable=False,
+)
+add_builtin(
+    "bit_and",
+    input_types={"a": vector(length=Any, dtype=Int), "b": vector(length=Any, dtype=Int)},
+    constraint=sametypes,
+    value_func=sametypes_create_value_func(vector(length=Any, dtype=Int)),
+    doc="",
+    group="Operators",
+    is_differentiable=False,
 )
+add_builtin(
+    "bit_and",
+    input_types={"a": matrix(shape=(Any, Any), dtype=Int), "b": matrix(shape=(Any, Any), dtype=Int)},
+    constraint=sametypes,
+    value_func=sametypes_create_value_func(matrix(shape=(Any, Any), dtype=Int)),
+    doc="",
+    group="Operators",
+    is_differentiable=False,
+)
+
 add_builtin(
     "bit_or",
     input_types={"a": Int, "b": Int},
     value_func=sametypes_create_value_func(Int),
     group="Operators",
-    missing_grad=True,
+    is_differentiable=False,
+)
+add_builtin(
+    "bit_or",
+    input_types={"a": vector(length=Any, dtype=Int), "b": vector(length=Any, dtype=Int)},
+    constraint=sametypes,
+    value_func=sametypes_create_value_func(vector(length=Any, dtype=Int)),
+    doc="",
+    group="Operators",
+    is_differentiable=False,
+)
+add_builtin(
+    "bit_or",
+    input_types={"a": matrix(shape=(Any, Any), dtype=Int), "b": matrix(shape=(Any, Any), dtype=Int)},
+    constraint=sametypes,
+    value_func=sametypes_create_value_func(matrix(shape=(Any, Any), dtype=Int)),
+    doc="",
+    group="Operators",
+    is_differentiable=False,
+)
+
+add_builtin(
+    "bit_xor",
+    input_types={"a": Int, "b": Int},
+    value_func=sametypes_create_value_func(Int),
+    group="Operators",
+    is_differentiable=False,
+)
+add_builtin(
+    "bit_xor",
+    input_types={"a": vector(length=Any, dtype=Int), "b": vector(length=Any, dtype=Int)},
+    constraint=sametypes,
+    value_func=sametypes_create_value_func(vector(length=Any, dtype=Int)),
+    doc="",
+    group="Operators",
+    is_differentiable=False,
 )
 add_builtin(
     "bit_xor",
+    input_types={"a": matrix(shape=(Any, Any), dtype=Int), "b": matrix(shape=(Any, Any), dtype=Int)},
+    constraint=sametypes,
+    value_func=sametypes_create_value_func(matrix(shape=(Any, Any), dtype=Int)),
+    doc="",
+    group="Operators",
+    is_differentiable=False,
+)
+
+add_builtin(
+    "lshift",
     input_types={"a": Int, "b": Int},
     value_func=sametypes_create_value_func(Int),
     group="Operators",
-    missing_grad=True,
+    is_differentiable=False,
+)
+add_builtin(
+    "lshift",
+    input_types={"a": vector(length=Any, dtype=Int), "b": vector(length=Any, dtype=Int)},
+    constraint=sametypes,
+    value_func=sametypes_create_value_func(vector(length=Any, dtype=Int)),
+    doc="",
+    group="Operators",
+    is_differentiable=False,
+)
+add_builtin(
+    "lshift",
+    input_types={"a": matrix(shape=(Any, Any), dtype=Int), "b": matrix(shape=(Any, Any), dtype=Int)},
+    constraint=sametypes,
+    value_func=sametypes_create_value_func(matrix(shape=(Any, Any), dtype=Int)),
+    doc="",
+    group="Operators",
+    is_differentiable=False,
 )
-add_builtin("lshift", input_types={"a": Int, "b": Int}, value_func=sametypes_create_value_func(Int), group="Operators")
+
 add_builtin(
     "rshift",
     input_types={"a": Int, "b": Int},
     value_func=sametypes_create_value_func(Int),
     group="Operators",
-    missing_grad=True,
+    is_differentiable=False,
+)
+add_builtin(
+    "rshift",
+    input_types={"a": vector(length=Any, dtype=Int), "b": vector(length=Any, dtype=Int)},
+    constraint=sametypes,
+    value_func=sametypes_create_value_func(vector(length=Any, dtype=Int)),
+    doc="",
+    group="Operators",
+    is_differentiable=False,
+)
+add_builtin(
+    "rshift",
+    input_types={"a": matrix(shape=(Any, Any), dtype=Int), "b": matrix(shape=(Any, Any), dtype=Int)},
+    constraint=sametypes,
+    value_func=sametypes_create_value_func(matrix(shape=(Any, Any), dtype=Int)),
+    doc="",
+    group="Operators",
+    is_differentiable=False,
+)
+
+add_builtin(
+    "invert",
+    input_types={"a": Int},
+    value_func=sametypes_create_value_func(Int),
+    group="Operators",
+    is_differentiable=False,
 )
-add_builtin("invert", input_types={"a": Int}, value_func=sametypes_create_value_func(Int), group="Operators")
+add_builtin(
+    "invert",
+    input_types={"a": vector(length=Any, dtype=Int)},
+    value_func=sametypes_create_value_func(vector(length=Any, dtype=Int)),
+    group="Operators",
+    is_differentiable=False,
+)
+add_builtin(
+    "invert",
+    input_types={"a": matrix(shape=(Any, Any), dtype=Int)},
+    value_func=sametypes_create_value_func(matrix(shape=(Any, Any), dtype=Int)),
+    group="Operators",
+    is_differentiable=False,
+)
+
 
 add_builtin(
     "mul", input_types={"a": Scalar, "b": Scalar}, value_func=sametypes_create_value_func(Scalar), group="Operators"
@@ -8123,7 +8661,7 @@ add_builtin(
     value_func=sametypes_create_value_func(vector(length=Any, dtype=Scalar)),
     doc="Modulo operation using truncated division.",
     group="Operators",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -8183,7 +8721,7 @@ add_builtin(
     value_func=sametypes_create_value_func(Scalar),
     doc="",
     group="Operators",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin("pos", input_types={"x": Scalar}, value_func=sametypes_create_value_func(Scalar), group="Operators")
@@ -8232,14 +8770,26 @@ add_builtin(
 )
 
 add_builtin(
-    "unot", input_types={"a": builtins.bool}, value_type=builtins.bool, doc="", group="Operators", missing_grad=True
+    "unot",
+    input_types={"a": builtins.bool},
+    value_type=builtins.bool,
+    doc="",
+    group="Operators",
+    is_differentiable=False,
 )
 for t in int_types:
-    add_builtin("unot", input_types={"a": t}, value_type=builtins.bool, doc="", group="Operators", missing_grad=True)
+    add_builtin(
+        "unot", input_types={"a": t}, value_type=builtins.bool, doc="", group="Operators", is_differentiable=False
+    )
 
 
 add_builtin(
-    "unot", input_types={"a": array(dtype=Any)}, value_type=builtins.bool, doc="", group="Operators", missing_grad=True
+    "unot",
+    input_types={"a": array(dtype=Any)},
+    value_type=builtins.bool,
+    doc="",
+    group="Operators",
+    is_differentiable=False,
 )
 
 
@@ -8312,6 +8862,45 @@ add_builtin(
     export=False,
 )
 
+add_builtin(
+    "bit_and",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "b": tile(dtype=Any, shape=Tuple[int, ...])},
+    value_func=tile_binary_map_value_func,
+    # dispatch_func=tile_map_dispatch_func,
+    # variadic=True,
+    native_func="tile_bit_and",
+    doc="Bitwise AND each element of two tiles together",
+    group="Tile Primitives",
+    export=False,
+    is_differentiable=False,
+)
+
+add_builtin(
+    "bit_or",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "b": tile(dtype=Any, shape=Tuple[int, ...])},
+    value_func=tile_binary_map_value_func,
+    # dispatch_func=tile_map_dispatch_func,
+    # variadic=True,
+    native_func="tile_bit_or",
+    doc="Bitwise OR each element of two tiles together",
+    group="Tile Primitives",
+    export=False,
+    is_differentiable=False,
+)
+
+add_builtin(
+    "bit_xor",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "b": tile(dtype=Any, shape=Tuple[int, ...])},
+    value_func=tile_binary_map_value_func,
+    # dispatch_func=tile_map_dispatch_func,
+    # variadic=True,
+    native_func="tile_bit_xor",
+    doc="Bitwise XOR each element of two tiles together",
+    group="Tile Primitives",
+    export=False,
+    is_differentiable=False,
+)
+
 
 add_builtin(
     "mul",
@@ -8373,6 +8962,45 @@ add_builtin(
 )
 
 
+add_builtin(
+    "bit_and_inplace",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "b": tile(dtype=Any, shape=Tuple[int, ...])},
+    value_type=None,
+    dispatch_func=tile_inplace_dispatch_func,
+    export=False,
+    hidden=True,
+    native_func="tile_bit_and_inplace",
+    group="Operators",
+    is_differentiable=False,
+)
+
+
+add_builtin(
+    "bit_or_inplace",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "b": tile(dtype=Any, shape=Tuple[int, ...])},
+    value_type=None,
+    dispatch_func=tile_inplace_dispatch_func,
+    export=False,
+    hidden=True,
+    native_func="tile_bit_or_inplace",
+    group="Operators",
+    is_differentiable=False,
+)
+
+
+add_builtin(
+    "bit_xor_inplace",
+    input_types={"a": tile(dtype=Any, shape=Tuple[int, ...]), "b": tile(dtype=Any, shape=Tuple[int, ...])},
+    value_type=None,
+    dispatch_func=tile_inplace_dispatch_func,
+    export=False,
+    hidden=True,
+    native_func="tile_bit_xor_inplace",
+    group="Operators",
+    is_differentiable=False,
+)
+
+
 def tile_diag_add_value_func(arg_types, arg_values):
     if arg_types is None:
         return tile(dtype=Any, shape=Tuple[int, int])
@@ -8434,7 +9062,7 @@ add_builtin(
     doc="Add a square matrix and a diagonal matrix 'd' represented as a 1D tile",
     group="Tile Primitives",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -8762,7 +9390,7 @@ add_builtin(
     group="Tile Primitives",
     export=False,
     namespace="",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -8784,7 +9412,7 @@ add_builtin(
     group="Tile Primitives",
     export=False,
     namespace="",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -8909,7 +9537,7 @@ add_builtin(
     group="Tile Primitives",
     export=False,
     namespace="",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -9040,7 +9668,7 @@ add_builtin(
     group="Tile Primitives",
     export=False,
     namespace="",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -9173,7 +9801,7 @@ add_builtin(
     group="Tile Primitives",
     export=False,
     namespace="",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -9306,7 +9934,7 @@ add_builtin(
     group="Tile Primitives",
     export=False,
     namespace="",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -9326,7 +9954,7 @@ add_builtin(
     The return type of the expression must be either a Warp function, a string, or a type that is supported inside Warp kernels and functions
     (excluding Warp arrays since they cannot be created in a Warp kernel at the moment).""",
     group="Code Generation",
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -9351,7 +9979,7 @@ add_builtin(
     doc="Return the number of elements in a vector.",
     group="Utility",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -9361,7 +9989,7 @@ add_builtin(
     doc="Return the number of elements in a quaternion.",
     group="Utility",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -9371,7 +9999,7 @@ add_builtin(
     doc="Return the number of rows in a matrix.",
     group="Utility",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -9381,7 +10009,7 @@ add_builtin(
     doc="Return the number of elements in a transformation.",
     group="Utility",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -9391,7 +10019,7 @@ add_builtin(
     doc="Return the size of the first dimension in an array.",
     group="Utility",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 add_builtin(
@@ -9401,7 +10029,7 @@ add_builtin(
     doc="Return the number of rows in a tile.",
     group="Utility",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -9428,7 +10056,7 @@ add_builtin(
     doc="Construct a tuple from a list of values",
     group="Utility",
     hidden=True,
-    missing_grad=True,
+    is_differentiable=False,
     export=False,
 )
 
@@ -9465,7 +10093,7 @@ add_builtin(
     dispatch_func=tuple_extract_dispatch_func,
     group="Utility",
     hidden=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 
@@ -9476,7 +10104,7 @@ add_builtin(
     doc="Return the number of elements in a tuple.",
     group="Utility",
     export=False,
-    missing_grad=True,
+    is_differentiable=False,
 )
 
 # ---------------------------------
@@ -9495,5 +10123,5 @@ add_builtin(
     export=False,
     group="Utility",
     hidden=True,
-    missing_grad=True,
+    is_differentiable=False,
 )
diff --git a/warp/codegen.py b/warp/codegen.py
index 232aaa31..dee703bd 100644
--- a/warp/codegen.py
+++ b/warp/codegen.py
@@ -53,6 +53,22 @@ class WarpCodegenAttributeError(AttributeError):
         super().__init__(message)
 
 
+def get_node_name_safe(node):
+    """Safely get a string representation of an AST node for error messages.
+
+    This handles different AST node types (Name, Subscript, etc.) without
+    raising AttributeError when accessing attributes that may not exist.
+    """
+    if hasattr(node, "id"):
+        return node.id
+    elif hasattr(node, "value") and hasattr(node, "slice"):
+        # Subscript node like inputs[tid]
+        base_name = get_node_name_safe(node.value)
+        return f"{base_name}[...]"
+    else:
+        return f"<{type(node).__name__}>"
+
+
 class WarpCodegenKeyError(KeyError):
     def __init__(self, message):
         super().__init__(message)
@@ -185,23 +201,39 @@ def eval_annotations(annotations: Mapping[str, Any], obj: Any) -> Mapping[str, A
 
 def get_annotations(obj: Any) -> Mapping[str, Any]:
     """Same as `inspect.get_annotations()` but always returning un-stringized annotations."""
-    # This backports `inspect.get_annotations()` for Python 3.9 and older.
-    # See https://docs.python.org/3/howto/annotations.html#accessing-the-annotations-dict-of-an-object-in-python-3-9-and-older
-    if isinstance(obj, type):
-        annotations = obj.__dict__.get("__annotations__", {})
+    # Python 3.10+: Use the built-in inspect.get_annotations() which handles
+    # PEP 649 (deferred annotation evaluation) in Python 3.14+
+    if hasattr(inspect, "get_annotations"):
+        # eval_str=True ensures stringized annotations from PEP 563 are evaluated
+        return inspect.get_annotations(obj, eval_str=True)
     else:
-        annotations = getattr(obj, "__annotations__", {})
+        # Python 3.9 and older: Manual backport of inspect.get_annotations()
+        # See https://docs.python.org/3/howto/annotations.html#accessing-the-annotations-dict-of-an-object-in-python-3-9-and-older
+        if isinstance(obj, type):
+            annotations = obj.__dict__.get("__annotations__", {})
+        else:
+            annotations = getattr(obj, "__annotations__", {})
 
-    # Evaluating annotations can be done using the `eval_str` parameter with
-    # the official function from the `inspect` module.
-    return eval_annotations(annotations, obj)
+        return eval_annotations(annotations, obj)
 
 
 def get_full_arg_spec(func: Callable) -> inspect.FullArgSpec:
     """Same as `inspect.getfullargspec()` but always returning un-stringized annotations."""
-    # See https://docs.python.org/3/howto/annotations.html#manually-un-stringizing-stringized-annotations
     spec = inspect.getfullargspec(func)
-    return spec._replace(annotations=eval_annotations(spec.annotations, func))
+
+    # Python 3.10+: Use inspect.get_annotations()
+    if hasattr(inspect, "get_annotations"):
+        # Capture closure variables to handle cases like `foo.Data` where `foo` is a closure variable
+        closure_vars = dict(
+            zip(func.__code__.co_freevars, (get_closure_cell_contents(x) for x in (func.__closure__ or ())))
+        )
+        # Filter out None values from empty cells
+        closure_vars = {k: v for k, v in closure_vars.items() if v is not None}
+        return spec._replace(annotations=inspect.get_annotations(func, eval_str=True, locals=closure_vars))
+    else:
+        # Python 3.9 and older: Manually un-stringize annotations
+        # See https://docs.python.org/3/howto/annotations.html#manually-un-stringizing-stringized-annotations
+        return spec._replace(annotations=eval_annotations(spec.annotations, func))
 
 
 def struct_instance_repr_recursive(inst: StructInstance, depth: int, use_repr: bool) -> str:
@@ -230,122 +262,19 @@ def struct_instance_repr_recursive(inst: StructInstance, depth: int, use_repr: b
 
 
 class StructInstance:
-    def __init__(self, cls: Struct, ctype):
-        super().__setattr__("_cls", cls)
-
+    def __init__(self, ctype):
         # maintain a c-types object for the top-level instance the struct
-        if not ctype:
-            super().__setattr__("_ctype", cls.ctype())
-        else:
-            super().__setattr__("_ctype", ctype)
+        super().__setattr__("_ctype", ctype)
 
         # create Python attributes for each of the struct's variables
-        for field, var in cls.vars.items():
-            if isinstance(var.type, warp.codegen.Struct):
-                self.__dict__[field] = var.type.instance_type(ctype=getattr(self._ctype, field))
-            elif isinstance(var.type, warp.types.array):
-                self.__dict__[field] = None
-            else:
-                self.__dict__[field] = var.type()
-
-    def __getattribute__(self, name):
-        cls = super().__getattribute__("_cls")
-        if name == "native_name":
-            return cls.native_name
-
-        var = cls.vars.get(name)
-        if var is not None:
-            if isinstance(var.type, type) and issubclass(var.type, ctypes.Array):
-                # Each field stored in a `StructInstance` is exposed as
-                # a standard Python attribute but also has a `ctypes`
-                # equivalent that is being updated in `__setattr__`.
-                # However, when assigning in place an object such as a vec/mat
-                # (e.g.: `my_struct.my_vec[0] = 1.23`), the `__setattr__` method
-                # from `StructInstance` isn't called, and the synchronization
-                # mechanism has no chance of updating the underlying ctype data.
-                # As a workaround, we catch here all attempts at accessing such
-                # objects and directly return their underlying ctype since
-                # the Python-facing Warp vectors and matrices are implemented
-                # using `ctypes.Array` anyways.
-                return getattr(self._ctype, name)
-
-        return super().__getattribute__(name)
+        for k, cst in type(self)._constructors:
+            self.__dict__[k] = cst(ctype)
 
     def __setattr__(self, name, value):
-        if name not in self._cls.vars:
-            raise RuntimeError(f"Trying to set Warp struct attribute that does not exist {name}")
-
-        var = self._cls.vars[name]
-
-        # update our ctype flat copy
-        if isinstance(var.type, array):
-            if value is None:
-                # create array with null pointer
-                setattr(self._ctype, name, array_t())
-            else:
-                # wp.array
-                assert isinstance(value, array)
-                assert types_equal(value.dtype, var.type.dtype), (
-                    f"assign to struct member variable {name} failed, expected type {type_repr(var.type.dtype)}, got type {type_repr(value.dtype)}"
-                )
-                setattr(self._ctype, name, value.__ctype__())
-
-                # workaround to prevent gradient buffers being garbage collected
-                # since users can do struct.array.requires_grad = False the gradient array
-                # would be collected while the struct ctype still holds a reference to it
-                super().__setattr__("_" + name + "_grad", value.grad)
-
-        elif isinstance(var.type, Struct):
-            # assign structs by-value, otherwise we would have problematic cases transferring ownership
-            # of the underlying ctypes data between shared Python struct instances
-
-            if not isinstance(value, StructInstance):
-                raise RuntimeError(
-                    f"Trying to assign a non-structure value to a struct attribute with type: {self._cls.key}"
-                )
-
-            # destination attribution on self
-            dest = getattr(self, name)
-
-            if dest._cls.key is not value._cls.key:
-                raise RuntimeError(
-                    f"Trying to assign a structure of type {value._cls.key} to an attribute of {self._cls.key}"
-                )
-
-            # update all nested ctype vars by deep copy
-            for n in dest._cls.vars:
-                setattr(dest, n, getattr(value, n))
-
-            # early return to avoid updating our Python StructInstance
-            return
-
-        elif issubclass(var.type, ctypes.Array):
-            # vector/matrix type, e.g. vec3
-            if value is None:
-                setattr(self._ctype, name, var.type())
-            elif type(value) == var.type:
-                setattr(self._ctype, name, value)
-            else:
-                # conversion from list/tuple, ndarray, etc.
-                setattr(self._ctype, name, var.type(value))
-
-        else:
-            # primitive type
-            if value is None:
-                # zero initialize
-                setattr(self._ctype, name, var.type._type_())
-            else:
-                if hasattr(value, "_type_"):
-                    # assigning warp type value (e.g.: wp.float32)
-                    value = value.value
-                # float16 needs conversion to uint16 bits
-                if var.type == warp.float16:
-                    setattr(self._ctype, name, float_to_half_bits(value))
-                else:
-                    setattr(self._ctype, name, value)
-
-        # update Python instance
-        super().__setattr__(name, value)
+        try:
+            self._setters[name](self, value)
+        except KeyError as err:
+            raise RuntimeError(f"Trying to set Warp struct attribute that does not exist {name}") from err
 
     def __ctype__(self):
         return self._ctype
@@ -356,6 +285,22 @@ class StructInstance:
     def __str__(self):
         return struct_instance_repr_recursive(self, 0, use_repr=False)
 
+    def assign(self, value):
+        """Assigns the values of another struct instance to this one."""
+        if not isinstance(value, StructInstance):
+            raise RuntimeError(
+                f"Trying to assign a non-structure value to a struct attribute with type: {self._cls.key}"
+            )
+
+        if self._cls.key is not value._cls.key:
+            raise RuntimeError(
+                f"Trying to assign a structure of type {value._cls.key} to an attribute of {self._cls.key}"
+            )
+
+        # update all nested ctype vars by deep copy
+        for n in self._cls.vars:
+            setattr(self, n, getattr(value, n))
+
     def to(self, device):
         """Copies this struct with all array members moved onto the given device.
 
@@ -372,12 +317,12 @@ class StructInstance:
                 setattr(dst, name, value.to(device))
             elif isinstance(var.type, Struct):
                 # nested struct
-                new_struct = value._cls()
+                new_struct = var.type()
                 setattr(dst, name, new_struct)
                 # The call to `setattr()` just above makes a copy of `new_struct`
                 # so we need to reference that new instance of the struct.
                 new_struct = getattr(dst, name)
-                stack.extend((value, new_struct, k, v) for k, v in value._cls.vars.items())
+                stack.extend((value, new_struct, k, v) for k, v in var.type.vars.items())
             else:
                 setattr(dst, name, value)
 
@@ -417,6 +362,82 @@ class StructInstance:
         return tuple(npvalue)
 
 
+def _make_struct_field_constructor(field: str, var_type: type):
+    if isinstance(var_type, warp.codegen.Struct):
+        return lambda ctype: var_type.instance_type(ctype=getattr(ctype, field))
+    elif isinstance(var_type, warp.types.array):
+        return lambda ctype: None
+    elif issubclass(var_type, ctypes.Array):
+        # for vector/matrices, the Python attribute aliases the ctype one
+        return lambda ctype: getattr(ctype, field)
+    else:
+        return lambda ctype: var_type()
+
+
+def _make_struct_field_setter(cls, field: str, var_type: type):
+    def set_array_value(inst, value):
+        if value is None:
+            # create array with null pointer
+            setattr(inst._ctype, field, array_t())
+        else:
+            # wp.array
+            assert isinstance(value, array)
+            assert types_equal(value.dtype, var_type.dtype), (
+                f"assign to struct member variable {field} failed, expected type {type_repr(var_type.dtype)}, got type {type_repr(value.dtype)}"
+            )
+            setattr(inst._ctype, field, value.__ctype__())
+
+            # workaround to prevent gradient buffers being garbage collected
+            # since users can do struct.array.requires_grad = False the gradient array
+            # would be collected while the struct ctype still holds a reference to it
+            if value.requires_grad:
+                cls.__setattr__(inst, "_" + field + "_grad", value.grad)
+
+        cls.__setattr__(inst, field, value)
+
+    def set_struct_value(inst, value):
+        getattr(inst, field).assign(value)
+
+    def set_vector_value(inst, value):
+        # vector/matrix type, e.g. vec3
+        if value is None:
+            setattr(inst._ctype, field, var_type())
+        elif type(value) is var_type:
+            setattr(inst._ctype, field, value)
+        else:
+            # conversion from list/tuple, ndarray, etc.
+            setattr(inst._ctype, field, var_type(value))
+
+        # no need to update the Python attribute,
+        # it's already aliasing the ctype one
+
+    def set_primitive_value(inst, value):
+        # primitive type
+        if value is None:
+            # zero initialize
+            setattr(inst._ctype, field, var_type._type_())
+        else:
+            if hasattr(value, "_type_"):
+                # assigning warp type value (e.g.: wp.float32)
+                value = value.value
+            # float16 needs conversion to uint16 bits
+            if var_type == warp.float16:
+                setattr(inst._ctype, field, float_to_half_bits(value))
+            else:
+                setattr(inst._ctype, field, value)
+
+        cls.__setattr__(inst, field, value)
+
+    if isinstance(var_type, array):
+        return set_array_value
+    elif isinstance(var_type, Struct):
+        return set_struct_value
+    elif issubclass(var_type, ctypes.Array):
+        return set_vector_value
+    else:
+        return set_primitive_value
+
+
 class Struct:
     hash: bytes
 
@@ -430,8 +451,8 @@ class Struct:
             raise RuntimeError("Warp structs must be defined as base classes")
 
         annotations = get_annotations(self.cls)
-        for label, type in annotations.items():
-            self.vars[label] = Var(label, type)
+        for label, type_ in annotations.items():
+            self.vars[label] = Var(label, type_)
 
         fields = []
         for label, var in self.vars.items():
@@ -513,12 +534,19 @@ class Struct:
 
         # The type annotations are inherited in A(), allowing autocomplete in kernels
         class NewStructInstance(self.cls, StructInstance):
-            def __init__(inst, ctype=None):
-                StructInstance.__init__(inst, self, ctype)
+            cls: ClassVar[type] = self.cls
+            native_name: ClassVar[str] = self.native_name
+
+            _cls: ClassVar[type] = self
+            _constructors: ClassVar[list[tuple[str, Callable]]] = [
+                (field, _make_struct_field_constructor(field, var.type)) for field, var in self.vars.items()
+            ]
+            _setters: ClassVar[dict[str, Callable]] = {
+                field: _make_struct_field_setter(self.cls, field, var.type) for field, var in self.vars.items()
+            }
 
-        # make sure warp.types.get_type_code works with this StructInstance
-        NewStructInstance.cls = self.cls
-        NewStructInstance.native_name = self.native_name
+            def __init__(inst, ctype=None):
+                StructInstance.__init__(inst, ctype or self.ctype())
 
         self.instance_type = NewStructInstance
 
@@ -1562,7 +1590,7 @@ class Adjoint:
         else:
             adj.add_forward(forward_call, replay=replay_call)
 
-        if not func.missing_grad and len(func_args):
+        if func.is_differentiable and len(func_args):
             adj_args = tuple(strip_reference(x) for x in func_args)
             reverse_has_output_args = (
                 func.require_original_output_arg or len(output_list) > 1
@@ -2051,8 +2079,9 @@ class Adjoint:
                 return type_attribute
 
             if isinstance(aggregate, Var):
+                node_name = get_node_name_safe(node.value)
                 raise WarpCodegenAttributeError(
-                    f"Error, `{node.attr}` is not an attribute of '{node.value.id}' ({type_repr(aggregate.type)})"
+                    f"Error, `{node.attr}` is not an attribute of '{node_name}' ({type_repr(aggregate.type)})"
                 ) from e
             raise WarpCodegenAttributeError(f"Error, `{node.attr}` is not an attribute of '{aggregate}'") from e
 
@@ -2521,7 +2550,9 @@ class Adjoint:
         indices = adj.eval_indices(target_type, indices)
 
         if is_array(target_type):
-            if len(indices) == target_type.ndim:
+            if len(indices) == target_type.ndim and all(
+                warp.types.type_is_int(strip_reference(x.type)) for x in indices
+            ):
                 # handles array loads (where each dimension has an index specified)
                 out = adj.add_builtin_call("address", [target, *indices])
 
@@ -2529,6 +2560,21 @@ class Adjoint:
                     target.mark_read()
 
             else:
+                if isinstance(target_type, warp.types.array):
+                    # In order to reduce the number of overloads needed in the C
+                    # implementation to support combinations of int/slice indices,
+                    # we convert all integer indices into slices, and set their
+                    # step to 0 if they are representing an integer index.
+                    new_indices = []
+                    for idx in indices:
+                        if not warp.types.is_slice(strip_reference(idx.type)):
+                            new_idx = adj.add_builtin_call("slice", (idx, idx, 0))
+                            new_indices.append(new_idx)
+                        else:
+                            new_indices.append(idx)
+
+                    indices = new_indices
+
                 # handles array views (fewer indices than dimensions)
                 out = adj.add_builtin_call("view", [target, *indices])
 
@@ -2630,6 +2676,12 @@ class Adjoint:
 
         return adj.emit_indexing(target, indices)
 
+    def emit_Slice(adj, node):
+        start = SLICE_BEGIN if node.lower is None else adj.eval(node.lower)
+        stop = SLICE_END if node.upper is None else adj.eval(node.upper)
+        step = 1 if node.step is None else adj.eval(node.step)
+        return adj.add_builtin_call("slice", (start, stop, step))
+
     def emit_Assign(adj, node):
         if len(node.targets) != 1:
             raise WarpCodegenError("Assigning the same value to multiple variables is not supported")
@@ -2922,6 +2974,24 @@ class Adjoint:
                 elif isinstance(node.op, ast.Sub):
                     adj.add_builtin_call("atomic_sub", [target, *indices, rhs])
 
+                    if warp.config.verify_autograd_array_access:
+                        target.mark_write(kernel_name=kernel_name, filename=filename, lineno=lineno)
+
+                elif isinstance(node.op, ast.BitAnd):
+                    adj.add_builtin_call("atomic_and", [target, *indices, rhs])
+
+                    if warp.config.verify_autograd_array_access:
+                        target.mark_write(kernel_name=kernel_name, filename=filename, lineno=lineno)
+
+                elif isinstance(node.op, ast.BitOr):
+                    adj.add_builtin_call("atomic_or", [target, *indices, rhs])
+
+                    if warp.config.verify_autograd_array_access:
+                        target.mark_write(kernel_name=kernel_name, filename=filename, lineno=lineno)
+
+                elif isinstance(node.op, ast.BitXor):
+                    adj.add_builtin_call("atomic_xor", [target, *indices, rhs])
+
                     if warp.config.verify_autograd_array_access:
                         target.mark_write(kernel_name=kernel_name, filename=filename, lineno=lineno)
                 else:
@@ -2940,6 +3010,12 @@ class Adjoint:
                     adj.add_builtin_call("add_inplace", [target, *indices, rhs])
                 elif isinstance(node.op, ast.Sub):
                     adj.add_builtin_call("sub_inplace", [target, *indices, rhs])
+                elif isinstance(node.op, ast.BitAnd):
+                    adj.add_builtin_call("bit_and_inplace", [target, *indices, rhs])
+                elif isinstance(node.op, ast.BitOr):
+                    adj.add_builtin_call("bit_or_inplace", [target, *indices, rhs])
+                elif isinstance(node.op, ast.BitXor):
+                    adj.add_builtin_call("bit_xor_inplace", [target, *indices, rhs])
                 else:
                     if warp.config.verbose:
                         print(f"Warning: in-place op {node.op} is not differentiable")
@@ -2951,6 +3027,12 @@ class Adjoint:
                     adj.add_builtin_call("tile_add_inplace", [target, *indices, rhs])
                 elif isinstance(node.op, ast.Sub):
                     adj.add_builtin_call("tile_sub_inplace", [target, *indices, rhs])
+                elif isinstance(node.op, ast.BitAnd):
+                    adj.add_builtin_call("tile_bit_and_inplace", [target, *indices, rhs])
+                elif isinstance(node.op, ast.BitOr):
+                    adj.add_builtin_call("tile_bit_or_inplace", [target, *indices, rhs])
+                elif isinstance(node.op, ast.BitXor):
+                    adj.add_builtin_call("tile_bit_xor_inplace", [target, *indices, rhs])
                 else:
                     if warp.config.verbose:
                         print(f"Warning: in-place op {node.op} is not differentiable")
@@ -2968,6 +3050,12 @@ class Adjoint:
                     adj.add_builtin_call("add_inplace", [target, rhs])
                 elif isinstance(node.op, ast.Sub):
                     adj.add_builtin_call("sub_inplace", [target, rhs])
+                elif isinstance(node.op, ast.BitAnd):
+                    adj.add_builtin_call("bit_and_inplace", [target, rhs])
+                elif isinstance(node.op, ast.BitOr):
+                    adj.add_builtin_call("bit_or_inplace", [target, rhs])
+                elif isinstance(node.op, ast.BitXor):
+                    adj.add_builtin_call("bit_xor_inplace", [target, rhs])
                 else:
                     make_new_assign_statement()
                     return
@@ -3010,6 +3098,7 @@ class Adjoint:
         ast.Call: emit_Call,
         ast.Index: emit_Index,  # Deprecated in 3.9
         ast.Subscript: emit_Subscript,
+        ast.Slice: emit_Slice,
         ast.Assign: emit_Assign,
         ast.Return: emit_Return,
         ast.AugAssign: emit_AugAssign,
@@ -3165,7 +3254,7 @@ class Adjoint:
             lines.extend(source_lines[start_line + 1 : end_line])
             # last line (from the start to end_col)
             lines.append(source_lines[end_line][:end_col])
-            return "\n".join(lines).strip()
+            return "".join(lines).strip()
 
     @staticmethod
     def extract_lambda_source(func, only_body=False) -> str | None:
@@ -3183,7 +3272,7 @@ class Adjoint:
             source = source[:-1]
         # extract lambda expression up until a comma, e.g. in the case of
         # "map(lambda a: (a + 2.0, a + 3.0), a, return_kernel=True)"
-        si = max(source.find(")"), source.find(":"))
+        si = max(source.rfind(")"), source.find(":"))
         ci = source.find(",", si)
         if ci != -1:
             source = source[:ci]
diff --git a/warp/config.py b/warp/config.py
index 56f4db57..ac1f2f73 100644
--- a/warp/config.py
+++ b/warp/config.py
@@ -15,7 +15,7 @@
 
 from typing import Optional
 
-version: str = "1.9.1"
+version: str = "1.10.0.dev0"
 """Warp version string"""
 
 verify_fp: bool = False
diff --git a/warp/context.py b/warp/context.py
index 90268a51..43cdfd82 100644
--- a/warp/context.py
+++ b/warp/context.py
@@ -138,7 +138,7 @@ class Function:
         group: str = "",
         hidden: bool = False,
         skip_replay: bool = False,
-        missing_grad: bool = False,
+        is_differentiable: bool = True,
         generic: bool = False,
         native_func: str | None = None,
         defaults: dict[str, Any] | None = None,
@@ -193,7 +193,7 @@ class Function:
         self.skip_replay = (
             skip_replay  # whether operation will be performed during the forward replay in the backward pass
         )
-        self.missing_grad = missing_grad  # whether builtin is missing a corresponding adjoint
+        self.is_differentiable = is_differentiable  # whether a corresponding adjoint exists for this builtin in Warp
         self.generic = generic
         self.mangled_name: str | None = None
 
@@ -1207,8 +1207,13 @@ def overload(kernel, arg_types=Union[None, Dict[str, Any], List[Any]]):
         for node in func_body:
             if isinstance(node, ast.Pass):
                 continue
-            elif isinstance(node, ast.Expr) and isinstance(node.value, (ast.Str, ast.Ellipsis)):
-                continue
+            elif isinstance(node, ast.Expr):
+                # Python 3.8+ uses ast.Constant for strings and Ellipsis
+                # Python 3.14+ removed ast.Str and ast.Ellipsis (deprecated since 3.8)
+                if isinstance(node.value, ast.Constant) and (
+                    isinstance(node.value.value, str) or node.value.value is ...
+                ):
+                    continue
             raise RuntimeError(
                 "Illegal statement in kernel overload definition.  Only pass, ellipsis (...), comments, or docstrings are allowed"
             )
@@ -1271,7 +1276,7 @@ def add_builtin(
     group: str = "Other",
     hidden: bool = False,
     skip_replay: bool = False,
-    missing_grad: bool = False,
+    is_differentiable: bool = True,
     native_func: str | None = None,
     defaults: dict[str, Any] | None = None,
     require_original_output_arg: bool = False,
@@ -1319,7 +1324,7 @@ def add_builtin(
         hidden: Whether to add that function into the documentation.
         skip_replay: Whether operation will be performed during
             the forward replay in the backward pass.
-        missing_grad: Whether the function is missing a corresponding adjoint.
+        is_differentiable: Whether a corresponding adjoint exists for this function in Warp.
         native_func: Name of the underlying C++ function.
         defaults: Default values for the parameters defined in `input_types`.
         require_original_output_arg: Used during the codegen stage to
@@ -1448,7 +1453,7 @@ def add_builtin(
                     group=group,
                     hidden=True,
                     skip_replay=skip_replay,
-                    missing_grad=missing_grad,
+                    is_differentiable=is_differentiable,
                     defaults=defaults,
                     require_original_output_arg=require_original_output_arg,
                 )
@@ -1470,7 +1475,7 @@ def add_builtin(
         group=group,
         hidden=hidden,
         skip_replay=skip_replay,
-        missing_grad=missing_grad,
+        is_differentiable=is_differentiable,
         generic=generic,
         native_func=native_func,
         defaults=defaults,
@@ -2919,12 +2924,14 @@ class Stream:
             self._cached_event = Event(self.device)
         return self._cached_event
 
-    def record_event(self, event: Event | None = None) -> Event:
+    def record_event(self, event: Event | None = None, external: bool = False) -> Event:
         """Record an event onto the stream.
 
         Args:
             event: A warp.Event instance to be recorded onto the stream. If not
-              provided, an :class:`~warp.Event` on the same device will be created.
+                provided, an :class:`~warp.Event` on the same device will be created.
+            external: Whether this is an external event during graph capture. This
+                argument has no effect outside of graph capture.
 
         Raises:
             RuntimeError: The provided :class:`~warp.Event` is from a different device than
@@ -2937,18 +2944,23 @@ class Stream:
                 f"Event from device {event.device} cannot be recorded on stream from device {self.device}"
             )
 
-        runtime.core.wp_cuda_event_record(event.cuda_event, self.cuda_stream, event.enable_timing)
+        runtime.core.wp_cuda_event_record(event.cuda_event, self.cuda_stream, external or event.enable_timing)
 
         return event
 
-    def wait_event(self, event: Event):
+    def wait_event(self, event: Event, external: bool = False):
         """Makes all future work in this stream wait until `event` has completed.
 
         This function does not block the host thread.
+
+        Args:
+            event: :class:`Event` instance to wait for.
+            external: Whether this is an external event during graph capture. This
+                argument has no effect outside of graph capture.
         """
-        runtime.core.wp_cuda_stream_wait_event(self.cuda_stream, event.cuda_event)
+        runtime.core.wp_cuda_stream_wait_event(self.cuda_stream, event.cuda_event, external)
 
-    def wait_stream(self, other_stream: Stream, event: Event | None = None):
+    def wait_stream(self, other_stream: Stream, event: Event | None = None, external: bool = False):
         """Records an event on `other_stream` and makes this stream wait on it.
 
         All work added to this stream after this function has been called will
@@ -2959,17 +2971,19 @@ class Stream:
 
         Args:
             other_stream: The stream on which the calling stream will wait for
-              previously issued commands to complete before executing subsequent
-              commands.
+                previously issued commands to complete before executing subsequent
+                commands.
             event: An optional :class:`Event` instance that will be used to
-              record an event onto ``other_stream``. If ``None``, an internally
-              managed :class:`Event` instance will be used.
+                record an event onto ``other_stream``. If ``None``, an internally
+                managed :class:`Event` instance will be used.
+            external: Whether this is an external event during graph capture. This
+                argument has no effect outside of graph capture.
         """
 
         if event is None:
             event = other_stream.cached_event
 
-        runtime.core.wp_cuda_stream_wait_stream(self.cuda_stream, other_stream.cuda_stream, event.cuda_event)
+        runtime.core.wp_cuda_stream_wait_stream(self.cuda_stream, other_stream.cuda_stream, event.cuda_event, external)
 
     @property
     def is_complete(self) -> bool:
@@ -3093,7 +3107,7 @@ class Device:
             pci_domain_id = runtime.core.wp_cuda_device_get_pci_domain_id(ordinal)
             pci_bus_id = runtime.core.wp_cuda_device_get_pci_bus_id(ordinal)
             pci_device_id = runtime.core.wp_cuda_device_get_pci_device_id(ordinal)
-            # This is (mis)named to correspond to the naming of cudaDeviceGetPCIBusId
+            # Named to match the CUDA API function cudaDeviceGetPCIBusId
             self.pci_bus_id = f"{pci_domain_id:08X}:{pci_bus_id:02X}:{pci_device_id:02X}"
 
             self.default_allocator = CudaDefaultAllocator(self)
@@ -3242,29 +3256,51 @@ class Device:
     def total_memory(self) -> int:
         """The total amount of device memory available in bytes.
 
-        This function is currently only implemented for CUDA devices. 0 will be returned if called on a CPU device.
+        Querying memory information for the CPU device requires the `psutil` package to be installed
+        and will return 0 otherwise.
         """
         if self.is_cuda:
             total_mem = ctypes.c_size_t()
             self.runtime.core.wp_cuda_device_get_memory_info(self.ordinal, None, ctypes.byref(total_mem))
             return total_mem.value
         else:
-            # TODO: cpu
-            return 0
+            try:
+                import psutil
+
+                return psutil.virtual_memory().total
+            except ModuleNotFoundError:
+                warp.utils.warn(
+                    "Please install the 'psutil' package to query CPU memory information.",
+                    UserWarning,
+                    stacklevel=2,
+                    once=True,
+                )
+                return 0
 
     @property
     def free_memory(self) -> int:
         """The amount of memory on the device that is free according to the OS in bytes.
 
-        This function is currently only implemented for CUDA devices. 0 will be returned if called on a CPU device.
+        Querying memory information for the CPU device requires the `psutil` package to be installed
+        and will return 0 otherwise.
         """
         if self.is_cuda:
             free_mem = ctypes.c_size_t()
             self.runtime.core.wp_cuda_device_get_memory_info(self.ordinal, ctypes.byref(free_mem), None)
             return free_mem.value
         else:
-            # TODO: cpu
-            return 0
+            try:
+                import psutil
+
+                return psutil.virtual_memory().free
+            except ModuleNotFoundError:
+                warp.utils.warn(
+                    "Please install the 'psutil' package to query CPU memory information.",
+                    UserWarning,
+                    stacklevel=2,
+                    once=True,
+                )
+                return 0
 
     def __str__(self):
         return self.alias
@@ -3721,7 +3757,9 @@ class Runtime:
             self.core.wp_bvh_destroy_device.argtypes = [ctypes.c_uint64]
 
             self.core.wp_bvh_refit_host.argtypes = [ctypes.c_uint64]
+            self.core.wp_bvh_rebuild_host.argtypes = [ctypes.c_uint64, ctypes.c_int]
             self.core.wp_bvh_refit_device.argtypes = [ctypes.c_uint64]
+            self.core.wp_bvh_rebuild_device.argtypes = [ctypes.c_uint64]
 
             self.core.wp_mesh_create_host.restype = ctypes.c_uint64
             self.core.wp_mesh_create_host.argtypes = [
@@ -4027,9 +4065,14 @@ class Runtime:
             self.core.wp_cuda_stream_unregister.restype = None
             self.core.wp_cuda_stream_synchronize.argtypes = [ctypes.c_void_p]
             self.core.wp_cuda_stream_synchronize.restype = None
-            self.core.wp_cuda_stream_wait_event.argtypes = [ctypes.c_void_p, ctypes.c_void_p]
+            self.core.wp_cuda_stream_wait_event.argtypes = [ctypes.c_void_p, ctypes.c_void_p, ctypes.c_bool]
             self.core.wp_cuda_stream_wait_event.restype = None
-            self.core.wp_cuda_stream_wait_stream.argtypes = [ctypes.c_void_p, ctypes.c_void_p, ctypes.c_void_p]
+            self.core.wp_cuda_stream_wait_stream.argtypes = [
+                ctypes.c_void_p,
+                ctypes.c_void_p,
+                ctypes.c_void_p,
+                ctypes.c_bool,
+            ]
             self.core.wp_cuda_stream_wait_stream.restype = None
             self.core.wp_cuda_stream_is_capturing.argtypes = [ctypes.c_void_p]
             self.core.wp_cuda_stream_is_capturing.restype = ctypes.c_int
@@ -5167,28 +5210,32 @@ def set_stream(stream: Stream, device: Devicelike = None, sync: bool = False) ->
     get_device(device).set_stream(stream, sync=sync)
 
 
-def record_event(event: Event | None = None):
+def record_event(event: Event | None = None, external: bool = False):
     """Convenience function for calling :meth:`Stream.record_event` on the current stream.
 
     Args:
         event: :class:`Event` instance to record. If ``None``, a new :class:`Event`
-          instance will be created.
+            instance will be created.
+        external: Whether this is an external event during graph capture. This
+            argument has no effect outside of graph capture.
 
     Returns:
         The recorded event.
     """
 
-    return get_stream().record_event(event)
+    return get_stream().record_event(event, external=external)
 
 
-def wait_event(event: Event):
+def wait_event(event: Event, external: bool = False):
     """Convenience function for calling :meth:`Stream.wait_event` on the current stream.
 
     Args:
         event: :class:`Event` instance to wait for.
+        external: Whether this is an external event during graph capture. This
+            argument has no effect outside of graph capture.
     """
 
-    get_stream().wait_event(event)
+    get_stream().wait_event(event, external=external)
 
 
 def get_event_elapsed_time(start_event: Event, end_event: Event, synchronize: bool = True):
@@ -5216,19 +5263,21 @@ def get_event_elapsed_time(start_event: Event, end_event: Event, synchronize: bo
     return runtime.core.wp_cuda_event_elapsed_time(start_event.cuda_event, end_event.cuda_event)
 
 
-def wait_stream(other_stream: Stream, event: Event | None = None):
+def wait_stream(other_stream: Stream, event: Event | None = None, external: bool = False):
     """Convenience function for calling :meth:`Stream.wait_stream` on the current stream.
 
     Args:
         other_stream: The stream on which the calling stream will wait for
-          previously issued commands to complete before executing subsequent
-          commands.
+            previously issued commands to complete before executing subsequent
+            commands.
         event: An optional :class:`Event` instance that will be used to
-          record an event onto ``other_stream``. If ``None``, an internally
-          managed :class:`Event` instance will be used.
+            record an event onto ``other_stream``. If ``None``, an internally
+            managed :class:`Event` instance will be used.
+        external: Whether this is an external event during graph capture. This
+            argument has no effect outside of graph capture.
     """
 
-    get_stream().wait_stream(other_stream, event=event)
+    get_stream().wait_stream(other_stream, event=event, external=external)
 
 
 class RegisteredGLBuffer:
@@ -6536,10 +6585,12 @@ def load_module(
     """Force a user-defined module to be compiled and loaded
 
     Args:
-        module: The module to load.  If None, load the current module.
-        device: The device to load the modules on.  If None, load on all devices.
-        recursive: Whether to load submodules.  E.g., if the given module is `warp.sim`, this will also load `warp.sim.model`, `warp.sim.articulation`, etc.
-        block_dim: The number of threads per block (always 1 for "cpu" devices).
+        module: The module to load. If None, load the current module.
+        device: The device to load the modules on. If None, load on all devices.
+        recursive: Whether to load submodules. E.g., if the given module is
+          ``warp.render``, this will also load ``warp.render.utils`` and
+          ``warp.render.opengl``.
+        block_dim: The number of threads per block (always 1 for ``"cpu"`` devices).
 
     Note: A module must be imported before it can be loaded by this function.
     """
@@ -7658,7 +7709,7 @@ def print_function(f, file, is_exported, noentry=False):  # pragma: no cover
     if is_exported:
         print("       * Python", file=file)
 
-    if not f.missing_grad:
+    if f.is_differentiable:
         print("       * Differentiable", file=file)
 
     print("", file=file)
diff --git a/warp/examples/assets/cartpole.urdf b/warp/examples/assets/cartpole.urdf
deleted file mode 100644
index 6bf35e72..00000000
--- a/warp/examples/assets/cartpole.urdf
+++ /dev/null
@@ -1,110 +0,0 @@
-<?xml version="1.0"?>
-<robot name="cartpole">
-
-  <link name="slider">
-    <visual>
-      <geometry>
-        <box size="0.03 8 0.03"/>
-      </geometry>
-      <material name="slider_mat">
-        <color rgba="0.9 0.6 0.2 1"/>
-      </material>
-    </visual>
-    <collision>
-      <geometry>
-        <box size="0.03 8 0.03"/>
-      </geometry>
-    </collision>
-  </link>
-
-  <joint name="slider_to_cart" type="prismatic">
-    <axis xyz="0 1 0"/>
-    <origin xyz="0 0 0"/>
-    <parent link="slider"/>
-    <child link="cart"/>
-    <limit effort="1000.0" lower="-4" upper="4" velocity="100"/>
-  </joint>
-  
-  <link name="cart">
-    <visual>
-      <geometry>
-        <box size="0.2 0.25 0.2"/>
-      </geometry>
-      <material name="cart_mat">
-        <color rgba="0.3 0.5 0.7 1"/>
-      </material>
-    </visual>
-    <collision>
-      <geometry>
-          <box size="0.2 0.25 0.2"/>
-      </geometry>
-    </collision>
-    <inertial>
-      <mass value="1"/>
-      <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.1" iyz="0.0" izz="0.1"/>
-    </inertial>
-  </link>
-
-  <joint name="cart_to_pole1" type="continuous">
-    <axis xyz="1 0 0"/>
-    <origin xyz="0.12 0 0"/>
-    <parent link="cart"/>
-    <child link="pole1"/>
-    <limit effort="1000.0" velocity="8"/>
-  </joint>
-  
-  <link name="pole1">
-    <visual>
-      <geometry>
-        <box size="0.04 0.06 1.0"/>	
-      </geometry>
-      <origin xyz="0 0 0.47"/>
-      <material name="pole_mat">
-        <color rgba="0.1 0.1 0.3 1"/>
-      </material>
-    </visual>
-    <collision>
-      <geometry>
-        <box size="0.04 0.06 1.0"/>	
-      </geometry>
-      <origin xyz="0 0 0.47"/>
-    </collision>
-    <inertial>
-      <origin xyz="0 0 0.47"/>
-      <mass value="0.25"/>
-      <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.1" iyz="0.0" izz="0.1"/>
-    </inertial>
-  </link>
-
-  <link name="pole2">
-    <visual>
-      <geometry>
-        <box size="0.04 0.06 1.0"/> 
-      </geometry>
-      <origin xyz="0 0 0.47"/>
-      <material name="pole_mat">
-        <color rgba="0.1 0.1 0.3 1"/>
-      </material>
-    </visual>
-    <collision>
-      <geometry>
-        <box size="0.04 0.06 1.0"/> 
-      </geometry>
-      <origin xyz="0 0 0.47"/>
-    </collision>
-    <inertial>
-      <origin xyz="0 0 0.47"/>
-      <mass value="0.25"/>
-      <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.1" iyz="0.0" izz="0.1"/>
-    </inertial>
-  </link>
-
-  <joint name="pole1_to_pole2" type="continuous">
-    <axis xyz="1 0 0"/>
-    <origin xyz="0.0 0 1.0"/>
-    <parent link="pole1"/>
-    <child link="pole2"/>
-    <limit effort="1000.0" velocity="8"/>
-  </joint>
-
-</robot>
diff --git a/warp/examples/assets/crazyflie.usd b/warp/examples/assets/crazyflie.usd
deleted file mode 100644
index f530f71e..00000000
--- a/warp/examples/assets/crazyflie.usd
+++ /dev/null
@@ -1,3 +0,0 @@
-version https://git-lfs.github.com/spec/v1
-oid sha256:c8c534355087b870df80462c03084646b9597b6bd0de0cc885c383ac5e2b9b64
-size 205332
diff --git a/warp/examples/assets/nv_ant.xml b/warp/examples/assets/nv_ant.xml
deleted file mode 100644
index 222cb2d2..00000000
--- a/warp/examples/assets/nv_ant.xml
+++ /dev/null
@@ -1,92 +0,0 @@
-<mujoco model="ant">
-  <custom>
-    <numeric data="0.0 0.0 0.55 1.0 0.0 0.0 0.0 0.0 1.0 0.0 -1.0 0.0 -1.0 0.0 1.0" name="init_qpos"/>
-  </custom>
-
-  <default>
-    <joint armature="0.01" damping="0.1" limited="true"/>
-    <geom condim="3" density="5.0" friction="1.5 0.1 0.1" margin="0.01" rgba="0.97 0.38 0.06 1"/>
-  </default>
-
-  <compiler inertiafromgeom="true" angle="degree"/>
-
-  <option timestep="0.016" iterations="50" tolerance="1e-10" solver="Newton" jacobian="dense" cone="pyramidal"/>
-
-  <size nconmax="50" njmax="200" nstack="10000"/>
-  <visual>
-      <map force="0.1" zfar="30"/>
-      <rgba haze="0.15 0.25 0.35 1"/>
-      <quality shadowsize="2048"/>
-      <global offwidth="800" offheight="800"/>
-  </visual>
-
-  <asset>
-      <texture type="skybox" builtin="gradient" rgb1="0.3 0.5 0.7" rgb2="0 0 0" width="512" height="512"/> 
-      <texture name="texplane" type="2d" builtin="checker" rgb1=".2 .3 .4" rgb2=".1 0.15 0.2" width="512" height="512" mark="cross" markrgb=".8 .8 .8"/>
-      <texture name="texgeom" type="cube" builtin="flat" mark="cross" width="127" height="1278" 
-          rgb1="0.8 0.6 0.4" rgb2="0.8 0.6 0.4" markrgb="1 1 1" random="0.01"/>  
-
-      <material name="matplane" reflectance="0.3" texture="texplane" texrepeat="1 1" texuniform="true"/>
-      <material name="matgeom" texture="texgeom" texuniform="true" rgba="0.8 0.6 .4 1"/>
-  </asset>
-
-  <worldbody>
-    <geom name="floor" pos="0 0 0" size="0 0 .25" type="plane" material="matplane" condim="3"/>
-
-    <light directional="false" diffuse=".2 .2 .2" specular="0 0 0" pos="0 0 5" dir="0 0 -1" castshadow="false"/>
-    <light mode="targetbodycom" target="torso" directional="false" diffuse=".8 .8 .8" specular="0.3 0.3 0.3" pos="0 0 4.0" dir="0 0 -1"/>
-
-    <body name="torso" pos="0 0 0.75">
-      <geom name="torso_geom" pos="0 0 0" size="0.25" type="sphere"/>
-      <geom fromto="0.0 0.0 0.0 0.2 0.2 0.0" name="aux_1_geom" size="0.08" type="capsule" rgba=".999 .2 .1 1"/>
-      <geom fromto="0.0 0.0 0.0 -0.2 0.2 0.0" name="aux_2_geom" size="0.08" type="capsule"/>
-      <geom fromto="0.0 0.0 0.0 -0.2 -0.2 0.0" name="aux_3_geom" size="0.08" type="capsule"/>
-      <geom fromto="0.0 0.0 0.0 0.2 -0.2 0.0" name="aux_4_geom" size="0.08" type="capsule" rgba=".999 .2 .02 1"/>
-
-      <joint armature="0" damping="0" limited="false" margin="0.01" name="root" pos="0 0 0" type="free"/>
-      <body name="front_left_leg" pos="0.2 0.2 0">
-        <joint axis="0 0 1" name="hip_1" pos="0.0 0.0 0.0" range="-40 40" type="hinge"/>
-        <geom fromto="0.0 0.0 0.0 0.2 0.2 0.0" name="left_leg_geom" size="0.08" type="capsule" rgba=".999 .2 .1 1"/>
-        <body pos="0.2 0.2 0" name="front_left_foot">
-          <joint axis="-1 1 0" name="ankle_1" pos="0.0 0.0 0.0" range="30 100" type="hinge"/>
-          <geom fromto="0.0 0.0 0.0 0.4 0.4 0.0" name="left_ankle_geom" size="0.08" type="capsule" rgba=".999 .2 .1 1"/>
-        </body>
-      </body>
-      <body name="front_right_leg" pos="-0.2 0.2 0">
-        <joint axis="0 0 1" name="hip_2" pos="0.0 0.0 0.0" range="-40 40" type="hinge"/>
-        <geom fromto="0.0 0.0 0.0 -0.2 0.2 0.0" name="right_leg_geom" size="0.08" type="capsule"/>
-        <body pos="-0.2 0.2 0" name="front_right_foot">
-          <joint axis="1 1 0" name="ankle_2" pos="0.0 0.0 0.0" range="-100 -30" type="hinge"/>
-          <geom fromto="0.0 0.0 0.0 -0.4 0.4 0.0" name="right_ankle_geom" size="0.08" type="capsule"/>
-        </body>
-      </body>
-      <body name="left_back_leg" pos="-0.2 -0.2 0">
-        <joint axis="0 0 1" name="hip_3" pos="0.0 0.0 0.0" range="-40 40" type="hinge"/>
-        <geom fromto="0.0 0.0 0.0 -0.2 -0.2 0.0" name="back_leg_geom" size="0.08" type="capsule"/>
-        <body pos="-0.2 -0.2 0" name="left_back_foot">
-          <joint axis="-1 1 0" name="ankle_3" pos="0.0 0.0 0.0" range="-100 -30" type="hinge"/>
-          <geom fromto="0.0 0.0 0.0 -0.4 -0.4 0.0" name="third_ankle_geom" size="0.08" type="capsule"/>
-        </body>
-      </body>
-      <body name="right_back_leg" pos="0.2 -0.2 0">
-        <joint axis="0 0 1" name="hip_4" pos="0.0 0.0 0.0" range="-40 40" type="hinge"/>
-        <geom fromto="0.0 0.0 0.0 0.2 -0.2 0.0" name="rightback_leg_geom" size="0.08" type="capsule" rgba=".999 .2 .1 1"/>
-        <body pos="0.2 -0.2 0" name="right_back_foot">
-          <joint axis="1 1 0" name="ankle_4" pos="0.0 0.0 0.0" range="30 100" type="hinge"/>
-          <geom fromto="0.0 0.0 0.0 0.4 -0.4 0.0" name="fourth_ankle_geom" size="0.08" type="capsule" rgba=".999 .2 .1 1"/>
-        </body>
-      </body>
-    </body>
-  </worldbody>
-
-  <actuator>
-    <motor ctrllimited="true" ctrlrange="-1.0 1.0" joint="hip_4" gear="15"/>
-    <motor ctrllimited="true" ctrlrange="-1.0 1.0" joint="ankle_4" gear="15"/>
-    <motor ctrllimited="true" ctrlrange="-1.0 1.0" joint="hip_1" gear="15"/>
-    <motor ctrllimited="true" ctrlrange="-1.0 1.0" joint="ankle_1" gear="15"/>
-    <motor ctrllimited="true" ctrlrange="-1.0 1.0" joint="hip_2" gear="15"/>
-    <motor ctrllimited="true" ctrlrange="-1.0 1.0" joint="ankle_2" gear="15"/>
-    <motor ctrllimited="true" ctrlrange="-1.0 1.0" joint="hip_3" gear="15"/>
-    <motor ctrllimited="true" ctrlrange="-1.0 1.0" joint="ankle_3" gear="15"/>
-  </actuator>
-</mujoco>
diff --git a/warp/examples/assets/nv_humanoid.xml b/warp/examples/assets/nv_humanoid.xml
deleted file mode 100644
index aff98983..00000000
--- a/warp/examples/assets/nv_humanoid.xml
+++ /dev/null
@@ -1,183 +0,0 @@
-<mujoco model="humanoid">
-
-  <statistic extent="2" center="0 0 1"/>
-
-  <option timestep="0.00555"/>
-
-  <default>
-    <motor ctrlrange="-1 1" ctrllimited="true"/>
-    <default class="body">
-      <geom  type="capsule" condim="1" friction="1.0 0.05 0.05" solimp=".9 .99 .003" solref=".015 1" material="self"/>
-      <joint limited="true" type="hinge" damping="0.1" stiffness="5" armature=".007" solimplimit="0 .99 .01"/>
-      <site size=".04" group="3"/>
-      <default class="force-torque">
-        <site type="box" size=".01 .01 .02" rgba="1 0 0 1" />
-      </default>
-      <default class="touch">
-        <site type="capsule" rgba="0 0 1 .3"/>
-      </default>
-    </default>
-  </default>
-
-  <worldbody>
-    <geom name="floor" type="plane" conaffinity="1" size="100 100 .2" material="grid"/>
-    <body name="torso" pos="0 0 0" childclass="body">
-      <light name="top" pos="0 0 2" mode="trackcom"/>
-      <camera name="back" pos="-3 0 1" xyaxes="0 -1 0 1 0 2" mode="trackcom"/>
-      <camera name="side" pos="0 -3 1" xyaxes="1 0 0 0 1 2" mode="trackcom"/>
-      <joint armature="0" damping="0" limited="false" margin="0.01" name="root" pos="0 0 0" type="free"/>
-      <site name="root" class="force-torque"/>
-      <geom name="torso" type="capsule" fromto="0 -.07 0 0 .07 0" size=".07"/>
-      <geom name="upper_waist" type="capsule" fromto="-.01 -.06 -.12 -.01 .06 -.12" size=".06"/>
-      <site name="torso" class="touch" type="box" pos="0 0 -.05" size=".075 .14 .13"/>
-      <geom name="head" type="sphere" size=".09" pos="0 0 .19"/>
-      <body name="lower_waist" pos="-.01 0 -.260" quat="1.000 0 -.002 0">
-        <geom name="lower_waist" type="capsule" fromto="0 -.06 0 0 .06 0" size=".06"/>
-        <site name="lower_waist" class="touch" size=".061 .06" zaxis="0 1 0"/>
-        <joint limited="true" name="abdomen_z" pos="0 0 .065" axis="0 0 1" range="-45 45" damping="5" stiffness="20" armature=".02"/>
-        <joint limited="true" name="abdomen_y" pos="0 0 .065" axis="0 1 0" range="-75 30" damping="5" stiffness="20" armature=".01"/>
-        <body name="pelvis" pos="0 0 -.165" quat="1.000 0 -.002 0">
-          <joint limited="true" name="abdomen_x" pos="0 0 .1" axis="1 0 0" range="-35 35" damping="5" stiffness="10" armature=".01"/>
-          <geom name="butt" type="capsule" fromto="-.02 -.07 0 -.02 .07 0" size=".09"/>
-          <site name="butt" class="touch" size=".091 .07" pos="-.02 0 0" zaxis="0 1 0"/>
-          <body name="right_thigh" pos="0 -.1 -.04">
-            <site name="right_hip" class="force-torque"/>
-            <joint limited="true" name="right_hip_x" axis="1 0 0" range="-25 5" damping="5" stiffness="10" armature=".01"/>
-            <joint limited="true" name="right_hip_z" axis="0 0 1" range="-60 35" damping="5" stiffness="10" armature=".01"/>
-            <joint limited="true" name="right_hip_y" axis="0 1 0" range="-80 20" damping="5" stiffness="20" armature=".01"/>
-            <geom name="right_thigh" type="capsule" fromto="0 0 0 0 .01 -.34" size=".06"/>
-            <site name="right_thigh" class="touch" pos="0 .005 -.17" size=".061 .17" zaxis="0 -1 34"/>
-            <body name="right_shin" pos="0 .01 -.403">
-              <site name="right_knee" class="force-torque" pos="0 0 .02"/>
-              <joint limited="true" name="right_knee" pos="0 0 .02" axis="0 -1 0" range="-160 2"/>
-              <geom name="right_shin" type="capsule" fromto="0 0 0 0 0 -.3"  size=".049"/>
-              <site name="right_shin" class="touch" pos="0 0 -.15" size=".05 .15"/>
-              <body name="right_foot" pos="0 0 -.39">
-                <site name="right_ankle" class="force-torque"/>
-                <joint limited="true" name="right_ankle_y" pos="0 0 .08" axis="0 1 0" range="-50 50" damping="1.0" stiffness="2" armature=".006"/>
-                <joint limited="true" name="right_ankle_x" pos="0 0 .08" axis="1 0 .5" range="-50 50" damping="1.0" stiffness="2" armature=".006"/>
-                <geom name="right_right_foot" type="capsule" fromto="-.07 -.02 0 .14 -.04 0" size=".027"/>
-                <geom name="left_right_foot" type="capsule" fromto="-.07 0 0 .14  .02 0" size=".027"/>
-                <site name="right_right_foot" class="touch" pos=".035 -.03 0" size=".03 .11" zaxis="21 -2 0"/>
-                <site name="left_right_foot" class="touch" pos=".035 .01 0" size=".03 .11" zaxis="21 2 0"/>
-              </body>
-            </body>
-          </body>
-          <body name="left_thigh" pos="0 .1 -.04">
-            <site name="left_hip" class="force-torque"/>
-            <joint limited="true" name="left_hip_x" axis="-1 0 0" range="-25 5" damping="5" stiffness="10" armature=".01"/>
-            <joint limited="true" name="left_hip_z" axis="0 0 -1" range="-60 35" damping="5" stiffness="10" armature=".01"/>
-            <joint limited="true" name="left_hip_y" axis="0 1 0" range="-80 20" damping="5" stiffness="20" armature=".01"/>
-            <geom name="left_thigh" type="capsule" fromto="0 0 0 0 -.01 -.34" size=".06"/>
-            <site name="left_thigh" class="touch" pos="0 -.005 -.17" size=".061 .17" zaxis="0 1 34"/>
-            <body name="left_shin" pos="0 -.01 -.403">
-              <site name="left_knee" class="force-torque" pos="0 0 .02"/>
-              <joint limited="true" name="left_knee" pos="0 0 .02" axis="0 -1 0" range="-160 2"/>
-              <geom name="left_shin" type="capsule" fromto="0 0 0 0 0 -.3"  size=".049"/>
-              <site name="left_shin" class="touch"  pos="0 0 -.15" size=".05 .15"/>
-              <body name="left_foot" pos="0 0 -.39">
-                <site name="left_ankle" class="force-torque"/>
-                <joint limited="true" name="left_ankle_y" pos="0 0 .08" axis="0 1 0" range="-50 50" damping="1.0" stiffness="2" armature=".006"/>
-                <joint limited="true" name="left_ankle_x" pos="0 0 .08" axis="1 0 .5" range="-50 50" damping="1.0" stiffness="2" armature=".006"/>
-                <geom name="left_left_foot" type="capsule" fromto="-.07 .02 0 .14 .04 0" size=".027"/>
-                <geom name="right_left_foot" type="capsule" fromto="-.07 0 0 .14  -.02 0" size=".027"/>
-                <site name="right_left_foot" class="touch" pos=".035 -.01 0" size=".03 .11" zaxis="21 -2 0"/>
-                <site name="left_left_foot" class="touch" pos=".035 .03 0" size=".03 .11" zaxis="21 2 0"/>
-              </body>
-            </body>
-          </body>
-        </body>
-      </body>
-      <body name="right_upper_arm" pos="0 -.17 .06">
-        <joint limited="true" name="right_shoulder1" axis="2 1 1"  range="-60 60" damping="5" stiffness="10" armature=".01"/>
-        <joint limited="true" name="right_shoulder2" axis="0 -1 1" range="-60 60" damping="5" stiffness="10" armature=".01"/>
-        <geom name="right_upper_arm" type="capsule" fromto="0 0 0 .16 -.16 -.16" size=".04 .16"/>
-        <site name="right_upper_arm" class="touch" pos=".08 -.08 -.08" size=".041 .14" zaxis="1 -1 -1"/>
-        <body name="right_lower_arm" pos=".18 -.18 -.18">
-          <joint limited="true" name="right_elbow" axis="0 -1 1" range="-90 50" damping="1.0" stiffness="2" armature=".006"/>
-          <geom name="right_lower_arm" type="capsule" fromto=".01 .01 .01 .17 .17 .17" size=".031"/>
-          <site name="right_lower_arm" class="touch" pos=".09 .09 .09" size=".032 .14" zaxis="1 1 1"/>
-          <geom name="right_hand" type="sphere" size=".04" pos=".18 .18 .18"/>
-        </body>
-      </body>
-      <body name="left_upper_arm" pos="0 .17 .06">
-        <joint limited="true" name="left_shoulder1" axis="-2 1 -1" range="-60 60" damping="5" stiffness="10" armature=".01"/>
-        <joint limited="true" name="left_shoulder2" axis="0 -1 -1" range="-60 60" damping="5" stiffness="10" armature=".01"/>
-        <geom name="left_upper_arm" type="capsule" fromto="0 0 0 .16 .16 -.16" size=".04 .16"/>
-        <site name="left_upper_arm" class="touch" pos=".08 .08 -.08" size=".041 .14" zaxis="1 1 -1"/>
-        <body name="left_lower_arm" pos=".18 .18 -.18">
-          <joint limited="true" name="left_elbow" axis="0 -1 -1" range="-90 50" damping="1.0" stiffness="2" armature=".006"/>
-          <geom name="left_lower_arm" type="capsule" fromto=".01 -.01 .01 .17 -.17 .17" size=".031"/>
-          <site name="left_lower_arm" class="touch" pos=".09 -.09 .09" size=".032 .14" zaxis="1 -1 1"/>
-          <geom name="left_hand" type="sphere" size=".04" pos=".18 -.18 .18"/>
-        </body>
-      </body>
-    </body>
-  </worldbody>
-
-  <actuator>
-    <motor name='abdomen_y'       gear='67.5' joint='abdomen_y'/>
-    <motor name='abdomen_z'       gear='67.5' joint='abdomen_z'/>
-    <motor name='abdomen_x'       gear='67.5' joint='abdomen_x'/>
-    <motor name='right_hip_x'     gear='45.0' joint='right_hip_x'/>
-    <motor name='right_hip_z'     gear='45.0' joint='right_hip_z'/>
-    <motor name='right_hip_y'     gear='135.0' joint='right_hip_y'/>
-    <motor name='right_knee'      gear='90.0' joint='right_knee'/>
-    <motor name='right_ankle_x'   gear='22.5' joint='right_ankle_x'/>
-    <motor name='right_ankle_y'   gear='22.5' joint='right_ankle_y'/>
-    <motor name='left_hip_x'      gear='45.0' joint='left_hip_x'/>
-    <motor name='left_hip_z'      gear='45.0' joint='left_hip_z'/>
-    <motor name='left_hip_y'      gear='135.0' joint='left_hip_y'/>
-    <motor name='left_knee'       gear='90.0' joint='left_knee'/>
-    <motor name='left_ankle_x'    gear='22.5' joint='left_ankle_x'/>
-    <motor name='left_ankle_y'    gear='22.5' joint='left_ankle_y'/>
-    <motor name='right_shoulder1' gear='67.5' joint='right_shoulder1'/>
-    <motor name='right_shoulder2' gear='67.5' joint='right_shoulder2'/>
-    <motor name='right_elbow'     gear='45.0' joint='right_elbow'/>  
-    <motor name='left_shoulder1'  gear='67.5' joint='left_shoulder1'/>
-    <motor name='left_shoulder2'  gear='67.5' joint='left_shoulder2'/>
-    <motor name='left_elbow'      gear='45.0' joint='left_elbow'/>
-  </actuator>
-
-  <sensor>
-    <subtreelinvel name="torso_subtreelinvel" body="torso"/>
-    <accelerometer name="torso_accel"    site="root"/>
-    <velocimeter name="torso_vel"        site="root"/>
-    <gyro name="torso_gyro"              site="root"/>
-
-    <force name="left_ankle_force"       site="left_ankle"/>
-    <force name="right_ankle_force"      site="right_ankle"/>
-    <force name="left_knee_force"        site="left_knee"/>
-    <force name="right_knee_force"       site="right_knee"/>
-    <force name="left_hip_force"         site="left_hip"/>
-    <force name="right_hip_force"        site="right_hip"/>
-
-    <torque name="left_ankle_torque"     site="left_ankle"/>
-    <torque name="right_ankle_torque"    site="right_ankle"/>
-    <torque name="left_knee_torque"      site="left_knee"/>
-    <torque name="right_knee_torque"     site="right_knee"/>
-    <torque name="left_hip_torque"       site="left_hip"/>
-    <torque name="right_hip_torque"      site="right_hip"/>
-
-    <touch name="torso_touch"            site="torso"/>
-    <touch name="head_touch"             site="head"/>
-    <touch name="lower_waist_touch"      site="lower_waist"/>
-    <touch name="butt_touch"             site="butt"/>
-    <touch name="right_thigh_touch"      site="right_thigh"/>
-    <touch name="right_shin_touch"       site="right_shin"/>
-    <touch name="right_right_foot_touch" site="right_right_foot"/>
-    <touch name="left_right_foot_touch"  site="left_right_foot"/>
-    <touch name="left_thigh_touch"       site="left_thigh"/>
-    <touch name="left_shin_touch"        site="left_shin"/>
-    <touch name="right_left_foot_touch"  site="right_left_foot"/>
-    <touch name="left_left_foot_touch"   site="left_left_foot"/>
-    <touch name="right_upper_arm_touch"  site="right_upper_arm"/>
-    <touch name="right_lower_arm_touch"  site="right_lower_arm"/>
-    <touch name="right_hand_touch"       site="right_hand"/>
-    <touch name="left_upper_arm_touch"   site="left_upper_arm"/>
-    <touch name="left_lower_arm_touch"   site="left_lower_arm"/>
-    <touch name="left_hand_touch"        site="left_hand"/>
-  </sensor>
-
-</mujoco>
-
diff --git a/warp/examples/assets/quadruped.urdf b/warp/examples/assets/quadruped.urdf
deleted file mode 100644
index 38d81266..00000000
--- a/warp/examples/assets/quadruped.urdf
+++ /dev/null
@@ -1,268 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-
-<robot name="quadruped">
-    <link name="base">
-        <collision>
-            <origin rpy="0 1.57079632679 0" xyz="0 0 0"/>
-            <geometry>
-                <cylinder length="0.75" radius="0.1"/>
-            </geometry>
-        </collision>
-        <inertial>
-            <origin rpy="0 0 0" xyz="0 0 0.024"/>
-            <mass value="6.222"/>
-            <inertia ixx="0.017938806" ixy="0.00387963" ixz="0.001500772" iyy="0.370887745" iyz="6.8963e-05" izz="0.372497653"/>
-        </inertial>
-    </link>
-
-    <joint name="LF_HAA" type="revolute">
-        <parent link="base"/>
-        <child link="LF_HAA"/>
-        <axis xyz="1 0 0"/>
-        <limit effort="80.0" velocity="20." />
-        <origin rpy="0 0 0" xyz="0.2999 0.104 0.0"/>
-    </joint>
-    <link name="LF_HAA">
-        <collision>
-            <origin rpy="1.57079632679 0 0" xyz="0 0 0"/>
-            <geometry>
-                <cylinder length="0.05" radius="0.04"/>
-            </geometry>
-        </collision>
-        <inertial>
-            <origin rpy="0 0 0" xyz="0 0 0.00046"/>
-            <mass value="2.04"/>
-            <inertia ixx="0.001053013" ixy="4.527e-05" ixz="8.855e-05" iyy="0.001805509" iyz="9.909e-05" izz="0.001765827"/>
-        </inertial>
-    </link>
-    <joint name="LF_HFE" type="revolute">
-        <parent link="LF_HAA"/>
-        <child link="LF_THIGH"/>
-        <origin rpy="0 0 1.57079632679" xyz="0 0.05 0"/>
-        <axis xyz="1 0 0"/>
-        <limit effort="80.0" velocity="20." />
-        <dynamics damping="0.0" friction="0.0"/>
-    </joint>
-    <link name="LF_THIGH">
-        <collision>
-            <origin rpy="0 0 0" xyz="0 0 -0.125"/>
-            <geometry>
-                <cylinder length="0.25" radius="0.02"/>
-            </geometry>
-        </collision>
-        <inertial>
-            <origin rpy="0 0 0" xyz="0 0 -0.125"/>
-            <mass value="2.04"/>
-            <inertia ixx="0.001053013" ixy="4.527e-05" ixz="8.855e-05" iyy="0.001805509" iyz="9.909e-05" izz="0.001765827"/>
-        </inertial>
-    </link>
-    <joint name="LF_KFE" type="revolute">
-        <parent link="LF_THIGH"/>
-        <child link="LF_SHANK"/>
-        <origin rpy="0 0 0" xyz="0 0.0 -0.25"/>
-        <axis xyz="1 0 0"/>
-        <limit effort="80.0" velocity="20." />
-        <dynamics damping="0.0" friction="0.0"/>
-    </joint>
-    <link name="LF_SHANK">
-        <collision>
-            <origin rpy="0 0 0" xyz="0 0 -0.125"/>
-            <geometry>
-                <cylinder length="0.25" radius="0.02"/>
-            </geometry>
-        </collision>
-        <inertial>
-            <origin rpy="0 0 0" xyz="0 0 -0.125"/>
-            <mass value="2.04"/>
-            <inertia ixx="0.001053013" ixy="4.527e-05" ixz="8.855e-05" iyy="0.001805509" iyz="9.909e-05" izz="0.001765827"/>
-        </inertial>
-    </link>
-    <joint name="RF_HAA" type="revolute">
-        <parent link="base"/>
-        <child link="RF_HAA"/>
-        <axis xyz="1 0 0"/>
-        <limit effort="80.0" velocity="20." />
-        <origin rpy="0 0 0" xyz="0.2999 -0.104 0.0"/>
-    </joint>
-    <link name="RF_HAA">
-        <collision>
-            <origin rpy="1.57079632679 0 0" xyz="0 0 0"/>
-            <geometry>
-                <cylinder length="0.05" radius="0.04"/>
-            </geometry>
-        </collision>
-        <inertial>
-            <origin rpy="0 0 0" xyz="0 0 0.00046"/>
-            <mass value="2.04"/>
-            <inertia ixx="0.001053013" ixy="4.527e-05" ixz="8.855e-05" iyy="0.001805509" iyz="9.909e-05" izz="0.001765827"/>
-        </inertial>
-    </link>
-    <joint name="RF_HFE" type="revolute">
-        <parent link="RF_HAA"/>
-        <child link="RF_THIGH"/>
-        <origin rpy="0 0 -1.57079632679" xyz="0 -0.05 0"/>
-        <axis xyz="1 0 0"/>
-        <limit effort="80.0" velocity="20." />
-        <dynamics damping="0.0" friction="0.0"/>
-    </joint>
-    <link name="RF_THIGH">
-        <collision>
-            <origin rpy="0 0 0" xyz="0 0 -0.125"/>
-            <geometry>
-                <cylinder length="0.25" radius="0.02"/>
-            </geometry>
-        </collision>
-        <inertial>
-            <origin rpy="0 0 0" xyz="0 0 -0.125"/>
-            <mass value="2.04"/>
-            <inertia ixx="0.001053013" ixy="4.527e-05" ixz="8.855e-05" iyy="0.001805509" iyz="9.909e-05" izz="0.001765827"/>
-        </inertial>
-    </link>
-    <joint name="RF_KFE" type="revolute">
-        <parent link="RF_THIGH"/>
-        <child link="RF_SHANK"/>
-        <origin rpy="0 0 0" xyz="0 0.0 -0.25"/>
-        <axis xyz="1 0 0"/>
-        <limit effort="80.0" velocity="20." />
-        <dynamics damping="0.0" friction="0.0"/>
-    </joint>
-    <link name="RF_SHANK">
-        <collision>
-            <origin rpy="0 0 0" xyz="0 0 -0.125"/>
-            <geometry>
-                <cylinder length="0.25" radius="0.02"/>
-            </geometry>
-        </collision>
-        <inertial>
-            <origin rpy="0 0 0" xyz="0 0 -0.125"/>
-            <mass value="2.04"/>
-            <inertia ixx="0.001053013" ixy="4.527e-05" ixz="8.855e-05" iyy="0.001805509" iyz="9.909e-05" izz="0.001765827"/>
-        </inertial>
-    </link>
-
-    <joint name="LH_HAA" type="revolute">
-        <parent link="base"/>
-        <child link="LH_HAA"/>
-        <axis xyz="1 0 0"/>
-        <limit effort="80.0" velocity="20." />
-        <origin rpy="0 0 3.1415" xyz="-0.2999 0.104 0.0"/>
-    </joint>
-    <link name="LH_HAA">
-        <collision>
-            <origin rpy="1.57079632679 0 0" xyz="0 0 0"/>
-            <geometry>
-                <cylinder length="0.05" radius="0.04"/>
-            </geometry>
-        </collision>
-        <inertial>
-            <origin rpy="0 0 0" xyz="0 0 0.00046"/>
-            <mass value="2.04"/>
-            <inertia ixx="0.001053013" ixy="4.527e-05" ixz="8.855e-05" iyy="0.001805509" iyz="9.909e-05" izz="0.001765827"/>
-        </inertial>
-    </link>
-    <joint name="LH_HFE" type="revolute">
-        <parent link="LH_HAA"/>
-        <child link="LH_THIGH"/>
-        <origin rpy="0 0 1.57079632679" xyz="0 -0.05 0"/>
-        <axis xyz="1 0 0"/>
-        <limit effort="80.0" velocity="20." />
-        <dynamics damping="0.0" friction="0.0"/>
-    </joint>
-    <link name="LH_THIGH">
-        <collision>
-            <origin rpy="0 0 0" xyz="0 0 -0.125"/>
-            <geometry>
-                <cylinder length="0.25" radius="0.02"/>
-            </geometry>
-        </collision>
-        <inertial>
-            <origin rpy="0 0 0" xyz="0 0 -0.125"/>
-            <mass value="2.04"/>
-            <inertia ixx="0.001053013" ixy="4.527e-05" ixz="8.855e-05" iyy="0.001805509" iyz="9.909e-05" izz="0.001765827"/>
-        </inertial>
-    </link>
-    <joint name="LH_KFE" type="revolute">
-        <parent link="LH_THIGH"/>
-        <child link="LH_SHANK"/>
-        <origin rpy="0 0 0" xyz="0 0.0 -0.25"/>
-        <axis xyz="1 0 0"/>
-        <limit effort="80.0" velocity="20." />
-        <dynamics damping="0.0" friction="0.0"/>
-    </joint>
-    <link name="LH_SHANK">
-        <collision>
-            <origin rpy="0 0 0" xyz="0 0 -0.125"/>
-            <geometry>
-                <cylinder length="0.25" radius="0.02"/>
-            </geometry>
-        </collision>
-        <inertial>
-            <origin rpy="0 0 0" xyz="0 0 -0.125"/>
-            <mass value="2.04"/>
-            <inertia ixx="0.001053013" ixy="4.527e-05" ixz="8.855e-05" iyy="0.001805509" iyz="9.909e-05" izz="0.001765827"/>
-        </inertial>
-    </link>
-    <joint name="RH_HAA" type="revolute">
-        <parent link="base"/>
-        <child link="RH_HAA"/>
-        <axis xyz="1 0 0"/>
-        <limit effort="80.0" velocity="20." />
-        <origin rpy="0 0 3.1415" xyz="-0.2999 -0.104 0.0"/>
-    </joint>
-    <link name="RH_HAA">
-        <collision>
-            <origin rpy="1.57079632679 0 0" xyz="0 0 0"/>
-            <geometry>
-                <cylinder length="0.05" radius="0.04"/>
-            </geometry>
-        </collision>
-        <inertial>
-            <origin rpy="0 0 0" xyz="0 0 0.00046"/>
-            <mass value="2.04"/>
-            <inertia ixx="0.001053013" ixy="4.527e-05" ixz="8.855e-05" iyy="0.001805509" iyz="9.909e-05" izz="0.001765827"/>
-        </inertial>
-    </link>
-    <joint name="RH_HFE" type="revolute">
-        <parent link="RH_HAA"/>
-        <child link="RH_THIGH"/>
-        <origin rpy="0 0 -1.57079632679" xyz="0 0.05 0"/>
-        <axis xyz="1 0 0"/>
-        <limit effort="80.0" velocity="20." />
-        <dynamics damping="0.0" friction="0.0"/>
-    </joint>
-    <link name="RH_THIGH">
-        <collision>
-            <origin rpy="0 0 0" xyz="0 0 -0.125"/>
-            <geometry>
-                <cylinder length="0.25" radius="0.02"/>
-            </geometry>
-        </collision>
-        <inertial>
-            <origin rpy="0 0 0" xyz="0 0 -0.125"/>
-            <mass value="2.04"/>
-            <inertia ixx="0.001053013" ixy="4.527e-05" ixz="8.855e-05" iyy="0.001805509" iyz="9.909e-05" izz="0.001765827"/>
-        </inertial>
-    </link>
-    <joint name="RH_KFE" type="revolute">
-        <parent link="RH_THIGH"/>
-        <child link="RH_SHANK"/>
-        <origin rpy="0 0 0" xyz="0 0.0 -0.25"/>
-        <axis xyz="1 0 0"/>
-        <limit effort="80.0" velocity="20." />
-        <dynamics damping="0.0" friction="0.0"/>
-    </joint>
-    <link name="RH_SHANK">
-        <collision>
-            <origin rpy="0 0 0" xyz="0 0 -0.125"/>
-            <geometry>
-                <cylinder length="0.25" radius="0.02"/>
-            </geometry>
-        </collision>
-        <inertial>
-            <origin rpy="0 0 0" xyz="0 0 -0.125"/>
-            <mass value="2.04"/>
-            <inertia ixx="0.001053013" ixy="4.527e-05" ixz="8.855e-05" iyy="0.001805509" iyz="9.909e-05" izz="0.001765827"/>
-        </inertial>
-    </link>
-
-</robot>
\ No newline at end of file
diff --git a/warp/examples/fem/example_adaptive_grid.py b/warp/examples/fem/example_adaptive_grid.py
index 1fa824dc..60afca2a 100644
--- a/warp/examples/fem/example_adaptive_grid.py
+++ b/warp/examples/fem/example_adaptive_grid.py
@@ -16,7 +16,7 @@
 ###########################################################################
 # Example Adaptive Grid
 #
-# Demonstrates using an adaptive grid to increase the simulation resolition
+# Demonstrates using an adaptive grid to increase the simulation resolution
 # near a collider boundary.
 #
 ###########################################################################
diff --git a/warp/examples/fem/example_apic_fluid.py b/warp/examples/fem/example_apic_fluid.py
index 828226cd..ff071c0c 100644
--- a/warp/examples/fem/example_apic_fluid.py
+++ b/warp/examples/fem/example_apic_fluid.py
@@ -400,7 +400,7 @@ class Example:
         cell_volume = np.prod(cell_size)
 
         radius = np.max(cell_size) * 0.5
-        volume = np.prod(cell_volume) * packing_fraction
+        volume = cell_volume * packing_fraction
 
         rng = np.random.default_rng(42)
         points += 2.0 * radius * (rng.random(points.shape) - 0.5)
diff --git a/warp/examples/optim/example_bounce.py b/warp/examples/optim/example_bounce.py
deleted file mode 100644
index dccdcb38..00000000
--- a/warp/examples/optim/example_bounce.py
+++ /dev/null
@@ -1,266 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Sim Grad Bounce
-#
-# Shows how to use Warp to optimize the initial velocity of a particle
-# such that it bounces off the wall and floor in order to hit a target.
-#
-# This example uses the built-in wp.Tape() object to compute gradients of
-# the distance to target (loss) w.r.t the initial velocity, followed by
-# a simple gradient-descent optimization step.
-#
-###########################################################################
-
-import numpy as np
-
-import warp as wp
-import warp.sim
-import warp.sim.render
-
-
-@wp.kernel
-def loss_kernel(pos: wp.array(dtype=wp.vec3), target: wp.vec3, loss: wp.array(dtype=float)):
-    # distance to target
-    delta = pos[0] - target
-    loss[0] = wp.dot(delta, delta)
-
-
-@wp.kernel
-def step_kernel(x: wp.array(dtype=wp.vec3), grad: wp.array(dtype=wp.vec3), alpha: float):
-    tid = wp.tid()
-
-    # gradient descent step
-    x[tid] = x[tid] - grad[tid] * alpha
-
-
-class Example:
-    def __init__(self, stage_path="example_bounce.usd", verbose=False):
-        self.verbose = verbose
-
-        # seconds
-        sim_duration = 0.6
-
-        # control frequency
-        fps = 60
-        self.frame_dt = 1.0 / fps
-        frame_steps = int(sim_duration / self.frame_dt)
-
-        # sim frequency
-        self.sim_substeps = 8
-        self.sim_steps = frame_steps * self.sim_substeps
-        self.sim_dt = self.frame_dt / self.sim_substeps
-
-        self.iter = 0
-        self.render_time = 0.0
-
-        self.train_rate = 0.02
-
-        ke = 1.0e4
-        kf = 0.0
-        kd = 1.0e1
-        mu = 0.2
-
-        builder = wp.sim.ModelBuilder()
-        builder.add_particle(pos=wp.vec3(-0.5, 1.0, 0.0), vel=wp.vec3(5.0, -5.0, 0.0), mass=1.0)
-        builder.add_shape_box(body=-1, pos=wp.vec3(2.0, 1.0, 0.0), hx=0.25, hy=1.0, hz=1.0, ke=ke, kf=kf, kd=kd, mu=mu)
-
-        # use `requires_grad=True` to create a model for differentiable simulation
-        self.model = builder.finalize(requires_grad=True)
-        self.model.ground = True
-
-        self.model.soft_contact_ke = ke
-        self.model.soft_contact_kf = kf
-        self.model.soft_contact_kd = kd
-        self.model.soft_contact_mu = mu
-        self.model.soft_contact_margin = 10.0
-        self.model.soft_contact_restitution = 1.0
-
-        self.integrator = wp.sim.SemiImplicitIntegrator()
-
-        self.target = (-2.0, 1.5, 0.0)
-        self.loss = wp.zeros(1, dtype=wp.float32, requires_grad=True)
-
-        # allocate sim states for trajectory
-        self.states = []
-        for _i in range(self.sim_steps + 1):
-            self.states.append(self.model.state())
-
-        # one-shot contact creation (valid if we're doing simple collision against a constant normal plane)
-        wp.sim.collide(self.model, self.states[0])
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path, scaling=1.0)
-        else:
-            self.renderer = None
-
-        # capture forward/backward passes
-        self.use_cuda_graph = wp.get_device().is_cuda
-        if self.use_cuda_graph:
-            with wp.ScopedCapture() as capture:
-                self.tape = wp.Tape()
-                with self.tape:
-                    self.forward()
-                self.tape.backward(self.loss)
-            self.graph = capture.graph
-
-    def forward(self):
-        # run control loop
-        for i in range(self.sim_steps):
-            self.states[i].clear_forces()
-            self.integrator.simulate(self.model, self.states[i], self.states[i + 1], self.sim_dt)
-
-        # compute loss on final state
-        wp.launch(loss_kernel, dim=1, inputs=[self.states[-1].particle_q, self.target, self.loss])
-
-        return self.loss
-
-    def step(self):
-        with wp.ScopedTimer("step"):
-            if self.use_cuda_graph:
-                wp.capture_launch(self.graph)
-            else:
-                self.tape = wp.Tape()
-                with self.tape:
-                    self.forward()
-                self.tape.backward(self.loss)
-
-            # gradient descent step
-            x = self.states[0].particle_qd
-            wp.launch(step_kernel, dim=len(x), inputs=[x, x.grad, self.train_rate])
-
-            x_grad = self.tape.gradients[self.states[0].particle_qd]
-
-            if self.verbose:
-                print(f"Iter: {self.iter} Loss: {self.loss}")
-                print(f"    x: {x} g: {x_grad}")
-
-            # clear grads for next iteration
-            self.tape.zero()
-
-            self.iter = self.iter + 1
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            # draw trajectory
-            traj_verts = [self.states[0].particle_q.numpy()[0].tolist()]
-
-            for i in range(0, self.sim_steps, self.sim_substeps):
-                traj_verts.append(self.states[i].particle_q.numpy()[0].tolist())
-
-                self.renderer.begin_frame(self.render_time)
-                self.renderer.render(self.states[i])
-                self.renderer.render_box(
-                    pos=self.target,
-                    rot=wp.quat_identity(),
-                    extents=(0.1, 0.1, 0.1),
-                    name="target",
-                    color=(0.0, 0.0, 0.0),
-                )
-                self.renderer.render_line_strip(
-                    vertices=traj_verts,
-                    color=wp.render.bourke_color_map(0.0, 7.0, self.loss.numpy()[0]),
-                    radius=0.02,
-                    name=f"traj_{self.iter - 1}",
-                )
-                self.renderer.end_frame()
-
-                from pxr import Gf, UsdGeom
-
-                particles_prim = self.renderer.stage.GetPrimAtPath("/root/particles")
-                particles = UsdGeom.Points.Get(self.renderer.stage, particles_prim.GetPath())
-                particles.CreateDisplayColorAttr().Set([Gf.Vec3f(1.0, 1.0, 1.0)], time=self.renderer.time)
-
-                self.render_time += self.frame_dt
-
-    def check_grad(self):
-        param = self.states[0].particle_qd
-
-        # initial value
-        x_c = param.numpy().flatten()
-
-        # compute numeric gradient
-        x_grad_numeric = np.zeros_like(x_c)
-
-        for i in range(len(x_c)):
-            eps = 1.0e-3
-
-            step = np.zeros_like(x_c)
-            step[i] = eps
-
-            x_1 = x_c + step
-            x_0 = x_c - step
-
-            param.assign(x_1)
-            l_1 = self.forward().numpy()[0]
-
-            param.assign(x_0)
-            l_0 = self.forward().numpy()[0]
-
-            dldx = (l_1 - l_0) / (eps * 2.0)
-
-            x_grad_numeric[i] = dldx
-
-        # reset initial state
-        param.assign(x_c)
-
-        # compute analytic gradient
-        tape = wp.Tape()
-        with tape:
-            l = self.forward()
-
-        tape.backward(l)
-
-        x_grad_analytic = tape.gradients[param]
-
-        print(f"numeric grad: {x_grad_numeric}")
-        print(f"analytic grad: {x_grad_analytic}")
-
-        tape.zero()
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_bounce.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--train_iters", type=int, default=250, help="Total number of training iterations.")
-    parser.add_argument("--verbose", action="store_true", help="Print out additional status messages during execution.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path, verbose=args.verbose)
-
-        example.check_grad()
-
-        # replay and optimize
-        for i in range(args.train_iters):
-            example.step()
-            if i % 16 == 0:
-                example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/optim/example_cloth_throw.py b/warp/examples/optim/example_cloth_throw.py
deleted file mode 100644
index 55d39718..00000000
--- a/warp/examples/optim/example_cloth_throw.py
+++ /dev/null
@@ -1,228 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Sim Grad Cloth
-#
-# Shows how to use Warp to optimize the initial velocities of a piece of
-# cloth such that its center of mass hits a target after a specified time.
-#
-# This example uses the built-in wp.Tape() object to compute gradients of
-# the distance to target (loss) w.r.t the initial velocity, followed by
-# a simple gradient-descent optimization step.
-#
-###########################################################################
-
-import math
-
-import warp as wp
-import warp.sim
-import warp.sim.render
-
-
-@wp.kernel
-def com_kernel(positions: wp.array(dtype=wp.vec3), n: int, com: wp.array(dtype=wp.vec3)):
-    tid = wp.tid()
-
-    # compute center of mass
-    wp.atomic_add(com, 0, positions[tid] / float(n))
-
-
-@wp.kernel
-def loss_kernel(com: wp.array(dtype=wp.vec3), target: wp.vec3, loss: wp.array(dtype=float)):
-    # sq. distance to target
-    delta = com[0] - target
-
-    loss[0] = wp.dot(delta, delta)
-
-
-@wp.kernel
-def step_kernel(x: wp.array(dtype=wp.vec3), grad: wp.array(dtype=wp.vec3), alpha: float):
-    tid = wp.tid()
-
-    # gradient descent step
-    x[tid] = x[tid] - grad[tid] * alpha
-
-
-class Example:
-    def __init__(self, stage_path="example_cloth_throw.usd", verbose=False):
-        self.verbose = verbose
-
-        # seconds
-        sim_duration = 2.0
-
-        # control frequency
-        fps = 60
-        self.frame_dt = 1.0 / fps
-        frame_steps = int(sim_duration / self.frame_dt)
-
-        # sim frequency
-        self.sim_substeps = 16
-        self.sim_steps = frame_steps * self.sim_substeps
-        self.sim_dt = self.frame_dt / self.sim_substeps
-
-        self.iter = 0
-        self.render_time = 0.0
-
-        self.train_rate = 5.0
-
-        builder = wp.sim.ModelBuilder()
-        builder.default_particle_radius = 0.01
-
-        dim_x = 16
-        dim_y = 16
-
-        builder.add_cloth_grid(
-            pos=wp.vec3(0.0, 0.0, 0.0),
-            vel=wp.vec3(0.1, 0.1, 0.0),
-            rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), -math.pi * 0.25),
-            dim_x=dim_x,
-            dim_y=dim_y,
-            cell_x=1.0 / dim_x,
-            cell_y=1.0 / dim_y,
-            mass=1.0,
-            tri_ke=10000.0,
-            tri_ka=10000.0,
-            tri_kd=100.0,
-            tri_lift=10.0,
-            tri_drag=5.0,
-        )
-
-        self.model = builder.finalize()
-        self.model.ground = False
-
-        self.integrator = wp.sim.SemiImplicitIntegrator()
-
-        self.target = (8.0, 0.0, 0.0)
-        self.com = wp.zeros(1, dtype=wp.vec3, requires_grad=True)
-        self.loss = wp.zeros(1, dtype=wp.float32, requires_grad=True)
-
-        # allocate sim states for trajectory
-        self.states = []
-        for _i in range(self.sim_steps + 1):
-            self.states.append(self.model.state(requires_grad=True))
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path, scaling=4.0)
-        else:
-            self.renderer = None
-
-        # capture forward/backward passes
-        self.use_cuda_graph = wp.get_device().is_cuda
-        if self.use_cuda_graph:
-            with wp.ScopedCapture() as capture:
-                self.tape = wp.Tape()
-                with self.tape:
-                    self.forward()
-                self.tape.backward(self.loss)
-            self.graph = capture.graph
-
-    def forward(self):
-        # run control loop
-        for i in range(self.sim_steps):
-            self.states[i].clear_forces()
-
-            self.integrator.simulate(self.model, self.states[i], self.states[i + 1], self.sim_dt)
-
-        # compute loss on final state
-        self.com.zero_()
-        wp.launch(
-            com_kernel,
-            dim=self.model.particle_count,
-            inputs=[self.states[-1].particle_q, self.model.particle_count, self.com],
-        )
-        wp.launch(loss_kernel, dim=1, inputs=[self.com, self.target, self.loss])
-
-    def step(self):
-        with wp.ScopedTimer("step"):
-            if self.use_cuda_graph:
-                wp.capture_launch(self.graph)
-            else:
-                self.tape = wp.Tape()
-                with self.tape:
-                    self.forward()
-                self.tape.backward(self.loss)
-
-            # gradient descent step
-            x = self.states[0].particle_qd
-
-            if self.verbose:
-                print(f"Iter: {self.iter} Loss: {self.loss}")
-
-            wp.launch(step_kernel, dim=len(x), inputs=[x, x.grad, self.train_rate])
-
-            # clear grads for next iteration
-            self.tape.zero()
-
-            self.iter = self.iter + 1
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            # draw trajectory
-            traj_verts = [self.states[0].particle_q.numpy().mean(axis=0)]
-
-            for i in range(0, self.sim_steps, self.sim_substeps):
-                traj_verts.append(self.states[i].particle_q.numpy().mean(axis=0))
-
-                self.renderer.begin_frame(self.render_time)
-                self.renderer.render(self.states[i])
-                self.renderer.render_box(
-                    pos=self.target,
-                    rot=wp.quat_identity(),
-                    extents=(0.1, 0.1, 0.1),
-                    name="target",
-                    color=(1.0, 0.0, 0.0),
-                )
-                self.renderer.render_line_strip(
-                    vertices=traj_verts,
-                    color=wp.render.bourke_color_map(0.0, 269.0, self.loss.numpy()[0]),
-                    radius=0.02,
-                    name=f"traj_{self.iter - 1}",
-                )
-                self.renderer.end_frame()
-
-                self.render_time += self.frame_dt
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_cloth_throw.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--train_iters", type=int, default=64, help="Total number of training iterations.")
-    parser.add_argument("--verbose", action="store_true", help="Print out additional status messages during execution.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path, verbose=args.verbose)
-
-        # replay and optimize
-        for i in range(args.train_iters):
-            example.step()
-            if i % 4 == 0:
-                example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/optim/example_drone.py b/warp/examples/optim/example_drone.py
deleted file mode 100644
index a9a82cab..00000000
--- a/warp/examples/optim/example_drone.py
+++ /dev/null
@@ -1,870 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2024 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Drone
-#
-# A drone and its 4 propellers is simulated with the goal of reaching
-# different targets via model-predictive control (MPC) that continuously
-# optimizes the control trajectory.
-#
-###########################################################################
-
-import os
-from typing import Optional, Tuple
-
-import numpy as np
-
-import warp as wp
-import warp.examples
-import warp.optim
-import warp.sim
-import warp.sim.render
-from warp.sim.collide import box_sdf, capsule_sdf, cone_sdf, cylinder_sdf, mesh_sdf, plane_sdf, sphere_sdf
-
-DEFAULT_DRONE_PATH = os.path.join(warp.examples.get_asset_directory(), "crazyflie.usd")  # Path to input drone asset
-
-
-@wp.struct
-class Propeller:
-    body: int
-    pos: wp.vec3
-    dir: wp.vec3
-    thrust: float
-    power: float
-    diameter: float
-    height: float
-    max_rpm: float
-    max_thrust: float
-    max_torque: float
-    turning_direction: float
-    max_speed_square: float
-
-
-@wp.kernel
-def increment_seed(
-    seed: wp.array(dtype=int),
-):
-    seed[0] += 1
-
-
-@wp.kernel
-def sample_gaussian(
-    mean_trajectory: wp.array(dtype=float, ndim=3),
-    noise_scale: float,
-    num_control_points: int,
-    control_dim: int,
-    control_limits: wp.array(dtype=float, ndim=2),
-    seed: wp.array(dtype=int),
-    rollout_trajectories: wp.array(dtype=float, ndim=3),
-):
-    env_id, point_id, control_id = wp.tid()
-    unique_id = (env_id * num_control_points + point_id) * control_dim + control_id
-    r = wp.rand_init(seed[0], unique_id)
-    mean = mean_trajectory[0, point_id, control_id]
-    lo, hi = control_limits[control_id, 0], control_limits[control_id, 1]
-    sample = mean + noise_scale * wp.randn(r)
-    for _i in range(10):
-        if sample < lo or sample > hi:
-            sample = mean + noise_scale * wp.randn(r)
-        else:
-            break
-    rollout_trajectories[env_id, point_id, control_id] = wp.clamp(sample, lo, hi)
-
-
-@wp.kernel
-def replicate_states(
-    body_q_in: wp.array(dtype=wp.transform),
-    body_qd_in: wp.array(dtype=wp.spatial_vector),
-    bodies_per_env: int,
-    body_q_out: wp.array(dtype=wp.transform),
-    body_qd_out: wp.array(dtype=wp.spatial_vector),
-):
-    tid = wp.tid()
-    env_offset = tid * bodies_per_env
-    for i in range(bodies_per_env):
-        body_q_out[env_offset + i] = body_q_in[i]
-        body_qd_out[env_offset + i] = body_qd_in[i]
-
-
-@wp.kernel
-def drone_cost(
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-    targets: wp.array(dtype=wp.vec3),
-    prop_control: wp.array(dtype=float),
-    step: int,
-    horizon_length: int,
-    weighting: float,
-    cost: wp.array(dtype=wp.float32),
-):
-    env_id = wp.tid()
-    tf = body_q[env_id]
-    target = targets[0]
-
-    pos_drone = wp.transform_get_translation(tf)
-    pos_cost = wp.length_sq(pos_drone - target)
-    altitude_cost = wp.max(pos_drone[1] - 0.75, 0.0) + wp.max(0.25 - pos_drone[1], 0.0)
-    upvector = wp.vec3(0.0, 1.0, 0.0)
-    drone_up = wp.transform_vector(tf, upvector)
-    upright_cost = 1.0 - wp.dot(drone_up, upvector)
-
-    vel_drone = body_qd[env_id]
-
-    # Encourage zero velocity.
-    vel_cost = wp.length_sq(vel_drone)
-
-    control = wp.vec4(
-        prop_control[env_id * 4 + 0],
-        prop_control[env_id * 4 + 1],
-        prop_control[env_id * 4 + 2],
-        prop_control[env_id * 4 + 3],
-    )
-    control_cost = wp.dot(control, control)
-
-    discount = 0.8 ** wp.float(horizon_length - step - 1) / wp.float(horizon_length) ** 2.0
-
-    pos_weight = 1000.0
-    altitude_weight = 100.0
-    control_weight = 0.05
-    vel_weight = 0.1
-    upright_weight = 10.0
-    total_weight = pos_weight + altitude_weight + control_weight + vel_weight + upright_weight
-
-    wp.atomic_add(
-        cost,
-        env_id,
-        (
-            pos_cost * pos_weight
-            + altitude_cost * altitude_weight
-            + control_cost * control_weight
-            + vel_cost * vel_weight
-            + upright_cost * upright_weight
-        )
-        * (weighting / total_weight)
-        * discount,
-    )
-
-
-@wp.kernel
-def collision_cost(
-    body_q: wp.array(dtype=wp.transform),
-    obstacle_ids: wp.array(dtype=int, ndim=2),
-    shape_X_bs: wp.array(dtype=wp.transform),
-    geo: wp.sim.ModelShapeGeometry,
-    margin: float,
-    weighting: float,
-    cost: wp.array(dtype=wp.float32),
-):
-    env_id, obs_id = wp.tid()
-    shape_index = obstacle_ids[env_id, obs_id]
-
-    px = wp.transform_get_translation(body_q[env_id])
-
-    X_bs = shape_X_bs[shape_index]
-
-    # transform particle position to shape local space
-    x_local = wp.transform_point(wp.transform_inverse(X_bs), px)
-
-    # geo description
-    geo_type = geo.type[shape_index]
-    geo_scale = geo.scale[shape_index]
-
-    # evaluate shape sdf
-    d = 1e6
-
-    if geo_type == wp.sim.GEO_SPHERE:
-        d = sphere_sdf(wp.vec3(), geo_scale[0], x_local)
-    elif geo_type == wp.sim.GEO_BOX:
-        d = box_sdf(geo_scale, x_local)
-    elif geo_type == wp.sim.GEO_CAPSULE:
-        d = capsule_sdf(geo_scale[0], geo_scale[1], x_local)
-    elif geo_type == wp.sim.GEO_CYLINDER:
-        d = cylinder_sdf(geo_scale[0], geo_scale[1], x_local)
-    elif geo_type == wp.sim.GEO_CONE:
-        d = cone_sdf(geo_scale[0], geo_scale[1], x_local)
-    elif geo_type == wp.sim.GEO_MESH:
-        mesh = geo.source[shape_index]
-        min_scale = wp.min(geo_scale)
-        max_dist = margin / min_scale
-        d = mesh_sdf(mesh, wp.cw_div(x_local, geo_scale), max_dist)
-        d *= min_scale  # TODO fix this, mesh scaling needs to be handled properly
-    elif geo_type == wp.sim.GEO_SDF:
-        volume = geo.source[shape_index]
-        xpred_local = wp.volume_world_to_index(volume, wp.cw_div(x_local, geo_scale))
-        nn = wp.vec3(0.0, 0.0, 0.0)
-        d = wp.volume_sample_grad_f(volume, xpred_local, wp.Volume.LINEAR, nn)
-    elif geo_type == wp.sim.GEO_PLANE:
-        d = plane_sdf(geo_scale[0], geo_scale[1], x_local)
-
-    d = wp.max(d, 0.0)
-    if d < margin:
-        c = margin - d
-        wp.atomic_add(cost, env_id, weighting * c)
-
-
-@wp.kernel
-def enforce_control_limits(
-    control_limits: wp.array(dtype=float, ndim=2),
-    control_points: wp.array(dtype=float, ndim=3),
-):
-    env_id, t_id, control_id = wp.tid()
-    lo, hi = control_limits[control_id, 0], control_limits[control_id, 1]
-    control_points[env_id, t_id, control_id] = wp.clamp(control_points[env_id, t_id, control_id], lo, hi)
-
-
-@wp.kernel
-def pick_best_trajectory(
-    rollout_trajectories: wp.array(dtype=float, ndim=3),
-    lowest_cost_id: int,
-    best_traj: wp.array(dtype=float, ndim=3),
-):
-    t_id, control_id = wp.tid()
-    best_traj[0, t_id, control_id] = rollout_trajectories[lowest_cost_id, t_id, control_id]
-
-
-@wp.kernel
-def interpolate_control_linear(
-    control_points: wp.array(dtype=float, ndim=3),
-    control_dofs: wp.array(dtype=int),
-    control_gains: wp.array(dtype=float),
-    t: float,
-    torque_dim: int,
-    torques: wp.array(dtype=float),
-):
-    env_id, control_id = wp.tid()
-    t_id = int(t)
-    frac = t - wp.floor(t)
-    control_left = control_points[env_id, t_id, control_id]
-    control_right = control_points[env_id, t_id + 1, control_id]
-    torque_id = env_id * torque_dim + control_dofs[control_id]
-    action = control_left * (1.0 - frac) + control_right * frac
-    torques[torque_id] = action * control_gains[control_id]
-
-
-@wp.kernel
-def compute_prop_wrenches(
-    props: wp.array(dtype=Propeller),
-    controls: wp.array(dtype=float),
-    body_q: wp.array(dtype=wp.transform),
-    body_com: wp.array(dtype=wp.vec3),
-    body_f: wp.array(dtype=wp.spatial_vector),
-):
-    tid = wp.tid()
-    prop = props[tid]
-    control = controls[tid]
-    tf = body_q[prop.body]
-    dir = wp.transform_vector(tf, prop.dir)
-    force = dir * prop.max_thrust * control
-    torque = dir * prop.max_torque * control * prop.turning_direction
-    moment_arm = wp.transform_point(tf, prop.pos) - wp.transform_point(tf, body_com[prop.body])
-    torque += wp.cross(moment_arm, force)
-    # Apply angular damping.
-    torque *= 0.8
-    wp.atomic_add(body_f, prop.body, wp.spatial_vector(torque, force))
-
-
-def define_propeller(
-    drone: int,
-    pos: wp.vec3,
-    fps: float,
-    thrust: float = 0.109919,
-    power: float = 0.040164,
-    diameter: float = 0.2286,
-    height: float = 0.01,
-    max_rpm: float = 6396.667,
-    turning_direction: float = 1.0,
-):
-    # Air density at sea level.
-    air_density = 1.225  # kg / m^3
-
-    rps = max_rpm / fps
-    max_speed = rps * wp.TAU  # radians / sec
-    rps_square = rps**2
-
-    prop = Propeller()
-    prop.body = drone
-    prop.pos = pos
-    prop.dir = wp.vec3(0.0, 1.0, 0.0)
-    prop.thrust = thrust
-    prop.power = power
-    prop.diameter = diameter
-    prop.height = height
-    prop.max_rpm = max_rpm
-    prop.max_thrust = thrust * air_density * rps_square * diameter**4
-    prop.max_torque = power * air_density * rps_square * diameter**5 / wp.TAU
-    prop.turning_direction = turning_direction
-    prop.max_speed_square = max_speed**2
-
-    return prop
-
-
-class Drone:
-    def __init__(
-        self,
-        name: str,
-        fps: float,
-        trajectory_shape: Tuple[int, int],
-        variation_count: int = 1,
-        size: float = 1.0,
-        requires_grad: bool = False,
-        state_count: Optional[int] = None,
-    ) -> None:
-        self.variation_count = variation_count
-        self.requires_grad = requires_grad
-
-        # Current tick of the simulation, including substeps.
-        self.sim_tick = 0
-
-        # Initialize the helper to build a physics scene.
-        builder = wp.sim.ModelBuilder()
-        builder.rigid_contact_margin = 0.05
-
-        # Initialize the rigid bodies, propellers, and colliders.
-        props = []
-        colliders = []
-        crossbar_length = size
-        crossbar_height = size * 0.05
-        crossbar_width = size * 0.05
-        carbon_fiber_density = 1750.0  # kg / m^3
-        for i in range(variation_count):
-            # Register the drone as a rigid body in the simulation model.
-            body = builder.add_body(name=f"{name}_{i}")
-
-            # Define the shapes making up the drone's rigid body.
-            builder.add_shape_box(
-                body,
-                hx=crossbar_length,
-                hy=crossbar_height,
-                hz=crossbar_width,
-                density=carbon_fiber_density,
-                collision_group=i,
-            )
-            builder.add_shape_box(
-                body,
-                hx=crossbar_width,
-                hy=crossbar_height,
-                hz=crossbar_length,
-                density=carbon_fiber_density,
-                collision_group=i,
-            )
-
-            # Initialize the propellers.
-            props.extend(
-                (
-                    define_propeller(
-                        body,
-                        wp.vec3(crossbar_length, 0.0, 0.0),
-                        fps,
-                        turning_direction=-1.0,
-                    ),
-                    define_propeller(
-                        body,
-                        wp.vec3(-crossbar_length, 0.0, 0.0),
-                        fps,
-                        turning_direction=1.0,
-                    ),
-                    define_propeller(
-                        body,
-                        wp.vec3(0.0, 0.0, crossbar_length),
-                        fps,
-                        turning_direction=1.0,
-                    ),
-                    define_propeller(
-                        body,
-                        wp.vec3(0.0, 0.0, -crossbar_length),
-                        fps,
-                        turning_direction=-1.0,
-                    ),
-                ),
-            )
-
-            # Initialize the colliders.
-            colliders.append(
-                (
-                    builder.add_shape_capsule(
-                        -1,
-                        pos=(0.5, 2.0, 0.5),
-                        radius=0.15,
-                        half_height=2.0,
-                        collision_group=i,
-                    ),
-                ),
-            )
-        self.props = wp.array(props, dtype=Propeller)
-        self.colliders = wp.array(colliders, dtype=int)
-
-        # Build the model and set-up its properties.
-        self.model = builder.finalize(requires_grad=requires_grad)
-        self.model.ground = False
-
-        # Initialize the required simulation states.
-        if requires_grad:
-            self.states = tuple(self.model.state() for _ in range(state_count + 1))
-            self.controls = tuple(self.model.control() for _ in range(state_count))
-        else:
-            # When only running a forward simulation, we don't need to store
-            # the history of the states at each step, instead we use double
-            # buffering to represent the previous and next states.
-            self.states = [self.model.state(), self.model.state()]
-            self.controls = (self.model.control(),)
-
-        # create array for the propeller controls
-        for control in self.controls:
-            control.prop_controls = wp.zeros(len(self.props), dtype=float, requires_grad=requires_grad)
-
-        # Define the trajectories as arrays of control points.
-        # The point data has an additional item to support linear interpolation.
-        self.trajectories = wp.zeros(
-            (variation_count, trajectory_shape[0], trajectory_shape[1]),
-            dtype=float,
-            requires_grad=requires_grad,
-        )
-
-        # Store some miscellaneous info.
-        self.body_count = len(builder.body_q)
-        self.collider_count = self.colliders.shape[1]
-        self.collision_radius = crossbar_length
-
-    @property
-    def state(self) -> wp.sim.State:
-        return self.states[self.sim_tick if self.requires_grad else 0]
-
-    @property
-    def next_state(self) -> wp.sim.State:
-        return self.states[self.sim_tick + 1 if self.requires_grad else 1]
-
-    @property
-    def control(self) -> wp.sim.Control:
-        return self.controls[min(len(self.controls) - 1, self.sim_tick) if self.requires_grad else 0]
-
-
-class Example:
-    def __init__(
-        self,
-        stage_path="example_drone.usd",
-        verbose=False,
-        render_rollouts=False,
-        drone_path=DEFAULT_DRONE_PATH,
-        num_frames=360,
-        num_rollouts=16,
-        headless=True,
-    ) -> None:
-        # Number of frames per second.
-        self.fps = 60
-
-        # Duration of the simulation in number of frames.
-        self.num_frames = num_frames
-
-        # Number of simulation substeps to take per step.
-        self.sim_substep_count = 1
-
-        # Delta time between each simulation substep.
-        self.frame_dt = 1.0 / self.fps
-
-        # Delta time between each simulation substep.
-        self.sim_dt = self.frame_dt / self.sim_substep_count
-
-        # Frame number used for simulation and rendering.
-        self.frame = 0
-
-        # Targets positions that the drone will try to reach in turn.
-        self.targets = (
-            wp.vec3(0.0, 0.5, 1.0),
-            wp.vec3(1.0, 0.5, 0.0),
-        )
-
-        # Define the index of the active target.
-        # We start with -1 since it'll be incremented on the first frame.
-        self.target_idx = -1
-        # use a Warp array to store the current target so that we can assign
-        # a new target to it while retaining the original CUDA graph.
-        self.current_target = wp.array([self.targets[self.target_idx + 1]], dtype=wp.vec3)
-
-        # Number of steps to run at each frame for the optimisation pass.
-        self.optim_step_count = 20
-
-        # Time steps between control points.
-        self.control_point_step = 10
-
-        # Number of control horizon points to interpolate between.
-        self.control_point_count = 3
-
-        self.control_point_data_count = self.control_point_count + 1
-        self.control_dofs = wp.array((0, 1, 2, 3), dtype=int)
-        self.control_dim = len(self.control_dofs)
-        self.control_gains = wp.array((0.8,) * self.control_dim, dtype=float)
-        self.control_limits = wp.array(((0.1, 1.0),) * self.control_dim, dtype=float)
-
-        drone_size = 0.2
-
-        # Declare the reference drone.
-        self.drone = Drone(
-            "drone",
-            self.fps,
-            (self.control_point_data_count, self.control_dim),
-            size=drone_size,
-        )
-
-        # Declare the drone's rollouts.
-        # These allow to run parallel simulations in order to find the best
-        # trajectory at each control point.
-        self.rollout_count = num_rollouts
-        self.rollout_step_count = self.control_point_step * self.control_point_count
-        self.rollouts = Drone(
-            "rollout",
-            self.fps,
-            (self.control_point_data_count, self.control_dim),
-            variation_count=self.rollout_count,
-            size=drone_size,
-            requires_grad=True,
-            state_count=self.rollout_step_count * self.sim_substep_count,
-        )
-
-        self.seed = wp.zeros(1, dtype=int)
-        self.rollout_costs = wp.zeros(self.rollout_count, dtype=float, requires_grad=True)
-
-        # Use the Euler integrator for stepping through the simulation.
-        self.integrator = wp.sim.SemiImplicitIntegrator()
-
-        self.optimizer = wp.optim.SGD(
-            [self.rollouts.trajectories.flatten()],
-            lr=1e-2,
-            nesterov=False,
-            momentum=0.0,
-        )
-
-        self.tape = None
-
-        if stage_path:
-            if not headless:
-                self.renderer = wp.sim.render.SimRendererOpenGL(self.drone.model, stage_path, fps=self.fps)
-            else:
-                # Helper to render the physics scene as a USD file.
-                self.renderer = wp.sim.render.SimRenderer(self.drone.model, stage_path, fps=self.fps)
-
-            if isinstance(self.renderer, warp.sim.render.SimRendererUsd):
-                from pxr import UsdGeom
-
-                # Remove the default drone geometries.
-                drone_root_prim = self.renderer.stage.GetPrimAtPath("/root/body_0_drone_0")
-                for prim in drone_root_prim.GetChildren():
-                    self.renderer.stage.RemovePrim(prim.GetPath())
-
-                # Add a reference to the drone geometry.
-                drone_prim = self.renderer.stage.OverridePrim(f"{drone_root_prim.GetPath()}/crazyflie")
-                drone_prim.GetReferences().AddReference(drone_path)
-                drone_xform = UsdGeom.Xform(drone_prim)
-                drone_xform.AddTranslateOp().Set((0.0, -0.05, 0.0))
-                drone_xform.AddRotateYOp().Set(45.0)
-                drone_xform.AddScaleOp().Set((drone_size * 20.0,) * 3)
-
-                # Get the propellers to spin
-                for turning_direction in ("cw", "ccw"):
-                    spin = 100.0 * 360.0 * self.num_frames / self.fps
-                    spin = spin if turning_direction == "ccw" else -spin
-                    for side in ("back", "front"):
-                        prop_prim = self.renderer.stage.OverridePrim(
-                            f"{drone_prim.GetPath()}/propeller_{turning_direction}_{side}"
-                        )
-                        prop_xform = UsdGeom.Xform(prop_prim)
-                        rot = prop_xform.AddRotateYOp()
-                        rot.Set(0.0, 0.0)
-                        rot.Set(spin, self.num_frames)
-        else:
-            self.renderer = None
-
-        self.use_cuda_graph = wp.get_device().is_cuda
-        self.optim_graph = None
-
-        self.render_rollouts = render_rollouts
-        self.verbose = verbose
-
-    def update_drone(self, drone: Drone) -> None:
-        drone.state.clear_forces()
-
-        wp.launch(
-            interpolate_control_linear,
-            dim=(
-                drone.variation_count,
-                self.control_dim,
-            ),
-            inputs=(
-                drone.trajectories,
-                self.control_dofs,
-                self.control_gains,
-                drone.sim_tick / (self.sim_substep_count * self.control_point_step),
-                self.control_dim,
-            ),
-            outputs=(drone.control.prop_controls,),
-        )
-
-        wp.launch(
-            compute_prop_wrenches,
-            dim=len(drone.props),
-            inputs=(
-                drone.props,
-                drone.control.prop_controls,
-                drone.state.body_q,
-                drone.model.body_com,
-            ),
-            outputs=(drone.state.body_f,),
-        )
-
-        self.integrator.simulate(
-            drone.model,
-            drone.state,
-            drone.next_state,
-            self.sim_dt,
-            drone.control,
-        )
-
-        drone.sim_tick += 1
-
-    def forward(self):
-        # Evaluate the rollouts with their costs.
-        self.rollouts.sim_tick = 0
-        self.rollout_costs.zero_()
-        wp.launch(
-            replicate_states,
-            dim=self.rollout_count,
-            inputs=(
-                self.drone.state.body_q,
-                self.drone.state.body_qd,
-                self.drone.body_count,
-            ),
-            outputs=(
-                self.rollouts.state.body_q,
-                self.rollouts.state.body_qd,
-            ),
-        )
-
-        for i in range(self.rollout_step_count):
-            for _ in range(self.sim_substep_count):
-                self.update_drone(self.rollouts)
-
-            wp.launch(
-                drone_cost,
-                dim=self.rollout_count,
-                inputs=(
-                    self.rollouts.state.body_q,
-                    self.rollouts.state.body_qd,
-                    self.current_target,
-                    self.rollouts.control.prop_controls,
-                    i,
-                    self.rollout_step_count,
-                    1e3,
-                ),
-                outputs=(self.rollout_costs,),
-            )
-            wp.launch(
-                collision_cost,
-                dim=(
-                    self.rollout_count,
-                    self.rollouts.collider_count,
-                ),
-                inputs=(
-                    self.rollouts.state.body_q,
-                    self.rollouts.colliders,
-                    self.rollouts.model.shape_transform,
-                    self.rollouts.model.shape_geo,
-                    self.rollouts.collision_radius,
-                    1e4,
-                ),
-                outputs=(self.rollout_costs,),
-            )
-
-    def step_optimizer(self):
-        if self.optim_graph is None:
-            self.tape = wp.Tape()
-            with self.tape:
-                self.forward()
-            self.rollout_costs.grad.fill_(1.0)
-            self.tape.backward()
-        else:
-            wp.capture_launch(self.optim_graph)
-
-        self.optimizer.step([self.rollouts.trajectories.grad.flatten()])
-
-        # Enforce limits on the control points.
-        wp.launch(
-            enforce_control_limits,
-            dim=self.rollouts.trajectories.shape,
-            inputs=(self.control_limits,),
-            outputs=(self.rollouts.trajectories,),
-        )
-        self.tape.zero()
-
-    def step(self):
-        if self.frame % int(self.num_frames / len(self.targets)) == 0:
-            if self.verbose:
-                print(f"Choosing new flight target: {self.target_idx + 1}")
-
-            self.target_idx += 1
-            self.target_idx %= len(self.targets)
-
-            # Assign the new target to the current target array.
-            self.current_target.assign([self.targets[self.target_idx]])
-
-        if self.use_cuda_graph and self.optim_graph is None:
-            with wp.ScopedCapture() as capture:
-                self.tape = wp.Tape()
-                with self.tape:
-                    self.forward()
-                self.rollout_costs.grad.fill_(1.0)
-                self.tape.backward()
-            self.optim_graph = capture.graph
-
-        # Sample control waypoints around the nominal trajectory.
-        noise_scale = 0.15
-        wp.launch(
-            sample_gaussian,
-            dim=(
-                self.rollouts.trajectories.shape[0] - 1,
-                self.rollouts.trajectories.shape[1],
-                self.rollouts.trajectories.shape[2],
-            ),
-            inputs=(
-                self.drone.trajectories,
-                noise_scale,
-                self.control_point_data_count,
-                self.control_dim,
-                self.control_limits,
-                self.seed,
-            ),
-            outputs=(self.rollouts.trajectories,),
-        )
-
-        wp.launch(
-            increment_seed,
-            dim=1,
-            inputs=(),
-            outputs=(self.seed,),
-        )
-
-        for _ in range(self.optim_step_count):
-            self.step_optimizer()
-
-        # Pick the best trajectory.
-        wp.synchronize()
-        lowest_cost_id = np.argmin(self.rollout_costs.numpy())
-        wp.launch(
-            pick_best_trajectory,
-            dim=(
-                self.control_point_data_count,
-                self.control_dim,
-            ),
-            inputs=(
-                self.rollouts.trajectories,
-                lowest_cost_id,
-            ),
-            outputs=(self.drone.trajectories,),
-        )
-        self.rollouts.trajectories[-1].assign(self.drone.trajectories[0])
-
-        # Simulate the drone.
-        self.drone.sim_tick = 0
-        for _ in range(self.sim_substep_count):
-            self.update_drone(self.drone)
-
-            # Swap the drone's states.
-            (self.drone.states[0], self.drone.states[1]) = (self.drone.states[1], self.drone.states[0])
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        self.renderer.begin_frame(self.frame / self.fps)
-        self.renderer.render(self.drone.state)
-
-        # Render a sphere as the current target.
-        self.renderer.render_sphere(
-            "target",
-            self.targets[self.target_idx],
-            wp.quat_identity(),
-            0.05,
-            color=(1.0, 0.0, 0.0),
-        )
-
-        # Render the rollout trajectories.
-        if self.render_rollouts:
-            costs = self.rollout_costs.numpy()
-
-            positions = np.array([x.body_q.numpy()[:, :3] for x in self.rollouts.states])
-
-            min_cost = np.min(costs)
-            max_cost = np.max(costs)
-            for i in range(self.rollout_count):
-                # Flip colors, so red means best trajectory, blue worst.
-                color = wp.render.bourke_color_map(-max_cost, -min_cost, -costs[i])
-                self.renderer.render_line_strip(
-                    name=f"rollout_{i}",
-                    vertices=positions[:, i],
-                    color=color,
-                    radius=0.001,
-                )
-
-        self.renderer.end_frame()
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_drone.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--num_frames", type=int, default=360, help="Total number of frames.")
-    parser.add_argument("--num_rollouts", type=int, default=16, help="Number of drone rollouts.")
-    parser.add_argument(
-        "--drone_path",
-        type=str,
-        default=os.path.join(warp.examples.get_asset_directory(), "crazyflie.usd"),
-        help="Path to the USD file to use as the reference for the drone prim in the output stage.",
-    )
-    parser.add_argument("--render_rollouts", action="store_true", help="Add rollout trajectories to the output stage.")
-    parser.add_argument(
-        "--headless",
-        action="store_true",
-        help="Run in headless mode, suppressing the opening of any graphical windows.",
-    )
-    parser.add_argument("--verbose", action="store_true", help="Print out additional status messages during execution.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(
-            stage_path=args.stage_path,
-            verbose=args.verbose,
-            render_rollouts=args.render_rollouts,
-            drone_path=args.drone_path,
-            num_frames=args.num_frames,
-            num_rollouts=args.num_rollouts,
-            headless=args.headless,
-        )
-        for _i in range(args.num_frames):
-            example.step()
-            example.render()
-            example.frame += 1
-
-            loss = np.min(example.rollout_costs.numpy())
-            print(f"[{example.frame:3d}/{example.num_frames}] loss={loss:.8f}")
-
-        if example.renderer is not None:
-            example.renderer.save()
diff --git a/warp/examples/optim/example_inverse_kinematics.py b/warp/examples/optim/example_inverse_kinematics.py
deleted file mode 100644
index 551d542f..00000000
--- a/warp/examples/optim/example_inverse_kinematics.py
+++ /dev/null
@@ -1,182 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Sim Rigid Kinematics
-#
-# Tests rigid body forward and backwards kinematics through the
-# wp.sim.eval_ik() and wp.sim.eval_fk() methods.
-#
-###########################################################################
-
-import numpy as np
-
-import warp as wp
-import warp.sim
-import warp.sim.render
-
-TARGET = wp.constant(wp.vec3(2.0, 1.0, 0.0))
-
-
-@wp.kernel
-def compute_loss(body_q: wp.array(dtype=wp.transform), body_index: int, loss: wp.array(dtype=float)):
-    x = wp.transform_get_translation(body_q[body_index])
-
-    delta = x - TARGET
-    loss[0] = wp.dot(delta, delta)
-
-
-@wp.kernel
-def step_kernel(x: wp.array(dtype=float), grad: wp.array(dtype=float), alpha: float):
-    tid = wp.tid()
-
-    # gradient descent step
-    x[tid] = x[tid] - grad[tid] * alpha
-
-
-class Example:
-    def __init__(self, stage_path="example_inverse_kinematics.usd", verbose=False):
-        self.verbose = verbose
-
-        fps = 60
-        self.frame_dt = 1.0 / fps
-        self.render_time = 0.0
-
-        builder = wp.sim.ModelBuilder()
-        builder.add_articulation()
-
-        chain_length = 4
-        chain_width = 1.0
-
-        for i in range(chain_length):
-            if i == 0:
-                parent = -1
-                parent_joint_xform = wp.transform([0.0, 0.0, 0.0], wp.quat_identity())
-            else:
-                parent = builder.joint_count - 1
-                parent_joint_xform = wp.transform([chain_width, 0.0, 0.0], wp.quat_identity())
-
-            # create body
-            b = builder.add_body(origin=wp.transform([i, 0.0, 0.0], wp.quat_identity()), armature=0.1)
-
-            builder.add_joint_revolute(
-                parent=parent,
-                child=b,
-                axis=(0.0, 0.0, 1.0),
-                parent_xform=parent_joint_xform,
-                child_xform=wp.transform_identity(),
-                limit_lower=-np.deg2rad(60.0),
-                limit_upper=np.deg2rad(60.0),
-                target_ke=0.0,
-                target_kd=0.0,
-                limit_ke=30.0,
-                limit_kd=30.0,
-            )
-
-            if i == chain_length - 1:
-                # create end effector
-                builder.add_shape_sphere(pos=wp.vec3(0.0, 0.0, 0.0), radius=0.1, density=10.0, body=b)
-
-            else:
-                # create shape
-                builder.add_shape_box(
-                    pos=wp.vec3(chain_width * 0.5, 0.0, 0.0), hx=chain_width * 0.5, hy=0.1, hz=0.1, density=10.0, body=b
-                )
-
-        # finalize model
-        self.model = builder.finalize()
-        self.model.ground = False
-
-        self.state = self.model.state()
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path, scaling=50.0)
-        else:
-            self.renderer = None
-
-        # optimization variables
-        self.loss = wp.zeros(1, dtype=float)
-
-        self.model.joint_q.requires_grad = True
-        self.state.body_q.requires_grad = True
-        self.loss.requires_grad = True
-
-        self.train_rate = 0.01
-
-    def forward(self):
-        wp.sim.eval_fk(self.model, self.model.joint_q, self.model.joint_qd, None, self.state)
-
-        wp.launch(compute_loss, dim=1, inputs=[self.state.body_q, len(self.state.body_q) - 1, self.loss])
-
-    def step(self):
-        with wp.ScopedTimer("step"):
-            tape = wp.Tape()
-            with tape:
-                self.forward()
-            tape.backward(loss=self.loss)
-
-            if self.verbose:
-                print(f"loss: {self.loss}")
-                print(f"joint_grad: {tape.gradients[self.model.joint_q]}")
-
-            # gradient descent
-            wp.launch(
-                step_kernel,
-                dim=len(self.model.joint_q),
-                inputs=[self.model.joint_q, tape.gradients[self.model.joint_q], self.train_rate],
-            )
-
-            # zero gradients
-            tape.zero()
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            self.renderer.begin_frame(self.render_time)
-            self.renderer.render(self.state)
-            self.renderer.render_sphere(
-                name="target", pos=TARGET, rot=wp.quat_identity(), radius=0.1, color=(1.0, 0.0, 0.0)
-            )
-            self.renderer.end_frame()
-            self.render_time += self.frame_dt
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_inverse_kinematics.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--train_iters", type=int, default=512, help="Total number of training iterations.")
-    parser.add_argument("--verbose", action="store_true", help="Print out additional status messages during execution.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path, verbose=args.verbose)
-
-        for _ in range(args.train_iters):
-            example.step()
-            example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/optim/example_inverse_kinematics_torch.py b/warp/examples/optim/example_inverse_kinematics_torch.py
deleted file mode 100644
index cb59ceec..00000000
--- a/warp/examples/optim/example_inverse_kinematics_torch.py
+++ /dev/null
@@ -1,191 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Sim Rigid Kinematics
-#
-# Tests rigid body forward and backwards kinematics through the
-# wp.sim.eval_ik() and wp.sim.eval_fk() methods. Shows how to connect
-# gradients from Warp to PyTorch, through custom autograd nodes.
-#
-###########################################################################
-
-import numpy as np
-import torch
-
-import warp as wp
-import warp.sim
-import warp.sim.render
-
-
-class ForwardKinematics(torch.autograd.Function):
-    @staticmethod
-    def forward(ctx, joint_q, joint_qd, model):
-        ctx.tape = wp.Tape()
-        ctx.model = model
-        ctx.joint_q = wp.from_torch(joint_q)
-        ctx.joint_qd = wp.from_torch(joint_qd)
-
-        # allocate output
-        ctx.state = model.state()
-
-        with ctx.tape:
-            wp.sim.eval_fk(model, ctx.joint_q, ctx.joint_qd, None, ctx.state)
-
-        return (wp.to_torch(ctx.state.body_q), wp.to_torch(ctx.state.body_qd))
-
-    @staticmethod
-    def backward(ctx, adj_body_q, adj_body_qd):
-        # map incoming Torch grads to our output variables
-        ctx.state.body_q.grad = wp.from_torch(adj_body_q, dtype=wp.transform)
-        ctx.state.body_qd.grad = wp.from_torch(adj_body_qd, dtype=wp.spatial_vector)
-
-        ctx.tape.backward()
-
-        # return adjoint w.r.t. inputs
-        return (wp.to_torch(ctx.tape.gradients[ctx.joint_q]), wp.to_torch(ctx.tape.gradients[ctx.joint_qd]), None)
-
-
-class Example:
-    def __init__(self, stage_path="example_inverse_kinematics_torch.usd", verbose=False):
-        self.verbose = verbose
-
-        fps = 60
-        self.frame_dt = 1.0 / fps
-        self.render_time = 0.0
-
-        builder = wp.sim.ModelBuilder()
-        builder.add_articulation()
-
-        chain_length = 4
-        chain_width = 1.0
-
-        for i in range(chain_length):
-            if i == 0:
-                parent = -1
-                parent_joint_xform = wp.transform([0.0, 0.0, 0.0], wp.quat_identity())
-            else:
-                parent = builder.joint_count - 1
-                parent_joint_xform = wp.transform([chain_width, 0.0, 0.0], wp.quat_identity())
-
-            # create body
-            b = builder.add_body(origin=wp.transform([i, 0.0, 0.0], wp.quat_identity()), armature=0.1)
-
-            builder.add_joint_revolute(
-                parent=parent,
-                child=b,
-                axis=wp.vec3(0.0, 0.0, 1.0),
-                parent_xform=parent_joint_xform,
-                child_xform=wp.transform_identity(),
-                limit_lower=-np.deg2rad(60.0),
-                limit_upper=np.deg2rad(60.0),
-                target_ke=0.0,
-                target_kd=0.0,
-                limit_ke=30.0,
-                limit_kd=30.0,
-            )
-
-            if i == chain_length - 1:
-                # create end effector
-                builder.add_shape_sphere(pos=wp.vec3(0.0, 0.0, 0.0), radius=0.1, density=10.0, body=b)
-
-            else:
-                # create shape
-                builder.add_shape_box(
-                    pos=wp.vec3(chain_width * 0.5, 0.0, 0.0), hx=chain_width * 0.5, hy=0.1, hz=0.1, density=10.0, body=b
-                )
-
-        # finalize model
-        self.model = builder.finalize()
-        self.model.ground = False
-
-        self.torch_device = wp.device_to_torch(wp.get_device())
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path, scaling=50.0)
-        else:
-            self.renderer = None
-
-        self.target = torch.from_numpy(np.array((2.0, 1.0, 0.0))).to(self.torch_device)
-
-        self.body_q = None
-        self.body_qd = None
-
-        # optimization variable
-        self.joint_q = torch.zeros(len(self.model.joint_q), requires_grad=True, device=self.torch_device)
-        self.joint_qd = torch.zeros(len(self.model.joint_qd), requires_grad=True, device=self.torch_device)
-
-        self.train_rate = 0.01
-
-    def forward(self):
-        (self.body_q, self.body_qd) = ForwardKinematics.apply(self.joint_q, self.joint_qd, self.model)
-        self.loss = torch.norm(self.body_q[self.model.body_count - 1][0:3] - self.target) ** 2.0
-
-    def step(self):
-        with wp.ScopedTimer("step"):
-            self.forward()
-            self.loss.backward()
-
-            if self.verbose:
-                print(f"loss: {self.loss}")
-                print(f"loss: {self.joint_q.grad}")
-
-            with torch.no_grad():
-                self.joint_q -= self.joint_q.grad * self.train_rate
-                self.joint_q.grad.zero_()
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            s = self.model.state()
-            s.body_q = wp.from_torch(self.body_q, dtype=wp.transform, requires_grad=False)
-            s.body_qd = wp.from_torch(self.body_qd, dtype=wp.spatial_vector, requires_grad=False)
-
-            self.renderer.begin_frame(self.render_time)
-            self.renderer.render(s)
-            self.renderer.render_sphere(
-                name="target", pos=self.target, rot=wp.quat_identity(), radius=0.1, color=(1.0, 0.0, 0.0)
-            )
-            self.renderer.end_frame()
-            self.render_time += self.frame_dt
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_inverse_kinematics_torch.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--train_iters", type=int, default=512, help="Total number of training iterations.")
-    parser.add_argument("--verbose", action="store_true", help="Print out additional status messages during execution.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path, verbose=args.verbose)
-
-        for _ in range(args.train_iters):
-            example.step()
-            example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/optim/example_softbody_properties.py b/warp/examples/optim/example_softbody_properties.py
deleted file mode 100644
index 1b0cede7..00000000
--- a/warp/examples/optim/example_softbody_properties.py
+++ /dev/null
@@ -1,400 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2025 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example FEM Bounce
-#
-# Shows how to use Warp to optimize for the material parameters of a soft body,
-# such that it bounces off the wall and floor in order to hit a target.
-#
-# This example uses the built-in wp.Tape() object to compute gradients of
-# the distance to target (loss) w.r.t the material parameters, followed by
-# a simple gradient-descent optimization step.
-#
-###########################################################################
-
-import numpy as np
-
-import warp as wp
-import warp.optim
-import warp.sim
-import warp.sim.render
-
-
-@wp.kernel
-def assign_param(params: wp.array(dtype=wp.float32), tet_materials: wp.array2d(dtype=wp.float32)):
-    tid = wp.tid()
-    params_idx = 2 * wp.tid() % params.shape[0]
-    tet_materials[tid, 0] = params[params_idx]
-    tet_materials[tid, 1] = params[params_idx + 1]
-
-
-@wp.kernel
-def com_kernel(particle_q: wp.array(dtype=wp.vec3), com: wp.array(dtype=wp.vec3)):
-    tid = wp.tid()
-    point = particle_q[tid]
-    a = point / wp.float32(particle_q.shape[0])
-
-    # Atomically add the point coordinates to the accumulator
-    wp.atomic_add(com, 0, a)
-
-
-@wp.kernel
-def loss_kernel(
-    target: wp.vec3,
-    com: wp.array(dtype=wp.vec3),
-    pos_error: wp.array(dtype=float),
-    loss: wp.array(dtype=float),
-):
-    diff = com[0] - target
-    pos_error[0] = wp.dot(diff, diff)
-    norm = pos_error[0]
-    loss[0] = norm
-
-
-@wp.kernel
-def enforce_constraint_kernel(lower_bound: wp.float32, upper_bound: wp.float32, x: wp.array(dtype=wp.float32)):
-    tid = wp.tid()
-    if x[tid] < lower_bound:
-        x[tid] = lower_bound
-    elif x[tid] > upper_bound:
-        x[tid] = upper_bound
-
-
-class Example:
-    def __init__(
-        self,
-        stage_path="example_softbody_properties.usd",
-        material_behavior="anisotropic",
-        verbose=False,
-    ):
-        self.verbose = verbose
-        self.material_behavior = material_behavior
-
-        # seconds
-        sim_duration = 1.0
-
-        # control frequency
-        fps = 60
-        self.frame_dt = 1.0 / fps
-        frame_steps = int(sim_duration / self.frame_dt)
-
-        # sim frequency
-        self.sim_substeps = 16
-        self.sim_steps = frame_steps * self.sim_substeps
-        self.sim_dt = self.frame_dt / self.sim_substeps
-
-        self.iter = 0
-        self.render_time = 0.0
-
-        self.train_rate = 1e7
-
-        self.losses = []
-
-        self.hard_lower_bound = wp.float32(500.0)
-        self.hard_upper_bound = wp.float32(4e6)
-
-        # Create FEM model.
-        self.cell_dim = 2
-        self.cell_size = 0.1
-        center = self.cell_size * self.cell_dim * 0.5
-        self.grid_origin = wp.vec3(-0.5, 1.0, -center)
-        self.create_model()
-
-        self.integrator = wp.sim.SemiImplicitIntegrator()
-
-        self.target = wp.vec3(-1.0, 1.5, 0.0)
-        # Initialize material parameters
-        if self.material_behavior == "anisotropic":
-            # Different Lame parameters for each tet
-            self.material_params = wp.array(
-                self.model.tet_materials.numpy()[:, :2].flatten(),
-                dtype=wp.float32,
-                requires_grad=True,
-            )
-        else:
-            # Same Lame parameters for all tets
-            self.material_params = wp.array(
-                self.model.tet_materials.numpy()[0, :2].flatten(),
-                dtype=wp.float32,
-                requires_grad=True,
-            )
-
-        self.optimizer = wp.optim.SGD(
-            [self.material_params],
-            lr=self.train_rate,
-            nesterov=False,
-        )
-
-        self.com = wp.array([wp.vec3(0.0, 0.0, 0.0)], dtype=wp.vec3, requires_grad=True)
-        self.pos_error = wp.zeros(1, dtype=wp.float32, requires_grad=True)
-        self.loss = wp.zeros(1, dtype=wp.float32, requires_grad=True)
-
-        # allocate sim states for trajectory
-        self.states = []
-        for _i in range(self.sim_steps + 1):
-            self.states.append(self.model.state())
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path, scaling=1.0)
-        else:
-            self.renderer = None
-
-        # capture forward/backward passes
-        self.use_cuda_graph = wp.get_device().is_cuda
-        if self.use_cuda_graph:
-            with wp.ScopedCapture() as capture:
-                self.tape = wp.Tape()
-                with self.tape:
-                    self.forward()
-                self.tape.backward(self.loss)
-            self.graph = capture.graph
-
-    def create_model(self):
-        builder = wp.sim.ModelBuilder()
-        builder.default_particle_radius = 0.0005
-
-        total_mass = 0.2
-        num_particles = (self.cell_dim + 1) ** 3
-        particle_mass = total_mass / num_particles
-        particle_density = particle_mass / (self.cell_size**3)
-        if self.verbose:
-            print(f"Particle density: {particle_density}")
-
-        young_mod = 1.5 * 1e4
-        poisson_ratio = 0.3
-        k_mu = 0.5 * young_mod / (1.0 + poisson_ratio)
-        k_lambda = young_mod * poisson_ratio / ((1 + poisson_ratio) * (1 - 2 * poisson_ratio))
-
-        builder.add_soft_grid(
-            pos=self.grid_origin,
-            rot=wp.quat_identity(),
-            vel=wp.vec3(5.0, -5.0, 0.0),
-            dim_x=self.cell_dim,
-            dim_y=self.cell_dim,
-            dim_z=self.cell_dim,
-            cell_x=self.cell_size,
-            cell_y=self.cell_size,
-            cell_z=self.cell_size,
-            density=particle_density,
-            k_mu=k_mu,
-            k_lambda=k_lambda,
-            k_damp=0.0,
-            tri_ke=1e-4,
-            tri_ka=1e-4,
-            tri_kd=1e-4,
-            tri_drag=0.0,
-            tri_lift=0.0,
-            fix_bottom=False,
-        )
-
-        ke = 1.0e3
-        kf = 0.0
-        kd = 1.0e0
-        mu = 0.2
-        builder.add_shape_box(
-            body=-1,
-            pos=wp.vec3(2.0, 1.0, 0.0),
-            hx=0.25,
-            hy=1.0,
-            hz=1.0,
-            ke=ke,
-            kf=kf,
-            kd=kd,
-            mu=mu,
-        )
-
-        # use `requires_grad=True` to create a model for differentiable simulation
-        self.model = builder.finalize(requires_grad=True)
-        self.model.ground = True
-
-        self.model.soft_contact_ke = ke
-        self.model.soft_contact_kf = kf
-        self.model.soft_contact_kd = kd
-        self.model.soft_contact_mu = mu
-        self.model.soft_contact_margin = 0.001
-        self.model.soft_contact_restitution = 1.0
-
-    def forward(self):
-        wp.launch(
-            kernel=assign_param,
-            dim=self.model.tet_count,
-            inputs=(self.material_params,),
-            outputs=(self.model.tet_materials,),
-        )
-        # run control loop
-        for i in range(self.sim_steps):
-            wp.sim.collide(self.model, self.states[i])
-            self.states[i].clear_forces()
-
-            self.integrator.simulate(self.model, self.states[i], self.states[i + 1], self.sim_dt)
-
-        # Update loss
-        # Compute the center of mass for the last time step.
-        wp.launch(
-            kernel=com_kernel,
-            dim=self.model.particle_count,
-            inputs=(self.states[-1].particle_q,),
-            outputs=(self.com,),
-        )
-
-        # calculate loss
-        wp.launch(
-            kernel=loss_kernel,
-            dim=1,
-            inputs=(
-                self.target,
-                self.com,
-            ),
-            outputs=(self.pos_error, self.loss),
-        )
-
-        return self.loss
-
-    def step(self):
-        with wp.ScopedTimer("step"):
-            if self.use_cuda_graph:
-                wp.capture_launch(self.graph)
-            else:
-                self.tape = wp.Tape()
-                with self.tape:
-                    self.forward()
-                self.tape.backward(loss=self.loss)
-
-            if self.verbose:
-                self.log_step()
-
-            self.optimizer.step([self.material_params.grad])
-
-            wp.launch(
-                kernel=enforce_constraint_kernel,
-                dim=self.material_params.shape[0],
-                inputs=(
-                    self.hard_lower_bound,
-                    self.hard_upper_bound,
-                ),
-                outputs=(self.material_params,),
-            )
-
-            self.losses.append(self.loss.numpy()[0])
-
-            # clear grads for next iteration
-            self.tape.zero()
-            self.loss.zero_()
-            self.com.zero_()
-            self.pos_error.zero_()
-
-            self.iter = self.iter + 1
-
-    def log_step(self):
-        x = self.material_params.numpy().reshape(-1, 2)
-        x_grad = self.material_params.grad.numpy().reshape(-1, 2)
-
-        print(f"Iter: {self.iter} Loss: {self.loss.numpy()[0]}")
-
-        print(f"Pos error: {np.sqrt(self.pos_error.numpy()[0])}")
-
-        print(
-            f"Max Mu: {np.max(x[:, 0])}, Min Mu: {np.min(x[:, 0])}, "
-            f"Max Lambda: {np.max(x[:, 1])}, Min Lambda: {np.min(x[:, 1])}"
-        )
-
-        print(
-            f"Max Mu Grad: {np.max(x_grad[:, 0])}, Min Mu Grad: {np.min(x_grad[:, 0])}, "
-            f"Max Lambda Grad: {np.max(x_grad[:, 1])}, Min Lambda Grad: {np.min(x_grad[:, 1])}"
-        )
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            # draw trajectory
-            traj_verts = [np.mean(self.states[0].particle_q.numpy(), axis=0).tolist()]
-            for i in range(0, self.sim_steps, self.sim_substeps):
-                traj_verts.append(np.mean(self.states[i].particle_q.numpy(), axis=0).tolist())
-
-                self.renderer.begin_frame(self.render_time)
-                self.renderer.render(self.states[i])
-                self.renderer.render_box(
-                    pos=self.target,
-                    rot=wp.quat_identity(),
-                    extents=(0.1, 0.1, 0.1),
-                    name="target",
-                    color=(0.0, 0.0, 0.0),
-                )
-                self.renderer.render_line_strip(
-                    vertices=traj_verts,
-                    color=wp.render.bourke_color_map(0.0, self.losses[0], self.losses[-1]),
-                    radius=0.02,
-                    name=f"traj_{self.iter - 1}",
-                )
-                self.renderer.end_frame()
-
-                from pxr import Gf, UsdGeom
-
-                particles_prim = self.renderer.stage.GetPrimAtPath("/root/particles")
-                particles = UsdGeom.Points.Get(self.renderer.stage, particles_prim.GetPath())
-                particles.CreateDisplayColorAttr().Set([Gf.Vec3f(1.0, 1.0, 1.0)], time=self.renderer.time)
-
-                self.render_time += self.frame_dt
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_softbody_properties.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument(
-        "--train_iters",
-        type=int,
-        default=300,
-        help="Total number of training iterations.",
-    )
-    parser.add_argument(
-        "--material_behavior",
-        default="anisotropic",
-        choices=["anisotropic", "isotropic"],
-        help="Set material behavior to be Anisotropic or Isotropic.",
-    )
-    parser.add_argument(
-        "--verbose",
-        action="store_true",
-        help="Print out additional status messages during execution.",
-    )
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(
-            stage_path=args.stage_path,
-            material_behavior=args.material_behavior,
-            verbose=args.verbose,
-        )
-
-        # replay and optimize
-        for i in range(args.train_iters):
-            example.step()
-            if i == 0 or i % 50 == 0 or i == args.train_iters - 1:
-                example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/optim/example_spring_cage.py b/warp/examples/optim/example_spring_cage.py
deleted file mode 100644
index c6e9390a..00000000
--- a/warp/examples/optim/example_spring_cage.py
+++ /dev/null
@@ -1,245 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2023 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Diff Sim Spring Cage
-#
-# A single particle is attached with springs to each point of a cage.
-# The objective is to optimize the rest length of the springs in order
-# for the particle to be pulled towards a target position.
-#
-###########################################################################
-
-import numpy as np
-
-import warp as wp
-import warp.sim
-import warp.sim.render
-
-
-@wp.kernel
-def compute_loss_kernel(
-    pos: wp.array(dtype=wp.vec3),
-    target_pos: wp.vec3,
-    loss: wp.array(dtype=float),
-):
-    loss[0] = wp.length_sq(pos[0] - target_pos)
-
-
-@wp.kernel(enable_backward=False)
-def apply_gradient_kernel(
-    spring_rest_lengths_grad: wp.array(dtype=float),
-    train_rate: float,
-    spring_rest_lengths: wp.array(dtype=float),
-):
-    tid = wp.tid()
-
-    spring_rest_lengths[tid] -= spring_rest_lengths_grad[tid] * train_rate
-
-
-class Example:
-    def __init__(self, stage_path="example_spring_cage.usd", num_frames=30, train_iters=25):
-        # Number of frames per second.
-        self.fps = 30
-
-        # Duration of a single simulation iteration in number of frames.
-        self.num_frames = num_frames
-
-        # Number of simulation steps to take per frame.
-        self.sim_substep_count = 1
-
-        # Delta time between each simulation substep.
-        self.sim_dt = 1.0 / (self.fps * self.sim_substep_count)
-
-        # Target position that we want the main particle to reach by optimising
-        # the rest lengths of the springs.
-        self.target_pos = (0.125, 0.25, 0.375)
-
-        # Number of training iterations.
-        self.train_iters = train_iters
-
-        # Factor by which the rest lengths of the springs are adjusted after each
-        # iteration, relatively to the corresponding gradients. Lower values
-        # converge more slowly but have less chances to miss the local minimum.
-        self.train_rate = 0.5
-
-        # Initialize the helper to build a physics scene.
-        builder = wp.sim.ModelBuilder()
-
-        # Define the main particle at the origin.
-        particle_mass = 1.0
-        builder.add_particle((0.0, 0.0, 0.0), (0.0, 0.0, 0.0), particle_mass)
-
-        # Define the cage made of points that will be pulling our main particle
-        # using springs.
-        # fmt: off
-        builder.add_particle((-0.7,  0.8,  0.2), (0.0, 0.0, 0.0), 0.0)
-        builder.add_particle(( 0.0,  0.2,  1.1), (0.0, 0.0, 0.0), 0.0)
-        builder.add_particle(( 0.1,  0.1, -1.2), (0.0, 0.0, 0.0), 0.0)
-        builder.add_particle(( 0.6,  0.4,  0.4), (0.0, 0.0, 0.0), 0.0)
-        builder.add_particle(( 0.7, -0.9, -0.2), (0.0, 0.0, 0.0), 0.0)
-        builder.add_particle((-0.8, -0.8,  0.1), (0.0, 0.0, 0.0), 0.0)
-        builder.add_particle((-0.9,  0.2, -0.8), (0.0, 0.0, 0.0), 0.0)
-        builder.add_particle(( 1.0,  0.4, -0.1), (0.0, 0.0, 0.0), 0.0)
-        # fmt: on
-
-        # Define the spring constraints between the main particle and the cage points.
-        spring_elastic_stiffness = 100.0
-        spring_elastic_damping = 10.0
-        for i in range(1, builder.particle_count):
-            builder.add_spring(0, i, spring_elastic_stiffness, spring_elastic_damping, 0)
-
-        # Build the model and set-up its properties.
-        self.model = builder.finalize(requires_grad=True)
-        self.model.gravity = np.array((0.0, 0.0, 0.0))
-        self.model.ground = False
-
-        # Use the Euler integrator for stepping through the simulation.
-        self.integrator = wp.sim.SemiImplicitIntegrator()
-
-        # Initialize a state for each simulation step.
-        self.states = tuple(self.model.state() for _ in range(self.num_frames * self.sim_substep_count + 1))
-
-        # Initialize a loss value that will represent the distance of the main
-        # particle to the target position. It needs to be defined as an array
-        # so that it can be written out by a kernel.
-        self.loss = wp.zeros(1, dtype=float, requires_grad=True)
-
-        if stage_path:
-            # Helper to render the physics scene as a USD file.
-            self.renderer = warp.sim.render.SimRenderer(self.model, stage_path, fps=self.fps, scaling=10.0)
-
-            # Allows rendering one simulation to USD every N training iterations.
-            self.render_iteration_steps = 2
-
-            # Frame number used to render the simulation iterations onto the USD file.
-            self.render_frame = 0
-        else:
-            self.renderer = None
-
-        self.use_cuda_graph = wp.get_device().is_cuda
-        if self.use_cuda_graph:
-            # Capture all the kernel launches into a CUDA graph so that they can
-            # all be run in a single graph launch, which helps with performance.
-            with wp.ScopedCapture() as capture:
-                self.tape = wp.Tape()
-                with self.tape:
-                    self.forward()
-                self.tape.backward(loss=self.loss)
-            self.graph = capture.graph
-
-    def forward(self):
-        for i in range(1, len(self.states)):
-            prev = self.states[i - 1]
-            curr = self.states[i]
-            prev.clear_forces()
-            self.integrator.simulate(
-                self.model,
-                prev,
-                curr,
-                self.sim_dt,
-            )
-
-        last_state = self.states[-1]
-        wp.launch(
-            compute_loss_kernel,
-            dim=1,
-            inputs=(
-                last_state.particle_q,
-                self.target_pos,
-            ),
-            outputs=(self.loss,),
-        )
-
-    def step(self):
-        with wp.ScopedTimer("step"):
-            if self.use_cuda_graph:
-                wp.capture_launch(self.graph)
-            else:
-                self.tape = wp.Tape()
-                with self.tape:
-                    self.forward()
-                self.tape.backward(loss=self.loss)
-
-            wp.launch(
-                apply_gradient_kernel,
-                dim=self.model.spring_count,
-                inputs=(
-                    self.model.spring_rest_length.grad,
-                    self.train_rate,
-                ),
-                outputs=(self.model.spring_rest_length,),
-            )
-
-            self.tape.zero()
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            self.renderer.begin_frame(0.0)
-            self.renderer.render_box(
-                name="target",
-                pos=self.target_pos,
-                rot=wp.quat_identity(),
-                extents=(0.1, 0.1, 0.1),
-                color=(1.0, 0.0, 0.0),
-            )
-            self.renderer.end_frame()
-
-            for frame in range(self.num_frames):
-                self.renderer.begin_frame(self.render_frame / self.fps)
-                self.renderer.render(self.states[frame * self.sim_substep_count])
-                self.renderer.end_frame()
-
-                self.render_frame += 1
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_spring_cage.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--num_frames", type=int, default=30, help="Total number of frames per training iteration.")
-    parser.add_argument("--train_iters", type=int, default=25, help="Total number of training iterations.")
-    parser.add_argument("--verbose", action="store_true", help="Print out additional status messages during execution.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path, num_frames=args.num_frames, train_iters=args.train_iters)
-
-        for iteration in range(args.train_iters):
-            example.step()
-
-            loss = example.loss.numpy()[0]
-
-            if args.verbose:
-                print(f"[{iteration:3d}] loss={loss:.8f}")
-
-            if example.renderer and (
-                iteration == example.train_iters - 1 or iteration % example.render_iteration_steps == 0
-            ):
-                example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/optim/example_trajectory.py b/warp/examples/optim/example_trajectory.py
deleted file mode 100644
index 6b88c1dc..00000000
--- a/warp/examples/optim/example_trajectory.py
+++ /dev/null
@@ -1,227 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Trajectory Optimization
-#
-# Shows how to optimize torque trajectories for a simple planar environment
-# using Warp's provided Adam optimizer.
-#
-###########################################################################
-
-import numpy as np
-
-import warp as wp
-import warp.sim
-import warp.sim.render
-from warp.optim import Adam
-
-
-@wp.kernel
-def loss_l2(
-    states: wp.array2d(dtype=wp.float32), targets: wp.array2d(dtype=wp.float32), loss: wp.array(dtype=wp.float32)
-):
-    i, j = wp.tid()
-    diff = states[i, j] - targets[i, j]
-    l = diff * diff
-    wp.atomic_add(loss, 0, l)
-
-
-@wp.kernel
-def apply_torque(torques: wp.array(dtype=wp.float32), start_index: int, body_f: wp.array(dtype=wp.spatial_vector)):
-    fx = torques[start_index + 0]
-    fz = torques[start_index + 1]
-    body_f[0] = wp.spatial_vector(0.0, 0.0, 0.0, fx, 0.0, fz)
-
-
-@wp.kernel
-def save_state(body_q: wp.array(dtype=wp.transform), write_index: int, states: wp.array2d(dtype=wp.float32)):
-    pos = wp.transform_get_translation(body_q[0])
-    states[write_index, 0] = pos[0]
-    states[write_index, 1] = pos[2]
-
-
-class Example:
-    def __init__(self, stage_path="example_trajectory.usd", verbose=False, num_frames=100):
-        self.verbose = verbose
-
-        fps = 60
-        self.frame_dt = 1.0 / fps
-        self.num_frames = num_frames
-
-        self.sim_substeps = 1
-        self.sim_dt = self.frame_dt / self.sim_substeps
-
-        self.render_time = 0.0
-
-        self.iter = 0
-
-        # add planar joints
-        builder = wp.sim.ModelBuilder(gravity=0.0)
-        builder.add_articulation()
-        b = builder.add_body(origin=wp.transform())
-        builder.add_shape_sphere(pos=wp.vec3(0.0, 0.0, 0.0), radius=0.1, density=100.0, body=b)
-
-        # compute reference trajectory
-        rad = np.linspace(0.0, np.pi * 2, self.num_frames)
-        self.ref_traj = np.stack([np.cos(rad), np.sin(rad)], axis=1)
-
-        # set initial joint configuration to first reference state
-        builder.body_q[0] = wp.transform(p=[self.ref_traj[0][0], 0.0, self.ref_traj[0][1]])
-
-        self.ref_traj = wp.array(self.ref_traj, dtype=wp.float32, requires_grad=True)
-        self.last_traj = wp.empty_like(self.ref_traj)
-
-        # finalize model
-        self.model = builder.finalize(requires_grad=True)
-
-        self.builder = builder
-        self.model.ground = False
-
-        self.dof_q = self.model.joint_coord_count
-        self.dof_qd = self.model.joint_dof_count
-        self.num_bodies = self.model.body_count
-
-        self.action_dim = 2
-        self.state_dim = 2
-
-        assert self.ref_traj.shape == (self.num_frames, self.state_dim)
-
-        self.integrator = wp.sim.SemiImplicitIntegrator()
-
-        # initial guess
-        self.actions = wp.array(
-            np.zeros(self.num_frames * self.action_dim) * 100.0, dtype=wp.float32, requires_grad=True
-        )
-
-        self.optimizer = Adam([self.actions], lr=1e2)
-        self.loss = wp.zeros(1, dtype=wp.float32, requires_grad=True)
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path, scaling=100.0)
-        else:
-            self.renderer = None
-
-        # allocate sim states for trajectory
-        self.states = []
-        for _ in range(self.num_frames + 1):
-            self.states.append(self.model.state())
-
-    def forward(self):
-        """
-        Advances the system dynamics given the rigid-body state in maximal coordinates and generalized joint torques
-        [body_q, body_qd, tau].
-        """
-
-        self.last_traj.zero_()
-
-        for i in range(self.num_frames):
-            state = self.states[i]
-
-            for _ in range(self.sim_substeps):
-                next_state = self.model.state(requires_grad=True)
-
-                wp.sim.collide(self.model, state)
-
-                # apply generalized torques to rigid body here, instead of planar joints
-                wp.launch(apply_torque, 1, inputs=[self.actions, i * self.action_dim], outputs=[state.body_f])
-
-                state = self.integrator.simulate(self.model, state, next_state, self.sim_dt)
-
-            self.states[i + 1] = state
-
-            # save state
-            wp.launch(save_state, dim=1, inputs=[self.states[i + 1].body_q, i], outputs=[self.last_traj])
-
-        # compute loss
-        wp.launch(loss_l2, dim=self.last_traj.shape, inputs=[self.last_traj, self.ref_traj], outputs=[self.loss])
-
-    def step(self):
-        """Runs a single optimizer iteration"""
-
-        with wp.ScopedTimer("step"):
-            self.loss.zero_()
-            tape = wp.Tape()
-            with tape:
-                self.forward()
-            tape.backward(loss=self.loss)
-
-            if self.verbose and (self.iter + 1) % 10 == 0:
-                print(f"Iter {self.iter + 1} Loss: {self.loss.numpy()[0]:.3f}")
-
-            assert not np.isnan(self.actions.grad.numpy()).any(), "NaN in gradient"
-
-            self.optimizer.step([self.actions.grad])
-            tape.zero()
-            self.iter = self.iter + 1
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            for i in range(self.num_frames):
-                self.renderer.begin_frame(self.render_time)
-                self.renderer.render(self.states[i + 1])
-                self.renderer.end_frame()
-                self.render_time += self.frame_dt
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_trajectory.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--num_frames", type=int, default=100, help="Total number of frames per training iteration.")
-    parser.add_argument("--train_iters", type=int, default=250, help="Total number of training iterations.")
-    parser.add_argument("--verbose", action="store_true", help="Print out additional status messages during execution.")
-    parser.add_argument(
-        "--headless",
-        action="store_true",
-        help="Run in headless mode, suppressing the opening of any graphical windows.",
-    )
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path, verbose=args.verbose, num_frames=args.num_frames)
-
-        for i in range(args.train_iters):
-            example.step()
-
-            if i % 25 == 0:
-                example.render()
-
-        if example.renderer:
-            example.renderer.save()
-
-        np_states = example.last_traj.numpy()
-        np_ref = example.ref_traj.numpy()
-
-        if not args.headless:
-            import matplotlib.pyplot as plt
-
-            plt.plot(np_ref[:, 0], np_ref[:, 1], label="Reference Trajectory")
-            plt.plot(np_states[:, 0], np_states[:, 1], label="Optimized Trajectory")
-            plt.grid()
-            plt.legend()
-            plt.axis("equal")
-            plt.show()
diff --git a/warp/examples/sim/.gitignore b/warp/examples/sim/.gitignore
deleted file mode 100644
index 298ea37f..00000000
--- a/warp/examples/sim/.gitignore
+++ /dev/null
@@ -1,2 +0,0 @@
-*.usd
-!.gitignore
\ No newline at end of file
diff --git a/warp/examples/sim/example_cartpole.py b/warp/examples/sim/example_cartpole.py
deleted file mode 100644
index b595e344..00000000
--- a/warp/examples/sim/example_cartpole.py
+++ /dev/null
@@ -1,143 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Sim Cartpole
-#
-# Shows how to set up a simulation of a rigid-body cartpole articulation
-# from a URDF using the wp.sim.ModelBuilder().
-# Note this example does not include a trained policy.
-#
-###########################################################################
-
-import math
-import os
-
-import numpy as np
-
-import warp as wp
-import warp.examples
-import warp.sim
-import warp.sim.render
-
-
-class Example:
-    def __init__(self, stage_path="example_cartpole.usd", num_envs=8):
-        self.num_envs = num_envs
-
-        articulation_builder = wp.sim.ModelBuilder()
-
-        wp.sim.parse_urdf(
-            os.path.join(warp.examples.get_asset_directory(), "cartpole.urdf"),
-            articulation_builder,
-            xform=wp.transform(wp.vec3(), wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), -math.pi * 0.5)),
-            floating=False,
-            density=100,
-            armature=0.1,
-            stiffness=0.0,
-            damping=0.0,
-            limit_ke=1.0e4,
-            limit_kd=1.0e1,
-            enable_self_collisions=False,
-        )
-
-        builder = wp.sim.ModelBuilder()
-
-        self.sim_time = 0.0
-        fps = 60
-        self.frame_dt = 1.0 / fps
-
-        self.sim_substeps = 10
-        self.sim_dt = self.frame_dt / self.sim_substeps
-
-        for i in range(self.num_envs):
-            builder.add_builder(
-                articulation_builder, xform=wp.transform(np.array((i * 2.0, 4.0, 0.0)), wp.quat_identity())
-            )
-
-            # joint initial positions
-            builder.joint_q[-3:] = [0.0, 0.3, 0.0]
-
-        # finalize model
-        self.model = builder.finalize()
-        self.model.ground = False
-
-        self.model.joint_attach_ke = 1600.0
-        self.model.joint_attach_kd = 20.0
-
-        self.integrator = wp.sim.SemiImplicitIntegrator()
-
-        self.renderer = None
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(path=stage_path, model=self.model, scaling=15.0)
-
-        self.state = self.model.state()
-
-        wp.sim.eval_fk(self.model, self.model.joint_q, self.model.joint_qd, None, self.state)
-
-        self.use_cuda_graph = wp.get_device().is_cuda
-        if self.use_cuda_graph:
-            with wp.ScopedCapture() as capture:
-                self.simulate()
-            self.graph = capture.graph
-
-    def simulate(self):
-        for _ in range(self.sim_substeps):
-            self.state.clear_forces()
-            self.state = self.integrator.simulate(self.model, self.state, self.state, self.sim_dt)
-
-    def step(self):
-        with wp.ScopedTimer("step"):
-            if self.use_cuda_graph:
-                wp.capture_launch(self.graph)
-            else:
-                self.simulate()
-        self.sim_time += self.frame_dt
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            self.renderer.begin_frame(self.sim_time)
-            self.renderer.render(self.state)
-            self.renderer.end_frame()
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_cartpole.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--num_frames", type=int, default=1200, help="Total number of frames.")
-    parser.add_argument("--num_envs", type=int, default=8, help="Total number of simulated environments.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path, num_envs=args.num_envs)
-
-        for _ in range(args.num_frames):
-            example.step()
-            example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/sim/example_cloth.py b/warp/examples/sim/example_cloth.py
deleted file mode 100644
index c9ef7527..00000000
--- a/warp/examples/sim/example_cloth.py
+++ /dev/null
@@ -1,225 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Sim Cloth
-#
-# Shows a simulation of an FEM cloth model colliding against a static
-# rigid body mesh using the wp.sim.ModelBuilder().
-#
-###########################################################################
-
-import math
-import os
-from enum import Enum
-
-import numpy as np
-from pxr import Usd, UsdGeom
-
-import warp as wp
-import warp.examples
-import warp.sim
-import warp.sim.render
-
-
-class IntegratorType(Enum):
-    EULER = "euler"
-    XPBD = "xpbd"
-    VBD = "vbd"
-
-    def __str__(self):
-        return self.value
-
-
-class Example:
-    def __init__(
-        self, stage_path="example_cloth.usd", integrator: IntegratorType = IntegratorType.EULER, height=32, width=64
-    ):
-        self.integrator_type = integrator
-
-        self.sim_height = height
-        self.sim_width = width
-
-        fps = 60
-        self.sim_substeps = 32
-        self.frame_dt = 1.0 / fps
-        self.sim_dt = self.frame_dt / self.sim_substeps
-        self.sim_time = 0.0
-        self.profiler = {}
-
-        builder = wp.sim.ModelBuilder()
-
-        if self.integrator_type == IntegratorType.EULER:
-            builder.add_cloth_grid(
-                pos=wp.vec3(0.0, 4.0, 0.0),
-                rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), math.pi * 0.5),
-                vel=wp.vec3(0.0, 0.0, 0.0),
-                dim_x=self.sim_width,
-                dim_y=self.sim_height,
-                cell_x=0.1,
-                cell_y=0.1,
-                mass=0.1,
-                fix_left=True,
-                tri_ke=1.0e3,
-                tri_ka=1.0e3,
-                tri_kd=1.0e1,
-            )
-        elif self.integrator_type == IntegratorType.XPBD:
-            builder.add_cloth_grid(
-                pos=wp.vec3(0.0, 4.0, 0.0),
-                rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), math.pi * 0.5),
-                vel=wp.vec3(0.0, 0.0, 0.0),
-                dim_x=self.sim_width,
-                dim_y=self.sim_height,
-                cell_x=0.1,
-                cell_y=0.1,
-                mass=0.1,
-                fix_left=True,
-                edge_ke=1.0e2,
-                add_springs=True,
-                spring_ke=1.0e3,
-                spring_kd=0.0,
-            )
-        else:
-            # VBD
-            builder.add_cloth_grid(
-                pos=wp.vec3(0.0, 4.0, 0.0),
-                rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), math.pi * 0.5),
-                vel=wp.vec3(0.0, 0.0, 0.0),
-                dim_x=self.sim_width,
-                dim_y=self.sim_height,
-                cell_x=0.1,
-                cell_y=0.1,
-                mass=0.1,
-                fix_left=True,
-                tri_ke=1e4,
-                tri_ka=1e4,
-                tri_kd=1e-5,
-                edge_ke=100,
-            )
-
-        usd_stage = Usd.Stage.Open(os.path.join(warp.examples.get_asset_directory(), "bunny.usd"))
-        usd_geom = UsdGeom.Mesh(usd_stage.GetPrimAtPath("/root/bunny"))
-
-        mesh_points = np.array(usd_geom.GetPointsAttr().Get())
-        mesh_indices = np.array(usd_geom.GetFaceVertexIndicesAttr().Get())
-
-        mesh = wp.sim.Mesh(mesh_points, mesh_indices)
-
-        builder.add_shape_mesh(
-            body=-1,
-            mesh=mesh,
-            pos=wp.vec3(1.0, 0.0, 1.0),
-            rot=wp.quat_from_axis_angle(wp.vec3(0.0, 1.0, 0.0), math.pi * 0.5),
-            scale=wp.vec3(2.0, 2.0, 2.0),
-            ke=1.0e2,
-            kd=1.0e2,
-            kf=1.0e1,
-        )
-
-        if self.integrator_type == IntegratorType.VBD:
-            builder.color()
-
-        self.model = builder.finalize()
-        self.model.ground = True
-        self.model.soft_contact_ke = 1.0e4
-        self.model.soft_contact_kd = 1.0e2
-
-        if self.integrator_type == IntegratorType.EULER:
-            self.integrator = wp.sim.SemiImplicitIntegrator()
-        elif self.integrator_type == IntegratorType.XPBD:
-            self.integrator = wp.sim.XPBDIntegrator(iterations=1)
-        else:
-            self.integrator = wp.sim.VBDIntegrator(self.model, iterations=1)
-
-        self.state_0 = self.model.state()
-        self.state_1 = self.model.state()
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path, scaling=40.0)
-        else:
-            self.renderer = None
-
-        self.use_cuda_graph = wp.get_device().is_cuda
-        if self.use_cuda_graph:
-            with wp.ScopedCapture() as capture:
-                self.simulate()
-            self.graph = capture.graph
-
-    def simulate(self):
-        wp.sim.collide(self.model, self.state_0)
-
-        for _ in range(self.sim_substeps):
-            self.state_0.clear_forces()
-
-            self.integrator.simulate(self.model, self.state_0, self.state_1, self.sim_dt)
-
-            # swap states
-            (self.state_0, self.state_1) = (self.state_1, self.state_0)
-
-    def step(self):
-        with wp.ScopedTimer("step", dict=self.profiler):
-            if self.use_cuda_graph:
-                wp.capture_launch(self.graph)
-            else:
-                self.simulate()
-        self.sim_time += self.frame_dt
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            self.renderer.begin_frame(self.sim_time)
-            self.renderer.render(self.state_0)
-            self.renderer.end_frame()
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_cloth.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--num_frames", type=int, default=300, help="Total number of frames.")
-    parser.add_argument(
-        "--integrator",
-        help="Type of integrator",
-        type=IntegratorType,
-        choices=list(IntegratorType),
-        default=IntegratorType.EULER,
-    )
-    parser.add_argument("--width", type=int, default=64, help="Cloth resolution in x.")
-    parser.add_argument("--height", type=int, default=32, help="Cloth resolution in y.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path, integrator=args.integrator, height=args.height, width=args.width)
-
-        for _i in range(args.num_frames):
-            example.step()
-            example.render()
-
-        frame_times = example.profiler["step"]
-        print(f"\nAverage frame sim time: {sum(frame_times) / len(frame_times):.2f} ms")
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/sim/example_cloth_self_contact.py b/warp/examples/sim/example_cloth_self_contact.py
deleted file mode 100644
index bfe62f73..00000000
--- a/warp/examples/sim/example_cloth_self_contact.py
+++ /dev/null
@@ -1,316 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2024 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Sim Cloth Self Contact
-#
-# This simulation demonstrates twisting an FEM cloth model using the VBD
-# integrator, showcasing its ability to handle complex self-contacts while
-# ensuring it remains intersection-free.
-#
-###########################################################################
-
-import math
-import os
-
-import numpy as np
-from pxr import Usd, UsdGeom
-
-import warp as wp
-import warp.examples
-import warp.sim
-import warp.sim.render
-from warp.sim.model import PARTICLE_FLAG_ACTIVE
-
-
-@wp.kernel
-def initialize_rotation(
-    # input
-    vertex_indices_to_rot: wp.array(dtype=wp.int32),
-    pos: wp.array(dtype=wp.vec3),
-    rot_centers: wp.array(dtype=wp.vec3),
-    rot_axes: wp.array(dtype=wp.vec3),
-    t: wp.array(dtype=float),
-    # output
-    roots: wp.array(dtype=wp.vec3),
-    roots_to_ps: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-    v_index = vertex_indices_to_rot[wp.tid()]
-
-    p = pos[v_index]
-    rot_center = rot_centers[tid]
-    rot_axis = rot_axes[tid]
-    op = p - rot_center
-
-    root = wp.dot(op, rot_axis) * rot_axis
-
-    root_to_p = p - root
-
-    roots[tid] = root
-    roots_to_ps[tid] = root_to_p
-
-    if tid == 0:
-        t[0] = 0.0
-
-
-@wp.kernel
-def apply_rotation(
-    # input
-    vertex_indices_to_rot: wp.array(dtype=wp.int32),
-    rot_axes: wp.array(dtype=wp.vec3),
-    roots: wp.array(dtype=wp.vec3),
-    roots_to_ps: wp.array(dtype=wp.vec3),
-    t: wp.array(dtype=float),
-    angular_velocity: float,
-    dt: float,
-    end_time: float,
-    # output
-    pos_0: wp.array(dtype=wp.vec3),
-    pos_1: wp.array(dtype=wp.vec3),
-):
-    cur_t = t[0]
-    if cur_t > end_time:
-        return
-
-    tid = wp.tid()
-    v_index = vertex_indices_to_rot[wp.tid()]
-
-    rot_axis = rot_axes[tid]
-
-    ux = rot_axis[0]
-    uy = rot_axis[1]
-    uz = rot_axis[2]
-
-    theta = cur_t * angular_velocity
-
-    R = wp.mat33(
-        wp.cos(theta) + ux * ux * (1.0 - wp.cos(theta)),
-        ux * uy * (1.0 - wp.cos(theta)) - uz * wp.sin(theta),
-        ux * uz * (1.0 - wp.cos(theta)) + uy * wp.sin(theta),
-        uy * ux * (1.0 - wp.cos(theta)) + uz * wp.sin(theta),
-        wp.cos(theta) + uy * uy * (1.0 - wp.cos(theta)),
-        uy * uz * (1.0 - wp.cos(theta)) - ux * wp.sin(theta),
-        uz * ux * (1.0 - wp.cos(theta)) - uy * wp.sin(theta),
-        uz * uy * (1.0 - wp.cos(theta)) + ux * wp.sin(theta),
-        wp.cos(theta) + uz * uz * (1.0 - wp.cos(theta)),
-    )
-
-    root = roots[tid]
-    root_to_p = roots_to_ps[tid]
-    root_to_p_rot = R * root_to_p
-    p_rot = root + root_to_p_rot
-
-    pos_0[v_index] = p_rot
-    pos_1[v_index] = p_rot
-
-    if tid == 0:
-        t[0] = cur_t + dt
-
-
-class Example:
-    def __init__(self, stage_path="example_cloth_self_contact.usd", num_frames=600):
-        fps = 60
-        self.frame_dt = 1.0 / fps
-        # must be an even number when using CUDA Graph
-        self.num_substeps = 10
-        self.iterations = 4
-        self.dt = self.frame_dt / self.num_substeps
-        # the BVH used by VBDIntegrator will be rebuilt every self.bvh_rebuild_frames
-        # When the simulated object deforms significantly, simply refitting the BVH can lead to deterioration of the BVH's
-        # quality, in this case we need to completely rebuild the tree to achieve better query efficiency.
-        self.bvh_rebuild_frames = 10
-
-        self.num_frames = num_frames
-        self.sim_time = 0.0
-        self.profiler = {}
-
-        self.rot_angular_velocity = math.pi / 3
-        self.rot_end_time = 10
-        self.use_cuda_graph = wp.get_device().is_cuda
-
-        usd_stage = Usd.Stage.Open(os.path.join(warp.examples.get_asset_directory(), "square_cloth.usd"))
-        usd_geom = UsdGeom.Mesh(usd_stage.GetPrimAtPath("/root/cloth/cloth"))
-
-        mesh_points = np.array(usd_geom.GetPointsAttr().Get())
-        mesh_indices = np.array(usd_geom.GetFaceVertexIndicesAttr().Get())
-
-        self.input_scale_factor = 1.0
-        self.renderer_scale_factor = 0.01
-
-        vertices = [wp.vec3(v) * self.input_scale_factor for v in mesh_points]
-        self.faces = mesh_indices.reshape(-1, 3)
-
-        builder = wp.sim.ModelBuilder()
-        builder.add_cloth_mesh(
-            pos=wp.vec3(0.0, 0.0, 0.0),
-            rot=wp.quat_identity(),
-            scale=1.0,
-            vertices=vertices,
-            indices=mesh_indices,
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            density=0.02,
-            tri_ke=1.0e5,
-            tri_ka=1.0e5,
-            tri_kd=2.0e-6,
-            edge_ke=10,
-        )
-        builder.color()
-        self.model = builder.finalize()
-        self.model.ground = False
-        self.model.soft_contact_ke = 1.0e5
-        self.model.soft_contact_kd = 1.0e-6
-        self.model.soft_contact_mu = 0.2
-
-        # set up contact query and contact detection distances
-        self.model.soft_contact_radius = 0.2
-        self.model.soft_contact_margin = 0.35
-
-        cloth_size = 50
-        left_side = [cloth_size - 1 + i * cloth_size for i in range(cloth_size)]
-        right_side = [i * cloth_size for i in range(cloth_size)]
-        rot_point_indices = left_side + right_side
-
-        if len(rot_point_indices):
-            flags = self.model.particle_flags.numpy()
-            for fixed_vertex_id in rot_point_indices:
-                flags[fixed_vertex_id] = wp.uint32(int(flags[fixed_vertex_id]) & ~int(PARTICLE_FLAG_ACTIVE))
-
-            self.model.particle_flags = wp.array(flags)
-
-        self.integrator = wp.sim.VBDIntegrator(
-            self.model,
-            self.iterations,
-            handle_self_contact=True,
-        )
-        self.state0 = self.model.state()
-        self.state1 = self.model.state()
-
-        rot_axes = [[1, 0, 0]] * len(right_side) + [[-1, 0, 0]] * len(left_side)
-
-        self.rot_point_indices = wp.array(rot_point_indices, dtype=int)
-        self.t = wp.zeros((1,), dtype=float)
-        self.rot_centers = wp.zeros(len(rot_point_indices), dtype=wp.vec3)
-        self.rot_axes = wp.array(rot_axes, dtype=wp.vec3)
-
-        self.roots = wp.zeros_like(self.rot_centers)
-        self.roots_to_ps = wp.zeros_like(self.rot_centers)
-
-        wp.launch(
-            kernel=initialize_rotation,
-            dim=self.rot_point_indices.shape[0],
-            inputs=[
-                self.rot_point_indices,
-                self.state0.particle_q,
-                self.rot_centers,
-                self.rot_axes,
-                self.t,
-            ],
-            outputs=[
-                self.roots,
-                self.roots_to_ps,
-            ],
-        )
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path, scaling=1)
-        else:
-            self.renderer = None
-        self.cuda_graph = None
-        if self.use_cuda_graph:
-            with wp.ScopedCapture() as capture:
-                self.integrate_frame_substeps()
-
-            self.cuda_graph = capture.graph
-
-    def integrate_frame_substeps(self):
-        for _ in range(self.num_substeps):
-            wp.launch(
-                kernel=apply_rotation,
-                dim=self.rot_point_indices.shape[0],
-                inputs=[
-                    self.rot_point_indices,
-                    self.rot_axes,
-                    self.roots,
-                    self.roots_to_ps,
-                    self.t,
-                    self.rot_angular_velocity,
-                    self.dt,
-                    self.rot_end_time,
-                ],
-                outputs=[
-                    self.state0.particle_q,
-                    self.state1.particle_q,
-                ],
-            )
-
-            self.integrator.simulate(self.model, self.state0, self.state1, self.dt, None)
-            (self.state0, self.state1) = (self.state1, self.state0)
-
-    def advance_frame(self):
-        with wp.ScopedTimer("step", print=False, dict=self.profiler):
-            if self.use_cuda_graph:
-                wp.capture_launch(self.cuda_graph)
-            else:
-                self.integrate_frame_substeps()
-
-            self.sim_time += self.dt
-
-    def run(self):
-        for i in range(self.num_frames):
-            self.advance_frame()
-            self.render()
-            print(f"[{i:4d}/{self.num_frames}]")
-
-            if i != 0 and not i % self.bvh_rebuild_frames and self.use_cuda_graph:
-                self.integrator.rebuild_bvh(self.state0)
-                with wp.ScopedCapture() as capture:
-                    self.integrate_frame_substeps()
-                self.cuda_graph = capture.graph
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        self.renderer.begin_frame(self.sim_time)
-        self.renderer.render(self.state0)
-        self.renderer.end_frame()
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_cloth_self_contact.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--num_frames", type=int, default=300, help="Total number of frames.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path, num_frames=args.num_frames)
-
-        example.run()
-
-        frame_times = example.profiler["step"]
-        print(f"\nAverage frame sim time: {sum(frame_times) / len(frame_times):.2f} ms")
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/sim/example_granular.py b/warp/examples/sim/example_granular.py
deleted file mode 100644
index 65d87ae5..00000000
--- a/warp/examples/sim/example_granular.py
+++ /dev/null
@@ -1,130 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Sim Granular
-#
-# Shows how to set up a particle-based granular material model using the
-# wp.sim.ModelBuilder().
-#
-###########################################################################
-
-import warp as wp
-import warp.sim
-import warp.sim.render
-
-
-class Example:
-    def __init__(self, stage_path="example_granular.usd"):
-        fps = 60
-        self.frame_dt = 1.0 / fps
-
-        self.sim_substeps = 64
-        self.sim_dt = self.frame_dt / self.sim_substeps
-        self.sim_time = 0.0
-
-        self.radius = 0.1
-
-        builder = wp.sim.ModelBuilder()
-        builder.default_particle_radius = self.radius
-
-        builder.add_particle_grid(
-            dim_x=16,
-            dim_y=32,
-            dim_z=16,
-            cell_x=self.radius * 2.0,
-            cell_y=self.radius * 2.0,
-            cell_z=self.radius * 2.0,
-            pos=wp.vec3(0.0, 1.0, 0.0),
-            rot=wp.quat_identity(),
-            vel=wp.vec3(5.0, 0.0, 0.0),
-            mass=0.1,
-            jitter=self.radius * 0.1,
-        )
-
-        self.model = builder.finalize()
-        self.model.particle_kf = 25.0
-
-        self.model.soft_contact_kd = 100.0
-        self.model.soft_contact_kf *= 2.0
-
-        self.state_0 = self.model.state()
-        self.state_1 = self.model.state()
-
-        self.integrator = wp.sim.SemiImplicitIntegrator()
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path, scaling=20.0)
-        else:
-            self.renderer = None
-
-        self.use_cuda_graph = wp.get_device().is_cuda
-        if self.use_cuda_graph:
-            with wp.ScopedCapture() as capture:
-                self.simulate()
-            self.graph = capture.graph
-
-    def simulate(self):
-        for _ in range(self.sim_substeps):
-            self.state_0.clear_forces()
-            self.integrator.simulate(self.model, self.state_0, self.state_1, self.sim_dt)
-
-            # swap states
-            (self.state_0, self.state_1) = (self.state_1, self.state_0)
-
-    def step(self):
-        with wp.ScopedTimer("step"):
-            self.model.particle_grid.build(self.state_0.particle_q, self.radius * 2.0)
-            if self.use_cuda_graph:
-                wp.capture_launch(self.graph)
-            else:
-                self.simulate()
-
-        self.sim_time += self.frame_dt
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            self.renderer.begin_frame(self.sim_time)
-            self.renderer.render(self.state_0)
-            self.renderer.end_frame()
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_granular.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--num_frames", type=int, default=400, help="Total number of frames.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path)
-
-        for _ in range(args.num_frames):
-            example.step()
-            example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/sim/example_granular_collision_sdf.py b/warp/examples/sim/example_granular_collision_sdf.py
deleted file mode 100644
index 24ab2bee..00000000
--- a/warp/examples/sim/example_granular_collision_sdf.py
+++ /dev/null
@@ -1,202 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Sim Granular Collision SDF
-#
-# Shows how to set up a particle-based granular material model using the
-# wp.sim.ModelBuilder(). This version shows how to create collision geometry
-# objects from SDFs.
-#
-# Note: requires a CUDA-capable device
-###########################################################################
-
-import os
-
-import numpy as np
-
-import warp as wp
-import warp.examples
-import warp.sim
-import warp.sim.render
-
-
-class Example:
-    def __init__(self, stage_path="example_granular_collision_sdf.usd"):
-        fps = 60
-        self.frame_dt = 1.0 / fps
-
-        self.sim_substeps = 64
-        self.sim_dt = self.frame_dt / self.sim_substeps
-        self.sim_time = 0.0
-
-        self.radius = 0.1
-
-        builder = wp.sim.ModelBuilder()
-        builder.default_particle_radius = self.radius
-
-        builder.add_particle_grid(
-            dim_x=16,
-            dim_y=32,
-            dim_z=16,
-            cell_x=self.radius * 2.0,
-            cell_y=self.radius * 2.0,
-            cell_z=self.radius * 2.0,
-            pos=wp.vec3(0.0, 20.0, 0.0),
-            rot=wp.quat_identity(),
-            vel=wp.vec3(2.0, 0.0, 0.0),
-            mass=0.1,
-            jitter=self.radius * 0.1,
-        )
-        with open(os.path.join(warp.examples.get_asset_directory(), "rocks.nvdb"), "rb") as rock_file:
-            rock_vdb = wp.Volume.load_from_nvdb(rock_file.read())
-
-        rock_sdf = wp.sim.SDF(rock_vdb)
-
-        builder.add_shape_sdf(
-            ke=1.0e4,
-            kd=1000.0,
-            kf=1000.0,
-            mu=0.5,
-            sdf=rock_sdf,
-            body=-1,
-            pos=wp.vec3(0.0, 0.0, 0.0),
-            rot=wp.quat(0.0, 0.0, 0.0, 1.0),
-            scale=wp.vec3(1.0, 1.0, 1.0),
-        )
-
-        mins = np.array([-3.0, -3.0, -3.0])
-        voxel_size = 0.2
-        maxs = np.array([3.0, 3.0, 3.0])
-        nums = np.ceil((maxs - mins) / (voxel_size)).astype(dtype=int)
-        center = np.array([0.0, 0.0, 0.0])
-        rad = 2.5
-        sphere_sdf_np = np.zeros(tuple(nums))
-        for x in range(nums[0]):
-            for y in range(nums[1]):
-                for z in range(nums[2]):
-                    pos = mins + voxel_size * np.array([x, y, z])
-                    dis = np.linalg.norm(pos - center)
-                    sphere_sdf_np[x, y, z] = dis - rad
-
-        sphere_vdb = wp.Volume.load_from_numpy(sphere_sdf_np, mins, voxel_size, rad + 3.0 * voxel_size)
-        sphere_sdf = wp.sim.SDF(sphere_vdb)
-
-        self.sphere_pos = wp.vec3(3.0, 15.0, 0.0)
-        self.sphere_scale = 1.0
-        self.sphere_radius = rad
-        builder.add_shape_sdf(
-            ke=1.0e4,
-            kd=1000.0,
-            kf=1000.0,
-            mu=0.5,
-            sdf=sphere_sdf,
-            body=-1,
-            pos=self.sphere_pos,
-            scale=wp.vec3(self.sphere_scale, self.sphere_scale, self.sphere_scale),
-        )
-
-        self.model = builder.finalize()
-        self.model.particle_kf = 25.0
-
-        self.model.soft_contact_kd = 100.0
-        self.model.soft_contact_kf *= 2.0
-
-        self.state_0 = self.model.state()
-        self.state_1 = self.model.state()
-
-        self.integrator = wp.sim.SemiImplicitIntegrator()
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path, scaling=20.0)
-        else:
-            self.renderer = None
-
-        self.use_cuda_graph = wp.get_device().is_cuda
-        if self.use_cuda_graph:
-            with wp.ScopedCapture() as capture:
-                self.simulate()
-            self.graph = capture.graph
-
-    def simulate(self):
-        for _ in range(self.sim_substeps):
-            self.state_0.clear_forces()
-            wp.sim.collide(self.model, self.state_0)
-            self.integrator.simulate(self.model, self.state_0, self.state_1, self.sim_dt)
-
-            # swap states
-            (self.state_0, self.state_1) = (self.state_1, self.state_0)
-
-    def step(self):
-        with wp.ScopedTimer("step"):
-            self.model.particle_grid.build(self.state_0.particle_q, self.radius * 2.0)
-            if self.use_cuda_graph:
-                wp.capture_launch(self.graph)
-            else:
-                self.simulate()
-
-        self.sim_time += self.frame_dt
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            self.renderer.begin_frame(self.sim_time)
-
-            self.renderer.render_ref(
-                name="collision",
-                path=os.path.join(warp.examples.get_asset_directory(), "rocks.usd"),
-                pos=wp.vec3(0.0, 0.0, 0.0),
-                rot=wp.quat(0.0, 0.0, 0.0, 1.0),
-                scale=wp.vec3(1.0, 1.0, 1.0),
-                color=(0.35, 0.55, 0.9),
-            )
-
-            self.renderer.render_sphere(
-                name="sphere",
-                pos=self.sphere_pos,
-                radius=self.sphere_scale * self.sphere_radius,
-                rot=wp.quat(0.0, 0.0, 0.0, 1.0),
-            )
-
-            self.renderer.render(self.state_0)
-            self.renderer.end_frame()
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_granular_collision_sdf.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--num_frames", type=int, default=400, help="Total number of frames.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path)
-
-        for _ in range(args.num_frames):
-            example.step()
-            example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/sim/example_jacobian_ik.py b/warp/examples/sim/example_jacobian_ik.py
deleted file mode 100644
index da4571c2..00000000
--- a/warp/examples/sim/example_jacobian_ik.py
+++ /dev/null
@@ -1,244 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Jacobian
-#
-# Demonstrates how to compute the Jacobian of a multi-valued function.
-# Here, we use the simulation of a cartpole to differentiate
-# through the kinematics function. We instantiate multiple copies of the
-# cartpole and compute the Jacobian of the state of each cartpole in parallel
-# in order to perform inverse kinematics via Jacobian transpose.
-#
-###########################################################################
-
-import math
-import os
-
-import numpy as np
-
-import warp as wp
-import warp.examples
-import warp.sim
-import warp.sim.render
-
-
-@wp.kernel
-def compute_endeffector_position(
-    body_q: wp.array(dtype=wp.transform),
-    num_links: int,
-    ee_link_index: int,
-    ee_link_offset: wp.vec3,
-    ee_pos: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-    ee_pos[tid] = wp.transform_point(body_q[tid * num_links + ee_link_index], ee_link_offset)
-
-
-class Example:
-    def __init__(self, stage_path="example_jacobian_ik.usd", num_envs=10):
-        rng = np.random.default_rng(42)
-
-        self.num_envs = num_envs
-
-        fps = 60
-        self.frame_dt = 1.0 / fps
-
-        self.render_time = 0.0
-
-        # step size to use for the IK updates
-        self.step_size = 0.1
-
-        articulation_builder = wp.sim.ModelBuilder()
-
-        wp.sim.parse_urdf(
-            os.path.join(warp.examples.get_asset_directory(), "cartpole.urdf"),
-            articulation_builder,
-            xform=wp.transform_identity(),
-            floating=False,
-        )
-
-        builder = wp.sim.ModelBuilder()
-
-        self.num_links = len(articulation_builder.joint_type)
-        # use the last link as the end-effector
-        self.ee_link_index = self.num_links - 1
-        self.ee_link_offset = wp.vec3(0.0, 0.0, 1.0)
-
-        self.dof = len(articulation_builder.joint_q)
-
-        self.target_origin = []
-        for i in range(self.num_envs):
-            builder.add_builder(
-                articulation_builder,
-                xform=wp.transform(
-                    wp.vec3(i * 2.0, 4.0, 0.0), wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), -math.pi * 0.5)
-                ),
-            )
-            self.target_origin.append((i * 2.0, 4.0, 0.0))
-            # joint initial positions
-            builder.joint_q[-3:] = rng.uniform(-0.5, 0.5, size=3)
-        self.target_origin = np.array(self.target_origin)
-
-        # finalize model
-        self.model = builder.finalize()
-        self.model.ground = True
-
-        self.model.joint_q.requires_grad = True
-        self.model.body_q.requires_grad = True
-
-        self.model.joint_attach_ke = 1600.0
-        self.model.joint_attach_kd = 20.0
-
-        self.integrator = wp.sim.SemiImplicitIntegrator()
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path)
-        else:
-            self.renderer = None
-
-        self.ee_pos = wp.zeros(self.num_envs, dtype=wp.vec3, requires_grad=True)
-
-        self.state = self.model.state(requires_grad=True)
-
-        self.targets = self.target_origin.copy()
-
-        self.profiler = {}
-
-    def compute_ee_position(self):
-        # computes the end-effector position from the current joint angles
-        wp.sim.eval_fk(self.model, self.model.joint_q, self.model.joint_qd, None, self.state)
-        wp.launch(
-            compute_endeffector_position,
-            dim=self.num_envs,
-            inputs=[self.state.body_q, self.num_links, self.ee_link_index, self.ee_link_offset],
-            outputs=[self.ee_pos],
-        )
-        return self.ee_pos
-
-    def compute_jacobian(self):
-        # our function has 3 outputs (EE position), so we need a 3xN jacobian per environment
-        jacobians = np.empty((self.num_envs, 3, self.dof), dtype=np.float32)
-        tape = wp.Tape()
-        with tape:
-            self.compute_ee_position()
-        for output_index in range(3):
-            # select which row of the Jacobian we want to compute
-            select_index = np.zeros(3)
-            select_index[output_index] = 1.0
-            e = wp.array(np.tile(select_index, self.num_envs), dtype=wp.vec3)
-            tape.backward(grads={self.ee_pos: e})
-            q_grad_i = tape.gradients[self.model.joint_q]
-            jacobians[:, output_index, :] = q_grad_i.numpy().reshape(self.num_envs, self.dof)
-            tape.zero()
-        return jacobians
-
-    def compute_fd_jacobian(self, eps=1e-4):
-        jacobians = np.zeros((self.num_envs, 3, self.dof), dtype=np.float32)
-        q0 = self.model.joint_q.numpy().copy()
-        for e in range(self.num_envs):
-            for i in range(self.dof):
-                q = q0.copy()
-                q[e * self.dof + i] += eps
-                self.model.joint_q.assign(q)
-                self.compute_ee_position()
-                f_plus = self.ee_pos.numpy()[e].copy()
-                q[e * self.dof + i] -= 2 * eps
-                self.model.joint_q.assign(q)
-                self.compute_ee_position()
-                f_minus = self.ee_pos.numpy()[e].copy()
-                jacobians[e, :, i] = (f_plus - f_minus) / (2 * eps)
-        return jacobians
-
-    def step(self):
-        with wp.ScopedTimer("jacobian", print=False, active=True, dict=self.profiler):
-            # compute jacobian
-            jacobians = self.compute_jacobian()
-
-        # compute error
-        self.ee_pos_np = self.compute_ee_position().numpy()
-        error = self.targets - self.ee_pos_np
-        self.error = error.reshape(self.num_envs, 3, 1)
-
-        # compute Jacobian transpose update
-        delta_q = np.matmul(jacobians.transpose(0, 2, 1), self.error)
-
-        self.model.joint_q = wp.array(
-            self.model.joint_q.numpy() + self.step_size * delta_q.flatten(),
-            dtype=wp.float32,
-            requires_grad=True,
-        )
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        self.renderer.begin_frame(self.render_time)
-        self.renderer.render(self.state)
-        self.renderer.render_points("targets", self.targets, radius=0.05)
-        self.renderer.render_points("ee_pos", self.ee_pos_np, radius=0.05)
-        self.renderer.end_frame()
-        self.render_time += self.frame_dt
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_jacobian_ik.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--train_iters", type=int, default=50, help="Total number of training iterations.")
-    parser.add_argument("--num_envs", type=int, default=10, help="Total number of simulated environments.")
-    parser.add_argument(
-        "--num_rollouts",
-        type=int,
-        default=5,
-        help="Total number of rollouts. In each rollout, a new set of target points is resampled for all environments.",
-    )
-
-    args = parser.parse_known_args()[0]
-
-    rng = np.random.default_rng(42)
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path, num_envs=args.num_envs)
-
-        print("autodiff:")
-        print(example.compute_jacobian())
-        print("finite diff:")
-        print(example.compute_fd_jacobian())
-
-        for _ in range(args.num_rollouts):
-            # select new random target points for all envs
-            example.targets = example.target_origin.copy()
-            example.targets[:, 1:] += rng.uniform(-0.5, 0.5, size=(example.num_envs, 2))
-
-            for iter in range(args.train_iters):
-                example.step()
-                example.render()
-                print("iter:", iter, "error:", example.error.mean())
-
-        if example.renderer:
-            example.renderer.save()
-
-        avg_time = np.array(example.profiler["jacobian"]).mean()
-        avg_steps_second = 1000.0 * float(example.num_envs) / avg_time
-
-        print(f"envs: {example.num_envs} steps/second {avg_steps_second} avg_time {avg_time}")
diff --git a/warp/examples/sim/example_particle_chain.py b/warp/examples/sim/example_particle_chain.py
deleted file mode 100644
index 4536049a..00000000
--- a/warp/examples/sim/example_particle_chain.py
+++ /dev/null
@@ -1,124 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Sim Particle Chain
-#
-# Shows how to set up a simple chain of particles connected by springs
-# using wp.sim.ModelBuilder().
-#
-###########################################################################
-
-import math
-
-import warp as wp
-import warp.sim
-import warp.sim.render
-
-
-class Example:
-    def __init__(self, stage_path="example_particle_chain.usd"):
-        self.sim_width = 64
-        self.sim_height = 32
-
-        fps = 60
-        self.frame_dt = 1.0 / fps
-        self.sim_substeps = 10
-        self.sim_dt = self.frame_dt / self.sim_substeps
-        self.sim_time = 0.0
-
-        builder = wp.sim.ModelBuilder()
-
-        # anchor
-        builder.add_particle(wp.vec3(0.0, 1.0, 0.0), wp.vec3(0.0, 0.0, 0.0), 0.0)
-
-        # chain
-        for i in range(1, 10):
-            radius = math.sqrt(i) * 0.2
-            mass = math.pi * radius * radius * radius
-            builder.add_particle(wp.vec3(i, 1.0, 0.0), wp.vec3(0.0, 0.0, 0.0), mass, radius=radius)
-            builder.add_spring(i - 1, i, 1.0e6, 0.0, 0)
-
-        self.model = builder.finalize()
-        self.model.ground = False
-
-        self.integrator = wp.sim.XPBDIntegrator()
-
-        self.state_0 = self.model.state()
-        self.state_1 = self.model.state()
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path, scaling=15.0)
-        else:
-            self.renderer = None
-
-        # simulate() allocates memory via a clone, so we can't use graph capture if the device does not support mempools
-        self.use_cuda_graph = wp.get_device().is_cuda and wp.is_mempool_enabled(wp.get_device())
-        if self.use_cuda_graph:
-            with wp.ScopedCapture() as capture:
-                self.simulate()
-            self.graph = capture.graph
-
-    def simulate(self):
-        for _ in range(self.sim_substeps):
-            self.state_0.clear_forces()
-            self.state_1.clear_forces()
-            self.integrator.simulate(self.model, self.state_0, self.state_1, self.sim_dt)
-
-            # swap states
-            (self.state_0, self.state_1) = (self.state_1, self.state_0)
-
-    def step(self):
-        with wp.ScopedTimer("step"):
-            if self.use_cuda_graph:
-                wp.capture_launch(self.graph)
-            else:
-                self.simulate()
-        self.sim_time += self.frame_dt
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            self.renderer.begin_frame(self.sim_time)
-            self.renderer.render(self.state_0)
-            self.renderer.end_frame()
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_particle_chain.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--num_frames", type=int, default=300, help="Total number of frames.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path)
-
-        for _ in range(args.num_frames):
-            example.step()
-            example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/sim/example_quadruped.py b/warp/examples/sim/example_quadruped.py
deleted file mode 100644
index 117ca0c6..00000000
--- a/warp/examples/sim/example_quadruped.py
+++ /dev/null
@@ -1,203 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Sim Quadruped
-#
-# Shows how to set up a simulation of a rigid-body quadruped articulation
-# from a URDF using the wp.sim.ModelBuilder().
-# Note this example does not include a trained policy.
-#
-###########################################################################
-
-import math
-import os
-
-import numpy as np
-
-import warp as wp
-import warp.examples
-import warp.sim
-import warp.sim.render
-
-
-# Taken from env/environment.py
-def compute_env_offsets(num_envs, env_offset=(5.0, 0.0, 5.0), up_axis="Y"):
-    # compute positional offsets per environment
-    env_offset = np.array(env_offset)
-    nonzeros = np.nonzero(env_offset)[0]
-    num_dim = nonzeros.shape[0]
-    if num_dim > 0:
-        side_length = int(np.ceil(num_envs ** (1.0 / num_dim)))
-        env_offsets = []
-    else:
-        env_offsets = np.zeros((num_envs, 3))
-    if num_dim == 1:
-        for i in range(num_envs):
-            env_offsets.append(i * env_offset)
-    elif num_dim == 2:
-        for i in range(num_envs):
-            d0 = i // side_length
-            d1 = i % side_length
-            offset = np.zeros(3)
-            offset[nonzeros[0]] = d0 * env_offset[nonzeros[0]]
-            offset[nonzeros[1]] = d1 * env_offset[nonzeros[1]]
-            env_offsets.append(offset)
-    elif num_dim == 3:
-        for i in range(num_envs):
-            d0 = i // (side_length * side_length)
-            d1 = (i // side_length) % side_length
-            d2 = i % side_length
-            offset = np.zeros(3)
-            offset[0] = d0 * env_offset[0]
-            offset[1] = d1 * env_offset[1]
-            offset[2] = d2 * env_offset[2]
-            env_offsets.append(offset)
-    env_offsets = np.array(env_offsets)
-    min_offsets = np.min(env_offsets, axis=0)
-    correction = min_offsets + (np.max(env_offsets, axis=0) - min_offsets) / 2.0
-    if isinstance(up_axis, str):
-        up_axis = "XYZ".index(up_axis.upper())
-    correction[up_axis] = 0.0  # ensure the envs are not shifted below the ground plane
-    env_offsets -= correction
-    return env_offsets
-
-
-class Example:
-    def __init__(self, stage_path="example_quadruped.usd", num_envs=8):
-        articulation_builder = wp.sim.ModelBuilder()
-        wp.sim.parse_urdf(
-            os.path.join(warp.examples.get_asset_directory(), "quadruped.urdf"),
-            articulation_builder,
-            xform=wp.transform([0.0, 0.7, 0.0], wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), -math.pi * 0.5)),
-            floating=True,
-            density=1000,
-            armature=0.01,
-            stiffness=200,
-            damping=1,
-            contact_ke=1.0e4,
-            contact_kd=1.0e2,
-            contact_kf=1.0e2,
-            contact_mu=1.0,
-            limit_ke=1.0e4,
-            limit_kd=1.0e1,
-        )
-
-        builder = wp.sim.ModelBuilder()
-
-        self.sim_time = 0.0
-        fps = 100
-        self.frame_dt = 1.0 / fps
-
-        self.sim_substeps = 10
-        self.sim_dt = self.frame_dt / self.sim_substeps
-
-        self.num_envs = num_envs
-
-        offsets = compute_env_offsets(self.num_envs)
-        for i in range(self.num_envs):
-            builder.add_builder(articulation_builder, xform=wp.transform(offsets[i], wp.quat_identity()))
-
-            builder.joint_q[-12:] = [0.2, 0.4, -0.6, -0.2, -0.4, 0.6, -0.2, 0.4, -0.6, 0.2, -0.4, 0.6]
-
-            builder.joint_axis_mode = [wp.sim.JOINT_MODE_TARGET_POSITION] * len(builder.joint_axis_mode)
-            builder.joint_act[-12:] = [0.2, 0.4, -0.6, -0.2, -0.4, 0.6, -0.2, 0.4, -0.6, 0.2, -0.4, 0.6]
-
-        np.set_printoptions(suppress=True)
-        # finalize model
-        self.model = builder.finalize()
-        self.model.ground = True
-        # self.model.gravity = 0.0
-
-        self.model.joint_attach_ke = 16000.0
-        self.model.joint_attach_kd = 200.0
-        self.use_tile_gemm = False
-        self.fuse_cholesky = False
-
-        # self.integrator = wp.sim.XPBDIntegrator()
-        # self.integrator = wp.sim.SemiImplicitIntegrator()
-        self.integrator = wp.sim.FeatherstoneIntegrator(
-            self.model, use_tile_gemm=self.use_tile_gemm, fuse_cholesky=self.fuse_cholesky
-        )
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path)
-        else:
-            self.renderer = None
-
-        self.state_0 = self.model.state()
-        self.state_1 = self.model.state()
-
-        wp.sim.eval_fk(self.model, self.model.joint_q, self.model.joint_qd, None, self.state_0)
-
-        # simulate() allocates memory via a clone, so we can't use graph capture if the device does not support mempools
-        self.use_cuda_graph = wp.get_device().is_cuda and wp.is_mempool_enabled(wp.get_device())
-        if self.use_cuda_graph:
-            with wp.ScopedCapture() as capture:
-                self.simulate()
-            self.graph = capture.graph
-        else:
-            self.graph = None
-
-    def simulate(self):
-        for _ in range(self.sim_substeps):
-            self.state_0.clear_forces()
-            wp.sim.collide(self.model, self.state_0)
-            self.integrator.simulate(self.model, self.state_0, self.state_1, self.sim_dt)
-            self.state_0, self.state_1 = self.state_1, self.state_0
-
-    def step(self):
-        with wp.ScopedTimer("step"):
-            if self.use_cuda_graph:
-                wp.capture_launch(self.graph)
-            else:
-                self.simulate()
-        self.sim_time += self.frame_dt
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            self.renderer.begin_frame(self.sim_time)
-            self.renderer.render(self.state_0)
-            self.renderer.end_frame()
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_quadruped.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--num_frames", type=int, default=300, help="Total number of frames.")
-    parser.add_argument("--num_envs", type=int, default=8, help="Total number of simulated environments.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path, num_envs=args.num_envs)
-
-        for _ in range(args.num_frames):
-            example.step()
-            example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/sim/example_rigid_chain.py b/warp/examples/sim/example_rigid_chain.py
deleted file mode 100644
index 15778c76..00000000
--- a/warp/examples/sim/example_rigid_chain.py
+++ /dev/null
@@ -1,203 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Sim Rigid Chain
-#
-# Shows how to set up a chain of rigid bodies connected by different joint
-# types using wp.sim.ModelBuilder(). There is one chain for each joint
-# type, including fixed joints which act as a flexible beam.
-#
-###########################################################################
-
-import numpy as np
-
-import warp as wp
-import warp.sim
-import warp.sim.render
-
-
-class Example:
-    def __init__(self, stage_path="example_rigid_chain.usd"):
-        self.chain_length = 8
-        self.chain_width = 1.0
-        self.chain_types = [
-            wp.sim.JOINT_REVOLUTE,
-            wp.sim.JOINT_FIXED,
-            wp.sim.JOINT_BALL,
-            wp.sim.JOINT_UNIVERSAL,
-            wp.sim.JOINT_COMPOUND,
-        ]
-
-        builder = wp.sim.ModelBuilder()
-
-        self.sim_time = 0.0
-        fps = 100
-        self.frame_dt = 1.0 / fps
-
-        self.sim_substeps = 10
-        self.sim_dt = self.frame_dt / self.sim_substeps
-
-        for c, t in enumerate(self.chain_types):
-            # start a new articulation
-            builder.add_articulation()
-
-            for i in range(self.chain_length):
-                if i == 0:
-                    parent = -1
-                    parent_joint_xform = wp.transform([0.0, 0.0, c * 1.0], wp.quat_identity())
-                else:
-                    parent = builder.joint_count - 1
-                    parent_joint_xform = wp.transform([self.chain_width, 0.0, 0.0], wp.quat_identity())
-
-                # create body
-                b = builder.add_body(origin=wp.transform([i, 0.0, c * 1.0], wp.quat_identity()), armature=0.1)
-
-                # create shape
-                builder.add_shape_box(
-                    pos=wp.vec3(self.chain_width * 0.5, 0.0, 0.0),
-                    hx=self.chain_width * 0.5,
-                    hy=0.1,
-                    hz=0.1,
-                    density=10.0,
-                    body=b,
-                )
-
-                joint_type = t
-
-                if joint_type == wp.sim.JOINT_REVOLUTE:
-                    joint_limit_lower = -np.deg2rad(60.0)
-                    joint_limit_upper = np.deg2rad(60.0)
-                    builder.add_joint_revolute(
-                        parent=parent,
-                        child=b,
-                        axis=(0.0, 0.0, 1.0),
-                        parent_xform=parent_joint_xform,
-                        child_xform=wp.transform_identity(),
-                        limit_lower=joint_limit_lower,
-                        limit_upper=joint_limit_upper,
-                        target_ke=0.0,
-                        target_kd=0.0,
-                        limit_ke=1e5,
-                        limit_kd=1.0,
-                    )
-
-                elif joint_type == wp.sim.JOINT_UNIVERSAL:
-                    builder.add_joint_universal(
-                        parent=parent,
-                        child=b,
-                        axis_0=wp.sim.JointAxis((1.0, 0.0, 0.0), -np.deg2rad(60.0), np.deg2rad(60.0)),
-                        axis_1=wp.sim.JointAxis((0.0, 0.0, 1.0), -np.deg2rad(60.0), np.deg2rad(60.0)),
-                        parent_xform=parent_joint_xform,
-                        child_xform=wp.transform_identity(),
-                    )
-
-                elif joint_type == wp.sim.JOINT_BALL:
-                    builder.add_joint_ball(
-                        parent=parent,
-                        child=b,
-                        parent_xform=parent_joint_xform,
-                        child_xform=wp.transform_identity(),
-                    )
-
-                elif joint_type == wp.sim.JOINT_FIXED:
-                    builder.add_joint_fixed(
-                        parent=parent,
-                        child=b,
-                        parent_xform=parent_joint_xform,
-                        child_xform=wp.transform_identity(),
-                    )
-
-                elif joint_type == wp.sim.JOINT_COMPOUND:
-                    builder.add_joint_compound(
-                        parent=parent,
-                        child=b,
-                        axis_0=wp.sim.JointAxis((1.0, 0.0, 0.0), -np.deg2rad(60.0), np.deg2rad(60.0)),
-                        axis_1=wp.sim.JointAxis((0.0, 1.0, 0.0), -np.deg2rad(60.0), np.deg2rad(60.0)),
-                        axis_2=wp.sim.JointAxis((0.0, 0.0, 1.0), -np.deg2rad(60.0), np.deg2rad(60.0)),
-                        parent_xform=parent_joint_xform,
-                        child_xform=wp.transform_identity(),
-                    )
-
-        self.model = builder.finalize()
-        self.model.ground = False
-
-        self.integrator = wp.sim.FeatherstoneIntegrator(self.model)
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path, scaling=20.0)
-        else:
-            self.renderer = None
-
-        self.state_0 = self.model.state()
-        self.state_1 = self.model.state()
-
-        wp.sim.eval_fk(self.model, self.model.joint_q, self.model.joint_qd, None, self.state_0)
-
-        # simulate() allocates memory via a clone, so we can't use graph capture if the device does not support mempools
-        self.use_cuda_graph = wp.get_device().is_cuda and wp.is_mempool_enabled(wp.get_device())
-        if self.use_cuda_graph:
-            with wp.ScopedCapture() as capture:
-                self.simulate()
-            self.graph = capture.graph
-
-    def simulate(self):
-        for _ in range(self.sim_substeps):
-            self.state_0.clear_forces()
-            self.integrator.simulate(self.model, self.state_0, self.state_1, self.sim_dt)
-            self.state_0, self.state_1 = self.state_1, self.state_0
-
-    def step(self):
-        with wp.ScopedTimer("step"):
-            if self.use_cuda_graph:
-                wp.capture_launch(self.graph)
-            else:
-                self.simulate()
-        self.sim_time += self.frame_dt
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            self.renderer.begin_frame(self.sim_time)
-            self.renderer.render(self.state_0)
-            self.renderer.end_frame()
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_rigid_chain.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--num_frames", type=int, default=500, help="Total number of frames.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path)
-
-        for _ in range(args.num_frames):
-            example.step()
-            example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/sim/example_rigid_contact.py b/warp/examples/sim/example_rigid_contact.py
deleted file mode 100644
index 96c9c3b6..00000000
--- a/warp/examples/sim/example_rigid_contact.py
+++ /dev/null
@@ -1,195 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Sim Rigid Contact
-#
-# Shows how to set up free rigid bodies with different shape types falling
-# and colliding against each other and the ground using wp.sim.ModelBuilder().
-#
-###########################################################################
-
-import math
-import os
-
-import numpy as np
-from pxr import Usd, UsdGeom
-
-import warp as wp
-import warp.examples
-import warp.sim
-import warp.sim.render
-
-
-class Example:
-    def __init__(self, stage_path="example_rigid_contact.usd"):
-        builder = wp.sim.ModelBuilder()
-
-        self.sim_time = 0.0
-        fps = 60
-        self.frame_dt = 1.0 / fps
-
-        self.sim_substeps = 10
-        self.sim_dt = self.frame_dt / self.sim_substeps
-
-        self.num_bodies = 8
-        self.scale = 0.8
-        self.ke = 1.0e5
-        self.kd = 250.0
-        self.kf = 500.0
-
-        # boxes
-        for i in range(self.num_bodies):
-            b = builder.add_body(origin=wp.transform((i, 1.0, 0.0), wp.quat_identity()))
-
-            builder.add_shape_box(
-                pos=wp.vec3(0.0, 0.0, 0.0),
-                hx=0.5 * self.scale,
-                hy=0.2 * self.scale,
-                hz=0.2 * self.scale,
-                body=i,
-                ke=self.ke,
-                kd=self.kd,
-                kf=self.kf,
-            )
-
-        # spheres
-        for i in range(self.num_bodies):
-            b = builder.add_body(origin=wp.transform((i, 1.0, 2.0), wp.quat_identity()))
-
-            builder.add_shape_sphere(
-                pos=wp.vec3(0.0, 0.0, 0.0), radius=0.25 * self.scale, body=b, ke=self.ke, kd=self.kd, kf=self.kf
-            )
-
-        # capsules
-        for i in range(self.num_bodies):
-            b = builder.add_body(origin=wp.transform((i, 1.0, 6.0), wp.quat_identity()))
-
-            builder.add_shape_capsule(
-                pos=wp.vec3(0.0, 0.0, 0.0),
-                radius=0.25 * self.scale,
-                half_height=self.scale * 0.5,
-                up_axis=0,
-                body=b,
-                ke=self.ke,
-                kd=self.kd,
-                kf=self.kf,
-            )
-
-        # initial spin
-        for i in range(len(builder.body_qd)):
-            builder.body_qd[i] = (0.0, 2.0, 10.0, 0.0, 0.0, 0.0)
-
-        # meshes
-        bunny = self.load_mesh(os.path.join(warp.examples.get_asset_directory(), "bunny.usd"), "/root/bunny")
-        for i in range(self.num_bodies):
-            b = builder.add_body(
-                origin=wp.transform(
-                    (i * 0.5 * self.scale, 1.0 + i * 1.7 * self.scale, 4.0 + i * 0.5 * self.scale),
-                    wp.quat_from_axis_angle(wp.vec3(0.0, 1.0, 0.0), math.pi * 0.1 * i),
-                )
-            )
-
-            builder.add_shape_mesh(
-                body=b,
-                mesh=bunny,
-                pos=wp.vec3(0.0, 0.0, 0.0),
-                scale=wp.vec3(self.scale, self.scale, self.scale),
-                ke=self.ke,
-                kd=self.kd,
-                kf=self.kf,
-                density=1e3,
-            )
-
-        # finalize model
-        self.model = builder.finalize()
-        self.model.ground = True
-
-        self.integrator = wp.sim.SemiImplicitIntegrator()
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path, scaling=0.5)
-        else:
-            self.renderer = None
-
-        self.state_0 = self.model.state()
-        self.state_1 = self.model.state()
-
-        wp.sim.eval_fk(self.model, self.model.joint_q, self.model.joint_qd, None, self.state_0)
-
-        self.use_cuda_graph = wp.get_device().is_cuda
-        if self.use_cuda_graph:
-            with wp.ScopedCapture() as capture:
-                self.simulate()
-            self.graph = capture.graph
-
-    def load_mesh(self, filename, path):
-        asset_stage = Usd.Stage.Open(filename)
-        mesh_geom = UsdGeom.Mesh(asset_stage.GetPrimAtPath(path))
-
-        points = np.array(mesh_geom.GetPointsAttr().Get())
-        indices = np.array(mesh_geom.GetFaceVertexIndicesAttr().Get()).flatten()
-
-        return wp.sim.Mesh(points, indices)
-
-    def simulate(self):
-        for _ in range(self.sim_substeps):
-            self.state_0.clear_forces()
-            wp.sim.collide(self.model, self.state_0)
-            self.integrator.simulate(self.model, self.state_0, self.state_1, self.sim_dt)
-            self.state_0, self.state_1 = self.state_1, self.state_0
-
-    def step(self):
-        with wp.ScopedTimer("step", active=True):
-            if self.use_cuda_graph:
-                wp.capture_launch(self.graph)
-            else:
-                self.simulate()
-        self.sim_time += self.frame_dt
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render", active=True):
-            self.renderer.begin_frame(self.sim_time)
-            self.renderer.render(self.state_0)
-            self.renderer.end_frame()
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_rigid_contact.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--num_frames", type=int, default=300, help="Total number of frames.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path)
-
-        for _ in range(args.num_frames):
-            example.step()
-            example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/sim/example_rigid_force.py b/warp/examples/sim/example_rigid_force.py
deleted file mode 100644
index 421e4259..00000000
--- a/warp/examples/sim/example_rigid_force.py
+++ /dev/null
@@ -1,133 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Sim Rigid Force
-#
-# Shows how to apply an external force (torque) to a rigid body causing
-# it to roll.
-#
-###########################################################################
-
-import warp as wp
-import warp.sim
-import warp.sim.render
-
-
-class Example:
-    def __init__(self, stage_path="example_rigid_force.usd", use_opengl=False):
-        fps = 60
-        self.frame_dt = 1.0 / fps
-        self.sim_substeps = 5
-        self.sim_dt = self.frame_dt / self.sim_substeps
-        self.sim_time = 0.0
-
-        builder = wp.sim.ModelBuilder()
-
-        b = builder.add_body(origin=wp.transform((0.0, 10.0, 0.0), wp.quat_identity()))
-        builder.add_shape_box(body=b, hx=1.0, hy=1.0, hz=1.0, density=100.0)
-
-        self.model = builder.finalize()
-        self.model.ground = True
-
-        self.integrator = wp.sim.XPBDIntegrator()
-
-        self.state_0 = self.model.state()
-        self.state_1 = self.model.state()
-
-        if use_opengl:
-            self.renderer = wp.sim.render.SimRendererOpenGL(self.model, stage_path)
-        elif stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path)
-        else:
-            self.renderer = None
-
-        # simulate() allocates memory via a clone, so we can't use graph capture if the device does not support mempools
-        self.use_cuda_graph = wp.get_device().is_cuda and wp.is_mempool_enabled(wp.get_device())
-        if self.use_cuda_graph:
-            with wp.ScopedCapture() as capture:
-                self.simulate()
-            self.graph = capture.graph
-
-    def simulate(self):
-        for _ in range(self.sim_substeps):
-            wp.sim.collide(self.model, self.state_0)
-
-            self.state_0.clear_forces()
-            self.state_1.clear_forces()
-
-            self.state_0.body_f.assign(
-                [
-                    [0.0, 0.0, -7000.0, 0.0, 0.0, 0.0],
-                ]
-            )
-
-            self.integrator.simulate(self.model, self.state_0, self.state_1, self.sim_dt)
-
-            # swap states
-            (self.state_0, self.state_1) = (self.state_1, self.state_0)
-
-    def step(self):
-        with wp.ScopedTimer("step"):
-            if self.use_cuda_graph:
-                wp.capture_launch(self.graph)
-            else:
-                self.simulate()
-        self.sim_time += self.frame_dt
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            self.renderer.begin_frame(self.sim_time)
-            self.renderer.render(self.state_0)
-            self.renderer.end_frame()
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_rigid_force.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--num_frames", type=int, default=300, help="Total number of frames.")
-    parser.add_argument(
-        "--opengl",
-        action="store_true",
-        help="Open an interactive window to play back animations in real time. Ignores --num_frames if used.",
-    )
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path, use_opengl=args.opengl)
-
-        if args.opengl:
-            while example.renderer.is_running():
-                example.step()
-                example.render()
-        else:
-            for _ in range(args.num_frames):
-                example.step()
-                example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/sim/example_rigid_gyroscopic.py b/warp/examples/sim/example_rigid_gyroscopic.py
deleted file mode 100644
index ea3293dc..00000000
--- a/warp/examples/sim/example_rigid_gyroscopic.py
+++ /dev/null
@@ -1,115 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Sim Rigid Gyroscopic
-#
-# Demonstrates the Dzhanibekov effect where rigid bodies will tumble in
-# free space due to unstable axes of rotation.
-#
-###########################################################################
-
-import warp as wp
-import warp.sim
-import warp.sim.render
-
-
-class Example:
-    def __init__(self, stage_path="example_rigid_gyroscopic.usd"):
-        fps = 120
-        self.sim_dt = 1.0 / fps
-        self.sim_time = 0.0
-
-        self.scale = 0.5
-
-        builder = wp.sim.ModelBuilder()
-
-        b = builder.add_body()
-
-        # axis shape
-        builder.add_shape_box(
-            pos=wp.vec3(0.3 * self.scale, 0.0, 0.0),
-            hx=0.25 * self.scale,
-            hy=0.1 * self.scale,
-            hz=0.1 * self.scale,
-            density=100.0,
-            body=b,
-        )
-
-        # tip shape
-        builder.add_shape_box(
-            pos=wp.vec3(0.0, 0.0, 0.0),
-            hx=0.05 * self.scale,
-            hy=0.2 * self.scale,
-            hz=1.0 * self.scale,
-            density=100.0,
-            body=b,
-        )
-
-        # initial spin
-        builder.body_qd[0] = (25.0, 0.01, 0.01, 0.0, 0.0, 0.0)
-
-        builder.gravity = 0.0
-        self.model = builder.finalize()
-        self.model.ground = False
-
-        self.integrator = wp.sim.SemiImplicitIntegrator()
-        self.state = self.model.state()
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path, scaling=100.0)
-        else:
-            self.renderer = None
-
-    def step(self):
-        with wp.ScopedTimer("step"):
-            self.state.clear_forces()
-            self.state = self.integrator.simulate(self.model, self.state, self.state, self.sim_dt)
-            self.sim_time += self.sim_dt
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            self.renderer.begin_frame(self.sim_time)
-            self.renderer.render(self.state)
-            self.renderer.end_frame()
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_rigid_gyroscopic.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--num_frames", type=int, default=2000, help="Total number of frames.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path)
-
-        for _ in range(args.num_frames):
-            example.step()
-            example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/sim/example_rigid_soft_contact.py b/warp/examples/sim/example_rigid_soft_contact.py
deleted file mode 100644
index 65451788..00000000
--- a/warp/examples/sim/example_rigid_soft_contact.py
+++ /dev/null
@@ -1,140 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Sim Rigid FEM
-#
-# Shows how to set up a rigid sphere colliding with an FEM beam
-# using wp.sim.ModelBuilder().
-#
-###########################################################################
-
-import warp as wp
-import warp.sim
-import warp.sim.render
-
-
-class Example:
-    def __init__(self, stage_path="example_rigid_soft_contact.usd"):
-        self.sim_width = 8
-        self.sim_height = 8
-
-        fps = 60
-        self.frame_dt = 1.0 / fps
-        self.sim_substeps = 32
-        self.sim_dt = self.frame_dt / self.sim_substeps
-        self.sim_time = 0.0
-        self.sim_iterations = 1
-        self.sim_relaxation = 1.0
-        self.profiler = {}
-
-        builder = wp.sim.ModelBuilder()
-        builder.default_particle_radius = 0.01
-
-        builder.add_soft_grid(
-            pos=wp.vec3(0.0, 0.0, 0.0),
-            rot=wp.quat_identity(),
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            dim_x=20,
-            dim_y=10,
-            dim_z=10,
-            cell_x=0.1,
-            cell_y=0.1,
-            cell_z=0.1,
-            density=100.0,
-            k_mu=50000.0,
-            k_lambda=20000.0,
-            k_damp=0.0,
-        )
-
-        b = builder.add_body(origin=wp.transform((0.5, 2.5, 0.5), wp.quat_identity()))
-        builder.add_shape_sphere(body=b, radius=0.75, density=100.0)
-
-        self.model = builder.finalize()
-        self.model.ground = True
-        self.model.soft_contact_ke = 1.0e3
-        self.model.soft_contact_kd = 0.0
-        self.model.soft_contact_kf = 1.0e3
-
-        self.integrator = wp.sim.SemiImplicitIntegrator()
-
-        self.state_0 = self.model.state()
-        self.state_1 = self.model.state()
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path, scaling=1.0)
-        else:
-            self.renderer = None
-
-        self.use_cuda_graph = wp.get_device().is_cuda
-        if self.use_cuda_graph:
-            with wp.ScopedCapture() as capture:
-                self.simulate()
-            self.graph = capture.graph
-
-    def simulate(self):
-        for _s in range(self.sim_substeps):
-            wp.sim.collide(self.model, self.state_0)
-
-            self.state_0.clear_forces()
-            self.state_1.clear_forces()
-
-            self.integrator.simulate(self.model, self.state_0, self.state_1, self.sim_dt)
-
-            # swap states
-            (self.state_0, self.state_1) = (self.state_1, self.state_0)
-
-    def step(self):
-        with wp.ScopedTimer("step", dict=self.profiler):
-            if self.use_cuda_graph:
-                wp.capture_launch(self.graph)
-            else:
-                self.simulate()
-            self.sim_time += self.frame_dt
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            self.renderer.begin_frame(self.sim_time)
-            self.renderer.render(self.state_0)
-            self.renderer.end_frame()
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_rigid_soft_contact.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--num_frames", type=int, default=300, help="Total number of frames.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path)
-
-        for _ in range(args.num_frames):
-            example.step()
-            example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/sim/example_soft_body.py b/warp/examples/sim/example_soft_body.py
deleted file mode 100644
index 049a3d01..00000000
--- a/warp/examples/sim/example_soft_body.py
+++ /dev/null
@@ -1,196 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Sim Neo-Hookean
-#
-# Shows a simulation of an Neo-Hookean FEM beam being twisted through a
-# 180 degree rotation.
-#
-###########################################################################
-import math
-
-import warp as wp
-import warp.sim
-import warp.sim.render
-
-
-@wp.kernel
-def twist_points(
-    rest: wp.array(dtype=wp.vec3), points: wp.array(dtype=wp.vec3), mass: wp.array(dtype=float), xform: wp.transform
-):
-    tid = wp.tid()
-
-    r = rest[tid]
-    p = points[tid]
-    m = mass[tid]
-
-    # twist the top layer of particles in the beam
-    if m == 0 and p[1] != 0.0:
-        points[tid] = wp.transform_point(xform, r)
-
-
-@wp.kernel
-def compute_volume(points: wp.array(dtype=wp.vec3), indices: wp.array2d(dtype=int), volume: wp.array(dtype=float)):
-    tid = wp.tid()
-
-    i = indices[tid, 0]
-    j = indices[tid, 1]
-    k = indices[tid, 2]
-    l = indices[tid, 3]
-
-    x0 = points[i]
-    x1 = points[j]
-    x2 = points[k]
-    x3 = points[l]
-
-    x10 = x1 - x0
-    x20 = x2 - x0
-    x30 = x3 - x0
-
-    v = wp.dot(x10, wp.cross(x20, x30)) / 6.0
-
-    wp.atomic_add(volume, 0, v)
-
-
-class Example:
-    def __init__(self, stage_path="example_soft_body.usd", num_frames=300):
-        self.sim_substeps = 64
-        self.num_frames = num_frames
-        fps = 60
-        sim_duration = self.num_frames / fps
-        self.frame_dt = 1.0 / fps
-        self.sim_dt = self.frame_dt / self.sim_substeps
-        self.sim_time = 0.0
-        self.lift_speed = 2.5 / sim_duration * 2.0  # from Smith et al.
-        self.rot_speed = math.pi / sim_duration
-
-        builder = wp.sim.ModelBuilder()
-
-        cell_dim = 15
-        cell_size = 2.0 / cell_dim
-
-        center = cell_size * cell_dim * 0.5
-
-        builder.add_soft_grid(
-            pos=wp.vec3(-center, 0.0, -center),
-            rot=wp.quat_identity(),
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            dim_x=cell_dim,
-            dim_y=cell_dim,
-            dim_z=cell_dim,
-            cell_x=cell_size,
-            cell_y=cell_size,
-            cell_z=cell_size,
-            density=100.0,
-            fix_bottom=True,
-            fix_top=True,
-            k_mu=1000.0,
-            k_lambda=5000.0,
-            k_damp=0.0,
-        )
-
-        self.model = builder.finalize()
-        self.model.ground = False
-        self.model.gravity[1] = 0.0
-
-        self.integrator = wp.sim.SemiImplicitIntegrator()
-
-        self.rest = self.model.state()
-        self.rest_vol = (cell_size * cell_dim) ** 3
-
-        self.state_0 = self.model.state()
-        self.state_1 = self.model.state()
-
-        self.volume = wp.zeros(1, dtype=wp.float32)
-
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path, scaling=20.0)
-        else:
-            self.renderer = None
-
-        self.use_cuda_graph = wp.get_device().is_cuda
-        if self.use_cuda_graph:
-            with wp.ScopedCapture() as capture:
-                self.simulate()
-            self.graph = capture.graph
-
-    def simulate(self):
-        for _ in range(self.sim_substeps):
-            self.state_0.clear_forces()
-            self.state_1.clear_forces()
-
-            self.integrator.simulate(self.model, self.state_0, self.state_1, self.sim_dt)
-
-            # swap states
-            (self.state_0, self.state_1) = (self.state_1, self.state_0)
-
-    def step(self):
-        with wp.ScopedTimer("step"):
-            xform = wp.transform(
-                (0.0, self.lift_speed * self.sim_time, 0.0),
-                wp.quat_from_axis_angle(wp.vec3(0.0, 1.0, 0.0), self.rot_speed * self.sim_time),
-            )
-            wp.launch(
-                kernel=twist_points,
-                dim=len(self.state_0.particle_q),
-                inputs=[self.rest.particle_q, self.state_0.particle_q, self.model.particle_mass, xform],
-            )
-            if self.use_cuda_graph:
-                wp.capture_launch(self.graph)
-            else:
-                self.simulate()
-            self.volume.zero_()
-            wp.launch(
-                kernel=compute_volume,
-                dim=self.model.tet_count,
-                inputs=[self.state_0.particle_q, self.model.tet_indices, self.volume],
-            )
-        self.sim_time += self.frame_dt
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            self.renderer.begin_frame(self.sim_time)
-            self.renderer.render(self.state_0)
-            self.renderer.end_frame()
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_soft_body.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--num_frames", type=int, default=300, help="Total number of frames.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path, num_frames=args.num_frames)
-
-        for _ in range(args.num_frames):
-            example.step()
-            example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/examples/tile/example_tile_walker.py b/warp/examples/tile/example_tile_walker.py
deleted file mode 100644
index 4045ea7a..00000000
--- a/warp/examples/tile/example_tile_walker.py
+++ /dev/null
@@ -1,327 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2025 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-###########################################################################
-# Example Tile Walker
-#
-# Trains a tetrahedral mesh quadruped to run. Feeds 8 time-varying input
-# phases as inputs into a single layer fully connected network with a tanh
-# activation function. Interprets the output of the network as tet
-# activations, which are fed into the wp.sim soft mesh model. This is
-# simulated forward in time and then evaluated based on the center of mass
-# momentum of the mesh.
-#
-# This example uses the Warp tile API, which as of Warp 1.6 is the
-# recommended way to handle matrix multiplication. example_walker.py in
-# examples/optim demonstrates the old way of doing matrix multiplication,
-# wp.matmul(), which will be deprecated in a future version.
-#
-###########################################################################
-
-import math
-import os
-
-import numpy as np
-from pxr import Gf, Usd, UsdGeom
-
-import warp as wp
-import warp.examples
-import warp.optim
-import warp.sim
-import warp.sim.render
-
-PHASE_COUNT = 8
-PHASE_STEP = wp.constant((2.0 * math.pi) / PHASE_COUNT)
-PHASE_FREQ = wp.constant(5.0)
-ACTIVATION_STRENGTH = wp.constant(0.3)
-
-TILE_TETS = wp.constant(8)
-TILE_THREADS = 64
-
-
-@wp.kernel
-def loss_kernel(com: wp.array(dtype=wp.vec3), loss: wp.array(dtype=float)):
-    tid = wp.tid()
-    vx = com[tid][0]
-    vy = com[tid][1]
-    vz = com[tid][2]
-    delta = wp.sqrt(vx * vx) + wp.sqrt(vy * vy) - vz
-
-    wp.atomic_add(loss, 0, delta)
-
-
-@wp.kernel
-def com_kernel(velocities: wp.array(dtype=wp.vec3), n: int, com: wp.array(dtype=wp.vec3)):
-    tid = wp.tid()
-    v = velocities[tid]
-    a = v / wp.float32(n)
-    wp.atomic_add(com, 0, a)
-
-
-@wp.kernel
-def compute_phases(phases: wp.array(dtype=float), sim_time: float):
-    tid = wp.tid()
-    phases[tid] = wp.sin(PHASE_FREQ * sim_time + wp.float32(tid) * PHASE_STEP)
-
-
-@wp.func
-def tanh(x: float):
-    return wp.tanh(x) * ACTIVATION_STRENGTH
-
-
-@wp.kernel
-def network(
-    phases: wp.array2d(dtype=float), weights: wp.array2d(dtype=float), tet_activations: wp.array2d(dtype=float)
-):
-    # output tile index
-    i = wp.tid()
-
-    # GEMM
-    p = wp.tile_load(phases, shape=(PHASE_COUNT, 1))
-    w = wp.tile_load(weights, shape=(TILE_TETS, PHASE_COUNT), offset=(i * TILE_TETS, 0))
-    out = wp.tile_matmul(w, p)
-
-    # activation
-    activations = wp.tile_map(tanh, out)
-    wp.tile_store(tet_activations, activations, offset=(i * TILE_TETS, 0))
-
-
-class Example:
-    def __init__(self, stage_path="example_tile_walker.usd", verbose=False, num_frames=300):
-        self.verbose = verbose
-
-        fps = 60
-        self.frame_dt = 1.0 / fps
-        self.num_frames = num_frames
-
-        self.sim_substeps = 80
-        self.sim_dt = self.frame_dt / self.sim_substeps
-        self.sim_time = 0.0
-
-        self.iter = 0
-        self.train_rate = 0.025
-
-        self.phase_count = PHASE_COUNT
-
-        self.render_time = 0.0
-
-        # bear
-        asset_stage = Usd.Stage.Open(os.path.join(warp.examples.get_asset_directory(), "bear.usd"))
-
-        geom = UsdGeom.Mesh(asset_stage.GetPrimAtPath("/root/bear"))
-        points = geom.GetPointsAttr().Get()
-
-        xform = Gf.Matrix4f(geom.ComputeLocalToWorldTransform(0.0))
-        for i in range(len(points)):
-            points[i] = xform.Transform(points[i])
-
-        self.points = [wp.vec3(point) for point in points]
-        self.tet_indices = geom.GetPrim().GetAttribute("tetraIndices").Get()
-
-        # sim model
-        builder = wp.sim.ModelBuilder()
-        builder.add_soft_mesh(
-            pos=wp.vec3(0.0, 0.5, 0.0),
-            rot=wp.quat_identity(),
-            scale=1.0,
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            vertices=self.points,
-            indices=self.tet_indices,
-            density=1.0,
-            k_mu=2000.0,
-            k_lambda=2000.0,
-            k_damp=2.0,
-            tri_ke=0.0,
-            tri_ka=1e-8,
-            tri_kd=0.0,
-            tri_drag=0.0,
-            tri_lift=0.0,
-        )
-
-        # finalize model
-        self.model = builder.finalize(requires_grad=True)
-        self.control = self.model.control()
-
-        self.model.soft_contact_ke = 2.0e3
-        self.model.soft_contact_kd = 0.1
-        self.model.soft_contact_kf = 10.0
-        self.model.soft_contact_mu = 0.7
-
-        radii = wp.zeros(self.model.particle_count, dtype=float)
-        radii.fill_(0.05)
-        self.model.particle_radius = radii
-        self.model.ground = True
-
-        # allocate sim states
-        self.states = []
-        for _i in range(self.num_frames * self.sim_substeps + 1):
-            self.states.append(self.model.state(requires_grad=True))
-
-        # initialize the integrator.
-        self.integrator = wp.sim.SemiImplicitIntegrator()
-
-        # model input
-        self.phases = []
-        for _i in range(self.num_frames):
-            self.phases.append(wp.zeros(self.phase_count, dtype=float, requires_grad=True))
-
-        # weights matrix for linear network
-        rng = np.random.default_rng(42)
-        k = 1.0 / self.phase_count
-        weights = rng.uniform(-np.sqrt(k), np.sqrt(k), (self.model.tet_count, self.phase_count))
-        self.weights = wp.array(weights, dtype=float, requires_grad=True)
-
-        # tanh activation layer array
-        self.tet_activations = []
-        for _i in range(self.num_frames):
-            self.tet_activations.append(wp.zeros(self.model.tet_count, dtype=float, requires_grad=True))
-
-        # optimization
-        self.loss = wp.zeros(1, dtype=float, requires_grad=True)
-        self.coms = []
-        for _i in range(self.num_frames):
-            self.coms.append(wp.zeros(1, dtype=wp.vec3, requires_grad=True))
-        self.optimizer = warp.optim.Adam([self.weights.flatten()], lr=self.train_rate)
-
-        # rendering
-        if stage_path:
-            self.renderer = wp.sim.render.SimRenderer(self.model, stage_path)
-        else:
-            self.renderer = None
-
-        # capture forward/backward passes
-        self.use_cuda_graph = wp.get_device().is_cuda
-        if self.use_cuda_graph:
-            with wp.ScopedCapture() as capture:
-                self.tape = wp.Tape()
-                with self.tape:
-                    for i in range(self.num_frames):
-                        self.forward(i)
-                self.tape.backward(self.loss)
-            self.graph = capture.graph
-
-    def forward(self, frame):
-        with wp.ScopedTimer("network", active=self.verbose):
-            # build sinusoidal input phases
-            wp.launch(kernel=compute_phases, dim=self.phase_count, inputs=[self.phases[frame], self.sim_time])
-
-            # apply linear network with tanh activation
-            wp.launch_tiled(
-                kernel=network,
-                dim=math.ceil(self.model.tet_count / TILE_TETS),
-                inputs=[self.phases[frame].reshape((self.phase_count, 1)), self.weights],
-                outputs=[self.tet_activations[frame].reshape((self.model.tet_count, 1))],
-                block_dim=TILE_THREADS,
-            )
-            self.control.tet_activations = self.tet_activations[frame]
-
-        with wp.ScopedTimer("simulate", active=self.verbose):
-            # run simulation loop
-            for i in range(self.sim_substeps):
-                self.states[frame * self.sim_substeps + i].clear_forces()
-                self.integrator.simulate(
-                    self.model,
-                    self.states[frame * self.sim_substeps + i],
-                    self.states[frame * self.sim_substeps + i + 1],
-                    self.sim_dt,
-                    self.control,
-                )
-                self.sim_time += self.sim_dt
-
-        with wp.ScopedTimer("loss", active=self.verbose):
-            # compute center of mass velocity
-            wp.launch(
-                com_kernel,
-                dim=self.model.particle_count,
-                inputs=[
-                    self.states[(frame + 1) * self.sim_substeps].particle_qd,
-                    self.model.particle_count,
-                    self.coms[frame],
-                ],
-                outputs=[],
-            )
-            # compute loss
-            wp.launch(loss_kernel, dim=1, inputs=[self.coms[frame], self.loss], outputs=[])
-
-    def step(self):
-        with wp.ScopedTimer("step"):
-            if self.use_cuda_graph:
-                wp.capture_launch(self.graph)
-            else:
-                self.tape = wp.Tape()
-                with self.tape:
-                    for i in range(self.num_frames):
-                        self.forward(i)
-                self.tape.backward(self.loss)
-
-            # optimization
-            x = self.weights.grad.flatten()
-            self.optimizer.step([x])
-
-        loss = self.loss.numpy()
-        if self.verbose:
-            print(f"Iteration {self.iter}: {loss}")
-
-        # reset sim
-        self.sim_time = 0.0
-        self.states[0] = self.model.state(requires_grad=True)
-
-        # clear grads and zero arrays for next iteration
-        self.tape.zero()
-        self.loss.zero_()
-        for i in range(self.num_frames):
-            self.coms[i].zero_()
-
-        self.iter += 1
-
-    def render(self):
-        if self.renderer is None:
-            return
-
-        with wp.ScopedTimer("render"):
-            for i in range(self.num_frames + 1):
-                self.renderer.begin_frame(self.render_time)
-                self.renderer.render(self.states[i * self.sim_substeps])
-                self.renderer.end_frame()
-
-                self.render_time += self.frame_dt
-
-
-if __name__ == "__main__":
-    import argparse
-
-    parser = argparse.ArgumentParser(formatter_class=argparse.ArgumentDefaultsHelpFormatter)
-    parser.add_argument("--device", type=str, default=None, help="Override the default Warp device.")
-    parser.add_argument(
-        "--stage_path",
-        type=lambda x: None if x == "None" else str(x),
-        default="example_tile_walker.usd",
-        help="Path to the output USD file.",
-    )
-    parser.add_argument("--num_frames", type=int, default=300, help="Total number of frames per training iteration.")
-    parser.add_argument("--train_iters", type=int, default=30, help="Total number of training iterations.")
-    parser.add_argument("--verbose", action="store_true", help="Print out additional status messages during execution.")
-
-    args = parser.parse_known_args()[0]
-
-    with wp.ScopedDevice(args.device):
-        example = Example(stage_path=args.stage_path, verbose=args.verbose, num_frames=args.num_frames)
-
-        for _ in range(args.train_iters):
-            example.step()
-            example.render()
-
-        if example.renderer:
-            example.renderer.save()
diff --git a/warp/fem/dirichlet.py b/warp/fem/dirichlet.py
index d37dc26c..0caf39f4 100644
--- a/warp/fem/dirichlet.py
+++ b/warp/fem/dirichlet.py
@@ -132,7 +132,7 @@ def project_linear_system(
 @wp.func
 def _normalize_projector_and_value(A: Any, b: Any):
     # Do a modal decomposition of the left and right hand side,
-    # Make lhs an orthogonal projection and apply corresponding scaling to righ-hand-side
+    # Make lhs an orthogonal projection and apply corresponding scaling to right-hand side
 
     eps = wp.trace(A) * A.dtype(1.0e-6)
 
diff --git a/warp/fem/geometry/quadmesh.py b/warp/fem/geometry/quadmesh.py
index 98120fdf..8a59bd41 100644
--- a/warp/fem/geometry/quadmesh.py
+++ b/warp/fem/geometry/quadmesh.py
@@ -457,7 +457,7 @@ class Quadmesh(Geometry):
         q = pos - p0
         e = args.positions[edge_idx[1]] - p0
 
-        dist, t = project_on_seg_at_origin(q, e, wp.lengh_sq(e))
+        dist, t = project_on_seg_at_origin(q, e, wp.length_sq(e))
         return Coords(t, 0.0, 0.0), dist
 
     @wp.func
diff --git a/warp/fem/geometry/trimesh.py b/warp/fem/geometry/trimesh.py
index ba2d2ad2..ca05842e 100644
--- a/warp/fem/geometry/trimesh.py
+++ b/warp/fem/geometry/trimesh.py
@@ -467,7 +467,7 @@ class Trimesh(Geometry):
         q = pos - p0
         e = args.positions[edge_idx[1]] - p0
 
-        dist, t = project_on_seg_at_origin(q, e, wp.lengh_sq(e))
+        dist, t = project_on_seg_at_origin(q, e, wp.length_sq(e))
         return Coords(t, 0.0, 0.0), dist
 
     @wp.func
diff --git a/warp/fem/space/function_space.py b/warp/fem/space/function_space.py
index 5db1009b..9cdcfeff 100644
--- a/warp/fem/space/function_space.py
+++ b/warp/fem/space/function_space.py
@@ -243,7 +243,7 @@ class FunctionSpace:
          - node_weight: weight associated to the node, as given per `element_(inn|out)er_weight`
          - local_value_map: local transformation from node space to world space, as given per `local_map_value_(inn|out)er`
         """
-        raise NotADirectoryError
+        raise NotImplementedError
 
     def space_gradient(
         dof_value: "FunctionSpace.dof_dtype",
@@ -257,7 +257,7 @@ class FunctionSpace:
          - dof_value: node value in the degrees-of-freedom basis
          - node_weight_gradient: gradient of the weight associated to the node, as given per `element_(inn|out)er_weight_gradient`
          - local_value_map: local transformation from node space to world space, as given per `local_map_value_(inn|out)er`
-         - grad_transform: transform mapping the reference space gradient to worls-space gradient (inverse deformation gradient)
+         - grad_transform: transform mapping the reference-space gradient to world-space gradient (inverse deformation gradient)
         """
         raise NotImplementedError
 
@@ -273,7 +273,7 @@ class FunctionSpace:
          - dof_value: node value in the degrees-of-freedom basis
          - node_weight_gradient: gradient of the weight associated to the node, as given per `element_(inn|out)er_weight_gradient`
          - local_value_map: local transformation from node space to world space, as given per `local_map_value_(inn|out)er`
-         - grad_transform: transform mapping the reference space gradient to worls-space gradient (inverse deformation gradient)
+         - grad_transform: transform mapping the reference-space gradient to world-space gradient (inverse deformation gradient)
         """
         raise NotImplementedError
 
diff --git a/warp/fem/space/partition.py b/warp/fem/space/partition.py
index 96fe90d9..cc83d593 100644
--- a/warp/fem/space/partition.py
+++ b/warp/fem/space/partition.py
@@ -310,7 +310,7 @@ class NodePartition(SpacePartition):
                 inputs=[category_offsets.array, node_indices.array, self._space_to_partition.array],
             )
 
-            # Copy to shrinked-to-fit array
+            # Copy to shrunk-to-fit array
             cache.synchronize_event(copy_event)  # Transfer to host must be finished to access node_count()
             self._node_indices = cache.borrow_temporary(
                 temporary_store, shape=(self.node_count()), dtype=int, device=device
diff --git a/warp/jax_experimental/ffi.py b/warp/jax_experimental/ffi.py
index 38d6fafd..9f7f8dc3 100644
--- a/warp/jax_experimental/ffi.py
+++ b/warp/jax_experimental/ffi.py
@@ -13,6 +13,7 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
+import collections
 import ctypes
 import threading
 import traceback
@@ -28,6 +29,21 @@ from warp.types import array_t, launch_bounds_t, strides_from_shape, type_to_war
 
 from .xla_ffi import *
 
+jax_callable_default_graph_cache_max: int | None = 32
+"""
+Maximum size of the graph cache for graphs captured using ``GraphMode.WARP``, unlimited if ``None``.
+Example usage: ``warp.jax_experimental.ffi.jax_callable_default_graph_cache_max = 42``.
+"""
+
+# Holders for the custom callbacks to keep them alive.
+_FFI_KERNEL_REGISTRY: dict[str, "FfiKernel"] = {}
+_FFI_CALLABLE_REGISTRY: dict[str, "FfiCallable"] = {}
+_FFI_CALLBACK_REGISTRY: dict[str, ctypes.CFUNCTYPE] = {}
+_FFI_REGISTRY_LOCK = threading.Lock()
+
+# Lock when XLA invokes callbacks from multiple threads.
+_FFI_CALLBACK_LOCK = threading.Lock()
+
 
 def check_jax_version():
     # check if JAX version supports this
@@ -47,6 +63,12 @@ class GraphMode(IntEnum):
     WARP = 2  # let Warp capture a graph
 
 
+class ModulePreloadMode(IntEnum):
+    NONE = 0  # don't preload modules
+    CURRENT_DEVICE = 1  # preload on currently active device
+    ALL_DEVICES = 2  # preload on all supported devices
+
+
 class FfiArg:
     def __init__(self, name, type, in_out=False):
         self.name = name
@@ -85,13 +107,16 @@ class FfiLaunchDesc:
 
 
 class FfiKernel:
-    def __init__(self, kernel, num_outputs, vmap_method, launch_dims, output_dims, in_out_argnames):
+    def __init__(
+        self, kernel, num_outputs, vmap_method, launch_dims, output_dims, in_out_argnames, module_preload_mode
+    ):
         self.kernel = kernel
         self.name = generate_unique_name(kernel.func)
         self.num_outputs = num_outputs
         self.vmap_method = vmap_method
         self.launch_dims = launch_dims
         self.output_dims = output_dims
+        self.module_preload_mode = module_preload_mode
         self.first_array_arg = None
         self.launch_id = 0
         self.launch_descriptors = {}
@@ -244,9 +269,20 @@ class FfiKernel:
             input_output_aliases=self.input_output_aliases,
         )
 
-        # ensure the kernel module is loaded before the callback, otherwise graph capture may fail
-        device = wp.device_from_jax(get_jax_device())
-        self.kernel.module.load(device)
+        # preload on the specified devices
+        if self.module_preload_mode == ModulePreloadMode.CURRENT_DEVICE:
+            device = wp.device_from_jax(get_jax_device())
+            self.kernel.module.load(device)
+        elif self.module_preload_mode == ModulePreloadMode.ALL_DEVICES:
+            for d in jax.local_devices():
+                try:
+                    dev = wp.device_from_jax(d)
+                except Exception:
+                    # ignore unsupported devices like TPUs
+                    pass
+                # we only support CUDA devices for now
+                if dev.is_cuda:
+                    self.kernel.module.load(dev)
 
         # save launch data to be retrieved by callback
         launch_id = self.launch_id
@@ -273,72 +309,75 @@ class FfiKernel:
                     )
                     return None
 
-            # retrieve call info
-            attrs = decode_attrs(call_frame.contents.attrs)
-            launch_id = int(attrs["launch_id"])
-            launch_desc = self.launch_descriptors[launch_id]
-
-            num_inputs = call_frame.contents.args.size
-            inputs = ctypes.cast(call_frame.contents.args.args, ctypes.POINTER(ctypes.POINTER(XLA_FFI_Buffer)))
-
-            num_outputs = call_frame.contents.rets.size
-            outputs = ctypes.cast(call_frame.contents.rets.rets, ctypes.POINTER(ctypes.POINTER(XLA_FFI_Buffer)))
-
-            assert num_inputs == self.num_inputs
-            assert num_outputs == self.num_outputs
-
-            launch_bounds = launch_bounds_t(launch_desc.launch_dims)
-
-            # first kernel param is the launch bounds
-            kernel_params = (ctypes.c_void_p * (1 + self.num_kernel_args))()
-            kernel_params[0] = ctypes.addressof(launch_bounds)
-
-            arg_refs = []
-
-            # input and in-out args
-            for i, input_arg in enumerate(self.input_args):
-                if input_arg.is_array:
-                    buffer = inputs[i].contents
-                    shape = buffer.dims[: input_arg.type.ndim]
-                    strides = strides_from_shape(shape, input_arg.type.dtype)
-                    arg = array_t(buffer.data, 0, input_arg.type.ndim, shape, strides)
-                    kernel_params[i + 1] = ctypes.addressof(arg)
+            # Lock is required to prevent race conditions when callback is invoked
+            # from multiple threads, like with pmap.
+            with _FFI_CALLBACK_LOCK:
+                # retrieve call info
+                attrs = decode_attrs(call_frame.contents.attrs)
+                launch_id = int(attrs["launch_id"])
+                launch_desc = self.launch_descriptors[launch_id]
+
+                num_inputs = call_frame.contents.args.size
+                inputs = ctypes.cast(call_frame.contents.args.args, ctypes.POINTER(ctypes.POINTER(XLA_FFI_Buffer)))
+
+                num_outputs = call_frame.contents.rets.size
+                outputs = ctypes.cast(call_frame.contents.rets.rets, ctypes.POINTER(ctypes.POINTER(XLA_FFI_Buffer)))
+
+                assert num_inputs == self.num_inputs
+                assert num_outputs == self.num_outputs
+
+                launch_bounds = launch_bounds_t(launch_desc.launch_dims)
+
+                # first kernel param is the launch bounds
+                kernel_params = (ctypes.c_void_p * (1 + self.num_kernel_args))()
+                kernel_params[0] = ctypes.addressof(launch_bounds)
+
+                arg_refs = []
+
+                # input and in-out args
+                for i, input_arg in enumerate(self.input_args):
+                    if input_arg.is_array:
+                        buffer = inputs[i].contents
+                        shape = buffer.dims[: input_arg.type.ndim]
+                        strides = strides_from_shape(shape, input_arg.type.dtype)
+                        arg = array_t(buffer.data, 0, input_arg.type.ndim, shape, strides)
+                        kernel_params[i + 1] = ctypes.addressof(arg)
+                        arg_refs.append(arg)  # keep a reference
+                    else:
+                        # scalar argument, get stashed value
+                        value = launch_desc.static_inputs[input_arg.name]
+                        arg = input_arg.type._type_(value)
+                        kernel_params[i + 1] = ctypes.addressof(arg)
+                        arg_refs.append(arg)  # keep a reference
+
+                # pure output args (skip in-out FFI buffers)
+                for i, output_arg in enumerate(self.output_args):
+                    buffer = outputs[i + self.num_in_out].contents
+                    shape = buffer.dims[: output_arg.type.ndim]
+                    strides = strides_from_shape(shape, output_arg.type.dtype)
+                    arg = array_t(buffer.data, 0, output_arg.type.ndim, shape, strides)
+                    kernel_params[num_inputs + i + 1] = ctypes.addressof(arg)
                     arg_refs.append(arg)  # keep a reference
-                else:
-                    # scalar argument, get stashed value
-                    value = launch_desc.static_inputs[input_arg.name]
-                    arg = input_arg.type._type_(value)
-                    kernel_params[i + 1] = ctypes.addressof(arg)
-                    arg_refs.append(arg)  # keep a reference
-
-            # pure output args (skip in-out FFI buffers)
-            for i, output_arg in enumerate(self.output_args):
-                buffer = outputs[i + self.num_in_out].contents
-                shape = buffer.dims[: output_arg.type.ndim]
-                strides = strides_from_shape(shape, output_arg.type.dtype)
-                arg = array_t(buffer.data, 0, output_arg.type.ndim, shape, strides)
-                kernel_params[num_inputs + i + 1] = ctypes.addressof(arg)
-                arg_refs.append(arg)  # keep a reference
 
-            # get device and stream
-            device = wp.device_from_jax(get_jax_device())
-            stream = get_stream_from_callframe(call_frame.contents)
-
-            # get kernel hooks
-            hooks = self.kernel.module.get_kernel_hooks(self.kernel, device)
-            assert hooks.forward, "Failed to find kernel entry point"
-
-            # launch the kernel
-            wp.context.runtime.core.wp_cuda_launch_kernel(
-                device.context,
-                hooks.forward,
-                launch_bounds.size,
-                0,
-                256,
-                hooks.forward_smem_bytes,
-                kernel_params,
-                stream,
-            )
+                # get device and stream
+                device = wp.get_cuda_device(get_device_ordinal_from_callframe(call_frame.contents))
+                stream = get_stream_from_callframe(call_frame.contents)
+
+                # get kernel hooks
+                hooks = self.kernel.module.get_kernel_hooks(self.kernel, device)
+                assert hooks.forward, "Failed to find kernel entry point"
+
+                # launch the kernel
+                wp.context.runtime.core.wp_cuda_launch_kernel(
+                    device.context,
+                    hooks.forward,
+                    launch_bounds.size,
+                    0,
+                    256,
+                    hooks.forward_smem_bytes,
+                    kernel_params,
+                    stream,
+                )
 
         except Exception as e:
             print(traceback.format_exc())
@@ -350,21 +389,35 @@ class FfiKernel:
 class FfiCallDesc:
     def __init__(self, static_inputs):
         self.static_inputs = static_inputs
-        self.captures = {}
 
 
 class FfiCallable:
-    def __init__(self, func, num_outputs, graph_mode, vmap_method, output_dims, in_out_argnames):
+    def __init__(
+        self,
+        func,
+        num_outputs,
+        graph_mode,
+        vmap_method,
+        output_dims,
+        in_out_argnames,
+        graph_cache_max,
+        module_preload_mode,
+    ):
         self.func = func
         self.name = generate_unique_name(func)
         self.num_outputs = num_outputs
         self.vmap_method = vmap_method
         self.graph_mode = graph_mode
         self.output_dims = output_dims
+        self.module_preload_mode = module_preload_mode
         self.first_array_arg = None
         self.call_id = 0
         self.call_descriptors = {}
 
+        # LRU cache of graphs captured by Warp
+        self._graph_cache_max = graph_cache_max
+        self.captures = collections.OrderedDict()
+
         in_out_argnames_list = in_out_argnames or []
         in_out_argnames = set(in_out_argnames_list)
         if len(in_out_argnames_list) != len(in_out_argnames):
@@ -516,11 +569,22 @@ class FfiCallable:
             # has_side_effect=True,  # force this function to execute even if outputs aren't used
         )
 
-        # load the module
+        # preload on the specified devices
         # NOTE: if the target function uses kernels from different modules, they will not be loaded here
-        device = wp.device_from_jax(get_jax_device())
         module = wp.get_module(self.func.__module__)
-        module.load(device)
+        if self.module_preload_mode == ModulePreloadMode.CURRENT_DEVICE:
+            device = wp.device_from_jax(get_jax_device())
+            module.load(device)
+        elif self.module_preload_mode == ModulePreloadMode.ALL_DEVICES:
+            for d in jax.local_devices():
+                try:
+                    dev = wp.device_from_jax(d)
+                except Exception:
+                    # ignore unsupported devices like TPUs
+                    pass
+                # we only support CUDA devices for now
+                if dev.is_cuda:
+                    module.load(dev)
 
         # save call data to be retrieved by callback
         call_id = self.call_id
@@ -547,95 +611,105 @@ class FfiCallable:
                         )
                     return None
 
-            # retrieve call info
-            # NOTE: this assumes that there's only one attribute - call_id (int64).
-            # A more general but slower approach is this:
-            #   attrs = decode_attrs(call_frame.contents.attrs)
-            #   call_id = int(attrs["call_id"])
-            attr = ctypes.cast(call_frame.contents.attrs.attrs[0], ctypes.POINTER(XLA_FFI_Scalar)).contents
-            call_id = ctypes.cast(attr.value, ctypes.POINTER(ctypes.c_int64)).contents.value
-            call_desc = self.call_descriptors[call_id]
-
-            num_inputs = call_frame.contents.args.size
-            inputs = ctypes.cast(call_frame.contents.args.args, ctypes.POINTER(ctypes.POINTER(XLA_FFI_Buffer)))
-
-            num_outputs = call_frame.contents.rets.size
-            outputs = ctypes.cast(call_frame.contents.rets.rets, ctypes.POINTER(ctypes.POINTER(XLA_FFI_Buffer)))
-
-            assert num_inputs == self.num_inputs
-            assert num_outputs == self.num_outputs
-
-            cuda_stream = get_stream_from_callframe(call_frame.contents)
-
-            if self.graph_mode == GraphMode.WARP:
-                # check if we already captured an identical call
-                ip = [inputs[i].contents.data for i in self.array_input_indices]
-                op = [outputs[i].contents.data for i in self.array_output_indices]
-                buffer_hash = hash((*ip, *op))
-                capture = call_desc.captures.get(buffer_hash)
-
-                # launch existing graph
-                if capture is not None:
-                    # NOTE: We use the native graph API to avoid overhead with obtaining Stream and Device objects in Python.
-                    # This code should match wp.capture_launch().
-                    graph = capture.graph
-                    if graph.graph_exec is None:
-                        g = ctypes.c_void_p()
-                        if not wp.context.runtime.core.wp_cuda_graph_create_exec(
-                            graph.device.context, cuda_stream, graph.graph, ctypes.byref(g)
-                        ):
-                            raise RuntimeError(f"Graph creation error: {wp.context.runtime.get_error_string()}")
-                        graph.graph_exec = g
-
-                    if not wp.context.runtime.core.wp_cuda_graph_launch(graph.graph_exec, cuda_stream):
-                        raise RuntimeError(f"Graph launch error: {wp.context.runtime.get_error_string()}")
-
-                    # early out
-                    return
-
-            device = wp.device_from_jax(get_jax_device())
-            stream = wp.Stream(device, cuda_stream=cuda_stream)
-
-            # reconstruct the argument list
-            arg_list = []
-
-            # input and in-out args
-            for i, arg in enumerate(self.input_args):
-                if arg.is_array:
-                    buffer = inputs[i].contents
+            # Lock is required to prevent race conditions when callback is invoked
+            # from multiple threads, like with pmap.
+            with _FFI_CALLBACK_LOCK:
+                # retrieve call info
+                # NOTE: this assumes that there's only one attribute - call_id (int64).
+                # A more general but slower approach is this:
+                #   attrs = decode_attrs(call_frame.contents.attrs)
+                #   call_id = int(attrs["call_id"])
+                attr = ctypes.cast(call_frame.contents.attrs.attrs[0], ctypes.POINTER(XLA_FFI_Scalar)).contents
+                call_id = ctypes.cast(attr.value, ctypes.POINTER(ctypes.c_int64)).contents.value
+                call_desc = self.call_descriptors[call_id]
+
+                num_inputs = call_frame.contents.args.size
+                inputs = ctypes.cast(call_frame.contents.args.args, ctypes.POINTER(ctypes.POINTER(XLA_FFI_Buffer)))
+
+                num_outputs = call_frame.contents.rets.size
+                outputs = ctypes.cast(call_frame.contents.rets.rets, ctypes.POINTER(ctypes.POINTER(XLA_FFI_Buffer)))
+
+                assert num_inputs == self.num_inputs
+                assert num_outputs == self.num_outputs
+
+                cuda_stream = get_stream_from_callframe(call_frame.contents)
+
+                if self.graph_mode == GraphMode.WARP:
+                    # check if we already captured an identical call
+                    ip = [inputs[i].contents.data for i in self.array_input_indices]
+                    op = [outputs[i].contents.data for i in self.array_output_indices]
+                    capture_key = hash((call_id, *ip, *op))
+                    capture = self.captures.get(capture_key)
+
+                    # launch existing graph
+                    if capture is not None:
+                        # NOTE: We use the native graph API to avoid overhead with obtaining Stream and Device objects in Python.
+                        # This code should match wp.capture_launch().
+                        graph = capture.graph
+                        if graph.graph_exec is None:
+                            g = ctypes.c_void_p()
+                            if not wp.context.runtime.core.wp_cuda_graph_create_exec(
+                                graph.device.context, cuda_stream, graph.graph, ctypes.byref(g)
+                            ):
+                                raise RuntimeError(f"Graph creation error: {wp.context.runtime.get_error_string()}")
+                            graph.graph_exec = g
+
+                        if not wp.context.runtime.core.wp_cuda_graph_launch(graph.graph_exec, cuda_stream):
+                            raise RuntimeError(f"Graph launch error: {wp.context.runtime.get_error_string()}")
+
+                        # update the graph cache to keep recently used graphs alive
+                        self.captures.move_to_end(capture_key)
+
+                        # early out
+                        return
+
+                device_ordinal = get_device_ordinal_from_callframe(call_frame.contents)
+                device = wp.get_cuda_device(device_ordinal)
+                stream = wp.Stream(device, cuda_stream=cuda_stream)
+
+                # reconstruct the argument list
+                arg_list = []
+
+                # input and in-out args
+                for i, arg in enumerate(self.input_args):
+                    if arg.is_array:
+                        buffer = inputs[i].contents
+                        shape = buffer.dims[: buffer.rank - arg.dtype_ndim]
+                        arr = wp.array(ptr=buffer.data, dtype=arg.type.dtype, shape=shape, device=device)
+                        arg_list.append(arr)
+                    else:
+                        # scalar argument, get stashed value
+                        value = call_desc.static_inputs[arg.name]
+                        arg_list.append(value)
+
+                # pure output args (skip in-out FFI buffers)
+                for i, arg in enumerate(self.output_args):
+                    buffer = outputs[i + self.num_in_out].contents
                     shape = buffer.dims[: buffer.rank - arg.dtype_ndim]
                     arr = wp.array(ptr=buffer.data, dtype=arg.type.dtype, shape=shape, device=device)
                     arg_list.append(arr)
-                else:
-                    # scalar argument, get stashed value
-                    value = call_desc.static_inputs[arg.name]
-                    arg_list.append(value)
-
-            # pure output args (skip in-out FFI buffers)
-            for i, arg in enumerate(self.output_args):
-                buffer = outputs[i + self.num_in_out].contents
-                shape = buffer.dims[: buffer.rank - arg.dtype_ndim]
-                arr = wp.array(ptr=buffer.data, dtype=arg.type.dtype, shape=shape, device=device)
-                arg_list.append(arr)
-
-            # call the Python function with reconstructed arguments
-            with wp.ScopedStream(stream, sync_enter=False):
-                if stream.is_capturing:
-                    # capturing with JAX
-                    with wp.ScopedCapture(external=True) as capture:
-                        self.func(*arg_list)
-                    # keep a reference to the capture object to prevent required modules getting unloaded
-                    call_desc.capture = capture
-                elif self.graph_mode == GraphMode.WARP:
-                    # capturing with WARP
-                    with wp.ScopedCapture() as capture:
+
+                # call the Python function with reconstructed arguments
+                with wp.ScopedStream(stream, sync_enter=True):
+                    if stream.is_capturing:
+                        # capturing with JAX
+                        with wp.ScopedCapture(external=True) as capture:
+                            self.func(*arg_list)
+                        # keep a reference to the capture object to prevent required modules getting unloaded
+                        call_desc.capture = capture
+                    elif self.graph_mode == GraphMode.WARP:
+                        # capturing with WARP
+                        with wp.ScopedCapture() as capture:
+                            self.func(*arg_list)
+                        wp.capture_launch(capture.graph)
+                        # keep a reference to the capture object and reuse it with same buffers
+                        self.captures[capture_key] = capture
+                        # respect the cache size limit if specified
+                        if self._graph_cache_max is not None and len(self.captures) > self._graph_cache_max:
+                            self.captures.popitem(last=False)
+                    else:
+                        # not capturing
                         self.func(*arg_list)
-                    wp.capture_launch(capture.graph)
-                    # keep a reference to the capture object and reuse it with same buffers
-                    call_desc.captures[buffer_hash] = capture
-                else:
-                    # not capturing
-                    self.func(*arg_list)
 
         except Exception as e:
             print(traceback.format_exc())
@@ -645,15 +719,32 @@ class FfiCallable:
 
         return None
 
+    @property
+    def graph_cache_max(self) -> int | None:
+        return self._graph_cache_max
 
-# Holders for the custom callbacks to keep them alive.
-_FFI_CALLABLE_REGISTRY: dict[str, FfiCallable] = {}
-_FFI_KERNEL_REGISTRY: dict[str, FfiKernel] = {}
-_FFI_REGISTRY_LOCK = threading.Lock()
+    @graph_cache_max.setter
+    def graph_cache_max(self, value: int | None):
+        if value != self._graph_cache_max:
+            if value is not None and (self._graph_cache_max is None or value < self._graph_cache_max):
+                # trim the cache if needed
+                while len(self.captures) > value:
+                    self.captures.popitem(last=False)
+            self._graph_cache_max = value
+
+    @property
+    def graph_cache_size(self) -> int:
+        return len(self.captures)
 
 
 def jax_kernel(
-    kernel, num_outputs=1, vmap_method="broadcast_all", launch_dims=None, output_dims=None, in_out_argnames=None
+    kernel,
+    num_outputs=1,
+    vmap_method="broadcast_all",
+    launch_dims=None,
+    output_dims=None,
+    in_out_argnames=None,
+    module_preload_mode=ModulePreloadMode.CURRENT_DEVICE,
 ):
     """Create a JAX callback from a Warp kernel.
 
@@ -661,17 +752,18 @@ def jax_kernel(
 
     Args:
         kernel: The Warp kernel to launch.
-        num_outputs: Optional. Specify the number of output arguments if greater than 1.
+        num_outputs: Specify the number of output arguments if greater than 1.
                      This must include the number of ``in_out_arguments``.
-        vmap_method: Optional. String specifying how the callback transforms under ``vmap()``.
+        vmap_method: String specifying how the callback transforms under ``vmap()``.
                      This argument can also be specified for individual calls.
-        launch_dims: Optional. Specify the default kernel launch dimensions. If None, launch
+        launch_dims: Specify the default kernel launch dimensions. If None, launch
                      dimensions are inferred from the shape of the first array argument.
                      This argument can also be specified for individual calls.
-        output_dims: Optional. Specify the default dimensions of output arrays.  If None, output
+        output_dims: Specify the default dimensions of output arrays.  If None, output
                      dimensions are inferred from the launch dimensions.
                      This argument can also be specified for individual calls.
-        in_out_argnames: Optional. Names of input-output arguments.
+        in_out_argnames: Names of input-output arguments.
+        module_preload_mode: Specify the devices where the module should be preloaded.
 
     Limitations:
         - All kernel arguments must be contiguous arrays or scalars.
@@ -690,11 +782,14 @@ def jax_kernel(
         vmap_method,
         tuple(launch_dims) if launch_dims else launch_dims,
         tuple(sorted(output_dims.items())) if output_dims else output_dims,
+        module_preload_mode,
     )
 
     with _FFI_REGISTRY_LOCK:
         if key not in _FFI_KERNEL_REGISTRY:
-            new_kernel = FfiKernel(kernel, num_outputs, vmap_method, launch_dims, output_dims, in_out_argnames)
+            new_kernel = FfiKernel(
+                kernel, num_outputs, vmap_method, launch_dims, output_dims, in_out_argnames, module_preload_mode
+            )
             _FFI_KERNEL_REGISTRY[key] = new_kernel
 
     return _FFI_KERNEL_REGISTRY[key]
@@ -708,6 +803,8 @@ def jax_callable(
     vmap_method: Optional[str] = "broadcast_all",
     output_dims=None,
     in_out_argnames=None,
+    graph_cache_max: int | None = None,
+    module_preload_mode: ModulePreloadMode = ModulePreloadMode.CURRENT_DEVICE,
 ):
     """Create a JAX callback from an annotated Python function.
 
@@ -717,22 +814,25 @@ def jax_callable(
 
     Args:
         func: The Python function to call.
-        num_outputs: Optional. Specify the number of output arguments if greater than 1.
+        num_outputs: Specify the number of output arguments if greater than 1.
             This must include the number of ``in_out_arguments``.
-        graph_compatible: Optional. Whether the function can be called during CUDA graph capture.
+        graph_compatible: Whether the function can be called during CUDA graph capture.
             This argument is deprecated, use ``graph_mode`` instead.
-        graph_mode: Optional. CUDA graph capture mode.
-            ``GraphMode.JAX`` (default): Let JAX capture the graph, which may be used as a subgraph in an enclosing capture.
-            ``GraphMode.WARP``: Let Warp capture the graph. Use this mode when the callable cannot be used as a subraph,
+        graph_mode: CUDA graph capture mode.
+            ``GraphMode.JAX`` (default): Let JAX capture the graph, which may be used as a subgraph in an enclosing JAX capture.
+            ``GraphMode.WARP``: Let Warp capture the graph. Use this mode when the callable cannot be used as a subgraph,
             such as when the callable uses conditional graph nodes.
             ``GraphMode.NONE``: Disable graph capture. Use when the callable performs operations that are not legal in a graph,
             such as host synchronization.
-        vmap_method: Optional. String specifying how the callback transforms under ``vmap()``.
+        vmap_method: String specifying how the callback transforms under ``vmap()``.
             This argument can also be specified for individual calls.
-        output_dims: Optional. Specify the default dimensions of output arrays.
+        output_dims: Specify the default dimensions of output arrays.
             If ``None``, output dimensions are inferred from the launch dimensions.
             This argument can also be specified for individual calls.
-        in_out_argnames: Optional. Names of input-output arguments.
+        in_out_argnames: Names of input-output arguments.
+        graph_cache_max: Maximum number of cached graphs captured using ``GraphMode.WARP``.
+            If ``None``, use ``warp.jax_experimental.ffi.jax_callable_default_graph_cache_max``.
+        module_preload_mode: Specify the devices where the module should be preloaded.
 
     Limitations:
         - All kernel arguments must be contiguous arrays or scalars.
@@ -753,20 +853,50 @@ def jax_callable(
         if graph_compatible is False:
             graph_mode = GraphMode.NONE
 
+    if graph_cache_max is None:
+        graph_cache_max = jax_callable_default_graph_cache_max
+
+    # Note: we don't include graph_cache_max in the key, it is applied below.
     key = (
         func,
         num_outputs,
         graph_mode,
         vmap_method,
         tuple(sorted(output_dims.items())) if output_dims else output_dims,
+        module_preload_mode,
     )
 
     with _FFI_REGISTRY_LOCK:
-        if key not in _FFI_CALLABLE_REGISTRY:
-            new_callable = FfiCallable(func, num_outputs, graph_mode, vmap_method, output_dims, in_out_argnames)
-            _FFI_CALLABLE_REGISTRY[key] = new_callable
+        callable = _FFI_CALLABLE_REGISTRY.get(key)
+        if callable is None:
+            callable = FfiCallable(
+                func,
+                num_outputs,
+                graph_mode,
+                vmap_method,
+                output_dims,
+                in_out_argnames,
+                graph_cache_max,
+                module_preload_mode,
+            )
+            _FFI_CALLABLE_REGISTRY[key] = callable
+        else:
+            # make sure we're using the latest graph cache max
+            callable.graph_cache_max = graph_cache_max
 
-    return _FFI_CALLABLE_REGISTRY[key]
+    return callable
+
+
+def clear_jax_callable_graph_cache(callable: FfiCallable | None = None):
+    """Clear the graph cache of the given callable or all callables if ``None``."""
+
+    if callable is not None:
+        callable.captures.clear()
+    else:
+        # apply to all callables
+        with _FFI_REGISTRY_LOCK:
+            for callable in _FFI_CALLABLE_REGISTRY.values():
+                callable.captures.clear()
 
 
 ###############################################################################
@@ -787,7 +917,7 @@ def register_ffi_callback(name: str, func: Callable, graph_compatible: bool = Tr
     Args:
         name: A unique FFI callback name.
         func: The Python function to call.
-        graph_compatible: Optional. Whether the function can be called during CUDA graph capture.
+        graph_compatible: Whether the function can be called during CUDA graph capture.
     """
 
     check_jax_version()
@@ -813,19 +943,23 @@ def register_ffi_callback(name: str, func: Callable, graph_compatible: bool = Tr
                         )
                     return None
 
-            attrs = decode_attrs(call_frame.contents.attrs)
+            # Lock is required to prevent race conditions when callback is invoked
+            # from multiple threads, like with pmap.
+            with _FFI_CALLBACK_LOCK:
+                attrs = decode_attrs(call_frame.contents.attrs)
+
+                input_count = call_frame.contents.args.size
+                inputs = ctypes.cast(call_frame.contents.args.args, ctypes.POINTER(ctypes.POINTER(XLA_FFI_Buffer)))
+                inputs = [FfiBuffer(inputs[i].contents) for i in range(input_count)]
 
-            input_count = call_frame.contents.args.size
-            inputs = ctypes.cast(call_frame.contents.args.args, ctypes.POINTER(ctypes.POINTER(XLA_FFI_Buffer)))
-            inputs = [FfiBuffer(inputs[i].contents) for i in range(input_count)]
+                output_count = call_frame.contents.rets.size
+                outputs = ctypes.cast(call_frame.contents.rets.rets, ctypes.POINTER(ctypes.POINTER(XLA_FFI_Buffer)))
+                outputs = [FfiBuffer(outputs[i].contents) for i in range(output_count)]
 
-            output_count = call_frame.contents.rets.size
-            outputs = ctypes.cast(call_frame.contents.rets.rets, ctypes.POINTER(ctypes.POINTER(XLA_FFI_Buffer)))
-            outputs = [FfiBuffer(outputs[i].contents) for i in range(output_count)]
+                ctx = ExecutionContext(call_frame.contents)
 
-            ctx = ExecutionContext(call_frame.contents)
+                func(inputs, outputs, attrs, ctx)
 
-            func(inputs, outputs, attrs, ctx)
         except Exception as e:
             print(traceback.format_exc())
             return create_ffi_error(
@@ -837,7 +971,7 @@ def register_ffi_callback(name: str, func: Callable, graph_compatible: bool = Tr
     FFI_CCALLFUNC = ctypes.CFUNCTYPE(ctypes.c_void_p, ctypes.POINTER(XLA_FFI_CallFrame))
     callback_func = FFI_CCALLFUNC(ffi_callback)
     with _FFI_REGISTRY_LOCK:
-        _FFI_CALLABLE_REGISTRY[name] = callback_func
+        _FFI_CALLBACK_REGISTRY[name] = callback_func
     ffi_ccall_address = ctypes.cast(callback_func, ctypes.c_void_p)
     ffi_capsule = jax.ffi.pycapsule(ffi_ccall_address.value)
     jax.ffi.register_ffi_target(name, ffi_capsule, platform="CUDA")
diff --git a/warp/jax_experimental/xla_ffi.py b/warp/jax_experimental/xla_ffi.py
index 8e311143..c3aa51bd 100644
--- a/warp/jax_experimental/xla_ffi.py
+++ b/warp/jax_experimental/xla_ffi.py
@@ -379,6 +379,24 @@ class XLA_FFI_Stream_Get_Args(ctypes.Structure):
 XLA_FFI_Stream_Get = ctypes.CFUNCTYPE(ctypes.c_void_p, ctypes.POINTER(XLA_FFI_Stream_Get_Args))
 
 
+# struct XLA_FFI_DeviceOrdinal_Get {
+#   size_t struct_size;
+#   XLA_FFI_Extension_Base* extension_start;
+#   XLA_FFI_ExecutionContext* ctx;
+#   int32_t device_ordinal;  // out
+# };
+class XLA_FFI_DeviceOrdinal_Get_Args(ctypes.Structure):
+    _fields_ = (
+        ("struct_size", ctypes.c_size_t),
+        ("extension_start", ctypes.POINTER(XLA_FFI_Extension_Base)),
+        ("ctx", ctypes.c_void_p),  # XLA_FFI_ExecutionContext*
+        ("device_ordinal", ctypes.c_int32),
+    )  # // out
+
+
+XLA_FFI_DeviceOrdinal_Get = ctypes.CFUNCTYPE(ctypes.c_void_p, ctypes.POINTER(XLA_FFI_DeviceOrdinal_Get_Args))
+
+
 # struct XLA_FFI_Api {
 #   size_t struct_size;
 #   XLA_FFI_Extension_Base* extension_start;
@@ -402,6 +420,8 @@ XLA_FFI_Stream_Get = ctypes.CFUNCTYPE(ctypes.c_void_p, ctypes.POINTER(XLA_FFI_St
 #   _XLA_FFI_API_STRUCT_FIELD(XLA_FFI_Future_Create);
 #   _XLA_FFI_API_STRUCT_FIELD(XLA_FFI_Future_SetAvailable);
 #   _XLA_FFI_API_STRUCT_FIELD(XLA_FFI_Future_SetError);
+#   _XLA_FFI_API_STRUCT_FIELD(XLA_FFI_RunId_Get);
+#   _XLA_FFI_API_STRUCT_FIELD(XLA_FFI_DeviceOrdinal_Get);
 # };
 class XLA_FFI_Api(ctypes.Structure):
     _fields_ = (
@@ -425,6 +445,9 @@ class XLA_FFI_Api(ctypes.Structure):
         ("XLA_FFI_Future_Create", ctypes.c_void_p),  # XLA_FFI_Future_Create
         ("XLA_FFI_Future_SetAvailable", ctypes.c_void_p),  # XLA_FFI_Future_SetAvailable
         ("XLA_FFI_Future_SetError", ctypes.c_void_p),  # XLA_FFI_Future_SetError
+        # TODO(chaserileyroberts): Make this return the correct value and not a c_void_p.
+        ("XLA_FFI_RunId_Get", ctypes.c_void_p),  # XLA_FFI_RunId_Get
+        ("XLA_FFI_DeviceOrdinal_Get", XLA_FFI_DeviceOrdinal_Get),  # XLA_FFI_DeviceOrdinal_Get
     )
 
 
@@ -570,6 +593,15 @@ def get_stream_from_callframe(call_frame):
     return get_stream_args.stream
 
 
+def get_device_ordinal_from_callframe(call_frame):
+    api = call_frame.api
+    get_device_args = XLA_FFI_DeviceOrdinal_Get_Args(
+        ctypes.sizeof(XLA_FFI_DeviceOrdinal_Get_Args), ctypes.POINTER(XLA_FFI_Extension_Base)(), call_frame.ctx, 0
+    )
+    api.contents.XLA_FFI_DeviceOrdinal_Get(get_device_args)
+    return get_device_args.device_ordinal
+
+
 _dtype_from_ffi = {
     XLA_FFI_DataType.S8: wp.int8,
     XLA_FFI_DataType.S16: wp.int16,
diff --git a/warp/marching_cubes.py b/warp/marching_cubes.py
index e6f5ffaf..dd7ac6d0 100644
--- a/warp/marching_cubes.py
+++ b/warp/marching_cubes.py
@@ -243,7 +243,7 @@ def marching_cubes_extract_faces(
 def extract_faces_kernel(
     values: wp.array3d(dtype=wp.float32),
     threshold: wp.float32,
-    edge_genererated_vert_ind: wp.array(dtype=wp.int32, ndim=4),
+    edge_generated_vert_ind: wp.array(dtype=wp.int32, ndim=4),
     face_result_ind: wp.array(dtype=wp.int32),
     mc_case_to_tri_range_table: wp.array(dtype=wp.int32),
     mc_tri_local_inds_table: wp.array(dtype=wp.int32),
@@ -306,7 +306,7 @@ def extract_faces_kernel(
         for s in range(3):
             local_ind = mc_tri_local_inds_table[tri_range_start + 3 * i_tri + s]
 
-            global_ind = edge_genererated_vert_ind[
+            global_ind = edge_generated_vert_ind[
                 ti + mc_edge_offset_table[local_ind][0],
                 tj + mc_edge_offset_table[local_ind][1],
                 tk + mc_edge_offset_table[local_ind][2],
diff --git a/warp/native/array.h b/warp/native/array.h
index 91c57cc7..5788b9d9 100644
--- a/warp/native/array.h
+++ b/warp/native/array.h
@@ -118,6 +118,23 @@ namespace wp
 
 #endif  // WP_FP_CHECK
 
+
+template<size_t... Is>
+struct index_sequence {};
+
+template<size_t N, size_t... Is>
+struct make_index_sequence_impl : make_index_sequence_impl<N-1, N-1, Is...> {};
+
+template<size_t... Is>
+struct make_index_sequence_impl<0, Is...>
+{
+    using type = index_sequence<Is...>;
+};
+
+template<size_t N>
+using make_index_sequence = typename make_index_sequence_impl<N>::type;
+
+
 const int ARRAY_MAX_DIMS = 4;       // must match constant in types.py
 
 // must match constants in types.py
@@ -423,6 +440,13 @@ template <typename T>
 CUDA_CALLABLE inline T& index(const array_t<T>& arr, int i)
 {
     assert(arr.ndim == 1);
+    assert(i >= -arr.shape[0] && i < arr.shape[0]);
+
+    if (i < 0)
+    {
+        i += arr.shape[0];
+    }
+
     T& result = *data_at_byte_offset(arr, byte_offset(arr, i));
     FP_VERIFY_FWD_1(result)
 
@@ -433,6 +457,18 @@ template <typename T>
 CUDA_CALLABLE inline T& index(const array_t<T>& arr, int i, int j)
 {
     assert(arr.ndim == 2);
+    assert(i >= -arr.shape[0] && i < arr.shape[0]);
+    assert(j >= -arr.shape[1] && j < arr.shape[1]);
+
+    if (i < 0)
+    {
+        i += arr.shape[0];
+    }
+    if (j < 0)
+    {
+        j += arr.shape[1];
+    }
+
     T& result = *data_at_byte_offset(arr, byte_offset(arr, i, j));
     FP_VERIFY_FWD_2(result)
 
@@ -443,6 +479,23 @@ template <typename T>
 CUDA_CALLABLE inline T& index(const array_t<T>& arr, int i, int j, int k)
 {
     assert(arr.ndim == 3);
+    assert(i >= -arr.shape[0] && i < arr.shape[0]);
+    assert(j >= -arr.shape[1] && j < arr.shape[1]);
+    assert(k >= -arr.shape[2] && k < arr.shape[2]);
+
+    if (i < 0)
+    {
+        i += arr.shape[0];
+    }
+    if (j < 0)
+    {
+        j += arr.shape[1];
+    }
+    if (k < 0)
+    {
+        k += arr.shape[2];
+    }
+
     T& result = *data_at_byte_offset(arr, byte_offset(arr, i, j, k));
     FP_VERIFY_FWD_3(result)
 
@@ -453,6 +506,28 @@ template <typename T>
 CUDA_CALLABLE inline T& index(const array_t<T>& arr, int i, int j, int k, int l)
 {
     assert(arr.ndim == 4);
+    assert(i >= -arr.shape[0] && i < arr.shape[0]);
+    assert(j >= -arr.shape[1] && j < arr.shape[1]);
+    assert(k >= -arr.shape[2] && k < arr.shape[2]);
+    assert(l >= -arr.shape[3] && l < arr.shape[3]);
+
+    if (i < 0)
+    {
+        i += arr.shape[0];
+    }
+    if (j < 0)
+    {
+        j += arr.shape[1];
+    }
+    if (k < 0)
+    {
+        k += arr.shape[2];
+    }
+    if (l < 0)
+    {
+        l += arr.shape[3];
+    }
+
     T& result = *data_at_byte_offset(arr, byte_offset(arr, i, j, k, l));
     FP_VERIFY_FWD_4(result)
 
@@ -462,6 +537,14 @@ CUDA_CALLABLE inline T& index(const array_t<T>& arr, int i, int j, int k, int l)
 template <typename T>
 CUDA_CALLABLE inline T& index_grad(const array_t<T>& arr, int i)
 {
+    assert(arr.ndim == 1);
+    assert(i >= -arr.shape[0] && i < arr.shape[0]);
+
+    if (i < 0)
+    {
+        i += arr.shape[0];
+    }
+
     T& result = *grad_at_byte_offset(arr, byte_offset(arr, i));
     FP_VERIFY_FWD_1(result)
 
@@ -471,6 +554,19 @@ CUDA_CALLABLE inline T& index_grad(const array_t<T>& arr, int i)
 template <typename T>
 CUDA_CALLABLE inline T& index_grad(const array_t<T>& arr, int i, int j)
 {
+    assert(arr.ndim == 2);
+    assert(i >= -arr.shape[0] && i < arr.shape[0]);
+    assert(j >= -arr.shape[1] && j < arr.shape[1]);
+
+    if (i < 0)
+    {
+        i += arr.shape[0];
+    }
+    if (j < 0)
+    {
+        j += arr.shape[1];
+    }
+
     T& result = *grad_at_byte_offset(arr, byte_offset(arr, i, j));
     FP_VERIFY_FWD_2(result)
 
@@ -480,6 +576,24 @@ CUDA_CALLABLE inline T& index_grad(const array_t<T>& arr, int i, int j)
 template <typename T>
 CUDA_CALLABLE inline T& index_grad(const array_t<T>& arr, int i, int j, int k)
 {
+    assert(arr.ndim == 3);
+    assert(i >= -arr.shape[0] && i < arr.shape[0]);
+    assert(j >= -arr.shape[1] && j < arr.shape[1]);
+    assert(k >= -arr.shape[2] && k < arr.shape[2]);
+
+    if (i < 0)
+    {
+        i += arr.shape[0];
+    }
+    if (j < 0)
+    {
+        j += arr.shape[1];
+    }
+    if (k < 0)
+    {
+        k += arr.shape[2];
+    }
+
     T& result = *grad_at_byte_offset(arr, byte_offset(arr, i, j, k));
     FP_VERIFY_FWD_3(result)
 
@@ -489,6 +603,29 @@ CUDA_CALLABLE inline T& index_grad(const array_t<T>& arr, int i, int j, int k)
 template <typename T>
 CUDA_CALLABLE inline T& index_grad(const array_t<T>& arr, int i, int j, int k, int l)
 {
+    assert(arr.ndim == 4);
+    assert(i >= -arr.shape[0] && i < arr.shape[0]);
+    assert(j >= -arr.shape[1] && j < arr.shape[1]);
+    assert(k >= -arr.shape[2] && k < arr.shape[2]);
+    assert(l >= -arr.shape[3] && l < arr.shape[3]);
+
+    if (i < 0)
+    {
+        i += arr.shape[0];
+    }
+    if (j < 0)
+    {
+        j += arr.shape[1];
+    }
+    if (k < 0)
+    {
+        k += arr.shape[2];
+    }
+    if (l < 0)
+    {
+        l += arr.shape[3];
+    }
+
     T& result = *grad_at_byte_offset(arr, byte_offset(arr, i, j, k, l));
     FP_VERIFY_FWD_4(result)
 
@@ -500,7 +637,12 @@ template <typename T>
 CUDA_CALLABLE inline T& index(const indexedarray_t<T>& iarr, int i)
 {
     assert(iarr.arr.ndim == 1);
-    assert(i >= 0 && i < iarr.shape[0]);
+    assert(i >= -iarr.shape[0] && i < iarr.shape[0]);
+
+    if (i < 0)
+    {
+        i += iarr.shape[0];
+    }
 
     if (iarr.indices[0])
     {
@@ -518,8 +660,17 @@ template <typename T>
 CUDA_CALLABLE inline T& index(const indexedarray_t<T>& iarr, int i, int j)
 {
     assert(iarr.arr.ndim == 2);
-    assert(i >= 0 && i < iarr.shape[0]);
-    assert(j >= 0 && j < iarr.shape[1]);
+    assert(i >= -iarr.shape[0] && i < iarr.shape[0]);
+    assert(j >= -iarr.shape[1] && j < iarr.shape[1]);
+
+    if (i < 0)
+    {
+        i += iarr.shape[0];
+    }
+    if (j < 0)
+    {
+        j += iarr.shape[1];
+    }
 
     if (iarr.indices[0])
     {
@@ -542,9 +693,22 @@ template <typename T>
 CUDA_CALLABLE inline T& index(const indexedarray_t<T>& iarr, int i, int j, int k)
 {
     assert(iarr.arr.ndim == 3);
-    assert(i >= 0 && i < iarr.shape[0]);
-    assert(j >= 0 && j < iarr.shape[1]);
-    assert(k >= 0 && k < iarr.shape[2]);
+    assert(i >= -iarr.shape[0] && i < iarr.shape[0]);
+    assert(j >= -iarr.shape[1] && j < iarr.shape[1]);
+    assert(k >= -iarr.shape[2] && k < iarr.shape[2]);
+
+    if (i < 0)
+    {
+        i += iarr.shape[0];
+    }
+    if (j < 0)
+    {
+        j += iarr.shape[1];
+    }
+    if (k < 0)
+    {
+        k += iarr.shape[2];
+    }
 
     if (iarr.indices[0])
     {
@@ -572,10 +736,27 @@ template <typename T>
 CUDA_CALLABLE inline T& index(const indexedarray_t<T>& iarr, int i, int j, int k, int l)
 {
     assert(iarr.arr.ndim == 4);
-    assert(i >= 0 && i < iarr.shape[0]);
-    assert(j >= 0 && j < iarr.shape[1]);
-    assert(k >= 0 && k < iarr.shape[2]);
-    assert(l >= 0 && l < iarr.shape[3]);
+    assert(i >= -iarr.shape[0] && i < iarr.shape[0]);
+    assert(j >= -iarr.shape[1] && j < iarr.shape[1]);
+    assert(k >= -iarr.shape[2] && k < iarr.shape[2]);
+    assert(l >= -iarr.shape[3] && l < iarr.shape[3]);
+
+    if (i < 0)
+    {
+        i += iarr.shape[0];
+    }
+    if (j < 0)
+    {
+        j += iarr.shape[1];
+    }
+    if (k < 0)
+    {
+        k += iarr.shape[2];
+    }
+    if (l < 0)
+    {
+        l += iarr.shape[3];
+    }
 
     if (iarr.indices[0])
     {
@@ -609,7 +790,12 @@ template <typename T>
 CUDA_CALLABLE inline array_t<T> view(array_t<T>& src, int i)
 {
     assert(src.ndim > 1);
-    assert(i >= 0 && i < src.shape[0]);
+    assert(i >= -src.shape[0] && i < src.shape[0]);
+
+    if (i < 0)
+    {
+        i += src.shape[0];
+    }
 
     array_t<T> a;
     size_t offset = byte_offset(src, i);
@@ -631,8 +817,17 @@ template <typename T>
 CUDA_CALLABLE inline array_t<T> view(array_t<T>& src, int i, int j)
 {
     assert(src.ndim > 2);
-    assert(i >= 0 && i < src.shape[0]);
-    assert(j >= 0 && j < src.shape[1]);
+    assert(i >= -src.shape[0] && i < src.shape[0]);
+    assert(j >= -src.shape[1] && j < src.shape[1]);
+
+    if (i < 0)
+    {
+        i += src.shape[0];
+    }
+    if (j < 0)
+    {
+        j += src.shape[1];
+    }
 
     array_t<T> a;
     size_t offset = byte_offset(src, i, j);
@@ -652,9 +847,22 @@ template <typename T>
 CUDA_CALLABLE inline array_t<T> view(array_t<T>& src, int i, int j, int k)
 {
     assert(src.ndim > 3);
-    assert(i >= 0 && i < src.shape[0]);
-    assert(j >= 0 && j < src.shape[1]);
-    assert(k >= 0 && k < src.shape[2]);
+    assert(i >= -src.shape[0] && i < src.shape[0]);
+    assert(j >= -src.shape[1] && j < src.shape[1]);
+    assert(k >= -src.shape[2] && k < src.shape[2]);
+
+    if (i < 0)
+    {
+        i += src.shape[0];
+    }
+    if (j < 0)
+    {
+        j += src.shape[1];
+    }
+    if (k < 0)
+    {
+        k += src.shape[2];
+    }
 
     array_t<T> a;
     size_t offset = byte_offset(src, i, j, k);
@@ -669,6 +877,78 @@ CUDA_CALLABLE inline array_t<T> view(array_t<T>& src, int i, int j, int k)
 }
 
 
+template <typename T, size_t... Idxs>
+size_t byte_offset_helper(
+    array_t<T>& src,
+    const slice_t (&slices)[sizeof...(Idxs)],
+    index_sequence<Idxs...>
+)
+{
+    return byte_offset(src, slices[Idxs].start...);
+}
+
+
+template <typename T, typename... Slices>
+CUDA_CALLABLE inline array_t<T> view(array_t<T>& src, const Slices&... slice_args)
+{
+    constexpr int N = sizeof...(Slices);
+    static_assert(N >= 1 && N <= 4, "view supports 1 to 4 slices");
+    assert(src.ndim >= N);
+
+    slice_t slices[N] = { slice_args... };
+    int slice_idxs[N];
+    int slice_count = 0;
+
+    for (int i = 0; i < N; ++i)
+    {
+        if (slices[i].step == 0)
+        {
+            // We have a slice representing an integer index.
+            if (slices[i].start < 0)
+            {
+                slices[i].start += src.shape[i];
+            }
+        }
+        else
+        {
+            slices[i] = slice_adjust_indices(slices[i], src.shape[i]);
+            slice_idxs[slice_count] = i;
+            ++slice_count;
+        }
+    }
+
+    size_t offset = byte_offset_helper(src, slices, make_index_sequence<N>{});
+
+    array_t<T> out;
+
+    out.data = data_at_byte_offset(src, offset);
+    if (src.grad)
+    {
+        out.grad = grad_at_byte_offset(src, offset);
+    }
+
+    int dim = 0;
+    for (; dim < slice_count; ++dim)
+    {
+        int idx = slice_idxs[dim];
+        out.shape[dim] = slice_get_length(slices[idx]);
+        out.strides[dim] = src.strides[idx] * slices[idx].step;
+    }
+    for (; dim < slice_count + 4 - N; ++dim)
+    {
+        out.shape[dim] = src.shape[dim - slice_count + N];
+        out.strides[dim] = src.strides[dim - slice_count + N];
+    }
+    for (; dim < 4; ++dim)
+    {
+        out.shape[dim] = 0;
+        out.strides[dim] = 0;
+    }
+
+    out.ndim = src.ndim + slice_count - N;
+    return out;
+}
+
 template <typename T>
 CUDA_CALLABLE inline indexedarray_t<T> view(indexedarray_t<T>& src, int i)
 {
@@ -676,7 +956,11 @@ CUDA_CALLABLE inline indexedarray_t<T> view(indexedarray_t<T>& src, int i)
 
     if (src.indices[0])
     {
-        assert(i >= 0 && i < src.shape[0]);
+        assert(i >= -src.shape[0] && i < src.shape[0]);
+        if (i < 0)
+        {
+            i += src.shape[0];
+        }
         i = src.indices[0][i];
     }
 
@@ -699,12 +983,20 @@ CUDA_CALLABLE inline indexedarray_t<T> view(indexedarray_t<T>& src, int i, int j
 
     if (src.indices[0])
     {
-        assert(i >= 0 && i < src.shape[0]);
+        assert(i >= -src.shape[0] && i < src.shape[0]);
+        if (i < 0)
+        {
+            i += src.shape[0];
+        }
         i = src.indices[0][i];
     }
     if (src.indices[1])
     {
-        assert(j >= 0 && j < src.shape[1]);
+        assert(j >= -src.shape[1] && j < src.shape[1]);
+        if (j < 0)
+        {
+            j += src.shape[1];
+        }
         j = src.indices[1][j];
     }
 
@@ -725,17 +1017,29 @@ CUDA_CALLABLE inline indexedarray_t<T> view(indexedarray_t<T>& src, int i, int j
 
     if (src.indices[0])
     {
-        assert(i >= 0 && i < src.shape[0]);
+        assert(i >= -src.shape[0] && i < src.shape[0]);
+        if (i < 0)
+        {
+            i += src.shape[0];
+        }
         i = src.indices[0][i];
     }
     if (src.indices[1])
     {
-        assert(j >= 0 && j < src.shape[1]);
+        assert(j >= -src.shape[1] && j < src.shape[1]);
+        if (j < 0)
+        {
+            j += src.shape[1];
+        }
         j = src.indices[1][j];
     }
     if (src.indices[2])
     {
-        assert(k >= 0 && k < src.shape[2]);
+        assert(k >= -src.shape[2] && k < src.shape[2]);
+        if (k < 0)
+        {
+            k += src.shape[2];
+        }
         k = src.indices[2][k];
     }
 
@@ -754,6 +1058,9 @@ inline CUDA_CALLABLE void adj_view(A1<T>& src, int i, int j, A2<T>& adj_src, int
 template<template<typename> class A1, template<typename> class A2, template<typename> class A3, typename T>
 inline CUDA_CALLABLE void adj_view(A1<T>& src, int i, int j, int k, A2<T>& adj_src, int adj_i, int adj_j, int adj_k, A3<T>& adj_ret) {}
 
+template <typename... Args>
+CUDA_CALLABLE inline void adj_view(Args&&...) { }
+
 // TODO: lower_bound() for indexed arrays?
 
 template <typename T>
@@ -844,6 +1151,33 @@ inline CUDA_CALLABLE T atomic_exch(const A<T>& buf, int i, int j, int k, T value
 template<template<typename> class A, typename T>
 inline CUDA_CALLABLE T atomic_exch(const A<T>& buf, int i, int j, int k, int l, T value) { return atomic_exch(&index(buf, i, j, k, l), value); }
 
+template<template<typename> class A, typename T>
+inline CUDA_CALLABLE T atomic_and(const A<T>& buf, int i, T value) { return atomic_and(&index(buf, i), value); }
+template<template<typename> class A, typename T>
+inline CUDA_CALLABLE T atomic_and(const A<T>& buf, int i, int j, T value) { return atomic_and(&index(buf, i, j), value); }
+template<template<typename> class A, typename T>
+inline CUDA_CALLABLE T atomic_and(const A<T>& buf, int i, int j, int k, T value) { return atomic_and(&index(buf, i, j, k), value); }
+template<template<typename> class A, typename T>
+inline CUDA_CALLABLE T atomic_and(const A<T>& buf, int i, int j, int k, int l, T value) { return atomic_and(&index(buf, i, j, k, l), value); }
+
+template<template<typename> class A, typename T>
+inline CUDA_CALLABLE T atomic_or(const A<T>& buf, int i, T value) { return atomic_or(&index(buf, i), value); }
+template<template<typename> class A, typename T>
+inline CUDA_CALLABLE T atomic_or(const A<T>& buf, int i, int j, T value) { return atomic_or(&index(buf, i, j), value); }
+template<template<typename> class A, typename T>
+inline CUDA_CALLABLE T atomic_or(const A<T>& buf, int i, int j, int k, T value) { return atomic_or(&index(buf, i, j, k), value); }
+template<template<typename> class A, typename T>
+inline CUDA_CALLABLE T atomic_or(const A<T>& buf, int i, int j, int k, int l, T value) { return atomic_or(&index(buf, i, j, k, l), value); }
+
+template<template<typename> class A, typename T>
+inline CUDA_CALLABLE T atomic_xor(const A<T>& buf, int i, T value) { return atomic_xor(&index(buf, i), value); }
+template<template<typename> class A, typename T>
+inline CUDA_CALLABLE T atomic_xor(const A<T>& buf, int i, int j, T value) { return atomic_xor(&index(buf, i, j), value); }
+template<template<typename> class A, typename T>
+inline CUDA_CALLABLE T atomic_xor(const A<T>& buf, int i, int j, int k, T value) { return atomic_xor(&index(buf, i, j, k), value); }
+template<template<typename> class A, typename T>
+inline CUDA_CALLABLE T atomic_xor(const A<T>& buf, int i, int j, int k, int l, T value) { return atomic_xor(&index(buf, i, j, k, l), value); }
+
 template<template<typename> class A, typename T>
 inline CUDA_CALLABLE T* address(const A<T>& buf, int i)
 {
@@ -1321,6 +1655,34 @@ inline CUDA_CALLABLE void adj_atomic_exch(const A1<T>& buf, int i, int j, int k,
     FP_VERIFY_ADJ_4(value, adj_value)
 }
 
+// for bitwise operations we do not accumulate gradients
+template<template<typename> class A1, template<typename> class A2, typename T>
+inline CUDA_CALLABLE void adj_atomic_and(const A1<T>& buf, int i, T value, const A2<T>& adj_buf, int adj_i, T& adj_value, const T& adj_ret) {}
+template<template<typename> class A1, template<typename> class A2, typename T>
+inline CUDA_CALLABLE void adj_atomic_and(const A1<T>& buf, int i, int j, T value, const A2<T>& adj_buf, int adj_i, int adj_j, T& adj_value, const T& adj_ret) {}
+template<template<typename> class A1, template<typename> class A2, typename T>
+inline CUDA_CALLABLE void adj_atomic_and(const A1<T>& buf, int i, int j, int k, T value, const A2<T>& adj_buf, int adj_i, int adj_j, int adj_k, T& adj_value, const T& adj_ret) {}
+template<template<typename> class A1, template<typename> class A2, typename T>
+inline CUDA_CALLABLE void adj_atomic_and(const A1<T>& buf, int i, int j, int k, int l, T value, const A2<T>& adj_buf, int adj_i, int adj_j, int adj_k, int adj_l, T& adj_value, const T& adj_ret) {}
+
+template<template<typename> class A1, template<typename> class A2, typename T>
+inline CUDA_CALLABLE void adj_atomic_or(const A1<T>& buf, int i, T value, const A2<T>& adj_buf, int adj_i, T& adj_value, const T& adj_ret) {}
+template<template<typename> class A1, template<typename> class A2, typename T>
+inline CUDA_CALLABLE void adj_atomic_or(const A1<T>& buf, int i, int j, T value, const A2<T>& adj_buf, int adj_i, int adj_j, T& adj_value, const T& adj_ret) {}
+template<template<typename> class A1, template<typename> class A2, typename T>
+inline CUDA_CALLABLE void adj_atomic_or(const A1<T>& buf, int i, int j, int k, T value, const A2<T>& adj_buf, int adj_i, int adj_j, int adj_k, T& adj_value, const T& adj_ret) {}
+template<template<typename> class A1, template<typename> class A2, typename T>
+inline CUDA_CALLABLE void adj_atomic_or(const A1<T>& buf, int i, int j, int k, int l, T value, const A2<T>& adj_buf, int adj_i, int adj_j, int adj_k, int adj_l, T& adj_value, const T& adj_ret) {}
+
+template<template<typename> class A1, template<typename> class A2, typename T>
+inline CUDA_CALLABLE void adj_atomic_xor(const A1<T>& buf, int i, T value, const A2<T>& adj_buf, int adj_i, T& adj_value, const T& adj_ret) {}
+template<template<typename> class A1, template<typename> class A2, typename T>
+inline CUDA_CALLABLE void adj_atomic_xor(const A1<T>& buf, int i, int j, T value, const A2<T>& adj_buf, int adj_i, int adj_j, T& adj_value, const T& adj_ret) {}
+template<template<typename> class A1, template<typename> class A2, typename T>
+inline CUDA_CALLABLE void adj_atomic_xor(const A1<T>& buf, int i, int j, int k, T value, const A2<T>& adj_buf, int adj_i, int adj_j, int adj_k, T& adj_value, const T& adj_ret) {}
+template<template<typename> class A1, template<typename> class A2, typename T>
+inline CUDA_CALLABLE void adj_atomic_xor(const A1<T>& buf, int i, int j, int k, int l, T value, const A2<T>& adj_buf, int adj_i, int adj_j, int adj_k, int adj_l, T& adj_value, const T& adj_ret) {}
+
 
 template<template<typename> class A, typename T>
 CUDA_CALLABLE inline int len(const A<T>& a)
@@ -1333,7 +1695,6 @@ CUDA_CALLABLE inline void adj_len(const A<T>& a, A<T>& adj_a, int& adj_ret)
 {
 }
 
-
 } // namespace wp
 
 #include "fabric.h"
diff --git a/warp/native/builtin.h b/warp/native/builtin.h
index a7b6109a..6ef0231b 100644
--- a/warp/native/builtin.h
+++ b/warp/native/builtin.h
@@ -49,7 +49,7 @@
 #define DEG_TO_RAD  0.01745329251994329577
 
 #if defined(__CUDACC__) && !defined(_MSC_VER)
-__device__ void __debugbreak() { __brkpt(); }
+__device__ inline void __debugbreak() { __brkpt(); }
 #endif
 
 #if defined(__clang__) && defined(__CUDA__) && defined(__CUDA_ARCH__)
@@ -1157,12 +1157,30 @@ CUDA_CALLABLE inline T& operator += (T& a, const T& b) { a = add(a, b); return a
 template <typename T>
 CUDA_CALLABLE inline T& operator -= (T& a, const T& b) { a = sub(a, b); return a; }
 
+template <typename T>
+CUDA_CALLABLE inline T& operator &= (T& a, const T& b) { a = bit_and(a, b); return a; }
+
+template <typename T>
+CUDA_CALLABLE inline T& operator |= (T& a, const T& b) { a = bit_or(a, b); return a; }
+
+template <typename T>
+CUDA_CALLABLE inline T& operator ^= (T& a, const T& b) { a = bit_xor(a, b); return a; }
+
 template <typename T>
 CUDA_CALLABLE inline T operator+(const T& a, const T& b) { return add(a, b); }
 
 template <typename T>
 CUDA_CALLABLE inline T operator-(const T& a, const T& b) { return sub(a, b); }
 
+template <typename T>
+CUDA_CALLABLE inline T operator&(const T& a, const T& b) { return bit_and(a, b); }
+
+template <typename T>
+CUDA_CALLABLE inline T operator|(const T& a, const T& b) { return bit_or(a, b); }
+
+template <typename T>
+CUDA_CALLABLE inline T operator^(const T& a, const T& b) { return bit_xor(a, b); }
+
 template <typename T>
 CUDA_CALLABLE inline T pos(const T& x) { return x; }
 template <typename T>
@@ -1278,8 +1296,8 @@ inline CUDA_CALLABLE_DEVICE void tid(int& i, int& j, int& k, int& l, size_t inde
 }
 
 // should match types.py
-constexpr int SLICE_BEGIN = (1U << (sizeof(int) - 1)) - 1; // std::numeric_limits<int>::max()
-constexpr int SLICE_END = -(1U << (sizeof(int) - 1)); // std::numeric_limits<int>::min()
+static const int SLICE_BEGIN = (1LL << (sizeof(int) * 8 - 1)) - 1; // std::numeric_limits<int>::max()
+static const int SLICE_END = -(1LL << (sizeof(int) * 8 - 1)); // std::numeric_limits<int>::min()
 
 struct slice_t
 {
@@ -1366,26 +1384,18 @@ inline CUDA_CALLABLE T atomic_add(T* buf, T value)
 #endif
 }
 
-// emulate atomic int64 add with atomicCAS()
 template <>
-inline CUDA_CALLABLE int64 atomic_add(int64* address, int64 val)
+inline CUDA_CALLABLE int64 atomic_add(int64* buf, int64 value)
 {
-#if defined(__CUDA_ARCH__)
-    unsigned long long int *address_as_ull = (unsigned long long int*)address;
-    unsigned long long int old = *address_as_ull, assumed;
-
-    while (val < (int64)old)
-    {
-        assumed = old;
-        old = atomicCAS(address_as_ull, assumed, (int64)val);
-    }
-
-    return (int64)old;
-
-#else
-    int64 old = *address;
-    *address = min(old, val);
+#if !defined(__CUDA_ARCH__)
+    int64 old = buf[0];
+    buf[0] += value;
     return old;
+#else  // CUDA compiled by NVRTC
+    unsigned long long int *buf_as_ull = (unsigned long long int*)buf;
+    unsigned long long int unsigned_value = static_cast<unsigned long long int>(value);
+    unsigned long long int result = atomicAdd(buf_as_ull, unsigned_value);
+    return static_cast<int64>(result);
 #endif
 }
 
@@ -1727,6 +1737,52 @@ CUDA_CALLABLE inline void adj_atomic_exch(T* address, T val, T* adj_address, T&
 }
 
 
+template<typename T>
+inline CUDA_CALLABLE T atomic_and(T* buf, T value)
+{
+#if defined(__CUDA_ARCH__)
+    return atomicAnd(buf, value);
+#else
+    T old = buf[0];
+    buf[0] &= value;
+    return old;
+#endif
+}
+
+template<typename T>
+inline CUDA_CALLABLE T atomic_or(T* buf, T value)
+{
+#if defined(__CUDA_ARCH__)
+    return atomicOr(buf, value);
+#else
+    T old = buf[0];
+    buf[0] |= value;
+    return old;
+#endif
+}
+
+template<typename T>
+inline CUDA_CALLABLE T atomic_xor(T* buf, T value)
+{
+#if defined(__CUDA_ARCH__)
+    return atomicXor(buf, value);
+#else
+    T old = buf[0];
+    buf[0] ^= value;
+    return old;
+#endif
+}
+
+
+// for bitwise operations we do not accumulate gradients
+template<typename T>
+CUDA_CALLABLE inline void adj_atomic_and(T* buf, T* adj_buf, T &value, T &adj_value) { }
+template<typename T>
+CUDA_CALLABLE inline void adj_atomic_or(T* buf, T* adj_buf, T &value, T &adj_value) { }
+template<typename T>
+CUDA_CALLABLE inline void adj_atomic_xor(T* buf, T* adj_buf, T &value, T &adj_value) { }
+
+
 } // namespace wp
 
 
diff --git a/warp/native/bvh.cpp b/warp/native/bvh.cpp
index 38c6f09e..94447880 100644
--- a/warp/native/bvh.cpp
+++ b/warp/native/bvh.cpp
@@ -39,20 +39,19 @@ class TopDownBVHBuilder
 public:
 
     void build(BVH& bvh, const vec3* lowers, const vec3* uppers, int n, int in_constructor_type);
+    void rebuild(BVH& bvh, int in_constructor_type);
 
 private:
 
     void initialize_empty(BVH& bvh);
 
     bounds3 calc_bounds(const vec3* lowers, const vec3* uppers, const int* indices, int start, int end);
-
+    int build_recursive(BVH& bvh, const vec3* lowers, const vec3* uppers, int start, int end, int depth, int parent);
     int partition_median(const vec3* lowers, const vec3* uppers, int* indices, int start, int end, bounds3 range_bounds);
     int partition_midpoint(const vec3* lowers, const vec3* uppers, int* indices, int start, int end, bounds3 range_bounds);
     float partition_sah(BVH& bvh, const vec3* lowers, const vec3* uppers,
        int start, int end, bounds3 range_bounds, int& split_axis);
 
-    int build_recursive(BVH& bvh, const vec3* lowers, const vec3* uppers, int start, int end, int depth, int parent);
-
     int constructor_type = -1;
 };
 
@@ -69,6 +68,7 @@ void TopDownBVHBuilder::initialize_empty(BVH& bvh)
     bvh.root = nullptr;
     bvh.primitive_indices = nullptr;
     bvh.num_leaf_nodes = 0;
+    bvh.num_items = 0;
 }
 
 void TopDownBVHBuilder::build(BVH& bvh, const vec3* lowers, const vec3* uppers, int n, int in_constructor_type)
@@ -112,6 +112,7 @@ void TopDownBVHBuilder::build(BVH& bvh, const vec3* lowers, const vec3* uppers,
     bvh.node_uppers = new BVHPackedNodeHalf[bvh.max_nodes];
     bvh.node_parents = new int[bvh.max_nodes];
     bvh.node_counts = nullptr;
+    bvh.num_items = n;
 
     // root is always in first slot for top down builders
     bvh.root = new int[1];
@@ -124,6 +125,27 @@ void TopDownBVHBuilder::build(BVH& bvh, const vec3* lowers, const vec3* uppers,
     build_recursive(bvh, lowers, uppers,  0, n, 0, -1);
 }
 
+void TopDownBVHBuilder::rebuild(BVH& bvh, int in_constructor_type)
+{
+    if (in_constructor_type != BVH_CONSTRUCTOR_SAH && in_constructor_type != BVH_CONSTRUCTOR_MEDIAN)
+    {
+        fprintf(stderr, "Unrecognized Constructor type: %d! For CPU constructor it should be either SAH (%d) or Median (%d)!\n",
+            in_constructor_type, BVH_CONSTRUCTOR_SAH, BVH_CONSTRUCTOR_MEDIAN);
+        return;
+    }
+    if (bvh.num_items == 0)
+        return;
+
+    constructor_type = in_constructor_type;
+    for (int i = 0; i < bvh.num_items; ++i)
+        bvh.primitive_indices[i] = i;
+
+    bvh.max_depth = 0;
+    bvh.num_nodes = 0;
+    bvh.num_leaf_nodes = 0;
+    build_recursive(bvh, bvh.item_lowers, bvh.item_uppers, 0, bvh.num_items, 0, -1);
+}
+
 
 bounds3 TopDownBVHBuilder::calc_bounds(const vec3* lowers, const vec3* uppers, const int* indices, int start, int end)
 {
@@ -421,7 +443,11 @@ void bvh_refit_host(BVH& bvh)
 {
     bvh_refit_recursive(bvh, 0);
 }
-
+void bvh_rebuild_host(BVH& bvh, int constructor_type)
+{
+    TopDownBVHBuilder builder;
+    builder.rebuild(bvh, constructor_type);
+}
 
 } // namespace wp
 
@@ -510,6 +536,12 @@ void wp_bvh_refit_host(uint64_t id)
     wp::bvh_refit_host(*bvh);
 }
 
+void wp_bvh_rebuild_host(uint64_t id, int constructor_type)
+{
+    BVH* bvh = (BVH*)(id);
+    wp::bvh_rebuild_host(*bvh, constructor_type);
+}
+
 void wp_bvh_destroy_host(uint64_t id)
 {
     BVH* bvh = (BVH*)(id);
@@ -524,5 +556,6 @@ void wp_bvh_destroy_host(uint64_t id)
 uint64_t wp_bvh_create_device(void* context, wp::vec3* lowers, wp::vec3* uppers, int num_items, int constructor_type) { return 0; }
 void wp_bvh_refit_device(uint64_t id) {}
 void wp_bvh_destroy_device(uint64_t id) {}
+void wp_bvh_rebuild_device(uint64_t id) {}
 
 #endif // !WP_ENABLE_CUDA
diff --git a/warp/native/bvh.cu b/warp/native/bvh.cu
index 60545c86..f0f78bc4 100644
--- a/warp/native/bvh.cu
+++ b/warp/native/bvh.cu
@@ -31,11 +31,22 @@
 
 #include <cub/cub.cuh>
 
+extern CUcontext get_current_context();
 
 namespace wp
 {
-    void bvh_create_host(vec3* lowers, vec3* uppers, int num_items, int constructor_type, BVH& bvh);
-    void bvh_destroy_host(BVH& bvh);
+void bvh_create_host(vec3* lowers, vec3* uppers, int num_items, int constructor_type, BVH& bvh);
+void bvh_destroy_host(BVH& bvh);
+
+__global__ void memset_kernel(int* dest, int value, size_t n)
+{
+    const size_t tid = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);
+    
+    if (tid < n)
+    {
+        dest[tid] = value;
+    }
+}
 
 // for LBVH: this will start with some muted leaf nodes, but that is okay, we can still trace up because there parents information is still valid
 // the only thing worth mentioning is that when the parent leaf node is also a leaf node, we need to recompute its bounds, since their child information are lost
@@ -149,17 +160,6 @@ __global__ void bvh_refit_kernel(int n, const int* __restrict__ parents, int* __
     }
 }
 
-
-void bvh_refit_device(BVH& bvh)
-{
-    ContextGuard guard(bvh.context);
-
-    // clear child counters
-    wp_memset_device(WP_CURRENT_CONTEXT, bvh.node_counts, 0, sizeof(int) * bvh.max_nodes);
-    wp_launch_device(WP_CURRENT_CONTEXT, bvh_refit_kernel, bvh.num_leaf_nodes, (bvh.num_leaf_nodes, bvh.node_parents, bvh.node_counts, bvh.primitive_indices, bvh.node_lowers, bvh.node_uppers, bvh.item_lowers, bvh.item_uppers));
-}
-
-
 /////////////////////////////////////////////////////////////////////////////////////////////
 
 // Create a linear BVH as described in Fast and Simple Agglomerative LBVH construction
@@ -514,11 +514,15 @@ void LinearBVHBuilderGPU::build(BVH& bvh, const vec3* item_lowers, const vec3* i
     }
     else
     {
-        static vec3 upper(-FLT_MAX);
-        static vec3 lower(FLT_MAX);
+        // IEEE-754 bit patterns for +/- FLT_MAX
+        constexpr int FLT_MAX_BITS = 0x7f7fffff;
+        constexpr int NEG_FLT_MAX_BITS = 0xff7fffff;
+
+        // total_lower := ( +FLT_MAX, +FLT_MAX, +FLT_MAX )
+        wp_launch_device(WP_CURRENT_CONTEXT, memset_kernel, sizeof(vec3) / 4, ((int*)total_lower, FLT_MAX_BITS, sizeof(vec3) / 4));
 
-        wp_memcpy_h2d(WP_CURRENT_CONTEXT, total_lower, &lower, sizeof(lower));
-        wp_memcpy_h2d(WP_CURRENT_CONTEXT, total_upper, &upper, sizeof(upper));
+        // total_upper := ( -FLT_MAX, -FLT_MAX, -FLT_MAX )
+        wp_launch_device(WP_CURRENT_CONTEXT, memset_kernel, sizeof(vec3) / 4, ((int*)total_upper, NEG_FLT_MAX_BITS, sizeof(vec3) / 4));
 
         // compute the total bounds on the GPU
         wp_launch_device(WP_CURRENT_CONTEXT, compute_total_bounds, num_items, (item_lowers, item_uppers, total_lower, total_upper, num_items));
@@ -737,6 +741,24 @@ void bvh_destroy_device(BVH& bvh)
     wp_free_device(WP_CURRENT_CONTEXT, bvh.root); bvh.root = NULL;
 }
 
+void bvh_refit_device(BVH& bvh)
+{
+    ContextGuard guard(bvh.context);
+
+    // clear child counters
+    wp_memset_device(WP_CURRENT_CONTEXT, bvh.node_counts, 0, sizeof(int) * bvh.max_nodes);
+    wp_launch_device(WP_CURRENT_CONTEXT, bvh_refit_kernel, bvh.num_leaf_nodes, (bvh.num_leaf_nodes, bvh.node_parents, bvh.node_counts, bvh.primitive_indices, bvh.node_lowers, bvh.node_uppers, bvh.item_lowers, bvh.item_uppers));
+}
+
+void bvh_rebuild_device(BVH& bvh)
+{
+    ContextGuard guard(bvh.context);
+
+    LinearBVHBuilderGPU builder;
+    builder.build(bvh, bvh.item_lowers, bvh.item_uppers, bvh.num_items, NULL);
+}
+
+
 
 } // namespace wp
 
@@ -752,6 +774,17 @@ void wp_bvh_refit_device(uint64_t id)
     }
 }
 
+void wp_bvh_rebuild_device(uint64_t id)
+{
+    wp::BVH bvh;
+    if (bvh_get_descriptor(id, bvh))
+    {
+        ContextGuard guard(bvh.context);
+
+        wp::bvh_rebuild_device(bvh);
+    }
+}
+
 /*
 * Since we don't even know the number of true leaf nodes, never mention where they are, we will launch
 * the num_items threads, which are identical to the number of leaf nodes in the original tree. The 
diff --git a/warp/native/bvh.h b/warp/native/bvh.h
index 15029e6e..224717b0 100644
--- a/warp/native/bvh.h
+++ b/warp/native/bvh.h
@@ -34,133 +34,133 @@ namespace wp
 
 struct bounds3
 {
-	CUDA_CALLABLE inline bounds3() : lower( FLT_MAX)
-						           , upper(-FLT_MAX) {}
-
-	CUDA_CALLABLE inline bounds3(const vec3& lower, const vec3& upper) : lower(lower), upper(upper) {}
-
-	CUDA_CALLABLE inline vec3 center() const { return 0.5f*(lower+upper); }
-	CUDA_CALLABLE inline vec3 edges() const { return upper-lower; }
-
-	CUDA_CALLABLE inline void expand(float r)
-	{
-		lower -= vec3(r);
-		upper += vec3(r);
-	}
-
-	CUDA_CALLABLE inline void expand(const vec3& r)
-	{
-		lower -= r;
-		upper += r;
-	}
-
-	CUDA_CALLABLE inline bool empty() const { return lower[0] >= upper[0] || lower[1] >= upper[1] || lower[2] >= upper[2]; }
-
-	CUDA_CALLABLE inline bool overlaps(const vec3& p) const
-	{
-		if (p[0] < lower[0] ||
-			p[1] < lower[1] ||
-			p[2] < lower[2] ||
-			p[0] > upper[0] ||
-			p[1] > upper[1] ||
-			p[2] > upper[2])
-		{
-			return false;
-		}
-		else
-		{
-			return true;
-		}
-	}
-
-	CUDA_CALLABLE inline bool overlaps(const bounds3& b) const
-	{
-		if (lower[0] > b.upper[0] ||
-			lower[1] > b.upper[1] ||
-			lower[2] > b.upper[2] ||
-			upper[0] < b.lower[0] ||
-			upper[1] < b.lower[1] ||
-			upper[2] < b.lower[2])
-		{
-			return false;
-		}
-		else
-		{
-			return true;
-		}
-	}
-
-	CUDA_CALLABLE inline bool overlaps(const vec3& b_lower, const vec3& b_upper) const
-	{
-		if (lower[0] > b_upper[0] ||
-			lower[1] > b_upper[1] ||
-			lower[2] > b_upper[2] ||
-			upper[0] < b_lower[0] ||
-			upper[1] < b_lower[1] ||
-			upper[2] < b_lower[2])
-		{
-			return false;
-		}
-		else
-		{
-			return true;
-		}
-	}
-
-	CUDA_CALLABLE inline void add_point(const vec3& p)
-	{
-		lower = min(lower, p);
-		upper = max(upper, p);
-	}
-
-	CUDA_CALLABLE inline void add_bounds(const vec3& lower_other, const vec3& upper_other)
-	{
-		// lower_other will only impact the lower of the new bounds
-		// upper_other will only impact the upper of the new bounds
-		// this costs only half of the computation of adding lower_other and upper_other separately
-		lower = min(lower, lower_other);
-		upper = max(upper, upper_other);
-	}
-
-	CUDA_CALLABLE inline float area() const
-	{
-		vec3 e = upper-lower;
-		return 2.0f*(e[0]*e[1] + e[0]*e[2] + e[1]*e[2]);
-	}
-
-	vec3 lower;
-	vec3 upper;
+    CUDA_CALLABLE inline bounds3() : lower( FLT_MAX)
+                                   , upper(-FLT_MAX) {}
+
+    CUDA_CALLABLE inline bounds3(const vec3& lower, const vec3& upper) : lower(lower), upper(upper) {}
+
+    CUDA_CALLABLE inline vec3 center() const { return 0.5f*(lower+upper); }
+    CUDA_CALLABLE inline vec3 edges() const { return upper-lower; }
+
+    CUDA_CALLABLE inline void expand(float r)
+    {
+        lower -= vec3(r);
+        upper += vec3(r);
+    }
+
+    CUDA_CALLABLE inline void expand(const vec3& r)
+    {
+        lower -= r;
+        upper += r;
+    }
+
+    CUDA_CALLABLE inline bool empty() const { return lower[0] >= upper[0] || lower[1] >= upper[1] || lower[2] >= upper[2]; }
+
+    CUDA_CALLABLE inline bool overlaps(const vec3& p) const
+    {
+        if (p[0] < lower[0] ||
+            p[1] < lower[1] ||
+            p[2] < lower[2] ||
+            p[0] > upper[0] ||
+            p[1] > upper[1] ||
+            p[2] > upper[2])
+        {
+            return false;
+        }
+        else
+        {
+            return true;
+        }
+    }
+
+    CUDA_CALLABLE inline bool overlaps(const bounds3& b) const
+    {
+        if (lower[0] > b.upper[0] ||
+            lower[1] > b.upper[1] ||
+            lower[2] > b.upper[2] ||
+            upper[0] < b.lower[0] ||
+            upper[1] < b.lower[1] ||
+            upper[2] < b.lower[2])
+        {
+            return false;
+        }
+        else
+        {
+            return true;
+        }
+    }
+
+    CUDA_CALLABLE inline bool overlaps(const vec3& b_lower, const vec3& b_upper) const
+    {
+        if (lower[0] > b_upper[0] ||
+            lower[1] > b_upper[1] ||
+            lower[2] > b_upper[2] ||
+            upper[0] < b_lower[0] ||
+            upper[1] < b_lower[1] ||
+            upper[2] < b_lower[2])
+        {
+            return false;
+        }
+        else
+        {
+            return true;
+        }
+    }
+
+    CUDA_CALLABLE inline void add_point(const vec3& p)
+    {
+        lower = min(lower, p);
+        upper = max(upper, p);
+    }
+
+    CUDA_CALLABLE inline void add_bounds(const vec3& lower_other, const vec3& upper_other)
+    {
+        // lower_other will only impact the lower of the new bounds
+        // upper_other will only impact the upper of the new bounds
+        // this costs only half of the computation of adding lower_other and upper_other separately
+        lower = min(lower, lower_other);
+        upper = max(upper, upper_other);
+    }
+
+    CUDA_CALLABLE inline float area() const
+    {
+        vec3 e = upper-lower;
+        return 2.0f*(e[0]*e[1] + e[0]*e[2] + e[1]*e[2]);
+    }
+
+    vec3 lower;
+    vec3 upper;
 };
 
 CUDA_CALLABLE inline bounds3 bounds_union(const bounds3& a, const vec3& b) 
 {
-	return bounds3(min(a.lower, b), max(a.upper, b));
+    return bounds3(min(a.lower, b), max(a.upper, b));
 }
 
 CUDA_CALLABLE inline bounds3 bounds_union(const bounds3& a, const bounds3& b) 
 {
-	return bounds3(min(a.lower, b.lower), max(a.upper, b.upper));
+    return bounds3(min(a.lower, b.lower), max(a.upper, b.upper));
 }
 
 CUDA_CALLABLE inline bounds3 bounds_intersection(const bounds3& a, const bounds3& b)
 {
-	return bounds3(max(a.lower, b.lower), min(a.upper, b.upper));
+    return bounds3(max(a.lower, b.lower), min(a.upper, b.upper));
 }
 
 struct BVHPackedNodeHalf
 {
-	float x;
-	float y;
-	float z;
-	// For non-leaf nodes:
-	// - 'lower.i' represents the index of the left child node.
-	// - 'upper.i' represents the index of the right child node.
-	//
-	// For leaf nodes:
-	// - 'lower.i' indicates the start index of the primitives in 'primitive_indices'.
-	// - 'upper.i' indicates the index just after the last primitive in 'primitive_indices'
-	unsigned int i : 31;
-	unsigned int b : 1;
+    float x;
+    float y;
+    float z;
+    // For non-leaf nodes:
+    // - 'lower.i' represents the index of the left child node.
+    // - 'upper.i' represents the index of the right child node.
+    //
+    // For leaf nodes:
+    // - 'lower.i' indicates the start index of the primitives in 'primitive_indices'.
+    // - 'upper.i' indicates the index just after the last primitive in 'primitive_indices'
+    unsigned int i : 31;
+    unsigned int b : 1;
 };
 
 struct BVH
@@ -168,30 +168,30 @@ struct BVH
     BVHPackedNodeHalf* node_lowers;
     BVHPackedNodeHalf* node_uppers;
 
-	// used for fast refits
-	int* node_parents;
-	int* node_counts;
-	// reordered primitive indices corresponds to the ordering of leaf nodes
-	int* primitive_indices;
-	
-	int max_depth;
-	int max_nodes;
-	int num_nodes;
-	// since we use packed leaf nodes, the number of them is no longer the number of items, but variable
-	int num_leaf_nodes;
-
-	// pointer (CPU or GPU) to a single integer index in node_lowers, node_uppers
-	// representing the root of the tree, this is not always the first node
-	// for bottom-up builders
-	int* root;
-
-	// item bounds are not owned by the BVH but by the caller
+    // used for fast refits
+    int* node_parents;
+    int* node_counts;
+    // reordered primitive indices corresponds to the ordering of leaf nodes
+    int* primitive_indices;
+    
+    int max_depth;
+    int max_nodes;
+    int num_nodes;
+    // since we use packed leaf nodes, the number of them is no longer the number of items, but variable
+    int num_leaf_nodes;
+
+    // pointer (CPU or GPU) to a single integer index in node_lowers, node_uppers
+    // representing the root of the tree, this is not always the first node
+    // for bottom-up builders
+    int* root;
+
+    // item bounds are not owned by the BVH but by the caller
     vec3* item_lowers;
-	vec3* item_uppers;
-	int num_items;
+    vec3* item_uppers;
+    int num_items;
 
-	// cuda context
-	void* context;
+    // cuda context
+    void* context;
 };
 
 CUDA_CALLABLE inline BVHPackedNodeHalf make_node(const vec3& bound, int child, bool leaf)
@@ -220,17 +220,17 @@ CUDA_CALLABLE inline void make_node(volatile BVHPackedNodeHalf* n, const vec3& b
 __device__ inline wp::BVHPackedNodeHalf bvh_load_node(const wp::BVHPackedNodeHalf* nodes, int index)
 {
 #ifdef USE_LOAD4
-	//return  (const wp::BVHPackedNodeHalf&)(__ldg((const float4*)(nodes)+index));
-	return  (const wp::BVHPackedNodeHalf&)(*((const float4*)(nodes)+index));
+    //return  (const wp::BVHPackedNodeHalf&)(__ldg((const float4*)(nodes)+index));
+    return  (const wp::BVHPackedNodeHalf&)(*((const float4*)(nodes)+index));
 #else
-	return  nodes[index];
+    return  nodes[index];
 #endif // USE_LOAD4
 
 }
 #else
 inline wp::BVHPackedNodeHalf bvh_load_node(const wp::BVHPackedNodeHalf* nodes, int index)
 {
-	return  nodes[index];
+    return  nodes[index];
 }
 #endif // __CUDACC__
 
@@ -272,8 +272,8 @@ CUDA_CALLABLE inline BVH bvh_get(uint64_t id)
 
 CUDA_CALLABLE inline int bvh_get_num_bounds(uint64_t id)
 {
-	BVH bvh = bvh_get(id);
-	return bvh.num_items;
+    BVH bvh = bvh_get(id);
+    return bvh.num_items;
 }
 
 
@@ -289,7 +289,7 @@ struct bvh_query_t
           input_lower(),
           input_upper(),
           bounds_nr(0),
-		  primitive_counter(-1)
+          primitive_counter(-1)
     {}
 
     // Required for adjoint computations.
@@ -300,211 +300,169 @@ struct bvh_query_t
 
     BVH bvh;
 
-	// BVH traversal stack:
-	int stack[BVH_QUERY_STACK_SIZE];
-	int count;
+    // BVH traversal stack:
+    int stack[BVH_QUERY_STACK_SIZE];
+    int count;
 
-	// >= 0 if currently in a packed leaf node
-	int primitive_counter;
-	
+    // >= 0 if currently in a packed leaf node
+    int primitive_counter;
+    
     // inputs
     wp::vec3 input_lower;	// start for ray
     wp::vec3 input_upper;	// dir for ray
 
-	int bounds_nr;
-	bool is_ray;
+    int bounds_nr;
+    bool is_ray;
 };
 
 CUDA_CALLABLE inline bool bvh_query_intersection_test(const bvh_query_t& query, const vec3& node_lower, const vec3& node_upper)
 {
-	if (query.is_ray)
-	{
-		float t = 0.0f;
-		return intersect_ray_aabb(query.input_lower, query.input_upper, node_lower, node_upper, t);
-	}
-	else
-	{
-		return intersect_aabb_aabb(query.input_lower, query.input_upper, node_lower, node_upper);
-	}
+    if (query.is_ray)
+    {
+        float t = 0.0f;
+        return intersect_ray_aabb(query.input_lower, query.input_upper, node_lower, node_upper, t);
+    }
+    else
+    {
+        return intersect_aabb_aabb(query.input_lower, query.input_upper, node_lower, node_upper);
+    }
 }
 
 CUDA_CALLABLE inline bvh_query_t bvh_query(
-	uint64_t id, bool is_ray, const vec3& lower, const vec3& upper)
+    uint64_t id, bool is_ray, const vec3& lower, const vec3& upper)
 {
-	// This routine traverses the BVH tree until it finds
-	// the first overlapping bound. 
+    // This routine traverses the BVH tree until it finds
+    // the first overlapping bound. 
 
-	// initialize empty
-	bvh_query_t query;
+    // initialize empty
+    bvh_query_t query;
 
-	query.bounds_nr = -1;
+    query.bounds_nr = -1;
 
-	BVH bvh = bvh_get(id);
+    BVH bvh = bvh_get(id);
 
-	query.bvh = bvh;
-	query.is_ray = is_ray;
+    query.bvh = bvh;
+    query.is_ray = is_ray;
 
-	// optimization: make the latest	
-	query.stack[0] = *bvh.root;
-	query.count = 1;
-	query.input_lower = lower;
-	query.input_upper = upper;
+    // optimization: make the latest	
+    query.stack[0] = *bvh.root;
+    query.count = 1;
+    query.input_lower = lower;
+    query.input_upper = upper;
 
-	// Navigate through the bvh, find the first overlapping leaf node.
-	while (query.count)
-	{
-		const int node_index = query.stack[--query.count];
-		BVHPackedNodeHalf node_lower = bvh_load_node(bvh.node_lowers, node_index);
-		BVHPackedNodeHalf node_upper = bvh_load_node(bvh.node_uppers, node_index);
+    // Navigate through the bvh, find the first overlapping leaf node.
+    while (query.count)
+    {
+        const int node_index = query.stack[--query.count];
+        BVHPackedNodeHalf node_lower = bvh_load_node(bvh.node_lowers, node_index);
+        BVHPackedNodeHalf node_upper = bvh_load_node(bvh.node_uppers, node_index);
 
         if (!bvh_query_intersection_test(query, reinterpret_cast<vec3&>(node_lower), reinterpret_cast<vec3&>(node_upper)))
-		{
-			continue;
-		}
-
-		const int left_index = node_lower.i;
-		const int right_index = node_upper.i;
-		// Make bounds from this AABB
-		if (node_lower.b)
-		{
-			// Reached a leaf node, point to its first primitive
-			// Back up one level and return 
-			query.primitive_counter = left_index;
-			query.stack[query.count++] = node_index;
-			return query;
-		}
-		else
-		{
-			query.stack[query.count++] = left_index;
-			query.stack[query.count++] = right_index;
-		}
-	}
-
-	return query;
+        {
+            continue;
+        }
+
+        const int left_index = node_lower.i;
+        const int right_index = node_upper.i;
+        // Make bounds from this AABB
+        if (node_lower.b)
+        {
+            // Reached a leaf node, point to its first primitive
+            // Back up one level and return 
+            query.primitive_counter = 0;
+            query.stack[query.count++] = node_index;
+            return query;
+        }
+        else
+        {
+            query.stack[query.count++] = left_index;
+            query.stack[query.count++] = right_index;
+        }
+    }
+
+    return query;
 }
 
 CUDA_CALLABLE inline bvh_query_t bvh_query_aabb(
     uint64_t id, const vec3& lower, const vec3& upper)
 {
-	return bvh_query(id, false, lower, upper);
+    return bvh_query(id, false, lower, upper);
 }
 
 
-CUDA_CALLABLE inline bvh_query_t bvh_query_ray(
-    uint64_t id, const vec3& start, const vec3& dir)
+CUDA_CALLABLE inline bvh_query_t bvh_query_ray(uint64_t id, const vec3& start, const vec3& dir)
 {
-	return bvh_query(id, true, start, 1.0f / dir);
+    return bvh_query(id, true, start, 1.0f / dir);
 }
 
 //Stub
 CUDA_CALLABLE inline void adj_bvh_query_aabb(uint64_t id, const vec3& lower, const vec3& upper,
-											   uint64_t, vec3&, vec3&, bvh_query_t&)
+                                               uint64_t, vec3&, vec3&, bvh_query_t&)
 {
 }
 
 
 CUDA_CALLABLE inline void adj_bvh_query_ray(uint64_t id, const vec3& start, const vec3& dir,
-											   uint64_t, vec3&, vec3&, bvh_query_t&)
+                                               uint64_t, vec3&, vec3&, bvh_query_t&)
 {
 }
 
 
 CUDA_CALLABLE inline bool bvh_query_next(bvh_query_t& query, int& index)
 {
-	BVH bvh = query.bvh;
-
-	if (query.primitive_counter != -1)
-		// currently in a leaf node which is the last node in the stack
-	{
-		const int node_index = query.stack[query.count - 1];
-		BVHPackedNodeHalf node_lower = bvh_load_node(bvh.node_lowers, node_index);
-		BVHPackedNodeHalf node_upper = bvh_load_node(bvh.node_uppers, node_index);
-
-		const int end = node_upper.i;
-		for (int primitive_counter = query.primitive_counter; primitive_counter < end; primitive_counter++)
-		{
-			int primitive_index = bvh.primitive_indices[primitive_counter];
-			if (bvh_query_intersection_test(query, bvh.item_lowers[primitive_index], bvh.item_uppers[primitive_index]))
-			{
-				if (primitive_counter < end - 1)
-					// still need to come back to this leaf node for the leftover primitives
-				{
-					query.primitive_counter = primitive_counter + 1;
-				}
-				else
-					// no need to come back to this leaf node
-				{
-					query.count--;
-					query.primitive_counter = -1;
-				}
-				index = primitive_index;
-				query.bounds_nr = primitive_index;
-
-				return true;
-			}
-		}
-		// if we reach here that means we have finished the current leaf node without finding intersections
-		query.primitive_counter = -1;
-		// remove the leaf node from the back of the stack because it is finished
-		// and continue the bvh traversal
-		query.count--;
-	}
-
-	// Navigate through the bvh, find the first overlapping leaf node.
-	while (query.count)
-	{
-		const int node_index = query.stack[--query.count];
-		BVHPackedNodeHalf node_lower = bvh_load_node(bvh.node_lowers, node_index);
-		BVHPackedNodeHalf node_upper = bvh_load_node(bvh.node_uppers, node_index);
-
-		const int left_index = node_lower.i;
-		const int right_index = node_upper.i;
-
-		wp::vec3 lower_pos(node_lower.x, node_lower.y, node_lower.z);
-		wp::vec3 upper_pos(node_upper.x, node_upper.y, node_upper.z);
-		wp::bounds3 current_bounds(lower_pos, upper_pos);
+    BVH bvh = query.bvh;
+
+    // Navigate through the bvh, find the first overlapping leaf node.
+    while (query.count)
+    {
+        const int node_index = query.stack[--query.count];
+
+        BVHPackedNodeHalf node_lower = bvh_load_node(bvh.node_lowers, node_index);
+        BVHPackedNodeHalf node_upper = bvh_load_node(bvh.node_uppers, node_index);
 
         if (!bvh_query_intersection_test(query, reinterpret_cast<vec3&>(node_lower), reinterpret_cast<vec3&>(node_upper)))
-		{
-			continue;
-		}
-
-		if (node_lower.b)
-		{
-			// found leaf, loop through its content primitives
-			const int start = left_index;
-			const int end = right_index;
-
-			for (int primitive_counter = start; primitive_counter < end; primitive_counter++)
-			{
-				int primitive_index = bvh.primitive_indices[primitive_counter];
-				if (bvh_query_intersection_test(query, bvh.item_lowers[primitive_index], bvh.item_uppers[primitive_index]))
-				{
-					if (primitive_counter < end - 1)
-						// still need to come back to this leaf node for the leftover primitives
-					{
-						query.primitive_counter = primitive_counter + 1;
-						query.stack[query.count++] = node_index;
-					}
-					else
-						// no need to come back to this leaf node
-					{
-						query.primitive_counter = -1;
-					}
-					index = primitive_index;
-					query.bounds_nr = primitive_index;
-
-					return true;
-				}
-			}
-		}
-		else
-		{
-			query.stack[query.count++] = left_index;
-			query.stack[query.count++] = right_index;
-		}
-	}
-	return false;
+        {
+            continue;
+        }
+
+        const int left_index = node_lower.i;
+        const int right_index = node_upper.i;
+
+        if (node_lower.b)
+        {
+            // found leaf, loop through its content primitives
+            const int start = left_index;
+            const int end = right_index;
+
+            int primitive_index = bvh.primitive_indices[start + (query.primitive_counter++)];
+            // if already visited the last primitive in the leaf node
+            // move to the next node and reset the primitive counter to 0
+            if (start + query.primitive_counter == end)
+            {
+                query.primitive_counter = 0;
+            }
+            // otherwise we need to keep this leaf node in stack for a future visit
+            else
+            {
+                query.stack[query.count++] = node_index;
+            }
+            if (bvh_query_intersection_test(query, bvh.item_lowers[primitive_index], bvh.item_uppers[primitive_index]))
+            {
+                index = primitive_index;
+                query.bounds_nr = primitive_index;
+
+                return true;
+            }
+        }
+        else
+        {
+            // if it's not a leaf node we treat it as if we have visited the last primitive
+            query.primitive_counter = 0;
+            query.stack[query.count++] = left_index;
+            query.stack[query.count++] = right_index;
+        }
+    }
+    return false;
 }
 
 
@@ -540,15 +498,16 @@ CUDA_CALLABLE bool bvh_get_descriptor(uint64_t id, BVH& bvh);
 CUDA_CALLABLE void bvh_add_descriptor(uint64_t id, const BVH& bvh);
 CUDA_CALLABLE void bvh_rem_descriptor(uint64_t id);
 
-#if !__CUDA_ARCH__
-
 void bvh_create_host(vec3* lowers, vec3* uppers, int num_items,  int constructor_type, BVH& bvh);
 void bvh_destroy_host(wp::BVH& bvh);
 void bvh_refit_host(wp::BVH& bvh);
 
-void bvh_destroy_device(wp::BVH& bvh);
-void bvh_refit_device(uint64_t id);
+#if WP_ENABLE_CUDA
+
+void bvh_create_device(void* context, vec3* lowers, vec3* uppers, int num_items, int constructor_type, BVH& bvh_device_on_host);
+void bvh_destroy_device(BVH& bvh);
+void bvh_refit_device(BVH& bvh);
 
-#endif
+#endif // WP_ENABLE_CUDA
 
 } // namespace wp
diff --git a/warp/native/clang/clang.cpp b/warp/native/clang/clang.cpp
index 07e26959..0c049ada 100644
--- a/warp/native/clang/clang.cpp
+++ b/warp/native/clang/clang.cpp
@@ -271,7 +271,11 @@ WP_API int wp_compile_cpp(const char* cpp_src, const char *input_file, const cha
         target_options.AllowFPOpFusion = llvm::FPOpFusion::Strict;
     llvm::Reloc::Model relocation_model = llvm::Reloc::PIC_;  // Position Independent Code
     llvm::CodeModel::Model code_model = llvm::CodeModel::Large;  // Don't make assumptions about displacement sizes
+    #if LLVM_VERSION_MAJOR >= 22
+    llvm::TargetMachine* target_machine = target->createTargetMachine(llvm::Triple(target_triple), CPU, features, target_options, relocation_model, code_model);
+    #else
     llvm::TargetMachine* target_machine = target->createTargetMachine(target_triple, CPU, features, target_options, relocation_model, code_model);
+    #endif
 
     module->setDataLayout(target_machine->createDataLayout());
 
@@ -313,7 +317,11 @@ WP_API int wp_compile_cuda(const char* cpp_src, const char *input_file, const ch
     const char* features = "+ptx75";  // Warp requires CUDA 11.5, which supports PTX ISA 7.5
     llvm::TargetOptions target_options;
     llvm::Reloc::Model relocation_model = llvm::Reloc::PIC_;
+    #if LLVM_VERSION_MAJOR >= 22
+    llvm::TargetMachine* target_machine = target->createTargetMachine(llvm::Triple("nvptx64-nvidia-cuda"), CPU, features, target_options, relocation_model);
+    #else
     llvm::TargetMachine* target_machine = target->createTargetMachine("nvptx64-nvidia-cuda", CPU, features, target_options, relocation_model);
+    #endif
 
     module->setDataLayout(target_machine->createDataLayout());
 
diff --git a/warp/native/coloring.cpp b/warp/native/coloring.cpp
index 884146c2..15520d15 100644
--- a/warp/native/coloring.cpp
+++ b/warp/native/coloring.cpp
@@ -346,7 +346,6 @@ public:
         return node_weights[node_idx];
     }
 
-
     void add_node(int weight, int node_idx)
     {
         if (weight >= weight_buckets.size()) 
diff --git a/warp/native/exports.h b/warp/native/exports.h
index 6722c6c5..dcf4ae04 100644
--- a/warp/native/exports.h
+++ b/warp/native/exports.h
@@ -1356,6 +1356,30 @@ WP_API void wp_builtin_bit_and_uint16_uint16(uint16 a, uint16 b, uint16* ret) {
 WP_API void wp_builtin_bit_and_uint32_uint32(uint32 a, uint32 b, uint32* ret) { *ret = wp::bit_and(a, b); }
 WP_API void wp_builtin_bit_and_uint64_uint64(uint64 a, uint64 b, uint64* ret) { *ret = wp::bit_and(a, b); }
 WP_API void wp_builtin_bit_and_uint8_uint8(uint8 a, uint8 b, uint8* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec2s_vec2s(vec2s& a, vec2s& b, vec2s* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec3s_vec3s(vec3s& a, vec3s& b, vec3s* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec4s_vec4s(vec4s& a, vec4s& b, vec4s* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec2i_vec2i(vec2i& a, vec2i& b, vec2i* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec3i_vec3i(vec3i& a, vec3i& b, vec3i* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec4i_vec4i(vec4i& a, vec4i& b, vec4i* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec2l_vec2l(vec2l& a, vec2l& b, vec2l* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec3l_vec3l(vec3l& a, vec3l& b, vec3l* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec4l_vec4l(vec4l& a, vec4l& b, vec4l* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec2b_vec2b(vec2b& a, vec2b& b, vec2b* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec3b_vec3b(vec3b& a, vec3b& b, vec3b* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec4b_vec4b(vec4b& a, vec4b& b, vec4b* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec2us_vec2us(vec2us& a, vec2us& b, vec2us* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec3us_vec3us(vec3us& a, vec3us& b, vec3us* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec4us_vec4us(vec4us& a, vec4us& b, vec4us* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec2ui_vec2ui(vec2ui& a, vec2ui& b, vec2ui* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec3ui_vec3ui(vec3ui& a, vec3ui& b, vec3ui* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec4ui_vec4ui(vec4ui& a, vec4ui& b, vec4ui* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec2ul_vec2ul(vec2ul& a, vec2ul& b, vec2ul* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec3ul_vec3ul(vec3ul& a, vec3ul& b, vec3ul* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec4ul_vec4ul(vec4ul& a, vec4ul& b, vec4ul* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec2ub_vec2ub(vec2ub& a, vec2ub& b, vec2ub* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec3ub_vec3ub(vec3ub& a, vec3ub& b, vec3ub* ret) { *ret = wp::bit_and(a, b); }
+WP_API void wp_builtin_bit_and_vec4ub_vec4ub(vec4ub& a, vec4ub& b, vec4ub* ret) { *ret = wp::bit_and(a, b); }
 WP_API void wp_builtin_bit_or_int16_int16(int16 a, int16 b, int16* ret) { *ret = wp::bit_or(a, b); }
 WP_API void wp_builtin_bit_or_int32_int32(int32 a, int32 b, int32* ret) { *ret = wp::bit_or(a, b); }
 WP_API void wp_builtin_bit_or_int64_int64(int64 a, int64 b, int64* ret) { *ret = wp::bit_or(a, b); }
@@ -1364,6 +1388,30 @@ WP_API void wp_builtin_bit_or_uint16_uint16(uint16 a, uint16 b, uint16* ret) { *
 WP_API void wp_builtin_bit_or_uint32_uint32(uint32 a, uint32 b, uint32* ret) { *ret = wp::bit_or(a, b); }
 WP_API void wp_builtin_bit_or_uint64_uint64(uint64 a, uint64 b, uint64* ret) { *ret = wp::bit_or(a, b); }
 WP_API void wp_builtin_bit_or_uint8_uint8(uint8 a, uint8 b, uint8* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec2s_vec2s(vec2s& a, vec2s& b, vec2s* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec3s_vec3s(vec3s& a, vec3s& b, vec3s* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec4s_vec4s(vec4s& a, vec4s& b, vec4s* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec2i_vec2i(vec2i& a, vec2i& b, vec2i* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec3i_vec3i(vec3i& a, vec3i& b, vec3i* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec4i_vec4i(vec4i& a, vec4i& b, vec4i* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec2l_vec2l(vec2l& a, vec2l& b, vec2l* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec3l_vec3l(vec3l& a, vec3l& b, vec3l* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec4l_vec4l(vec4l& a, vec4l& b, vec4l* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec2b_vec2b(vec2b& a, vec2b& b, vec2b* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec3b_vec3b(vec3b& a, vec3b& b, vec3b* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec4b_vec4b(vec4b& a, vec4b& b, vec4b* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec2us_vec2us(vec2us& a, vec2us& b, vec2us* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec3us_vec3us(vec3us& a, vec3us& b, vec3us* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec4us_vec4us(vec4us& a, vec4us& b, vec4us* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec2ui_vec2ui(vec2ui& a, vec2ui& b, vec2ui* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec3ui_vec3ui(vec3ui& a, vec3ui& b, vec3ui* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec4ui_vec4ui(vec4ui& a, vec4ui& b, vec4ui* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec2ul_vec2ul(vec2ul& a, vec2ul& b, vec2ul* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec3ul_vec3ul(vec3ul& a, vec3ul& b, vec3ul* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec4ul_vec4ul(vec4ul& a, vec4ul& b, vec4ul* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec2ub_vec2ub(vec2ub& a, vec2ub& b, vec2ub* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec3ub_vec3ub(vec3ub& a, vec3ub& b, vec3ub* ret) { *ret = wp::bit_or(a, b); }
+WP_API void wp_builtin_bit_or_vec4ub_vec4ub(vec4ub& a, vec4ub& b, vec4ub* ret) { *ret = wp::bit_or(a, b); }
 WP_API void wp_builtin_bit_xor_int16_int16(int16 a, int16 b, int16* ret) { *ret = wp::bit_xor(a, b); }
 WP_API void wp_builtin_bit_xor_int32_int32(int32 a, int32 b, int32* ret) { *ret = wp::bit_xor(a, b); }
 WP_API void wp_builtin_bit_xor_int64_int64(int64 a, int64 b, int64* ret) { *ret = wp::bit_xor(a, b); }
@@ -1372,6 +1420,30 @@ WP_API void wp_builtin_bit_xor_uint16_uint16(uint16 a, uint16 b, uint16* ret) {
 WP_API void wp_builtin_bit_xor_uint32_uint32(uint32 a, uint32 b, uint32* ret) { *ret = wp::bit_xor(a, b); }
 WP_API void wp_builtin_bit_xor_uint64_uint64(uint64 a, uint64 b, uint64* ret) { *ret = wp::bit_xor(a, b); }
 WP_API void wp_builtin_bit_xor_uint8_uint8(uint8 a, uint8 b, uint8* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec2s_vec2s(vec2s& a, vec2s& b, vec2s* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec3s_vec3s(vec3s& a, vec3s& b, vec3s* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec4s_vec4s(vec4s& a, vec4s& b, vec4s* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec2i_vec2i(vec2i& a, vec2i& b, vec2i* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec3i_vec3i(vec3i& a, vec3i& b, vec3i* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec4i_vec4i(vec4i& a, vec4i& b, vec4i* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec2l_vec2l(vec2l& a, vec2l& b, vec2l* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec3l_vec3l(vec3l& a, vec3l& b, vec3l* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec4l_vec4l(vec4l& a, vec4l& b, vec4l* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec2b_vec2b(vec2b& a, vec2b& b, vec2b* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec3b_vec3b(vec3b& a, vec3b& b, vec3b* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec4b_vec4b(vec4b& a, vec4b& b, vec4b* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec2us_vec2us(vec2us& a, vec2us& b, vec2us* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec3us_vec3us(vec3us& a, vec3us& b, vec3us* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec4us_vec4us(vec4us& a, vec4us& b, vec4us* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec2ui_vec2ui(vec2ui& a, vec2ui& b, vec2ui* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec3ui_vec3ui(vec3ui& a, vec3ui& b, vec3ui* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec4ui_vec4ui(vec4ui& a, vec4ui& b, vec4ui* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec2ul_vec2ul(vec2ul& a, vec2ul& b, vec2ul* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec3ul_vec3ul(vec3ul& a, vec3ul& b, vec3ul* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec4ul_vec4ul(vec4ul& a, vec4ul& b, vec4ul* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec2ub_vec2ub(vec2ub& a, vec2ub& b, vec2ub* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec3ub_vec3ub(vec3ub& a, vec3ub& b, vec3ub* ret) { *ret = wp::bit_xor(a, b); }
+WP_API void wp_builtin_bit_xor_vec4ub_vec4ub(vec4ub& a, vec4ub& b, vec4ub* ret) { *ret = wp::bit_xor(a, b); }
 WP_API void wp_builtin_lshift_int16_int16(int16 a, int16 b, int16* ret) { *ret = wp::lshift(a, b); }
 WP_API void wp_builtin_lshift_int32_int32(int32 a, int32 b, int32* ret) { *ret = wp::lshift(a, b); }
 WP_API void wp_builtin_lshift_int64_int64(int64 a, int64 b, int64* ret) { *ret = wp::lshift(a, b); }
@@ -1380,6 +1452,30 @@ WP_API void wp_builtin_lshift_uint16_uint16(uint16 a, uint16 b, uint16* ret) { *
 WP_API void wp_builtin_lshift_uint32_uint32(uint32 a, uint32 b, uint32* ret) { *ret = wp::lshift(a, b); }
 WP_API void wp_builtin_lshift_uint64_uint64(uint64 a, uint64 b, uint64* ret) { *ret = wp::lshift(a, b); }
 WP_API void wp_builtin_lshift_uint8_uint8(uint8 a, uint8 b, uint8* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec2s_vec2s(vec2s& a, vec2s& b, vec2s* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec3s_vec3s(vec3s& a, vec3s& b, vec3s* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec4s_vec4s(vec4s& a, vec4s& b, vec4s* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec2i_vec2i(vec2i& a, vec2i& b, vec2i* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec3i_vec3i(vec3i& a, vec3i& b, vec3i* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec4i_vec4i(vec4i& a, vec4i& b, vec4i* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec2l_vec2l(vec2l& a, vec2l& b, vec2l* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec3l_vec3l(vec3l& a, vec3l& b, vec3l* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec4l_vec4l(vec4l& a, vec4l& b, vec4l* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec2b_vec2b(vec2b& a, vec2b& b, vec2b* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec3b_vec3b(vec3b& a, vec3b& b, vec3b* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec4b_vec4b(vec4b& a, vec4b& b, vec4b* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec2us_vec2us(vec2us& a, vec2us& b, vec2us* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec3us_vec3us(vec3us& a, vec3us& b, vec3us* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec4us_vec4us(vec4us& a, vec4us& b, vec4us* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec2ui_vec2ui(vec2ui& a, vec2ui& b, vec2ui* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec3ui_vec3ui(vec3ui& a, vec3ui& b, vec3ui* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec4ui_vec4ui(vec4ui& a, vec4ui& b, vec4ui* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec2ul_vec2ul(vec2ul& a, vec2ul& b, vec2ul* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec3ul_vec3ul(vec3ul& a, vec3ul& b, vec3ul* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec4ul_vec4ul(vec4ul& a, vec4ul& b, vec4ul* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec2ub_vec2ub(vec2ub& a, vec2ub& b, vec2ub* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec3ub_vec3ub(vec3ub& a, vec3ub& b, vec3ub* ret) { *ret = wp::lshift(a, b); }
+WP_API void wp_builtin_lshift_vec4ub_vec4ub(vec4ub& a, vec4ub& b, vec4ub* ret) { *ret = wp::lshift(a, b); }
 WP_API void wp_builtin_rshift_int16_int16(int16 a, int16 b, int16* ret) { *ret = wp::rshift(a, b); }
 WP_API void wp_builtin_rshift_int32_int32(int32 a, int32 b, int32* ret) { *ret = wp::rshift(a, b); }
 WP_API void wp_builtin_rshift_int64_int64(int64 a, int64 b, int64* ret) { *ret = wp::rshift(a, b); }
@@ -1388,6 +1484,30 @@ WP_API void wp_builtin_rshift_uint16_uint16(uint16 a, uint16 b, uint16* ret) { *
 WP_API void wp_builtin_rshift_uint32_uint32(uint32 a, uint32 b, uint32* ret) { *ret = wp::rshift(a, b); }
 WP_API void wp_builtin_rshift_uint64_uint64(uint64 a, uint64 b, uint64* ret) { *ret = wp::rshift(a, b); }
 WP_API void wp_builtin_rshift_uint8_uint8(uint8 a, uint8 b, uint8* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec2s_vec2s(vec2s& a, vec2s& b, vec2s* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec3s_vec3s(vec3s& a, vec3s& b, vec3s* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec4s_vec4s(vec4s& a, vec4s& b, vec4s* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec2i_vec2i(vec2i& a, vec2i& b, vec2i* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec3i_vec3i(vec3i& a, vec3i& b, vec3i* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec4i_vec4i(vec4i& a, vec4i& b, vec4i* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec2l_vec2l(vec2l& a, vec2l& b, vec2l* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec3l_vec3l(vec3l& a, vec3l& b, vec3l* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec4l_vec4l(vec4l& a, vec4l& b, vec4l* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec2b_vec2b(vec2b& a, vec2b& b, vec2b* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec3b_vec3b(vec3b& a, vec3b& b, vec3b* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec4b_vec4b(vec4b& a, vec4b& b, vec4b* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec2us_vec2us(vec2us& a, vec2us& b, vec2us* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec3us_vec3us(vec3us& a, vec3us& b, vec3us* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec4us_vec4us(vec4us& a, vec4us& b, vec4us* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec2ui_vec2ui(vec2ui& a, vec2ui& b, vec2ui* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec3ui_vec3ui(vec3ui& a, vec3ui& b, vec3ui* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec4ui_vec4ui(vec4ui& a, vec4ui& b, vec4ui* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec2ul_vec2ul(vec2ul& a, vec2ul& b, vec2ul* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec3ul_vec3ul(vec3ul& a, vec3ul& b, vec3ul* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec4ul_vec4ul(vec4ul& a, vec4ul& b, vec4ul* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec2ub_vec2ub(vec2ub& a, vec2ub& b, vec2ub* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec3ub_vec3ub(vec3ub& a, vec3ub& b, vec3ub* ret) { *ret = wp::rshift(a, b); }
+WP_API void wp_builtin_rshift_vec4ub_vec4ub(vec4ub& a, vec4ub& b, vec4ub* ret) { *ret = wp::rshift(a, b); }
 WP_API void wp_builtin_invert_int16(int16 a, int16* ret) { *ret = wp::invert(a); }
 WP_API void wp_builtin_invert_int32(int32 a, int32* ret) { *ret = wp::invert(a); }
 WP_API void wp_builtin_invert_int64(int64 a, int64* ret) { *ret = wp::invert(a); }
@@ -1396,6 +1516,30 @@ WP_API void wp_builtin_invert_uint16(uint16 a, uint16* ret) { *ret = wp::invert(
 WP_API void wp_builtin_invert_uint32(uint32 a, uint32* ret) { *ret = wp::invert(a); }
 WP_API void wp_builtin_invert_uint64(uint64 a, uint64* ret) { *ret = wp::invert(a); }
 WP_API void wp_builtin_invert_uint8(uint8 a, uint8* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec2s(vec2s& a, vec2s* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec3s(vec3s& a, vec3s* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec4s(vec4s& a, vec4s* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec2i(vec2i& a, vec2i* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec3i(vec3i& a, vec3i* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec4i(vec4i& a, vec4i* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec2l(vec2l& a, vec2l* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec3l(vec3l& a, vec3l* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec4l(vec4l& a, vec4l* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec2b(vec2b& a, vec2b* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec3b(vec3b& a, vec3b* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec4b(vec4b& a, vec4b* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec2us(vec2us& a, vec2us* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec3us(vec3us& a, vec3us* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec4us(vec4us& a, vec4us* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec2ui(vec2ui& a, vec2ui* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec3ui(vec3ui& a, vec3ui* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec4ui(vec4ui& a, vec4ui* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec2ul(vec2ul& a, vec2ul* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec3ul(vec3ul& a, vec3ul* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec4ul(vec4ul& a, vec4ul* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec2ub(vec2ub& a, vec2ub* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec3ub(vec3ub& a, vec3ub* ret) { *ret = wp::invert(a); }
+WP_API void wp_builtin_invert_vec4ub(vec4ub& a, vec4ub* ret) { *ret = wp::invert(a); }
 WP_API void wp_builtin_mul_float16_float16(float16 a, float16 b, float16* ret) { *ret = wp::mul(a, b); }
 WP_API void wp_builtin_mul_float32_float32(float32 a, float32 b, float32* ret) { *ret = wp::mul(a, b); }
 WP_API void wp_builtin_mul_float64_float64(float64 a, float64 b, float64* ret) { *ret = wp::mul(a, b); }
diff --git a/warp/native/hashgrid.cu b/warp/native/hashgrid.cu
index 1e29a355..c98b3f98 100644
--- a/warp/native/hashgrid.cu
+++ b/warp/native/hashgrid.cu
@@ -20,6 +20,8 @@
 #include "hashgrid.h"
 #include "sort.h"
 
+extern CUcontext get_current_context();
+
 namespace wp
 {
 
diff --git a/warp/native/mat.h b/warp/native/mat.h
index 6b7c6fb7..51ed2fb9 100644
--- a/warp/native/mat.h
+++ b/warp/native/mat.h
@@ -437,6 +437,42 @@ inline CUDA_CALLABLE mat_t<Rows,Cols,Type> atomic_add(mat_t<Rows,Cols,Type> * ad
     return m;
 }
 
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> atomic_and(mat_t<Rows,Cols,Type> * addr, mat_t<Rows,Cols,Type> value) 
+{
+    mat_t<Rows,Cols,Type> m;
+    
+    for (unsigned i=0; i < Rows; ++i)
+        for (unsigned j=0; j < Cols; ++j)
+            m.data[i][j] = atomic_and(&addr->data[i][j], value.data[i][j]);
+
+    return m;
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> atomic_or(mat_t<Rows,Cols,Type> * addr, mat_t<Rows,Cols,Type> value) 
+{
+    mat_t<Rows,Cols,Type> m;
+    
+    for (unsigned i=0; i < Rows; ++i)
+        for (unsigned j=0; j < Cols; ++j)
+            m.data[i][j] = atomic_or(&addr->data[i][j], value.data[i][j]);
+
+    return m;
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> atomic_xor(mat_t<Rows,Cols,Type> * addr, mat_t<Rows,Cols,Type> value) 
+{
+    mat_t<Rows,Cols,Type> m;
+    
+    for (unsigned i=0; i < Rows; ++i)
+        for (unsigned j=0; j < Cols; ++j)
+            m.data[i][j] = atomic_xor(&addr->data[i][j], value.data[i][j]);
+
+    return m;
+}
+
 template<unsigned Rows, unsigned Cols, typename Type>
 inline CUDA_CALLABLE mat_t<Rows,Cols,Type> atomic_min(mat_t<Rows,Cols,Type> * addr, mat_t<Rows,Cols,Type> value) 
 {
@@ -1619,7 +1655,7 @@ inline CUDA_CALLABLE void adj_sub_inplace(
 
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, int row, int col, Type value)
+inline CUDA_CALLABLE void bit_and_inplace(mat_t<Rows,Cols,Type>& m, int row, int col, Type value)
 {
 #ifndef NDEBUG
     if (row < -(int)Rows || row >= (int)Rows)
@@ -1643,12 +1679,12 @@ inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, int row, int
         col += Cols;
     }
 
-    m.data[row][col] = value;
+    m.data[row][col] &= value;
 }
 
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, int row, vec_t<Cols,Type>& value)
+inline CUDA_CALLABLE void bit_and_inplace(mat_t<Rows,Cols,Type>& m, int row, vec_t<Cols,Type>& value)
 {
 #ifndef NDEBUG
     if (row < -(int)Rows || row >= (int)Rows)
@@ -1665,13 +1701,13 @@ inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, int row, vec_
 
     for(unsigned i=0; i < Cols; ++i)
     {
-        m.data[row][i] = value[i];
+        m.data[row][i] &= value[i];
     }
 }
 
 
 template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value)
+inline CUDA_CALLABLE void bit_and_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value)
 {
     static_assert(
         RowSliceLength == 0 ? ColSliceLength == 0 : ColSliceLength == Cols,
@@ -1694,7 +1730,7 @@ inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_s
     {
         for (int j = 0; j < Cols; ++j)
         {
-            m.data[i][j] = value.data[ii][j];
+            m.data[i][j] &= value.data[ii][j];
         }
 
         ++ii;
@@ -1705,7 +1741,7 @@ inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_s
 
 
 template<unsigned RowSliceLength, unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_slice, int col, vec_t<RowSliceLength, Type>& value)
+inline CUDA_CALLABLE void bit_and_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_slice, int col, vec_t<RowSliceLength, Type>& value)
 {
 #ifndef NDEBUG
     if (col < -(int)Cols || col >= (int)Cols)
@@ -1734,7 +1770,7 @@ inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_s
         i += row_slice.step
     )
     {
-        m.data[i][col] = value.c[ii];
+        m.data[i][col] &= value.c[ii];
         ++ii;
     }
 
@@ -1743,7 +1779,7 @@ inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_s
 
 
 template<unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, int row, slice_t col_slice, vec_t<ColSliceLength, Type>& value)
+inline CUDA_CALLABLE void bit_and_inplace(mat_t<Rows,Cols,Type>& m, int row, slice_t col_slice, vec_t<ColSliceLength, Type>& value)
 {
 #ifndef NDEBUG
     if (row < -(int)Rows || row >= (int)Rows)
@@ -1772,7 +1808,7 @@ inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, int row, slic
         i += col_slice.step
     )
     {
-        m.data[row][i] = value.c[ii];
+        m.data[row][i] &= value.c[ii];
         ++ii;
     }
 
@@ -1781,7 +1817,7 @@ inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, int row, slic
 
 
 template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_slice, slice_t col_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value)
+inline CUDA_CALLABLE void bit_and_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_slice, slice_t col_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value)
 {
     assert(row_slice.start >= 0 && row_slice.start <= (int)Rows);
     assert(row_slice.stop >= -1 && row_slice.stop <= (int)Rows);
@@ -1810,7 +1846,7 @@ inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_s
             j += col_slice.step
         )
         {
-            m.data[i][j] = value.data[ii][jj];
+            m.data[i][j] &= value.data[ii][jj];
             ++jj;
         }
 
@@ -1823,8 +1859,50 @@ inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_s
 
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE void adj_assign_inplace(mat_t<Rows,Cols,Type>& m, int row, int col, Type value,
-                                        mat_t<Rows,Cols,Type>& adj_m, int& adj_row, int& adj_col, Type& adj_value)
+inline CUDA_CALLABLE void adj_bit_and_inplace(
+    mat_t<Rows,Cols,Type>& m, int row, int col, Type value,
+    mat_t<Rows,Cols,Type>& adj_m, int adj_row, int adj_col, Type& adj_value
+) {}
+
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_and_inplace(
+    mat_t<Rows,Cols,Type>& m, int row, vec_t<Cols,Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, int adj_row, vec_t<Cols,Type>& adj_value
+) {}
+
+
+template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_and_inplace(
+    mat_t<Rows,Cols,Type>& m, slice_t row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& adj_value
+) {}
+
+
+template<unsigned RowSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_and_inplace(
+    mat_t<Rows,Cols,Type>& m, slice_t row_slice, int col, vec_t<RowSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, int& adj_col, vec_t<RowSliceLength, Type>& adj_value
+) {}
+
+
+template<unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_and_inplace(
+    mat_t<Rows,Cols,Type>& m, int row, slice_t col_slice, vec_t<ColSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, int& adj_row, slice_t& adj_col_slice, vec_t<ColSliceLength, Type>& adj_value
+) {}
+
+
+template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_and_inplace(
+    mat_t<Rows,Cols,Type>& m, slice_t row_slice, slice_t col_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, slice_t& adj_col_slice, mat_t<RowSliceLength, ColSliceLength, Type>& adj_value
+) {}
+
+
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void bit_or_inplace(mat_t<Rows,Cols,Type>& m, int row, int col, Type value)
 {
 #ifndef NDEBUG
     if (row < -(int)Rows || row >= (int)Rows)
@@ -1848,13 +1926,12 @@ inline CUDA_CALLABLE void adj_assign_inplace(mat_t<Rows,Cols,Type>& m, int row,
         col += Cols;
     }
 
-    adj_value += adj_m.data[row][col];
+    m.data[row][col] |= value;
 }
 
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE void adj_assign_inplace(mat_t<Rows,Cols,Type>& m, int row, vec_t<Cols,Type>& value,
-                                        mat_t<Rows,Cols,Type>& adj_m, int& adj_row, vec_t<Cols,Type>& adj_value)
+inline CUDA_CALLABLE void bit_or_inplace(mat_t<Rows,Cols,Type>& m, int row, vec_t<Cols,Type>& value)
 {
 #ifndef NDEBUG
     if (row < -(int)Rows || row >= (int)Rows)
@@ -1871,16 +1948,13 @@ inline CUDA_CALLABLE void adj_assign_inplace(mat_t<Rows,Cols,Type>& m, int row,
 
     for(unsigned i=0; i < Cols; ++i)
     {
-        adj_value[i] += adj_m.data[row][i];
+        m.data[row][i] |= value[i];
     }
 }
 
 
 template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE void adj_assign_inplace(
-    mat_t<Rows,Cols,Type>& m, slice_t row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value,
-    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& adj_value
-)
+inline CUDA_CALLABLE void bit_or_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value)
 {
     static_assert(
         RowSliceLength == 0 ? ColSliceLength == 0 : ColSliceLength == Cols,
@@ -1903,7 +1977,7 @@ inline CUDA_CALLABLE void adj_assign_inplace(
     {
         for (int j = 0; j < Cols; ++j)
         {
-            adj_value.data[ii][j] += adj_m.data[i][j];
+            m.data[i][j] |= value.data[ii][j];
         }
 
         ++ii;
@@ -1914,10 +1988,7 @@ inline CUDA_CALLABLE void adj_assign_inplace(
 
 
 template<unsigned RowSliceLength, unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE void adj_assign_inplace(
-    mat_t<Rows,Cols,Type>& m, slice_t row_slice, int col, vec_t<RowSliceLength, Type>& value,
-    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, int& adj_col, vec_t<RowSliceLength, Type>& adj_value
-)
+inline CUDA_CALLABLE void bit_or_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_slice, int col, vec_t<RowSliceLength, Type>& value)
 {
 #ifndef NDEBUG
     if (col < -(int)Cols || col >= (int)Cols)
@@ -1946,7 +2017,7 @@ inline CUDA_CALLABLE void adj_assign_inplace(
         i += row_slice.step
     )
     {
-        adj_value.c[ii] += adj_m.data[i][col];
+        m.data[i][col] |= value.c[ii];
         ++ii;
     }
 
@@ -1955,10 +2026,7 @@ inline CUDA_CALLABLE void adj_assign_inplace(
 
 
 template<unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE void adj_assign_inplace(
-    mat_t<Rows,Cols,Type>& m, int row, slice_t col_slice, vec_t<ColSliceLength, Type>& value,
-    mat_t<Rows,Cols,Type>& adj_m, int& adj_row, slice_t& adj_col_slice, vec_t<ColSliceLength, Type>& adj_value
-)
+inline CUDA_CALLABLE void bit_or_inplace(mat_t<Rows,Cols,Type>& m, int row, slice_t col_slice, vec_t<ColSliceLength, Type>& value)
 {
 #ifndef NDEBUG
     if (row < -(int)Rows || row >= (int)Rows)
@@ -1987,7 +2055,7 @@ inline CUDA_CALLABLE void adj_assign_inplace(
         i += col_slice.step
     )
     {
-        adj_value.c[ii] += adj_m.data[row][i];
+        m.data[row][i] |= value.c[ii];
         ++ii;
     }
 
@@ -1996,10 +2064,7 @@ inline CUDA_CALLABLE void adj_assign_inplace(
 
 
 template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE void adj_assign_inplace(
-    mat_t<Rows,Cols,Type>& m, slice_t row_slice, slice_t col_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value,
-    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, slice_t& adj_col_slice, mat_t<RowSliceLength, ColSliceLength, Type>& adj_value
-)
+inline CUDA_CALLABLE void bit_or_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_slice, slice_t col_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value)
 {
     assert(row_slice.start >= 0 && row_slice.start <= (int)Rows);
     assert(row_slice.stop >= -1 && row_slice.stop <= (int)Rows);
@@ -2028,7 +2093,7 @@ inline CUDA_CALLABLE void adj_assign_inplace(
             j += col_slice.step
         )
         {
-            adj_value.data[ii][jj] += adj_m.data[i][j];
+            m.data[i][j] |= value.data[ii][jj];
             ++jj;
         }
 
@@ -2041,100 +2106,50 @@ inline CUDA_CALLABLE void adj_assign_inplace(
 
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE mat_t<Rows,Cols,Type> assign_copy(mat_t<Rows,Cols,Type>& m, int row, int col, Type value)
-{
-#ifndef NDEBUG
-    if (row < -(int)Rows || row >= (int)Rows)
-    {
-        printf("mat row index %d out of bounds at %s %d\n", row, __FILE__, __LINE__);
-        assert(0);
-    }
-    if (col < -(int)Cols || col >= (int)Cols)
-    {
-        printf("mat col index %d out of bounds at %s %d\n", col, __FILE__, __LINE__);
-        assert(0);
-    }
-#endif
-
-    if (row < 0)
-    {
-        row += Rows;
-    }
-    if (col < 0)
-    {
-        col += Cols;
-    }
-
-    mat_t<Rows,Cols,Type> ret(m);
-    ret.data[row][col] = value;
-    return ret;
-}
+inline CUDA_CALLABLE void adj_bit_or_inplace(
+    mat_t<Rows,Cols,Type>& m, int row, int col, Type value,
+    mat_t<Rows,Cols,Type>& adj_m, int adj_row, int adj_col, Type& adj_value
+) {}
 
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE mat_t<Rows,Cols,Type> assign_copy(mat_t<Rows,Cols,Type>& m, int row, vec_t<Cols,Type>& value)
-{
-#ifndef NDEBUG
-    if (row < -(int)Rows || row >= (int)Rows)
-    {
-        printf("mat row index %d out of bounds at %s %d\n", row, __FILE__, __LINE__);
-        assert(0);
-    }
-#endif
-
-    if (row < 0)
-    {
-        row += Rows;
-    }
-
-    mat_t<Rows,Cols,Type> ret(m);
-    for(unsigned i=0; i < Cols; ++i)
-    {
-        ret.data[row][i] = value[i];
-    }
-    return ret;
-}
+inline CUDA_CALLABLE void adj_bit_or_inplace(
+    mat_t<Rows,Cols,Type>& m, int row, vec_t<Cols,Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, int adj_row, vec_t<Cols,Type>& adj_value
+) {}
 
 
 template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE mat_t<Rows,Cols,Type> assign_copy(mat_t<Rows,Cols,Type>& m, slice_t row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value)
-{
-    mat_t<Rows, Cols, Type> ret(m);
-    assign_inplace(ret, row_slice, value);
-    return ret;
-}
+inline CUDA_CALLABLE void adj_bit_or_inplace(
+    mat_t<Rows,Cols,Type>& m, slice_t row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& adj_value
+) {}
 
 
 template<unsigned RowSliceLength, unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE mat_t<Rows,Cols,Type> assign_copy(mat_t<Rows,Cols,Type>& m, slice_t row_slice, int col, vec_t<RowSliceLength, Type>& value)
-{
-    mat_t<Rows, Cols, Type> ret(m);
-    assign_inplace(ret, row_slice, col, value);
-    return ret;
-}
+inline CUDA_CALLABLE void adj_bit_or_inplace(
+    mat_t<Rows,Cols,Type>& m, slice_t row_slice, int col, vec_t<RowSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, int& adj_col, vec_t<RowSliceLength, Type>& adj_value
+) {}
 
 
 template<unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE mat_t<Rows,Cols,Type> assign_copy(mat_t<Rows,Cols,Type>& m, int row, slice_t col_slice, vec_t<ColSliceLength, Type>& value)
-{
-    mat_t<Rows, Cols, Type> ret(m);
-    assign_inplace(ret, row, col_slice, value);
-    return ret;
-}
+inline CUDA_CALLABLE void adj_bit_or_inplace(
+    mat_t<Rows,Cols,Type>& m, int row, slice_t col_slice, vec_t<ColSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, int& adj_row, slice_t& adj_col_slice, vec_t<ColSliceLength, Type>& adj_value
+) {}
 
 
 template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE mat_t<Rows,Cols,Type> assign_copy(mat_t<Rows,Cols,Type>& m, slice_t row_slice, slice_t col_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value)
-{
-    mat_t<Rows, Cols, Type> ret(m);
-    assign_inplace(ret, row_slice, col_slice, value);
-    return ret;
-}
+inline CUDA_CALLABLE void adj_bit_or_inplace(
+    mat_t<Rows,Cols,Type>& m, slice_t row_slice, slice_t col_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, slice_t& adj_col_slice, mat_t<RowSliceLength, ColSliceLength, Type>& adj_value
+) {}
+
 
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE void adj_assign_copy(mat_t<Rows,Cols,Type>& m, int row, int col, Type value,
-                                        mat_t<Rows,Cols,Type>& adj_m, int& adj_row, int& adj_col, Type& adj_value, const mat_t<Rows,Cols,Type>& adj_ret)
+inline CUDA_CALLABLE void bit_xor_inplace(mat_t<Rows,Cols,Type>& m, int row, int col, Type value)
 {
 #ifndef NDEBUG
     if (row < -(int)Rows || row >= (int)Rows)
@@ -2158,21 +2173,12 @@ inline CUDA_CALLABLE void adj_assign_copy(mat_t<Rows,Cols,Type>& m, int row, int
         col += Cols;
     }
 
-    adj_value += adj_ret.data[row][col];
-    for(unsigned i=0; i < Rows; ++i)
-    {
-        for(unsigned j=0; j < Cols; ++j)
-        {
-            if(i != row || j != col)
-                adj_m.data[i][j] += adj_ret.data[i][j];
-        }
-    }
+    m.data[row][col] ^= value;
 }
 
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE void adj_assign_copy(mat_t<Rows,Cols,Type>& m, int row, vec_t<Cols,Type>& value,
-                                        mat_t<Rows,Cols,Type>& adj_m, int& adj_row, vec_t<Cols,Type>& adj_value, const mat_t<Rows,Cols,Type>& adj_ret)
+inline CUDA_CALLABLE void bit_xor_inplace(mat_t<Rows,Cols,Type>& m, int row, vec_t<Cols,Type>& value)
 {
 #ifndef NDEBUG
     if (row < -(int)Rows || row >= (int)Rows)
@@ -2187,25 +2193,15 @@ inline CUDA_CALLABLE void adj_assign_copy(mat_t<Rows,Cols,Type>& m, int row, vec
         row += Rows;
     }
 
-    for(unsigned i=0; i < Rows; ++i)
+    for(unsigned i=0; i < Cols; ++i)
     {
-        for(unsigned j=0; j < Cols; ++j)
-        {
-            if (i==row)
-                adj_value[j] += adj_ret.data[i][j];
-            else
-                adj_m.data[i][j] += adj_ret.data[i][j];
-        }
+        m.data[row][i] ^= value[i];
     }
 }
 
 
 template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE void adj_assign_copy(
-    mat_t<Rows,Cols,Type>& m, slice_t row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value,
-    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& adj_value,
-    mat_t<Rows,Cols,Type>& adj_ret
-)
+inline CUDA_CALLABLE void bit_xor_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value)
 {
     static_assert(
         RowSliceLength == 0 ? ColSliceLength == 0 : ColSliceLength == Cols,
@@ -2220,28 +2216,18 @@ inline CUDA_CALLABLE void adj_assign_copy(
     bool is_row_reversed = row_slice.step < 0;
 
     int ii = 0;
-    for (int i = 0; i < Rows; ++i)
+    for (
+        int i = row_slice.start;
+        is_row_reversed ? (i > row_slice.stop) : (i < row_slice.stop);
+        i += row_slice.step
+    )
     {
-        bool in_row_slice = is_row_reversed
-            ? (i <= row_slice.start && i > row_slice.stop && (row_slice.start - i) % (-row_slice.step) == 0)
-            : (i >= row_slice.start && i < row_slice.stop && (i - row_slice.start) % row_slice.step == 0);
-
-        if (!in_row_slice)
+        for (int j = 0; j < Cols; ++j)
         {
-            for (int j = 0; j < Cols; ++j)
-            {
-                adj_m.data[i][j] += adj_ret.data[i][j];
-            }
+            m.data[i][j] ^= value.data[ii][j];
         }
-        else
-        {
-            for (int j = 0; j < Cols; ++j)
-            {
-                adj_value.data[ii][j] += adj_ret.data[i][j];
-            }
 
-            ++ii;
-        }
+        ++ii;
     }
 
     assert(ii == RowSliceLength);
@@ -2249,11 +2235,7 @@ inline CUDA_CALLABLE void adj_assign_copy(
 
 
 template<unsigned RowSliceLength, unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE void adj_assign_copy(
-    mat_t<Rows,Cols,Type>& m, slice_t row_slice, int col, vec_t<RowSliceLength, Type>& value,
-    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, int& adj_col, vec_t<RowSliceLength, Type>& adj_value,
-    mat_t<Rows,Cols,Type>& adj_ret
-)
+inline CUDA_CALLABLE void bit_xor_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_slice, int col, vec_t<RowSliceLength, Type>& value)
 {
 #ifndef NDEBUG
     if (col < -(int)Cols || col >= (int)Cols)
@@ -2276,22 +2258,816 @@ inline CUDA_CALLABLE void adj_assign_copy(
     bool is_row_reversed = row_slice.step < 0;
 
     int ii = 0;
-    for (int i = 0; i < Rows; ++i)
+    for (
+        int i = row_slice.start;
+        is_row_reversed ? (i > row_slice.stop) : (i < row_slice.stop);
+        i += row_slice.step
+    )
     {
-        bool in_row_slice = is_row_reversed
-            ? (i <= row_slice.start && i > row_slice.stop && (row_slice.start - i) % (-row_slice.step) == 0)
-            : (i >= row_slice.start && i < row_slice.stop && (i - row_slice.start) % row_slice.step == 0);
+        m.data[i][col] ^= value.c[ii];
+        ++ii;
+    }
 
-        if (!in_row_slice)
-        {
-            for (int j = 0; j < Cols; ++j)
-            {
-                adj_m.data[i][j] += adj_ret.data[i][j];
-            }
-        }
-        else
-        {
-            for (int j = 0; j < Cols; ++j)
+    assert(ii == RowSliceLength);
+}
+
+
+template<unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void bit_xor_inplace(mat_t<Rows,Cols,Type>& m, int row, slice_t col_slice, vec_t<ColSliceLength, Type>& value)
+{
+#ifndef NDEBUG
+    if (row < -(int)Rows || row >= (int)Rows)
+    {
+        printf("mat row index %d out of bounds at %s %d\n", row, __FILE__, __LINE__);
+        assert(0);
+    }
+#endif
+
+    assert(col_slice.start >= 0 && col_slice.start <= (int)Cols);
+    assert(col_slice.stop >= -1 && col_slice.stop <= (int)Cols);
+    assert(col_slice.step != 0 && col_slice.step < 0 ? col_slice.start >= col_slice.stop : col_slice.start <= col_slice.stop);
+    assert(slice_get_length(col_slice) == ColSliceLength);
+
+    if (row < 0)
+    {
+        row += Rows;
+    }
+
+    bool is_col_reversed = col_slice.step < 0;
+
+    int ii = 0;
+    for (
+        int i = col_slice.start;
+        is_col_reversed ? (i > col_slice.stop) : (i < col_slice.stop);
+        i += col_slice.step
+    )
+    {
+        m.data[row][i] ^= value.c[ii];
+        ++ii;
+    }
+
+    assert(ii == ColSliceLength);
+}
+
+
+template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void bit_xor_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_slice, slice_t col_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value)
+{
+    assert(row_slice.start >= 0 && row_slice.start <= (int)Rows);
+    assert(row_slice.stop >= -1 && row_slice.stop <= (int)Rows);
+    assert(row_slice.step != 0 && row_slice.step < 0 ? row_slice.start >= row_slice.stop : row_slice.start <= row_slice.stop);
+    assert(slice_get_length(row_slice) == RowSliceLength);
+
+    assert(col_slice.start >= 0 && col_slice.start <= (int)Cols);
+    assert(col_slice.stop >= -1 && col_slice.stop <= (int)Cols);
+    assert(col_slice.step != 0 && col_slice.step < 0 ? col_slice.start >= col_slice.stop : col_slice.start <= col_slice.stop);
+    assert(slice_get_length(col_slice) == ColSliceLength);
+
+    bool is_row_reversed = row_slice.step < 0;
+    bool is_col_reversed = col_slice.step < 0;
+
+    int ii = 0;
+    for (
+        int i = row_slice.start;
+        is_row_reversed ? (i > row_slice.stop) : (i < row_slice.stop);
+        i += row_slice.step
+    )
+    {
+        int jj = 0;
+        for (
+            int j = col_slice.start;
+            is_col_reversed ? (j > col_slice.stop) : (j < col_slice.stop);
+            j += col_slice.step
+        )
+        {
+            m.data[i][j] ^= value.data[ii][jj];
+            ++jj;
+        }
+
+        assert(jj == ColSliceLength);
+        ++ii;
+    }
+
+    assert(ii == RowSliceLength);
+}
+
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_xor_inplace(
+    mat_t<Rows,Cols,Type>& m, int row, int col, Type value,
+    mat_t<Rows,Cols,Type>& adj_m, int adj_row, int adj_col, Type& adj_value
+) {}
+
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_xor_inplace(
+    mat_t<Rows,Cols,Type>& m, int row, vec_t<Cols,Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, int adj_row, vec_t<Cols,Type>& adj_value
+) {}
+
+
+template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_xor_inplace(
+    mat_t<Rows,Cols,Type>& m, slice_t row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& adj_value
+) {}
+
+
+template<unsigned RowSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_xor_inplace(
+    mat_t<Rows,Cols,Type>& m, slice_t row_slice, int col, vec_t<RowSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, int& adj_col, vec_t<RowSliceLength, Type>& adj_value
+) {}
+
+
+template<unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_xor_inplace(
+    mat_t<Rows,Cols,Type>& m, int row, slice_t col_slice, vec_t<ColSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, int& adj_row, slice_t& adj_col_slice, vec_t<ColSliceLength, Type>& adj_value
+) {}
+
+
+template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_xor_inplace(
+    mat_t<Rows,Cols,Type>& m, slice_t row_slice, slice_t col_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, slice_t& adj_col_slice, mat_t<RowSliceLength, ColSliceLength, Type>& adj_value
+) {}
+
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, int row, int col, Type value)
+{
+#ifndef NDEBUG
+    if (row < -(int)Rows || row >= (int)Rows)
+    {
+        printf("mat row index %d out of bounds at %s %d\n", row, __FILE__, __LINE__);
+        assert(0);
+    }
+    if (col < -(int)Cols || col >= (int)Cols)
+    {
+        printf("mat col index %d out of bounds at %s %d\n", col, __FILE__, __LINE__);
+        assert(0);
+    }
+#endif
+
+    if (row < 0)
+    {
+        row += Rows;
+    }
+    if (col < 0)
+    {
+        col += Cols;
+    }
+
+    m.data[row][col] = value;
+}
+
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, int row, vec_t<Cols,Type>& value)
+{
+#ifndef NDEBUG
+    if (row < -(int)Rows || row >= (int)Rows)
+    {
+        printf("mat row index %d out of bounds at %s %d\n", row, __FILE__, __LINE__);
+        assert(0);
+    }
+#endif
+
+    if (row < 0)
+    {
+        row += Rows;
+    }
+
+    for(unsigned i=0; i < Cols; ++i)
+    {
+        m.data[row][i] = value[i];
+    }
+}
+
+
+template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value)
+{
+    static_assert(
+        RowSliceLength == 0 ? ColSliceLength == 0 : ColSliceLength == Cols,
+        "Expected RowSliceLength == 0 ? ColSliceLength == 0 : ColSliceLength == Cols"
+    );
+
+    assert(row_slice.start >= 0 && row_slice.start <= (int)Rows);
+    assert(row_slice.stop >= -1 && row_slice.stop <= (int)Rows);
+    assert(row_slice.step != 0 && row_slice.step < 0 ? row_slice.start >= row_slice.stop : row_slice.start <= row_slice.stop);
+    assert(slice_get_length(row_slice) == RowSliceLength);
+
+    bool is_row_reversed = row_slice.step < 0;
+
+    int ii = 0;
+    for (
+        int i = row_slice.start;
+        is_row_reversed ? (i > row_slice.stop) : (i < row_slice.stop);
+        i += row_slice.step
+    )
+    {
+        for (int j = 0; j < Cols; ++j)
+        {
+            m.data[i][j] = value.data[ii][j];
+        }
+
+        ++ii;
+    }
+
+    assert(ii == RowSliceLength);
+}
+
+
+template<unsigned RowSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_slice, int col, vec_t<RowSliceLength, Type>& value)
+{
+#ifndef NDEBUG
+    if (col < -(int)Cols || col >= (int)Cols)
+    {
+        printf("mat col index %d out of bounds at %s %d\n", col, __FILE__, __LINE__);
+        assert(0);
+    }
+#endif
+
+    assert(row_slice.start >= 0 && row_slice.start <= (int)Rows);
+    assert(row_slice.stop >= -1 && row_slice.stop <= (int)Rows);
+    assert(row_slice.step != 0 && row_slice.step < 0 ? row_slice.start >= row_slice.stop : row_slice.start <= row_slice.stop);
+    assert(slice_get_length(row_slice) == RowSliceLength);
+
+    if (col < 0)
+    {
+        col += Cols;
+    }
+
+    bool is_row_reversed = row_slice.step < 0;
+
+    int ii = 0;
+    for (
+        int i = row_slice.start;
+        is_row_reversed ? (i > row_slice.stop) : (i < row_slice.stop);
+        i += row_slice.step
+    )
+    {
+        m.data[i][col] = value.c[ii];
+        ++ii;
+    }
+
+    assert(ii == RowSliceLength);
+}
+
+
+template<unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, int row, slice_t col_slice, vec_t<ColSliceLength, Type>& value)
+{
+#ifndef NDEBUG
+    if (row < -(int)Rows || row >= (int)Rows)
+    {
+        printf("mat row index %d out of bounds at %s %d\n", row, __FILE__, __LINE__);
+        assert(0);
+    }
+#endif
+
+    assert(col_slice.start >= 0 && col_slice.start <= (int)Cols);
+    assert(col_slice.stop >= -1 && col_slice.stop <= (int)Cols);
+    assert(col_slice.step != 0 && col_slice.step < 0 ? col_slice.start >= col_slice.stop : col_slice.start <= col_slice.stop);
+    assert(slice_get_length(col_slice) == ColSliceLength);
+
+    if (row < 0)
+    {
+        row += Rows;
+    }
+
+    bool is_col_reversed = col_slice.step < 0;
+
+    int ii = 0;
+    for (
+        int i = col_slice.start;
+        is_col_reversed ? (i > col_slice.stop) : (i < col_slice.stop);
+        i += col_slice.step
+    )
+    {
+        m.data[row][i] = value.c[ii];
+        ++ii;
+    }
+
+    assert(ii == ColSliceLength);
+}
+
+
+template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void assign_inplace(mat_t<Rows,Cols,Type>& m, slice_t row_slice, slice_t col_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value)
+{
+    assert(row_slice.start >= 0 && row_slice.start <= (int)Rows);
+    assert(row_slice.stop >= -1 && row_slice.stop <= (int)Rows);
+    assert(row_slice.step != 0 && row_slice.step < 0 ? row_slice.start >= row_slice.stop : row_slice.start <= row_slice.stop);
+    assert(slice_get_length(row_slice) == RowSliceLength);
+
+    assert(col_slice.start >= 0 && col_slice.start <= (int)Cols);
+    assert(col_slice.stop >= -1 && col_slice.stop <= (int)Cols);
+    assert(col_slice.step != 0 && col_slice.step < 0 ? col_slice.start >= col_slice.stop : col_slice.start <= col_slice.stop);
+    assert(slice_get_length(col_slice) == ColSliceLength);
+
+    bool is_row_reversed = row_slice.step < 0;
+    bool is_col_reversed = col_slice.step < 0;
+
+    int ii = 0;
+    for (
+        int i = row_slice.start;
+        is_row_reversed ? (i > row_slice.stop) : (i < row_slice.stop);
+        i += row_slice.step
+    )
+    {
+        int jj = 0;
+        for (
+            int j = col_slice.start;
+            is_col_reversed ? (j > col_slice.stop) : (j < col_slice.stop);
+            j += col_slice.step
+        )
+        {
+            m.data[i][j] = value.data[ii][jj];
+            ++jj;
+        }
+
+        assert(jj == ColSliceLength);
+        ++ii;
+    }
+
+    assert(ii == RowSliceLength);
+}
+
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_assign_inplace(mat_t<Rows,Cols,Type>& m, int row, int col, Type value,
+                                        mat_t<Rows,Cols,Type>& adj_m, int& adj_row, int& adj_col, Type& adj_value)
+{
+#ifndef NDEBUG
+    if (row < -(int)Rows || row >= (int)Rows)
+    {
+        printf("mat row index %d out of bounds at %s %d\n", row, __FILE__, __LINE__);
+        assert(0);
+    }
+    if (col < -(int)Cols || col >= (int)Cols)
+    {
+        printf("mat col index %d out of bounds at %s %d\n", col, __FILE__, __LINE__);
+        assert(0);
+    }
+#endif
+
+    if (row < 0)
+    {
+        row += Rows;
+    }
+    if (col < 0)
+    {
+        col += Cols;
+    }
+
+    adj_value += adj_m.data[row][col];
+}
+
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_assign_inplace(mat_t<Rows,Cols,Type>& m, int row, vec_t<Cols,Type>& value,
+                                        mat_t<Rows,Cols,Type>& adj_m, int& adj_row, vec_t<Cols,Type>& adj_value)
+{
+#ifndef NDEBUG
+    if (row < -(int)Rows || row >= (int)Rows)
+    {
+        printf("mat row index %d out of bounds at %s %d\n", row, __FILE__, __LINE__);
+        assert(0);
+    }
+#endif
+
+    if (row < 0)
+    {
+        row += Rows;
+    }
+
+    for(unsigned i=0; i < Cols; ++i)
+    {
+        adj_value[i] += adj_m.data[row][i];
+    }
+}
+
+
+template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_assign_inplace(
+    mat_t<Rows,Cols,Type>& m, slice_t row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& adj_value
+)
+{
+    static_assert(
+        RowSliceLength == 0 ? ColSliceLength == 0 : ColSliceLength == Cols,
+        "Expected RowSliceLength == 0 ? ColSliceLength == 0 : ColSliceLength == Cols"
+    );
+
+    assert(row_slice.start >= 0 && row_slice.start <= (int)Rows);
+    assert(row_slice.stop >= -1 && row_slice.stop <= (int)Rows);
+    assert(row_slice.step != 0 && row_slice.step < 0 ? row_slice.start >= row_slice.stop : row_slice.start <= row_slice.stop);
+    assert(slice_get_length(row_slice) == RowSliceLength);
+
+    bool is_row_reversed = row_slice.step < 0;
+
+    int ii = 0;
+    for (
+        int i = row_slice.start;
+        is_row_reversed ? (i > row_slice.stop) : (i < row_slice.stop);
+        i += row_slice.step
+    )
+    {
+        for (int j = 0; j < Cols; ++j)
+        {
+            adj_value.data[ii][j] += adj_m.data[i][j];
+        }
+
+        ++ii;
+    }
+
+    assert(ii == RowSliceLength);
+}
+
+
+template<unsigned RowSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_assign_inplace(
+    mat_t<Rows,Cols,Type>& m, slice_t row_slice, int col, vec_t<RowSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, int& adj_col, vec_t<RowSliceLength, Type>& adj_value
+)
+{
+#ifndef NDEBUG
+    if (col < -(int)Cols || col >= (int)Cols)
+    {
+        printf("mat col index %d out of bounds at %s %d\n", col, __FILE__, __LINE__);
+        assert(0);
+    }
+#endif
+
+    assert(row_slice.start >= 0 && row_slice.start <= (int)Rows);
+    assert(row_slice.stop >= -1 && row_slice.stop <= (int)Rows);
+    assert(row_slice.step != 0 && row_slice.step < 0 ? row_slice.start >= row_slice.stop : row_slice.start <= row_slice.stop);
+    assert(slice_get_length(row_slice) == RowSliceLength);
+
+    if (col < 0)
+    {
+        col += Cols;
+    }
+
+    bool is_row_reversed = row_slice.step < 0;
+
+    int ii = 0;
+    for (
+        int i = row_slice.start;
+        is_row_reversed ? (i > row_slice.stop) : (i < row_slice.stop);
+        i += row_slice.step
+    )
+    {
+        adj_value.c[ii] += adj_m.data[i][col];
+        ++ii;
+    }
+
+    assert(ii == RowSliceLength);
+}
+
+
+template<unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_assign_inplace(
+    mat_t<Rows,Cols,Type>& m, int row, slice_t col_slice, vec_t<ColSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, int& adj_row, slice_t& adj_col_slice, vec_t<ColSliceLength, Type>& adj_value
+)
+{
+#ifndef NDEBUG
+    if (row < -(int)Rows || row >= (int)Rows)
+    {
+        printf("mat row index %d out of bounds at %s %d\n", row, __FILE__, __LINE__);
+        assert(0);
+    }
+#endif
+
+    assert(col_slice.start >= 0 && col_slice.start <= (int)Cols);
+    assert(col_slice.stop >= -1 && col_slice.stop <= (int)Cols);
+    assert(col_slice.step != 0 && col_slice.step < 0 ? col_slice.start >= col_slice.stop : col_slice.start <= col_slice.stop);
+    assert(slice_get_length(col_slice) == ColSliceLength);
+
+    if (row < 0)
+    {
+        row += Rows;
+    }
+
+    bool is_col_reversed = col_slice.step < 0;
+
+    int ii = 0;
+    for (
+        int i = col_slice.start;
+        is_col_reversed ? (i > col_slice.stop) : (i < col_slice.stop);
+        i += col_slice.step
+    )
+    {
+        adj_value.c[ii] += adj_m.data[row][i];
+        ++ii;
+    }
+
+    assert(ii == ColSliceLength);
+}
+
+
+template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_assign_inplace(
+    mat_t<Rows,Cols,Type>& m, slice_t row_slice, slice_t col_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, slice_t& adj_col_slice, mat_t<RowSliceLength, ColSliceLength, Type>& adj_value
+)
+{
+    assert(row_slice.start >= 0 && row_slice.start <= (int)Rows);
+    assert(row_slice.stop >= -1 && row_slice.stop <= (int)Rows);
+    assert(row_slice.step != 0 && row_slice.step < 0 ? row_slice.start >= row_slice.stop : row_slice.start <= row_slice.stop);
+    assert(slice_get_length(row_slice) == RowSliceLength);
+
+    assert(col_slice.start >= 0 && col_slice.start <= (int)Cols);
+    assert(col_slice.stop >= -1 && col_slice.stop <= (int)Cols);
+    assert(col_slice.step != 0 && col_slice.step < 0 ? col_slice.start >= col_slice.stop : col_slice.start <= col_slice.stop);
+    assert(slice_get_length(col_slice) == ColSliceLength);
+
+    bool is_row_reversed = row_slice.step < 0;
+    bool is_col_reversed = col_slice.step < 0;
+
+    int ii = 0;
+    for (
+        int i = row_slice.start;
+        is_row_reversed ? (i > row_slice.stop) : (i < row_slice.stop);
+        i += row_slice.step
+    )
+    {
+        int jj = 0;
+        for (
+            int j = col_slice.start;
+            is_col_reversed ? (j > col_slice.stop) : (j < col_slice.stop);
+            j += col_slice.step
+        )
+        {
+            adj_value.data[ii][jj] += adj_m.data[i][j];
+            ++jj;
+        }
+
+        assert(jj == ColSliceLength);
+        ++ii;
+    }
+
+    assert(ii == RowSliceLength);
+}
+
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> assign_copy(mat_t<Rows,Cols,Type>& m, int row, int col, Type value)
+{
+#ifndef NDEBUG
+    if (row < -(int)Rows || row >= (int)Rows)
+    {
+        printf("mat row index %d out of bounds at %s %d\n", row, __FILE__, __LINE__);
+        assert(0);
+    }
+    if (col < -(int)Cols || col >= (int)Cols)
+    {
+        printf("mat col index %d out of bounds at %s %d\n", col, __FILE__, __LINE__);
+        assert(0);
+    }
+#endif
+
+    if (row < 0)
+    {
+        row += Rows;
+    }
+    if (col < 0)
+    {
+        col += Cols;
+    }
+
+    mat_t<Rows,Cols,Type> ret(m);
+    ret.data[row][col] = value;
+    return ret;
+}
+
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> assign_copy(mat_t<Rows,Cols,Type>& m, int row, vec_t<Cols,Type>& value)
+{
+#ifndef NDEBUG
+    if (row < -(int)Rows || row >= (int)Rows)
+    {
+        printf("mat row index %d out of bounds at %s %d\n", row, __FILE__, __LINE__);
+        assert(0);
+    }
+#endif
+
+    if (row < 0)
+    {
+        row += Rows;
+    }
+
+    mat_t<Rows,Cols,Type> ret(m);
+    for(unsigned i=0; i < Cols; ++i)
+    {
+        ret.data[row][i] = value[i];
+    }
+    return ret;
+}
+
+
+template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> assign_copy(mat_t<Rows,Cols,Type>& m, slice_t row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value)
+{
+    mat_t<Rows, Cols, Type> ret(m);
+    assign_inplace(ret, row_slice, value);
+    return ret;
+}
+
+
+template<unsigned RowSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> assign_copy(mat_t<Rows,Cols,Type>& m, slice_t row_slice, int col, vec_t<RowSliceLength, Type>& value)
+{
+    mat_t<Rows, Cols, Type> ret(m);
+    assign_inplace(ret, row_slice, col, value);
+    return ret;
+}
+
+
+template<unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> assign_copy(mat_t<Rows,Cols,Type>& m, int row, slice_t col_slice, vec_t<ColSliceLength, Type>& value)
+{
+    mat_t<Rows, Cols, Type> ret(m);
+    assign_inplace(ret, row, col_slice, value);
+    return ret;
+}
+
+
+template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> assign_copy(mat_t<Rows,Cols,Type>& m, slice_t row_slice, slice_t col_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value)
+{
+    mat_t<Rows, Cols, Type> ret(m);
+    assign_inplace(ret, row_slice, col_slice, value);
+    return ret;
+}
+
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_assign_copy(mat_t<Rows,Cols,Type>& m, int row, int col, Type value,
+                                        mat_t<Rows,Cols,Type>& adj_m, int& adj_row, int& adj_col, Type& adj_value, const mat_t<Rows,Cols,Type>& adj_ret)
+{
+#ifndef NDEBUG
+    if (row < -(int)Rows || row >= (int)Rows)
+    {
+        printf("mat row index %d out of bounds at %s %d\n", row, __FILE__, __LINE__);
+        assert(0);
+    }
+    if (col < -(int)Cols || col >= (int)Cols)
+    {
+        printf("mat col index %d out of bounds at %s %d\n", col, __FILE__, __LINE__);
+        assert(0);
+    }
+#endif
+
+    if (row < 0)
+    {
+        row += Rows;
+    }
+    if (col < 0)
+    {
+        col += Cols;
+    }
+
+    adj_value += adj_ret.data[row][col];
+    for(unsigned i=0; i < Rows; ++i)
+    {
+        for(unsigned j=0; j < Cols; ++j)
+        {
+            if(i != row || j != col)
+                adj_m.data[i][j] += adj_ret.data[i][j];
+        }
+    }
+}
+
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_assign_copy(mat_t<Rows,Cols,Type>& m, int row, vec_t<Cols,Type>& value,
+                                        mat_t<Rows,Cols,Type>& adj_m, int& adj_row, vec_t<Cols,Type>& adj_value, const mat_t<Rows,Cols,Type>& adj_ret)
+{
+#ifndef NDEBUG
+    if (row < -(int)Rows || row >= (int)Rows)
+    {
+        printf("mat row index %d out of bounds at %s %d\n", row, __FILE__, __LINE__);
+        assert(0);
+    }
+#endif
+
+    if (row < 0)
+    {
+        row += Rows;
+    }
+
+    for(unsigned i=0; i < Rows; ++i)
+    {
+        for(unsigned j=0; j < Cols; ++j)
+        {
+            if (i==row)
+                adj_value[j] += adj_ret.data[i][j];
+            else
+                adj_m.data[i][j] += adj_ret.data[i][j];
+        }
+    }
+}
+
+
+template<unsigned RowSliceLength, unsigned ColSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_assign_copy(
+    mat_t<Rows,Cols,Type>& m, slice_t row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, mat_t<RowSliceLength, ColSliceLength, Type>& adj_value,
+    mat_t<Rows,Cols,Type>& adj_ret
+)
+{
+    static_assert(
+        RowSliceLength == 0 ? ColSliceLength == 0 : ColSliceLength == Cols,
+        "Expected RowSliceLength == 0 ? ColSliceLength == 0 : ColSliceLength == Cols"
+    );
+
+    assert(row_slice.start >= 0 && row_slice.start <= (int)Rows);
+    assert(row_slice.stop >= -1 && row_slice.stop <= (int)Rows);
+    assert(row_slice.step != 0 && row_slice.step < 0 ? row_slice.start >= row_slice.stop : row_slice.start <= row_slice.stop);
+    assert(slice_get_length(row_slice) == RowSliceLength);
+
+    bool is_row_reversed = row_slice.step < 0;
+
+    int ii = 0;
+    for (int i = 0; i < Rows; ++i)
+    {
+        bool in_row_slice = is_row_reversed
+            ? (i <= row_slice.start && i > row_slice.stop && (row_slice.start - i) % (-row_slice.step) == 0)
+            : (i >= row_slice.start && i < row_slice.stop && (i - row_slice.start) % row_slice.step == 0);
+
+        if (!in_row_slice)
+        {
+            for (int j = 0; j < Cols; ++j)
+            {
+                adj_m.data[i][j] += adj_ret.data[i][j];
+            }
+        }
+        else
+        {
+            for (int j = 0; j < Cols; ++j)
+            {
+                adj_value.data[ii][j] += adj_ret.data[i][j];
+            }
+
+            ++ii;
+        }
+    }
+
+    assert(ii == RowSliceLength);
+}
+
+
+template<unsigned RowSliceLength, unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_assign_copy(
+    mat_t<Rows,Cols,Type>& m, slice_t row_slice, int col, vec_t<RowSliceLength, Type>& value,
+    mat_t<Rows,Cols,Type>& adj_m, slice_t& adj_row_slice, int& adj_col, vec_t<RowSliceLength, Type>& adj_value,
+    mat_t<Rows,Cols,Type>& adj_ret
+)
+{
+#ifndef NDEBUG
+    if (col < -(int)Cols || col >= (int)Cols)
+    {
+        printf("mat col index %d out of bounds at %s %d\n", col, __FILE__, __LINE__);
+        assert(0);
+    }
+#endif
+
+    assert(row_slice.start >= 0 && row_slice.start <= (int)Rows);
+    assert(row_slice.stop >= -1 && row_slice.stop <= (int)Rows);
+    assert(row_slice.step != 0 && row_slice.step < 0 ? row_slice.start >= row_slice.stop : row_slice.start <= row_slice.stop);
+    assert(slice_get_length(row_slice) == RowSliceLength);
+
+    if (col < 0)
+    {
+        col += Cols;
+    }
+
+    bool is_row_reversed = row_slice.step < 0;
+
+    int ii = 0;
+    for (int i = 0; i < Rows; ++i)
+    {
+        bool in_row_slice = is_row_reversed
+            ? (i <= row_slice.start && i > row_slice.stop && (row_slice.start - i) % (-row_slice.step) == 0)
+            : (i >= row_slice.start && i < row_slice.stop && (i - row_slice.start) % row_slice.step == 0);
+
+        if (!in_row_slice)
+        {
+            for (int j = 0; j < Cols; ++j)
+            {
+                adj_m.data[i][j] += adj_ret.data[i][j];
+            }
+        }
+        else
+        {
+            for (int j = 0; j < Cols; ++j)
             {
                 if (j != col)
                 {
@@ -2427,69 +3203,298 @@ inline CUDA_CALLABLE void adj_assign_copy(
                 }
             }
 
-            assert(jj == ColSliceLength);
-            ++ii;
+            assert(jj == ColSliceLength);
+            ++ii;
+        }
+    }
+
+    assert(ii == RowSliceLength);
+}
+
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline bool CUDA_CALLABLE isfinite(const mat_t<Rows,Cols,Type>& m)
+{
+    for (unsigned i=0; i < Rows; ++i)
+        for (unsigned j=0; j < Cols; ++j)
+            if (!isfinite(m.data[i][j]))
+                return false;
+    return true;
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline void CUDA_CALLABLE adj_isfinite(const mat_t<Rows,Cols,Type>& m, mat_t<Rows,Cols,Type>& adj_m, const bool &adj_ret)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline bool CUDA_CALLABLE isnan(const mat_t<Rows,Cols,Type>& m)
+{
+    for (unsigned i=0; i < Rows; ++i)
+        for (unsigned j=0; j < Cols; ++j)
+            if (isnan(m.data[i][j]))
+                return true;
+    return false;
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline void CUDA_CALLABLE adj_isnan(const mat_t<Rows,Cols,Type>& m, mat_t<Rows,Cols,Type>& adj_m, const bool &adj_ret)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline bool CUDA_CALLABLE isinf(const mat_t<Rows,Cols,Type>& m)
+{
+    for (unsigned i=0; i < Rows; ++i)
+        for (unsigned j=0; j < Cols; ++j)
+            if (isinf(m.data[i][j]))
+                return true;
+    return false;
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline void CUDA_CALLABLE adj_isinf(const mat_t<Rows,Cols,Type>& m, mat_t<Rows,Cols,Type>& adj_m, const bool &adj_ret)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> add(const mat_t<Rows,Cols,Type>& a, const mat_t<Rows,Cols,Type>& b)
+{
+    mat_t<Rows,Cols,Type> t;
+    for (unsigned i=0; i < Rows; ++i)
+    {
+        for (unsigned j=0; j < Cols; ++j)
+        {
+            t.data[i][j] = a.data[i][j] + b.data[i][j];
+        }
+    }
+
+    return t;
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> add(Type a, const mat_t<Rows,Cols,Type>& b)
+{
+    mat_t<Rows,Cols,Type> t;
+    for (unsigned i=0; i < Rows; ++i)
+    {
+        for (unsigned j=0; j < Cols; ++j)
+        {
+            t.data[i][j] = a + b.data[i][j];
+        }
+    }
+
+    return t;
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> sub(const mat_t<Rows,Cols,Type>& a, const mat_t<Rows,Cols,Type>& b)
+{
+    mat_t<Rows,Cols,Type> t;
+    for (unsigned i=0; i < Rows; ++i)
+    {
+        for (unsigned j=0; j < Cols; ++j)
+        {
+            t.data[i][j] = a.data[i][j] - b.data[i][j];
+        }
+    }
+
+    return t;
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> sub(Type a, const mat_t<Rows,Cols,Type>& b)
+{
+    mat_t<Rows,Cols,Type> t;
+    for (unsigned i=0; i < Rows; ++i)
+    {
+        for (unsigned j=0; j < Cols; ++j)
+        {
+            t.data[i][j] = a - b.data[i][j];
+        }
+    }
+
+    return t;
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> div(const mat_t<Rows,Cols,Type>& a, Type b)
+{
+    mat_t<Rows,Cols,Type> t;
+    for (unsigned i=0; i < Rows; ++i)
+    {
+        for (unsigned j=0; j < Cols; ++j)
+        {
+            t.data[i][j] = a.data[i][j]/b;
+        }
+    }
+
+    return t;
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> div(Type b, const mat_t<Rows,Cols,Type>& a)
+{
+    mat_t<Rows,Cols,Type> t;
+    for (unsigned i=0; i < Rows; ++i)
+    {
+        for (unsigned j=0; j < Cols; ++j)
+        {
+            t.data[i][j] = b / a.data[i][j];
+        }
+    }
+
+    return t;
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> mul(const mat_t<Rows,Cols,Type>& a, Type b)
+{
+    mat_t<Rows,Cols,Type> t;
+    for (unsigned i=0; i < Rows; ++i)
+    {
+        for (unsigned j=0; j < Cols; ++j)
+        {
+            t.data[i][j] = a.data[i][j]*b;
+        }
+    }
+
+    return t;
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> mul(Type b, const mat_t<Rows,Cols,Type>& a)
+{
+    return mul(a,b);
+}
+
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> operator*(Type b, const mat_t<Rows,Cols,Type>& a)
+{
+    return mul(a,b);
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> operator*( const mat_t<Rows,Cols,Type>& a, Type b)
+{
+    return mul(a,b);
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE vec_t<Rows,Type> mul(const mat_t<Rows,Cols,Type>& a, const vec_t<Cols,Type>& b)
+{
+    vec_t<Rows,Type> r = a.get_col(0)*b[0];
+    for( unsigned i=1; i < Cols; ++i )
+    {
+        r += a.get_col(i)*b[i];
+    }
+    return r;
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE vec_t<Cols,Type> mul(const vec_t<Rows,Type>& b, const mat_t<Rows,Cols,Type>& a)
+{
+    vec_t<Cols,Type> r = a.get_row(0)*b[0];
+    for( unsigned i=1; i < Rows; ++i )
+    {
+        r += a.get_row(i)*b[i];
+    }
+    return r;
+}
+
+template<typename T>
+inline CUDA_CALLABLE T muladd(T a, T b, T c) {
+    return c + a*b;
+}
+template<>
+inline CUDA_CALLABLE float muladd(float a, float b, float c) {
+    return fmaf(a, b, c);
+}
+template<>
+inline CUDA_CALLABLE double muladd(double a, double b, double c) {
+    return fma(a, b, c);
+}
+
+
+template<unsigned Rows, unsigned Cols, unsigned ColsOut, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,ColsOut,Type> mul(const mat_t<Rows,Cols,Type>& a, const mat_t<Cols,ColsOut,Type>& b)
+{
+    mat_t<Rows,ColsOut,Type> t(0);
+    for (unsigned i=0; i < Rows; ++i)
+    {        
+        for (unsigned j=0; j < ColsOut; ++j)
+        {
+            Type sum(0.0);
+
+            for (unsigned k=0; k < Cols; ++k)
+            {
+                sum = muladd<Type>(a.data[i][k], b.data[k][j], sum);
+            }
+
+            t.data[i][j] = sum;
         }
     }
-
-    assert(ii == RowSliceLength);
+    
+    return t;
 }
 
-
+// bitwise AND
 template<unsigned Rows, unsigned Cols, typename Type>
-inline bool CUDA_CALLABLE isfinite(const mat_t<Rows,Cols,Type>& m)
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> bit_and(const mat_t<Rows,Cols,Type>& a, const mat_t<Rows,Cols,Type>& b)
 {
+    mat_t<Rows,Cols,Type> t;
     for (unsigned i=0; i < Rows; ++i)
+    {
         for (unsigned j=0; j < Cols; ++j)
-            if (!isfinite(m.data[i][j]))
-                return false;
-    return true;
-}
+        {
+            t.data[i][j] = a.data[i][j] & b.data[i][j];
+        }
+    }
 
-template<unsigned Rows, unsigned Cols, typename Type>
-inline void CUDA_CALLABLE adj_isfinite(const mat_t<Rows,Cols,Type>& m, mat_t<Rows,Cols,Type>& adj_m, const bool &adj_ret)
-{
+    return t;
 }
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline bool CUDA_CALLABLE isnan(const mat_t<Rows,Cols,Type>& m)
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> bit_and(const mat_t<Rows,Cols,Type>& a, Type b)
 {
+    mat_t<Rows,Cols,Type> t;
     for (unsigned i=0; i < Rows; ++i)
+    {
         for (unsigned j=0; j < Cols; ++j)
-            if (isnan(m.data[i][j]))
-                return true;
-    return false;
-}
+        {
+            t.data[i][j] = a.data[i][j] & b;
+        }
+    }
 
-template<unsigned Rows, unsigned Cols, typename Type>
-inline void CUDA_CALLABLE adj_isnan(const mat_t<Rows,Cols,Type>& m, mat_t<Rows,Cols,Type>& adj_m, const bool &adj_ret)
-{
+    return t;
 }
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline bool CUDA_CALLABLE isinf(const mat_t<Rows,Cols,Type>& m)
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> bit_and(Type a, const mat_t<Rows,Cols,Type>& b)
 {
+    mat_t<Rows,Cols,Type> t;
     for (unsigned i=0; i < Rows; ++i)
+    {
         for (unsigned j=0; j < Cols; ++j)
-            if (isinf(m.data[i][j]))
-                return true;
-    return false;
-}
+        {
+            t.data[i][j] = a & b.data[i][j];
+        }
+    }
 
-template<unsigned Rows, unsigned Cols, typename Type>
-inline void CUDA_CALLABLE adj_isinf(const mat_t<Rows,Cols,Type>& m, mat_t<Rows,Cols,Type>& adj_m, const bool &adj_ret)
-{
+    return t;
 }
 
+// bitwise OR
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE mat_t<Rows,Cols,Type> add(const mat_t<Rows,Cols,Type>& a, const mat_t<Rows,Cols,Type>& b)
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> bit_or(const mat_t<Rows,Cols,Type>& a, const mat_t<Rows,Cols,Type>& b)
 {
     mat_t<Rows,Cols,Type> t;
     for (unsigned i=0; i < Rows; ++i)
     {
         for (unsigned j=0; j < Cols; ++j)
         {
-            t.data[i][j] = a.data[i][j] + b.data[i][j];
+            t.data[i][j] = a.data[i][j] | b.data[i][j];
         }
     }
 
@@ -2497,14 +3502,14 @@ inline CUDA_CALLABLE mat_t<Rows,Cols,Type> add(const mat_t<Rows,Cols,Type>& a, c
 }
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE mat_t<Rows,Cols,Type> add(Type a, const mat_t<Rows,Cols,Type>& b)
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> bit_or(const mat_t<Rows,Cols,Type>& a, Type b)
 {
     mat_t<Rows,Cols,Type> t;
     for (unsigned i=0; i < Rows; ++i)
     {
         for (unsigned j=0; j < Cols; ++j)
         {
-            t.data[i][j] = a + b.data[i][j];
+            t.data[i][j] = a.data[i][j] | b;
         }
     }
 
@@ -2512,29 +3517,30 @@ inline CUDA_CALLABLE mat_t<Rows,Cols,Type> add(Type a, const mat_t<Rows,Cols,Typ
 }
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE mat_t<Rows,Cols,Type> sub(const mat_t<Rows,Cols,Type>& a, const mat_t<Rows,Cols,Type>& b)
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> bit_or(Type a, const mat_t<Rows,Cols,Type>& b)
 {
     mat_t<Rows,Cols,Type> t;
     for (unsigned i=0; i < Rows; ++i)
     {
         for (unsigned j=0; j < Cols; ++j)
         {
-            t.data[i][j] = a.data[i][j] - b.data[i][j];
+            t.data[i][j] = a | b.data[i][j];
         }
     }
 
     return t;
 }
 
+// bitwise XOR
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE mat_t<Rows,Cols,Type> sub(Type a, const mat_t<Rows,Cols,Type>& b)
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> bit_xor(const mat_t<Rows,Cols,Type>& a, const mat_t<Rows,Cols,Type>& b)
 {
     mat_t<Rows,Cols,Type> t;
     for (unsigned i=0; i < Rows; ++i)
     {
         for (unsigned j=0; j < Cols; ++j)
         {
-            t.data[i][j] = a - b.data[i][j];
+            t.data[i][j] = a.data[i][j] ^ b.data[i][j];
         }
     }
 
@@ -2542,14 +3548,14 @@ inline CUDA_CALLABLE mat_t<Rows,Cols,Type> sub(Type a, const mat_t<Rows,Cols,Typ
 }
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE mat_t<Rows,Cols,Type> div(const mat_t<Rows,Cols,Type>& a, Type b)
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> bit_xor(const mat_t<Rows,Cols,Type>& a, Type b)
 {
     mat_t<Rows,Cols,Type> t;
     for (unsigned i=0; i < Rows; ++i)
     {
         for (unsigned j=0; j < Cols; ++j)
         {
-            t.data[i][j] = a.data[i][j]/b;
+            t.data[i][j] = a.data[i][j] ^ b;
         }
     }
 
@@ -2557,29 +3563,30 @@ inline CUDA_CALLABLE mat_t<Rows,Cols,Type> div(const mat_t<Rows,Cols,Type>& a, T
 }
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE mat_t<Rows,Cols,Type> div(Type b, const mat_t<Rows,Cols,Type>& a)
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> bit_xor(Type a, const mat_t<Rows,Cols,Type>& b)
 {
     mat_t<Rows,Cols,Type> t;
     for (unsigned i=0; i < Rows; ++i)
     {
         for (unsigned j=0; j < Cols; ++j)
         {
-            t.data[i][j] = b / a.data[i][j];
+            t.data[i][j] = a ^ b.data[i][j];
         }
     }
 
     return t;
 }
 
+// left shift
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE mat_t<Rows,Cols,Type> mul(const mat_t<Rows,Cols,Type>& a, Type b)
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> lshift(const mat_t<Rows,Cols,Type>& a, const mat_t<Rows,Cols,Type>& b)
 {
     mat_t<Rows,Cols,Type> t;
     for (unsigned i=0; i < Rows; ++i)
     {
         for (unsigned j=0; j < Cols; ++j)
         {
-            t.data[i][j] = a.data[i][j]*b;
+            t.data[i][j] = a.data[i][j] << b.data[i][j];
         }
     }
 
@@ -2587,79 +3594,94 @@ inline CUDA_CALLABLE mat_t<Rows,Cols,Type> mul(const mat_t<Rows,Cols,Type>& a, T
 }
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE mat_t<Rows,Cols,Type> mul(Type b, const mat_t<Rows,Cols,Type>& a)
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> lshift(const mat_t<Rows,Cols,Type>& a, Type b)
 {
-    return mul(a,b);
-}
+    mat_t<Rows,Cols,Type> t;
+    for (unsigned i=0; i < Rows; ++i)
+    {
+        for (unsigned j=0; j < Cols; ++j)
+        {
+            t.data[i][j] = a.data[i][j] << b;
+        }
+    }
 
+    return t;
+}
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE mat_t<Rows,Cols,Type> operator*(Type b, const mat_t<Rows,Cols,Type>& a)
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> lshift(Type a, const mat_t<Rows,Cols,Type>& b)
 {
-    return mul(a,b);
+    mat_t<Rows,Cols,Type> t;
+    for (unsigned i=0; i < Rows; ++i)
+    {
+        for (unsigned j=0; j < Cols; ++j)
+        {
+            t.data[i][j] = a << b.data[i][j];
+        }
+    }
+
+    return t;
 }
 
+// right shift
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE mat_t<Rows,Cols,Type> operator*( const mat_t<Rows,Cols,Type>& a, Type b)
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> rshift(const mat_t<Rows,Cols,Type>& a, const mat_t<Rows,Cols,Type>& b)
 {
-    return mul(a,b);
+    mat_t<Rows,Cols,Type> t;
+    for (unsigned i=0; i < Rows; ++i)
+    {
+        for (unsigned j=0; j < Cols; ++j)
+        {
+            t.data[i][j] = a.data[i][j] >> b.data[i][j];
+        }
+    }
+
+    return t;
 }
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE vec_t<Rows,Type> mul(const mat_t<Rows,Cols,Type>& a, const vec_t<Cols,Type>& b)
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> rshift(const mat_t<Rows,Cols,Type>& a, Type b)
 {
-    vec_t<Rows,Type> r = a.get_col(0)*b[0];
-    for( unsigned i=1; i < Cols; ++i )
+    mat_t<Rows,Cols,Type> t;
+    for (unsigned i=0; i < Rows; ++i)
     {
-        r += a.get_col(i)*b[i];
+        for (unsigned j=0; j < Cols; ++j)
+        {
+            t.data[i][j] = a.data[i][j] >> b;
+        }
     }
-    return r;
+
+    return t;
 }
 
 template<unsigned Rows, unsigned Cols, typename Type>
-inline CUDA_CALLABLE vec_t<Cols,Type> mul(const vec_t<Rows,Type>& b, const mat_t<Rows,Cols,Type>& a)
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> rshift(Type a, const mat_t<Rows,Cols,Type>& b)
 {
-    vec_t<Cols,Type> r = a.get_row(0)*b[0];
-    for( unsigned i=1; i < Rows; ++i )
+    mat_t<Rows,Cols,Type> t;
+    for (unsigned i=0; i < Rows; ++i)
     {
-        r += a.get_row(i)*b[i];
+        for (unsigned j=0; j < Cols; ++j)
+        {
+            t.data[i][j] = a >> b.data[i][j];
+        }
     }
-    return r;
-}
 
-template<typename T>
-inline CUDA_CALLABLE T muladd(T a, T b, T c) {
-    return c + a*b;
-}
-template<>
-inline CUDA_CALLABLE float muladd(float a, float b, float c) {
-    return fmaf(a, b, c);
-}
-template<>
-inline CUDA_CALLABLE double muladd(double a, double b, double c) {
-    return fma(a, b, c);
+    return t;
 }
 
-
-template<unsigned Rows, unsigned Cols, unsigned ColsOut, typename Type>
-inline CUDA_CALLABLE mat_t<Rows,ColsOut,Type> mul(const mat_t<Rows,Cols,Type>& a, const mat_t<Cols,ColsOut,Type>& b)
+// invert
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE mat_t<Rows,Cols,Type> invert(const mat_t<Rows,Cols,Type>& m)
 {
-    mat_t<Rows,ColsOut,Type> t(0);
+    mat_t<Rows,Cols,Type> t;
     for (unsigned i=0; i < Rows; ++i)
-    {        
-        for (unsigned j=0; j < ColsOut; ++j)
+    {
+        for (unsigned j=0; j < Cols; ++j)
         {
-            Type sum(0.0);
-
-            for (unsigned k=0; k < Cols; ++k)
-            {
-                sum = muladd<Type>(a.data[i][k], b.data[k][j], sum);
-            }
-
-            t.data[i][j] = sum;
+            t.data[i][j] = ~m.data[i][j];
         }
     }
-    
+
     return t;
 }
 
@@ -3310,6 +4332,126 @@ inline CUDA_CALLABLE void adj_sub(
     }
 }
 
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_and(const mat_t<Rows,Cols,Type>& a, const mat_t<Rows,Cols,Type>& b, mat_t<Rows,Cols,Type>& adj_a, mat_t<Rows,Cols,Type>& adj_b, const mat_t<Rows,Cols,Type>& adj_ret)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_and(
+    const mat_t<Rows,Cols,Type>& a, Type b,
+    mat_t<Rows,Cols,Type>& adj_a, Type& adj_b,
+    const mat_t<Rows,Cols,Type>& adj_ret
+)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_and(
+    Type a, const mat_t<Rows,Cols,Type>& b,
+    Type& adj_a, mat_t<Rows,Cols,Type>& adj_b,
+    const mat_t<Rows,Cols,Type>& adj_ret
+)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_or(const mat_t<Rows,Cols,Type>& a, const mat_t<Rows,Cols,Type>& b, mat_t<Rows,Cols,Type>& adj_a, mat_t<Rows,Cols,Type>& adj_b, const mat_t<Rows,Cols,Type>& adj_ret)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_or(
+    const mat_t<Rows,Cols,Type>& a, Type b,
+    mat_t<Rows,Cols,Type>& adj_a, Type& adj_b,
+    const mat_t<Rows,Cols,Type>& adj_ret
+)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_or(
+    Type a, const mat_t<Rows,Cols,Type>& b,
+    Type& adj_a, mat_t<Rows,Cols,Type>& adj_b,
+    const mat_t<Rows,Cols,Type>& adj_ret
+)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_xor(const mat_t<Rows,Cols,Type>& a, const mat_t<Rows,Cols,Type>& b, mat_t<Rows,Cols,Type>& adj_a, mat_t<Rows,Cols,Type>& adj_b, const mat_t<Rows,Cols,Type>& adj_ret)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_xor(
+    const mat_t<Rows,Cols,Type>& a, Type b,
+    mat_t<Rows,Cols,Type>& adj_a, Type& adj_b,
+    const mat_t<Rows,Cols,Type>& adj_ret
+)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_bit_xor(
+    Type a, const mat_t<Rows,Cols,Type>& b,
+    Type& adj_a, mat_t<Rows,Cols,Type>& adj_b,
+    const mat_t<Rows,Cols,Type>& adj_ret
+)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_lshift(const mat_t<Rows,Cols,Type>& a, const mat_t<Rows,Cols,Type>& b, mat_t<Rows,Cols,Type>& adj_a, mat_t<Rows,Cols,Type>& adj_b, const mat_t<Rows,Cols,Type>& adj_ret)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_lshift(
+    const mat_t<Rows,Cols,Type>& a, Type b,
+    mat_t<Rows,Cols,Type>& adj_a, Type& adj_b,
+    const mat_t<Rows,Cols,Type>& adj_ret
+)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_lshift(
+    Type a, const mat_t<Rows,Cols,Type>& b,
+    Type& adj_a, mat_t<Rows,Cols,Type>& adj_b,
+    const mat_t<Rows,Cols,Type>& adj_ret
+)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_rshift(const mat_t<Rows,Cols,Type>& a, const mat_t<Rows,Cols,Type>& b, mat_t<Rows,Cols,Type>& adj_a, mat_t<Rows,Cols,Type>& adj_b, const mat_t<Rows,Cols,Type>& adj_ret)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_rshift(
+    const mat_t<Rows,Cols,Type>& a, Type b,
+    mat_t<Rows,Cols,Type>& adj_a, Type& adj_b,
+    const mat_t<Rows,Cols,Type>& adj_ret
+)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_rshift(
+    Type a, const mat_t<Rows,Cols,Type>& b,
+    Type& adj_a, mat_t<Rows,Cols,Type>& adj_b,
+    const mat_t<Rows,Cols,Type>& adj_ret
+)
+{
+}
+
+template<unsigned Rows, unsigned Cols, typename Type>
+inline CUDA_CALLABLE void adj_invert(const mat_t<Rows,Cols,Type>& m, mat_t<Rows,Cols,Type>& adj_m, const mat_t<Rows,Cols,Type>& adj_ret)
+{
+}
+
 template<unsigned Rows, unsigned Cols, typename Type>
 inline CUDA_CALLABLE void adj_div(const mat_t<Rows,Cols,Type>& a, Type s, mat_t<Rows,Cols,Type>& adj_a, Type& adj_s, const mat_t<Rows,Cols,Type>& adj_ret)
 {
@@ -3864,6 +5006,34 @@ template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_add(
 template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_add(mat_t<Rows, Cols, int64>* buf, const mat_t<Rows, Cols, int64> &value) { }
 template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_add(mat_t<Rows, Cols, uint64>* buf, const mat_t<Rows, Cols, uint64> &value) { }
 
+// for bitwise operations we do not accumulate gradients
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_and(mat_t<Rows, Cols, int8>* buf, const mat_t<Rows, Cols, int8> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_and(mat_t<Rows, Cols, uint8>* buf, const mat_t<Rows, Cols, uint8> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_and(mat_t<Rows, Cols, int16>* buf, const mat_t<Rows, Cols, int16> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_and(mat_t<Rows, Cols, uint16>* buf, const mat_t<Rows, Cols, uint16> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_and(mat_t<Rows, Cols, int32>* buf, const mat_t<Rows, Cols, int32> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_and(mat_t<Rows, Cols, uint32>* buf, const mat_t<Rows, Cols, uint32> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_and(mat_t<Rows, Cols, int64>* buf, const mat_t<Rows, Cols, int64> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_and(mat_t<Rows, Cols, uint64>* buf, const mat_t<Rows, Cols, uint64> &value) { }
+
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_or(mat_t<Rows, Cols, int8>* buf, const mat_t<Rows, Cols, int8> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_or(mat_t<Rows, Cols, uint8>* buf, const mat_t<Rows, Cols, uint8> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_or(mat_t<Rows, Cols, int16>* buf, const mat_t<Rows, Cols, int16> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_or(mat_t<Rows, Cols, uint16>* buf, const mat_t<Rows, Cols, uint16> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_or(mat_t<Rows, Cols, int32>* buf, const mat_t<Rows, Cols, int32> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_or(mat_t<Rows, Cols, uint32>* buf, const mat_t<Rows, Cols, uint32> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_or(mat_t<Rows, Cols, int64>* buf, const mat_t<Rows, Cols, int64> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_or(mat_t<Rows, Cols, uint64>* buf, const mat_t<Rows, Cols, uint64> &value) { }
+
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_xor(mat_t<Rows, Cols, int8>* buf, const mat_t<Rows, Cols, int8> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_xor(mat_t<Rows, Cols, uint8>* buf, const mat_t<Rows, Cols, uint8> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_xor(mat_t<Rows, Cols, int16>* buf, const mat_t<Rows, Cols, int16> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_xor(mat_t<Rows, Cols, uint16>* buf, const mat_t<Rows, Cols, uint16> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_xor(mat_t<Rows, Cols, int32>* buf, const mat_t<Rows, Cols, int32> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_xor(mat_t<Rows, Cols, uint32>* buf, const mat_t<Rows, Cols, uint32> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_xor(mat_t<Rows, Cols, int64>* buf, const mat_t<Rows, Cols, int64> &value) { }
+template<unsigned Rows, unsigned Cols> CUDA_CALLABLE inline void adj_atomic_xor(mat_t<Rows, Cols, uint64>* buf, const mat_t<Rows, Cols, uint64> &value) { }
+
 using mat22h = mat_t<2,2,half>;
 using mat33h = mat_t<3,3,half>;
 using mat44h = mat_t<4,4,half>;
diff --git a/warp/native/mesh.cpp b/warp/native/mesh.cpp
index 40bbdcf5..78cf5443 100644
--- a/warp/native/mesh.cpp
+++ b/warp/native/mesh.cpp
@@ -126,7 +126,7 @@ void bvh_refit_with_solid_angle_recursive_host(BVH& bvh, int index, Mesh& mesh)
         
         // write new BVH nodes
         reinterpret_cast<vec3&>(lower) = new_lower;
-        reinterpret_cast<vec3&>(upper) = new_upper; 
+        reinterpret_cast<vec3&>(upper) = new_upper;        
     }
 }
 
diff --git a/warp/native/mesh.cu b/warp/native/mesh.cu
index 196f9846..44c00d0d 100644
--- a/warp/native/mesh.cu
+++ b/warp/native/mesh.cu
@@ -21,6 +21,8 @@
 #include "bvh.h"
 #include "scan.h"
 
+extern CUcontext get_current_context();
+
 namespace wp
 {
 
diff --git a/warp/native/mesh.h b/warp/native/mesh.h
index 152471a0..21cbb69c 100644
--- a/warp/native/mesh.h
+++ b/warp/native/mesh.h
@@ -1622,8 +1622,6 @@ CUDA_CALLABLE inline mesh_query_aabb_t mesh_query_aabb(
     query.count = 1;
     query.input_lower = lower;
     query.input_upper = upper;
-
-    wp::bounds3 input_bounds(query.input_lower, query.input_upper);
     
     // Navigate through the bvh, find the first overlapping leaf node.
     while (query.count)
@@ -1632,7 +1630,7 @@ CUDA_CALLABLE inline mesh_query_aabb_t mesh_query_aabb(
         BVHPackedNodeHalf node_lower = bvh_load_node(mesh.bvh.node_lowers, nodeIndex);
         BVHPackedNodeHalf node_upper = bvh_load_node(mesh.bvh.node_uppers, nodeIndex);
 
-        if (!input_bounds.overlaps(reinterpret_cast<vec3&>(node_lower), reinterpret_cast<vec3&>(node_upper)))
+        if (!intersect_aabb_aabb(query.input_lower, query.input_upper, reinterpret_cast<vec3&>(node_lower), reinterpret_cast<vec3&>(node_upper)))
         {
             // Skip this box, it doesn't overlap with our target box.
             continue;
@@ -1646,7 +1644,7 @@ CUDA_CALLABLE inline mesh_query_aabb_t mesh_query_aabb(
         {
             // Reached a leaf node, point to its first primitive
             // Back up one level and return 
-            query.primitive_counter = left_index;
+            query.primitive_counter = 0;
             query.stack[query.count++] = nodeIndex;
             return query;
         }
@@ -1671,45 +1669,6 @@ CUDA_CALLABLE inline bool mesh_query_aabb_next(mesh_query_aabb_t& query, int& in
 {
     Mesh mesh = query.mesh;
 
-    wp::bounds3 input_bounds(query.input_lower, query.input_upper);
-
-    if (query.primitive_counter != -1)
-        // currently in a leaf node which is the last node in the stack
-    {
-        const int node_index = query.stack[query.count - 1];
-        BVHPackedNodeHalf node_lower = bvh_load_node(mesh.bvh.node_lowers, node_index);
-        BVHPackedNodeHalf node_upper = bvh_load_node(mesh.bvh.node_uppers, node_index);
-
-        const int end = node_upper.i;
-        for (int primitive_counter = query.primitive_counter; primitive_counter < end; primitive_counter++)
-        {
-            int primitive_index = mesh.bvh.primitive_indices[primitive_counter];
-            if (input_bounds.overlaps(mesh.lowers[primitive_index], mesh.uppers[primitive_index]))
-            {
-                if (primitive_counter < end - 1)
-                    // still need to come back to this leaf node for the leftover primitives
-                {
-                    query.primitive_counter = primitive_counter + 1;
-                }
-                else
-                    // no need to come back to this leaf node
-                {
-                    query.count--;
-                    query.primitive_counter = -1;
-                }
-                index = primitive_index;
-                query.face = primitive_index;
-
-                return true;
-            }
-        }
-        // if we reach here it means we have finished the current leaf node without finding intersections
-        query.primitive_counter = -1;
-        // remove the leaf node from the back of the stack because it is finished
-        // and continue the bvh traversal
-        query.count--;
-    }
-    
     // Navigate through the bvh, find the first overlapping leaf node.
     while (query.count)
     {
@@ -1717,7 +1676,7 @@ CUDA_CALLABLE inline bool mesh_query_aabb_next(mesh_query_aabb_t& query, int& in
         BVHPackedNodeHalf node_lower = bvh_load_node(mesh.bvh.node_lowers, node_index);
         BVHPackedNodeHalf node_upper = bvh_load_node(mesh.bvh.node_uppers, node_index);
 
-        if (!input_bounds.overlaps(reinterpret_cast<vec3&>(node_lower), reinterpret_cast<vec3&>(node_upper)))
+        if (!intersect_aabb_aabb(query.input_lower, query.input_upper, reinterpret_cast<vec3&>(node_lower), reinterpret_cast<vec3&>(node_upper)))
         {
             // Skip this box, it doesn't overlap with our target box.
             continue;
@@ -1733,31 +1692,30 @@ CUDA_CALLABLE inline bool mesh_query_aabb_next(mesh_query_aabb_t& query, int& in
             const int start = left_index;
             const int end = right_index;
 
-            for (int primitive_counter = start; primitive_counter < end; primitive_counter++)
+            int primitive_index = mesh.bvh.primitive_indices[start + (query.primitive_counter++)];
+            // if already visited the last primitive in the leaf node
+            // move to the next node and reset the primitive counter to 0
+            if (start + query.primitive_counter == end)
             {
-                int primitive_index = mesh.bvh.primitive_indices[primitive_counter];
-                if (input_bounds.overlaps(mesh.lowers[primitive_index], mesh.uppers[primitive_index]))
-                {
-                    if (primitive_counter < end - 1)
-                        // still need to come back to this leaf node for the leftover primitives
-                    {
-                        query.primitive_counter = primitive_counter + 1;
-                        query.stack[query.count++] = node_index;
-                    }
-                    else
-                        // no need to come back to this leaf node
-                    {
-                        query.primitive_counter = -1;
-                    }
-                    index = primitive_index;
-                    query.face = primitive_index;
+                query.primitive_counter = 0;
+            }
+            // otherwise we need to keep this leaf node in stack for a future visit
+            else
+            {
+                query.count++;
+            }
+            
+            if (intersect_aabb_aabb(query.input_lower, query.input_upper, mesh.lowers[primitive_index], mesh.uppers[primitive_index]))
+            {
+                index = primitive_index;
+                query.face = primitive_index;
 
-                    return true;
-                }
+                return true;
             }
         }
         else
         {
+            query.primitive_counter = 0;
             query.stack[query.count++] = left_index;
             query.stack[query.count++] = right_index;
         }
diff --git a/warp/native/scan.cu b/warp/native/scan.cu
index 3ca14155..9d99a130 100644
--- a/warp/native/scan.cu
+++ b/warp/native/scan.cu
@@ -18,6 +18,8 @@
 #include "warp.h"
 #include "scan.h"
 
+#include "cuda_util.h"
+
 #define THRUST_IGNORE_CUB_VERSION_CHECK
 
 #include <cub/device/device_scan.cuh>
diff --git a/warp/native/sparse.cu b/warp/native/sparse.cu
index 16c69b56..ce64e7e0 100644
--- a/warp/native/sparse.cu
+++ b/warp/native/sparse.cu
@@ -16,8 +16,9 @@
  */
 
 #include "cuda_util.h"
+#include "temp_buffer.h"
 #include "warp.h"
-#include "stdint.h"
+
 #include <cstdint>
 
 #define THRUST_IGNORE_CUB_VERSION_CHECK
@@ -26,6 +27,8 @@
 #include <cub/device/device_run_length_encode.cuh>
 #include <cub/device/device_scan.cuh>
 
+extern CUcontext get_current_context();
+
 namespace
 {
 
@@ -361,7 +364,8 @@ WP_API void wp_bsr_matrix_from_triplets_device(
 
         if (bsr_nnz_event)
         {
-            wp_cuda_event_record(bsr_nnz_event, stream);
+            const bool external = true;
+            wp_cuda_event_record(bsr_nnz_event, stream, external);
         }
     }
 
@@ -416,7 +420,7 @@ WP_API void wp_bsr_transpose_device(int row_count, int col_count, int nnz,
         // Ensures the sorted keys are available in summed_block_indices if needed
         if(d_keys.Current() != src_block_indices)
         {
-            check_cuda(cudaMemcpy(src_block_indices, src_block_indices+nnz, size_t(nnz) * sizeof(int), cudaMemcpyDeviceToDevice));
+            check_cuda(cudaMemcpyAsync(src_block_indices, src_block_indices+nnz, size_t(nnz) * sizeof(int), cudaMemcpyDeviceToDevice, stream));
         }
     }
 
diff --git a/warp/native/tile.h b/warp/native/tile.h
index f340ab10..a95f5450 100644
--- a/warp/native/tile.h
+++ b/warp/native/tile.h
@@ -140,7 +140,6 @@
     [ ] LayerNorm  
     [ ] SoftMax
     [ ] GEMM
-    [ ] warp.sim (CRBA)
     [ ] Batched MLP
     [ ] Layer norm
     [ ] FNO + Burgers equation
@@ -149,7 +148,6 @@
     [ ] MeshCNN (Modulus, Oliver)
     [ ] BioNemo (Ali)
     [ ] Skinning (David/Or/Vismay)
-    [ ] warp.sim (VBD)
 [ ] Error checking
     [ ] Ensure functions passed to tile_map() are compatible with tile type
     [ ] Ensure that args passed to tile ops are compatible
@@ -1095,6 +1093,46 @@ struct tile_shared_t
         adj_x -= grad(c);
     }
 
+    // perform AND between a scalar value and a single tile element
+    inline CUDA_CALLABLE void bit_and_inplace(const typename Layout::Coord& c, const Type& x)
+    {
+        // since multiple threads may access the same element
+        // we need to access using atomic operations
+        wp::atomic_and(&data(c), x);
+
+        WP_TILE_SYNC();
+    }
+
+    // backward of inplace scalar AND
+    inline CUDA_CALLABLE void adj_bit_and_inplace(const typename Layout::Coord& c, Type& adj_x) {}
+
+
+    // perform OR between a scalar value and a single tile element
+    inline CUDA_CALLABLE void bit_or_inplace(const typename Layout::Coord& c, const Type& x)
+    {
+        // since multiple threads may access the same element
+        // we need to access using atomic operations
+        wp::atomic_or(&data(c), x);
+
+        WP_TILE_SYNC();
+    }
+
+    // backward of inplace scalar OR
+    inline CUDA_CALLABLE void adj_bit_or_inplace(const typename Layout::Coord& c, Type& adj_x) {}
+
+    // perform XOR between a scalar value and a single tile element
+    inline CUDA_CALLABLE void bit_xor_inplace(const typename Layout::Coord& c, const Type& x)
+    {
+        // since multiple threads may access the same element
+        // we need to access using atomic operations
+        wp::atomic_xor(&data(c), x);
+
+        WP_TILE_SYNC();
+    }
+
+    // backward of inplace scalar XOR
+    inline CUDA_CALLABLE void adj_bit_xor_inplace(const typename Layout::Coord& c, Type& adj_x) {}
+
     // copy register tile to shared
     template <typename Tile>
     inline CUDA_CALLABLE void assign(const Tile& tile)
@@ -2438,6 +2476,43 @@ inline CUDA_CALLABLE void adj_tile_mul(const typename Tile::Type& s, Tile& a,
 }
 
 
+// tile & tile
+template <typename TileA, typename TileB>
+inline CUDA_CALLABLE auto tile_bit_and(TileA& a, TileB& b)
+{
+    return tile_binary_map(bit_and, a, b, a);
+}
+
+template <typename TileA, typename TileB, typename AdjTileA, typename AdjTileB, typename AdjTile>
+inline CUDA_CALLABLE void adj_tile_bit_and(TileA& a, TileB& b, AdjTileA& adj_a, AdjTileB& adj_b, AdjTile& adj_c)
+{
+}
+
+// tile | tile
+template <typename TileA, typename TileB>
+inline CUDA_CALLABLE auto tile_bit_or(TileA& a, TileB& b)
+{
+    return tile_binary_map(bit_or, a, b, a);
+}
+
+template <typename TileA, typename TileB, typename AdjTileA, typename AdjTileB, typename AdjTile>
+inline CUDA_CALLABLE void adj_tile_bit_or(TileA& a, TileB& b, AdjTileA& adj_a, AdjTileB& adj_b, AdjTile& adj_c)
+{
+}
+
+// tile ^ tile
+template <typename TileA, typename TileB>
+inline CUDA_CALLABLE auto tile_bit_xor(TileA& a, TileB& b)
+{
+    return tile_binary_map(bit_xor, a, b, a);
+}
+
+template <typename TileA, typename TileB, typename AdjTileA, typename AdjTileB, typename AdjTile>
+inline CUDA_CALLABLE void adj_tile_bit_xor(TileA& a, TileB& b, AdjTileA& adj_a, AdjTileB& adj_b, AdjTile& adj_c)
+{
+}
+
+
 template <typename TileA, typename TileB>
 inline CUDA_CALLABLE void tile_add_inplace(TileA& a, TileB& b)
 {
@@ -2557,6 +2632,105 @@ inline CUDA_CALLABLE void adj_tile_sub_inplace(TileA& a, TileB& b, AdjTileA& adj
     adj_b.grad_add(adj_b_reg);
 }
 
+template <typename TileA, typename TileB>
+inline CUDA_CALLABLE void tile_bit_and_inplace(TileA& a, TileB& b)
+{
+    using ShapeA = typename TileA::Layout::Shape;
+    using ShapeB = typename TileB::Layout::Shape;
+
+    // verify shapes and sizes are compatible
+    static_assert(ShapeA::N == ShapeB::N, "Tile shapes must match for inplace bitwise AND");
+    static_assert(ShapeA::size() == ShapeB::size(), "Tile sizes must match for inplace bitwise AND");
+
+    // work with register tiles for inplace operations, regardless of the storage type of the input tiles
+    auto a_reg = a.copy_to_register();
+    auto b_reg = b.copy_to_register();
+
+    using Layout = typename decltype(a_reg)::Layout;
+
+    WP_PRAGMA_UNROLL
+    for (int i=0; i < Layout::NumRegs; ++i)
+    {
+        const int linear = Layout::linear_from_register(i);
+
+        if(!Layout::valid(linear))
+            break;
+
+        a_reg.data[i] &= b_reg.data[i];
+    }
+
+    a.assign(a_reg);
+}
+
+template <typename TileA, typename TileB, typename AdjTileA, typename AdjTileB>
+inline CUDA_CALLABLE void adj_tile_bit_and_inplace(TileA& a, TileB& b, AdjTileA& adj_a, AdjTileB& adj_b) {}
+
+template <typename TileA, typename TileB>
+inline CUDA_CALLABLE void tile_bit_or_inplace(TileA& a, TileB& b)
+{
+    using ShapeA = typename TileA::Layout::Shape;
+    using ShapeB = typename TileB::Layout::Shape;
+
+    // verify shapes and sizes are compatible
+    static_assert(ShapeA::N == ShapeB::N, "Tile shapes must match for inplace bitwise OR");
+    static_assert(ShapeA::size() == ShapeB::size(), "Tile sizes must match for inplace bitwise OR");
+
+    // work with register tiles for inplace operations, regardless of the storage type of the input tiles
+    auto a_reg = a.copy_to_register();
+    auto b_reg = b.copy_to_register();
+
+    using Layout = typename decltype(a_reg)::Layout;
+
+    WP_PRAGMA_UNROLL
+    for (int i=0; i < Layout::NumRegs; ++i)
+    {
+        const int linear = Layout::linear_from_register(i);
+
+        if(!Layout::valid(linear))
+            break;
+
+        a_reg.data[i] |= b_reg.data[i];
+    }
+
+    a.assign(a_reg);
+}
+
+template <typename TileA, typename TileB, typename AdjTileA, typename AdjTileB>
+inline CUDA_CALLABLE void adj_tile_bit_or_inplace(TileA& a, TileB& b, AdjTileA& adj_a, AdjTileB& adj_b) {}
+
+template <typename TileA, typename TileB>
+inline CUDA_CALLABLE void tile_bit_xor_inplace(TileA& a, TileB& b)
+{
+    using ShapeA = typename TileA::Layout::Shape;
+    using ShapeB = typename TileB::Layout::Shape;
+
+    // verify shapes and sizes are compatible
+    static_assert(ShapeA::N == ShapeB::N, "Tile shapes must match for inplace bitwise XOR");
+    static_assert(ShapeA::size() == ShapeB::size(), "Tile sizes must match for inplace bitwise XOR");
+
+    // work with register tiles for inplace operations, regardless of the storage type of the input tiles
+    auto a_reg = a.copy_to_register();
+    auto b_reg = b.copy_to_register();
+
+    using Layout = typename decltype(a_reg)::Layout;
+
+    WP_PRAGMA_UNROLL
+    for (int i=0; i < Layout::NumRegs; ++i)
+    {
+        const int linear = Layout::linear_from_register(i);
+
+        if(!Layout::valid(linear))
+            break;
+
+        a_reg.data[i] ^= b_reg.data[i];
+    }
+
+    a.assign(a_reg);
+}
+
+template <typename TileA, typename TileB, typename AdjTileA, typename AdjTileB>
+inline CUDA_CALLABLE void adj_tile_bit_xor_inplace(TileA& a, TileB& b, AdjTileA& adj_a, AdjTileB& adj_b) {}
+
 
 template<typename Tile>
 typename Tile::Type tile_extract(Tile& t, int i) { return t.extract(tile_coord(i)); }
@@ -2595,6 +2769,33 @@ void tile_sub_inplace(Tile& t, int i, int j, int k, typename Tile::Type value) {
 template<typename Tile>
 void tile_sub_inplace(Tile& t, int i, int j, int k, int l, typename Tile::Type value) { t.sub_inplace(tile_coord(i,j,k,l), value); }
 
+template<typename Tile>
+void tile_bit_and_inplace(Tile& t, int i, typename Tile::Type value) { t.bit_and_inplace(tile_coord(i), value); }
+template<typename Tile>
+void tile_bit_and_inplace(Tile& t, int i, int j, typename Tile::Type value) { t.bit_and_inplace(tile_coord(i,j), value); }
+template<typename Tile>
+void tile_bit_and_inplace(Tile& t, int i, int j, int k, typename Tile::Type value) { t.bit_and_inplace(tile_coord(i,j,k), value); }
+template<typename Tile>
+void tile_bit_and_inplace(Tile& t, int i, int j, int k, int l, typename Tile::Type value) { t.bit_and_inplace(tile_coord(i,j,k,l), value); }
+
+template<typename Tile>
+void tile_bit_or_inplace(Tile& t, int i, typename Tile::Type value) { t.bit_or_inplace(tile_coord(i), value); }
+template<typename Tile>
+void tile_bit_or_inplace(Tile& t, int i, int j, typename Tile::Type value) { t.bit_or_inplace(tile_coord(i,j), value); }
+template<typename Tile>
+void tile_bit_or_inplace(Tile& t, int i, int j, int k, typename Tile::Type value) { t.bit_or_inplace(tile_coord(i,j,k), value); }
+template<typename Tile>
+void tile_bit_or_inplace(Tile& t, int i, int j, int k, int l, typename Tile::Type value) { t.bit_or_inplace(tile_coord(i,j,k,l), value); }
+
+template<typename Tile>
+void tile_bit_xor_inplace(Tile& t, int i, typename Tile::Type value) { t.bit_xor_inplace(tile_coord(i), value); }
+template<typename Tile>
+void tile_bit_xor_inplace(Tile& t, int i, int j, typename Tile::Type value) { t.bit_xor_inplace(tile_coord(i,j), value); }
+template<typename Tile>
+void tile_bit_xor_inplace(Tile& t, int i, int j, int k, typename Tile::Type value) { t.bit_xor_inplace(tile_coord(i,j,k), value); }
+template<typename Tile>
+void tile_bit_xor_inplace(Tile& t, int i, int j, int k, int l, typename Tile::Type value) { t.bit_xor_inplace(tile_coord(i,j,k,l), value); }
+
 template<typename Tile, typename AdjTile>
 void adj_tile_add_inplace(Tile& t, int i, typename Tile::Type value, AdjTile& adj_t, int adj_i, typename Tile::Type& adj_value) { adj_t.adj_add_inplace(tile_coord(i), adj_value); }
 template<typename Tile, typename AdjTile>
@@ -2613,6 +2814,33 @@ void adj_tile_sub_inplace(Tile& t, int i, int j, int k, typename Tile::Type valu
 template<typename Tile, typename AdjTile>
 void adj_tile_sub_inplace(Tile& t, int i, int j, int k, int l, typename Tile::Type value, AdjTile& adj_t, int adj_i, int adj_j, int adj_k, int adj_l, typename Tile::Type& adj_value) { adj_t.adj_sub_inplace(tile_coord(i, j, k, l), adj_value); }
 
+template<typename Tile, typename AdjTile>
+void adj_tile_bit_and_inplace(Tile& t, int i, typename Tile::Type value, AdjTile& adj_t, int adj_i, typename Tile::Type& adj_value) {}
+template<typename Tile, typename AdjTile>
+void adj_tile_bit_and_inplace(Tile& t, int i, int j, typename Tile::Type value, AdjTile& adj_t, int adj_i, int adj_j, typename Tile::Type& adj_value) {}
+template<typename Tile, typename AdjTile>
+void adj_tile_bit_and_inplace(Tile& t, int i, int j, int k, typename Tile::Type value, AdjTile& adj_t, int adj_i, int adj_j, int adj_k, typename Tile::Type& adj_value) {}
+template<typename Tile, typename AdjTile>
+void adj_tile_bit_and_inplace(Tile& t, int i, int j, int k, int l, typename Tile::Type value, AdjTile& adj_t, int adj_i, int adj_j, int adj_k, int adj_l, typename Tile::Type& adj_value) {}
+
+template<typename Tile, typename AdjTile>
+void adj_tile_bit_or_inplace(Tile& t, int i, typename Tile::Type value, AdjTile& adj_t, int adj_i, typename Tile::Type& adj_value) {}
+template<typename Tile, typename AdjTile>
+void adj_tile_bit_or_inplace(Tile& t, int i, int j, typename Tile::Type value, AdjTile& adj_t, int adj_i, int adj_j, typename Tile::Type& adj_value) {}
+template<typename Tile, typename AdjTile>
+void adj_tile_bit_or_inplace(Tile& t, int i, int j, int k, typename Tile::Type value, AdjTile& adj_t, int adj_i, int adj_j, int adj_k, typename Tile::Type& adj_value) {}
+template<typename Tile, typename AdjTile>
+void adj_tile_bit_or_inplace(Tile& t, int i, int j, int k, int l, typename Tile::Type value, AdjTile& adj_t, int adj_i, int adj_j, int adj_k, int adj_l, typename Tile::Type& adj_value) {}
+
+template<typename Tile, typename AdjTile>
+void adj_tile_bit_xor_inplace(Tile& t, int i, typename Tile::Type value, AdjTile& adj_t, int adj_i, typename Tile::Type& adj_value) {}
+template<typename Tile, typename AdjTile>
+void adj_tile_bit_xor_inplace(Tile& t, int i, int j, typename Tile::Type value, AdjTile& adj_t, int adj_i, int adj_j, typename Tile::Type& adj_value) {}
+template<typename Tile, typename AdjTile>
+void adj_tile_bit_xor_inplace(Tile& t, int i, int j, int k, typename Tile::Type value, AdjTile& adj_t, int adj_i, int adj_j, int adj_k, typename Tile::Type& adj_value) {}
+template<typename Tile, typename AdjTile>
+void adj_tile_bit_xor_inplace(Tile& t, int i, int j, int k, int l, typename Tile::Type value, AdjTile& adj_t, int adj_i, int adj_j, int adj_k, int adj_l, typename Tile::Type& adj_value) {}
+
 namespace partitioned_gemm
 {
 
diff --git a/warp/native/vec.h b/warp/native/vec.h
index fc77c2a4..bff25b4f 100644
--- a/warp/native/vec.h
+++ b/warp/native/vec.h
@@ -404,6 +404,139 @@ inline CUDA_CALLABLE vec_t<3, Type> mod(vec_t<3, Type> a, vec_t<3, Type> b)
     return vec_t<3, Type>(mod(a.c[0], b.c[0]), mod(a.c[1], b.c[1]), mod(a.c[2], b.c[2]));
 }
 
+// bitwise AND
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE vec_t<Length, Type> bit_and(vec_t<Length, Type> a, vec_t<Length, Type> b)
+{
+    vec_t<Length, Type> ret;
+    for( unsigned i=0; i < Length; ++i )
+    {
+        ret[i] = Type(a[i] & b[i]);
+    }
+    return ret;
+}
+
+template<typename Type>
+inline CUDA_CALLABLE vec_t<2, Type> bit_and(vec_t<2, Type> a, vec_t<2, Type> b)
+{
+    return vec_t<2, Type>( a.c[0] & b.c[0], a.c[1] & b.c[1]);
+}
+
+template<typename Type>
+inline CUDA_CALLABLE vec_t<3, Type> bit_and(vec_t<3, Type> a, vec_t<3, Type> b)
+{
+    return vec_t<3, Type>( a.c[0] & b.c[0], a.c[1] & b.c[1], a.c[2] & b.c[2]);
+}
+
+// bitwise OR
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE vec_t<Length, Type> bit_or(vec_t<Length, Type> a, vec_t<Length, Type> b)
+{
+    vec_t<Length, Type> ret;
+    for( unsigned i=0; i < Length; ++i )
+    {
+        ret[i] = Type(a[i] | b[i]);
+    }
+    return ret;
+}
+
+template<typename Type>
+inline CUDA_CALLABLE vec_t<2, Type> bit_or(vec_t<2, Type> a, vec_t<2, Type> b)
+{
+    return vec_t<2, Type>( a.c[0] | b.c[0], a.c[1] | b.c[1]);
+}
+
+template<typename Type>
+inline CUDA_CALLABLE vec_t<3, Type> bit_or(vec_t<3, Type> a, vec_t<3, Type> b)
+{
+    return vec_t<3, Type>( a.c[0] | b.c[0], a.c[1] | b.c[1], a.c[2] | b.c[2]);
+}
+
+// bitwise XOR
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE vec_t<Length, Type> bit_xor(vec_t<Length, Type> a, vec_t<Length, Type> b)
+{
+    vec_t<Length, Type> ret;
+    for( unsigned i=0; i < Length; ++i )
+    {
+        ret[i] = Type(a[i] ^ b[i]);
+    }
+    return ret;
+}
+
+template<typename Type>
+inline CUDA_CALLABLE vec_t<2, Type> bit_xor(vec_t<2, Type> a, vec_t<2, Type> b)
+{
+    return vec_t<2, Type>( a.c[0] ^ b.c[0], a.c[1] ^ b.c[1]);
+}
+
+template<typename Type>
+inline CUDA_CALLABLE vec_t<3, Type> bit_xor(vec_t<3, Type> a, vec_t<3, Type> b)
+{
+    return vec_t<3, Type>( a.c[0] ^ b.c[0], a.c[1] ^ b.c[1], a.c[2] ^ b.c[2]);
+}
+
+// left shift
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE vec_t<Length, Type> lshift(vec_t<Length, Type> a, vec_t<Length, Type> b)
+{
+    vec_t<Length, Type> ret;
+    for( unsigned i=0; i < Length; ++i )
+    {
+        ret[i] = Type(a[i] << b[i]);
+    }
+    return ret;
+}
+
+template<typename Type>
+inline CUDA_CALLABLE vec_t<2, Type> lshift(vec_t<2, Type> a, vec_t<2, Type> b)
+{
+    return vec_t<2, Type>( a.c[0] << b.c[0], a.c[1] << b.c[1]);
+}
+
+template<typename Type>
+inline CUDA_CALLABLE vec_t<3, Type> lshift(vec_t<3, Type> a, vec_t<3, Type> b)
+{
+    return vec_t<3, Type>( a.c[0] << b.c[0], a.c[1] << b.c[1], a.c[2] << b.c[2]);
+}
+
+// right shift
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE vec_t<Length, Type> rshift(vec_t<Length, Type> a, vec_t<Length, Type> b)
+{
+    vec_t<Length, Type> ret;
+    for( unsigned i=0; i < Length; ++i )
+    {
+        ret[i] = Type(a[i] >> b[i]);
+    }
+    return ret;
+}
+
+template<typename Type>
+inline CUDA_CALLABLE vec_t<2, Type> rshift(vec_t<2, Type> a, vec_t<2, Type> b)
+{
+    return vec_t<2, Type>( a.c[0] >> b.c[0], a.c[1] >> b.c[1]);
+}
+
+template<typename Type>
+inline CUDA_CALLABLE vec_t<3, Type> rshift(vec_t<3, Type> a, vec_t<3, Type> b)
+{
+    return vec_t<3, Type>( a.c[0] >> b.c[0], a.c[1] >> b.c[1], a.c[2] >> b.c[2]);
+}
+
+// invert
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE vec_t<Length,Type> invert(vec_t<Length,Type> v)
+{
+    vec_t<Length,Type> ret;
+    for (unsigned i=0; i < Length; ++i)
+    {
+        ret[i] = ~v[i];
+    }
+
+    return ret;
+}
+
 // dot product:
 template<unsigned Length, typename Type>
 inline CUDA_CALLABLE Type dot(vec_t<Length, Type> a, vec_t<Length, Type> b)
@@ -724,6 +857,183 @@ inline CUDA_CALLABLE void adj_sub_inplace(
 }
 
 
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE void bit_and_inplace(vec_t<Length, Type>& v, int idx, Type value)
+{
+#ifndef NDEBUG
+    if (idx < -(int)Length || idx >= (int)Length)
+    {
+        printf("vec index %d out of bounds at %s %d\n", idx, __FILE__, __LINE__);
+        assert(0);
+    }
+#endif
+
+    if (idx < 0)
+    {
+        idx += Length;
+    }
+
+    v[idx] &= value;
+}
+
+
+template<unsigned SliceLength, unsigned Length, typename Type>
+inline CUDA_CALLABLE void bit_and_inplace(vec_t<Length, Type>& v, slice_t slice, const vec_t<SliceLength, Type> &a)
+{
+    assert(slice.start >= 0 && slice.start <= (int)Length);
+    assert(slice.stop >= -1 && slice.stop <= (int)Length);
+    assert(slice.step != 0 && slice.step < 0 ? slice.start >= slice.stop : slice.start <= slice.stop);
+    assert(slice_get_length(slice) == SliceLength);
+
+    bool is_reversed = slice.step < 0;
+
+    int ii = 0;
+    for (
+        int i = slice.start;
+        is_reversed ? (i > slice.stop) : (i < slice.stop);
+        i += slice.step
+    )
+    {
+        v[i] &= a[ii];
+        ++ii;
+    }
+
+    assert(ii == SliceLength);
+}
+
+
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE void adj_bit_and_inplace(
+    vec_t<Length, Type>& v, int idx, Type value,
+    vec_t<Length, Type>& adj_v, int adj_idx, Type& adj_value
+) {}
+
+
+template<unsigned SliceLength, unsigned Length, typename Type>
+inline CUDA_CALLABLE void adj_bit_and_inplace(
+    const vec_t<Length, Type>& v, slice_t slice, const vec_t<SliceLength, Type> &a,
+    vec_t<Length, Type>& adj_v, slice_t& adj_slice, vec_t<SliceLength, Type>& adj_a
+) {}
+
+
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE void bit_or_inplace(vec_t<Length, Type>& v, int idx, Type value)
+{
+#ifndef NDEBUG
+    if (idx < -(int)Length || idx >= (int)Length)
+    {
+        printf("vec index %d out of bounds at %s %d\n", idx, __FILE__, __LINE__);
+        assert(0);
+    }
+#endif
+
+    if (idx < 0)
+    {
+        idx += Length;
+    }
+
+    v[idx] |= value;
+}
+
+
+template<unsigned SliceLength, unsigned Length, typename Type>
+inline CUDA_CALLABLE void bit_or_inplace(vec_t<Length, Type>& v, slice_t slice, const vec_t<SliceLength, Type> &a)
+{
+    assert(slice.start >= 0 && slice.start <= (int)Length);
+    assert(slice.stop >= -1 && slice.stop <= (int)Length);
+    assert(slice.step != 0 && slice.step < 0 ? slice.start >= slice.stop : slice.start <= slice.stop);
+    assert(slice_get_length(slice) == SliceLength);
+
+    bool is_reversed = slice.step < 0;
+
+    int ii = 0;
+    for (
+        int i = slice.start;
+        is_reversed ? (i > slice.stop) : (i < slice.stop);
+        i += slice.step
+    )
+    {
+        v[i] |= a[ii];
+        ++ii;
+    }
+
+    assert(ii == SliceLength);
+}
+
+
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE void adj_bit_or_inplace(
+    vec_t<Length, Type>& v, int idx, Type value,
+    vec_t<Length, Type>& adj_v, int adj_idx, Type& adj_value
+) {}
+
+
+template<unsigned SliceLength, unsigned Length, typename Type>
+inline CUDA_CALLABLE void adj_bit_or_inplace(
+    const vec_t<Length, Type>& v, slice_t slice, const vec_t<SliceLength, Type> &a,
+    vec_t<Length, Type>& adj_v, slice_t& adj_slice, vec_t<SliceLength, Type>& adj_a
+) {}
+
+
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE void bit_xor_inplace(vec_t<Length, Type>& v, int idx, Type value)
+{
+#ifndef NDEBUG
+    if (idx < -(int)Length || idx >= (int)Length)
+    {
+        printf("vec index %d out of bounds at %s %d\n", idx, __FILE__, __LINE__);
+        assert(0);
+    }
+#endif
+
+    if (idx < 0)
+    {
+        idx += Length;
+    }
+
+    v[idx] ^= value;
+}
+
+
+template<unsigned SliceLength, unsigned Length, typename Type>
+inline CUDA_CALLABLE void bit_xor_inplace(vec_t<Length, Type>& v, slice_t slice, const vec_t<SliceLength, Type> &a)
+{
+    assert(slice.start >= 0 && slice.start <= (int)Length);
+    assert(slice.stop >= -1 && slice.stop <= (int)Length);
+    assert(slice.step != 0 && slice.step < 0 ? slice.start >= slice.stop : slice.start <= slice.stop);
+    assert(slice_get_length(slice) == SliceLength);
+
+    bool is_reversed = slice.step < 0;
+
+    int ii = 0;
+    for (
+        int i = slice.start;
+        is_reversed ? (i > slice.stop) : (i < slice.stop);
+        i += slice.step
+    )
+    {
+        v[i] ^= a[ii];
+        ++ii;
+    }
+
+    assert(ii == SliceLength);
+}
+
+
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE void adj_bit_xor_inplace(
+    vec_t<Length, Type>& v, int idx, Type value,
+    vec_t<Length, Type>& adj_v, int adj_idx, Type& adj_value
+) {}
+
+
+template<unsigned SliceLength, unsigned Length, typename Type>
+inline CUDA_CALLABLE void adj_bit_xor_inplace(
+    const vec_t<Length, Type>& v, slice_t slice, const vec_t<SliceLength, Type> &a,
+    vec_t<Length, Type>& adj_v, slice_t& adj_slice, vec_t<SliceLength, Type>& adj_a
+) {}
+
+
 template<unsigned Length, typename Type>
 inline CUDA_CALLABLE void assign_inplace(vec_t<Length, Type>& v, int idx, Type value)
 {
@@ -1342,6 +1652,90 @@ inline CUDA_CALLABLE void adj_mod(vec_t<3, Type> a, vec_t<3, Type> b, vec_t<3, T
 {
 }
 
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE void adj_bit_and(vec_t<Length, Type> a, vec_t<Length, Type> b, vec_t<Length, Type>& adj_a, vec_t<Length, Type>& adj_b, const vec_t<Length, Type>& adj_ret)
+{
+}
+
+template<typename Type>
+inline CUDA_CALLABLE void adj_bit_and(vec_t<2, Type> a, vec_t<2, Type> b, vec_t<2, Type>& adj_a, vec_t<2, Type>& adj_b, const vec_t<2, Type>& adj_ret)
+{
+}
+
+template<typename Type>
+inline CUDA_CALLABLE void adj_bit_and(vec_t<3, Type> a, vec_t<3, Type> b, vec_t<3, Type>& adj_a, vec_t<3, Type>& adj_b, const vec_t<3, Type>& adj_ret)
+{
+}
+
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE void adj_bit_or(vec_t<Length, Type> a, vec_t<Length, Type> b, vec_t<Length, Type>& adj_a, vec_t<Length, Type>& adj_b, const vec_t<Length, Type>& adj_ret)
+{
+}
+
+template<typename Type>
+inline CUDA_CALLABLE void adj_bit_or(vec_t<2, Type> a, vec_t<2, Type> b, vec_t<2, Type>& adj_a, vec_t<2, Type>& adj_b, const vec_t<2, Type>& adj_ret)
+{
+}
+
+template<typename Type>
+inline CUDA_CALLABLE void adj_bit_or(vec_t<3, Type> a, vec_t<3, Type> b, vec_t<3, Type>& adj_a, vec_t<3, Type>& adj_b, const vec_t<3, Type>& adj_ret)
+{
+}
+
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE void adj_bit_xor(vec_t<Length, Type> a, vec_t<Length, Type> b, vec_t<Length, Type>& adj_a, vec_t<Length, Type>& adj_b, const vec_t<Length, Type>& adj_ret)
+{
+}
+
+template<typename Type>
+inline CUDA_CALLABLE void adj_bit_xor(vec_t<2, Type> a, vec_t<2, Type> b, vec_t<2, Type>& adj_a, vec_t<2, Type>& adj_b, const vec_t<2, Type>& adj_ret)
+{
+}
+
+template<typename Type>
+inline CUDA_CALLABLE void adj_bit_xor(vec_t<3, Type> a, vec_t<3, Type> b, vec_t<3, Type>& adj_a, vec_t<3, Type>& adj_b, const vec_t<3, Type>& adj_ret)
+{
+}
+
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE void adj_lshift(vec_t<Length, Type> a, vec_t<Length, Type> b, vec_t<Length, Type>& adj_a, vec_t<Length, Type>& adj_b, const vec_t<Length, Type>& adj_ret)
+{
+}
+
+template<typename Type>
+inline CUDA_CALLABLE void adj_lshift(vec_t<2, Type> a, vec_t<2, Type> b, vec_t<2, Type>& adj_a, vec_t<2, Type>& adj_b, const vec_t<2, Type>& adj_ret)
+{
+}
+
+template<typename Type>
+inline CUDA_CALLABLE void adj_lshift(vec_t<3, Type> a, vec_t<3, Type> b, vec_t<3, Type>& adj_a, vec_t<3, Type>& adj_b, const vec_t<3, Type>& adj_ret)
+{
+}
+
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE void adj_rshift(vec_t<Length, Type> a, vec_t<Length, Type> b, vec_t<Length, Type>& adj_a, vec_t<Length, Type>& adj_b, const vec_t<Length, Type>& adj_ret)
+{
+}
+
+template<typename Type>
+inline CUDA_CALLABLE void adj_rshift(vec_t<2, Type> a, vec_t<2, Type> b, vec_t<2, Type>& adj_a, vec_t<2, Type>& adj_b, const vec_t<2, Type>& adj_ret)
+{
+}
+
+template<typename Type>
+inline CUDA_CALLABLE void adj_rshift(vec_t<3, Type> a, vec_t<3, Type> b, vec_t<3, Type>& adj_a, vec_t<3, Type>& adj_b, const vec_t<3, Type>& adj_ret)
+{
+}
+
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE void adj_invert(
+    const vec_t<Length,Type>& v,
+    vec_t<Length,Type>& adj_v,
+    const vec_t<Length,Type>& adj_ret
+)
+{
+}
+
 template<unsigned Length, typename Type>
 inline CUDA_CALLABLE void adj_dot(vec_t<Length, Type> a, vec_t<Length, Type> b, vec_t<Length, Type>& adj_a, vec_t<Length, Type>& adj_b, const Type adj_ret)
 {
@@ -1626,6 +2020,42 @@ inline CUDA_CALLABLE vec_t<Length, Type> atomic_max(vec_t<Length, Type> * addr,
     return ret;
 }
 
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE vec_t<Length, Type> atomic_and(vec_t<Length, Type> * addr, vec_t<Length, Type> value)
+{
+    vec_t<Length, Type> ret;
+    for( unsigned i=0; i < Length; ++i )
+    {
+        ret[i] = atomic_and(&(addr -> c[i]), value[i]);
+    }
+
+    return ret;
+}
+
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE vec_t<Length, Type> atomic_or(vec_t<Length, Type> * addr, vec_t<Length, Type> value)
+{
+    vec_t<Length, Type> ret;
+    for( unsigned i=0; i < Length; ++i )
+    {
+        ret[i] = atomic_or(&(addr -> c[i]), value[i]);
+    }
+
+    return ret;
+}
+
+template<unsigned Length, typename Type>
+inline CUDA_CALLABLE vec_t<Length, Type> atomic_xor(vec_t<Length, Type> * addr, vec_t<Length, Type> value)
+{
+    vec_t<Length, Type> ret;
+    for( unsigned i=0; i < Length; ++i )
+    {
+        ret[i] = atomic_xor(&(addr -> c[i]), value[i]);
+    }
+
+    return ret;
+}
+
 template<unsigned Length, typename Type>
 inline CUDA_CALLABLE void adj_atomic_minmax(
     vec_t<Length,Type> *addr,
@@ -1683,6 +2113,34 @@ template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_add(vec_t<Length,
 template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_add(vec_t<Length, int64>* buf, const vec_t<Length, int64> &value) { }
 template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_add(vec_t<Length, uint64>* buf, const vec_t<Length, uint64> &value) { }
 
+// for bitwise operations we do not accumulate gradients
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_and(vec_t<Length, int8>* buf, const vec_t<Length, int8> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_and(vec_t<Length, uint8>* buf, const vec_t<Length, uint8> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_and(vec_t<Length, int16>* buf, const vec_t<Length, int16> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_and(vec_t<Length, uint16>* buf, const vec_t<Length, uint16> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_and(vec_t<Length, int32>* buf, const vec_t<Length, int32> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_and(vec_t<Length, uint32>* buf, const vec_t<Length, uint32> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_and(vec_t<Length, int64>* buf, const vec_t<Length, int64> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_and(vec_t<Length, uint64>* buf, const vec_t<Length, uint64> &value) { }
+
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_or(vec_t<Length, int8>* buf, const vec_t<Length, int8> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_or(vec_t<Length, uint8>* buf, const vec_t<Length, uint8> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_or(vec_t<Length, int16>* buf, const vec_t<Length, int16> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_or(vec_t<Length, uint16>* buf, const vec_t<Length, uint16> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_or(vec_t<Length, int32>* buf, const vec_t<Length, int32> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_or(vec_t<Length, uint32>* buf, const vec_t<Length, uint32> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_or(vec_t<Length, int64>* buf, const vec_t<Length, int64> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_or(vec_t<Length, uint64>* buf, const vec_t<Length, uint64> &value) { }
+
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_xor(vec_t<Length, int8>* buf, const vec_t<Length, int8> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_xor(vec_t<Length, uint8>* buf, const vec_t<Length, uint8> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_xor(vec_t<Length, int16>* buf, const vec_t<Length, int16> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_xor(vec_t<Length, uint16>* buf, const vec_t<Length, uint16> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_xor(vec_t<Length, int32>* buf, const vec_t<Length, int32> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_xor(vec_t<Length, uint32>* buf, const vec_t<Length, uint32> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_xor(vec_t<Length, int64>* buf, const vec_t<Length, int64> &value) { }
+template<unsigned Length> CUDA_CALLABLE inline void adj_atomic_xor(vec_t<Length, uint64>* buf, const vec_t<Length, uint64> &value) { }
+
 
 // adjoints for some of the constructors, used in intersect.h
 inline CUDA_CALLABLE void adj_vec2(float x, float y, float& adj_x, float& adj_y, const vec2& adj_ret)
diff --git a/warp/native/volume.cpp b/warp/native/volume.cpp
index 2e8d7d8b..10637d00 100644
--- a/warp/native/volume.cpp
+++ b/warp/native/volume.cpp
@@ -205,7 +205,7 @@ void wp_volume_get_buffer_info(uint64_t id, void** buf, uint64_t* size)
 
 void wp_volume_get_voxel_size(uint64_t id, float* dx, float* dy, float* dz)
 {
-    *dx = *dx = *dz = 0.0f;
+    *dx = *dy = *dz = 0.0f;
 
     const VolumeDesc* volume;
     if (volume_get_descriptor(id, volume))
diff --git a/warp/native/volume.cu b/warp/native/volume.cu
index 0e1f7723..ba5860e4 100644
--- a/warp/native/volume.cu
+++ b/warp/native/volume.cu
@@ -19,6 +19,7 @@
 #include "volume_impl.h"
 #include "warp.h"
 
+extern CUcontext get_current_context();
 
 __global__ void volume_get_leaf_coords(const uint32_t leaf_count, pnanovdb_coord_t *leaf_coords,
                                        const pnanovdb_buf_t buf)
diff --git a/warp/native/volume.h b/warp/native/volume.h
index 1683c72a..d5e03457 100644
--- a/warp/native/volume.h
+++ b/warp/native/volume.h
@@ -161,7 +161,7 @@ CUDA_CALLABLE inline void pnano_read(T &result, pnanovdb_buf_t buf, PNANOVDB_INO
     pnano_read<T>(result, buf, address);
 }
 
-/// regular grid accessor (values stored in leafs)
+/// regular grid accessor (values stored in leaves)
 
 struct value_accessor_base
 {
diff --git a/warp/native/volume_builder.cu b/warp/native/volume_builder.cu
index f65a06e7..8dafe5df 100644
--- a/warp/native/volume_builder.cu
+++ b/warp/native/volume_builder.cu
@@ -16,6 +16,8 @@
  */
 
 #include "volume_builder.h"
+#include "cuda_util.h"
+#include "warp.h"
 
 #include <nanovdb/tools/cuda/PointsToGrid.cuh>
 
diff --git a/warp/native/warp.cpp b/warp/native/warp.cpp
index cfd7bab9..1412edf0 100644
--- a/warp/native/warp.cpp
+++ b/warp/native/warp.cpp
@@ -260,14 +260,14 @@ void wp_array_scan_float_host(uint64_t in, uint64_t out, int len, bool inclusive
 static void array_copy_nd(void* dst, const void* src,
                       const int* dst_strides, const int* src_strides,
                       const int*const* dst_indices, const int*const* src_indices,
-                      const int* shape, int ndim, int elem_size)
+                      const int* shape, int ndim, size_t elem_size)
 {
     if (ndim == 1)
     {
         for (int i = 0; i < shape[0]; i++)
         {
-            int src_idx = src_indices[0] ? src_indices[0][i] : i;
-            int dst_idx = dst_indices[0] ? dst_indices[0][i] : i;
+            size_t src_idx = src_indices[0] ? src_indices[0][i] : i;
+            size_t dst_idx = dst_indices[0] ? dst_indices[0][i] : i;
             const char* p = (const char*)src + src_idx * src_strides[0];
             char* q = (char*)dst + dst_idx * dst_strides[0];
             // copy element
@@ -278,8 +278,8 @@ static void array_copy_nd(void* dst, const void* src,
     {
         for (int i = 0; i < shape[0]; i++)
         {
-            int src_idx = src_indices[0] ? src_indices[0][i] : i;
-            int dst_idx = dst_indices[0] ? dst_indices[0][i] : i;
+            size_t src_idx = src_indices[0] ? src_indices[0][i] : i;
+            size_t dst_idx = dst_indices[0] ? dst_indices[0][i] : i;
             const char* p = (const char*)src + src_idx * src_strides[0];
             char* q = (char*)dst + dst_idx * dst_strides[0];
             // recurse on next inner dimension
@@ -290,7 +290,7 @@ static void array_copy_nd(void* dst, const void* src,
 
 
 static void array_copy_to_fabric(wp::fabricarray_t<void>& dst, const void* src_data,
-                                 int src_stride, const int* src_indices, int elem_size)
+                                 size_t src_stride, const int* src_indices, size_t elem_size)
 {
     const int8_t* src_ptr = static_cast<const int8_t*>(src_data);
 
@@ -304,7 +304,7 @@ static void array_copy_to_fabric(wp::fabricarray_t<void>& dst, const void* src_d
             size_t bucket_size = bucket.index_end - bucket.index_start;
             for (size_t j = 0; j < bucket_size; j++)
             {
-                int idx = *src_indices;
+                size_t idx = *src_indices;
                 memcpy(dst_ptr, src_ptr + idx * elem_size, elem_size);
                 dst_ptr += elem_size;
                 ++src_indices;
@@ -344,7 +344,7 @@ static void array_copy_to_fabric(wp::fabricarray_t<void>& dst, const void* src_d
 }
 
 static void array_copy_from_fabric(const wp::fabricarray_t<void>& src, void* dst_data,
-                                   int dst_stride, const int* dst_indices, int elem_size)
+                                   size_t dst_stride, const int* dst_indices, size_t elem_size)
 {
     int8_t* dst_ptr = static_cast<int8_t*>(dst_data);
 
@@ -397,7 +397,7 @@ static void array_copy_from_fabric(const wp::fabricarray_t<void>& src, void* dst
     }
 }
 
-static void array_copy_fabric_to_fabric(wp::fabricarray_t<void>& dst, const wp::fabricarray_t<void>& src, int elem_size)
+static void array_copy_fabric_to_fabric(wp::fabricarray_t<void>& dst, const wp::fabricarray_t<void>& src, size_t elem_size)
 {
     wp::fabricbucket_t* dst_bucket = dst.buckets;
     const wp::fabricbucket_t* src_bucket = src.buckets;
@@ -450,7 +450,7 @@ static void array_copy_fabric_to_fabric(wp::fabricarray_t<void>& dst, const wp::
 
 
 static void array_copy_to_fabric_indexed(wp::indexedfabricarray_t<void>& dst, const void* src_data,
-                                         int src_stride, const int* src_indices, int elem_size)
+                                         size_t src_stride, const int* src_indices, size_t elem_size)
 {
     const int8_t* src_ptr = static_cast<const int8_t*>(src_data);
 
@@ -482,7 +482,7 @@ static void array_copy_to_fabric_indexed(wp::indexedfabricarray_t<void>& dst, co
 }
 
 
-static void array_copy_fabric_indexed_to_fabric(wp::fabricarray_t<void>& dst, const wp::indexedfabricarray_t<void>& src, int elem_size)
+static void array_copy_fabric_indexed_to_fabric(wp::fabricarray_t<void>& dst, const wp::indexedfabricarray_t<void>& src, size_t elem_size)
 {
     wp::fabricbucket_t* dst_bucket = dst.buckets;
     int8_t* dst_ptr = static_cast<int8_t*>(dst_bucket->ptr);
@@ -508,7 +508,7 @@ static void array_copy_fabric_indexed_to_fabric(wp::fabricarray_t<void>& dst, co
 }
 
 
-static void array_copy_fabric_indexed_to_fabric_indexed(wp::indexedfabricarray_t<void>& dst, const wp::indexedfabricarray_t<void>& src, int elem_size)
+static void array_copy_fabric_indexed_to_fabric_indexed(wp::indexedfabricarray_t<void>& dst, const wp::indexedfabricarray_t<void>& src, size_t elem_size)
 {
     for (size_t i = 0; i < src.size; i++)
     {
@@ -523,7 +523,7 @@ static void array_copy_fabric_indexed_to_fabric_indexed(wp::indexedfabricarray_t
 }
 
 
-static void array_copy_fabric_to_fabric_indexed(wp::indexedfabricarray_t<void>& dst, const wp::fabricarray_t<void>& src, int elem_size)
+static void array_copy_fabric_to_fabric_indexed(wp::indexedfabricarray_t<void>& dst, const wp::fabricarray_t<void>& src, size_t elem_size)
 {
     wp::fabricbucket_t* src_bucket = src.buckets;
     const int8_t* src_ptr = static_cast<const int8_t*>(src_bucket->ptr);
@@ -550,7 +550,7 @@ static void array_copy_fabric_to_fabric_indexed(wp::indexedfabricarray_t<void>&
 
 
 static void array_copy_from_fabric_indexed(const wp::indexedfabricarray_t<void>& src, void* dst_data,
-                                           int dst_stride, const int* dst_indices, int elem_size)
+                                           size_t dst_stride, const int* dst_indices, size_t elem_size)
 {
     int8_t* dst_ptr = static_cast<int8_t*>(dst_data);
 
@@ -563,7 +563,7 @@ static void array_copy_from_fabric_indexed(const wp::indexedfabricarray_t<void>&
             if (idx < src.fa.size)
             {
                 const void* src_ptr = fabricarray_element_ptr(src.fa, idx, elem_size);
-                int dst_idx = dst_indices[i];
+                size_t dst_idx = dst_indices[i];
                 memcpy(dst_ptr + dst_idx * elem_size, src_ptr, elem_size);
             }
             else
@@ -811,22 +811,23 @@ WP_API bool wp_array_copy_host(void* dst, void* src, int dst_type, int src_type,
 }
 
 
-static void array_fill_strided(void* data, const int* shape, const int* strides, int ndim, const void* value, int value_size)
+static void array_fill_strided(void* data, const int* shape, const int* strides, int ndim, const void* value, size_t value_size)
 {
+    size_t stride = strides[0];
     if (ndim == 1)
     {
         char* p = (char*)data;
         for (int i = 0; i < shape[0]; i++)
         {
             memcpy(p, value, value_size);
-            p += strides[0];
+            p += stride;
         }
     }
     else
     {
         for (int i = 0; i < shape[0]; i++)
         {
-            char* p = (char*)data + i * strides[0];
+            char* p = (char*)data + i * stride;
             // recurse on next inner dimension
             array_fill_strided(p, shape + 1, strides + 1, ndim - 1, value, value_size);
         }
@@ -834,14 +835,15 @@ static void array_fill_strided(void* data, const int* shape, const int* strides,
 }
 
 
-static void array_fill_indexed(void* data, const int* shape, const int* strides, const int*const* indices, int ndim, const void* value, int value_size)
+static void array_fill_indexed(void* data, const int* shape, const int* strides, const int*const* indices, int ndim, const void* value, size_t value_size)
 {
+    size_t stride = strides[0];
     if (ndim == 1)
     {
         for (int i = 0; i < shape[0]; i++)
         {
-            int idx = indices[0] ? indices[0][i] : i;
-            char* p = (char*)data + idx * strides[0];
+            size_t idx = indices[0] ? indices[0][i] : i;
+            char* p = (char*)data + idx * stride;
             memcpy(p, value, value_size);
         }
     }
@@ -849,8 +851,8 @@ static void array_fill_indexed(void* data, const int* shape, const int* strides,
     {
         for (int i = 0; i < shape[0]; i++)
         {
-            int idx = indices[0] ? indices[0][i] : i;
-            char* p = (char*)data + idx * strides[0];
+            size_t idx = indices[0] ? indices[0][i] : i;
+            char* p = (char*)data + idx * stride;
             // recurse on next inner dimension
             array_fill_indexed(p, shape + 1, strides + 1, indices + 1, ndim - 1, value, value_size);
         }
@@ -858,7 +860,7 @@ static void array_fill_indexed(void* data, const int* shape, const int* strides,
 }
 
 
-static void array_fill_fabric(wp::fabricarray_t<void>& fa, const void* value_ptr, int value_size)
+static void array_fill_fabric(wp::fabricarray_t<void>& fa, const void* value_ptr, size_t value_size)
 {
     for (size_t i = 0; i < fa.nbuckets; i++)
     {
@@ -869,7 +871,7 @@ static void array_fill_fabric(wp::fabricarray_t<void>& fa, const void* value_ptr
 }
 
 
-static void array_fill_fabric_indexed(wp::indexedfabricarray_t<void>& ifa, const void* value_ptr, int value_size)
+static void array_fill_fabric_indexed(wp::indexedfabricarray_t<void>& ifa, const void* value_ptr, size_t value_size)
 {
     for (size_t i = 0; i < ifa.size; i++)
     {
@@ -1057,8 +1059,8 @@ WP_API void wp_cuda_stream_register(void* context, void* stream) {}
 WP_API void wp_cuda_stream_unregister(void* context, void* stream) {}
 WP_API void* wp_cuda_stream_get_current() { return NULL; }
 WP_API void wp_cuda_stream_synchronize(void* stream) {}
-WP_API void wp_cuda_stream_wait_event(void* stream, void* event) {}
-WP_API void wp_cuda_stream_wait_stream(void* stream, void* other_stream, void* event) {}
+WP_API void wp_cuda_stream_wait_event(void* stream, void* event, bool external) {}
+WP_API void wp_cuda_stream_wait_stream(void* stream, void* other_stream, void* event, bool external) {}
 WP_API int wp_cuda_stream_is_capturing(void* stream) { return 0; }
 WP_API uint64_t wp_cuda_stream_get_capture_id(void* stream) { return 0; }
 WP_API int wp_cuda_stream_get_priority(void* stream) { return 0; }
@@ -1066,7 +1068,7 @@ WP_API int wp_cuda_stream_get_priority(void* stream) { return 0; }
 WP_API void* wp_cuda_event_create(void* context, unsigned flags) { return NULL; }
 WP_API void wp_cuda_event_destroy(void* event) {}
 WP_API int wp_cuda_event_query(void* event) { return 0; }
-WP_API void wp_cuda_event_record(void* event, void* stream, bool timing) {}
+WP_API void wp_cuda_event_record(void* event, void* stream, bool external) {}
 WP_API void wp_cuda_event_synchronize(void* event) {}
 WP_API float wp_cuda_event_elapsed_time(void* start_event, void* end_event) { return 0.0f; }
 
diff --git a/warp/native/warp.cu b/warp/native/warp.cu
index 89d5efe6..ee62c5f5 100644
--- a/warp/native/warp.cu
+++ b/warp/native/warp.cu
@@ -222,6 +222,14 @@ struct ModuleInfo
     void* module = NULL;
 };
 
+// Information used when deferring graph destruction.
+struct GraphDestroyInfo
+{
+    void* context = NULL;
+    void* graph = NULL;
+    void* graph_exec = NULL;
+};
+
 static std::unordered_map<CUfunction, std::string> g_kernel_names;
 
 // cached info for all devices, indexed by ordinal
@@ -253,6 +261,11 @@ static std::vector<FreeInfo> g_deferred_free_list;
 // Call unload_deferred_modules() to release.
 static std::vector<ModuleInfo> g_deferred_module_list;
 
+// Graphs that cannot be destroyed immediately get queued here.
+// Call destroy_deferred_graphs() to release.
+static std::vector<GraphDestroyInfo> g_deferred_graph_list;
+
+
 void wp_cuda_set_context_restore_policy(bool always_restore)
 {
     ContextGuard::always_restore = always_restore;
@@ -338,7 +351,7 @@ int cuda_init()
 }
 
 
-static inline CUcontext get_current_context()
+CUcontext get_current_context()
 {
     CUcontext ctx;
     if (check_cu(cuCtxGetCurrent_f(&ctx)))
@@ -495,6 +508,38 @@ static int unload_deferred_modules(void* context = NULL)
     return num_unloaded_modules;
 }
 
+static int destroy_deferred_graphs(void* context = NULL)
+{
+    if (g_deferred_graph_list.empty() || !g_captures.empty())
+        return 0;
+
+    int num_destroyed_graphs = 0;
+    for (auto it = g_deferred_graph_list.begin(); it != g_deferred_graph_list.end(); /*noop*/)
+    {
+        // destroy the graph if it matches the given context or if the context is unspecified
+        const GraphDestroyInfo& graph_info = *it;
+        if (graph_info.context == context || !context)
+        {
+            if (graph_info.graph)
+            {
+                check_cuda(cudaGraphDestroy((cudaGraph_t)graph_info.graph));
+            }
+            if (graph_info.graph_exec)
+            {
+                check_cuda(cudaGraphExecDestroy((cudaGraphExec_t)graph_info.graph_exec));
+            }
+            ++num_destroyed_graphs;
+            it = g_deferred_graph_list.erase(it);
+        }
+        else
+        {
+            ++it;
+        }
+    }
+
+    return num_destroyed_graphs;
+}
+
 static void CUDART_CB on_graph_destroy(void* user_data)
 {
     if (!user_data)
@@ -989,15 +1034,15 @@ void wp_memtile_device(void* context, void* dst, const void* src, size_t srcsize
 
 
 static __global__ void array_copy_1d_kernel(void* dst, const void* src,
-                                        int dst_stride, int src_stride,
+                                        size_t dst_stride, size_t src_stride,
                                         const int* dst_indices, const int* src_indices,
-                                        int n, int elem_size)
+                                        size_t n, size_t elem_size)
 {
-    int i = blockIdx.x * blockDim.x + threadIdx.x;
+    size_t i = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
     if (i < n)
     {
-        int src_idx = src_indices ? src_indices[i] : i;
-        int dst_idx = dst_indices ? dst_indices[i] : i;
+        size_t src_idx = src_indices ? src_indices[i] : i;
+        size_t dst_idx = dst_indices ? dst_indices[i] : i;
         const char* p = (const char*)src + src_idx * src_stride;
         char* q = (char*)dst + dst_idx * dst_stride;
         memcpy(q, p, elem_size);
@@ -1005,20 +1050,20 @@ static __global__ void array_copy_1d_kernel(void* dst, const void* src,
 }
 
 static __global__ void array_copy_2d_kernel(void* dst, const void* src,
-                                        wp::vec_t<2, int> dst_strides, wp::vec_t<2, int> src_strides,
+                                        wp::vec_t<2, size_t> dst_strides, wp::vec_t<2, size_t> src_strides,
                                         wp::vec_t<2, const int*> dst_indices, wp::vec_t<2, const int*> src_indices,
-                                        wp::vec_t<2, int> shape, int elem_size)
+                                        wp::vec_t<2, size_t> shape, size_t elem_size)
 {
-    int tid = blockIdx.x * blockDim.x + threadIdx.x;
-    int n = shape[1];
-    int i = tid / n;
-    int j = tid % n;
+    size_t tid = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
+    size_t n = shape[1];
+    size_t i = tid / n;
+    size_t j = tid % n;
     if (i < shape[0] /*&& j < shape[1]*/)
     {
-        int src_idx0 = src_indices[0] ? src_indices[0][i] : i;
-        int dst_idx0 = dst_indices[0] ? dst_indices[0][i] : i;
-        int src_idx1 = src_indices[1] ? src_indices[1][j] : j;
-        int dst_idx1 = dst_indices[1] ? dst_indices[1][j] : j;
+        size_t src_idx0 = src_indices[0] ? src_indices[0][i] : i;
+        size_t dst_idx0 = dst_indices[0] ? dst_indices[0][i] : i;
+        size_t src_idx1 = src_indices[1] ? src_indices[1][j] : j;
+        size_t dst_idx1 = dst_indices[1] ? dst_indices[1][j] : j;
         const char* p = (const char*)src + src_idx0 * src_strides[0] + src_idx1 * src_strides[1];
         char* q = (char*)dst + dst_idx0 * dst_strides[0] + dst_idx1 * dst_strides[1];
         memcpy(q, p, elem_size);
@@ -1026,24 +1071,24 @@ static __global__ void array_copy_2d_kernel(void* dst, const void* src,
 }
 
 static __global__ void array_copy_3d_kernel(void* dst, const void* src,
-                                        wp::vec_t<3, int> dst_strides, wp::vec_t<3, int> src_strides,
+                                        wp::vec_t<3, size_t> dst_strides, wp::vec_t<3, size_t> src_strides,
                                         wp::vec_t<3, const int*> dst_indices, wp::vec_t<3, const int*> src_indices,
-                                        wp::vec_t<3, int> shape, int elem_size)
-{
-    int tid = blockIdx.x * blockDim.x + threadIdx.x;
-    int n = shape[1];
-    int o = shape[2];
-    int i = tid / (n * o);
-    int j = tid % (n * o) / o;
-    int k = tid % o;
+                                        wp::vec_t<3, size_t> shape, size_t elem_size)
+{
+    size_t tid = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
+    size_t n = shape[1];
+    size_t o = shape[2];
+    size_t i = tid / (n * o);
+    size_t j = tid % (n * o) / o;
+    size_t k = tid % o;
     if (i < shape[0] && j < shape[1] /*&& k < shape[2]*/)
     {
-        int src_idx0 = src_indices[0] ? src_indices[0][i] : i;
-        int dst_idx0 = dst_indices[0] ? dst_indices[0][i] : i;
-        int src_idx1 = src_indices[1] ? src_indices[1][j] : j;
-        int dst_idx1 = dst_indices[1] ? dst_indices[1][j] : j;
-        int src_idx2 = src_indices[2] ? src_indices[2][k] : k;
-        int dst_idx2 = dst_indices[2] ? dst_indices[2][k] : k;
+        size_t src_idx0 = src_indices[0] ? src_indices[0][i] : i;
+        size_t dst_idx0 = dst_indices[0] ? dst_indices[0][i] : i;
+        size_t src_idx1 = src_indices[1] ? src_indices[1][j] : j;
+        size_t dst_idx1 = dst_indices[1] ? dst_indices[1][j] : j;
+        size_t src_idx2 = src_indices[2] ? src_indices[2][k] : k;
+        size_t dst_idx2 = dst_indices[2] ? dst_indices[2][k] : k;
         const char* p = (const char*)src + src_idx0 * src_strides[0]
                                          + src_idx1 * src_strides[1]
                                          + src_idx2 * src_strides[2];
@@ -1055,28 +1100,28 @@ static __global__ void array_copy_3d_kernel(void* dst, const void* src,
 }
 
 static __global__ void array_copy_4d_kernel(void* dst, const void* src,
-                                        wp::vec_t<4, int> dst_strides, wp::vec_t<4, int> src_strides,
+                                        wp::vec_t<4, size_t> dst_strides, wp::vec_t<4, size_t> src_strides,
                                         wp::vec_t<4, const int*> dst_indices, wp::vec_t<4, const int*> src_indices,
-                                        wp::vec_t<4, int> shape, int elem_size)
-{
-    int tid = blockIdx.x * blockDim.x + threadIdx.x;
-    int n = shape[1];
-    int o = shape[2];
-    int p = shape[3];
-    int i = tid / (n * o * p);
-    int j = tid % (n * o * p) / (o * p);
-    int k = tid % (o * p) / p;
-    int l = tid % p;
+                                        wp::vec_t<4, size_t> shape, size_t elem_size)
+{
+    size_t tid = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
+    size_t n = shape[1];
+    size_t o = shape[2];
+    size_t p = shape[3];
+    size_t i = tid / (n * o * p);
+    size_t j = tid % (n * o * p) / (o * p);
+    size_t k = tid % (o * p) / p;
+    size_t l = tid % p;
     if (i < shape[0] && j < shape[1] && k < shape[2] /*&& l < shape[3]*/)
     {
-        int src_idx0 = src_indices[0] ? src_indices[0][i] : i;
-        int dst_idx0 = dst_indices[0] ? dst_indices[0][i] : i;
-        int src_idx1 = src_indices[1] ? src_indices[1][j] : j;
-        int dst_idx1 = dst_indices[1] ? dst_indices[1][j] : j;
-        int src_idx2 = src_indices[2] ? src_indices[2][k] : k;
-        int dst_idx2 = dst_indices[2] ? dst_indices[2][k] : k;
-        int src_idx3 = src_indices[3] ? src_indices[3][l] : l;
-        int dst_idx3 = dst_indices[3] ? dst_indices[3][l] : l;
+        size_t src_idx0 = src_indices[0] ? src_indices[0][i] : i;
+        size_t dst_idx0 = dst_indices[0] ? dst_indices[0][i] : i;
+        size_t src_idx1 = src_indices[1] ? src_indices[1][j] : j;
+        size_t dst_idx1 = dst_indices[1] ? dst_indices[1][j] : j;
+        size_t src_idx2 = src_indices[2] ? src_indices[2][k] : k;
+        size_t dst_idx2 = dst_indices[2] ? dst_indices[2][k] : k;
+        size_t src_idx3 = src_indices[3] ? src_indices[3][l] : l;
+        size_t dst_idx3 = dst_indices[3] ? dst_indices[3][l] : l;
         const char* p = (const char*)src + src_idx0 * src_strides[0]
                                          + src_idx1 * src_strides[1]
                                          + src_idx2 * src_strides[2]
@@ -1091,14 +1136,14 @@ static __global__ void array_copy_4d_kernel(void* dst, const void* src,
 
 
 static __global__ void array_copy_from_fabric_kernel(wp::fabricarray_t<void> src,
-                                                     void* dst_data, int dst_stride, const int* dst_indices,
-                                                     int elem_size)
+                                                     void* dst_data, size_t dst_stride, const int* dst_indices,
+                                                     size_t elem_size)
 {
-    int tid = blockIdx.x * blockDim.x + threadIdx.x;
+    size_t tid = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
 
     if (tid < src.size)
     {
-        int dst_idx = dst_indices ? dst_indices[tid] : tid;
+        size_t dst_idx = dst_indices ? dst_indices[tid] : tid;
         void* dst_ptr = (char*)dst_data + dst_idx * dst_stride;
         const void* src_ptr = fabricarray_element_ptr(src, tid, elem_size);
         memcpy(dst_ptr, src_ptr, elem_size);
@@ -1106,15 +1151,15 @@ static __global__ void array_copy_from_fabric_kernel(wp::fabricarray_t<void> src
 }
 
 static __global__ void array_copy_from_fabric_indexed_kernel(wp::indexedfabricarray_t<void> src,
-                                                             void* dst_data, int dst_stride, const int* dst_indices,
-                                                             int elem_size)
+                                                             void* dst_data, size_t dst_stride, const int* dst_indices,
+                                                             size_t elem_size)
 {
-    int tid = blockIdx.x * blockDim.x + threadIdx.x;
+    size_t tid = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
 
     if (tid < src.size)
     {
-        int src_index = src.indices[tid];
-        int dst_idx = dst_indices ? dst_indices[tid] : tid;
+        size_t src_index = src.indices[tid];
+        size_t dst_idx = dst_indices ? dst_indices[tid] : tid;
         void* dst_ptr = (char*)dst_data + dst_idx * dst_stride;
         const void* src_ptr = fabricarray_element_ptr(src.fa, src_index, elem_size);
         memcpy(dst_ptr, src_ptr, elem_size);
@@ -1122,14 +1167,14 @@ static __global__ void array_copy_from_fabric_indexed_kernel(wp::indexedfabricar
 }
 
 static __global__ void array_copy_to_fabric_kernel(wp::fabricarray_t<void> dst,
-                                                   const void* src_data, int src_stride, const int* src_indices,
-                                                   int elem_size)
+                                                   const void* src_data, size_t src_stride, const int* src_indices,
+                                                   size_t elem_size)
 {
-    int tid = blockIdx.x * blockDim.x + threadIdx.x;
+    size_t tid = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
 
     if (tid < dst.size)
     {
-        int src_idx = src_indices ? src_indices[tid] : tid;
+        size_t src_idx = src_indices ? src_indices[tid] : tid;
         const void* src_ptr = (const char*)src_data + src_idx * src_stride;
         void* dst_ptr = fabricarray_element_ptr(dst, tid, elem_size);
         memcpy(dst_ptr, src_ptr, elem_size);
@@ -1137,25 +1182,25 @@ static __global__ void array_copy_to_fabric_kernel(wp::fabricarray_t<void> dst,
 }
 
 static __global__ void array_copy_to_fabric_indexed_kernel(wp::indexedfabricarray_t<void> dst,
-                                                           const void* src_data, int src_stride, const int* src_indices,
-                                                           int elem_size)
+                                                           const void* src_data, size_t src_stride, const int* src_indices,
+                                                           size_t elem_size)
 {
-    int tid = blockIdx.x * blockDim.x + threadIdx.x;
+    size_t tid = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
 
     if (tid < dst.size)
     {
-        int src_idx = src_indices ? src_indices[tid] : tid;
+        size_t src_idx = src_indices ? src_indices[tid] : tid;
         const void* src_ptr = (const char*)src_data + src_idx * src_stride;
-        int dst_idx = dst.indices[tid];
+        size_t dst_idx = dst.indices[tid];
         void* dst_ptr = fabricarray_element_ptr(dst.fa, dst_idx, elem_size);
         memcpy(dst_ptr, src_ptr, elem_size);
     }
 }
 
 
-static __global__ void array_copy_fabric_to_fabric_kernel(wp::fabricarray_t<void> dst, wp::fabricarray_t<void> src, int elem_size)
+static __global__ void array_copy_fabric_to_fabric_kernel(wp::fabricarray_t<void> dst, wp::fabricarray_t<void> src, size_t elem_size)
 {
-    int tid = blockIdx.x * blockDim.x + threadIdx.x;
+    size_t tid = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
 
     if (tid < dst.size)
     {
@@ -1166,27 +1211,27 @@ static __global__ void array_copy_fabric_to_fabric_kernel(wp::fabricarray_t<void
 }
 
 
-static __global__ void array_copy_fabric_to_fabric_indexed_kernel(wp::indexedfabricarray_t<void> dst, wp::fabricarray_t<void> src, int elem_size)
+static __global__ void array_copy_fabric_to_fabric_indexed_kernel(wp::indexedfabricarray_t<void> dst, wp::fabricarray_t<void> src, size_t elem_size)
 {
-    int tid = blockIdx.x * blockDim.x + threadIdx.x;
+    size_t tid = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
 
     if (tid < dst.size)
     {
         const void* src_ptr = fabricarray_element_ptr(src, tid, elem_size);
-        int dst_index = dst.indices[tid];
+        size_t dst_index = dst.indices[tid];
         void* dst_ptr = fabricarray_element_ptr(dst.fa, dst_index, elem_size);
         memcpy(dst_ptr, src_ptr, elem_size);
     }
 }
 
 
-static __global__ void array_copy_fabric_indexed_to_fabric_kernel(wp::fabricarray_t<void> dst, wp::indexedfabricarray_t<void> src, int elem_size)
+static __global__ void array_copy_fabric_indexed_to_fabric_kernel(wp::fabricarray_t<void> dst, wp::indexedfabricarray_t<void> src, size_t elem_size)
 {
-    int tid = blockIdx.x * blockDim.x + threadIdx.x;
+    size_t tid = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
 
     if (tid < dst.size)
     {
-        int src_index = src.indices[tid];
+        size_t src_index = src.indices[tid];
         const void* src_ptr = fabricarray_element_ptr(src.fa, src_index, elem_size);
         void* dst_ptr = fabricarray_element_ptr(dst, tid, elem_size);
         memcpy(dst_ptr, src_ptr, elem_size);
@@ -1194,14 +1239,14 @@ static __global__ void array_copy_fabric_indexed_to_fabric_kernel(wp::fabricarra
 }
 
 
-static __global__ void array_copy_fabric_indexed_to_fabric_indexed_kernel(wp::indexedfabricarray_t<void> dst, wp::indexedfabricarray_t<void> src, int elem_size)
+static __global__ void array_copy_fabric_indexed_to_fabric_indexed_kernel(wp::indexedfabricarray_t<void> dst, wp::indexedfabricarray_t<void> src, size_t elem_size)
 {
-    int tid = blockIdx.x * blockDim.x + threadIdx.x;
+    size_t tid = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
 
     if (tid < dst.size)
     {
-        int src_index = src.indices[tid];
-        int dst_index = dst.indices[tid];
+        size_t src_index = src.indices[tid];
+        size_t dst_index = dst.indices[tid];
         const void* src_ptr = fabricarray_element_ptr(src.fa, src_index, elem_size);
         void* dst_ptr = fabricarray_element_ptr(dst.fa, dst_index, elem_size);
         memcpy(dst_ptr, src_ptr, elem_size);
@@ -1440,9 +1485,9 @@ WP_API bool wp_array_copy_device(void* context, void* dst, void* src, int dst_ty
     }
     case 2:
     {
-        wp::vec_t<2, int> shape_v(src_shape[0], src_shape[1]);
-        wp::vec_t<2, int> src_strides_v(src_strides[0], src_strides[1]);
-        wp::vec_t<2, int> dst_strides_v(dst_strides[0], dst_strides[1]);
+        wp::vec_t<2, size_t> shape_v(src_shape[0], src_shape[1]);
+        wp::vec_t<2, size_t> src_strides_v(src_strides[0], src_strides[1]);
+        wp::vec_t<2, size_t> dst_strides_v(dst_strides[0], dst_strides[1]);
         wp::vec_t<2, const int*> src_indices_v(src_indices[0], src_indices[1]);
         wp::vec_t<2, const int*> dst_indices_v(dst_indices[0], dst_indices[1]);
 
@@ -1454,9 +1499,9 @@ WP_API bool wp_array_copy_device(void* context, void* dst, void* src, int dst_ty
     }
     case 3:
     {
-        wp::vec_t<3, int> shape_v(src_shape[0], src_shape[1], src_shape[2]);
-        wp::vec_t<3, int> src_strides_v(src_strides[0], src_strides[1], src_strides[2]);
-        wp::vec_t<3, int> dst_strides_v(dst_strides[0], dst_strides[1], dst_strides[2]);
+        wp::vec_t<3, size_t> shape_v(src_shape[0], src_shape[1], src_shape[2]);
+        wp::vec_t<3, size_t> src_strides_v(src_strides[0], src_strides[1], src_strides[2]);
+        wp::vec_t<3, size_t> dst_strides_v(dst_strides[0], dst_strides[1], dst_strides[2]);
         wp::vec_t<3, const int*> src_indices_v(src_indices[0], src_indices[1], src_indices[2]);
         wp::vec_t<3, const int*> dst_indices_v(dst_indices[0], dst_indices[1], dst_indices[2]);
 
@@ -1468,9 +1513,9 @@ WP_API bool wp_array_copy_device(void* context, void* dst, void* src, int dst_ty
     }
     case 4:
     {
-        wp::vec_t<4, int> shape_v(src_shape[0], src_shape[1], src_shape[2], src_shape[3]);
-        wp::vec_t<4, int> src_strides_v(src_strides[0], src_strides[1], src_strides[2], src_strides[3]);
-        wp::vec_t<4, int> dst_strides_v(dst_strides[0], dst_strides[1], dst_strides[2], dst_strides[3]);
+        wp::vec_t<4, size_t> shape_v(src_shape[0], src_shape[1], src_shape[2], src_shape[3]);
+        wp::vec_t<4, size_t> src_strides_v(src_strides[0], src_strides[1], src_strides[2], src_strides[3]);
+        wp::vec_t<4, size_t> dst_strides_v(dst_strides[0], dst_strides[1], dst_strides[2], dst_strides[3]);
         wp::vec_t<4, const int*> src_indices_v(src_indices[0], src_indices[1], src_indices[2], src_indices[3]);
         wp::vec_t<4, const int*> dst_indices_v(dst_indices[0], dst_indices[1], dst_indices[2], dst_indices[3]);
 
@@ -1490,94 +1535,94 @@ WP_API bool wp_array_copy_device(void* context, void* dst, void* src, int dst_ty
 
 
 static __global__ void array_fill_1d_kernel(void* data,
-                                            int n,
-                                            int stride,
+                                            size_t n,
+                                            size_t stride,
                                             const int* indices,
                                             const void* value,
-                                            int value_size)
+                                            size_t value_size)
 {
-    int i = blockIdx.x * blockDim.x + threadIdx.x;
+    size_t i = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
     if (i < n)
     {
-        int idx = indices ? indices[i] : i;
+        size_t idx = indices ? indices[i] : i;
         char* p = (char*)data + idx * stride;
         memcpy(p, value, value_size);
     }
 }
 
 static __global__ void array_fill_2d_kernel(void* data,
-                                            wp::vec_t<2, int> shape,
-                                            wp::vec_t<2, int> strides,
+                                            wp::vec_t<2, size_t> shape,
+                                            wp::vec_t<2, size_t> strides,
                                             wp::vec_t<2, const int*> indices,
                                             const void* value,
-                                            int value_size)
+                                            size_t value_size)
 {
-    int tid = blockIdx.x * blockDim.x + threadIdx.x;
-    int n = shape[1];
-    int i = tid / n;
-    int j = tid % n;
+    size_t tid = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
+    size_t n = shape[1];
+    size_t i = tid / n;
+    size_t j = tid % n;
     if (i < shape[0] /*&& j < shape[1]*/)
     {
-        int idx0 = indices[0] ? indices[0][i] : i;
-        int idx1 = indices[1] ? indices[1][j] : j;
+        size_t idx0 = indices[0] ? indices[0][i] : i;
+        size_t idx1 = indices[1] ? indices[1][j] : j;
         char* p = (char*)data + idx0 * strides[0] + idx1 * strides[1];
         memcpy(p, value, value_size);
     }
 }
 
 static __global__ void array_fill_3d_kernel(void* data,
-                                            wp::vec_t<3, int> shape,
-                                            wp::vec_t<3, int> strides,
+                                            wp::vec_t<3, size_t> shape,
+                                            wp::vec_t<3, size_t> strides,
                                             wp::vec_t<3, const int*> indices,
                                             const void* value,
-                                            int value_size)
-{
-    int tid = blockIdx.x * blockDim.x + threadIdx.x;
-    int n = shape[1];
-    int o = shape[2];
-    int i = tid / (n * o);
-    int j = tid % (n * o) / o;
-    int k = tid % o;
+                                            size_t value_size)
+{
+    size_t tid = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
+    size_t n = shape[1];
+    size_t o = shape[2];
+    size_t i = tid / (n * o);
+    size_t j = tid % (n * o) / o;
+    size_t k = tid % o;
     if (i < shape[0] && j < shape[1] /*&& k < shape[2]*/)
     {
-        int idx0 = indices[0] ? indices[0][i] : i;
-        int idx1 = indices[1] ? indices[1][j] : j;
-        int idx2 = indices[2] ? indices[2][k] : k;
+        size_t idx0 = indices[0] ? indices[0][i] : i;
+        size_t idx1 = indices[1] ? indices[1][j] : j;
+        size_t idx2 = indices[2] ? indices[2][k] : k;
         char* p = (char*)data + idx0 * strides[0] + idx1 * strides[1] + idx2 * strides[2];
         memcpy(p, value, value_size);
     }
 }
 
 static __global__ void array_fill_4d_kernel(void* data,
-                                            wp::vec_t<4, int> shape,
-                                            wp::vec_t<4, int> strides,
+                                            wp::vec_t<4, size_t> shape,
+                                            wp::vec_t<4, size_t> strides,
                                             wp::vec_t<4, const int*> indices,
                                             const void* value,
-                                            int value_size)
-{
-    int tid = blockIdx.x * blockDim.x + threadIdx.x;
-    int n = shape[1];
-    int o = shape[2];
-    int p = shape[3];
-    int i = tid / (n * o * p);
-    int j = tid % (n * o * p) / (o * p);
-    int k = tid % (o * p) / p;
-    int l = tid % p;
+                                            size_t value_size)
+{
+    size_t tid = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
+    size_t n = shape[1];
+    size_t o = shape[2];
+    size_t p = shape[3];
+    size_t i = tid / (n * o * p);
+    size_t j = tid % (n * o * p) / (o * p);
+    size_t k = tid % (o * p) / p;
+    size_t l = tid % p;
     if (i < shape[0] && j < shape[1] && k < shape[2] /*&& l < shape[3]*/)
     {
-        int idx0 = indices[0] ? indices[0][i] : i;
-        int idx1 = indices[1] ? indices[1][j] : j;
-        int idx2 = indices[2] ? indices[2][k] : k;
-        int idx3 = indices[3] ? indices[3][l] : l;
+        size_t idx0 = indices[0] ? indices[0][i] : i;
+        size_t idx1 = indices[1] ? indices[1][j] : j;
+        size_t idx2 = indices[2] ? indices[2][k] : k;
+        size_t idx3 = indices[3] ? indices[3][l] : l;
         char* p = (char*)data + idx0 * strides[0] + idx1 * strides[1] + idx2 * strides[2] + idx3 * strides[3];
         memcpy(p, value, value_size);
     }
 }
 
 
-static __global__ void array_fill_fabric_kernel(wp::fabricarray_t<void> fa, const void* value, int value_size)
+static __global__ void array_fill_fabric_kernel(wp::fabricarray_t<void> fa, const void* value, size_t value_size)
 {
-    int tid = blockIdx.x * blockDim.x + threadIdx.x;
+    size_t tid = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
     if (tid < fa.size)
     {
         void* dst_ptr = fabricarray_element_ptr(fa, tid, value_size);
@@ -1586,9 +1631,9 @@ static __global__ void array_fill_fabric_kernel(wp::fabricarray_t<void> fa, cons
 }
 
 
-static __global__ void array_fill_fabric_indexed_kernel(wp::indexedfabricarray_t<void> ifa, const void* value, int value_size)
+static __global__ void array_fill_fabric_indexed_kernel(wp::indexedfabricarray_t<void> ifa, const void* value, size_t value_size)
 {
-    int tid = blockIdx.x * blockDim.x + threadIdx.x;
+    size_t tid = size_t(blockIdx.x) * size_t(blockDim.x) + size_t(threadIdx.x);
     if (tid < ifa.size)
     {
         size_t idx = size_t(ifa.indices[tid]);
@@ -1685,8 +1730,8 @@ WP_API void wp_array_fill_device(void* context, void* arr_ptr, int arr_type, con
     }
     case 2:
     {
-        wp::vec_t<2, int> shape_v(shape[0], shape[1]);
-        wp::vec_t<2, int> strides_v(strides[0], strides[1]);
+        wp::vec_t<2, size_t> shape_v(shape[0], shape[1]);
+        wp::vec_t<2, size_t> strides_v(strides[0], strides[1]);
         wp::vec_t<2, const int*> indices_v(indices[0], indices[1]);
         wp_launch_device(WP_CURRENT_CONTEXT, array_fill_2d_kernel, n,
                          (data, shape_v, strides_v, indices_v, value_devptr, value_size));
@@ -1694,8 +1739,8 @@ WP_API void wp_array_fill_device(void* context, void* arr_ptr, int arr_type, con
     }
     case 3:
     {
-        wp::vec_t<3, int> shape_v(shape[0], shape[1], shape[2]);
-        wp::vec_t<3, int> strides_v(strides[0], strides[1], strides[2]);
+        wp::vec_t<3, size_t> shape_v(shape[0], shape[1], shape[2]);
+        wp::vec_t<3, size_t> strides_v(strides[0], strides[1], strides[2]);
         wp::vec_t<3, const int*> indices_v(indices[0], indices[1], indices[2]);
         wp_launch_device(WP_CURRENT_CONTEXT, array_fill_3d_kernel, n,
                          (data, shape_v, strides_v, indices_v, value_devptr, value_size));
@@ -1703,8 +1748,8 @@ WP_API void wp_array_fill_device(void* context, void* arr_ptr, int arr_type, con
     }
     case 4:
     {
-        wp::vec_t<4, int> shape_v(shape[0], shape[1], shape[2], shape[3]);
-        wp::vec_t<4, int> strides_v(strides[0], strides[1], strides[2], strides[3]);
+        wp::vec_t<4, size_t> shape_v(shape[0], shape[1], shape[2], shape[3]);
+        wp::vec_t<4, size_t> strides_v(strides[0], strides[1], strides[2], strides[3]);
         wp::vec_t<4, const int*> indices_v(indices[0], indices[1], indices[2], indices[3]);
         wp_launch_device(WP_CURRENT_CONTEXT, array_fill_4d_kernel, n,
                          (data, shape_v, strides_v, indices_v, value_devptr, value_size));
@@ -2072,13 +2117,17 @@ void wp_cuda_context_synchronize(void* context)
 
     check_cu(cuCtxSynchronize_f());
 
-    if (free_deferred_allocs(context ? context : get_current_context()) > 0)
+    if (!context)
+        context = get_current_context();
+
+    if (free_deferred_allocs(context) > 0)
     {
         // ensure deferred asynchronous deallocations complete
         check_cu(cuCtxSynchronize_f());
     }
 
     unload_deferred_modules(context);
+    destroy_deferred_graphs(context);
 
     // check_cuda(cudaDeviceGraphMemTrim(wp_cuda_context_get_device_ordinal(context)));
 }
@@ -2514,15 +2563,36 @@ void wp_cuda_stream_synchronize(void* stream)
     check_cu(cuStreamSynchronize_f(static_cast<CUstream>(stream)));
 }
 
-void wp_cuda_stream_wait_event(void* stream, void* event)
+void wp_cuda_stream_wait_event(void* stream, void* event, bool external)
 {
-    check_cu(cuStreamWaitEvent_f(static_cast<CUstream>(stream), static_cast<CUevent>(event), 0));
+    // the external flag can only be used during graph capture
+    if (external && !g_captures.empty() && wp_cuda_stream_is_capturing(stream))
+    {
+        // wait for an external event during graph capture
+        check_cu(cuStreamWaitEvent_f(static_cast<CUstream>(stream), static_cast<CUevent>(event), CU_EVENT_WAIT_EXTERNAL));
+    }
+    else
+    {
+        check_cu(cuStreamWaitEvent_f(static_cast<CUstream>(stream), static_cast<CUevent>(event), CU_EVENT_WAIT_DEFAULT));
+    }
 }
 
-void wp_cuda_stream_wait_stream(void* stream, void* other_stream, void* event)
+void wp_cuda_stream_wait_stream(void* stream, void* other_stream, void* event, bool external)
 {
-    check_cu(cuEventRecord_f(static_cast<CUevent>(event), static_cast<CUstream>(other_stream)));
-    check_cu(cuStreamWaitEvent_f(static_cast<CUstream>(stream), static_cast<CUevent>(event), 0));
+    unsigned record_flags = CU_EVENT_RECORD_DEFAULT;
+    unsigned wait_flags = CU_EVENT_WAIT_DEFAULT;
+
+    // the external flag can only be used during graph capture
+    if (external && !g_captures.empty())
+    {
+        if (wp_cuda_stream_is_capturing(other_stream))
+            record_flags = CU_EVENT_RECORD_EXTERNAL;
+        if (wp_cuda_stream_is_capturing(stream))
+            wait_flags = CU_EVENT_WAIT_EXTERNAL;
+    }
+
+    check_cu(cuEventRecordWithFlags_f(static_cast<CUevent>(event), static_cast<CUstream>(other_stream), record_flags));
+    check_cu(cuStreamWaitEvent_f(static_cast<CUstream>(stream), static_cast<CUevent>(event), wait_flags));
 }
 
 int wp_cuda_stream_is_capturing(void* stream)
@@ -2575,11 +2645,12 @@ int wp_cuda_event_query(void* event)
     return res;
 }
 
-void wp_cuda_event_record(void* event, void* stream, bool timing)
+void wp_cuda_event_record(void* event, void* stream, bool external)
 {
-    if (timing && !g_captures.empty() && wp_cuda_stream_is_capturing(stream))
+    // the external flag can only be used during graph capture
+    if (external && !g_captures.empty() && wp_cuda_stream_is_capturing(stream))
     {
-        // record timing event during graph capture
+        // record external event during graph capture (e.g., for timing or when explicitly specified by the user)
         check_cu(cuEventRecordWithFlags_f(static_cast<CUevent>(event), static_cast<CUstream>(stream), CU_EVENT_RECORD_EXTERNAL));
     }
     else
@@ -2629,7 +2700,7 @@ bool wp_cuda_graph_begin_capture(void* context, void* stream, int external)
     else
     {
         // start the capture
-        if (!check_cuda(cudaStreamBeginCapture(cuda_stream, cudaStreamCaptureModeGlobal)))
+        if (!check_cuda(cudaStreamBeginCapture(cuda_stream, cudaStreamCaptureModeThreadLocal)))
             return false;
     }
 
@@ -2776,6 +2847,7 @@ bool wp_cuda_graph_end_capture(void* context, void* stream, void** graph_ret)
     {
         free_deferred_allocs();
         unload_deferred_modules();
+        destroy_deferred_graphs();
     }
 
     if (graph_ret)
@@ -2996,7 +3068,7 @@ bool wp_cuda_graph_resume_capture(void* context, void* stream, void* graph)
                                   leaf_nodes.data(),
                                   nullptr,
                                   leaf_nodes.size(),
-                                  cudaStreamCaptureModeGlobal)))
+                                  cudaStreamCaptureModeThreadLocal)))
         return false;
 
     return true;
@@ -3455,16 +3527,38 @@ bool wp_cuda_graph_launch(void* graph_exec, void* stream)
 
 bool wp_cuda_graph_destroy(void* context, void* graph)
 {
-    ContextGuard guard(context);
-
-    return check_cuda(cudaGraphDestroy((cudaGraph_t)graph));
+    // ensure there are no graph captures in progress
+    if (g_captures.empty())
+    {
+        ContextGuard guard(context);
+        return check_cuda(cudaGraphDestroy((cudaGraph_t)graph));
+    }
+    else
+    {
+        GraphDestroyInfo info;
+        info.context = context ? context : get_current_context();
+        info.graph = graph;
+        g_deferred_graph_list.push_back(info);
+        return true;
+    }
 }
 
 bool wp_cuda_graph_exec_destroy(void* context, void* graph_exec)
 {
-    ContextGuard guard(context);
-
-    return check_cuda(cudaGraphExecDestroy((cudaGraphExec_t)graph_exec));
+    // ensure there are no graph captures in progress
+    if (g_captures.empty())
+    {
+        ContextGuard guard(context);
+        return check_cuda(cudaGraphExecDestroy((cudaGraphExec_t)graph_exec));
+    }
+    else
+    {
+        GraphDestroyInfo info;
+        info.context = context ? context : get_current_context();
+        info.graph_exec = graph_exec;
+        g_deferred_graph_list.push_back(info);
+        return true;
+    }
 }
 
 bool write_file(const char* data, size_t size, std::string filename, const char* mode)
@@ -4317,17 +4411,5 @@ void wp_cuda_timing_end(timing_result_t* results, int size)
     g_cuda_timing_state = parent_state;
 }
 
-// impl. files
-#include "bvh.cu"
-#include "mesh.cu"
-#include "sort.cu"
-#include "hashgrid.cu"
-#include "reduce.cu"
-#include "runlength_encode.cu"
-#include "scan.cu"
-#include "sparse.cu"
-#include "volume.cu"
-#include "volume_builder.cu"
-
 //#include "spline.inl"
 //#include "volume.inl"
diff --git a/warp/native/warp.h b/warp/native/warp.h
index f987adca..ae3e653b 100644
--- a/warp/native/warp.h
+++ b/warp/native/warp.h
@@ -78,10 +78,12 @@ extern "C"
 	WP_API uint64_t wp_bvh_create_host(wp::vec3* lowers, wp::vec3* uppers, int num_items, int constructor_type);
 	WP_API void wp_bvh_destroy_host(uint64_t id);
     WP_API void wp_bvh_refit_host(uint64_t id);
+    WP_API void wp_bvh_rebuild_host(uint64_t id, int constructor_type);
 
-	WP_API uint64_t wp_bvh_create_device(void* context, wp::vec3* lowers, wp::vec3* uppers, int num_items, int constructor_type);
+    WP_API uint64_t wp_bvh_create_device(void* context, wp::vec3* lowers, wp::vec3* uppers, int num_items, int constructor_type);
 	WP_API void wp_bvh_destroy_device(uint64_t id);
     WP_API void wp_bvh_refit_device(uint64_t id);
+    WP_API void wp_bvh_rebuild_device(uint64_t id);
 
     // create a user-accessible copy of the mesh, it is the 
     // users responsibility to keep-alive the points/tris data for the duration of the mesh lifetime
@@ -293,8 +295,8 @@ extern "C"
     WP_API void wp_cuda_stream_unregister(void* context, void* stream);
     WP_API void* wp_cuda_stream_get_current();
     WP_API void wp_cuda_stream_synchronize(void* stream);
-    WP_API void wp_cuda_stream_wait_event(void* stream, void* event);
-    WP_API void wp_cuda_stream_wait_stream(void* stream, void* other_stream, void* event);
+    WP_API void wp_cuda_stream_wait_event(void* stream, void* event, bool external=false);
+    WP_API void wp_cuda_stream_wait_stream(void* stream, void* other_stream, void* event, bool external=false);
     WP_API int wp_cuda_stream_is_capturing(void* stream);
     WP_API uint64_t wp_cuda_stream_get_capture_id(void* stream);
     WP_API int wp_cuda_stream_get_priority(void* stream);
@@ -302,7 +304,7 @@ extern "C"
     WP_API void* wp_cuda_event_create(void* context, unsigned flags);
     WP_API void wp_cuda_event_destroy(void* event);
     WP_API int wp_cuda_event_query(void* event);
-    WP_API void wp_cuda_event_record(void* event, void* stream, bool timing=false);
+    WP_API void wp_cuda_event_record(void* event, void* stream, bool external=false);
     WP_API void wp_cuda_event_synchronize(void* event);
     WP_API float wp_cuda_event_elapsed_time(void* start_event, void* end_event);
 
diff --git a/warp/sim/__init__.py b/warp/sim/__init__.py
deleted file mode 100644
index 32fed118..00000000
--- a/warp/sim/__init__.py
+++ /dev/null
@@ -1,74 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-from warp.utils import warn
-
-from .articulation import eval_fk, eval_ik
-from .collide import collide
-from .import_mjcf import parse_mjcf
-from .import_snu import parse_snu
-from .import_urdf import parse_urdf
-from .import_usd import parse_usd, resolve_usd_from_url
-from .inertia import transform_inertia
-from .integrator import Integrator, integrate_bodies, integrate_particles
-from .integrator_euler import SemiImplicitIntegrator
-from .integrator_featherstone import FeatherstoneIntegrator
-from .integrator_vbd import VBDIntegrator
-from .integrator_xpbd import XPBDIntegrator
-from .model import (
-    GEO_BOX,
-    GEO_CAPSULE,
-    GEO_CONE,
-    GEO_CYLINDER,
-    GEO_MESH,
-    GEO_NONE,
-    GEO_PLANE,
-    GEO_SDF,
-    GEO_SPHERE,
-    JOINT_BALL,
-    JOINT_COMPOUND,
-    JOINT_D6,
-    JOINT_DISTANCE,
-    JOINT_FIXED,
-    JOINT_FREE,
-    JOINT_MODE_FORCE,
-    JOINT_MODE_TARGET_POSITION,
-    JOINT_MODE_TARGET_VELOCITY,
-    JOINT_PRISMATIC,
-    JOINT_REVOLUTE,
-    JOINT_UNIVERSAL,
-    SDF,
-    Control,
-    JointAxis,
-    Mesh,
-    Model,
-    ModelBuilder,
-    ModelShapeGeometry,
-    ModelShapeMaterials,
-    State,
-)
-from .utils import (
-    load_mesh,
-    quat_from_euler,
-    quat_to_euler,
-    velocity_at_point,
-)
-
-warn(
-    "The `warp.sim` module is deprecated and will be removed in v1.10. "
-    "Please transition to using the forthcoming Newton library instead.",
-    DeprecationWarning,
-    stacklevel=2,
-)
diff --git a/warp/sim/articulation.py b/warp/sim/articulation.py
deleted file mode 100644
index 81d59962..00000000
--- a/warp/sim/articulation.py
+++ /dev/null
@@ -1,793 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-import warp as wp
-
-from .utils import quat_decompose, quat_twist
-
-
-@wp.func
-def compute_2d_rotational_dofs(
-    axis_0: wp.vec3,
-    axis_1: wp.vec3,
-    q0: float,
-    q1: float,
-    qd0: float,
-    qd1: float,
-):
-    """
-    Computes the rotation quaternion and 3D angular velocity given the joint axes, coordinates and velocities.
-    """
-    q_off = wp.quat_from_matrix(wp.matrix_from_cols(axis_0, axis_1, wp.cross(axis_0, axis_1)))
-
-    # body local axes
-    local_0 = wp.quat_rotate(q_off, wp.vec3(1.0, 0.0, 0.0))
-    local_1 = wp.quat_rotate(q_off, wp.vec3(0.0, 1.0, 0.0))
-
-    axis_0 = local_0
-    q_0 = wp.quat_from_axis_angle(axis_0, q0)
-
-    axis_1 = wp.quat_rotate(q_0, local_1)
-    q_1 = wp.quat_from_axis_angle(axis_1, q1)
-
-    rot = q_1 * q_0
-
-    vel = axis_0 * qd0 + axis_1 * qd1
-
-    return rot, vel
-
-
-@wp.func
-def invert_2d_rotational_dofs(
-    axis_0: wp.vec3,
-    axis_1: wp.vec3,
-    q_p: wp.quat,
-    q_c: wp.quat,
-    w_err: wp.vec3,
-):
-    """
-    Computes generalized joint position and velocity coordinates for a 2D rotational joint given the joint axes, relative orientations and angular velocity differences between the two bodies the joint connects.
-    """
-    q_off = wp.quat_from_matrix(wp.matrix_from_cols(axis_0, axis_1, wp.cross(axis_0, axis_1)))
-    q_pc = wp.quat_inverse(q_off) * wp.quat_inverse(q_p) * q_c * q_off
-
-    # decompose to a compound rotation each axis
-    angles = quat_decompose(q_pc)
-
-    # find rotation axes
-    local_0 = wp.quat_rotate(q_off, wp.vec3(1.0, 0.0, 0.0))
-    local_1 = wp.quat_rotate(q_off, wp.vec3(0.0, 1.0, 0.0))
-    local_2 = wp.quat_rotate(q_off, wp.vec3(0.0, 0.0, 1.0))
-
-    axis_0 = local_0
-    q_0 = wp.quat_from_axis_angle(axis_0, angles[0])
-
-    axis_1 = wp.quat_rotate(q_0, local_1)
-    q_1 = wp.quat_from_axis_angle(axis_1, angles[1])
-
-    axis_2 = wp.quat_rotate(q_1 * q_0, local_2)
-
-    # convert angular velocity to local space
-    w_err_p = wp.quat_rotate_inv(q_p, w_err)
-
-    # given joint axes and angular velocity error, solve for joint velocities
-    c12 = wp.cross(axis_1, axis_2)
-    c02 = wp.cross(axis_0, axis_2)
-
-    vel = wp.vec2(wp.dot(w_err_p, c12) / wp.dot(axis_0, c12), wp.dot(w_err_p, c02) / wp.dot(axis_1, c02))
-
-    return wp.vec2(angles[0], angles[1]), vel
-
-
-@wp.func
-def compute_3d_rotational_dofs(
-    axis_0: wp.vec3,
-    axis_1: wp.vec3,
-    axis_2: wp.vec3,
-    q0: float,
-    q1: float,
-    q2: float,
-    qd0: float,
-    qd1: float,
-    qd2: float,
-):
-    """
-    Computes the rotation quaternion and 3D angular velocity given the joint axes, coordinates and velocities.
-    """
-    q_off = wp.quat_from_matrix(wp.matrix_from_cols(axis_0, axis_1, axis_2))
-
-    # body local axes
-    local_0 = wp.quat_rotate(q_off, wp.vec3(1.0, 0.0, 0.0))
-    local_1 = wp.quat_rotate(q_off, wp.vec3(0.0, 1.0, 0.0))
-    local_2 = wp.quat_rotate(q_off, wp.vec3(0.0, 0.0, 1.0))
-
-    # reconstruct rotation axes
-    axis_0 = local_0
-    q_0 = wp.quat_from_axis_angle(axis_0, q0)
-
-    axis_1 = wp.quat_rotate(q_0, local_1)
-    q_1 = wp.quat_from_axis_angle(axis_1, q1)
-
-    axis_2 = wp.quat_rotate(q_1 * q_0, local_2)
-    q_2 = wp.quat_from_axis_angle(axis_2, q2)
-
-    rot = q_2 * q_1 * q_0
-    vel = axis_0 * qd0 + axis_1 * qd1 + axis_2 * qd2
-
-    return rot, vel
-
-
-@wp.func
-def invert_3d_rotational_dofs(
-    axis_0: wp.vec3, axis_1: wp.vec3, axis_2: wp.vec3, q_p: wp.quat, q_c: wp.quat, w_err: wp.vec3
-):
-    """
-    Computes generalized joint position and velocity coordinates for a 3D rotational joint given the joint axes, relative orientations and angular velocity differences between the two bodies the joint connects.
-    """
-    q_off = wp.quat_from_matrix(wp.matrix_from_cols(axis_0, axis_1, axis_2))
-    q_pc = wp.quat_inverse(q_off) * wp.quat_inverse(q_p) * q_c * q_off
-
-    # decompose to a compound rotation each axis
-    angles = quat_decompose(q_pc)
-
-    # find rotation axes
-    local_0 = wp.quat_rotate(q_off, wp.vec3(1.0, 0.0, 0.0))
-    local_1 = wp.quat_rotate(q_off, wp.vec3(0.0, 1.0, 0.0))
-    local_2 = wp.quat_rotate(q_off, wp.vec3(0.0, 0.0, 1.0))
-
-    axis_0 = local_0
-    q_0 = wp.quat_from_axis_angle(axis_0, angles[0])
-
-    axis_1 = wp.quat_rotate(q_0, local_1)
-    q_1 = wp.quat_from_axis_angle(axis_1, angles[1])
-
-    axis_2 = wp.quat_rotate(q_1 * q_0, local_2)
-
-    # convert angular velocity to local space
-    w_err_p = wp.quat_rotate_inv(q_p, w_err)
-
-    # given joint axes and angular velocity error, solve for joint velocities
-    c12 = wp.cross(axis_1, axis_2)
-    c02 = wp.cross(axis_0, axis_2)
-    c01 = wp.cross(axis_0, axis_1)
-
-    velocities = wp.vec3(
-        wp.dot(w_err_p, c12) / wp.dot(axis_0, c12),
-        wp.dot(w_err_p, c02) / wp.dot(axis_1, c02),
-        wp.dot(w_err_p, c01) / wp.dot(axis_2, c01),
-    )
-
-    return angles, velocities
-
-
-@wp.func
-def eval_single_articulation_fk(
-    joint_start: int,
-    joint_end: int,
-    joint_q: wp.array(dtype=float),
-    joint_qd: wp.array(dtype=float),
-    joint_q_start: wp.array(dtype=int),
-    joint_qd_start: wp.array(dtype=int),
-    joint_type: wp.array(dtype=int),
-    joint_parent: wp.array(dtype=int),
-    joint_child: wp.array(dtype=int),
-    joint_X_p: wp.array(dtype=wp.transform),
-    joint_X_c: wp.array(dtype=wp.transform),
-    joint_axis: wp.array(dtype=wp.vec3),
-    joint_axis_start: wp.array(dtype=int),
-    joint_axis_dim: wp.array(dtype=int, ndim=2),
-    body_com: wp.array(dtype=wp.vec3),
-    # outputs
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-):
-    for i in range(joint_start, joint_end):
-        parent = joint_parent[i]
-        child = joint_child[i]
-
-        # compute transform across the joint
-        type = joint_type[i]
-
-        X_pj = joint_X_p[i]
-        X_cj = joint_X_c[i]
-
-        # parent anchor frame in world space
-        X_wpj = X_pj
-        # velocity of parent anchor point in world space
-        v_wpj = wp.spatial_vector()
-        if parent >= 0:
-            X_wp = body_q[parent]
-            X_wpj = X_wp * X_wpj
-            r_p = wp.transform_get_translation(X_wpj) - wp.transform_point(X_wp, body_com[parent])
-
-            v_wp = body_qd[parent]
-            w_p = wp.spatial_top(v_wp)
-            v_p = wp.spatial_bottom(v_wp) + wp.cross(w_p, r_p)
-            v_wpj = wp.spatial_vector(w_p, v_p)
-
-        q_start = joint_q_start[i]
-        qd_start = joint_qd_start[i]
-        axis_start = joint_axis_start[i]
-        lin_axis_count = joint_axis_dim[i, 0]
-        ang_axis_count = joint_axis_dim[i, 1]
-
-        X_j = wp.transform_identity()
-        v_j = wp.spatial_vector(wp.vec3(), wp.vec3())
-
-        if type == wp.sim.JOINT_PRISMATIC:
-            axis = joint_axis[axis_start]
-
-            q = joint_q[q_start]
-            qd = joint_qd[qd_start]
-
-            X_j = wp.transform(axis * q, wp.quat_identity())
-            v_j = wp.spatial_vector(wp.vec3(), axis * qd)
-
-        if type == wp.sim.JOINT_REVOLUTE:
-            axis = joint_axis[axis_start]
-
-            q = joint_q[q_start]
-            qd = joint_qd[qd_start]
-
-            X_j = wp.transform(wp.vec3(), wp.quat_from_axis_angle(axis, q))
-            v_j = wp.spatial_vector(axis * qd, wp.vec3())
-
-        if type == wp.sim.JOINT_BALL:
-            r = wp.quat(joint_q[q_start + 0], joint_q[q_start + 1], joint_q[q_start + 2], joint_q[q_start + 3])
-
-            w = wp.vec3(joint_qd[qd_start + 0], joint_qd[qd_start + 1], joint_qd[qd_start + 2])
-
-            X_j = wp.transform(wp.vec3(), r)
-            v_j = wp.spatial_vector(w, wp.vec3())
-
-        if type == wp.sim.JOINT_FREE or type == wp.sim.JOINT_DISTANCE:
-            t = wp.transform(
-                wp.vec3(joint_q[q_start + 0], joint_q[q_start + 1], joint_q[q_start + 2]),
-                wp.quat(joint_q[q_start + 3], joint_q[q_start + 4], joint_q[q_start + 5], joint_q[q_start + 6]),
-            )
-
-            v = wp.spatial_vector(
-                wp.vec3(joint_qd[qd_start + 0], joint_qd[qd_start + 1], joint_qd[qd_start + 2]),
-                wp.vec3(joint_qd[qd_start + 3], joint_qd[qd_start + 4], joint_qd[qd_start + 5]),
-            )
-
-            X_j = t
-            v_j = v
-
-        if type == wp.sim.JOINT_COMPOUND:
-            rot, vel_w = compute_3d_rotational_dofs(
-                joint_axis[axis_start],
-                joint_axis[axis_start + 1],
-                joint_axis[axis_start + 2],
-                joint_q[q_start + 0],
-                joint_q[q_start + 1],
-                joint_q[q_start + 2],
-                joint_qd[qd_start + 0],
-                joint_qd[qd_start + 1],
-                joint_qd[qd_start + 2],
-            )
-
-            t = wp.transform(wp.vec3(0.0, 0.0, 0.0), rot)
-            v = wp.spatial_vector(vel_w, wp.vec3(0.0, 0.0, 0.0))
-
-            X_j = t
-            v_j = v
-
-        if type == wp.sim.JOINT_UNIVERSAL:
-            rot, vel_w = compute_2d_rotational_dofs(
-                joint_axis[axis_start],
-                joint_axis[axis_start + 1],
-                joint_q[q_start + 0],
-                joint_q[q_start + 1],
-                joint_qd[qd_start + 0],
-                joint_qd[qd_start + 1],
-            )
-
-            t = wp.transform(wp.vec3(0.0, 0.0, 0.0), rot)
-            v = wp.spatial_vector(vel_w, wp.vec3(0.0, 0.0, 0.0))
-
-            X_j = t
-            v_j = v
-
-        if type == wp.sim.JOINT_D6:
-            pos = wp.vec3(0.0)
-            rot = wp.quat_identity()
-            vel_v = wp.vec3(0.0)
-            vel_w = wp.vec3(0.0)
-
-            # unroll for loop to ensure joint actions remain differentiable
-            # (since differentiating through a for loop that updates a local variable is not supported)
-
-            if lin_axis_count > 0:
-                axis = joint_axis[axis_start + 0]
-                pos += axis * joint_q[q_start + 0]
-                vel_v += axis * joint_qd[qd_start + 0]
-            if lin_axis_count > 1:
-                axis = joint_axis[axis_start + 1]
-                pos += axis * joint_q[q_start + 1]
-                vel_v += axis * joint_qd[qd_start + 1]
-            if lin_axis_count > 2:
-                axis = joint_axis[axis_start + 2]
-                pos += axis * joint_q[q_start + 2]
-                vel_v += axis * joint_qd[qd_start + 2]
-
-            ia = axis_start + lin_axis_count
-            iq = q_start + lin_axis_count
-            iqd = qd_start + lin_axis_count
-            if ang_axis_count == 1:
-                axis = joint_axis[ia]
-                rot = wp.quat_from_axis_angle(axis, joint_q[iq])
-                vel_w = joint_qd[iqd] * axis
-            if ang_axis_count == 2:
-                rot, vel_w = compute_2d_rotational_dofs(
-                    joint_axis[ia + 0],
-                    joint_axis[ia + 1],
-                    joint_q[iq + 0],
-                    joint_q[iq + 1],
-                    joint_qd[iqd + 0],
-                    joint_qd[iqd + 1],
-                )
-            if ang_axis_count == 3:
-                rot, vel_w = compute_3d_rotational_dofs(
-                    joint_axis[ia + 0],
-                    joint_axis[ia + 1],
-                    joint_axis[ia + 2],
-                    joint_q[iq + 0],
-                    joint_q[iq + 1],
-                    joint_q[iq + 2],
-                    joint_qd[iqd + 0],
-                    joint_qd[iqd + 1],
-                    joint_qd[iqd + 2],
-                )
-
-            X_j = wp.transform(pos, rot)
-            v_j = wp.spatial_vector(vel_w, vel_v)
-
-        # transform from world to joint anchor frame at child body
-        X_wcj = X_wpj * X_j
-        # transform from world to child body frame
-        X_wc = X_wcj * wp.transform_inverse(X_cj)
-
-        # transform velocity across the joint to world space
-        angular_vel = wp.transform_vector(X_wpj, wp.spatial_top(v_j))
-        linear_vel = wp.transform_vector(X_wpj, wp.spatial_bottom(v_j))
-
-        v_wc = v_wpj + wp.spatial_vector(angular_vel, linear_vel)
-
-        body_q[child] = X_wc
-        body_qd[child] = v_wc
-
-
-# implementation where mask is an integer array
-@wp.kernel
-def eval_articulation_fk(
-    articulation_start: wp.array(dtype=int),
-    articulation_mask: wp.array(
-        dtype=int
-    ),  # used to enable / disable FK for an articulation, if None then treat all as enabled
-    joint_q: wp.array(dtype=float),
-    joint_qd: wp.array(dtype=float),
-    joint_q_start: wp.array(dtype=int),
-    joint_qd_start: wp.array(dtype=int),
-    joint_type: wp.array(dtype=int),
-    joint_parent: wp.array(dtype=int),
-    joint_child: wp.array(dtype=int),
-    joint_X_p: wp.array(dtype=wp.transform),
-    joint_X_c: wp.array(dtype=wp.transform),
-    joint_axis: wp.array(dtype=wp.vec3),
-    joint_axis_start: wp.array(dtype=int),
-    joint_axis_dim: wp.array(dtype=int, ndim=2),
-    body_com: wp.array(dtype=wp.vec3),
-    # outputs
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-):
-    tid = wp.tid()
-
-    # early out if disabling FK for this articulation
-    if articulation_mask:
-        if articulation_mask[tid] == 0:
-            return
-
-    joint_start = articulation_start[tid]
-    joint_end = articulation_start[tid + 1]
-
-    eval_single_articulation_fk(
-        joint_start,
-        joint_end,
-        joint_q,
-        joint_qd,
-        joint_q_start,
-        joint_qd_start,
-        joint_type,
-        joint_parent,
-        joint_child,
-        joint_X_p,
-        joint_X_c,
-        joint_axis,
-        joint_axis_start,
-        joint_axis_dim,
-        body_com,
-        # outputs
-        body_q,
-        body_qd,
-    )
-
-
-# overload where mask is a bool array
-@wp.kernel
-def eval_articulation_fk(
-    articulation_start: wp.array(dtype=int),
-    articulation_mask: wp.array(
-        dtype=bool
-    ),  # used to enable / disable FK for an articulation, if None then treat all as enabled
-    joint_q: wp.array(dtype=float),
-    joint_qd: wp.array(dtype=float),
-    joint_q_start: wp.array(dtype=int),
-    joint_qd_start: wp.array(dtype=int),
-    joint_type: wp.array(dtype=int),
-    joint_parent: wp.array(dtype=int),
-    joint_child: wp.array(dtype=int),
-    joint_X_p: wp.array(dtype=wp.transform),
-    joint_X_c: wp.array(dtype=wp.transform),
-    joint_axis: wp.array(dtype=wp.vec3),
-    joint_axis_start: wp.array(dtype=int),
-    joint_axis_dim: wp.array(dtype=int, ndim=2),
-    body_com: wp.array(dtype=wp.vec3),
-    # outputs
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-):
-    tid = wp.tid()
-
-    # early out if disabling FK for this articulation
-    if articulation_mask:
-        if not articulation_mask[tid]:
-            return
-
-    joint_start = articulation_start[tid]
-    joint_end = articulation_start[tid + 1]
-
-    eval_single_articulation_fk(
-        joint_start,
-        joint_end,
-        joint_q,
-        joint_qd,
-        joint_q_start,
-        joint_qd_start,
-        joint_type,
-        joint_parent,
-        joint_child,
-        joint_X_p,
-        joint_X_c,
-        joint_axis,
-        joint_axis_start,
-        joint_axis_dim,
-        body_com,
-        # outputs
-        body_q,
-        body_qd,
-    )
-
-
-# updates state body information based on joint coordinates
-def eval_fk(model, joint_q, joint_qd, mask, state):
-    """
-    Evaluates the model's forward kinematics given the joint coordinates and updates the state's body information (:attr:`State.body_q` and :attr:`State.body_qd`).
-
-    Args:
-        model (Model): The model to evaluate.
-        joint_q (array): Generalized joint position coordinates, shape [joint_coord_count], float
-        joint_qd (array): Generalized joint velocity coordinates, shape [joint_dof_count], float
-        mask (array): The mask to use to enable / disable FK for an articulation. If None then treat all as enabled, shape [articulation_count], int/bool
-        state (State): The state to update.
-    """
-    wp.launch(
-        kernel=eval_articulation_fk,
-        dim=model.articulation_count,
-        inputs=[
-            model.articulation_start,
-            mask,
-            joint_q,
-            joint_qd,
-            model.joint_q_start,
-            model.joint_qd_start,
-            model.joint_type,
-            model.joint_parent,
-            model.joint_child,
-            model.joint_X_p,
-            model.joint_X_c,
-            model.joint_axis,
-            model.joint_axis_start,
-            model.joint_axis_dim,
-            model.body_com,
-        ],
-        outputs=[
-            state.body_q,
-            state.body_qd,
-        ],
-        device=model.device,
-    )
-
-
-@wp.func
-def reconstruct_angular_q_qd(q_pc: wp.quat, w_err: wp.vec3, X_wp: wp.transform, axis: wp.vec3):
-    """
-    Reconstructs the angular joint coordinates and velocities given the relative rotation and angular velocity
-    between a parent and child body.
-
-    Args:
-        q_pc (quat): The relative rotation between the parent and child body.
-        w_err (vec3): The angular velocity between the parent and child body.
-        X_wp (transform): The parent body's transform in world space.
-        axis (vec3): The joint axis in the frame of the parent body.
-
-    Returns:
-        q (float): The joint position coordinate.
-        qd (float): The joint velocity coordinate.
-    """
-    axis_p = wp.transform_vector(X_wp, axis)
-    twist = quat_twist(axis, q_pc)
-    q = wp.acos(twist[3]) * 2.0 * wp.sign(wp.dot(axis, wp.vec3(twist[0], twist[1], twist[2])))
-    qd = wp.dot(w_err, axis_p)
-    return q, qd
-
-
-@wp.kernel
-def eval_articulation_ik(
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-    body_com: wp.array(dtype=wp.vec3),
-    joint_type: wp.array(dtype=int),
-    joint_parent: wp.array(dtype=int),
-    joint_child: wp.array(dtype=int),
-    joint_X_p: wp.array(dtype=wp.transform),
-    joint_X_c: wp.array(dtype=wp.transform),
-    joint_axis: wp.array(dtype=wp.vec3),
-    joint_axis_start: wp.array(dtype=int),
-    joint_axis_dim: wp.array(dtype=int, ndim=2),
-    joint_q_start: wp.array(dtype=int),
-    joint_qd_start: wp.array(dtype=int),
-    joint_q: wp.array(dtype=float),
-    joint_qd: wp.array(dtype=float),
-):
-    tid = wp.tid()
-
-    parent = joint_parent[tid]
-    child = joint_child[tid]
-
-    X_pj = joint_X_p[tid]
-    X_cj = joint_X_c[tid]
-
-    w_p = wp.vec3()
-    v_p = wp.vec3()
-    v_wp = wp.spatial_vector()
-
-    # parent anchor frame in world space
-    X_wpj = X_pj
-    if parent >= 0:
-        X_wp = body_q[parent]
-        X_wpj = X_wp * X_pj
-        r_p = wp.transform_get_translation(X_wpj) - wp.transform_point(X_wp, body_com[parent])
-
-        v_wp = body_qd[parent]
-        w_p = wp.spatial_top(v_wp)
-        v_p = wp.spatial_bottom(v_wp) + wp.cross(w_p, r_p)
-
-    # child transform and moment arm
-    X_wc = body_q[child]
-    X_wcj = X_wc * X_cj
-
-    v_wc = body_qd[child]
-
-    w_c = wp.spatial_top(v_wc)
-    v_c = wp.spatial_bottom(v_wc)
-
-    # joint properties
-    type = joint_type[tid]
-
-    # compute position and orientation differences between anchor frames
-    x_p = wp.transform_get_translation(X_wpj)
-    x_c = wp.transform_get_translation(X_wcj)
-
-    q_p = wp.transform_get_rotation(X_wpj)
-    q_c = wp.transform_get_rotation(X_wcj)
-
-    x_err = x_c - x_p
-    v_err = v_c - v_p
-    w_err = w_c - w_p
-
-    q_start = joint_q_start[tid]
-    qd_start = joint_qd_start[tid]
-    axis_start = joint_axis_start[tid]
-    lin_axis_count = joint_axis_dim[tid, 0]
-    ang_axis_count = joint_axis_dim[tid, 1]
-
-    if type == wp.sim.JOINT_PRISMATIC:
-        axis = joint_axis[axis_start]
-
-        # world space joint axis
-        axis_p = wp.quat_rotate(q_p, axis)
-
-        # evaluate joint coordinates
-        q = wp.dot(x_err, axis_p)
-        qd = wp.dot(v_err, axis_p)
-
-        joint_q[q_start] = q
-        joint_qd[qd_start] = qd
-
-        return
-
-    if type == wp.sim.JOINT_REVOLUTE:
-        axis = joint_axis[axis_start]
-        q_pc = wp.quat_inverse(q_p) * q_c
-
-        q, qd = reconstruct_angular_q_qd(q_pc, w_err, X_wpj, axis)
-
-        joint_q[q_start] = q
-        joint_qd[qd_start] = qd
-
-        return
-
-    if type == wp.sim.JOINT_BALL:
-        q_pc = wp.quat_inverse(q_p) * q_c
-
-        joint_q[q_start + 0] = q_pc[0]
-        joint_q[q_start + 1] = q_pc[1]
-        joint_q[q_start + 2] = q_pc[2]
-        joint_q[q_start + 3] = q_pc[3]
-
-        ang_vel = wp.transform_vector(wp.transform_inverse(X_wpj), w_err)
-        joint_qd[qd_start + 0] = ang_vel[0]
-        joint_qd[qd_start + 1] = ang_vel[1]
-        joint_qd[qd_start + 2] = ang_vel[2]
-
-        return
-
-    if type == wp.sim.JOINT_FIXED:
-        return
-
-    if type == wp.sim.JOINT_FREE or type == wp.sim.JOINT_DISTANCE:
-        q_pc = wp.quat_inverse(q_p) * q_c
-
-        x_err_c = wp.quat_rotate_inv(q_p, x_err)
-        v_err_c = wp.quat_rotate_inv(q_p, v_err)
-        w_err_c = wp.quat_rotate_inv(q_p, w_err)
-
-        joint_q[q_start + 0] = x_err_c[0]
-        joint_q[q_start + 1] = x_err_c[1]
-        joint_q[q_start + 2] = x_err_c[2]
-
-        joint_q[q_start + 3] = q_pc[0]
-        joint_q[q_start + 4] = q_pc[1]
-        joint_q[q_start + 5] = q_pc[2]
-        joint_q[q_start + 6] = q_pc[3]
-
-        joint_qd[qd_start + 0] = w_err_c[0]
-        joint_qd[qd_start + 1] = w_err_c[1]
-        joint_qd[qd_start + 2] = w_err_c[2]
-
-        joint_qd[qd_start + 3] = v_err_c[0]
-        joint_qd[qd_start + 4] = v_err_c[1]
-        joint_qd[qd_start + 5] = v_err_c[2]
-
-        return
-
-    if type == wp.sim.JOINT_COMPOUND:
-        axis_0 = joint_axis[axis_start + 0]
-        axis_1 = joint_axis[axis_start + 1]
-        axis_2 = joint_axis[axis_start + 2]
-        qs, qds = invert_3d_rotational_dofs(axis_0, axis_1, axis_2, q_p, q_c, w_err)
-        joint_q[q_start + 0] = qs[0]
-        joint_q[q_start + 1] = qs[1]
-        joint_q[q_start + 2] = qs[2]
-        joint_qd[qd_start + 0] = qds[0]
-        joint_qd[qd_start + 1] = qds[1]
-        joint_qd[qd_start + 2] = qds[2]
-
-        return
-
-    if type == wp.sim.JOINT_UNIVERSAL:
-        axis_0 = joint_axis[axis_start + 0]
-        axis_1 = joint_axis[axis_start + 1]
-        qs2, qds2 = invert_2d_rotational_dofs(axis_0, axis_1, q_p, q_c, w_err)
-        joint_q[q_start + 0] = qs2[0]
-        joint_q[q_start + 1] = qs2[1]
-        joint_qd[qd_start + 0] = qds2[0]
-        joint_qd[qd_start + 1] = qds2[1]
-
-        return
-
-    if type == wp.sim.JOINT_D6:
-        x_err_c = wp.quat_rotate_inv(q_p, x_err)
-        v_err_c = wp.quat_rotate_inv(q_p, v_err)
-        if lin_axis_count > 0:
-            axis = joint_axis[axis_start + 0]
-            joint_q[q_start + 0] = wp.dot(x_err_c, axis)
-            joint_qd[qd_start + 0] = wp.dot(v_err_c, axis)
-
-        if lin_axis_count > 1:
-            axis = joint_axis[axis_start + 1]
-            joint_q[q_start + 1] = wp.dot(x_err_c, axis)
-            joint_qd[qd_start + 1] = wp.dot(v_err_c, axis)
-
-        if lin_axis_count > 2:
-            axis = joint_axis[axis_start + 2]
-            joint_q[q_start + 2] = wp.dot(x_err_c, axis)
-            joint_qd[qd_start + 2] = wp.dot(v_err_c, axis)
-
-        if ang_axis_count == 1:
-            axis = joint_axis[axis_start]
-            q_pc = wp.quat_inverse(q_p) * q_c
-            q, qd = reconstruct_angular_q_qd(q_pc, w_err, X_wpj, joint_axis[axis_start + lin_axis_count])
-            joint_q[q_start + lin_axis_count] = q
-            joint_qd[qd_start + lin_axis_count] = qd
-
-        if ang_axis_count == 2:
-            axis_0 = joint_axis[axis_start + lin_axis_count + 0]
-            axis_1 = joint_axis[axis_start + lin_axis_count + 1]
-            qs2, qds2 = invert_2d_rotational_dofs(axis_0, axis_1, q_p, q_c, w_err)
-            joint_q[q_start + lin_axis_count + 0] = qs2[0]
-            joint_q[q_start + lin_axis_count + 1] = qs2[1]
-            joint_qd[qd_start + lin_axis_count + 0] = qds2[0]
-            joint_qd[qd_start + lin_axis_count + 1] = qds2[1]
-
-        if ang_axis_count == 3:
-            axis_0 = joint_axis[axis_start + lin_axis_count + 0]
-            axis_1 = joint_axis[axis_start + lin_axis_count + 1]
-            axis_2 = joint_axis[axis_start + lin_axis_count + 2]
-            qs3, qds3 = invert_3d_rotational_dofs(axis_0, axis_1, axis_2, q_p, q_c, w_err)
-            joint_q[q_start + lin_axis_count + 0] = qs3[0]
-            joint_q[q_start + lin_axis_count + 1] = qs3[1]
-            joint_q[q_start + lin_axis_count + 2] = qs3[2]
-            joint_qd[qd_start + lin_axis_count + 0] = qds3[0]
-            joint_qd[qd_start + lin_axis_count + 1] = qds3[1]
-            joint_qd[qd_start + lin_axis_count + 2] = qds3[2]
-
-        return
-
-
-# given maximal coordinate model computes ik (closest point projection)
-def eval_ik(model, state, joint_q, joint_qd):
-    """
-    Evaluates the model's inverse kinematics given the state's body information (:attr:`State.body_q` and :attr:`State.body_qd`) and updates the generalized joint coordinates `joint_q` and `joint_qd`.
-
-    Args:
-        model (Model): The model to evaluate.
-        state (State): The state with the body's maximal coordinates (positions :attr:`State.body_q` and velocities :attr:`State.body_qd`) to use.
-        joint_q (array): Generalized joint position coordinates, shape [joint_coord_count], float
-        joint_qd (array): Generalized joint velocity coordinates, shape [joint_dof_count], float
-    """
-    wp.launch(
-        kernel=eval_articulation_ik,
-        dim=model.joint_count,
-        inputs=[
-            state.body_q,
-            state.body_qd,
-            model.body_com,
-            model.joint_type,
-            model.joint_parent,
-            model.joint_child,
-            model.joint_X_p,
-            model.joint_X_c,
-            model.joint_axis,
-            model.joint_axis_start,
-            model.joint_axis_dim,
-            model.joint_q_start,
-            model.joint_qd_start,
-        ],
-        outputs=[joint_q, joint_qd],
-        device=model.device,
-    )
diff --git a/warp/sim/collide.py b/warp/sim/collide.py
deleted file mode 100644
index 8c38155f..00000000
--- a/warp/sim/collide.py
+++ /dev/null
@@ -1,2570 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-"""
-Collision handling functions and kernels.
-"""
-
-from typing import Optional
-
-import numpy as np
-
-import warp as wp
-from warp.sim.model import Model, State
-
-from .model import PARTICLE_FLAG_ACTIVE, ModelShapeGeometry
-
-# types of triangle's closest point to a point
-TRI_CONTACT_FEATURE_VERTEX_A = wp.constant(0)
-TRI_CONTACT_FEATURE_VERTEX_B = wp.constant(1)
-TRI_CONTACT_FEATURE_VERTEX_C = wp.constant(2)
-TRI_CONTACT_FEATURE_EDGE_AB = wp.constant(3)
-TRI_CONTACT_FEATURE_EDGE_AC = wp.constant(4)
-TRI_CONTACT_FEATURE_EDGE_BC = wp.constant(5)
-TRI_CONTACT_FEATURE_FACE_INTERIOR = wp.constant(6)
-
-# constants used to access TriMeshCollisionDetector.resize_flags
-VERTEX_COLLISION_BUFFER_OVERFLOW_INDEX = wp.constant(0)
-TRI_COLLISION_BUFFER_OVERFLOW_INDEX = wp.constant(1)
-EDGE_COLLISION_BUFFER_OVERFLOW_INDEX = wp.constant(2)
-TRI_TRI_COLLISION_BUFFER_OVERFLOW_INDEX = wp.constant(3)
-
-
-@wp.func
-def build_orthonormal_basis(n: wp.vec3):
-    """
-    Builds an orthonormal basis given a normal vector `n`. Return the two axes that are perpendicular to `n`.
-
-    :param n: A 3D vector (list or array-like) representing the normal vector
-    """
-    b1 = wp.vec3()
-    b2 = wp.vec3()
-    if n[2] < 0.0:
-        a = 1.0 / (1.0 - n[2])
-        b = n[0] * n[1] * a
-        b1[0] = 1.0 - n[0] * n[0] * a
-        b1[1] = -b
-        b1[2] = n[0]
-
-        b2[0] = b
-        b2[1] = n[1] * n[1] * a - 1.0
-        b2[2] = -n[1]
-    else:
-        a = 1.0 / (1.0 + n[2])
-        b = -n[0] * n[1] * a
-        b1[0] = 1.0 - n[0] * n[0] * a
-        b1[1] = b
-        b1[2] = -n[0]
-
-        b2[0] = b
-        b2[1] = 1.0 - n[1] * n[1] * a
-        b2[2] = -n[1]
-
-    return b1, b2
-
-
-@wp.func
-def triangle_closest_point_barycentric(a: wp.vec3, b: wp.vec3, c: wp.vec3, p: wp.vec3):
-    ab = b - a
-    ac = c - a
-    ap = p - a
-
-    d1 = wp.dot(ab, ap)
-    d2 = wp.dot(ac, ap)
-
-    if d1 <= 0.0 and d2 <= 0.0:
-        return wp.vec3(1.0, 0.0, 0.0)
-
-    bp = p - b
-    d3 = wp.dot(ab, bp)
-    d4 = wp.dot(ac, bp)
-
-    if d3 >= 0.0 and d4 <= d3:
-        return wp.vec3(0.0, 1.0, 0.0)
-
-    vc = d1 * d4 - d3 * d2
-    v = d1 / (d1 - d3)
-    if vc <= 0.0 and d1 >= 0.0 and d3 <= 0.0:
-        return wp.vec3(1.0 - v, v, 0.0)
-
-    cp = p - c
-    d5 = wp.dot(ab, cp)
-    d6 = wp.dot(ac, cp)
-
-    if d6 >= 0.0 and d5 <= d6:
-        return wp.vec3(0.0, 0.0, 1.0)
-
-    vb = d5 * d2 - d1 * d6
-    w = d2 / (d2 - d6)
-    if vb <= 0.0 and d2 >= 0.0 and d6 <= 0.0:
-        return wp.vec3(1.0 - w, 0.0, w)
-
-    va = d3 * d6 - d5 * d4
-    w = (d4 - d3) / ((d4 - d3) + (d5 - d6))
-    if va <= 0.0 and (d4 - d3) >= 0.0 and (d5 - d6) >= 0.0:
-        return wp.vec3(0.0, 1.0 - w, w)
-
-    denom = 1.0 / (va + vb + vc)
-    v = vb * denom
-    w = vc * denom
-
-    return wp.vec3(1.0 - v - w, v, w)
-
-
-@wp.func
-def triangle_closest_point(a: wp.vec3, b: wp.vec3, c: wp.vec3, p: wp.vec3):
-    """
-    feature_type type:
-        TRI_CONTACT_FEATURE_VERTEX_A
-        TRI_CONTACT_FEATURE_VERTEX_B
-        TRI_CONTACT_FEATURE_VERTEX_C
-        TRI_CONTACT_FEATURE_EDGE_AB      : at edge A-B
-        TRI_CONTACT_FEATURE_EDGE_AC      : at edge A-C
-        TRI_CONTACT_FEATURE_EDGE_BC      : at edge B-C
-        TRI_CONTACT_FEATURE_FACE_INTERIOR
-    """
-    ab = b - a
-    ac = c - a
-    ap = p - a
-
-    d1 = wp.dot(ab, ap)
-    d2 = wp.dot(ac, ap)
-    if d1 <= 0.0 and d2 <= 0.0:
-        feature_type = TRI_CONTACT_FEATURE_VERTEX_A
-        bary = wp.vec3(1.0, 0.0, 0.0)
-        return a, bary, feature_type
-
-    bp = p - b
-    d3 = wp.dot(ab, bp)
-    d4 = wp.dot(ac, bp)
-    if d3 >= 0.0 and d4 <= d3:
-        feature_type = TRI_CONTACT_FEATURE_VERTEX_B
-        bary = wp.vec3(0.0, 1.0, 0.0)
-        return b, bary, feature_type
-
-    cp = p - c
-    d5 = wp.dot(ab, cp)
-    d6 = wp.dot(ac, cp)
-    if d6 >= 0.0 and d5 <= d6:
-        feature_type = TRI_CONTACT_FEATURE_VERTEX_C
-        bary = wp.vec3(0.0, 0.0, 1.0)
-        return c, bary, feature_type
-
-    vc = d1 * d4 - d3 * d2
-    if vc <= 0.0 and d1 >= 0.0 and d3 <= 0.0:
-        v = d1 / (d1 - d3)
-        feature_type = TRI_CONTACT_FEATURE_EDGE_AB
-        bary = wp.vec3(1.0 - v, v, 0.0)
-        return a + v * ab, bary, feature_type
-
-    vb = d5 * d2 - d1 * d6
-    if vb <= 0.0 and d2 >= 0.0 and d6 <= 0.0:
-        v = d2 / (d2 - d6)
-        feature_type = TRI_CONTACT_FEATURE_EDGE_AC
-        bary = wp.vec3(1.0 - v, 0.0, v)
-        return a + v * ac, bary, feature_type
-
-    va = d3 * d6 - d5 * d4
-    if va <= 0.0 and (d4 - d3) >= 0.0 and (d5 - d6) >= 0.0:
-        v = (d4 - d3) / ((d4 - d3) + (d5 - d6))
-        feature_type = TRI_CONTACT_FEATURE_EDGE_BC
-        bary = wp.vec3(0.0, 1.0 - v, v)
-        return b + v * (c - b), bary, feature_type
-
-    denom = 1.0 / (va + vb + vc)
-    v = vb * denom
-    w = vc * denom
-    feature_type = TRI_CONTACT_FEATURE_FACE_INTERIOR
-    bary = wp.vec3(1.0 - v - w, v, w)
-    return a + v * ab + w * ac, bary, feature_type
-
-
-@wp.func
-def sphere_sdf(center: wp.vec3, radius: float, p: wp.vec3):
-    return wp.length(p - center) - radius
-
-
-@wp.func
-def sphere_sdf_grad(center: wp.vec3, radius: float, p: wp.vec3):
-    return wp.normalize(p - center)
-
-
-@wp.func
-def box_sdf(upper: wp.vec3, p: wp.vec3):
-    # adapted from https://www.iquilezles.org/www/articles/distfunctions/distfunctions.htm
-    qx = abs(p[0]) - upper[0]
-    qy = abs(p[1]) - upper[1]
-    qz = abs(p[2]) - upper[2]
-
-    e = wp.vec3(wp.max(qx, 0.0), wp.max(qy, 0.0), wp.max(qz, 0.0))
-
-    return wp.length(e) + wp.min(wp.max(qx, wp.max(qy, qz)), 0.0)
-
-
-@wp.func
-def box_sdf_grad(upper: wp.vec3, p: wp.vec3):
-    qx = abs(p[0]) - upper[0]
-    qy = abs(p[1]) - upper[1]
-    qz = abs(p[2]) - upper[2]
-
-    # exterior case
-    if qx > 0.0 or qy > 0.0 or qz > 0.0:
-        x = wp.clamp(p[0], -upper[0], upper[0])
-        y = wp.clamp(p[1], -upper[1], upper[1])
-        z = wp.clamp(p[2], -upper[2], upper[2])
-
-        return wp.normalize(p - wp.vec3(x, y, z))
-
-    sx = wp.sign(p[0])
-    sy = wp.sign(p[1])
-    sz = wp.sign(p[2])
-
-    # x projection
-    if (qx > qy and qx > qz) or (qy == 0.0 and qz == 0.0):
-        return wp.vec3(sx, 0.0, 0.0)
-
-    # y projection
-    if (qy > qx and qy > qz) or (qx == 0.0 and qz == 0.0):
-        return wp.vec3(0.0, sy, 0.0)
-
-    # z projection
-    return wp.vec3(0.0, 0.0, sz)
-
-
-@wp.func
-def capsule_sdf(radius: float, half_height: float, p: wp.vec3):
-    if p[1] > half_height:
-        return wp.length(wp.vec3(p[0], p[1] - half_height, p[2])) - radius
-
-    if p[1] < -half_height:
-        return wp.length(wp.vec3(p[0], p[1] + half_height, p[2])) - radius
-
-    return wp.length(wp.vec3(p[0], 0.0, p[2])) - radius
-
-
-@wp.func
-def capsule_sdf_grad(radius: float, half_height: float, p: wp.vec3):
-    if p[1] > half_height:
-        return wp.normalize(wp.vec3(p[0], p[1] - half_height, p[2]))
-
-    if p[1] < -half_height:
-        return wp.normalize(wp.vec3(p[0], p[1] + half_height, p[2]))
-
-    return wp.normalize(wp.vec3(p[0], 0.0, p[2]))
-
-
-@wp.func
-def cylinder_sdf(radius: float, half_height: float, p: wp.vec3):
-    dx = wp.length(wp.vec3(p[0], 0.0, p[2])) - radius
-    dy = wp.abs(p[1]) - half_height
-    return wp.min(wp.max(dx, dy), 0.0) + wp.length(wp.vec2(wp.max(dx, 0.0), wp.max(dy, 0.0)))
-
-
-@wp.func
-def cylinder_sdf_grad(radius: float, half_height: float, p: wp.vec3):
-    dx = wp.length(wp.vec3(p[0], 0.0, p[2])) - radius
-    dy = wp.abs(p[1]) - half_height
-    if dx > dy:
-        return wp.normalize(wp.vec3(p[0], 0.0, p[2]))
-    return wp.vec3(0.0, wp.sign(p[1]), 0.0)
-
-
-@wp.func
-def cone_sdf(radius: float, half_height: float, p: wp.vec3):
-    dx = wp.length(wp.vec3(p[0], 0.0, p[2])) - radius * (p[1] + half_height) / (2.0 * half_height)
-    dy = wp.abs(p[1]) - half_height
-    return wp.min(wp.max(dx, dy), 0.0) + wp.length(wp.vec2(wp.max(dx, 0.0), wp.max(dy, 0.0)))
-
-
-@wp.func
-def cone_sdf_grad(radius: float, half_height: float, p: wp.vec3):
-    dx = wp.length(wp.vec3(p[0], 0.0, p[2])) - radius * (p[1] + half_height) / (2.0 * half_height)
-    dy = wp.abs(p[1]) - half_height
-    if dy < 0.0 or dx == 0.0:
-        return wp.vec3(0.0, wp.sign(p[1]), 0.0)
-    return wp.normalize(wp.vec3(p[0], 0.0, p[2])) + wp.vec3(0.0, radius / (2.0 * half_height), 0.0)
-
-
-@wp.func
-def plane_sdf(width: float, length: float, p: wp.vec3):
-    # SDF for a quad in the xz plane
-    if width > 0.0 and length > 0.0:
-        d = wp.max(wp.abs(p[0]) - width, wp.abs(p[2]) - length)
-        return wp.max(d, wp.abs(p[1]))
-    return p[1]
-
-
-@wp.func
-def closest_point_plane(width: float, length: float, point: wp.vec3):
-    # projects the point onto the quad in the xz plane (if width and length > 0.0, otherwise the plane is infinite)
-    if width > 0.0:
-        x = wp.clamp(point[0], -width, width)
-    else:
-        x = point[0]
-    if length > 0.0:
-        z = wp.clamp(point[2], -length, length)
-    else:
-        z = point[2]
-    return wp.vec3(x, 0.0, z)
-
-
-@wp.func
-def closest_point_line_segment(a: wp.vec3, b: wp.vec3, point: wp.vec3):
-    ab = b - a
-    ap = point - a
-    t = wp.dot(ap, ab) / wp.dot(ab, ab)
-    t = wp.clamp(t, 0.0, 1.0)
-    return a + t * ab
-
-
-@wp.func
-def closest_point_box(upper: wp.vec3, point: wp.vec3):
-    # closest point to box surface
-    x = wp.clamp(point[0], -upper[0], upper[0])
-    y = wp.clamp(point[1], -upper[1], upper[1])
-    z = wp.clamp(point[2], -upper[2], upper[2])
-    if wp.abs(point[0]) <= upper[0] and wp.abs(point[1]) <= upper[1] and wp.abs(point[2]) <= upper[2]:
-        # the point is inside, find closest face
-        sx = wp.abs(wp.abs(point[0]) - upper[0])
-        sy = wp.abs(wp.abs(point[1]) - upper[1])
-        sz = wp.abs(wp.abs(point[2]) - upper[2])
-        # return closest point on closest side, handle corner cases
-        if (sx < sy and sx < sz) or (sy == 0.0 and sz == 0.0):
-            x = wp.sign(point[0]) * upper[0]
-        elif (sy < sx and sy < sz) or (sx == 0.0 and sz == 0.0):
-            y = wp.sign(point[1]) * upper[1]
-        else:
-            z = wp.sign(point[2]) * upper[2]
-    return wp.vec3(x, y, z)
-
-
-@wp.func
-def get_box_vertex(point_id: int, upper: wp.vec3):
-    # box vertex numbering:
-    #    6---7
-    #    |\  |\       y
-    #    | 2-+-3      |
-    #    4-+-5 |   z \|
-    #     \|  \|      o---x
-    #      0---1
-    # get the vertex of the box given its ID (0-7)
-    sign_x = float(point_id % 2) * 2.0 - 1.0
-    sign_y = float((point_id // 2) % 2) * 2.0 - 1.0
-    sign_z = float((point_id // 4) % 2) * 2.0 - 1.0
-    return wp.vec3(sign_x * upper[0], sign_y * upper[1], sign_z * upper[2])
-
-
-@wp.func
-def get_box_edge(edge_id: int, upper: wp.vec3):
-    # get the edge of the box given its ID (0-11)
-    if edge_id < 4:
-        # edges along x: 0-1, 2-3, 4-5, 6-7
-        i = edge_id * 2
-        j = i + 1
-        return wp.spatial_vector(get_box_vertex(i, upper), get_box_vertex(j, upper))
-    elif edge_id < 8:
-        # edges along y: 0-2, 1-3, 4-6, 5-7
-        edge_id -= 4
-        i = edge_id % 2 + edge_id // 2 * 4
-        j = i + 2
-        return wp.spatial_vector(get_box_vertex(i, upper), get_box_vertex(j, upper))
-    # edges along z: 0-4, 1-5, 2-6, 3-7
-    edge_id -= 8
-    i = edge_id
-    j = i + 4
-    return wp.spatial_vector(get_box_vertex(i, upper), get_box_vertex(j, upper))
-
-
-@wp.func
-def get_plane_edge(edge_id: int, plane_width: float, plane_length: float):
-    # get the edge of the plane given its ID (0-3)
-    p0x = (2.0 * float(edge_id % 2) - 1.0) * plane_width
-    p0z = (2.0 * float(edge_id // 2) - 1.0) * plane_length
-    if edge_id == 0 or edge_id == 3:
-        p1x = p0x
-        p1z = -p0z
-    else:
-        p1x = -p0x
-        p1z = p0z
-    return wp.spatial_vector(wp.vec3(p0x, 0.0, p0z), wp.vec3(p1x, 0.0, p1z))
-
-
-@wp.func
-def closest_edge_coordinate_box(upper: wp.vec3, edge_a: wp.vec3, edge_b: wp.vec3, max_iter: int):
-    # find point on edge closest to box, return its barycentric edge coordinate
-    # Golden-section search
-    a = float(0.0)
-    b = float(1.0)
-    h = b - a
-    invphi = 0.61803398875  # 1 / phi
-    invphi2 = 0.38196601125  # 1 / phi^2
-    c = a + invphi2 * h
-    d = a + invphi * h
-    query = (1.0 - c) * edge_a + c * edge_b
-    yc = box_sdf(upper, query)
-    query = (1.0 - d) * edge_a + d * edge_b
-    yd = box_sdf(upper, query)
-
-    for _k in range(max_iter):
-        if yc < yd:  # yc > yd to find the maximum
-            b = d
-            d = c
-            yd = yc
-            h = invphi * h
-            c = a + invphi2 * h
-            query = (1.0 - c) * edge_a + c * edge_b
-            yc = box_sdf(upper, query)
-        else:
-            a = c
-            c = d
-            yc = yd
-            h = invphi * h
-            d = a + invphi * h
-            query = (1.0 - d) * edge_a + d * edge_b
-            yd = box_sdf(upper, query)
-
-    if yc < yd:
-        return 0.5 * (a + d)
-    return 0.5 * (c + b)
-
-
-@wp.func
-def closest_edge_coordinate_plane(
-    plane_width: float,
-    plane_length: float,
-    edge_a: wp.vec3,
-    edge_b: wp.vec3,
-    max_iter: int,
-):
-    # find point on edge closest to plane, return its barycentric edge coordinate
-    # Golden-section search
-    a = float(0.0)
-    b = float(1.0)
-    h = b - a
-    invphi = 0.61803398875  # 1 / phi
-    invphi2 = 0.38196601125  # 1 / phi^2
-    c = a + invphi2 * h
-    d = a + invphi * h
-    query = (1.0 - c) * edge_a + c * edge_b
-    yc = plane_sdf(plane_width, plane_length, query)
-    query = (1.0 - d) * edge_a + d * edge_b
-    yd = plane_sdf(plane_width, plane_length, query)
-
-    for _k in range(max_iter):
-        if yc < yd:  # yc > yd to find the maximum
-            b = d
-            d = c
-            yd = yc
-            h = invphi * h
-            c = a + invphi2 * h
-            query = (1.0 - c) * edge_a + c * edge_b
-            yc = plane_sdf(plane_width, plane_length, query)
-        else:
-            a = c
-            c = d
-            yc = yd
-            h = invphi * h
-            d = a + invphi * h
-            query = (1.0 - d) * edge_a + d * edge_b
-            yd = plane_sdf(plane_width, plane_length, query)
-
-    if yc < yd:
-        return 0.5 * (a + d)
-    return 0.5 * (c + b)
-
-
-@wp.func
-def closest_edge_coordinate_capsule(radius: float, half_height: float, edge_a: wp.vec3, edge_b: wp.vec3, max_iter: int):
-    # find point on edge closest to capsule, return its barycentric edge coordinate
-    # Golden-section search
-    a = float(0.0)
-    b = float(1.0)
-    h = b - a
-    invphi = 0.61803398875  # 1 / phi
-    invphi2 = 0.38196601125  # 1 / phi^2
-    c = a + invphi2 * h
-    d = a + invphi * h
-    query = (1.0 - c) * edge_a + c * edge_b
-    yc = capsule_sdf(radius, half_height, query)
-    query = (1.0 - d) * edge_a + d * edge_b
-    yd = capsule_sdf(radius, half_height, query)
-
-    for _k in range(max_iter):
-        if yc < yd:  # yc > yd to find the maximum
-            b = d
-            d = c
-            yd = yc
-            h = invphi * h
-            c = a + invphi2 * h
-            query = (1.0 - c) * edge_a + c * edge_b
-            yc = capsule_sdf(radius, half_height, query)
-        else:
-            a = c
-            c = d
-            yc = yd
-            h = invphi * h
-            d = a + invphi * h
-            query = (1.0 - d) * edge_a + d * edge_b
-            yd = capsule_sdf(radius, half_height, query)
-
-    if yc < yd:
-        return 0.5 * (a + d)
-
-    return 0.5 * (c + b)
-
-
-@wp.func
-def mesh_sdf(mesh: wp.uint64, point: wp.vec3, max_dist: float):
-    face_index = int(0)
-    face_u = float(0.0)
-    face_v = float(0.0)
-    sign = float(0.0)
-    res = wp.mesh_query_point_sign_normal(mesh, point, max_dist, sign, face_index, face_u, face_v)
-
-    if res:
-        closest = wp.mesh_eval_position(mesh, face_index, face_u, face_v)
-        return wp.length(point - closest) * sign
-    return max_dist
-
-
-@wp.func
-def closest_point_mesh(mesh: wp.uint64, point: wp.vec3, max_dist: float):
-    face_index = int(0)
-    face_u = float(0.0)
-    face_v = float(0.0)
-    sign = float(0.0)
-    res = wp.mesh_query_point_sign_normal(mesh, point, max_dist, sign, face_index, face_u, face_v)
-
-    if res:
-        return wp.mesh_eval_position(mesh, face_index, face_u, face_v)
-    # return arbitrary point from mesh
-    return wp.mesh_eval_position(mesh, 0, 0.0, 0.0)
-
-
-@wp.func
-def closest_edge_coordinate_mesh(mesh: wp.uint64, edge_a: wp.vec3, edge_b: wp.vec3, max_iter: int, max_dist: float):
-    # find point on edge closest to mesh, return its barycentric edge coordinate
-    # Golden-section search
-    a = float(0.0)
-    b = float(1.0)
-    h = b - a
-    invphi = 0.61803398875  # 1 / phi
-    invphi2 = 0.38196601125  # 1 / phi^2
-    c = a + invphi2 * h
-    d = a + invphi * h
-    query = (1.0 - c) * edge_a + c * edge_b
-    yc = mesh_sdf(mesh, query, max_dist)
-    query = (1.0 - d) * edge_a + d * edge_b
-    yd = mesh_sdf(mesh, query, max_dist)
-
-    for _k in range(max_iter):
-        if yc < yd:  # yc > yd to find the maximum
-            b = d
-            d = c
-            yd = yc
-            h = invphi * h
-            c = a + invphi2 * h
-            query = (1.0 - c) * edge_a + c * edge_b
-            yc = mesh_sdf(mesh, query, max_dist)
-        else:
-            a = c
-            c = d
-            yc = yd
-            h = invphi * h
-            d = a + invphi * h
-            query = (1.0 - d) * edge_a + d * edge_b
-            yd = mesh_sdf(mesh, query, max_dist)
-
-    if yc < yd:
-        return 0.5 * (a + d)
-    return 0.5 * (c + b)
-
-
-@wp.func
-def volume_grad(volume: wp.uint64, p: wp.vec3):
-    eps = 0.05  # TODO make this a parameter
-    q = wp.volume_world_to_index(volume, p)
-
-    # compute gradient of the SDF using finite differences
-    dx = wp.volume_sample_f(volume, q + wp.vec3(eps, 0.0, 0.0), wp.Volume.LINEAR) - wp.volume_sample_f(
-        volume, q - wp.vec3(eps, 0.0, 0.0), wp.Volume.LINEAR
-    )
-    dy = wp.volume_sample_f(volume, q + wp.vec3(0.0, eps, 0.0), wp.Volume.LINEAR) - wp.volume_sample_f(
-        volume, q - wp.vec3(0.0, eps, 0.0), wp.Volume.LINEAR
-    )
-    dz = wp.volume_sample_f(volume, q + wp.vec3(0.0, 0.0, eps), wp.Volume.LINEAR) - wp.volume_sample_f(
-        volume, q - wp.vec3(0.0, 0.0, eps), wp.Volume.LINEAR
-    )
-
-    return wp.normalize(wp.vec3(dx, dy, dz))
-
-
-@wp.func
-def counter_increment(counter: wp.array(dtype=int), counter_index: int, tids: wp.array(dtype=int), tid: int):
-    # increment counter, remember which thread received which counter value
-    count = wp.atomic_add(counter, counter_index, 1)
-    tids[tid] = count
-    return count
-
-
-@wp.func_replay(counter_increment)
-def replay_counter_increment(counter: wp.array(dtype=int), counter_index: int, tids: wp.array(dtype=int), tid: int):
-    return tids[tid]
-
-
-@wp.func
-def limited_counter_increment(
-    counter: wp.array(dtype=int), counter_index: int, tids: wp.array(dtype=int), tid: int, index_limit: int
-):
-    # increment counter but only if it is smaller than index_limit, remember which thread received which counter value
-    count = wp.atomic_add(counter, counter_index, 1)
-    if count < index_limit or index_limit < 0:
-        tids[tid] = count
-        return count
-    tids[tid] = -1
-    return -1
-
-
-@wp.func_replay(limited_counter_increment)
-def replay_limited_counter_increment(
-    counter: wp.array(dtype=int), counter_index: int, tids: wp.array(dtype=int), tid: int, index_limit: int
-):
-    return tids[tid]
-
-
-@wp.kernel
-def create_soft_contacts(
-    particle_x: wp.array(dtype=wp.vec3),
-    particle_radius: wp.array(dtype=float),
-    particle_flags: wp.array(dtype=wp.uint32),
-    body_X_wb: wp.array(dtype=wp.transform),
-    shape_X_bs: wp.array(dtype=wp.transform),
-    shape_body: wp.array(dtype=int),
-    geo: ModelShapeGeometry,
-    margin: float,
-    soft_contact_max: int,
-    shape_count: int,
-    # outputs
-    soft_contact_count: wp.array(dtype=int),
-    soft_contact_particle: wp.array(dtype=int),
-    soft_contact_shape: wp.array(dtype=int),
-    soft_contact_body_pos: wp.array(dtype=wp.vec3),
-    soft_contact_body_vel: wp.array(dtype=wp.vec3),
-    soft_contact_normal: wp.array(dtype=wp.vec3),
-    soft_contact_tids: wp.array(dtype=int),
-):
-    tid = wp.tid()
-    particle_index, shape_index = tid // shape_count, tid % shape_count
-    if (particle_flags[particle_index] & PARTICLE_FLAG_ACTIVE) == 0:
-        return
-
-    rigid_index = shape_body[shape_index]
-
-    px = particle_x[particle_index]
-    radius = particle_radius[particle_index]
-
-    X_wb = wp.transform_identity()
-    if rigid_index >= 0:
-        X_wb = body_X_wb[rigid_index]
-
-    X_bs = shape_X_bs[shape_index]
-
-    X_ws = wp.transform_multiply(X_wb, X_bs)
-    X_sw = wp.transform_inverse(X_ws)
-
-    # transform particle position to shape local space
-    x_local = wp.transform_point(X_sw, px)
-
-    # geo description
-    geo_type = geo.type[shape_index]
-    geo_scale = geo.scale[shape_index]
-
-    # evaluate shape sdf
-    d = 1.0e6
-    n = wp.vec3()
-    v = wp.vec3()
-
-    if geo_type == wp.sim.GEO_SPHERE:
-        d = sphere_sdf(wp.vec3(), geo_scale[0], x_local)
-        n = sphere_sdf_grad(wp.vec3(), geo_scale[0], x_local)
-
-    if geo_type == wp.sim.GEO_BOX:
-        d = box_sdf(geo_scale, x_local)
-        n = box_sdf_grad(geo_scale, x_local)
-
-    if geo_type == wp.sim.GEO_CAPSULE:
-        d = capsule_sdf(geo_scale[0], geo_scale[1], x_local)
-        n = capsule_sdf_grad(geo_scale[0], geo_scale[1], x_local)
-
-    if geo_type == wp.sim.GEO_CYLINDER:
-        d = cylinder_sdf(geo_scale[0], geo_scale[1], x_local)
-        n = cylinder_sdf_grad(geo_scale[0], geo_scale[1], x_local)
-
-    if geo_type == wp.sim.GEO_CONE:
-        d = cone_sdf(geo_scale[0], geo_scale[1], x_local)
-        n = cone_sdf_grad(geo_scale[0], geo_scale[1], x_local)
-
-    if geo_type == wp.sim.GEO_MESH:
-        mesh = geo.source[shape_index]
-
-        face_index = int(0)
-        face_u = float(0.0)
-        face_v = float(0.0)
-        sign = float(0.0)
-
-        min_scale = wp.min(geo_scale)
-        if wp.mesh_query_point_sign_normal(
-            mesh, wp.cw_div(x_local, geo_scale), margin + radius / min_scale, sign, face_index, face_u, face_v
-        ):
-            shape_p = wp.mesh_eval_position(mesh, face_index, face_u, face_v)
-            shape_v = wp.mesh_eval_velocity(mesh, face_index, face_u, face_v)
-
-            shape_p = wp.cw_mul(shape_p, geo_scale)
-            shape_v = wp.cw_mul(shape_v, geo_scale)
-
-            delta = x_local - shape_p
-
-            d = wp.length(delta) * sign
-            n = wp.normalize(delta) * sign
-            v = shape_v
-
-    if geo_type == wp.sim.GEO_SDF:
-        volume = geo.source[shape_index]
-        xpred_local = wp.volume_world_to_index(volume, wp.cw_div(x_local, geo_scale))
-        nn = wp.vec3(0.0, 0.0, 0.0)
-        d = wp.volume_sample_grad_f(volume, xpred_local, wp.Volume.LINEAR, nn)
-        n = wp.normalize(nn)
-
-    if geo_type == wp.sim.GEO_PLANE:
-        d = plane_sdf(geo_scale[0], geo_scale[1], x_local)
-        n = wp.vec3(0.0, 1.0, 0.0)
-
-    if d < margin + radius:
-        index = counter_increment(soft_contact_count, 0, soft_contact_tids, tid)
-
-        if index < soft_contact_max:
-            # compute contact point in body local space
-            body_pos = wp.transform_point(X_bs, x_local - n * d)
-            body_vel = wp.transform_vector(X_bs, v)
-
-            world_normal = wp.transform_vector(X_ws, n)
-
-            soft_contact_shape[index] = shape_index
-            soft_contact_body_pos[index] = body_pos
-            soft_contact_body_vel[index] = body_vel
-            soft_contact_particle[index] = particle_index
-            soft_contact_normal[index] = world_normal
-
-
-@wp.kernel(enable_backward=False)
-def count_contact_points(
-    contact_pairs: wp.array(dtype=int, ndim=2),
-    geo: ModelShapeGeometry,
-    mesh_contact_max: int,
-    # outputs
-    contact_count: wp.array(dtype=int),
-):
-    tid = wp.tid()
-    shape_a = contact_pairs[tid, 0]
-    shape_b = contact_pairs[tid, 1]
-
-    if shape_b == -1:
-        actual_shape_a = shape_a
-        actual_type_a = geo.type[shape_a]
-        # ground plane
-        actual_type_b = wp.sim.GEO_PLANE
-        actual_shape_b = -1
-    else:
-        type_a = geo.type[shape_a]
-        type_b = geo.type[shape_b]
-        # unique ordering of shape pairs
-        if type_a < type_b:
-            actual_shape_a = shape_a
-            actual_shape_b = shape_b
-            actual_type_a = type_a
-            actual_type_b = type_b
-        else:
-            actual_shape_a = shape_b
-            actual_shape_b = shape_a
-            actual_type_a = type_b
-            actual_type_b = type_a
-
-    # determine how many contact points need to be evaluated
-    num_contacts = 0
-    num_actual_contacts = 0
-    if actual_type_a == wp.sim.GEO_SPHERE:
-        num_contacts = 1
-        num_actual_contacts = 1
-    elif actual_type_a == wp.sim.GEO_CAPSULE:
-        if actual_type_b == wp.sim.GEO_PLANE:
-            if geo.scale[actual_shape_b][0] == 0.0 and geo.scale[actual_shape_b][1] == 0.0:
-                num_contacts = 2  # vertex-based collision for infinite plane
-                num_actual_contacts = 2
-            else:
-                num_contacts = 2 + 4  # vertex-based collision + plane edges
-                num_actual_contacts = 2 + 4
-        elif actual_type_b == wp.sim.GEO_MESH:
-            num_contacts_a = 2
-            mesh_b = wp.mesh_get(geo.source[actual_shape_b])
-            num_contacts_b = mesh_b.points.shape[0]
-            num_contacts = num_contacts_a + num_contacts_b
-            if mesh_contact_max > 0:
-                num_contacts_b = wp.min(mesh_contact_max, num_contacts_b)
-            num_actual_contacts = num_contacts_a + num_contacts_b
-        else:
-            num_contacts = 2
-            num_actual_contacts = 2
-    elif actual_type_a == wp.sim.GEO_BOX:
-        if actual_type_b == wp.sim.GEO_BOX:
-            num_contacts = 24
-            num_actual_contacts = 24
-        elif actual_type_b == wp.sim.GEO_MESH:
-            num_contacts_a = 8
-            mesh_b = wp.mesh_get(geo.source[actual_shape_b])
-            num_contacts_b = mesh_b.points.shape[0]
-            num_contacts = num_contacts_a + num_contacts_b
-            if mesh_contact_max > 0:
-                num_contacts_b = wp.min(mesh_contact_max, num_contacts_b)
-            num_actual_contacts = num_contacts_a + num_contacts_b
-        elif actual_type_b == wp.sim.GEO_PLANE:
-            if geo.scale[actual_shape_b][0] == 0.0 and geo.scale[actual_shape_b][1] == 0.0:
-                num_contacts = 8  # vertex-based collision
-                num_actual_contacts = 8
-            else:
-                num_contacts = 8 + 4  # vertex-based collision + plane edges
-                num_actual_contacts = 8 + 4
-        else:
-            num_contacts = 8
-            num_actual_contacts = 8
-    elif actual_type_a == wp.sim.GEO_MESH:
-        mesh_a = wp.mesh_get(geo.source[actual_shape_a])
-        num_contacts_a = mesh_a.points.shape[0]
-        if mesh_contact_max > 0:
-            num_contacts_a = wp.min(mesh_contact_max, num_contacts_a)
-        if actual_type_b == wp.sim.GEO_MESH:
-            mesh_b = wp.mesh_get(geo.source[actual_shape_b])
-            num_contacts_b = mesh_b.points.shape[0]
-            num_contacts = num_contacts_a + num_contacts_b
-            if mesh_contact_max > 0:
-                num_contacts_b = wp.min(mesh_contact_max, num_contacts_b)
-        else:
-            num_contacts_b = 0
-        num_contacts = num_contacts_a + num_contacts_b
-        num_actual_contacts = num_contacts_a + num_contacts_b
-    elif actual_type_a == wp.sim.GEO_PLANE:
-        return  # no plane-plane contacts
-    else:
-        wp.printf(
-            "count_contact_points: unsupported geometry type combination %d and %d\n", actual_type_a, actual_type_b
-        )
-
-    wp.atomic_add(contact_count, 0, num_contacts)
-    wp.atomic_add(contact_count, 1, num_actual_contacts)
-
-
-@wp.kernel(enable_backward=False)
-def broadphase_collision_pairs(
-    contact_pairs: wp.array(dtype=int, ndim=2),
-    body_q: wp.array(dtype=wp.transform),
-    shape_X_bs: wp.array(dtype=wp.transform),
-    shape_body: wp.array(dtype=int),
-    body_mass: wp.array(dtype=float),
-    num_shapes: int,
-    geo: ModelShapeGeometry,
-    collision_radius: wp.array(dtype=float),
-    rigid_contact_max: int,
-    rigid_contact_margin: float,
-    mesh_contact_max: int,
-    iterate_mesh_vertices: bool,
-    # outputs
-    contact_count: wp.array(dtype=int),
-    contact_shape0: wp.array(dtype=int),
-    contact_shape1: wp.array(dtype=int),
-    contact_point_id: wp.array(dtype=int),
-    contact_point_limit: wp.array(dtype=int),
-):
-    tid = wp.tid()
-    shape_a = contact_pairs[tid, 0]
-    shape_b = contact_pairs[tid, 1]
-
-    mass_a = 0.0
-    mass_b = 0.0
-    rigid_a = shape_body[shape_a]
-    if rigid_a == -1:
-        X_ws_a = shape_X_bs[shape_a]
-    else:
-        X_ws_a = wp.transform_multiply(body_q[rigid_a], shape_X_bs[shape_a])
-        mass_a = body_mass[rigid_a]
-    rigid_b = shape_body[shape_b]
-    if rigid_b == -1:
-        X_ws_b = shape_X_bs[shape_b]
-    else:
-        X_ws_b = wp.transform_multiply(body_q[rigid_b], shape_X_bs[shape_b])
-        mass_b = body_mass[rigid_b]
-    if mass_a == 0.0 and mass_b == 0.0:
-        # skip if both bodies are static
-        return
-
-    type_a = geo.type[shape_a]
-    type_b = geo.type[shape_b]
-    # unique ordering of shape pairs
-    if type_a < type_b:
-        actual_shape_a = shape_a
-        actual_shape_b = shape_b
-        actual_type_a = type_a
-        actual_type_b = type_b
-        actual_X_ws_a = X_ws_a
-        actual_X_ws_b = X_ws_b
-    else:
-        actual_shape_a = shape_b
-        actual_shape_b = shape_a
-        actual_type_a = type_b
-        actual_type_b = type_a
-        actual_X_ws_a = X_ws_b
-        actual_X_ws_b = X_ws_a
-
-    p_a = wp.transform_get_translation(actual_X_ws_a)
-    if actual_type_b == wp.sim.GEO_PLANE:
-        if actual_type_a == wp.sim.GEO_PLANE:
-            return
-        query_b = wp.transform_point(wp.transform_inverse(actual_X_ws_b), p_a)
-        scale = geo.scale[actual_shape_b]
-        closest = closest_point_plane(scale[0], scale[1], query_b)
-        d = wp.length(query_b - closest)
-        r_a = collision_radius[actual_shape_a]
-        if d > r_a + rigid_contact_margin:
-            return
-    else:
-        p_b = wp.transform_get_translation(actual_X_ws_b)
-        d = wp.length(p_a - p_b) * 0.5 - 0.1
-        r_a = collision_radius[actual_shape_a]
-        r_b = collision_radius[actual_shape_b]
-        if d > r_a + r_b + rigid_contact_margin:
-            return
-
-    pair_index_ab = actual_shape_a * num_shapes + actual_shape_b
-    pair_index_ba = actual_shape_b * num_shapes + actual_shape_a
-
-    # determine how many contact points need to be evaluated
-    num_contacts = 0
-    if actual_type_a == wp.sim.GEO_SPHERE:
-        num_contacts = 1
-    elif actual_type_a == wp.sim.GEO_CAPSULE:
-        if actual_type_b == wp.sim.GEO_PLANE:
-            if geo.scale[actual_shape_b][0] == 0.0 and geo.scale[actual_shape_b][1] == 0.0:
-                num_contacts = 2  # vertex-based collision for infinite plane
-            else:
-                num_contacts = 2 + 4  # vertex-based collision + plane edges
-        elif actual_type_b == wp.sim.GEO_MESH:
-            num_contacts_a = 2
-            mesh_b = wp.mesh_get(geo.source[actual_shape_b])
-            if iterate_mesh_vertices:
-                num_contacts_b = mesh_b.points.shape[0]
-            else:
-                num_contacts_b = 0
-            num_contacts = num_contacts_a + num_contacts_b
-            index = wp.atomic_add(contact_count, 0, num_contacts)
-            if index + num_contacts - 1 >= rigid_contact_max:
-                print("Number of rigid contacts exceeded limit. Increase Model.rigid_contact_max.")
-                return
-            # allocate contact points from capsule A against mesh B
-            for i in range(num_contacts_a):
-                contact_shape0[index + i] = actual_shape_a
-                contact_shape1[index + i] = actual_shape_b
-                contact_point_id[index + i] = i
-            # allocate contact points from mesh B against capsule A
-            for i in range(num_contacts_b):
-                contact_shape0[index + num_contacts_a + i] = actual_shape_b
-                contact_shape1[index + num_contacts_a + i] = actual_shape_a
-                contact_point_id[index + num_contacts_a + i] = i
-            if mesh_contact_max > 0 and contact_point_limit and pair_index_ba < contact_point_limit.shape[0]:
-                num_contacts_b = wp.min(mesh_contact_max, num_contacts_b)
-                contact_point_limit[pair_index_ba] = num_contacts_b
-            return
-        else:
-            num_contacts = 2
-    elif actual_type_a == wp.sim.GEO_BOX:
-        if actual_type_b == wp.sim.GEO_BOX:
-            index = wp.atomic_add(contact_count, 0, 24)
-            if index + 23 >= rigid_contact_max:
-                print("Number of rigid contacts exceeded limit. Increase Model.rigid_contact_max.")
-                return
-            # allocate contact points from box A against B
-            for i in range(12):  # 12 edges
-                contact_shape0[index + i] = shape_a
-                contact_shape1[index + i] = shape_b
-                contact_point_id[index + i] = i
-            # allocate contact points from box B against A
-            for i in range(12):
-                contact_shape0[index + 12 + i] = shape_b
-                contact_shape1[index + 12 + i] = shape_a
-                contact_point_id[index + 12 + i] = i
-            return
-        elif actual_type_b == wp.sim.GEO_MESH:
-            num_contacts_a = 8
-            mesh_b = wp.mesh_get(geo.source[actual_shape_b])
-            if iterate_mesh_vertices:
-                num_contacts_b = mesh_b.points.shape[0]
-            else:
-                num_contacts_b = 0
-            num_contacts = num_contacts_a + num_contacts_b
-            index = wp.atomic_add(contact_count, 0, num_contacts)
-            if index + num_contacts - 1 >= rigid_contact_max:
-                print("Number of rigid contacts exceeded limit. Increase Model.rigid_contact_max.")
-                return
-            # allocate contact points from box A against mesh B
-            for i in range(num_contacts_a):
-                contact_shape0[index + i] = actual_shape_a
-                contact_shape1[index + i] = actual_shape_b
-                contact_point_id[index + i] = i
-            # allocate contact points from mesh B against box A
-            for i in range(num_contacts_b):
-                contact_shape0[index + num_contacts_a + i] = actual_shape_b
-                contact_shape1[index + num_contacts_a + i] = actual_shape_a
-                contact_point_id[index + num_contacts_a + i] = i
-
-            if mesh_contact_max > 0 and contact_point_limit and pair_index_ba < contact_point_limit.shape[0]:
-                num_contacts_b = wp.min(mesh_contact_max, num_contacts_b)
-                contact_point_limit[pair_index_ba] = num_contacts_b
-            return
-        elif actual_type_b == wp.sim.GEO_PLANE:
-            if geo.scale[actual_shape_b][0] == 0.0 and geo.scale[actual_shape_b][1] == 0.0:
-                num_contacts = 8  # vertex-based collision
-            else:
-                num_contacts = 8 + 4  # vertex-based collision + plane edges
-        else:
-            num_contacts = 8
-    elif actual_type_a == wp.sim.GEO_MESH:
-        mesh_a = wp.mesh_get(geo.source[actual_shape_a])
-        num_contacts_a = mesh_a.points.shape[0]
-        num_contacts_b = 0
-        if actual_type_b == wp.sim.GEO_MESH:
-            mesh_b = wp.mesh_get(geo.source[actual_shape_b])
-            num_contacts_b = mesh_b.points.shape[0]
-        elif actual_type_b != wp.sim.GEO_PLANE:
-            print("broadphase_collision_pairs: unsupported geometry type for mesh collision")
-            return
-        num_contacts = num_contacts_a + num_contacts_b
-        if num_contacts > 0:
-            index = wp.atomic_add(contact_count, 0, num_contacts)
-            if index + num_contacts - 1 >= rigid_contact_max:
-                print("Mesh contact: Number of rigid contacts exceeded limit. Increase Model.rigid_contact_max.")
-                return
-            # allocate contact points from mesh A against B
-            for i in range(num_contacts_a):
-                contact_shape0[index + i] = actual_shape_a
-                contact_shape1[index + i] = actual_shape_b
-                contact_point_id[index + i] = i
-            # allocate contact points from mesh B against A
-            for i in range(num_contacts_b):
-                contact_shape0[index + num_contacts_a + i] = actual_shape_b
-                contact_shape1[index + num_contacts_a + i] = actual_shape_a
-                contact_point_id[index + num_contacts_a + i] = i
-
-            if mesh_contact_max > 0 and contact_point_limit:
-                num_contacts_a = wp.min(mesh_contact_max, num_contacts_a)
-                num_contacts_b = wp.min(mesh_contact_max, num_contacts_b)
-                if pair_index_ab < contact_point_limit.shape[0]:
-                    contact_point_limit[pair_index_ab] = num_contacts_a
-                if pair_index_ba < contact_point_limit.shape[0]:
-                    contact_point_limit[pair_index_ba] = num_contacts_b
-        return
-    elif actual_type_a == wp.sim.GEO_PLANE:
-        return  # no plane-plane contacts
-    else:
-        print("broadphase_collision_pairs: unsupported geometry type")
-
-    if num_contacts > 0:
-        index = wp.atomic_add(contact_count, 0, num_contacts)
-        if index + num_contacts - 1 >= rigid_contact_max:
-            print("Number of rigid contacts exceeded limit. Increase Model.rigid_contact_max.")
-            return
-        # allocate contact points
-        for i in range(num_contacts):
-            cp_index = index + i
-            contact_shape0[cp_index] = actual_shape_a
-            contact_shape1[cp_index] = actual_shape_b
-            contact_point_id[cp_index] = i
-        if contact_point_limit:
-            if pair_index_ab < contact_point_limit.shape[0]:
-                contact_point_limit[pair_index_ab] = num_contacts
-            if pair_index_ba < contact_point_limit.shape[0]:
-                contact_point_limit[pair_index_ba] = 0
-
-
-@wp.kernel
-def handle_contact_pairs(
-    body_q: wp.array(dtype=wp.transform),
-    shape_X_bs: wp.array(dtype=wp.transform),
-    shape_body: wp.array(dtype=int),
-    geo: ModelShapeGeometry,
-    rigid_contact_margin: float,
-    contact_broad_shape0: wp.array(dtype=int),
-    contact_broad_shape1: wp.array(dtype=int),
-    num_shapes: int,
-    contact_point_id: wp.array(dtype=int),
-    contact_point_limit: wp.array(dtype=int),
-    edge_sdf_iter: int,
-    # outputs
-    contact_count: wp.array(dtype=int),
-    contact_shape0: wp.array(dtype=int),
-    contact_shape1: wp.array(dtype=int),
-    contact_point0: wp.array(dtype=wp.vec3),
-    contact_point1: wp.array(dtype=wp.vec3),
-    contact_offset0: wp.array(dtype=wp.vec3),
-    contact_offset1: wp.array(dtype=wp.vec3),
-    contact_normal: wp.array(dtype=wp.vec3),
-    contact_thickness: wp.array(dtype=float),
-    contact_pairwise_counter: wp.array(dtype=int),
-    contact_tids: wp.array(dtype=int),
-):
-    tid = wp.tid()
-    shape_a = contact_broad_shape0[tid]
-    shape_b = contact_broad_shape1[tid]
-    if shape_a == shape_b:
-        return
-
-    if contact_point_limit:
-        pair_index = shape_a * num_shapes + shape_b
-        contact_limit = contact_point_limit[pair_index]
-        if contact_pairwise_counter[pair_index] >= contact_limit:
-            # reached limit of contact points per contact pair
-            return
-
-    point_id = contact_point_id[tid]
-
-    rigid_a = shape_body[shape_a]
-    X_wb_a = wp.transform_identity()
-    if rigid_a >= 0:
-        X_wb_a = body_q[rigid_a]
-    X_bs_a = shape_X_bs[shape_a]
-    X_ws_a = wp.transform_multiply(X_wb_a, X_bs_a)
-    X_sw_a = wp.transform_inverse(X_ws_a)
-    X_bw_a = wp.transform_inverse(X_wb_a)
-    geo_type_a = geo.type[shape_a]
-    geo_scale_a = geo.scale[shape_a]
-    min_scale_a = min(geo_scale_a)
-    thickness_a = geo.thickness[shape_a]
-    # is_solid_a = geo.is_solid[shape_a]
-
-    rigid_b = shape_body[shape_b]
-    X_wb_b = wp.transform_identity()
-    if rigid_b >= 0:
-        X_wb_b = body_q[rigid_b]
-    X_bs_b = shape_X_bs[shape_b]
-    X_ws_b = wp.transform_multiply(X_wb_b, X_bs_b)
-    X_sw_b = wp.transform_inverse(X_ws_b)
-    X_bw_b = wp.transform_inverse(X_wb_b)
-    geo_type_b = geo.type[shape_b]
-    geo_scale_b = geo.scale[shape_b]
-    min_scale_b = min(geo_scale_b)
-    thickness_b = geo.thickness[shape_b]
-    # is_solid_b = geo.is_solid[shape_b]
-
-    distance = 1.0e6
-    u = float(0.0)
-    thickness = thickness_a + thickness_b
-
-    if geo_type_a == wp.sim.GEO_SPHERE:
-        p_a_world = wp.transform_get_translation(X_ws_a)
-        if geo_type_b == wp.sim.GEO_SPHERE:
-            p_b_world = wp.transform_get_translation(X_ws_b)
-        elif geo_type_b == wp.sim.GEO_BOX:
-            # contact point in frame of body B
-            p_a_body = wp.transform_point(X_sw_b, p_a_world)
-            p_b_body = closest_point_box(geo_scale_b, p_a_body)
-            p_b_world = wp.transform_point(X_ws_b, p_b_body)
-        elif geo_type_b == wp.sim.GEO_CAPSULE:
-            half_height_b = geo_scale_b[1]
-            # capsule B
-            A_b = wp.transform_point(X_ws_b, wp.vec3(0.0, half_height_b, 0.0))
-            B_b = wp.transform_point(X_ws_b, wp.vec3(0.0, -half_height_b, 0.0))
-            p_b_world = closest_point_line_segment(A_b, B_b, p_a_world)
-        elif geo_type_b == wp.sim.GEO_MESH:
-            mesh_b = geo.source[shape_b]
-            query_b_local = wp.transform_point(X_sw_b, p_a_world)
-            face_index = int(0)
-            face_u = float(0.0)
-            face_v = float(0.0)
-            sign = float(0.0)
-            max_dist = (thickness + rigid_contact_margin) / min_scale_b
-            res = wp.mesh_query_point_sign_normal(
-                mesh_b, wp.cw_div(query_b_local, geo_scale_b), max_dist, sign, face_index, face_u, face_v
-            )
-            if res:
-                shape_p = wp.mesh_eval_position(mesh_b, face_index, face_u, face_v)
-                shape_p = wp.cw_mul(shape_p, geo_scale_b)
-                p_b_world = wp.transform_point(X_ws_b, shape_p)
-            else:
-                return
-        elif geo_type_b == wp.sim.GEO_PLANE:
-            p_b_body = closest_point_plane(geo_scale_b[0], geo_scale_b[1], wp.transform_point(X_sw_b, p_a_world))
-            p_b_world = wp.transform_point(X_ws_b, p_b_body)
-        else:
-            print("Unsupported geometry type in sphere collision handling")
-            print(geo_type_b)
-            return
-        diff = p_a_world - p_b_world
-        normal = wp.normalize(diff)
-        distance = wp.dot(diff, normal)
-
-    elif geo_type_a == wp.sim.GEO_BOX and geo_type_b == wp.sim.GEO_BOX:
-        # edge-based box contact
-        edge = get_box_edge(point_id, geo_scale_a)
-        edge0_world = wp.transform_point(X_ws_a, wp.spatial_top(edge))
-        edge1_world = wp.transform_point(X_ws_a, wp.spatial_bottom(edge))
-        edge0_b = wp.transform_point(X_sw_b, edge0_world)
-        edge1_b = wp.transform_point(X_sw_b, edge1_world)
-        max_iter = edge_sdf_iter
-        u = closest_edge_coordinate_box(geo_scale_b, edge0_b, edge1_b, max_iter)
-        p_a_world = (1.0 - u) * edge0_world + u * edge1_world
-
-        # find closest point + contact normal on box B
-        query_b = wp.transform_point(X_sw_b, p_a_world)
-        p_b_body = closest_point_box(geo_scale_b, query_b)
-        p_b_world = wp.transform_point(X_ws_b, p_b_body)
-        diff = p_a_world - p_b_world
-
-        normal = wp.transform_vector(X_ws_b, box_sdf_grad(geo_scale_b, query_b))
-        distance = wp.dot(diff, normal)
-
-    elif geo_type_a == wp.sim.GEO_BOX and geo_type_b == wp.sim.GEO_CAPSULE:
-        half_height_b = geo_scale_b[1]
-        # capsule B
-        # depending on point id, we query an edge from 0 to 0.5 or 0.5 to 1
-        e0 = wp.vec3(0.0, -half_height_b * float(point_id % 2), 0.0)
-        e1 = wp.vec3(0.0, half_height_b * float((point_id + 1) % 2), 0.0)
-        edge0_world = wp.transform_point(X_ws_b, e0)
-        edge1_world = wp.transform_point(X_ws_b, e1)
-        edge0_a = wp.transform_point(X_sw_a, edge0_world)
-        edge1_a = wp.transform_point(X_sw_a, edge1_world)
-        max_iter = edge_sdf_iter
-        u = closest_edge_coordinate_box(geo_scale_a, edge0_a, edge1_a, max_iter)
-        p_b_world = (1.0 - u) * edge0_world + u * edge1_world
-        # find closest point + contact normal on box A
-        query_a = wp.transform_point(X_sw_a, p_b_world)
-        p_a_body = closest_point_box(geo_scale_a, query_a)
-        p_a_world = wp.transform_point(X_ws_a, p_a_body)
-        diff = p_a_world - p_b_world
-        # the contact point inside the capsule should already be outside the box
-        normal = -wp.transform_vector(X_ws_a, box_sdf_grad(geo_scale_a, query_a))
-        distance = wp.dot(diff, normal)
-
-    elif geo_type_a == wp.sim.GEO_BOX and geo_type_b == wp.sim.GEO_PLANE:
-        plane_width = geo_scale_b[0]
-        plane_length = geo_scale_b[1]
-        if point_id < 8:
-            # vertex-based contact
-            p_a_body = get_box_vertex(point_id, geo_scale_a)
-            p_a_world = wp.transform_point(X_ws_a, p_a_body)
-            query_b = wp.transform_point(X_sw_b, p_a_world)
-            p_b_body = closest_point_plane(plane_width, plane_length, query_b)
-            p_b_world = wp.transform_point(X_ws_b, p_b_body)
-            diff = p_a_world - p_b_world
-            normal = wp.transform_vector(X_ws_b, wp.vec3(0.0, 1.0, 0.0))
-            if plane_width > 0.0 and plane_length > 0.0:
-                if wp.abs(query_b[0]) > plane_width or wp.abs(query_b[2]) > plane_length:
-                    # skip, we will evaluate the plane edge contact with the box later
-                    return
-                # check whether the COM is above the plane
-                # sign = wp.sign(wp.dot(wp.transform_get_translation(X_ws_a) - p_b_world, normal))
-                # if sign < 0.0:
-                #     # the entire box is most likely below the plane
-                #     return
-            # the contact point is within plane boundaries
-            distance = wp.dot(diff, normal)
-        else:
-            # contact between box A and edges of finite plane B
-            edge = get_plane_edge(point_id - 8, plane_width, plane_length)
-            edge0_world = wp.transform_point(X_ws_b, wp.spatial_top(edge))
-            edge1_world = wp.transform_point(X_ws_b, wp.spatial_bottom(edge))
-            edge0_a = wp.transform_point(X_sw_a, edge0_world)
-            edge1_a = wp.transform_point(X_sw_a, edge1_world)
-            max_iter = edge_sdf_iter
-            u = closest_edge_coordinate_box(geo_scale_a, edge0_a, edge1_a, max_iter)
-            p_b_world = (1.0 - u) * edge0_world + u * edge1_world
-
-            # find closest point + contact normal on box A
-            query_a = wp.transform_point(X_sw_a, p_b_world)
-            p_a_body = closest_point_box(geo_scale_a, query_a)
-            p_a_world = wp.transform_point(X_ws_a, p_a_body)
-            query_b = wp.transform_point(X_sw_b, p_a_world)
-            if wp.abs(query_b[0]) > plane_width or wp.abs(query_b[2]) > plane_length:
-                # ensure that the closest point is actually inside the plane
-                return
-            diff = p_a_world - p_b_world
-            com_a = wp.transform_get_translation(X_ws_a)
-            query_b = wp.transform_point(X_sw_b, com_a)
-            if wp.abs(query_b[0]) > plane_width or wp.abs(query_b[2]) > plane_length:
-                # the COM is outside the plane
-                normal = wp.normalize(com_a - p_b_world)
-            else:
-                normal = wp.transform_vector(X_ws_b, wp.vec3(0.0, 1.0, 0.0))
-            distance = wp.dot(diff, normal)
-
-    elif geo_type_a == wp.sim.GEO_CAPSULE and geo_type_b == wp.sim.GEO_CAPSULE:
-        # find closest edge coordinate to capsule SDF B
-        half_height_a = geo_scale_a[1]
-        half_height_b = geo_scale_b[1]
-        # edge from capsule A
-        # depending on point id, we query an edge from 0 to 0.5 or 0.5 to 1
-        e0 = wp.vec3(0.0, half_height_a * float(point_id % 2), 0.0)
-        e1 = wp.vec3(0.0, -half_height_a * float((point_id + 1) % 2), 0.0)
-        edge0_world = wp.transform_point(X_ws_a, e0)
-        edge1_world = wp.transform_point(X_ws_a, e1)
-        edge0_b = wp.transform_point(X_sw_b, edge0_world)
-        edge1_b = wp.transform_point(X_sw_b, edge1_world)
-        max_iter = edge_sdf_iter
-        u = closest_edge_coordinate_capsule(geo_scale_b[0], geo_scale_b[1], edge0_b, edge1_b, max_iter)
-        p_a_world = (1.0 - u) * edge0_world + u * edge1_world
-        p0_b_world = wp.transform_point(X_ws_b, wp.vec3(0.0, half_height_b, 0.0))
-        p1_b_world = wp.transform_point(X_ws_b, wp.vec3(0.0, -half_height_b, 0.0))
-        p_b_world = closest_point_line_segment(p0_b_world, p1_b_world, p_a_world)
-        diff = p_a_world - p_b_world
-        normal = wp.normalize(diff)
-        distance = wp.dot(diff, normal)
-
-    elif geo_type_a == wp.sim.GEO_CAPSULE and geo_type_b == wp.sim.GEO_MESH:
-        # find closest edge coordinate to mesh SDF B
-        half_height_a = geo_scale_a[1]
-        # edge from capsule A
-        # depending on point id, we query an edge from -h to 0 or 0 to h
-        e0 = wp.vec3(0.0, -half_height_a * float(point_id % 2), 0.0)
-        e1 = wp.vec3(0.0, half_height_a * float((point_id + 1) % 2), 0.0)
-        edge0_world = wp.transform_point(X_ws_a, e0)
-        edge1_world = wp.transform_point(X_ws_a, e1)
-        edge0_b = wp.transform_point(X_sw_b, edge0_world)
-        edge1_b = wp.transform_point(X_sw_b, edge1_world)
-        max_iter = edge_sdf_iter
-        max_dist = (rigid_contact_margin + thickness) / min_scale_b
-        mesh_b = geo.source[shape_b]
-        u = closest_edge_coordinate_mesh(
-            mesh_b, wp.cw_div(edge0_b, geo_scale_b), wp.cw_div(edge1_b, geo_scale_b), max_iter, max_dist
-        )
-        p_a_world = (1.0 - u) * edge0_world + u * edge1_world
-        query_b_local = wp.transform_point(X_sw_b, p_a_world)
-        mesh_b = geo.source[shape_b]
-
-        face_index = int(0)
-        face_u = float(0.0)
-        face_v = float(0.0)
-        sign = float(0.0)
-        res = wp.mesh_query_point_sign_normal(
-            mesh_b, wp.cw_div(query_b_local, geo_scale_b), max_dist, sign, face_index, face_u, face_v
-        )
-        if res:
-            shape_p = wp.mesh_eval_position(mesh_b, face_index, face_u, face_v)
-            shape_p = wp.cw_mul(shape_p, geo_scale_b)
-            p_b_world = wp.transform_point(X_ws_b, shape_p)
-            p_a_world = closest_point_line_segment(edge0_world, edge1_world, p_b_world)
-            # contact direction vector in world frame
-            diff = p_a_world - p_b_world
-            normal = wp.normalize(diff)
-            distance = wp.dot(diff, normal)
-        else:
-            return
-
-    elif geo_type_a == wp.sim.GEO_MESH and geo_type_b == wp.sim.GEO_CAPSULE:
-        # vertex-based contact
-        mesh = wp.mesh_get(geo.source[shape_a])
-        body_a_pos = wp.cw_mul(mesh.points[point_id], geo_scale_a)
-        p_a_world = wp.transform_point(X_ws_a, body_a_pos)
-        # find closest point + contact normal on capsule B
-        half_height_b = geo_scale_b[1]
-        A_b = wp.transform_point(X_ws_b, wp.vec3(0.0, half_height_b, 0.0))
-        B_b = wp.transform_point(X_ws_b, wp.vec3(0.0, -half_height_b, 0.0))
-        p_b_world = closest_point_line_segment(A_b, B_b, p_a_world)
-        diff = p_a_world - p_b_world
-        # this is more reliable in practice than using the SDF gradient
-        normal = wp.normalize(diff)
-        distance = wp.dot(diff, normal)
-
-    elif geo_type_a == wp.sim.GEO_CAPSULE and geo_type_b == wp.sim.GEO_PLANE:
-        plane_width = geo_scale_b[0]
-        plane_length = geo_scale_b[1]
-        if point_id < 2:
-            # vertex-based collision
-            half_height_a = geo_scale_a[1]
-            side = float(point_id) * 2.0 - 1.0
-            p_a_world = wp.transform_point(X_ws_a, wp.vec3(0.0, side * half_height_a, 0.0))
-            query_b = wp.transform_point(X_sw_b, p_a_world)
-            p_b_body = closest_point_plane(geo_scale_b[0], geo_scale_b[1], query_b)
-            p_b_world = wp.transform_point(X_ws_b, p_b_body)
-            diff = p_a_world - p_b_world
-            if geo_scale_b[0] > 0.0 and geo_scale_b[1] > 0.0:
-                normal = wp.normalize(diff)
-            else:
-                normal = wp.transform_vector(X_ws_b, wp.vec3(0.0, 1.0, 0.0))
-            distance = wp.dot(diff, normal)
-        else:
-            # contact between capsule A and edges of finite plane B
-            plane_width = geo_scale_b[0]
-            plane_length = geo_scale_b[1]
-            edge = get_plane_edge(point_id - 2, plane_width, plane_length)
-            edge0_world = wp.transform_point(X_ws_b, wp.spatial_top(edge))
-            edge1_world = wp.transform_point(X_ws_b, wp.spatial_bottom(edge))
-            edge0_a = wp.transform_point(X_sw_a, edge0_world)
-            edge1_a = wp.transform_point(X_sw_a, edge1_world)
-            max_iter = edge_sdf_iter
-            u = closest_edge_coordinate_capsule(geo_scale_a[0], geo_scale_a[1], edge0_a, edge1_a, max_iter)
-            p_b_world = (1.0 - u) * edge0_world + u * edge1_world
-
-            # find closest point + contact normal on capsule A
-            half_height_a = geo_scale_a[1]
-            p0_a_world = wp.transform_point(X_ws_a, wp.vec3(0.0, half_height_a, 0.0))
-            p1_a_world = wp.transform_point(X_ws_a, wp.vec3(0.0, -half_height_a, 0.0))
-            p_a_world = closest_point_line_segment(p0_a_world, p1_a_world, p_b_world)
-            diff = p_a_world - p_b_world
-            # normal = wp.transform_vector(X_ws_b, wp.vec3(0.0, 1.0, 0.0))
-            normal = wp.normalize(diff)
-            distance = wp.dot(diff, normal)
-
-    elif geo_type_a == wp.sim.GEO_MESH and geo_type_b == wp.sim.GEO_BOX:
-        # vertex-based contact
-        mesh = wp.mesh_get(geo.source[shape_a])
-        body_a_pos = wp.cw_mul(mesh.points[point_id], geo_scale_a)
-        p_a_world = wp.transform_point(X_ws_a, body_a_pos)
-        # find closest point + contact normal on box B
-        query_b = wp.transform_point(X_sw_b, p_a_world)
-        p_b_body = closest_point_box(geo_scale_b, query_b)
-        p_b_world = wp.transform_point(X_ws_b, p_b_body)
-        diff = p_a_world - p_b_world
-        # this is more reliable in practice than using the SDF gradient
-        normal = wp.normalize(diff)
-        if box_sdf(geo_scale_b, query_b) < 0.0:
-            normal = -normal
-        distance = wp.dot(diff, normal)
-
-    elif geo_type_a == wp.sim.GEO_BOX and geo_type_b == wp.sim.GEO_MESH:
-        # vertex-based contact
-        query_a = get_box_vertex(point_id, geo_scale_a)
-        p_a_world = wp.transform_point(X_ws_a, query_a)
-        query_b_local = wp.transform_point(X_sw_b, p_a_world)
-        mesh_b = geo.source[shape_b]
-        max_dist = (rigid_contact_margin + thickness) / min_scale_b
-        face_index = int(0)
-        face_u = float(0.0)
-        face_v = float(0.0)
-        sign = float(0.0)
-        res = wp.mesh_query_point_sign_normal(
-            mesh_b, wp.cw_div(query_b_local, geo_scale_b), max_dist, sign, face_index, face_u, face_v
-        )
-
-        if res:
-            shape_p = wp.mesh_eval_position(mesh_b, face_index, face_u, face_v)
-            shape_p = wp.cw_mul(shape_p, geo_scale_b)
-            p_b_world = wp.transform_point(X_ws_b, shape_p)
-            # contact direction vector in world frame
-            diff_b = p_a_world - p_b_world
-            normal = wp.normalize(diff_b) * sign
-            distance = wp.dot(diff_b, normal)
-        else:
-            return
-
-    elif geo_type_a == wp.sim.GEO_MESH and geo_type_b == wp.sim.GEO_MESH:
-        # vertex-based contact
-        mesh = wp.mesh_get(geo.source[shape_a])
-        mesh_b = geo.source[shape_b]
-
-        body_a_pos = wp.cw_mul(mesh.points[point_id], geo_scale_a)
-        p_a_world = wp.transform_point(X_ws_a, body_a_pos)
-        query_b_local = wp.transform_point(X_sw_b, p_a_world)
-
-        face_index = int(0)
-        face_u = float(0.0)
-        face_v = float(0.0)
-        sign = float(0.0)
-        min_scale = min(min_scale_a, min_scale_b)
-        max_dist = (rigid_contact_margin + thickness) / min_scale
-
-        res = wp.mesh_query_point_sign_normal(
-            mesh_b, wp.cw_div(query_b_local, geo_scale_b), max_dist, sign, face_index, face_u, face_v
-        )
-
-        if res:
-            shape_p = wp.mesh_eval_position(mesh_b, face_index, face_u, face_v)
-            shape_p = wp.cw_mul(shape_p, geo_scale_b)
-            p_b_world = wp.transform_point(X_ws_b, shape_p)
-            # contact direction vector in world frame
-            diff_b = p_a_world - p_b_world
-            normal = wp.normalize(diff_b) * sign
-            distance = wp.dot(diff_b, normal)
-        else:
-            return
-
-    elif geo_type_a == wp.sim.GEO_MESH and geo_type_b == wp.sim.GEO_PLANE:
-        # vertex-based contact
-        mesh = wp.mesh_get(geo.source[shape_a])
-        body_a_pos = wp.cw_mul(mesh.points[point_id], geo_scale_a)
-        p_a_world = wp.transform_point(X_ws_a, body_a_pos)
-        query_b = wp.transform_point(X_sw_b, p_a_world)
-        p_b_body = closest_point_plane(geo_scale_b[0], geo_scale_b[1], query_b)
-        p_b_world = wp.transform_point(X_ws_b, p_b_body)
-        diff = p_a_world - p_b_world
-
-        # if the plane is infinite or the point is within the plane we fix the normal to prevent intersections
-        if (geo_scale_b[0] == 0.0 and geo_scale_b[1] == 0.0) or (
-            wp.abs(query_b[0]) < geo_scale_b[0] and wp.abs(query_b[2]) < geo_scale_b[1]
-        ):
-            normal = wp.transform_vector(X_ws_b, wp.vec3(0.0, 1.0, 0.0))
-            distance = wp.dot(diff, normal)
-        else:
-            normal = wp.normalize(diff)
-            distance = wp.dot(diff, normal)
-            # ignore extreme penetrations (e.g. when mesh is below the plane)
-            if distance < -rigid_contact_margin:
-                return
-
-    else:
-        print("Unsupported geometry pair in collision handling")
-        return
-
-    d = distance - thickness
-    if d < rigid_contact_margin:
-        if contact_pairwise_counter:
-            pair_contact_id = limited_counter_increment(
-                contact_pairwise_counter, pair_index, contact_tids, tid, contact_limit
-            )
-            if pair_contact_id == -1:
-                # wp.printf("Reached contact point limit %d >= %d for shape pair %d and %d (pair_index: %d)\n",
-                #           contact_pairwise_counter[pair_index], contact_limit, shape_a, shape_b, pair_index)
-                # reached contact point limit
-                return
-        index = counter_increment(contact_count, 0, contact_tids, tid)
-        if index == -1:
-            return
-        contact_shape0[index] = shape_a
-        contact_shape1[index] = shape_b
-        # transform from world into body frame (so the contact point includes the shape transform)
-        contact_point0[index] = wp.transform_point(X_bw_a, p_a_world)
-        contact_point1[index] = wp.transform_point(X_bw_b, p_b_world)
-        contact_offset0[index] = wp.transform_vector(X_bw_a, -thickness_a * normal)
-        contact_offset1[index] = wp.transform_vector(X_bw_b, thickness_b * normal)
-        contact_normal[index] = normal
-        contact_thickness[index] = thickness
-
-
-def collide(
-    model: Model,
-    state: State,
-    edge_sdf_iter: int = 10,
-    iterate_mesh_vertices: bool = True,
-    requires_grad: Optional[bool] = None,
-) -> None:
-    """Generate contact points for the particles and rigid bodies in the model for use in contact-dynamics kernels.
-
-    Args:
-        model: The model to be simulated.
-        state: The state of the model.
-        edge_sdf_iter: Number of search iterations for finding closest contact points between edges and SDF.
-        iterate_mesh_vertices: Whether to iterate over all vertices of a mesh for contact generation
-            (used for capsule/box <> mesh collision).
-        requires_grad: Whether to duplicate contact arrays for gradient computation
-            (if ``None``, uses ``model.requires_grad``).
-    """
-
-    if requires_grad is None:
-        requires_grad = model.requires_grad
-
-    with wp.ScopedTimer("collide", False):
-        # generate soft contacts for particles and shapes except ground plane (last shape)
-        if model.particle_count and model.shape_count > 1:
-            if requires_grad:
-                model.soft_contact_body_pos = wp.empty_like(model.soft_contact_body_pos)
-                model.soft_contact_body_vel = wp.empty_like(model.soft_contact_body_vel)
-                model.soft_contact_normal = wp.empty_like(model.soft_contact_normal)
-            # clear old count
-            model.soft_contact_count.zero_()
-            wp.launch(
-                kernel=create_soft_contacts,
-                dim=model.particle_count * (model.shape_count - 1),
-                inputs=[
-                    state.particle_q,
-                    model.particle_radius,
-                    model.particle_flags,
-                    state.body_q,
-                    model.shape_transform,
-                    model.shape_body,
-                    model.shape_geo,
-                    model.soft_contact_margin,
-                    model.soft_contact_max,
-                    model.shape_count - 1,
-                ],
-                outputs=[
-                    model.soft_contact_count,
-                    model.soft_contact_particle,
-                    model.soft_contact_shape,
-                    model.soft_contact_body_pos,
-                    model.soft_contact_body_vel,
-                    model.soft_contact_normal,
-                    model.soft_contact_tids,
-                ],
-                device=model.device,
-            )
-
-        if model.shape_contact_pair_count or (model.ground and model.shape_ground_contact_pair_count):
-            # clear old count
-            model.rigid_contact_count.zero_()
-
-            model.rigid_contact_broad_shape0.fill_(-1)
-            model.rigid_contact_broad_shape1.fill_(-1)
-
-        if model.shape_contact_pair_count:
-            wp.launch(
-                kernel=broadphase_collision_pairs,
-                dim=model.shape_contact_pair_count,
-                inputs=[
-                    model.shape_contact_pairs,
-                    state.body_q,
-                    model.shape_transform,
-                    model.shape_body,
-                    model.body_mass,
-                    model.shape_count,
-                    model.shape_geo,
-                    model.shape_collision_radius,
-                    model.rigid_contact_max,
-                    model.rigid_contact_margin,
-                    model.rigid_mesh_contact_max,
-                    iterate_mesh_vertices,
-                ],
-                outputs=[
-                    model.rigid_contact_count,
-                    model.rigid_contact_broad_shape0,
-                    model.rigid_contact_broad_shape1,
-                    model.rigid_contact_point_id,
-                    model.rigid_contact_point_limit,
-                ],
-                device=model.device,
-                record_tape=False,
-            )
-
-        if model.ground and model.shape_ground_contact_pair_count:
-            wp.launch(
-                kernel=broadphase_collision_pairs,
-                dim=model.shape_ground_contact_pair_count,
-                inputs=[
-                    model.shape_ground_contact_pairs,
-                    state.body_q,
-                    model.shape_transform,
-                    model.shape_body,
-                    model.body_mass,
-                    model.shape_count,
-                    model.shape_geo,
-                    model.shape_collision_radius,
-                    model.rigid_contact_max,
-                    model.rigid_contact_margin,
-                    model.rigid_mesh_contact_max,
-                    iterate_mesh_vertices,
-                ],
-                outputs=[
-                    model.rigid_contact_count,
-                    model.rigid_contact_broad_shape0,
-                    model.rigid_contact_broad_shape1,
-                    model.rigid_contact_point_id,
-                    model.rigid_contact_point_limit,
-                ],
-                device=model.device,
-                record_tape=False,
-            )
-
-        if model.shape_contact_pair_count or (model.ground and model.shape_ground_contact_pair_count):
-            if requires_grad:
-                model.rigid_contact_point0 = wp.empty_like(model.rigid_contact_point0)
-                model.rigid_contact_point1 = wp.empty_like(model.rigid_contact_point1)
-                model.rigid_contact_offset0 = wp.empty_like(model.rigid_contact_offset0)
-                model.rigid_contact_offset1 = wp.empty_like(model.rigid_contact_offset1)
-                model.rigid_contact_normal = wp.empty_like(model.rigid_contact_normal)
-                model.rigid_contact_thickness = wp.empty_like(model.rigid_contact_thickness)
-                model.rigid_contact_count = wp.zeros_like(model.rigid_contact_count)
-                model.rigid_contact_tids = wp.full_like(model.rigid_contact_tids, -1)
-                model.rigid_contact_shape0 = wp.empty_like(model.rigid_contact_shape0)
-                model.rigid_contact_shape1 = wp.empty_like(model.rigid_contact_shape1)
-
-                if model.rigid_contact_pairwise_counter is not None:
-                    model.rigid_contact_pairwise_counter = wp.zeros_like(model.rigid_contact_pairwise_counter)
-            else:
-                model.rigid_contact_count.zero_()
-                model.rigid_contact_tids.fill_(-1)
-
-                if model.rigid_contact_pairwise_counter is not None:
-                    model.rigid_contact_pairwise_counter.zero_()
-
-            model.rigid_contact_shape0.fill_(-1)
-            model.rigid_contact_shape1.fill_(-1)
-
-            wp.launch(
-                kernel=handle_contact_pairs,
-                dim=model.rigid_contact_max,
-                inputs=[
-                    state.body_q,
-                    model.shape_transform,
-                    model.shape_body,
-                    model.shape_geo,
-                    model.rigid_contact_margin,
-                    model.rigid_contact_broad_shape0,
-                    model.rigid_contact_broad_shape1,
-                    model.shape_count,
-                    model.rigid_contact_point_id,
-                    model.rigid_contact_point_limit,
-                    edge_sdf_iter,
-                ],
-                outputs=[
-                    model.rigid_contact_count,
-                    model.rigid_contact_shape0,
-                    model.rigid_contact_shape1,
-                    model.rigid_contact_point0,
-                    model.rigid_contact_point1,
-                    model.rigid_contact_offset0,
-                    model.rigid_contact_offset1,
-                    model.rigid_contact_normal,
-                    model.rigid_contact_thickness,
-                    model.rigid_contact_pairwise_counter,
-                    model.rigid_contact_tids,
-                ],
-                device=model.device,
-            )
-
-
-@wp.func
-def compute_tri_aabb(
-    v1: wp.vec3,
-    v2: wp.vec3,
-    v3: wp.vec3,
-):
-    lower = wp.min(wp.min(v1, v2), v3)
-    upper = wp.max(wp.max(v1, v2), v3)
-
-    return lower, upper
-
-
-@wp.kernel
-def compute_tri_aabbs(
-    pos: wp.array(dtype=wp.vec3),
-    tri_indices: wp.array(dtype=wp.int32, ndim=2),
-    lower_bounds: wp.array(dtype=wp.vec3),
-    upper_bounds: wp.array(dtype=wp.vec3),
-):
-    t_id = wp.tid()
-
-    v1 = pos[tri_indices[t_id, 0]]
-    v2 = pos[tri_indices[t_id, 1]]
-    v3 = pos[tri_indices[t_id, 2]]
-
-    lower, upper = compute_tri_aabb(v1, v2, v3)
-
-    lower_bounds[t_id] = lower
-    upper_bounds[t_id] = upper
-
-
-@wp.kernel
-def compute_edge_aabbs(
-    pos: wp.array(dtype=wp.vec3),
-    edge_indices: wp.array(dtype=wp.int32, ndim=2),
-    lower_bounds: wp.array(dtype=wp.vec3),
-    upper_bounds: wp.array(dtype=wp.vec3),
-):
-    e_id = wp.tid()
-
-    v1 = pos[edge_indices[e_id, 2]]
-    v2 = pos[edge_indices[e_id, 3]]
-
-    lower_bounds[e_id] = wp.min(v1, v2)
-    upper_bounds[e_id] = wp.max(v1, v2)
-
-
-@wp.func
-def tri_is_neighbor(a_1: wp.int32, a_2: wp.int32, a_3: wp.int32, b_1: wp.int32, b_2: wp.int32, b_3: wp.int32):
-    tri_is_neighbor = (
-        a_1 == b_1
-        or a_1 == b_2
-        or a_1 == b_3
-        or a_2 == b_1
-        or a_2 == b_2
-        or a_2 == b_3
-        or a_3 == b_1
-        or a_3 == b_2
-        or a_3 == b_3
-    )
-
-    return tri_is_neighbor
-
-
-@wp.func
-def vertex_adjacent_to_triangle(v: wp.int32, a: wp.int32, b: wp.int32, c: wp.int32):
-    return v == a or v == b or v == c
-
-
-@wp.kernel
-def init_triangle_collision_data_kernel(
-    query_radius: float,
-    # outputs
-    triangle_colliding_vertices_count: wp.array(dtype=wp.int32),
-    triangle_colliding_vertices_min_dist: wp.array(dtype=float),
-    resize_flags: wp.array(dtype=wp.int32),
-):
-    tri_index = wp.tid()
-
-    triangle_colliding_vertices_count[tri_index] = 0
-    triangle_colliding_vertices_min_dist[tri_index] = query_radius
-
-    if tri_index == 0:
-        for i in range(3):
-            resize_flags[i] = 0
-
-
-@wp.kernel
-def vertex_triangle_collision_detection_kernel(
-    query_radius: float,
-    bvh_id: wp.uint64,
-    pos: wp.array(dtype=wp.vec3),
-    tri_indices: wp.array(dtype=wp.int32, ndim=2),
-    vertex_colliding_triangles_offsets: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_buffer_sizes: wp.array(dtype=wp.int32),
-    triangle_colliding_vertices_offsets: wp.array(dtype=wp.int32),
-    triangle_colliding_vertices_buffer_sizes: wp.array(dtype=wp.int32),
-    # outputs
-    vertex_colliding_triangles: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_count: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_min_dist: wp.array(dtype=float),
-    triangle_colliding_vertices: wp.array(dtype=wp.int32),
-    triangle_colliding_vertices_count: wp.array(dtype=wp.int32),
-    triangle_colliding_vertices_min_dist: wp.array(dtype=float),
-    resize_flags: wp.array(dtype=wp.int32),
-):
-    """
-    This function applies discrete collision detection between vertices and triangles. It uses pre-allocated spaces to
-    record the collision data. This collision detector works both ways, i.e., it records vertices' colliding triangles to
-    `vertex_colliding_triangles`, and records each triangles colliding vertices to `triangle_colliding_vertices`.
-
-    This function assumes that all the vertices are on triangles, and can be indexed from the pos argument.
-
-    Note:
-
-        The collision date buffer is pre-allocated and cannot be changed during collision detection, therefore, the space
-        may not be enough. If the space is not enough to record all the collision information, the function will set a
-        certain element in resized_flag to be true. The user can reallocate the buffer based on vertex_colliding_triangles_count
-        and vertex_colliding_triangles_count.
-
-    Attributes:
-        bvh_id (int): the bvh id you want to collide with
-        query_radius (float): the contact radius. vertex-triangle pairs whose distance are less than this will get detected
-        pos (array): positions of all the vertices that make up triangles
-        vertex_colliding_triangles (array): flattened buffer of vertices' collision triangles
-        vertex_colliding_triangles_count (array): number of triangles each vertex collides
-        vertex_colliding_triangles_offsets (array): where each vertex' collision buffer starts
-        vertex_colliding_triangles_buffer_sizes (array): size of each vertex' collision buffer, will be modified if resizing is needed
-        vertex_colliding_triangles_min_dist (array): each vertex' min distance to all (non-neighbor) triangles
-        triangle_colliding_vertices (array): positions of all the triangles' collision vertices, every two elements
-            records the vertex index and a triangle index it collides to
-        triangle_colliding_vertices_count (array): number of triangles each vertex collides
-        triangle_colliding_vertices_offsets (array): where each triangle's collision buffer starts
-        triangle_colliding_vertices_buffer_sizes (array): size of each triangle's collision buffer, will be modified if resizing is needed
-        triangle_colliding_vertices_min_dist (array): each triangle's min distance to all (non-self) vertices
-        resized_flag (array): size == 3, (vertex_buffer_resize_required, triangle_buffer_resize_required, edge_buffer_resize_required)
-    """
-
-    v_index = wp.tid()
-    v = pos[v_index]
-    vertex_buffer_offset = vertex_colliding_triangles_offsets[v_index]
-    vertex_buffer_size = vertex_colliding_triangles_offsets[v_index + 1] - vertex_buffer_offset
-
-    lower = wp.vec3(v[0] - query_radius, v[1] - query_radius, v[2] - query_radius)
-    upper = wp.vec3(v[0] + query_radius, v[1] + query_radius, v[2] + query_radius)
-
-    query = wp.bvh_query_aabb(bvh_id, lower, upper)
-
-    tri_index = wp.int32(0)
-    vertex_num_collisions = wp.int32(0)
-    min_dis_to_tris = query_radius
-    while wp.bvh_query_next(query, tri_index):
-        t1 = tri_indices[tri_index, 0]
-        t2 = tri_indices[tri_index, 1]
-        t3 = tri_indices[tri_index, 2]
-        if vertex_adjacent_to_triangle(v_index, t1, t2, t3):
-            continue
-
-        u1 = pos[t1]
-        u2 = pos[t2]
-        u3 = pos[t3]
-
-        closest_p, bary, feature_type = triangle_closest_point(u1, u2, u3, v)
-
-        dist = wp.length(closest_p - v)
-
-        if dist < query_radius:
-            # record v-f collision to vertex
-            min_dis_to_tris = wp.min(min_dis_to_tris, dist)
-            if vertex_num_collisions < vertex_buffer_size:
-                vertex_colliding_triangles[2 * (vertex_buffer_offset + vertex_num_collisions)] = v_index
-                vertex_colliding_triangles[2 * (vertex_buffer_offset + vertex_num_collisions) + 1] = tri_index
-            else:
-                resize_flags[VERTEX_COLLISION_BUFFER_OVERFLOW_INDEX] = 1
-
-            vertex_num_collisions = vertex_num_collisions + 1
-
-            wp.atomic_min(triangle_colliding_vertices_min_dist, tri_index, dist)
-            tri_buffer_size = triangle_colliding_vertices_buffer_sizes[tri_index]
-            tri_num_collisions = wp.atomic_add(triangle_colliding_vertices_count, tri_index, 1)
-
-            if tri_num_collisions < tri_buffer_size:
-                tri_buffer_offset = triangle_colliding_vertices_offsets[tri_index]
-                # record v-f collision to triangle
-                triangle_colliding_vertices[tri_buffer_offset + tri_num_collisions] = v_index
-            else:
-                resize_flags[TRI_COLLISION_BUFFER_OVERFLOW_INDEX] = 1
-
-    vertex_colliding_triangles_count[v_index] = vertex_num_collisions
-    vertex_colliding_triangles_min_dist[v_index] = min_dis_to_tris
-
-
-@wp.kernel
-def vertex_triangle_collision_detection_no_triangle_buffers_kernel(
-    query_radius: float,
-    bvh_id: wp.uint64,
-    pos: wp.array(dtype=wp.vec3),
-    tri_indices: wp.array(dtype=wp.int32, ndim=2),
-    vertex_colliding_triangles_offsets: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_buffer_sizes: wp.array(dtype=wp.int32),
-    # outputs
-    vertex_colliding_triangles: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_count: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_min_dist: wp.array(dtype=float),
-    triangle_colliding_vertices_min_dist: wp.array(dtype=float),
-    resize_flags: wp.array(dtype=wp.int32),
-):
-    """
-    This function applies discrete collision detection between vertices and triangles. It uses pre-allocated spaces to
-    record the collision data. Unlike `vertex_triangle_collision_detection_kernel`, this collision detection kernel
-    works only in one way, i.e., it only records vertices' colliding triangles to `vertex_colliding_triangles`.
-
-    This function assumes that all the vertices are on triangles, and can be indexed from the pos argument.
-
-    Note:
-
-        The collision date buffer is pre-allocated and cannot be changed during collision detection, therefore, the space
-        may not be enough. If the space is not enough to record all the collision information, the function will set a
-        certain element in resized_flag to be true. The user can reallocate the buffer based on vertex_colliding_triangles_count
-        and vertex_colliding_triangles_count.
-
-    Attributes:
-        bvh_id (int): the bvh id you want to collide with
-        query_radius (float): the contact radius. vertex-triangle pairs whose distance are less than this will get detected
-        pos (array): positions of all the vertices that make up triangles
-        vertex_colliding_triangles (array): flattened buffer of vertices' collision triangles, every two elements records
-            the vertex index and a triangle index it collides to
-        vertex_colliding_triangles_count (array): number of triangles each vertex collides
-        vertex_colliding_triangles_offsets (array): where each vertex' collision buffer starts
-        vertex_colliding_triangles_buffer_sizes (array): size of each vertex' collision buffer, will be modified if resizing is needed
-        vertex_colliding_triangles_min_dist (array): each vertex' min distance to all (non-neighbor) triangles
-        triangle_colliding_vertices_min_dist (array): each triangle's min distance to all (non-self) vertices
-        resized_flag (array): size == 3, (vertex_buffer_resize_required, triangle_buffer_resize_required, edge_buffer_resize_required)
-    """
-
-    v_index = wp.tid()
-    v = pos[v_index]
-    vertex_buffer_offset = vertex_colliding_triangles_offsets[v_index]
-    vertex_buffer_size = vertex_colliding_triangles_offsets[v_index + 1] - vertex_buffer_offset
-
-    lower = wp.vec3(v[0] - query_radius, v[1] - query_radius, v[2] - query_radius)
-    upper = wp.vec3(v[0] + query_radius, v[1] + query_radius, v[2] + query_radius)
-
-    query = wp.bvh_query_aabb(bvh_id, lower, upper)
-
-    tri_index = wp.int32(0)
-    vertex_num_collisions = wp.int32(0)
-    min_dis_to_tris = query_radius
-    while wp.bvh_query_next(query, tri_index):
-        t1 = tri_indices[tri_index, 0]
-        t2 = tri_indices[tri_index, 1]
-        t3 = tri_indices[tri_index, 2]
-        if vertex_adjacent_to_triangle(v_index, t1, t2, t3):
-            continue
-
-        u1 = pos[t1]
-        u2 = pos[t2]
-        u3 = pos[t3]
-
-        closest_p, bary, feature_type = triangle_closest_point(u1, u2, u3, v)
-
-        dist = wp.length(closest_p - v)
-
-        if dist < query_radius:
-            # record v-f collision to vertex
-            min_dis_to_tris = wp.min(min_dis_to_tris, dist)
-            if vertex_num_collisions < vertex_buffer_size:
-                vertex_colliding_triangles[2 * (vertex_buffer_offset + vertex_num_collisions)] = v_index
-                vertex_colliding_triangles[2 * (vertex_buffer_offset + vertex_num_collisions) + 1] = tri_index
-            else:
-                resize_flags[VERTEX_COLLISION_BUFFER_OVERFLOW_INDEX] = 1
-
-            vertex_num_collisions = vertex_num_collisions + 1
-
-            wp.atomic_min(triangle_colliding_vertices_min_dist, tri_index, dist)
-
-    vertex_colliding_triangles_count[v_index] = vertex_num_collisions
-    vertex_colliding_triangles_min_dist[v_index] = min_dis_to_tris
-
-
-@wp.kernel
-def edge_colliding_edges_detection_kernel(
-    query_radius: float,
-    bvh_id: wp.uint64,
-    pos: wp.array(dtype=wp.vec3),
-    edge_indices: wp.array(dtype=wp.int32, ndim=2),
-    edge_colliding_edges_offsets: wp.array(dtype=wp.int32),
-    edge_colliding_edges_buffer_sizes: wp.array(dtype=wp.int32),
-    edge_edge_parallel_epsilon: float,
-    # outputs
-    edge_colliding_edges: wp.array(dtype=wp.int32),
-    edge_colliding_edges_count: wp.array(dtype=wp.int32),
-    edge_colliding_edges_min_dist: wp.array(dtype=float),
-    resize_flags: wp.array(dtype=wp.int32),
-):
-    """
-    bvh_id (int): the bvh id you want to do collision detection on
-    query_radius (float):
-    pos (array): positions of all the vertices that make up edges
-    edge_colliding_triangles (array): flattened buffer of edges' collision edges
-    edge_colliding_edges_count (array): number of edges each edge collides
-    edge_colliding_triangles_offsets (array): where each edge's collision buffer starts
-    edge_colliding_triangles_buffer_size (array): size of each edge's collision buffer, will be modified if resizing is needed
-    edge_min_dis_to_triangles (array): each vertex' min distance to all (non-neighbor) triangles
-    resized_flag (array): size == 3, (vertex_buffer_resize_required, triangle_buffer_resize_required, edge_buffer_resize_required)
-    """
-    e_index = wp.tid()
-
-    e0_v0 = edge_indices[e_index, 2]
-    e0_v1 = edge_indices[e_index, 3]
-
-    e0_v0_pos = pos[e0_v0]
-    e0_v1_pos = pos[e0_v1]
-
-    lower = wp.min(e0_v0_pos, e0_v1_pos)
-    upper = wp.max(e0_v0_pos, e0_v1_pos)
-
-    lower = wp.vec3(lower[0] - query_radius, lower[1] - query_radius, lower[2] - query_radius)
-    upper = wp.vec3(upper[0] + query_radius, upper[1] + query_radius, upper[2] + query_radius)
-
-    query = wp.bvh_query_aabb(bvh_id, lower, upper)
-
-    colliding_edge_index = wp.int32(0)
-    edge_num_collisions = wp.int32(0)
-    min_dis_to_edges = query_radius
-    while wp.bvh_query_next(query, colliding_edge_index):
-        e1_v0 = edge_indices[colliding_edge_index, 2]
-        e1_v1 = edge_indices[colliding_edge_index, 3]
-
-        if e0_v0 == e1_v0 or e0_v0 == e1_v1 or e0_v1 == e1_v0 or e0_v1 == e1_v1:
-            continue
-
-        e1_v0_pos = pos[e1_v0]
-        e1_v1_pos = pos[e1_v1]
-
-        st = wp.closest_point_edge_edge(e0_v0_pos, e0_v1_pos, e1_v0_pos, e1_v1_pos, edge_edge_parallel_epsilon)
-        s = st[0]
-        t = st[1]
-        c1 = e0_v0_pos + (e0_v1_pos - e0_v0_pos) * s
-        c2 = e1_v0_pos + (e1_v1_pos - e1_v0_pos) * t
-
-        dist = wp.length(c1 - c2)
-        if dist < query_radius:
-            edge_buffer_offset = edge_colliding_edges_offsets[e_index]
-            edge_buffer_size = edge_colliding_edges_offsets[e_index + 1] - edge_buffer_offset
-
-            # record e-e collision to e0, and leave e1; e1 will detect this collision from its own thread
-            min_dis_to_edges = wp.min(min_dis_to_edges, dist)
-            if edge_num_collisions < edge_buffer_size:
-                edge_colliding_edges[2 * (edge_buffer_offset + edge_num_collisions)] = e_index
-                edge_colliding_edges[2 * (edge_buffer_offset + edge_num_collisions) + 1] = colliding_edge_index
-            else:
-                resize_flags[EDGE_COLLISION_BUFFER_OVERFLOW_INDEX] = 1
-
-            edge_num_collisions = edge_num_collisions + 1
-
-    edge_colliding_edges_count[e_index] = edge_num_collisions
-    edge_colliding_edges_min_dist[e_index] = min_dis_to_edges
-
-
-@wp.kernel
-def triangle_triangle_collision_detection_kernel(
-    bvh_id: wp.uint64,
-    pos: wp.array(dtype=wp.vec3),
-    tri_indices: wp.array(dtype=wp.int32, ndim=2),
-    triangle_intersecting_triangles_offsets: wp.array(dtype=wp.int32),
-    # outputs
-    triangle_intersecting_triangles: wp.array(dtype=wp.int32),
-    triangle_intersecting_triangles_count: wp.array(dtype=wp.int32),
-    resize_flags: wp.array(dtype=wp.int32),
-):
-    tri_index = wp.tid()
-    t1_v1 = tri_indices[tri_index, 0]
-    t1_v2 = tri_indices[tri_index, 1]
-    t1_v3 = tri_indices[tri_index, 2]
-
-    v1 = pos[t1_v1]
-    v2 = pos[t1_v2]
-    v3 = pos[t1_v3]
-
-    lower, upper = compute_tri_aabb(v1, v2, v3)
-
-    buffer_offset = triangle_intersecting_triangles_offsets[tri_index]
-    buffer_size = triangle_intersecting_triangles_offsets[tri_index + 1] - buffer_offset
-
-    query = wp.bvh_query_aabb(bvh_id, lower, upper)
-    tri_index_2 = wp.int32(0)
-    intersection_count = wp.int32(0)
-    while wp.bvh_query_next(query, tri_index_2):
-        t2_v1 = tri_indices[tri_index_2, 0]
-        t2_v2 = tri_indices[tri_index_2, 1]
-        t2_v3 = tri_indices[tri_index_2, 2]
-
-        # filter out intersection test with neighbor triangles
-        if (
-            vertex_adjacent_to_triangle(t1_v1, t2_v1, t2_v2, t2_v3)
-            or vertex_adjacent_to_triangle(t1_v2, t2_v1, t2_v2, t2_v3)
-            or vertex_adjacent_to_triangle(t1_v3, t2_v1, t2_v2, t2_v3)
-        ):
-            continue
-
-        u1 = pos[t2_v1]
-        u2 = pos[t2_v2]
-        u3 = pos[t2_v3]
-
-        if wp.intersect_tri_tri(v1, v2, v3, u1, u2, u3):
-            if intersection_count < buffer_size:
-                triangle_intersecting_triangles[buffer_offset + intersection_count] = tri_index_2
-            else:
-                resize_flags[TRI_TRI_COLLISION_BUFFER_OVERFLOW_INDEX] = 1
-            intersection_count = intersection_count + 1
-
-    triangle_intersecting_triangles_count[tri_index] = intersection_count
-
-
-@wp.struct
-class TriMeshCollisionInfo:
-    vertex_indices: wp.array(dtype=wp.int32)
-    # size: 2 x sum(vertex_colliding_triangles_buffer_sizes)
-    # every two elements records the vertex index and a triangle index it collides to
-    vertex_colliding_triangles: wp.array(dtype=wp.int32)
-    vertex_colliding_triangles_offsets: wp.array(dtype=wp.int32)
-    vertex_colliding_triangles_buffer_sizes: wp.array(dtype=wp.int32)
-    vertex_colliding_triangles_count: wp.array(dtype=wp.int32)
-    vertex_colliding_triangles_min_dist: wp.array(dtype=float)
-
-    triangle_colliding_vertices: wp.array(dtype=wp.int32)
-    triangle_colliding_vertices_offsets: wp.array(dtype=wp.int32)
-    triangle_colliding_vertices_buffer_sizes: wp.array(dtype=wp.int32)
-    triangle_colliding_vertices_count: wp.array(dtype=wp.int32)
-    triangle_colliding_vertices_min_dist: wp.array(dtype=float)
-
-    # size: 2 x sum(edge_colliding_edges_buffer_sizes)
-    # every two elements records the edge index and an edge index it collides to
-    edge_colliding_edges: wp.array(dtype=wp.int32)
-    edge_colliding_edges_offsets: wp.array(dtype=wp.int32)
-    edge_colliding_edges_buffer_sizes: wp.array(dtype=wp.int32)
-    edge_colliding_edges_count: wp.array(dtype=wp.int32)
-    edge_colliding_edges_min_dist: wp.array(dtype=float)
-
-
-@wp.func
-def get_vertex_colliding_triangles_count(col_info: TriMeshCollisionInfo, v: int):
-    return wp.min(col_info.vertex_colliding_triangles_count[v], col_info.vertex_colliding_triangles_buffer_sizes[v])
-
-
-@wp.func
-def get_vertex_colliding_triangles(col_info: TriMeshCollisionInfo, v: int, i_collision: int):
-    offset = col_info.vertex_colliding_triangles_offsets[v]
-    return col_info.vertex_colliding_triangles[2 * (offset + i_collision) + 1]
-
-
-@wp.func
-def get_vertex_collision_buffer_vertex_index(col_info: TriMeshCollisionInfo, v: int, i_collision: int):
-    offset = col_info.vertex_colliding_triangles_offsets[v]
-    return col_info.vertex_colliding_triangles[2 * (offset + i_collision)]
-
-
-@wp.func
-def get_triangle_colliding_vertices_count(col_info: TriMeshCollisionInfo, tri: int):
-    return wp.min(
-        col_info.triangle_colliding_vertices_count[tri], col_info.triangle_colliding_vertices_buffer_sizes[tri]
-    )
-
-
-@wp.func
-def get_triangle_colliding_vertices(col_info: TriMeshCollisionInfo, tri: int, i_collision: int):
-    offset = col_info.triangle_colliding_vertices_offsets[tri]
-    return col_info.triangle_colliding_vertices[offset + i_collision]
-
-
-@wp.func
-def get_edge_colliding_edges_count(col_info: TriMeshCollisionInfo, e: int):
-    return wp.min(col_info.edge_colliding_edges_count[e], col_info.edge_colliding_edges_buffer_sizes[e])
-
-
-@wp.func
-def get_edge_colliding_edges(col_info: TriMeshCollisionInfo, e: int, i_collision: int):
-    offset = col_info.edge_colliding_edges_offsets[e]
-    return col_info.edge_colliding_edges[2 * (offset + i_collision) + 1]
-
-
-@wp.func
-def get_edge_collision_buffer_edge_index(col_info: TriMeshCollisionInfo, e: int, i_collision: int):
-    offset = col_info.edge_colliding_edges_offsets[e]
-    return col_info.edge_colliding_edges[2 * (offset + i_collision)]
-
-
-class TriMeshCollisionDetector:
-    def __init__(
-        self,
-        model: Model,
-        record_triangle_contacting_vertices=False,
-        vertex_positions=None,
-        vertex_collision_buffer_pre_alloc=8,
-        vertex_collision_buffer_max_alloc=256,
-        triangle_collision_buffer_pre_alloc=16,
-        triangle_collision_buffer_max_alloc=256,
-        edge_collision_buffer_pre_alloc=8,
-        edge_collision_buffer_max_alloc=256,
-        triangle_triangle_collision_buffer_pre_alloc=8,
-        triangle_triangle_collision_buffer_max_alloc=256,
-        edge_edge_parallel_epsilon=1e-5,
-    ):
-        self.model = model
-        self.record_triangle_contacting_vertices = record_triangle_contacting_vertices
-        self.vertex_positions = model.particle_q if vertex_positions is None else vertex_positions
-        self.device = model.device
-        self.vertex_collision_buffer_pre_alloc = vertex_collision_buffer_pre_alloc
-        self.vertex_collision_buffer_max_alloc = vertex_collision_buffer_max_alloc
-        self.triangle_collision_buffer_pre_alloc = triangle_collision_buffer_pre_alloc
-        self.triangle_collision_buffer_max_alloc = triangle_collision_buffer_max_alloc
-        self.edge_collision_buffer_pre_alloc = edge_collision_buffer_pre_alloc
-        self.edge_collision_buffer_max_alloc = edge_collision_buffer_max_alloc
-        self.triangle_triangle_collision_buffer_pre_alloc = triangle_triangle_collision_buffer_pre_alloc
-        self.triangle_triangle_collision_buffer_max_alloc = triangle_triangle_collision_buffer_max_alloc
-
-        self.edge_edge_parallel_epsilon = edge_edge_parallel_epsilon
-
-        self.lower_bounds_tris = wp.array(shape=(model.tri_count,), dtype=wp.vec3, device=model.device)
-        self.upper_bounds_tris = wp.array(shape=(model.tri_count,), dtype=wp.vec3, device=model.device)
-        wp.launch(
-            kernel=compute_tri_aabbs,
-            inputs=[self.vertex_positions, model.tri_indices, self.lower_bounds_tris, self.upper_bounds_tris],
-            dim=model.tri_count,
-            device=model.device,
-        )
-
-        self.bvh_tris = wp.Bvh(self.lower_bounds_tris, self.upper_bounds_tris)
-
-        # collision detections results
-
-        # vertex collision buffers
-        self.vertex_colliding_triangles = wp.zeros(
-            shape=(2 * model.particle_count * self.vertex_collision_buffer_pre_alloc,),
-            dtype=wp.int32,
-            device=self.device,
-        )
-        self.vertex_colliding_triangles_count = wp.array(
-            shape=(model.particle_count,), dtype=wp.int32, device=self.device
-        )
-        self.vertex_colliding_triangles_min_dist = wp.array(
-            shape=(model.particle_count,), dtype=float, device=self.device
-        )
-        self.vertex_colliding_triangles_buffer_sizes = wp.full(
-            shape=(model.particle_count,),
-            value=self.vertex_collision_buffer_pre_alloc,
-            dtype=wp.int32,
-            device=self.device,
-        )
-        self.vertex_colliding_triangles_offsets = wp.array(
-            shape=(model.particle_count + 1,), dtype=wp.int32, device=self.device
-        )
-        self.compute_collision_buffer_offsets(
-            self.vertex_colliding_triangles_buffer_sizes, self.vertex_colliding_triangles_offsets
-        )
-
-        if record_triangle_contacting_vertices:
-            # triangle collision buffers
-            self.triangle_colliding_vertices = wp.zeros(
-                shape=(model.tri_count * self.triangle_collision_buffer_pre_alloc,), dtype=wp.int32, device=self.device
-            )
-            self.triangle_colliding_vertices_count = wp.zeros(
-                shape=(model.tri_count,), dtype=wp.int32, device=self.device
-            )
-            self.triangle_colliding_vertices_buffer_sizes = wp.full(
-                shape=(model.tri_count,),
-                value=self.triangle_collision_buffer_pre_alloc,
-                dtype=wp.int32,
-                device=self.device,
-            )
-
-            self.triangle_colliding_vertices_offsets = wp.array(
-                shape=(model.tri_count + 1,), dtype=wp.int32, device=self.device
-            )
-            self.compute_collision_buffer_offsets(
-                self.triangle_colliding_vertices_buffer_sizes, self.triangle_colliding_vertices_offsets
-            )
-        else:
-            self.triangle_colliding_vertices = None
-            self.triangle_colliding_vertices_count = None
-            self.triangle_colliding_vertices_buffer_sizes = None
-            self.triangle_colliding_vertices_offsets = None
-
-        # this is need regardless of whether we record triangle contacting vertices
-        self.triangle_colliding_vertices_min_dist = wp.array(shape=(model.tri_count,), dtype=float, device=self.device)
-
-        # edge collision buffers
-        self.edge_colliding_edges = wp.zeros(
-            shape=(2 * model.edge_count * self.edge_collision_buffer_pre_alloc,), dtype=wp.int32, device=self.device
-        )
-        self.edge_colliding_edges_count = wp.zeros(shape=(model.edge_count,), dtype=wp.int32, device=self.device)
-        self.edge_colliding_edges_buffer_sizes = wp.full(
-            shape=(model.edge_count,),
-            value=self.edge_collision_buffer_pre_alloc,
-            dtype=wp.int32,
-            device=self.device,
-        )
-        self.edge_colliding_edges_offsets = wp.array(shape=(model.edge_count + 1,), dtype=wp.int32, device=self.device)
-        self.compute_collision_buffer_offsets(self.edge_colliding_edges_buffer_sizes, self.edge_colliding_edges_offsets)
-        self.edge_colliding_edges_min_dist = wp.array(shape=(model.edge_count,), dtype=float, device=self.device)
-
-        self.lower_bounds_edges = wp.array(shape=(model.edge_count,), dtype=wp.vec3, device=model.device)
-        self.upper_bounds_edges = wp.array(shape=(model.edge_count,), dtype=wp.vec3, device=model.device)
-        wp.launch(
-            kernel=compute_edge_aabbs,
-            inputs=[self.vertex_positions, model.edge_indices, self.lower_bounds_edges, self.upper_bounds_edges],
-            dim=model.edge_count,
-            device=model.device,
-        )
-
-        self.bvh_edges = wp.Bvh(self.lower_bounds_edges, self.upper_bounds_edges)
-
-        self.resize_flags = wp.zeros(shape=(4,), dtype=wp.int32, device=self.device)
-
-        self.collision_info = self.get_collision_data()
-
-        # data for triangle-triangle intersection; they will only be initialized on demand, as triangle-triangle intersection is not needed for simulation
-        self.triangle_intersecting_triangles = None
-        self.triangle_intersecting_triangles_count = None
-        self.triangle_intersecting_triangles_offsets = None
-
-    def get_collision_data(self):
-        collision_info = TriMeshCollisionInfo()
-
-        collision_info.vertex_colliding_triangles = self.vertex_colliding_triangles
-        collision_info.vertex_colliding_triangles_offsets = self.vertex_colliding_triangles_offsets
-        collision_info.vertex_colliding_triangles_buffer_sizes = self.vertex_colliding_triangles_buffer_sizes
-        collision_info.vertex_colliding_triangles_count = self.vertex_colliding_triangles_count
-        collision_info.vertex_colliding_triangles_min_dist = self.vertex_colliding_triangles_min_dist
-
-        if self.record_triangle_contacting_vertices:
-            collision_info.triangle_colliding_vertices = self.triangle_colliding_vertices
-            collision_info.triangle_colliding_vertices_offsets = self.triangle_colliding_vertices_offsets
-            collision_info.triangle_colliding_vertices_buffer_sizes = self.triangle_colliding_vertices_buffer_sizes
-            collision_info.triangle_colliding_vertices_count = self.triangle_colliding_vertices_count
-
-        collision_info.triangle_colliding_vertices_min_dist = self.triangle_colliding_vertices_min_dist
-
-        collision_info.edge_colliding_edges = self.edge_colliding_edges
-        collision_info.edge_colliding_edges_offsets = self.edge_colliding_edges_offsets
-        collision_info.edge_colliding_edges_buffer_sizes = self.edge_colliding_edges_buffer_sizes
-        collision_info.edge_colliding_edges_count = self.edge_colliding_edges_count
-        collision_info.edge_colliding_edges_min_dist = self.edge_colliding_edges_min_dist
-
-        return collision_info
-
-    def compute_collision_buffer_offsets(
-        self, buffer_sizes: wp.array(dtype=wp.int32), offsets: wp.array(dtype=wp.int32)
-    ):
-        assert offsets.size == buffer_sizes.size + 1
-        offsets_np = np.empty(shape=(offsets.size,), dtype=np.int32)
-        offsets_np[1:] = np.cumsum(buffer_sizes.numpy())[:]
-        offsets_np[0] = 0
-
-        offsets.assign(offsets_np)
-
-    def rebuild(self, new_pos=None):
-        if new_pos is not None:
-            self.vertex_positions = new_pos
-
-        wp.launch(
-            kernel=compute_tri_aabbs,
-            inputs=[
-                self.vertex_positions,
-                self.model.tri_indices,
-            ],
-            outputs=[self.lower_bounds_tris, self.upper_bounds_tris],
-            dim=self.model.tri_count,
-            device=self.model.device,
-        )
-        self.bvh_tris = wp.Bvh(self.lower_bounds_tris, self.upper_bounds_tris)
-
-        wp.launch(
-            kernel=compute_edge_aabbs,
-            inputs=[self.vertex_positions, self.model.edge_indices],
-            outputs=[self.lower_bounds_edges, self.upper_bounds_edges],
-            dim=self.model.edge_count,
-            device=self.model.device,
-        )
-        self.bvh_edges = wp.Bvh(self.lower_bounds_edges, self.upper_bounds_edges)
-
-    def refit(self, new_pos=None):
-        if new_pos is not None:
-            self.vertex_positions = new_pos
-
-        self.refit_triangles()
-        self.refit_edges()
-
-    def refit_triangles(self):
-        wp.launch(
-            kernel=compute_tri_aabbs,
-            inputs=[self.vertex_positions, self.model.tri_indices, self.lower_bounds_tris, self.upper_bounds_tris],
-            dim=self.model.tri_count,
-            device=self.model.device,
-        )
-        self.bvh_tris.refit()
-
-    def refit_edges(self):
-        wp.launch(
-            kernel=compute_edge_aabbs,
-            inputs=[self.vertex_positions, self.model.edge_indices, self.lower_bounds_edges, self.upper_bounds_edges],
-            dim=self.model.edge_count,
-            device=self.model.device,
-        )
-        self.bvh_edges.refit()
-
-    def vertex_triangle_collision_detection(self, query_radius):
-        self.vertex_colliding_triangles.fill_(-1)
-
-        if self.record_triangle_contacting_vertices:
-            wp.launch(
-                kernel=init_triangle_collision_data_kernel,
-                inputs=[
-                    query_radius,
-                ],
-                outputs=[
-                    self.triangle_colliding_vertices_count,
-                    self.triangle_colliding_vertices_min_dist,
-                    self.resize_flags,
-                ],
-                dim=self.model.tri_count,
-                device=self.model.device,
-            )
-
-            wp.launch(
-                kernel=vertex_triangle_collision_detection_kernel,
-                inputs=[
-                    query_radius,
-                    self.bvh_tris.id,
-                    self.vertex_positions,
-                    self.model.tri_indices,
-                    self.vertex_colliding_triangles_offsets,
-                    self.vertex_colliding_triangles_buffer_sizes,
-                    self.triangle_colliding_vertices_offsets,
-                    self.triangle_colliding_vertices_buffer_sizes,
-                ],
-                outputs=[
-                    self.vertex_colliding_triangles,
-                    self.vertex_colliding_triangles_count,
-                    self.vertex_colliding_triangles_min_dist,
-                    self.triangle_colliding_vertices,
-                    self.triangle_colliding_vertices_count,
-                    self.triangle_colliding_vertices_min_dist,
-                    self.resize_flags,
-                ],
-                dim=self.model.particle_count,
-                device=self.model.device,
-            )
-        else:
-            self.triangle_colliding_vertices_min_dist.fill_(query_radius)
-            wp.launch(
-                kernel=vertex_triangle_collision_detection_no_triangle_buffers_kernel,
-                inputs=[
-                    query_radius,
-                    self.bvh_tris.id,
-                    self.vertex_positions,
-                    self.model.tri_indices,
-                    self.vertex_colliding_triangles_offsets,
-                    self.vertex_colliding_triangles_buffer_sizes,
-                ],
-                outputs=[
-                    self.vertex_colliding_triangles,
-                    self.vertex_colliding_triangles_count,
-                    self.vertex_colliding_triangles_min_dist,
-                    self.triangle_colliding_vertices_min_dist,
-                    self.resize_flags,
-                ],
-                dim=self.model.particle_count,
-                device=self.model.device,
-            )
-
-    def edge_edge_collision_detection(self, query_radius):
-        self.edge_colliding_edges.fill_(-1)
-        wp.launch(
-            kernel=edge_colliding_edges_detection_kernel,
-            inputs=[
-                query_radius,
-                self.bvh_edges.id,
-                self.vertex_positions,
-                self.model.edge_indices,
-                self.edge_colliding_edges_offsets,
-                self.edge_colliding_edges_buffer_sizes,
-                self.edge_edge_parallel_epsilon,
-            ],
-            outputs=[
-                self.edge_colliding_edges,
-                self.edge_colliding_edges_count,
-                self.edge_colliding_edges_min_dist,
-                self.resize_flags,
-            ],
-            dim=self.model.edge_count,
-            device=self.model.device,
-        )
-
-    def triangle_triangle_intersection_detection(self):
-        if self.triangle_intersecting_triangles is None:
-            self.triangle_intersecting_triangles = wp.zeros(
-                shape=(self.model.tri_count * self.triangle_triangle_collision_buffer_pre_alloc,),
-                dtype=wp.int32,
-                device=self.device,
-            )
-
-        if self.triangle_intersecting_triangles_count is None:
-            self.triangle_intersecting_triangles_count = wp.array(
-                shape=(self.model.tri_count,), dtype=wp.int32, device=self.device
-            )
-
-        if self.triangle_intersecting_triangles_offsets is None:
-            buffer_sizes = np.full((self.model.tri_count,), self.triangle_triangle_collision_buffer_pre_alloc)
-            offsets = np.zeros((self.model.tri_count + 1,), dtype=np.int32)
-            offsets[1:] = np.cumsum(buffer_sizes)
-
-            self.triangle_intersecting_triangles_offsets = wp.array(offsets, dtype=wp.int32, device=self.device)
-
-        wp.launch(
-            kernel=triangle_triangle_collision_detection_kernel,
-            inputs=[
-                self.bvh_tris.id,
-                self.vertex_positions,
-                self.model.tri_indices,
-                self.triangle_intersecting_triangles_offsets,
-            ],
-            outputs=[
-                self.triangle_intersecting_triangles,
-                self.triangle_intersecting_triangles_count,
-                self.resize_flags,
-            ],
-            dim=self.model.tri_count,
-            device=self.model.device,
-        )
diff --git a/warp/sim/graph_coloring.py b/warp/sim/graph_coloring.py
deleted file mode 100644
index 469be65f..00000000
--- a/warp/sim/graph_coloring.py
+++ /dev/null
@@ -1,307 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2024 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-from enum import Enum
-
-import numpy as np
-
-import warp as wp
-import warp.utils
-
-
-class ColoringAlgorithm(Enum):
-    MCS = 0
-    GREEDY = 1
-
-
-@wp.kernel
-def construct_trimesh_graph_edges_kernel(
-    trimesh_edge_indices: wp.array(dtype=int, ndim=2),
-    add_bending: bool,
-    graph_edge_indices: wp.array(dtype=int, ndim=2),
-    graph_num_edges: wp.array(dtype=int),
-):
-    num_diagonal_edges = wp.int32(0)
-    num_non_diagonal_edges = trimesh_edge_indices.shape[0]
-    for e_idx in range(trimesh_edge_indices.shape[0]):
-        v1 = trimesh_edge_indices[e_idx, 2]
-        v2 = trimesh_edge_indices[e_idx, 3]
-
-        graph_edge_indices[e_idx, 0] = v1
-        graph_edge_indices[e_idx, 1] = v2
-
-        o1 = trimesh_edge_indices[e_idx, 0]
-        o2 = trimesh_edge_indices[e_idx, 1]
-
-        if o1 != -1 and o2 != -1 and add_bending:
-            graph_edge_indices[num_non_diagonal_edges + num_diagonal_edges, 0] = o1
-            graph_edge_indices[num_non_diagonal_edges + num_diagonal_edges, 1] = o2
-
-            num_diagonal_edges = num_diagonal_edges + 1
-
-    graph_num_edges[0] = num_diagonal_edges + num_non_diagonal_edges
-
-
-@wp.kernel
-def validate_graph_coloring(edge_indices: wp.array(dtype=int, ndim=2), colors: wp.array(dtype=int)):
-    edge_idx = wp.tid()
-    e_v_1 = edge_indices[edge_idx, 0]
-    e_v_2 = edge_indices[edge_idx, 1]
-
-    wp.expect_neq(colors[e_v_1], colors[e_v_2])
-
-
-@wp.kernel
-def count_color_group_size(
-    colors: wp.array(dtype=int),
-    group_sizes: wp.array(dtype=int),
-):
-    for particle_idx in range(colors.shape[0]):
-        particle_color = colors[particle_idx]
-        group_sizes[particle_color] = group_sizes[particle_color] + 1
-
-
-@wp.kernel
-def fill_color_groups(
-    colors: wp.array(dtype=int),
-    group_fill_count: wp.array(dtype=int),
-    group_offsets: wp.array(dtype=int),
-    # flattened color groups
-    color_groups_flatten: wp.array(dtype=int),
-):
-    for particle_idx in range(colors.shape[0]):
-        particle_color = colors[particle_idx]
-        group_offset = group_offsets[particle_color]
-        group_idx = group_fill_count[particle_color]
-        color_groups_flatten[group_idx + group_offset] = wp.int32(particle_idx)
-
-        group_fill_count[particle_color] = group_idx + 1
-
-
-def convert_to_color_groups(num_colors, particle_colors, return_wp_array=False, device="cpu"):
-    group_sizes = wp.zeros(shape=(num_colors,), dtype=int, device="cpu")
-    wp.launch(kernel=count_color_group_size, inputs=[particle_colors, group_sizes], device="cpu", dim=1)
-
-    group_sizes_np = group_sizes.numpy()
-    group_offsets_np = np.concatenate([np.array([0]), np.cumsum(group_sizes_np)])
-    group_offsets = wp.array(group_offsets_np, dtype=int, device="cpu")
-
-    group_fill_count = wp.zeros(shape=(num_colors,), dtype=int, device="cpu")
-    color_groups_flatten = wp.empty(shape=(group_sizes_np.sum(),), dtype=int, device="cpu")
-    wp.launch(
-        kernel=fill_color_groups,
-        inputs=[particle_colors, group_fill_count, group_offsets, color_groups_flatten],
-        device="cpu",
-        dim=1,
-    )
-
-    color_groups_flatten_np = color_groups_flatten.numpy()
-
-    color_groups = []
-    if return_wp_array:
-        for color_idx in range(num_colors):
-            color_groups.append(
-                wp.array(
-                    color_groups_flatten_np[group_offsets_np[color_idx] : group_offsets_np[color_idx + 1]],
-                    dtype=int,
-                    device=device,
-                )
-            )
-    else:
-        for color_idx in range(num_colors):
-            color_groups.append(color_groups_flatten_np[group_offsets_np[color_idx] : group_offsets_np[color_idx + 1]])
-
-    return color_groups
-
-
-def construct_trimesh_graph_edges(trimesh_edge_indices, return_wp_array=False):
-    if isinstance(trimesh_edge_indices, np.ndarray):
-        trimesh_edge_indices = wp.array(trimesh_edge_indices, dtype=int, device="cpu")
-
-    # preallocate maximum amount of memory, which is model.edge_count * 2
-    graph_edge_indices = wp.empty(shape=(trimesh_edge_indices.shape[0] * 2, 2), dtype=int, device="cpu")
-    graph_num_edges = wp.zeros(shape=(1,), dtype=int, device="cpu")
-
-    wp.launch(
-        kernel=construct_trimesh_graph_edges_kernel,
-        inputs=[
-            trimesh_edge_indices.to("cpu"),
-            True,
-        ],
-        outputs=[graph_edge_indices, graph_num_edges],
-        dim=1,
-        device="cpu",
-    )
-
-    num_edges = graph_num_edges.numpy()[0]
-    graph_edge_indices_true_size = graph_edge_indices.numpy()[:num_edges, :]
-
-    if return_wp_array:
-        graph_edge_indices_true_size = wp.array(graph_edge_indices_true_size, dtype=int, device="cpu")
-
-    return graph_edge_indices_true_size
-
-
-def color_trimesh(
-    num_nodes,
-    trimesh_edge_indices,
-    include_bending_energy,
-    balance_colors=True,
-    target_max_min_color_ratio=1.1,
-    algorithm: ColoringAlgorithm = ColoringAlgorithm.MCS,
-):
-    """
-    A function that generates vertex coloring for a trimesh, which is represented by the number of vertices and edges of the mesh.
-    It will convert the trimesh to a graph and then apply coloring.
-    It returns a list of `np.array` with `dtype`=`int`. The length of the list is the number of colors
-    and each `np.array` contains the indices of vertices with this color.
-
-    Args:
-        num_nodes: The number of the nodes in the graph
-        trimesh_edge_indices: A `wp.array` with of shape (number_edges, 4), each row is (o1, o2, v1, v2), see `sim.Model`'s definition of `edge_indices`.
-        include_bending_energy: whether to consider bending energy in the coloring process. If set to `True`, the generated
-            graph will contain all the edges connecting o1 and o2; otherwise, the graph will be equivalent to the trimesh.
-        balance_colors: the parameter passed to `color_graph`, see `color_graph`'s document
-        target_max_min_color_ratio: the parameter passed to `color_graph`, see `color_graph`'s document
-        algorithm: the parameter passed to `color_graph`, see `color_graph`'s document
-
-    """
-    if num_nodes == 0:
-        return []
-
-    if trimesh_edge_indices.shape[0] == 0:
-        # no edge, all the particle can have same color
-        return [np.arange(0, num_nodes, dtype=int)]
-
-    if include_bending_energy:
-        graph_edge_indices = construct_trimesh_graph_edges(trimesh_edge_indices, return_wp_array=True)
-    else:
-        graph_edge_indices = wp.array(trimesh_edge_indices[:, 2:], dtype=int, device="cpu")
-
-    color_groups = color_graph(num_nodes, graph_edge_indices, balance_colors, target_max_min_color_ratio, algorithm)
-    return color_groups
-
-
-def color_graph(
-    num_nodes,
-    graph_edge_indices,
-    balance_colors=True,
-    target_max_min_color_ratio=1.1,
-    algorithm: ColoringAlgorithm = ColoringAlgorithm.MCS,
-):
-    """
-    A function that generates coloring for a graph, which is represented by the number of nodes and an array of edges.
-    It returns a list of `np.array` with `dtype`=`int`. The length of the list is the number of colors
-    and each `np.array` contains the indices of vertices with this color.
-
-    Args:
-        num_nodes: The number of the nodes in the graph
-        graph_edge_indices: A `wp.array` with of shape (number_edges, 2)
-        balance_colors: Whether to apply the color balancing algorithm to balance the size of each color
-        target_max_min_color_ratio: the color balancing algorithm will stop when the ratio between the largest color and
-            the smallest color reaches this value
-        algorithm: Value should an enum type of ColoringAlgorithm, otherwise it will raise an error. ColoringAlgorithm.mcs means using the MCS coloring algorithm,
-            while ColoringAlgorithm.ordered_greedy means using the degree-ordered greedy algorithm. The MCS algorithm typically generates 30% to 50% fewer colors
-            compared to the ordered greedy algorithm, while maintaining the same linear complexity. Although MCS has a constant overhead that makes it about twice
-            as slow as the greedy algorithm, it produces significantly better coloring results. We recommend using MCS, especially if coloring is only part of the
-            preprocessing stage.e.
-
-    Note:
-
-        References to the coloring algorithm:
-        MCS: Pereira, F. M. Q., & Palsberg, J. (2005, November). Register allocation via coloring of chordal graphs. In Asian Symposium on Programming Languages and Systems (pp. 315-329). Berlin, Heidelberg: Springer Berlin Heidelberg.
-        Ordered Greedy: Ton-That, Q. M., Kry, P. G., & Andrews, S. (2023). Parallel block Neo-Hookean XPBD using graph clustering. Computers & Graphics, 110, 1-10.
-    """
-    if num_nodes == 0:
-        return []
-
-    particle_colors = wp.empty(shape=(num_nodes), dtype=wp.int32, device="cpu")
-
-    if graph_edge_indices.ndim != 2:
-        raise ValueError(
-            f"graph_edge_indices must be a 2 dimensional array! The provided one is {graph_edge_indices.ndim} dimensional."
-        )
-
-    num_colors = wp.context.runtime.core.wp_graph_coloring(
-        num_nodes,
-        graph_edge_indices.__ctype__(),
-        algorithm.value,
-        particle_colors.__ctype__(),
-    )
-
-    if balance_colors:
-        max_min_ratio = wp.context.runtime.core.wp_balance_coloring(
-            num_nodes,
-            graph_edge_indices.__ctype__(),
-            num_colors,
-            target_max_min_color_ratio,
-            particle_colors.__ctype__(),
-        )
-
-        if max_min_ratio > target_max_min_color_ratio:
-            wp.utils.warn(
-                f"The graph is not optimizable anymore, terminated with a max/min ratio: {max_min_ratio} without reaching the target ratio: {target_max_min_color_ratio}"
-            )
-
-    color_groups = convert_to_color_groups(num_colors, particle_colors, return_wp_array=False)
-
-    return color_groups
-
-
-def combine_independent_particle_coloring(color_groups_1, color_groups_2):
-    """
-    A function that combines 2 independent coloring groups. Note that color_groups_1 and color_groups_2 must be from 2 independent
-    graphs so that there is no connection between them. This algorithm will sort color_groups_1 in ascending order and
-    sort color_groups_2 in descending order, and combine each group with the same index, this way we are always combining
-    the smaller group with the larger group.
-
-    Args:
-        color_groups_1: A list of `np.array` with `dtype`=`int`. The length of the list is the number of colors
-            and each `np.array` contains the indices of vertices with this color.
-        color_groups_2: A list of `np.array` with `dtype`=`int`. The length of the list is the number of colors
-            and each `np.array` contains the indices of vertices with this color.
-
-    """
-    if len(color_groups_1) == 0:
-        return color_groups_2
-    if len(color_groups_2) == 0:
-        return color_groups_1
-
-    num_colors_after_combining = max(len(color_groups_1), len(color_groups_2))
-    color_groups_combined = []
-
-    # this made sure that the leftover groups are always the largest
-    if len(color_groups_1) < len(color_groups_2):
-        color_groups_1, color_groups_2 = color_groups_2, color_groups_1
-
-    # sort group 1 in ascending order
-    color_groups_1_sorted = sorted(color_groups_1, key=lambda group: len(group))
-    # sort group 1 in descending order
-    color_groups_2_sorted = sorted(color_groups_2, key=lambda group: -len(group))
-    # so that we are combining the smaller group with the larger group
-    # which will balance the load of each group
-
-    for i in range(num_colors_after_combining):
-        group_1 = color_groups_1_sorted[i] if i < len(color_groups_1) else None
-        group_2 = color_groups_2_sorted[i] if i < len(color_groups_2) else None
-
-        if group_1 is not None and group_2 is not None:
-            color_groups_combined.append(np.concatenate([group_1, group_2]))
-        elif group_1 is not None:
-            color_groups_combined.append(group_1)
-        else:
-            color_groups_combined.append(group_2)
-
-    return color_groups_combined
diff --git a/warp/sim/import_mjcf.py b/warp/sim/import_mjcf.py
deleted file mode 100644
index 42f422ad..00000000
--- a/warp/sim/import_mjcf.py
+++ /dev/null
@@ -1,791 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-from __future__ import annotations
-
-import math
-import os
-import re
-import xml.etree.ElementTree as ET
-
-import numpy as np
-
-import warp as wp
-from warp.sim.model import Mesh
-
-
-def parse_mjcf(
-    mjcf_filename,
-    builder,
-    xform=None,
-    floating=False,
-    base_joint: dict | str | None = None,
-    density=1000.0,
-    stiffness=100.0,
-    damping=10.0,
-    armature=0.0,
-    armature_scale=1.0,
-    contact_ke=1.0e4,
-    contact_kd=1.0e3,
-    contact_kf=1.0e2,
-    contact_ka=0.0,
-    contact_mu=0.25,
-    contact_restitution=0.5,
-    contact_thickness=0.0,
-    limit_ke=100.0,
-    limit_kd=10.0,
-    joint_limit_lower=-1e6,
-    joint_limit_upper=1e6,
-    scale=1.0,
-    hide_visuals=False,
-    parse_visuals_as_colliders=False,
-    parse_meshes=True,
-    up_axis="Z",
-    ignore_names=(),
-    ignore_classes=None,
-    visual_classes=("visual",),
-    collider_classes=("collision",),
-    no_class_as_colliders=True,
-    force_show_colliders=False,
-    enable_self_collisions=False,
-    ignore_inertial_definitions=True,
-    ensure_nonstatic_links=True,
-    static_link_mass=1e-2,
-    collapse_fixed_joints=False,
-    verbose=False,
-):
-    """
-    Parses MuJoCo XML (MJCF) file and adds the bodies and joints to the given ModelBuilder.
-
-    Args:
-        mjcf_filename (str): The filename of the MuJoCo file to parse.
-        builder (ModelBuilder): The :class:`ModelBuilder` to add the bodies and joints to.
-        xform (:ref:`transform <transform>`): The transform to apply to the imported mechanism.
-        floating (bool): If True, the root body is a free joint. If False, the root body is connected via a fixed joint to the world, unless a `base_joint` is defined.
-        base_joint (Union[str, dict]): The joint by which the root body is connected to the world. This can be either a string defining the joint axes of a D6 joint with comma-separated positional and angular axis names (e.g. "px,py,rz" for a D6 joint with linear axes in x, y and an angular axis in z) or a dict with joint parameters (see :meth:`ModelBuilder.add_joint`).
-        density (float): The density of the shapes in kg/m^3 which will be used to calculate the body mass and inertia.
-        stiffness (float): The stiffness of the joints.
-        damping (float): The damping of the joints.
-        armature (float): Default joint armature to use if `armature` has not been defined for a joint in the MJCF.
-        armature_scale (float): Scaling factor to apply to the MJCF-defined joint armature values.
-        contact_ke (float): The stiffness of the shape contacts.
-        contact_kd (float): The damping of the shape contacts.
-        contact_kf (float): The friction stiffness of the shape contacts.
-        contact_ka (float): The adhesion distance of the shape contacts.
-        contact_mu (float): The friction coefficient of the shape contacts.
-        contact_restitution (float): The restitution coefficient of the shape contacts.
-        contact_thickness (float): The thickness to add to the shape geometry.
-        limit_ke (float): The stiffness of the joint limits.
-        limit_kd (float): The damping of the joint limits.
-        joint_limit_lower (float): The default lower joint limit if not specified in the MJCF.
-        joint_limit_upper (float): The default upper joint limit if not specified in the MJCF.
-        scale (float): The scaling factor to apply to the imported mechanism.
-        hide_visuals (bool): If True, hide visual shapes.
-        parse_visuals_as_colliders (bool): If True, the geometry defined under the `visual_classes` tags is used for collision handling instead of the `collider_classes` geometries.
-        parse_meshes (bool): Whether geometries of type `"mesh"` should be parsed. If False, geometries of type `"mesh"` are ignored.
-        up_axis (str): The up axis of the mechanism. Can be either `"X"`, `"Y"` or `"Z"`. The default is `"Z"`.
-        ignore_names (List[str]): A list of regular expressions. Bodies and joints with a name matching one of the regular expressions will be ignored.
-        ignore_classes (List[str]): A list of regular expressions. Bodies and joints with a class matching one of the regular expressions will be ignored.
-        visual_classes (List[str]): A list of regular expressions. Visual geometries with a class matching one of the regular expressions will be parsed.
-        collider_classes (List[str]): A list of regular expressions. Collision geometries with a class matching one of the regular expressions will be parsed.
-        no_class_as_colliders: If True, geometries without a class are parsed as collision geometries. If False, geometries without a class are parsed as visual geometries.
-        force_show_colliders (bool): If True, the collision shapes are always shown, even if there are visual shapes.
-        enable_self_collisions (bool): If True, self-collisions are enabled.
-        ignore_inertial_definitions (bool): If True, the inertial parameters defined in the MJCF are ignored and the inertia is calculated from the shape geometry.
-        ensure_nonstatic_links (bool): If True, links with zero mass are given a small mass (see `static_link_mass`) to ensure they are dynamic.
-        static_link_mass (float): The mass to assign to links with zero mass (if `ensure_nonstatic_links` is set to True).
-        collapse_fixed_joints (bool): If True, fixed joints are removed and the respective bodies are merged.
-        verbose (bool): If True, print additional information about parsing the MJCF.
-    """
-    if xform is None:
-        xform = wp.transform()
-
-    if ignore_classes is None:
-        ignore_classes = []
-
-    mjcf_dirname = os.path.dirname(mjcf_filename)
-    file = ET.parse(mjcf_filename)
-    root = file.getroot()
-
-    contact_vars = {
-        "ke": contact_ke,
-        "kd": contact_kd,
-        "kf": contact_kf,
-        "ka": contact_ka,
-        "mu": contact_mu,
-        "restitution": contact_restitution,
-        "thickness": contact_thickness,
-    }
-
-    use_degrees = True  # angles are in degrees by default
-    euler_seq = [0, 1, 2]  # XYZ by default
-
-    compiler = root.find("compiler")
-    if compiler is not None:
-        use_degrees = compiler.attrib.get("angle", "degree").lower() == "degree"
-        euler_seq = ["xyz".index(c) for c in compiler.attrib.get("eulerseq", "xyz").lower()]
-        mesh_dir = compiler.attrib.get("meshdir", ".")
-    else:
-        mesh_dir = "."
-
-    mesh_assets = {}
-    for asset in root.findall("asset"):
-        for mesh in asset.findall("mesh"):
-            if "file" in mesh.attrib:
-                fname = os.path.join(mesh_dir, mesh.attrib["file"])
-                # handle stl relative paths
-                if not os.path.isabs(fname):
-                    fname = os.path.abspath(os.path.join(mjcf_dirname, fname))
-                name = mesh.attrib.get("name", ".".join(os.path.basename(fname).split(".")[:-1]))
-                s = mesh.attrib.get("scale", "1.0 1.0 1.0")
-                s = np.fromstring(s, sep=" ", dtype=np.float32)
-                mesh_assets[name] = {"file": fname, "scale": s}
-
-    class_parent = {}
-    class_children = {}
-    class_defaults = {"__all__": {}}
-
-    def get_class(element):
-        return element.get("class", "__all__")
-
-    def parse_default(node, parent):
-        nonlocal class_parent
-        nonlocal class_children
-        nonlocal class_defaults
-        class_name = "__all__"
-        if "class" in node.attrib:
-            class_name = node.attrib["class"]
-            class_parent[class_name] = parent
-            parent = parent or "__all__"
-            if parent not in class_children:
-                class_children[parent] = []
-            class_children[parent].append(class_name)
-
-        if class_name not in class_defaults:
-            class_defaults[class_name] = {}
-        for child in node:
-            if child.tag == "default":
-                parse_default(child, node.get("class"))
-            else:
-                class_defaults[class_name][child.tag] = child.attrib
-
-    for default in root.findall("default"):
-        parse_default(default, None)
-
-    def merge_attrib(default_attrib: dict, incoming_attrib: dict):
-        attrib = default_attrib.copy()
-        attrib.update(incoming_attrib)
-        return attrib
-
-    if isinstance(up_axis, str):
-        up_axis = "XYZ".index(up_axis.upper())
-    sqh = np.sqrt(0.5)
-    if up_axis == 0:
-        xform = wp.transform(xform.p, wp.quat(0.0, 0.0, -sqh, sqh) * xform.q)
-    elif up_axis == 2:
-        xform = wp.transform(xform.p, wp.quat(sqh, 0.0, 0.0, -sqh) * xform.q)
-    # do not apply scaling to the root transform
-    xform = wp.transform(np.array(xform.p) / scale, xform.q)
-
-    def parse_float(attrib, key, default):
-        if key in attrib:
-            return float(attrib[key])
-        else:
-            return default
-
-    def parse_vec(attrib, key, default):
-        if key in attrib:
-            out = np.fromstring(attrib[key], sep=" ", dtype=np.float32)
-        else:
-            out = np.array(default, dtype=np.float32)
-
-        length = len(out)
-        if length == 1:
-            return wp.vec(len(default), wp.float32)(out[0], out[0], out[0])
-
-        return wp.vec(length, wp.float32)(out)
-
-    def parse_orientation(attrib):
-        if "quat" in attrib:
-            wxyz = np.fromstring(attrib["quat"], sep=" ")
-            return wp.normalize(wp.quat(*wxyz[1:], wxyz[0]))
-        if "euler" in attrib:
-            euler = np.fromstring(attrib["euler"], sep=" ")
-            if use_degrees:
-                euler *= np.pi / 180
-            return wp.sim.quat_from_euler(wp.vec3(euler), *euler_seq)
-        if "axisangle" in attrib:
-            axisangle = np.fromstring(attrib["axisangle"], sep=" ")
-            angle = axisangle[3]
-            if use_degrees:
-                angle *= np.pi / 180
-            axis = wp.normalize(wp.vec3(*axisangle[:3]))
-            return wp.quat_from_axis_angle(axis, float(angle))
-        if "xyaxes" in attrib:
-            xyaxes = np.fromstring(attrib["xyaxes"], sep=" ")
-            xaxis = wp.normalize(wp.vec3(*xyaxes[:3]))
-            zaxis = wp.normalize(wp.vec3(*xyaxes[3:]))
-            yaxis = wp.normalize(wp.cross(zaxis, xaxis))
-            rot_matrix = np.array([xaxis, yaxis, zaxis]).T
-            return wp.quat_from_matrix(rot_matrix)
-        if "zaxis" in attrib:
-            zaxis = np.fromstring(attrib["zaxis"], sep=" ")
-            zaxis = wp.normalize(wp.vec3(*zaxis))
-            xaxis = wp.normalize(wp.cross(wp.vec3(0, 0, 1), zaxis))
-            yaxis = wp.normalize(wp.cross(zaxis, xaxis))
-            rot_matrix = np.array([xaxis, yaxis, zaxis]).T
-            return wp.quat_from_matrix(rot_matrix)
-        return wp.quat_identity()
-
-    def parse_shapes(defaults, body_name, link, geoms, density, visible=True, just_visual=False, incoming_xform=None):
-        shapes = []
-        for geo_count, geom in enumerate(geoms):
-            geom_defaults = defaults
-            if "class" in geom.attrib:
-                geom_class = geom.attrib["class"]
-                ignore_geom = False
-                for pattern in ignore_classes:
-                    if re.match(pattern, geom_class):
-                        ignore_geom = True
-                        break
-                if ignore_geom:
-                    continue
-                if geom_class in class_defaults:
-                    geom_defaults = merge_attrib(defaults, class_defaults[geom_class])
-            if "geom" in geom_defaults:
-                geom_attrib = merge_attrib(geom_defaults["geom"], geom.attrib)
-            else:
-                geom_attrib = geom.attrib
-
-            geom_name = geom_attrib.get("name", f"{body_name}_geom_{geo_count}{'_visual' if just_visual else ''}")
-            geom_type = geom_attrib.get("type", "sphere")
-            if "mesh" in geom_attrib:
-                geom_type = "mesh"
-
-            ignore_geom = False
-            for pattern in ignore_names:
-                if re.match(pattern, geom_name):
-                    ignore_geom = True
-                    break
-            if ignore_geom:
-                continue
-
-            geom_size = parse_vec(geom_attrib, "size", [1.0, 1.0, 1.0]) * scale
-            geom_pos = parse_vec(geom_attrib, "pos", (0.0, 0.0, 0.0)) * scale
-            geom_rot = parse_orientation(geom_attrib)
-            geom_density = parse_float(geom_attrib, "density", density)
-
-            if incoming_xform is not None:
-                geom_pos = wp.transform_point(incoming_xform, geom_pos)
-                geom_rot = incoming_xform.q * geom_rot
-
-            if geom_type == "sphere":
-                s = builder.add_shape_sphere(
-                    link,
-                    pos=geom_pos,
-                    rot=geom_rot,
-                    radius=geom_size[0],
-                    density=geom_density,
-                    is_visible=visible,
-                    has_ground_collision=not just_visual,
-                    has_shape_collision=not just_visual,
-                    **contact_vars,
-                )
-                shapes.append(s)
-
-            elif geom_type == "box":
-                s = builder.add_shape_box(
-                    link,
-                    pos=geom_pos,
-                    rot=geom_rot,
-                    hx=geom_size[0],
-                    hy=geom_size[1],
-                    hz=geom_size[2],
-                    density=geom_density,
-                    is_visible=visible,
-                    has_ground_collision=not just_visual,
-                    has_shape_collision=not just_visual,
-                    **contact_vars,
-                )
-                shapes.append(s)
-
-            elif geom_type == "mesh" and parse_meshes:
-                import trimesh
-
-                # use force='mesh' to load the mesh as a trimesh object
-                # with baked in transforms, e.g. from COLLADA files
-                stl_file = mesh_assets[geom_attrib["mesh"]]["file"]
-                m = trimesh.load(stl_file, force="mesh")
-                if "mesh" in geom_defaults:
-                    mesh_scale = parse_vec(geom_defaults["mesh"], "scale", mesh_assets[geom_attrib["mesh"]]["scale"])
-                else:
-                    mesh_scale = mesh_assets[geom_attrib["mesh"]]["scale"]
-                scaling = np.array(mesh_scale) * scale
-                # as per the Mujoco XML reference, ignore geom size attribute
-                assert len(geom_size) == 3, "need to specify size for mesh geom"
-
-                if hasattr(m, "geometry"):
-                    # multiple meshes are contained in a scene
-                    for m_geom in m.geometry.values():
-                        m_vertices = np.array(m_geom.vertices, dtype=np.float32) * scaling
-                        m_faces = np.array(m_geom.faces.flatten(), dtype=np.int32)
-                        m_mesh = Mesh(m_vertices, m_faces)
-                        s = builder.add_shape_mesh(
-                            body=link,
-                            pos=geom_pos,
-                            rot=geom_rot,
-                            mesh=m_mesh,
-                            density=density,
-                            is_visible=visible,
-                            has_ground_collision=not just_visual,
-                            has_shape_collision=not just_visual,
-                            **contact_vars,
-                        )
-                        shapes.append(s)
-                else:
-                    # a single mesh
-                    m_vertices = np.array(m.vertices, dtype=np.float32) * scaling
-                    m_faces = np.array(m.faces.flatten(), dtype=np.int32)
-                    m_mesh = Mesh(m_vertices, m_faces)
-                    s = builder.add_shape_mesh(
-                        body=link,
-                        pos=geom_pos,
-                        rot=geom_rot,
-                        mesh=m_mesh,
-                        density=density,
-                        is_visible=visible,
-                        has_ground_collision=not just_visual,
-                        has_shape_collision=not just_visual,
-                        **contact_vars,
-                    )
-                    shapes.append(s)
-
-            elif geom_type in {"capsule", "cylinder"}:
-                if "fromto" in geom_attrib:
-                    geom_fromto = parse_vec(geom_attrib, "fromto", (0.0, 0.0, 0.0, 1.0, 0.0, 0.0))
-
-                    start = wp.vec3(geom_fromto[0:3]) * scale
-                    end = wp.vec3(geom_fromto[3:6]) * scale
-
-                    # compute rotation to align the Warp capsule (along x-axis), with mjcf fromto direction
-                    axis = wp.normalize(end - start)
-                    angle = math.acos(wp.dot(axis, wp.vec3(0.0, 1.0, 0.0)))
-                    axis = wp.normalize(wp.cross(axis, wp.vec3(0.0, 1.0, 0.0)))
-
-                    geom_pos = (start + end) * 0.5
-                    geom_rot = wp.quat_from_axis_angle(axis, -angle)
-
-                    geom_radius = geom_size[0]
-                    geom_height = wp.length(end - start) * 0.5
-                    geom_up_axis = 1
-
-                else:
-                    geom_radius = geom_size[0]
-                    geom_height = geom_size[1]
-                    geom_up_axis = up_axis
-
-                if geom_type == "cylinder":
-                    s = builder.add_shape_cylinder(
-                        link,
-                        pos=geom_pos,
-                        rot=geom_rot,
-                        radius=geom_radius,
-                        half_height=geom_height,
-                        density=density,
-                        up_axis=geom_up_axis,
-                        is_visible=visible,
-                        has_ground_collision=not just_visual,
-                        has_shape_collision=not just_visual,
-                        **contact_vars,
-                    )
-                    shapes.append(s)
-                else:
-                    s = builder.add_shape_capsule(
-                        link,
-                        pos=geom_pos,
-                        rot=geom_rot,
-                        radius=geom_radius,
-                        half_height=geom_height,
-                        density=density,
-                        up_axis=geom_up_axis,
-                        is_visible=visible,
-                        has_ground_collision=not just_visual,
-                        has_shape_collision=not just_visual,
-                        **contact_vars,
-                    )
-                    shapes.append(s)
-
-            elif geom_type == "plane":
-                normal = wp.quat_rotate(geom_rot, wp.vec3(0.0, 0.0, 1.0))
-                p = wp.dot(geom_pos, normal)
-                s = builder.add_shape_plane(
-                    body=link,
-                    plane=(*normal, p),
-                    width=geom_size[0],
-                    length=geom_size[1],
-                    is_visible=visible,
-                    has_ground_collision=False,
-                    has_shape_collision=not just_visual,
-                    **contact_vars,
-                )
-                shapes.append(s)
-
-            else:
-                if verbose:
-                    print(f"MJCF parsing shape {geom_name} issue: geom type {geom_type} is unsupported")
-
-        return shapes
-
-    def parse_body(body, parent, incoming_defaults: dict, childclass: str | None = None):
-        body_class = body.get("class")
-        if body_class is None:
-            body_class = childclass
-            defaults = incoming_defaults
-        else:
-            for pattern in ignore_classes:
-                if re.match(pattern, body_class):
-                    return
-            defaults = merge_attrib(incoming_defaults, class_defaults[body_class])
-        if "body" in defaults:
-            body_attrib = merge_attrib(defaults["body"], body.attrib)
-        else:
-            body_attrib = body.attrib
-        body_name = body_attrib["name"]
-        body_name = body_name.replace("-", "_")  # ensure valid USD path
-        body_pos = parse_vec(body_attrib, "pos", (0.0, 0.0, 0.0))
-        body_ori = parse_orientation(body_attrib)
-        if parent == -1:
-            body_pos = wp.transform_point(xform, body_pos)
-            body_ori = xform.q * body_ori
-        body_pos *= scale
-
-        joint_armature = []
-        joint_name = []
-        joint_pos = []
-
-        linear_axes = []
-        angular_axes = []
-        joint_type = None
-
-        freejoint_tags = body.findall("freejoint")
-        if len(freejoint_tags) > 0:
-            joint_type = wp.sim.JOINT_FREE
-            joint_name.append(freejoint_tags[0].attrib.get("name", f"{body_name}_freejoint"))
-            joint_armature.append(0.0)
-        else:
-            joints = body.findall("joint")
-            for _i, joint in enumerate(joints):
-                joint_defaults = defaults
-                if "class" in joint.attrib:
-                    joint_class = joint.attrib["class"]
-                    if joint_class in class_defaults:
-                        joint_defaults = merge_attrib(joint_defaults, class_defaults[joint_class])
-                if "joint" in joint_defaults:
-                    joint_attrib = merge_attrib(joint_defaults["joint"], joint.attrib)
-                else:
-                    joint_attrib = joint.attrib
-
-                # default to hinge if not specified
-                joint_type_str = joint_attrib.get("type", "hinge")
-
-                joint_name.append(joint_attrib["name"])
-                joint_pos.append(parse_vec(joint_attrib, "pos", (0.0, 0.0, 0.0)) * scale)
-                joint_range = parse_vec(joint_attrib, "range", (joint_limit_lower, joint_limit_upper))
-                joint_armature.append(parse_float(joint_attrib, "armature", armature) * armature_scale)
-
-                if joint_type_str == "free":
-                    joint_type = wp.sim.JOINT_FREE
-                    break
-                if joint_type_str == "fixed":
-                    joint_type = wp.sim.JOINT_FIXED
-                    break
-                is_angular = joint_type_str == "hinge"
-                mode = wp.sim.JOINT_MODE_FORCE
-                if stiffness > 0.0 or "stiffness" in joint_attrib:
-                    mode = wp.sim.JOINT_MODE_TARGET_POSITION
-                axis_vec = parse_vec(joint_attrib, "axis", (0.0, 0.0, 0.0))
-                limit_lower = np.deg2rad(joint_range[0]) if is_angular and use_degrees else joint_range[0]
-                limit_upper = np.deg2rad(joint_range[1]) if is_angular and use_degrees else joint_range[1]
-                ax = wp.sim.JointAxis(
-                    axis=axis_vec,
-                    limit_lower=limit_lower,
-                    limit_upper=limit_upper,
-                    target_ke=parse_float(joint_attrib, "stiffness", stiffness),
-                    target_kd=parse_float(joint_attrib, "damping", damping),
-                    limit_ke=limit_ke,
-                    limit_kd=limit_kd,
-                    mode=mode,
-                )
-                if is_angular:
-                    angular_axes.append(ax)
-                else:
-                    linear_axes.append(ax)
-
-        link = builder.add_body(
-            origin=wp.transform(body_pos, body_ori),  # will be evaluated in fk()
-            armature=joint_armature[0] if len(joint_armature) > 0 else armature,
-            name=body_name,
-        )
-
-        if joint_type is None:
-            if len(linear_axes) == 0:
-                if len(angular_axes) == 0:
-                    joint_type = wp.sim.JOINT_FIXED
-                elif len(angular_axes) == 1:
-                    joint_type = wp.sim.JOINT_REVOLUTE
-                elif len(angular_axes) == 2:
-                    joint_type = wp.sim.JOINT_UNIVERSAL
-                elif len(angular_axes) == 3:
-                    joint_type = wp.sim.JOINT_COMPOUND
-            elif len(linear_axes) == 1 and len(angular_axes) == 0:
-                joint_type = wp.sim.JOINT_PRISMATIC
-            else:
-                joint_type = wp.sim.JOINT_D6
-
-        if len(freejoint_tags) > 0 and parent == -1 and (base_joint is not None or floating is not None):
-            joint_pos = joint_pos[0] if len(joint_pos) > 0 else (0.0, 0.0, 0.0)
-            _xform = wp.transform(body_pos + joint_pos, body_ori)
-
-            if base_joint is not None:
-                # in case of a given base joint, the position is applied first, the rotation only
-                # after the base joint itself to not rotate its axis
-                base_parent_xform = wp.transform(_xform.p, wp.quat_identity())
-                base_child_xform = wp.transform((0.0, 0.0, 0.0), wp.quat_inverse(_xform.q))
-                if isinstance(base_joint, str):
-                    axes = base_joint.lower().split(",")
-                    axes = [ax.strip() for ax in axes]
-                    linear_axes = [ax[-1] for ax in axes if ax[0] in {"l", "p"}]
-                    angular_axes = [ax[-1] for ax in axes if ax[0] in {"a", "r"}]
-                    axes = {
-                        "x": [1.0, 0.0, 0.0],
-                        "y": [0.0, 1.0, 0.0],
-                        "z": [0.0, 0.0, 1.0],
-                    }
-                    builder.add_joint_d6(
-                        linear_axes=[wp.sim.JointAxis(axes[a]) for a in linear_axes],
-                        angular_axes=[wp.sim.JointAxis(axes[a]) for a in angular_axes],
-                        parent_xform=base_parent_xform,
-                        child_xform=base_child_xform,
-                        parent=-1,
-                        child=link,
-                        name="base_joint",
-                    )
-                elif isinstance(base_joint, dict):
-                    base_joint["parent"] = -1
-                    base_joint["child"] = root
-                    base_joint["parent_xform"] = base_parent_xform
-                    base_joint["child_xform"] = base_child_xform
-                    base_joint["name"] = "base_joint"
-                    builder.add_joint(**base_joint)
-                else:
-                    raise ValueError(
-                        "base_joint must be a comma-separated string of joint axes or a dict with joint parameters"
-                    )
-            elif floating:
-                builder.add_joint_free(link, name="floating_base")
-
-                # set dofs to transform
-                start = builder.joint_q_start[link]
-
-                builder.joint_q[start + 0] = _xform.p[0]
-                builder.joint_q[start + 1] = _xform.p[1]
-                builder.joint_q[start + 2] = _xform.p[2]
-
-                builder.joint_q[start + 3] = _xform.q[0]
-                builder.joint_q[start + 4] = _xform.q[1]
-                builder.joint_q[start + 5] = _xform.q[2]
-                builder.joint_q[start + 6] = _xform.q[3]
-            else:
-                builder.add_joint_fixed(-1, link, parent_xform=_xform, name="fixed_base")
-
-        else:
-            joint_pos = joint_pos[0] if len(joint_pos) > 0 else (0.0, 0.0, 0.0)
-            if len(joint_name) == 0:
-                joint_name = [f"{body_name}_joint"]
-            builder.add_joint(
-                joint_type,
-                parent,
-                link,
-                linear_axes,
-                angular_axes,
-                name="_".join(joint_name),
-                parent_xform=wp.transform(body_pos + joint_pos, body_ori),
-                child_xform=wp.transform(joint_pos, wp.quat_identity()),
-                armature=joint_armature[0] if len(joint_armature) > 0 else armature,
-            )
-
-        # -----------------
-        # add shapes
-
-        geoms = body.findall("geom")
-        visuals = []
-        colliders = []
-        for geo_count, geom in enumerate(geoms):
-            geom_defaults = defaults
-            if "class" in geom.attrib:
-                geom_class = geom.attrib["class"]
-                ignore_geom = False
-                for pattern in ignore_classes:
-                    if re.match(pattern, geom_class):
-                        ignore_geom = True
-                        break
-                if ignore_geom:
-                    continue
-                if geom_class in class_defaults:
-                    geom_defaults = merge_attrib(defaults, class_defaults[geom_class])
-            if "geom" in geom_defaults:
-                geom_attrib = merge_attrib(geom_defaults["geom"], geom.attrib)
-            else:
-                geom_attrib = geom.attrib
-
-            geom_name = geom_attrib.get("name", f"{body_name}_geom_{geo_count}")
-
-            if "class" in geom.attrib:
-                for pattern in visual_classes:
-                    if re.match(pattern, geom_class):
-                        visuals.append(geom)
-                        break
-                for pattern in collider_classes:
-                    if re.match(pattern, geom_class):
-                        colliders.append(geom)
-                        break
-            else:
-                no_class_class = "collision" if no_class_as_colliders else "visual"
-                if verbose:
-                    print(f"MJCF parsing shape {geom_name} issue: no class defined for geom, assuming {no_class_class}")
-                if no_class_as_colliders:
-                    colliders.append(geom)
-                else:
-                    visuals.append(geom)
-
-        if parse_visuals_as_colliders:
-            colliders = visuals
-        else:
-            s = parse_shapes(
-                defaults, body_name, link, visuals, density=0.0, just_visual=True, visible=not hide_visuals
-            )
-            visual_shapes.extend(s)
-
-        show_colliders = force_show_colliders
-        if parse_visuals_as_colliders:
-            show_colliders = True
-        elif len(visuals) == 0:
-            # we need to show the collision shapes since there are no visual shapes
-            show_colliders = True
-
-        parse_shapes(defaults, body_name, link, colliders, density, visible=show_colliders)
-
-        m = builder.body_mass[link]
-        if not ignore_inertial_definitions and body.find("inertial") is not None:
-            inertial = body.find("inertial")
-            if "inertial" in defaults:
-                inertial_attrib = merge_attrib(defaults["inertial"], inertial.attrib)
-            else:
-                inertial_attrib = inertial.attrib
-            # overwrite inertial parameters if defined
-            inertial_pos = parse_vec(inertial_attrib, "pos", (0.0, 0.0, 0.0)) * scale
-            inertial_rot = parse_orientation(inertial_attrib)
-
-            inertial_frame = wp.transform(inertial_pos, inertial_rot)
-            com = inertial_frame.p
-            if inertial_attrib.get("diaginertia") is not None:
-                diaginertia = parse_vec(inertial_attrib, "diaginertia", None)
-                I_m = np.zeros((3, 3))
-                I_m[0, 0] = diaginertia[0] * scale**2
-                I_m[1, 1] = diaginertia[1] * scale**2
-                I_m[2, 2] = diaginertia[2] * scale**2
-            else:
-                fullinertia = inertial_attrib.get("fullinertia")
-                assert fullinertia is not None
-                fullinertia = np.fromstring(fullinertia, sep=" ", dtype=np.float32)
-                I_m = np.zeros((3, 3))
-                I_m[0, 0] = fullinertia[0] * scale**2
-                I_m[1, 1] = fullinertia[1] * scale**2
-                I_m[2, 2] = fullinertia[2] * scale**2
-                I_m[0, 1] = fullinertia[3] * scale**2
-                I_m[0, 2] = fullinertia[4] * scale**2
-                I_m[1, 2] = fullinertia[5] * scale**2
-                I_m[1, 0] = I_m[0, 1]
-                I_m[2, 0] = I_m[0, 2]
-                I_m[2, 1] = I_m[1, 2]
-            rot = wp.quat_to_matrix(inertial_frame.q)
-            I_m = rot @ wp.mat33(I_m)
-            m = float(inertial_attrib.get("mass", "0"))
-            builder.body_mass[link] = m
-            builder.body_inv_mass[link] = 1.0 / m if m > 0.0 else 0.0
-            builder.body_com[link] = com
-            builder.body_inertia[link] = I_m
-            if any(x for x in I_m):
-                builder.body_inv_inertia[link] = wp.inverse(I_m)
-            else:
-                builder.body_inv_inertia[link] = I_m
-        if m == 0.0 and ensure_nonstatic_links:
-            # set the mass to something nonzero to ensure the body is dynamic
-            m = static_link_mass
-            # cube with side length 0.5
-            I_m = wp.mat33(np.eye(3)) * m / 12.0 * (0.5 * scale) ** 2 * 2.0
-            I_m += wp.mat33(armature * np.eye(3))
-            builder.body_mass[link] = m
-            builder.body_inv_mass[link] = 1.0 / m
-            builder.body_inertia[link] = I_m
-            builder.body_inv_inertia[link] = wp.inverse(I_m)
-
-        # -----------------
-        # recurse
-
-        for child in body.findall("body"):
-            _childclass = body.get("childclass")
-            if _childclass is None:
-                _childclass = childclass
-                _incoming_defaults = defaults
-            else:
-                _incoming_defaults = merge_attrib(defaults, class_defaults[_childclass])
-            parse_body(child, link, _incoming_defaults, childclass=_childclass)
-
-    # -----------------
-    # start articulation
-
-    visual_shapes = []
-    start_shape_count = len(builder.shape_geo_type)
-    builder.add_articulation()
-
-    world = root.find("worldbody")
-    world_class = get_class(world)
-    world_defaults = merge_attrib(class_defaults["__all__"], class_defaults.get(world_class, {}))
-
-    # -----------------
-    # add bodies
-
-    for body in world.findall("body"):
-        parse_body(body, -1, world_defaults)
-
-    # -----------------
-    # add static geoms
-
-    parse_shapes(world_defaults, "world", -1, world.findall("geom"), density, incoming_xform=xform)
-
-    end_shape_count = len(builder.shape_geo_type)
-
-    for i in range(start_shape_count, end_shape_count):
-        for j in visual_shapes:
-            builder.shape_collision_filter_pairs.add((i, j))
-
-    if not enable_self_collisions:
-        for i in range(start_shape_count, end_shape_count):
-            for j in range(i + 1, end_shape_count):
-                builder.shape_collision_filter_pairs.add((i, j))
-
-    if collapse_fixed_joints:
-        builder.collapse_fixed_joints()
diff --git a/warp/sim/import_snu.py b/warp/sim/import_snu.py
deleted file mode 100644
index dd4677b1..00000000
--- a/warp/sim/import_snu.py
+++ /dev/null
@@ -1,227 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-import os
-import xml.etree.ElementTree as ET
-
-import numpy as np
-
-import warp as wp
-
-# SNU file format parser
-
-
-class MuscleUnit:
-    def __init__(self):
-        self.name = ""
-        self.bones = []
-        self.points = []
-
-
-class Skeleton:
-    def __init__(self, root_xform, skeleton_file, muscle_file, builder, filter, armature=0.0):
-        self.parse_skeleton(skeleton_file, builder, filter, root_xform, armature)
-        self.parse_muscles(muscle_file, builder)
-
-    def parse_skeleton(self, filename, builder, filter, root_xform, armature):
-        file = ET.parse(filename)
-        root = file.getroot()
-
-        self.node_map = {}  # map node names to link indices
-        self.xform_map = {}  # map node names to parent transforms
-        self.mesh_map = {}  # map mesh names to link indices objects
-
-        self.coord_start = builder.joint_coord_count
-        self.dof_start = builder.joint_dof_count
-
-        type_map = {
-            "Ball": wp.sim.JOINT_BALL,
-            "Revolute": wp.sim.JOINT_REVOLUTE,
-            "Prismatic": wp.sim.JOINT_PRISMATIC,
-            "Free": wp.sim.JOINT_FREE,
-            "Fixed": wp.sim.JOINT_FIXED,
-        }
-
-        builder.add_articulation()
-
-        for child in root:
-            if child.tag == "Node":
-                body = child.find("Body")
-                joint = child.find("Joint")
-
-                name = child.attrib["name"]
-                parent = child.attrib["parent"]
-                parent_X_s = wp.transform_identity()
-
-                if parent in self.node_map:
-                    parent_link = self.node_map[parent]
-                    parent_X_s = self.xform_map[parent]
-                else:
-                    parent_link = -1
-
-                body_xform = body.find("Transformation")
-                joint_xform = joint.find("Transformation")
-
-                body_mesh = body.attrib["obj"]
-                body_size = np.fromstring(body.attrib["size"], sep=" ")
-                # body_type = body.attrib["type"]
-                # body_mass = body.attrib["mass"]
-
-                body_R_s = np.fromstring(body_xform.attrib["linear"], sep=" ").reshape((3, 3))
-                body_t_s = np.fromstring(body_xform.attrib["translation"], sep=" ")
-
-                joint_R_s = np.fromstring(joint_xform.attrib["linear"], sep=" ").reshape((3, 3))
-                joint_t_s = np.fromstring(joint_xform.attrib["translation"], sep=" ")
-
-                joint_type = type_map[joint.attrib["type"]]
-
-                joint_lower = np.array([-1.0e3])
-                joint_upper = np.array([1.0e3])
-
-                try:
-                    joint_lower = np.fromstring(joint.attrib["lower"], sep=" ")
-                    joint_upper = np.fromstring(joint.attrib["upper"], sep=" ")
-                except Exception:
-                    pass
-
-                if "axis" in joint.attrib:
-                    joint_axis = np.fromstring(joint.attrib["axis"], sep=" ")
-                else:
-                    joint_axis = np.array((0.0, 0.0, 0.0))
-
-                body_X_s = wp.transform(body_t_s, wp.quat_from_matrix(body_R_s))
-                joint_X_s = wp.transform(joint_t_s, wp.quat_from_matrix(joint_R_s))
-
-                mesh_base = os.path.splitext(body_mesh)[0]
-                # mesh_file = mesh_base + ".usd"
-
-                # -----------------------------------
-                # one time conversion, put meshes into local body space (and meter units)
-
-                # stage = Usd.Stage.Open("./assets/snu/OBJ/" + mesh_file)
-                # geom = UsdGeom.Mesh.Get(stage, "/" + mesh_base + "_obj/defaultobject/defaultobject")
-
-                # body_X_bs = wp.transform_inverse(body_X_s)
-                # joint_X_bs = wp.transform_inverse(joint_X_s)
-
-                # points = geom.GetPointsAttr().Get()
-                # for i in range(len(points)):
-
-                #     p = wp.transform_point(joint_X_bs, points[i]*0.01)
-                #     points[i] = Gf.Vec3f(p.tolist())  # cm -> meters
-
-                # geom.GetPointsAttr().Set(points)
-
-                # extent = UsdGeom.Boundable.ComputeExtentFromPlugins(geom, 0.0)
-                # geom.GetExtentAttr().Set(extent)
-                # stage.Save()
-
-                # --------------------------------------
-                link = -1
-
-                if len(filter) == 0 or name in filter:
-                    joint_X_p = wp.transform_multiply(wp.transform_inverse(parent_X_s), joint_X_s)
-                    body_X_c = wp.transform_multiply(wp.transform_inverse(joint_X_s), body_X_s)
-
-                    if parent_link == -1:
-                        joint_X_p = wp.transform_identity()
-
-                    # add link
-                    link = builder.add_body(
-                        parent=parent_link,
-                        origin=wp.transform_multiply(root_xform, joint_X_s),
-                        joint_xform=joint_X_p,
-                        joint_axis=joint_axis,
-                        joint_type=joint_type,
-                        joint_target_ke=5.0,
-                        joint_target_kd=2.0,
-                        joint_limit_lower=joint_lower[0],
-                        joint_limit_upper=joint_upper[0],
-                        joint_limit_ke=1.0e3,
-                        joint_limit_kd=1.0e2,
-                        joint_armature=armature,
-                    )
-
-                    # add shape
-                    builder.add_shape_box(
-                        body=link,
-                        pos=body_X_c.p,
-                        rot=body_X_c.q,
-                        hx=body_size[0] * 0.5,
-                        hy=body_size[1] * 0.5,
-                        hz=body_size[2] * 0.5,
-                        ke=1.0e3 * 5.0,
-                        kd=1.0e2 * 2.0,
-                        kf=1.0e3,
-                        mu=0.5,
-                    )
-
-                # add lookup in name->link map
-                # save parent transform
-                self.xform_map[name] = joint_X_s
-                self.node_map[name] = link
-                self.mesh_map[mesh_base] = link
-
-    def parse_muscles(self, filename, builder):
-        # list of MuscleUnits
-        muscles = []
-
-        file = ET.parse(filename)
-        root = file.getroot()
-
-        self.muscle_start = len(builder.muscle_activation)
-
-        for child in root:
-            if child.tag == "Unit":
-                unit_name = child.attrib["name"]
-                unit_f0 = float(child.attrib["f0"])
-                unit_lm = float(child.attrib["lm"])
-                unit_lt = float(child.attrib["lt"])
-                unit_lmax = float(child.attrib["lmax"])
-                unit_pen = float(child.attrib["pen_angle"])
-
-                m = MuscleUnit()
-                m.name = unit_name
-
-                incomplete = False
-
-                for waypoint in child.iter("Waypoint"):
-                    way_bone = waypoint.attrib["body"]
-                    way_link = self.node_map[way_bone]
-                    way_loc = np.fromstring(waypoint.attrib["p"], sep=" ", dtype=np.float32)
-
-                    if way_link == -1:
-                        incomplete = True
-                        break
-
-                    # transform loc to joint local space
-                    joint_X_s = self.xform_map[way_bone]
-
-                    way_loc = wp.transform_point(wp.transform_inverse(joint_X_s), way_loc)
-
-                    m.bones.append(way_link)
-                    m.points.append(way_loc)
-
-                if not incomplete:
-                    muscles.append(m)
-                    builder.add_muscle(
-                        m.bones, m.points, f0=unit_f0, lm=unit_lm, lt=unit_lt, lmax=unit_lmax, pen=unit_pen
-                    )
-
-        self.muscles = muscles
-
-
-def parse_snu(root_xform, skeleton_file, muscle_file, builder, filter, armature=0.0):
-    return Skeleton(root_xform, skeleton_file, muscle_file, builder, filter, armature=0.0)
diff --git a/warp/sim/import_urdf.py b/warp/sim/import_urdf.py
deleted file mode 100644
index 63e46518..00000000
--- a/warp/sim/import_urdf.py
+++ /dev/null
@@ -1,579 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-import os
-import xml.etree.ElementTree as ET
-from typing import Union
-
-import numpy as np
-
-import warp as wp
-from warp.sim.model import Mesh
-
-
-def parse_urdf(
-    urdf_filename,
-    builder,
-    xform=None,
-    floating=False,
-    base_joint: Union[dict, str, None] = None,
-    density=1000.0,
-    stiffness=100.0,
-    damping=10.0,
-    armature=0.0,
-    contact_ke=1.0e4,
-    contact_kd=1.0e3,
-    contact_kf=1.0e2,
-    contact_ka=0.0,
-    contact_mu=0.25,
-    contact_restitution=0.5,
-    contact_thickness=0.0,
-    limit_ke=100.0,
-    limit_kd=10.0,
-    joint_limit_lower=-1e6,
-    joint_limit_upper=1e6,
-    scale=1.0,
-    hide_visuals=False,
-    parse_visuals_as_colliders=False,
-    force_show_colliders=False,
-    enable_self_collisions=True,
-    ignore_inertial_definitions=True,
-    ensure_nonstatic_links=True,
-    static_link_mass=1e-2,
-    collapse_fixed_joints=False,
-):
-    """
-    Parses a URDF file and adds the bodies and joints to the given ModelBuilder.
-
-    Args:
-        urdf_filename (str): The filename of the URDF file to parse.
-        builder (ModelBuilder): The :class:`ModelBuilder` to add the bodies and joints to.
-        xform (:ref:`transform <transform>`): The transform to apply to the root body.
-        floating (bool): If True, the root body is a free joint. If False, the root body is connected via a fixed joint to the world, unless a `base_joint` is defined.
-        base_joint (Union[str, dict]): The joint by which the root body is connected to the world. This can be either a string defining the joint axes of a D6 joint with comma-separated positional and angular axis names (e.g. "px,py,rz" for a D6 joint with linear axes in x, y and an angular axis in z) or a dict with joint parameters (see :meth:`ModelBuilder.add_joint`).
-        density (float): The density of the shapes in kg/m^3 which will be used to calculate the body mass and inertia.
-        stiffness (float): The stiffness of the joints.
-        damping (float): The damping of the joints.
-        armature (float): The armature of the joints (bias to add to the inertia diagonals that may stabilize the simulation).
-        contact_ke (float): The stiffness of the shape contacts (used by the Euler integrators).
-        contact_kd (float): The damping of the shape contacts (used by the Euler integrators).
-        contact_kf (float): The friction stiffness of the shape contacts (used by the Euler integrators).
-        contact_ka (float): The adhesion distance of the shape contacts (used by the Euler integrators).
-        contact_mu (float): The friction coefficient of the shape contacts.
-        contact_restitution (float): The restitution coefficient of the shape contacts.
-        contact_thickness (float): The thickness to add to the shape geometry.
-        limit_ke (float): The stiffness of the joint limits (used by the Euler integrators).
-        limit_kd (float): The damping of the joint limits (used by the Euler integrators).
-        joint_limit_lower (float): The default lower joint limit if not specified in the URDF.
-        joint_limit_upper (float): The default upper joint limit if not specified in the URDF.
-        scale (float): The scaling factor to apply to the imported mechanism.
-        hide_visuals (bool): If True, hide visual shapes.
-        parse_visuals_as_colliders (bool): If True, the geometry defined under the `<visual>` tags is used for collision handling instead of the `<collision>` geometries.
-        force_show_colliders (bool): If True, the collision shapes are always shown, even if there are visual shapes.
-        enable_self_collisions (bool): If True, self-collisions are enabled.
-        ignore_inertial_definitions (bool): If True, the inertial parameters defined in the URDF are ignored and the inertia is calculated from the shape geometry.
-        ensure_nonstatic_links (bool): If True, links with zero mass are given a small mass (see `static_link_mass`) to ensure they are dynamic.
-        static_link_mass (float): The mass to assign to links with zero mass (if `ensure_nonstatic_links` is set to True).
-        collapse_fixed_joints (bool): If True, fixed joints are removed and the respective bodies are merged.
-    """
-    if xform is None:
-        xform = wp.transform()
-
-    file = ET.parse(urdf_filename)
-    root = file.getroot()
-
-    contact_vars = {
-        "ke": contact_ke,
-        "kd": contact_kd,
-        "kf": contact_kf,
-        "ka": contact_ka,
-        "mu": contact_mu,
-        "restitution": contact_restitution,
-        "thickness": contact_thickness,
-    }
-
-    def parse_transform(element):
-        if element is None or element.find("origin") is None:
-            return wp.transform()
-        origin = element.find("origin")
-        xyz = origin.get("xyz") or "0 0 0"
-        rpy = origin.get("rpy") or "0 0 0"
-        xyz = [float(x) * scale for x in xyz.split()]
-        rpy = [float(x) for x in rpy.split()]
-        return wp.transform(xyz, wp.quat_rpy(*rpy))
-
-    def parse_shapes(link, geoms, density, incoming_xform=None, visible=True, just_visual=False):
-        shapes = []
-        # add geometry
-        for geom_group in geoms:
-            geo = geom_group.find("geometry")
-            if geo is None:
-                continue
-
-            tf = parse_transform(geom_group)
-            if incoming_xform is not None:
-                tf = incoming_xform * tf
-
-            for box in geo.findall("box"):
-                size = box.get("size") or "1 1 1"
-                size = [float(x) for x in size.split()]
-                s = builder.add_shape_box(
-                    body=link,
-                    pos=wp.vec3(tf.p),
-                    rot=wp.quat(tf.q),
-                    hx=size[0] * 0.5 * scale,
-                    hy=size[1] * 0.5 * scale,
-                    hz=size[2] * 0.5 * scale,
-                    density=density,
-                    is_visible=visible,
-                    has_ground_collision=not just_visual,
-                    has_shape_collision=not just_visual,
-                    **contact_vars,
-                )
-                shapes.append(s)
-
-            for sphere in geo.findall("sphere"):
-                s = builder.add_shape_sphere(
-                    body=link,
-                    pos=wp.vec3(tf.p),
-                    rot=wp.quat(tf.q),
-                    radius=float(sphere.get("radius") or "1") * scale,
-                    density=density,
-                    is_visible=visible,
-                    has_ground_collision=not just_visual,
-                    has_shape_collision=not just_visual,
-                    **contact_vars,
-                )
-                shapes.append(s)
-
-            for cylinder in geo.findall("cylinder"):
-                s = builder.add_shape_capsule(
-                    body=link,
-                    pos=wp.vec3(tf.p),
-                    rot=wp.quat(tf.q),
-                    radius=float(cylinder.get("radius") or "1") * scale,
-                    half_height=float(cylinder.get("length") or "1") * 0.5 * scale,
-                    density=density,
-                    up_axis=2,  # cylinders in URDF are aligned with z-axis
-                    is_visible=visible,
-                    has_ground_collision=not just_visual,
-                    has_shape_collision=not just_visual,
-                    **contact_vars,
-                )
-                shapes.append(s)
-
-            for capsule in geo.findall("capsule"):
-                s = builder.add_shape_capsule(
-                    body=link,
-                    pos=wp.vec3(tf.p),
-                    rot=wp.quat(tf.q),
-                    radius=float(capsule.get("radius") or "1") * scale,
-                    half_height=float(capsule.get("height") or "1") * 0.5 * scale,
-                    density=density,
-                    up_axis=2,  # capsules in URDF are aligned with z-axis
-                    is_visible=visible,
-                    has_ground_collision=not just_visual,
-                    has_shape_collision=not just_visual,
-                    **contact_vars,
-                )
-                shapes.append(s)
-
-            for mesh in geo.findall("mesh"):
-                filename = mesh.get("filename")
-                if filename is None:
-                    continue
-                if filename.startswith("package://"):
-                    fn = filename.replace("package://", "")
-                    package_name = fn.split("/")[0]
-                    urdf_folder = os.path.dirname(urdf_filename)
-                    # resolve file path from package name, i.e. find
-                    # the package folder from the URDF folder
-                    if package_name in urdf_folder:
-                        filename = os.path.join(urdf_folder[: urdf_folder.index(package_name)], fn)
-                    else:
-                        wp.utils.warn(
-                            f'Warning: package "{package_name}" not found in URDF folder while loading mesh at "{filename}"'
-                        )
-                elif filename.startswith("http://") or filename.startswith("https://"):
-                    # download mesh
-                    import shutil
-                    import tempfile
-
-                    import requests
-
-                    with tempfile.TemporaryDirectory() as tmpdir:
-                        # get filename extension
-                        extension = os.path.splitext(filename)[1]
-                        tmpfile = os.path.join(tmpdir, "mesh" + extension)
-                        with requests.get(filename, stream=True) as r:
-                            with open(tmpfile, "wb") as f:
-                                shutil.copyfileobj(r.raw, f)
-                        filename = tmpfile
-                else:
-                    filename = os.path.join(os.path.dirname(urdf_filename), filename)
-                if not os.path.exists(filename):
-                    wp.utils.warn(f"Warning: mesh file {filename} does not exist")
-                    continue
-
-                import trimesh
-
-                # use force='mesh' to load the mesh as a trimesh object
-                # with baked in transforms, e.g. from COLLADA files
-                m = trimesh.load(filename, force="mesh")
-                scaling = mesh.get("scale") or "1 1 1"
-                scaling = np.array([float(x) * scale for x in scaling.split()])
-                if hasattr(m, "geometry"):
-                    # multiple meshes are contained in a scene
-                    for m_geom in m.geometry.values():
-                        m_vertices = np.array(m_geom.vertices, dtype=np.float32) * scaling
-                        m_faces = np.array(m_geom.faces.flatten(), dtype=np.int32)
-                        m_mesh = Mesh(m_vertices, m_faces)
-                        s = builder.add_shape_mesh(
-                            body=link,
-                            pos=wp.vec3(tf.p),
-                            rot=wp.quat(tf.q),
-                            mesh=m_mesh,
-                            density=density,
-                            is_visible=visible,
-                            has_ground_collision=not just_visual,
-                            has_shape_collision=not just_visual,
-                            **contact_vars,
-                        )
-                        shapes.append(s)
-                else:
-                    # a single mesh
-                    m_vertices = np.array(m.vertices, dtype=np.float32) * scaling
-                    m_faces = np.array(m.faces.flatten(), dtype=np.int32)
-                    m_mesh = Mesh(m_vertices, m_faces)
-                    s = builder.add_shape_mesh(
-                        body=link,
-                        pos=wp.vec3(tf.p),
-                        rot=wp.quat(tf.q),
-                        mesh=m_mesh,
-                        density=density,
-                        is_visible=visible,
-                        has_ground_collision=not just_visual,
-                        has_shape_collision=not just_visual,
-                        **contact_vars,
-                    )
-                    shapes.append(s)
-
-        return shapes
-
-    # maps from link name -> link index
-    link_index = {}
-
-    visual_shapes = []
-
-    builder.add_articulation()
-
-    start_shape_count = len(builder.shape_geo_type)
-
-    # add links
-    for _i, urdf_link in enumerate(root.findall("link")):
-        name = urdf_link.get("name")
-        link = builder.add_body(origin=wp.transform_identity(), armature=armature, name=name)
-
-        # add ourselves to the index
-        link_index[name] = link
-
-        visuals = urdf_link.findall("visual")
-        colliders = urdf_link.findall("collision")
-
-        if parse_visuals_as_colliders:
-            colliders = visuals
-        else:
-            s = parse_shapes(link, visuals, density=0.0, just_visual=True, visible=not hide_visuals)
-            visual_shapes.extend(s)
-
-        show_colliders = force_show_colliders
-        if parse_visuals_as_colliders:
-            show_colliders = True
-        elif len(visuals) == 0:
-            # we need to show the collision shapes since there are no visual shapes
-            show_colliders = True
-
-        parse_shapes(link, colliders, density=density, visible=show_colliders)
-        m = builder.body_mass[link]
-        if not ignore_inertial_definitions and urdf_link.find("inertial") is not None:
-            # overwrite inertial parameters if defined
-            inertial = urdf_link.find("inertial")
-            inertial_frame = parse_transform(inertial)
-            com = inertial_frame.p
-            I_m = np.zeros((3, 3))
-            I_m[0, 0] = float(inertial.find("inertia").get("ixx") or "0") * scale**2
-            I_m[1, 1] = float(inertial.find("inertia").get("iyy") or "0") * scale**2
-            I_m[2, 2] = float(inertial.find("inertia").get("izz") or "0") * scale**2
-            I_m[0, 1] = float(inertial.find("inertia").get("ixy") or "0") * scale**2
-            I_m[0, 2] = float(inertial.find("inertia").get("ixz") or "0") * scale**2
-            I_m[1, 2] = float(inertial.find("inertia").get("iyz") or "0") * scale**2
-            I_m[1, 0] = I_m[0, 1]
-            I_m[2, 0] = I_m[0, 2]
-            I_m[2, 1] = I_m[1, 2]
-            rot = wp.quat_to_matrix(inertial_frame.q)
-            I_m = rot @ wp.mat33(I_m)
-            m = float(inertial.find("mass").get("value") or "0")
-            builder.body_mass[link] = m
-            builder.body_inv_mass[link] = 1.0 / m if m > 0.0 else 0.0
-            builder.body_com[link] = com
-            builder.body_inertia[link] = I_m
-            if any(x for x in I_m):
-                builder.body_inv_inertia[link] = wp.inverse(I_m)
-            else:
-                builder.body_inv_inertia[link] = I_m
-        if m == 0.0 and ensure_nonstatic_links:
-            # set the mass to something nonzero to ensure the body is dynamic
-            m = static_link_mass
-            # cube with side length 0.5
-            I_m = wp.mat33(np.eye(3)) * m / 12.0 * (0.5 * scale) ** 2 * 2.0
-            I_m += wp.mat33(armature * np.eye(3))
-            builder.body_mass[link] = m
-            builder.body_inv_mass[link] = 1.0 / m
-            builder.body_inertia[link] = I_m
-            builder.body_inv_inertia[link] = wp.inverse(I_m)
-
-    end_shape_count = len(builder.shape_geo_type)
-
-    # find joints per body
-    body_children = {name: [] for name in link_index.keys()}
-    # mapping from parent, child link names to joint
-    parent_child_joint = {}
-
-    joints = []
-    for joint in root.findall("joint"):
-        parent = joint.find("parent").get("link")
-        child = joint.find("child").get("link")
-        body_children[parent].append(child)
-        joint_data = {
-            "name": joint.get("name"),
-            "parent": parent,
-            "child": child,
-            "type": joint.get("type"),
-            "origin": parse_transform(joint),
-            "damping": damping,
-            "friction": 0.0,
-            "limit_lower": joint_limit_lower,
-            "limit_upper": joint_limit_upper,
-        }
-        if joint.find("axis") is not None:
-            joint_data["axis"] = joint.find("axis").get("xyz")
-            joint_data["axis"] = np.array([float(x) for x in joint_data["axis"].split()])
-        if joint.find("dynamics") is not None:
-            dynamics = joint.find("dynamics")
-            joint_data["damping"] = float(dynamics.get("damping") or str(damping))
-            joint_data["friction"] = float(dynamics.get("friction") or "0")
-        if joint.find("limit") is not None:
-            limit = joint.find("limit")
-            joint_data["limit_lower"] = float(limit.get("lower") or "-1e6")
-            joint_data["limit_upper"] = float(limit.get("upper") or "1e6")
-        if joint.find("mimic") is not None:
-            mimic = joint.find("mimic")
-            joint_data["mimic_joint"] = mimic.get("joint")
-            joint_data["mimic_multiplier"] = float(mimic.get("multiplier") or "1")
-            joint_data["mimic_offset"] = float(mimic.get("offset") or "0")
-
-        parent_child_joint[(parent, child)] = joint_data
-        joints.append(joint_data)
-
-    # topological sorting of joints because the FK solver will resolve body transforms
-    # in joint order and needs the parent link transform to be resolved before the child
-    visited = dict.fromkeys(link_index.keys(), False)
-    sorted_joints = []
-
-    # depth-first search
-    def dfs(joint):
-        link = joint["child"]
-        if visited[link]:
-            return
-        visited[link] = True
-
-        for child in body_children[link]:
-            if not visited[child]:
-                dfs(parent_child_joint[(link, child)])
-
-        sorted_joints.insert(0, joint)
-
-    # start DFS from each unvisited joint
-    for joint in joints:
-        if not visited[joint["parent"]]:
-            dfs(joint)
-
-    # add base joint
-    if len(sorted_joints) > 0:
-        base_link_name = sorted_joints[0]["parent"]
-    else:
-        base_link_name = next(iter(link_index.keys()))
-    root = link_index[base_link_name]
-    if base_joint is not None:
-        # in case of a given base joint, the position is applied first, the rotation only
-        # after the base joint itself to not rotate its axis
-        base_parent_xform = wp.transform(xform.p, wp.quat_identity())
-        base_child_xform = wp.transform((0.0, 0.0, 0.0), wp.quat_inverse(xform.q))
-        if isinstance(base_joint, str):
-            axes = base_joint.lower().split(",")
-            axes = [ax.strip() for ax in axes]
-            linear_axes = [ax[-1] for ax in axes if ax[0] in {"l", "p"}]
-            angular_axes = [ax[-1] for ax in axes if ax[0] in {"a", "r"}]
-            axes = {
-                "x": [1.0, 0.0, 0.0],
-                "y": [0.0, 1.0, 0.0],
-                "z": [0.0, 0.0, 1.0],
-            }
-            builder.add_joint_d6(
-                linear_axes=[wp.sim.JointAxis(axes[a]) for a in linear_axes],
-                angular_axes=[wp.sim.JointAxis(axes[a]) for a in angular_axes],
-                parent_xform=base_parent_xform,
-                child_xform=base_child_xform,
-                parent=-1,
-                child=root,
-                name="base_joint",
-            )
-        elif isinstance(base_joint, dict):
-            base_joint["parent"] = -1
-            base_joint["child"] = root
-            base_joint["parent_xform"] = base_parent_xform
-            base_joint["child_xform"] = base_child_xform
-            base_joint["name"] = "base_joint"
-            builder.add_joint(**base_joint)
-        else:
-            raise ValueError(
-                "base_joint must be a comma-separated string of joint axes or a dict with joint parameters"
-            )
-    elif floating:
-        builder.add_joint_free(root, name="floating_base")
-
-        # set dofs to transform
-        start = builder.joint_q_start[root]
-
-        builder.joint_q[start + 0] = xform.p[0]
-        builder.joint_q[start + 1] = xform.p[1]
-        builder.joint_q[start + 2] = xform.p[2]
-
-        builder.joint_q[start + 3] = xform.q[0]
-        builder.joint_q[start + 4] = xform.q[1]
-        builder.joint_q[start + 5] = xform.q[2]
-        builder.joint_q[start + 6] = xform.q[3]
-    else:
-        builder.add_joint_fixed(-1, root, parent_xform=xform, name="fixed_base")
-
-    # add joints, in topological order starting from root body
-    for joint in sorted_joints:
-        parent = link_index[joint["parent"]]
-        child = link_index[joint["child"]]
-        if child == -1:
-            # we skipped the insertion of the child body
-            continue
-
-        lower = joint["limit_lower"]
-        upper = joint["limit_upper"]
-        joint_damping = joint["damping"]
-
-        parent_xform = joint["origin"]
-        child_xform = wp.transform_identity()
-
-        joint_mode = wp.sim.JOINT_MODE_FORCE
-        if stiffness > 0.0:
-            joint_mode = wp.sim.JOINT_MODE_TARGET_POSITION
-
-        joint_params = {
-            "parent": parent,
-            "child": child,
-            "parent_xform": parent_xform,
-            "child_xform": child_xform,
-            "name": joint["name"],
-            "armature": armature,
-        }
-
-        if joint["type"] == "revolute" or joint["type"] == "continuous":
-            builder.add_joint_revolute(
-                axis=joint["axis"],
-                target_ke=stiffness,
-                target_kd=joint_damping,
-                limit_lower=lower,
-                limit_upper=upper,
-                limit_ke=limit_ke,
-                limit_kd=limit_kd,
-                mode=joint_mode,
-                **joint_params,
-            )
-        elif joint["type"] == "prismatic":
-            builder.add_joint_prismatic(
-                axis=joint["axis"],
-                target_ke=stiffness,
-                target_kd=joint_damping,
-                limit_lower=lower * scale,
-                limit_upper=upper * scale,
-                limit_ke=limit_ke,
-                limit_kd=limit_kd,
-                mode=joint_mode,
-                **joint_params,
-            )
-        elif joint["type"] == "fixed":
-            builder.add_joint_fixed(**joint_params)
-        elif joint["type"] == "floating":
-            builder.add_joint_free(**joint_params)
-        elif joint["type"] == "planar":
-            # find plane vectors perpendicular to axis
-            axis = np.array(joint["axis"])
-            axis /= np.linalg.norm(axis)
-
-            # create helper vector that is not parallel to the axis
-            helper = np.array([1, 0, 0]) if np.allclose(axis, [0, 1, 0]) else np.array([0, 1, 0])
-
-            u = np.cross(helper, axis)
-            u /= np.linalg.norm(u)
-
-            v = np.cross(axis, u)
-            v /= np.linalg.norm(v)
-
-            builder.add_joint_d6(
-                linear_axes=[
-                    wp.sim.JointAxis(
-                        u,
-                        limit_lower=lower * scale,
-                        limit_upper=upper * scale,
-                        limit_ke=limit_ke,
-                        limit_kd=limit_kd,
-                        target_ke=stiffness,
-                        target_kd=joint_damping,
-                        mode=joint_mode,
-                    ),
-                    wp.sim.JointAxis(
-                        v,
-                        limit_lower=lower * scale,
-                        limit_upper=upper * scale,
-                        limit_ke=limit_ke,
-                        limit_kd=limit_kd,
-                        target_ke=stiffness,
-                        target_kd=joint_damping,
-                        mode=joint_mode,
-                    ),
-                ],
-                **joint_params,
-            )
-        else:
-            raise Exception("Unsupported joint type: " + joint["type"])
-
-    for i in range(start_shape_count, end_shape_count):
-        for j in visual_shapes:
-            builder.shape_collision_filter_pairs.add((i, j))
-
-    if not enable_self_collisions:
-        for i in range(start_shape_count, end_shape_count):
-            for j in range(i + 1, end_shape_count):
-                builder.shape_collision_filter_pairs.add((i, j))
-
-    if collapse_fixed_joints:
-        builder.collapse_fixed_joints()
diff --git a/warp/sim/import_usd.py b/warp/sim/import_usd.py
deleted file mode 100644
index 371b7d3b..00000000
--- a/warp/sim/import_usd.py
+++ /dev/null
@@ -1,898 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-from __future__ import annotations
-
-import re
-
-import numpy as np
-
-import warp as wp
-
-
-def parse_usd(
-    source,
-    builder,
-    default_density=1.0e3,
-    only_load_enabled_rigid_bodies=False,
-    only_load_enabled_joints=True,
-    contact_ke=1e5,
-    contact_kd=250.0,
-    contact_kf=500.0,
-    contact_ka=0.0,
-    contact_mu=0.6,
-    contact_restitution=0.0,
-    contact_thickness=0.0,
-    joint_limit_ke=100.0,
-    joint_limit_kd=10.0,
-    armature=0.0,
-    invert_rotations=False,
-    verbose=False,
-    ignore_paths=None,
-):
-    """
-    Parses a Universal Scene Description (USD) stage containing UsdPhysics schema definitions for rigid-body articulations and adds the bodies, shapes and joints to the given ModelBuilder.
-
-    The USD description has to be either a path (file name or URL), or an existing USD stage instance that implements the `UsdStage <https://openusd.org/dev/api/class_usd_stage.html>`_ interface.
-
-    Args:
-        source (str | pxr.UsdStage): The file path to the USD file, or an existing USD stage instance.
-        builder (ModelBuilder): The :class:`ModelBuilder` to add the bodies and joints to.
-        default_density (float): The default density to use for bodies without a density attribute.
-        only_load_enabled_rigid_bodies (bool): If True, only rigid bodies which do not have `physics:rigidBodyEnabled` set to False are loaded.
-        only_load_enabled_joints (bool): If True, only joints which do not have `physics:jointEnabled` set to False are loaded.
-        contact_ke (float): The default contact stiffness to use, only considered by the Euler integrators.
-        contact_kd (float): The default contact damping to use, only considered by the Euler integrators.
-        contact_kf (float): The default friction stiffness to use, only considered by the Euler integrators.
-        contact_ka (float): The default adhesion distance to use, only considered by the Euler integrators.
-        contact_mu (float): The default friction coefficient to use if a shape has not friction coefficient defined.
-        contact_restitution (float): The default coefficient of restitution to use if a shape has not coefficient of restitution defined.
-        contact_thickness (float): The thickness to add to the shape geometry.
-        joint_limit_ke (float): The default stiffness to use for joint limits, only considered by the Euler integrators.
-        joint_limit_kd (float): The default damping to use for joint limits, only considered by the Euler integrators.
-        armature (float): The armature to use for the bodies.
-        invert_rotations (bool): If True, inverts any rotations defined in the shape transforms.
-        verbose (bool): If True, print additional information about the parsed USD file.
-        ignore_paths (List[str]): A list of regular expressions matching prim paths to ignore.
-
-    Returns:
-        dict: Dictionary with the following entries:
-
-        .. list-table::
-            :widths: 25 75
-
-            * - "fps"
-              - USD stage frames per second
-            * - "duration"
-              - Difference between end time code and start time code of the USD stage
-            * - "up_axis"
-              - Upper-case string of the stage's up axis ("X", "Y", or "Z")
-            * - "path_shape_map"
-              - Mapping from prim path (str) of the UsdGeom to the respective shape index in :class:`ModelBuilder`
-            * - "path_body_map"
-              - Mapping from prim path (str) of a rigid body prim (e.g. that implements the PhysicsRigidBodyAPI) to the respective body index in :class:`ModelBuilder`
-            * - "path_shape_scale"
-              - Mapping from prim path (str) of the UsdGeom to its respective 3D world scale
-            * - "mass_unit"
-              - The stage's Kilograms Per Unit (KGPU) definition (1.0 by default)
-            * - "linear_unit"
-              - The stage's Meters Per Unit (MPU) definition (1.0 by default)
-
-
-    Note:
-        This importer is experimental and only supports a subset of the USD Physics schema. Please report any issues you encounter.
-    """
-    try:
-        from pxr import Usd, UsdGeom, UsdPhysics
-    except ImportError as e:
-        raise ImportError("Failed to import pxr. Please install USD (e.g. via `pip install usd-core`).") from e
-
-    if ignore_paths is None:
-        ignore_paths = []
-
-    def get_attribute(prim, name):
-        if "*" in name:
-            regex = name.replace("*", ".*")
-            for attr in prim.GetAttributes():
-                if re.match(regex, attr.GetName()):
-                    return attr
-        else:
-            return prim.GetAttribute(name)
-
-    def has_attribute(prim, name):
-        attr = get_attribute(prim, name)
-        return attr.IsValid() and attr.HasAuthoredValue()
-
-    def parse_float(prim, name, default=None):
-        attr = get_attribute(prim, name)
-        if not attr or not attr.HasAuthoredValue():
-            return default
-        val = attr.Get()
-        if np.isfinite(val):
-            return val
-        return default
-
-    def parse_quat(prim, name, default=None):
-        attr = get_attribute(prim, name)
-        if not attr or not attr.HasAuthoredValue():
-            return default
-        val = attr.Get()
-        if invert_rotations:
-            quat = wp.quat(*val.imaginary, -val.real)
-        else:
-            quat = wp.quat(*val.imaginary, val.real)
-        l = wp.length(quat)
-        if np.isfinite(l) and l > 0.0:
-            return quat
-        return default
-
-    def parse_vec(prim, name, default=None):
-        attr = get_attribute(prim, name)
-        if not attr or not attr.HasAuthoredValue():
-            return default
-        val = attr.Get()
-        if np.isfinite(val).all():
-            return np.array(val, dtype=np.float32)
-        return default
-
-    def parse_generic(prim, name, default=None):
-        attr = get_attribute(prim, name)
-        if not attr or not attr.HasAuthoredValue():
-            return default
-        return attr.Get()
-
-    def str2axis(s: str) -> np.ndarray:
-        axis = np.zeros(3, dtype=np.float32)
-        axis["XYZ".index(s.upper())] = 1.0
-        return axis
-
-    if isinstance(source, str):
-        stage = Usd.Stage.Open(source, Usd.Stage.LoadAll)
-    else:
-        stage = source
-
-    mass_unit = 1.0
-    try:
-        if UsdPhysics.StageHasAuthoredKilogramsPerUnit(stage):
-            mass_unit = UsdPhysics.GetStageKilogramsPerUnit(stage)
-    except Exception as e:
-        if verbose:
-            print(f"Failed to get mass unit: {e}")
-    linear_unit = 1.0
-    try:
-        if UsdGeom.StageHasAuthoredMetersPerUnit(stage):
-            linear_unit = UsdGeom.GetStageMetersPerUnit(stage)
-    except Exception as e:
-        if verbose:
-            print(f"Failed to get linear unit: {e}")
-
-    def parse_xform(prim):
-        xform = UsdGeom.Xform(prim)
-        mat = np.array(xform.GetLocalTransformation(), dtype=np.float32)
-        if invert_rotations:
-            rot = wp.quat_from_matrix(wp.mat33(mat[:3, :3].T.flatten()))
-        else:
-            rot = wp.quat_from_matrix(wp.mat33(mat[:3, :3].flatten()))
-        pos = mat[3, :3] * linear_unit
-        scale = np.ones(3, dtype=np.float32)
-        for op in xform.GetOrderedXformOps():
-            if op.GetOpType() == UsdGeom.XformOp.TypeScale:
-                scale = np.array(op.Get(), dtype=np.float32)
-        return wp.transform(pos, rot), scale
-
-    def parse_axis(prim, type, joint_data, is_angular, axis=None):
-        # parse joint axis data
-        schemas = prim.GetAppliedSchemas()
-        schemas_str = "".join(schemas)
-        if f"DriveAPI:{type}" not in schemas_str and f"PhysicsLimitAPI:{type}" not in schemas_str:
-            return
-        drive_type = parse_generic(prim, f"drive:{type}:physics:type", "force")
-        if drive_type != "force":
-            print(f"Warning: only force drive type is supported, ignoring drive:{type} for joint {path}")
-            return
-        stiffness = parse_float(prim, f"drive:{type}:physics:stiffness", 0.0)
-        damping = parse_float(prim, f"drive:{type}:physics:damping", 0.0)
-        low = parse_float(prim, f"limit:{type}:physics:low")
-        high = parse_float(prim, f"limit:{type}:physics:high")
-        target_pos = parse_float(prim, f"drive:{type}:physics:targetPosition")
-        target_vel = parse_float(prim, f"drive:{type}:physics:targetVelocity")
-        if is_angular:
-            stiffness *= mass_unit * linear_unit**2
-            stiffness = np.deg2rad(stiffness)
-            damping *= mass_unit * linear_unit**2
-            damping = np.deg2rad(damping)
-            if target_pos is not None:
-                target_pos = np.deg2rad(target_pos)
-            if target_vel is not None:
-                target_vel = np.deg2rad(target_vel)
-            if low is None:
-                low = joint_data["lowerLimit"]
-            else:
-                low = np.deg2rad(low)
-            if high is None:
-                high = joint_data["upperLimit"]
-            else:
-                high = np.deg2rad(high)
-        else:
-            stiffness *= mass_unit
-            damping *= mass_unit
-            if target_pos is not None:
-                target_pos *= linear_unit
-            if target_vel is not None:
-                target_vel *= linear_unit
-            if low is None:
-                low = joint_data["lowerLimit"]
-            else:
-                low *= linear_unit
-            if high is None:
-                high = joint_data["upperLimit"]
-            else:
-                high *= linear_unit
-
-        mode = wp.sim.JOINT_MODE_FORCE
-        if f"DriveAPI:{type}" in schemas_str:
-            if target_vel is not None and target_vel != 0.0:
-                mode = wp.sim.JOINT_MODE_TARGET_VELOCITY
-            else:
-                mode = wp.sim.JOINT_MODE_TARGET_POSITION
-        if low > high:
-            low = (low + high) / 2
-            high = low
-        axis = wp.sim.JointAxis(
-            axis=(axis or joint_data["axis"]),
-            limit_lower=low,
-            limit_upper=high,
-            action=(target_pos or target_vel or (low + high) / 2),
-            target_ke=stiffness,
-            target_kd=damping,
-            mode=mode,
-            limit_ke=joint_limit_ke,
-            limit_kd=joint_limit_kd,
-        )
-        if is_angular:
-            joint_data["angular_axes"].append(axis)
-        else:
-            joint_data["linear_axes"].append(axis)
-
-    axis_str = "Y"
-    try:
-        axis_str = UsdGeom.GetStageUpAxis(stage)
-    except Exception as e:
-        if verbose:
-            print(f"Failed to parse stage up axis: {e}")
-    upaxis = str2axis(axis_str)
-
-    shape_types = {"Cube", "Sphere", "Mesh", "Capsule", "Plane", "Cylinder", "Cone"}
-
-    path_body_map = {}
-    path_shape_map = {}
-    path_shape_scale = {}
-    # maps prim path name to its world transform
-    path_world_poses = {}
-    # transform from body frame to where the actual joint child frame is
-    # so that the link's children will use the right parent tf for the joint
-    prim_joint_xforms = {}
-    path_collision_filters = set()
-    no_collision_shapes = set()
-
-    body_density = {}  # mapping from body ID to defined density
-
-    # first find all joints and materials
-    joint_data = {}  # mapping from path of child link to joint USD settings
-    materials = {}  # mapping from material path to material USD settings
-    joint_parents = set()  # paths of joint parents
-    for prim in stage.Traverse():
-        type_name = str(prim.GetTypeName())
-        path = str(prim.GetPath())
-        # if verbose:
-        #     print(path, type_name)
-        if type_name.endswith("Joint"):
-            # the type name can sometimes be "DistancePhysicsJoint" or "PhysicsDistanceJoint" ...
-            type_name = type_name.replace("Physics", "").replace("Joint", "")
-            child = str(prim.GetRelationship("physics:body1").GetTargets()[0])
-            pos0 = parse_vec(prim, "physics:localPos0", np.zeros(3, dtype=np.float32)) * linear_unit
-            pos1 = parse_vec(prim, "physics:localPos1", np.zeros(3, dtype=np.float32)) * linear_unit
-            rot0 = parse_quat(prim, "physics:localRot0", wp.quat_identity())
-            rot1 = parse_quat(prim, "physics:localRot1", wp.quat_identity())
-            joint_data[child] = {
-                "type": type_name,
-                "name": str(prim.GetName()),
-                "parent_tf": wp.transform(pos0, rot0),
-                "child_tf": wp.transform(pos1, rot1),
-                "enabled": parse_generic(prim, "physics:jointEnabled", True),
-                "collisionEnabled": parse_generic(prim, "physics:collisionEnabled", False),
-                "excludeFromArticulation": parse_generic(prim, "physics:excludeFromArticulation", False),
-                "axis": str2axis(parse_generic(prim, "physics:axis", "X")),
-                "breakForce": parse_float(prim, "physics:breakForce", np.inf),
-                "breakTorque": parse_float(prim, "physics:breakTorque", np.inf),
-                "linear_axes": [],
-                "angular_axes": [],
-            }
-            if only_load_enabled_joints and not joint_data[child]["enabled"]:
-                print("Skipping disabled joint", path)
-                continue
-            # parse joint limits
-            lower = parse_float(prim, "physics:lowerLimit", -np.inf)
-            upper = parse_float(prim, "physics:upperLimit", np.inf)
-            if type_name == "Distance":
-                # if distance is negative the joint is not limited
-                joint_data[child]["lowerLimit"] = parse_float(prim, "physics:minDistance", -1.0) * linear_unit
-                joint_data[child]["upperLimit"] = parse_float(prim, "physics:maxDistance", -1.0) * linear_unit
-            elif type_name == "Prismatic":
-                joint_data[child]["lowerLimit"] = lower * linear_unit
-                joint_data[child]["upperLimit"] = upper * linear_unit
-            else:
-                joint_data[child]["lowerLimit"] = np.deg2rad(lower) if np.isfinite(lower) else lower
-                joint_data[child]["upperLimit"] = np.deg2rad(upper) if np.isfinite(upper) else upper
-
-            if joint_data[child]["lowerLimit"] > joint_data[child]["upperLimit"]:
-                joint_data[child]["lowerLimit"] = (
-                    joint_data[child]["lowerLimit"] + joint_data[child]["upperLimit"]
-                ) / 2
-                joint_data[child]["upperLimit"] = joint_data[child]["lowerLimit"]
-            parents = prim.GetRelationship("physics:body0").GetTargets()
-            if len(parents) > 0:
-                parent_path = str(parents[0])
-                joint_data[child]["parent"] = parent_path
-                joint_parents.add(parent_path)
-            else:
-                joint_data[child]["parent"] = None
-
-            # parse joint drive
-            parse_axis(prim, "angular", joint_data[child], is_angular=True)
-            parse_axis(prim, "rotX", joint_data[child], is_angular=True, axis=(1.0, 0.0, 0.0))
-            parse_axis(prim, "rotY", joint_data[child], is_angular=True, axis=(0.0, 1.0, 0.0))
-            parse_axis(prim, "rotZ", joint_data[child], is_angular=True, axis=(0.0, 0.0, 1.0))
-            parse_axis(prim, "linear", joint_data[child], is_angular=False)
-            parse_axis(prim, "transX", joint_data[child], is_angular=False, axis=(1.0, 0.0, 0.0))
-            parse_axis(prim, "transY", joint_data[child], is_angular=False, axis=(0.0, 1.0, 0.0))
-            parse_axis(prim, "transZ", joint_data[child], is_angular=False, axis=(0.0, 0.0, 1.0))
-
-        elif type_name == "Material":
-            material = {}
-            if has_attribute(prim, "physics:density"):
-                material["density"] = parse_float(prim, "physics:density") * mass_unit  # / (linear_unit**3)
-            if has_attribute(prim, "physics:restitution"):
-                material["restitution"] = parse_float(prim, "physics:restitution", contact_restitution)
-            if has_attribute(prim, "physics:staticFriction"):
-                material["staticFriction"] = parse_float(prim, "physics:staticFriction", contact_mu)
-            if has_attribute(prim, "physics:dynamicFriction"):
-                material["dynamicFriction"] = parse_float(prim, "physics:dynamicFriction", contact_mu)
-            materials[path] = material
-
-        elif type_name == "PhysicsScene":
-            try:
-                scene = UsdPhysics.Scene(prim)
-                g_vec = scene.GetGravityDirectionAttr()
-                g_mag = scene.GetGravityMagnitudeAttr()
-                if g_mag.HasAuthoredValue() and np.isfinite(g_mag.Get()):
-                    builder.gravity = -np.abs(g_mag.Get() * linear_unit)
-                if g_vec.HasAuthoredValue() and np.linalg.norm(g_vec.Get()) > 0.0:
-                    builder.up_vector = np.array(g_vec.Get(), dtype=np.float32)
-                    if np.any(builder.up_vector < 0.0):
-                        builder.up_vector = -builder.up_vector
-                else:
-                    builder.up_vector = upaxis
-            except Exception as e:
-                if verbose:
-                    print(f"Failed to parse physics scene: {e}")
-
-    def parse_prim(prim, incoming_xform, incoming_scale, parent_body: int = -1):
-        nonlocal builder
-        nonlocal joint_data
-        nonlocal path_body_map
-        nonlocal path_shape_map
-        nonlocal path_shape_scale
-        nonlocal path_world_poses
-        nonlocal prim_joint_xforms
-        nonlocal path_collision_filters
-        nonlocal no_collision_shapes
-        nonlocal body_density
-
-        path = str(prim.GetPath())
-        for pattern in ignore_paths:
-            if re.match(pattern, path):
-                return
-
-        type_name = str(prim.GetTypeName())
-        if type_name.endswith("Joint") or type_name.endswith("Light") or type_name.endswith("Material"):
-            return
-        if verbose:
-            print(f"parse_prim {prim.GetPath()} ({type_name})")
-        if type_name == "PhysicsScene":
-            # in case the PhysicsScene has bodies as children...
-            for child in prim.GetChildren():
-                parse_prim(child, incoming_xform, incoming_scale, parent_body)
-
-        schemas = set(prim.GetAppliedSchemas())
-        children_refs = prim.GetChildren()
-
-        prim_joint_xforms[path] = wp.transform()
-
-        local_xform, scale = parse_xform(prim)
-        scale = incoming_scale * scale
-        xform = wp.mul(incoming_xform, local_xform)
-        path_world_poses[path] = xform
-
-        geo_tf = local_xform
-        body_id = parent_body
-        is_rigid_body = "PhysicsRigidBodyAPI" in schemas and parent_body == -1
-        create_rigid_body = is_rigid_body or path in joint_parents
-        if create_rigid_body:
-            body_id = builder.add_body(
-                origin=xform,
-                name=prim.GetName(),
-                armature=armature,
-            )
-            path_body_map[path] = body_id
-            body_density[body_id] = 0.0
-
-            parent_body = body_id
-
-            geo_tf = wp.transform()
-
-            # set up joints between rigid bodies after the children have been added
-            if path in joint_data:
-                joint = joint_data[path]
-
-                joint_params = {
-                    "child": body_id,
-                    "linear_axes": joint["linear_axes"],
-                    "angular_axes": joint["angular_axes"],
-                    "name": joint["name"],
-                    "enabled": joint["enabled"],
-                    "parent_xform": joint["parent_tf"],
-                    "child_xform": joint["child_tf"],
-                    "armature": armature,
-                }
-
-                parent_path = joint["parent"]
-                if parent_path is None:
-                    joint_params["parent"] = -1
-                    parent_tf = wp.transform()
-                else:
-                    joint_params["parent"] = path_body_map[parent_path]
-                    parent_tf = path_world_poses[parent_path]
-
-                # the joint to which we are connected will transform this body already
-                geo_tf = wp.transform()
-
-                if verbose:
-                    print(f"Adding joint {joint['name']} between {joint['parent']} and {path}")
-                    print("  parent_xform", joint["parent_tf"])
-                    print("  child_xform ", joint["child_tf"])
-                    print("  parent_tf   ", parent_tf)
-                    print(f"  geo_tf at {path} = {geo_tf}  (xform was {xform})")
-
-                if joint["type"] == "Revolute":
-                    joint_params["joint_type"] = wp.sim.JOINT_REVOLUTE
-                    if len(joint_params["angular_axes"]) == 0:
-                        joint_params["angular_axes"].append(
-                            wp.sim.JointAxis(
-                                joint["axis"],
-                                limit_lower=joint["lowerLimit"],
-                                limit_upper=joint["upperLimit"],
-                                limit_ke=joint_limit_ke,
-                                limit_kd=joint_limit_kd,
-                            )
-                        )
-                elif joint["type"] == "Prismatic":
-                    joint_params["joint_type"] = wp.sim.JOINT_PRISMATIC
-                    if len(joint_params["linear_axes"]) == 0:
-                        joint_params["linear_axes"].append(
-                            wp.sim.JointAxis(
-                                joint["axis"],
-                                limit_lower=joint["lowerLimit"],
-                                limit_upper=joint["upperLimit"],
-                                limit_ke=joint_limit_ke,
-                                limit_kd=joint_limit_kd,
-                            )
-                        )
-                elif joint["type"] == "Spherical":
-                    joint_params["joint_type"] = wp.sim.JOINT_BALL
-                elif joint["type"] == "Fixed":
-                    joint_params["joint_type"] = wp.sim.JOINT_FIXED
-                elif joint["type"] == "Distance":
-                    joint_params["joint_type"] = wp.sim.JOINT_DISTANCE
-                    # we have to add a dummy linear X axis to define the joint limits
-                    joint_params["linear_axes"].append(
-                        wp.sim.JointAxis(
-                            (1.0, 0.0, 0.0),
-                            limit_lower=joint["lowerLimit"],
-                            limit_upper=joint["upperLimit"],
-                            limit_ke=joint_limit_ke,
-                            limit_kd=joint_limit_kd,
-                        )
-                    )
-                elif joint["type"] == "":
-                    joint_params["joint_type"] = wp.sim.JOINT_D6
-                else:
-                    print(f"Warning: unsupported joint type {joint['type']} for {path}")
-
-                builder.add_joint(**joint_params)
-
-            elif is_rigid_body:
-                builder.add_joint_free(child=body_id)
-                # free joint; we set joint_q/qd, not body_q/qd since eval_fk is used after model creation
-                builder.joint_q[-4:] = xform.q
-                builder.joint_q[-7:-4] = xform.p
-                linear_vel = parse_vec(prim, "physics:velocity", np.zeros(3, dtype=np.float32)) * linear_unit
-                angular_vel = parse_vec(prim, "physics:angularVelocity", np.zeros(3, dtype=np.float32)) * linear_unit
-                builder.joint_qd[-6:-3] = angular_vel
-                builder.joint_qd[-3:] = linear_vel
-
-        if verbose:
-            print(f"added {type_name} body {body_id} ({path}) at {xform}")
-
-        density = None
-
-        material = None
-        if prim.HasRelationship("material:binding:physics"):
-            other_paths = prim.GetRelationship("material:binding:physics").GetTargets()
-            if len(other_paths) > 0:
-                material = materials[str(other_paths[0])]
-        if material is not None:
-            if "density" in material:
-                density = material["density"]
-        if has_attribute(prim, "physics:density"):
-            d = parse_float(prim, "physics:density")
-            density = d * mass_unit  # / (linear_unit**3)
-
-        # assert prim.GetAttribute('orientation').Get() == "rightHanded", "Only right-handed orientations are supported."
-        enabled = parse_generic(prim, "physics:rigidBodyEnabled", True)
-        if only_load_enabled_rigid_bodies and not enabled:
-            if verbose:
-                print("Skipping disabled rigid body", path)
-            return
-        mass = parse_float(prim, "physics:mass")
-        if is_rigid_body:
-            if density is None:
-                density = default_density
-            body_density[body_id] = density
-        elif density is None:
-            if body_id >= 0:
-                density = body_density[body_id]
-            else:
-                density = 0.0
-
-        com = parse_vec(prim, "physics:centerOfMass", np.zeros(3, dtype=np.float32))
-        i_diag = parse_vec(prim, "physics:diagonalInertia", np.zeros(3, dtype=np.float32))
-        i_rot = parse_quat(prim, "physics:principalAxes", wp.quat_identity())
-
-        # parse children
-        if type_name == "Xform":
-            if prim.IsInstance():
-                proto = prim.GetPrototype()
-                for child in proto.GetChildren():
-                    parse_prim(child, xform, scale, parent_body)
-            else:
-                for child in children_refs:
-                    parse_prim(child, xform, scale, parent_body)
-        elif type_name == "Scope":
-            for child in children_refs:
-                parse_prim(child, incoming_xform, incoming_scale, parent_body)
-        elif type_name in shape_types:
-            # parse shapes
-            shape_params = {
-                "ke": contact_ke,
-                "kd": contact_kd,
-                "kf": contact_kf,
-                "ka": contact_ka,
-                "mu": contact_mu,
-                "restitution": contact_restitution,
-            }
-            if material is not None:
-                if "restitution" in material:
-                    shape_params["restitution"] = material["restitution"]
-                if "dynamicFriction" in material:
-                    shape_params["mu"] = material["dynamicFriction"]
-
-            if has_attribute(prim, "doubleSided") and not prim.GetAttribute("doubleSided").Get():
-                print(f"Warning: treating {path} as double-sided because single-sided collisions are not supported.")
-
-            if type_name == "Cube":
-                size = parse_float(prim, "size", 2.0)
-                if has_attribute(prim, "extents"):
-                    extents = parse_vec(prim, "extents") * scale
-                    # TODO position geom at extents center?
-                    # geo_pos = 0.5 * (extents[0] + extents[1])
-                    extents = extents[1] - extents[0]
-                else:
-                    extents = scale * size
-                shape_id = builder.add_shape_box(
-                    body_id,
-                    geo_tf.p,
-                    geo_tf.q,
-                    hx=extents[0] / 2,
-                    hy=extents[1] / 2,
-                    hz=extents[2] / 2,
-                    density=density,
-                    thickness=contact_thickness,
-                    **shape_params,
-                )
-            elif type_name == "Sphere":
-                if not (scale[0] == scale[1] == scale[2]):
-                    print("Warning: Non-uniform scaling of spheres is not supported.")
-                if has_attribute(prim, "extents"):
-                    extents = parse_vec(prim, "extents") * scale
-                    # TODO position geom at extents center?
-                    # geo_pos = 0.5 * (extents[0] + extents[1])
-                    extents = extents[1] - extents[0]
-                    if not (extents[0] == extents[1] == extents[2]):
-                        print("Warning: Non-uniform extents of spheres are not supported.")
-                    radius = extents[0]
-                else:
-                    radius = parse_float(prim, "radius", 1.0) * scale[0]
-                shape_id = builder.add_shape_sphere(
-                    body_id, geo_tf.p, geo_tf.q, radius, density=density, **shape_params
-                )
-            elif type_name == "Plane":
-                normal_str = parse_generic(prim, "axis", "Z").upper()
-                geo_rot = geo_tf.q
-                if normal_str != "Y":
-                    normal = str2axis(normal_str)
-                    c = np.cross(normal, (0.0, 1.0, 0.0))
-                    angle = np.arcsin(np.linalg.norm(c))
-                    axis = c / np.linalg.norm(c)
-                    geo_rot = wp.mul(geo_rot, wp.quat_from_axis_angle(axis, angle))
-                width = parse_float(prim, "width", 0.0) * scale[0]
-                length = parse_float(prim, "length", 0.0) * scale[1]
-                shape_id = builder.add_shape_plane(
-                    body=body_id,
-                    pos=geo_tf.p,
-                    rot=geo_rot,
-                    width=width,
-                    length=length,
-                    thickness=contact_thickness,
-                    **shape_params,
-                )
-            elif type_name == "Capsule":
-                axis_str = parse_generic(prim, "axis", "Z").upper()
-                radius = parse_float(prim, "radius", 0.5) * scale[0]
-                half_height = parse_float(prim, "height", 2.0) / 2 * scale[1]
-                assert not has_attribute(prim, "extents"), "Capsule extents are not supported."
-                shape_id = builder.add_shape_capsule(
-                    body_id,
-                    geo_tf.p,
-                    geo_tf.q,
-                    radius,
-                    half_height,
-                    density=density,
-                    up_axis="XYZ".index(axis_str),
-                    **shape_params,
-                )
-            elif type_name == "Cylinder":
-                axis_str = parse_generic(prim, "axis", "Z").upper()
-                radius = parse_float(prim, "radius", 0.5) * scale[0]
-                half_height = parse_float(prim, "height", 2.0) / 2 * scale[1]
-                assert not has_attribute(prim, "extents"), "Cylinder extents are not supported."
-                shape_id = builder.add_shape_cylinder(
-                    body_id,
-                    geo_tf.p,
-                    geo_tf.q,
-                    radius,
-                    half_height,
-                    density=density,
-                    up_axis="XYZ".index(axis_str),
-                    **shape_params,
-                )
-            elif type_name == "Cone":
-                axis_str = parse_generic(prim, "axis", "Z").upper()
-                radius = parse_float(prim, "radius", 0.5) * scale[0]
-                half_height = parse_float(prim, "height", 2.0) / 2 * scale[1]
-                assert not has_attribute(prim, "extents"), "Cone extents are not supported."
-                shape_id = builder.add_shape_cone(
-                    body_id,
-                    geo_tf.p,
-                    geo_tf.q,
-                    radius,
-                    half_height,
-                    density=density,
-                    up_axis="XYZ".index(axis_str),
-                    **shape_params,
-                )
-            elif type_name == "Mesh":
-                mesh = UsdGeom.Mesh(prim)
-                points = np.array(mesh.GetPointsAttr().Get(), dtype=np.float32)
-                indices = np.array(mesh.GetFaceVertexIndicesAttr().Get(), dtype=np.float32)
-                counts = mesh.GetFaceVertexCountsAttr().Get()
-                faces = []
-                face_id = 0
-                for count in counts:
-                    if count == 3:
-                        faces.append(indices[face_id : face_id + 3])
-                    elif count == 4:
-                        faces.append(indices[face_id : face_id + 3])
-                        faces.append(indices[[face_id, face_id + 2, face_id + 3]])
-                    else:
-                        # assert False, f"Error while parsing USD mesh {path}: encountered polygon with {count} vertices, but only triangles and quads are supported."
-                        continue
-                    face_id += count
-                m = wp.sim.Mesh(points, np.array(faces, dtype=np.int32).flatten())
-                shape_id = builder.add_shape_mesh(
-                    body_id,
-                    geo_tf.p,
-                    geo_tf.q,
-                    scale=scale,
-                    mesh=m,
-                    density=density,
-                    thickness=contact_thickness,
-                    **shape_params,
-                )
-            else:
-                print(f"Warning: Unsupported geometry type {type_name} at {path}.")
-                return
-
-            path_body_map[path] = body_id
-            path_shape_map[path] = shape_id
-            path_shape_scale[path] = scale
-
-            if prim.HasRelationship("physics:filteredPairs"):
-                other_paths = prim.GetRelationship("physics:filteredPairs").GetTargets()
-                for other_path in other_paths:
-                    path_collision_filters.add((path, str(other_path)))
-
-            if "PhysicsCollisionAPI" not in schemas or not parse_generic(prim, "physics:collisionEnabled", True):
-                no_collision_shapes.add(shape_id)
-
-        else:
-            print(f"Warning: encountered unsupported prim type {type_name}")
-
-        # update mass properties of rigid bodies in cases where properties are defined with higher precedence
-        if body_id >= 0:
-            com = parse_vec(prim, "physics:centerOfMass")
-            if com is not None:
-                # overwrite COM
-                builder.body_com[body_id] = com * scale
-
-            if mass is not None and not (is_rigid_body and mass == 0.0):
-                mass_ratio = mass / builder.body_mass[body_id]
-                # mass has precedence over density, so we overwrite the mass computed from density
-                builder.body_mass[body_id] = mass * mass_unit
-                if mass > 0.0:
-                    builder.body_inv_mass[body_id] = 1.0 / builder.body_mass[body_id]
-                else:
-                    builder.body_inv_mass[body_id] = 0.0
-                # update inertia
-                builder.body_inertia[body_id] *= mass_ratio
-                if np.array(builder.body_inertia[body_id]).any():
-                    builder.body_inv_inertia[body_id] = wp.inverse(builder.body_inertia[body_id])
-                else:
-                    builder.body_inv_inertia[body_id] = wp.mat33(*np.zeros((3, 3), dtype=np.float32))
-
-            if np.linalg.norm(i_diag) > 0.0:
-                rot = np.array(wp.quat_to_matrix(i_rot), dtype=np.float32).reshape(3, 3)
-                inertia = rot @ np.diag(i_diag) @ rot.T
-                builder.body_inertia[body_id] = inertia
-                if inertia.any():
-                    builder.body_inv_inertia[body_id] = wp.inverse(wp.mat33(*inertia))
-                else:
-                    builder.body_inv_inertia[body_id] = wp.mat33(*np.zeros((3, 3), dtype=np.float32))
-
-    parse_prim(
-        stage.GetDefaultPrim(), incoming_xform=wp.transform(), incoming_scale=np.ones(3, dtype=np.float32) * linear_unit
-    )
-
-    shape_count = len(builder.shape_geo_type)
-
-    # apply collision filters now that we have added all shapes
-    for path1, path2 in path_collision_filters:
-        shape1 = path_shape_map[path1]
-        shape2 = path_shape_map[path2]
-        builder.shape_collision_filter_pairs.add((shape1, shape2))
-
-    # apply collision filters to all shapes that have no collision
-    for shape_id in no_collision_shapes:
-        for other_shape_id in range(shape_count):
-            if other_shape_id != shape_id:
-                builder.shape_collision_filter_pairs.add((shape_id, other_shape_id))
-
-    # return stage parameters
-    return {
-        "fps": stage.GetFramesPerSecond(),
-        "duration": stage.GetEndTimeCode() - stage.GetStartTimeCode(),
-        "up_axis": UsdGeom.GetStageUpAxis(stage).upper(),
-        "path_shape_map": path_shape_map,
-        "path_body_map": path_body_map,
-        "path_shape_scale": path_shape_scale,
-        "mass_unit": mass_unit,
-        "linear_unit": linear_unit,
-    }
-
-
-def resolve_usd_from_url(url: str, target_folder_name: str | None = None, export_usda: bool = False) -> str:
-    """Download a USD file from a URL and resolves all references to other USD files to be downloaded to the given target folder.
-
-    Args:
-        url: URL to the USD file.
-        target_folder_name: Target folder name. If ``None``, a time-stamped
-          folder will be created in the current directory.
-        export_usda: If ``True``, converts each downloaded USD file to USDA and
-          saves the additional USDA file in the target folder with the same
-          base name as the original USD file.
-
-    Returns:
-        File path to the downloaded USD file.
-    """
-    import datetime
-    import os
-
-    import requests
-
-    try:
-        from pxr import Usd
-    except ImportError as e:
-        raise ImportError("Failed to import pxr. Please install USD (e.g. via `pip install usd-core`).") from e
-
-    response = requests.get(url, allow_redirects=True)
-    if response.status_code != 200:
-        raise RuntimeError(f"Failed to download USD file. Status code: {response.status_code}")
-    file = response.content
-    dot = os.path.extsep
-    base = os.path.basename(url)
-    url_folder = os.path.dirname(url)
-    base_name = dot.join(base.split(dot)[:-1])
-    if target_folder_name is None:
-        timestamp = datetime.datetime.now().strftime("%Y%m%d%H%M%S")
-        target_folder_name = os.path.join(".usd_cache", f"{base_name}_{timestamp}")
-    os.makedirs(target_folder_name, exist_ok=True)
-    target_filename = os.path.join(target_folder_name, base)
-    with open(target_filename, "wb") as f:
-        f.write(file)
-
-    stage = Usd.Stage.Open(target_filename, Usd.Stage.LoadNone)
-    stage_str = stage.GetRootLayer().ExportToString()
-    print(f"Downloaded USD file to {target_filename}.")
-    if export_usda:
-        usda_filename = os.path.join(target_folder_name, base_name + ".usda")
-        with open(usda_filename, "w") as f:
-            f.write(stage_str)
-            print(f"Exported USDA file to {usda_filename}.")
-
-    # parse referenced USD files like `references = @./franka_collisions.usd@`
-    downloaded = set()
-    for match in re.finditer(r"references.=.@(.*?)@", stage_str):
-        refname = match.group(1)
-        if refname.startswith("./"):
-            refname = refname[2:]
-        if refname in downloaded:
-            continue
-        try:
-            response = requests.get(f"{url_folder}/{refname}", allow_redirects=True)
-            if response.status_code != 200:
-                print(f"Failed to download reference {refname}. Status code: {response.status_code}")
-                continue
-            file = response.content
-            refdir = os.path.dirname(refname)
-            if refdir:
-                os.makedirs(os.path.join(target_folder_name, refdir), exist_ok=True)
-            ref_filename = os.path.join(target_folder_name, refname)
-            if not os.path.exists(ref_filename):
-                with open(ref_filename, "wb") as f:
-                    f.write(file)
-            downloaded.add(refname)
-            print(f"Downloaded USD reference {refname} to {ref_filename}.")
-            if export_usda:
-                ref_stage = Usd.Stage.Open(ref_filename, Usd.Stage.LoadNone)
-                ref_stage_str = ref_stage.GetRootLayer().ExportToString()
-                base = os.path.basename(ref_filename)
-                base_name = dot.join(base.split(dot)[:-1])
-                usda_filename = os.path.join(target_folder_name, base_name + ".usda")
-                with open(usda_filename, "w") as f:
-                    f.write(ref_stage_str)
-                    print(f"Exported USDA file to {usda_filename}.")
-        except Exception:
-            print(f"Failed to download {refname}.")
-    return target_filename
diff --git a/warp/sim/inertia.py b/warp/sim/inertia.py
deleted file mode 100644
index acdc6ace..00000000
--- a/warp/sim/inertia.py
+++ /dev/null
@@ -1,357 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-"""Helper functions for computing rigid body inertia properties."""
-
-from __future__ import annotations
-
-import numpy as np
-
-import warp as wp
-
-
-def compute_sphere_inertia(density: float, r: float) -> tuple[float, wp.vec3, wp.mat33]:
-    """Helper to compute mass and inertia of a solid sphere
-
-    Args:
-        density: The sphere density
-        r: The sphere radius
-
-    Returns:
-
-        A tuple of (mass, inertia) with inertia specified around the origin
-    """
-
-    v = 4.0 / 3.0 * wp.pi * r * r * r
-
-    m = density * v
-    Ia = 2.0 / 5.0 * m * r * r
-
-    I = wp.mat33([[Ia, 0.0, 0.0], [0.0, Ia, 0.0], [0.0, 0.0, Ia]])
-
-    return (m, wp.vec3(), I)
-
-
-def compute_capsule_inertia(density: float, r: float, h: float) -> tuple[float, wp.vec3, wp.mat33]:
-    """Helper to compute mass and inertia of a solid capsule extending along the y-axis
-
-    Args:
-        density: The capsule density
-        r: The capsule radius
-        h: The capsule height (full height of the interior cylinder)
-
-    Returns:
-
-        A tuple of (mass, inertia) with inertia specified around the origin
-    """
-
-    ms = density * (4.0 / 3.0) * wp.pi * r * r * r
-    mc = density * wp.pi * r * r * h
-
-    # total mass
-    m = ms + mc
-
-    # adapted from ODE
-    Ia = mc * (0.25 * r * r + (1.0 / 12.0) * h * h) + ms * (0.4 * r * r + 0.375 * r * h + 0.25 * h * h)
-    Ib = (mc * 0.5 + ms * 0.4) * r * r
-
-    I = wp.mat33([[Ia, 0.0, 0.0], [0.0, Ib, 0.0], [0.0, 0.0, Ia]])
-
-    return (m, wp.vec3(), I)
-
-
-def compute_cylinder_inertia(density: float, r: float, h: float) -> tuple[float, wp.vec3, wp.mat33]:
-    """Helper to compute mass and inertia of a solid cylinder extending along the y-axis
-
-    Args:
-        density: The cylinder density
-        r: The cylinder radius
-        h: The cylinder height (extent along the y-axis)
-
-    Returns:
-
-        A tuple of (mass, inertia) with inertia specified around the origin
-    """
-
-    m = density * wp.pi * r * r * h
-
-    Ia = 1 / 12 * m * (3 * r * r + h * h)
-    Ib = 1 / 2 * m * r * r
-
-    I = wp.mat33([[Ia, 0.0, 0.0], [0.0, Ib, 0.0], [0.0, 0.0, Ia]])
-
-    return (m, wp.vec3(), I)
-
-
-def compute_cone_inertia(density: float, r: float, h: float) -> tuple[float, wp.vec3, wp.mat33]:
-    """Helper to compute mass and inertia of a solid cone extending along the y-axis
-
-    Args:
-        density: The cone density
-        r: The cone radius
-        h: The cone height (extent along the y-axis)
-
-    Returns:
-
-        A tuple of (mass, inertia) with inertia specified around the origin
-    """
-
-    m = density * wp.pi * r * r * h / 3.0
-
-    Ia = 1 / 20 * m * (3 * r * r + 2 * h * h)
-    Ib = 3 / 10 * m * r * r
-
-    I = wp.mat33([[Ia, 0.0, 0.0], [0.0, Ib, 0.0], [0.0, 0.0, Ia]])
-
-    return (m, wp.vec3(), I)
-
-
-def compute_box_inertia(density: float, w: float, h: float, d: float) -> tuple[float, wp.vec3, wp.mat33]:
-    """Helper to compute mass and inertia of a solid box
-
-    Args:
-        density: The box density
-        w: The box width along the x-axis
-        h: The box height along the y-axis
-        d: The box depth along the z-axis
-
-    Returns:
-
-        A tuple of (mass, inertia) with inertia specified around the origin
-    """
-
-    v = w * h * d
-    m = density * v
-
-    Ia = 1.0 / 12.0 * m * (h * h + d * d)
-    Ib = 1.0 / 12.0 * m * (w * w + d * d)
-    Ic = 1.0 / 12.0 * m * (w * w + h * h)
-
-    I = wp.mat33([[Ia, 0.0, 0.0], [0.0, Ib, 0.0], [0.0, 0.0, Ic]])
-
-    return (m, wp.vec3(), I)
-
-
-@wp.func
-def triangle_inertia(
-    v0: wp.vec3,
-    v1: wp.vec3,
-    v2: wp.vec3,
-):
-    vol = wp.dot(v0, wp.cross(v1, v2)) / 6.0  # tetra volume (0,v0,v1,v2)
-    first = vol * (v0 + v1 + v2) / 4.0  # first-order integral
-
-    # second-order integral (symmetric)
-    o00, o11, o22 = wp.outer(v0, v0), wp.outer(v1, v1), wp.outer(v2, v2)
-    o01, o02, o12 = wp.outer(v0, v1), wp.outer(v0, v2), wp.outer(v1, v2)
-    o01t, o02t, o12t = wp.transpose(o01), wp.transpose(o02), wp.transpose(o12)
-
-    second = (vol / 10.0) * (o00 + o11 + o22)
-    second += (vol / 20.0) * (o01 + o01t + o02 + o02t + o12 + o12t)
-
-    return vol, first, second
-
-
-@wp.kernel
-def compute_solid_mesh_inertia(
-    indices: wp.array(dtype=int),
-    vertices: wp.array(dtype=wp.vec3),
-    # outputs
-    volume: wp.array(dtype=float),
-    first: wp.array(dtype=wp.vec3),
-    second: wp.array(dtype=wp.mat33),
-):
-    i = wp.tid()
-    p = vertices[indices[i * 3 + 0]]
-    q = vertices[indices[i * 3 + 1]]
-    r = vertices[indices[i * 3 + 2]]
-
-    v, f, s = triangle_inertia(p, q, r)
-    wp.atomic_add(volume, 0, v)
-    wp.atomic_add(first, 0, f)
-    wp.atomic_add(second, 0, s)
-
-
-@wp.kernel
-def compute_hollow_mesh_inertia(
-    indices: wp.array(dtype=int),
-    vertices: wp.array(dtype=wp.vec3),
-    thickness: wp.array(dtype=float),
-    # outputs
-    volume: wp.array(dtype=float),
-    first: wp.array(dtype=wp.vec3),
-    second: wp.array(dtype=wp.mat33),
-):
-    tid = wp.tid()
-    i = indices[tid * 3 + 0]
-    j = indices[tid * 3 + 1]
-    k = indices[tid * 3 + 2]
-
-    vi = vertices[i]
-    vj = vertices[j]
-    vk = vertices[k]
-
-    normal = -wp.normalize(wp.cross(vj - vi, vk - vi))
-    ti = normal * thickness[i]
-    tj = normal * thickness[j]
-    tk = normal * thickness[k]
-
-    # wedge vertices
-    vi0 = vi - ti
-    vi1 = vi + ti
-    vj0 = vj - tj
-    vj1 = vj + tj
-    vk0 = vk - tk
-    vk1 = vk + tk
-
-    v_total = 0.0
-    f_total = wp.vec3(0.0)
-    s_total = wp.mat33(0.0)
-
-    v, f, s = triangle_inertia(vi0, vj0, vk0)
-    v_total += v
-    f_total += f
-    s_total += s
-    v, f, s = triangle_inertia(vj0, vk1, vk0)
-    v_total += v
-    f_total += f
-    s_total += s
-    v, f, s = triangle_inertia(vj0, vj1, vk1)
-    v_total += v
-    f_total += f
-    s_total += s
-    v, f, s = triangle_inertia(vj0, vi1, vj1)
-    v_total += v
-    f_total += f
-    s_total += s
-    v, f, s = triangle_inertia(vj0, vi0, vi1)
-    v_total += v
-    f_total += f
-    s_total += s
-    v, f, s = triangle_inertia(vj1, vi1, vk1)
-    v_total += v
-    f_total += f
-    s_total += s
-    v, f, s = triangle_inertia(vi1, vi0, vk0)
-    v_total += v
-    f_total += f
-    s_total += s
-    v, f, s = triangle_inertia(vi1, vk0, vk1)
-    v_total += v
-    f_total += f
-    s_total += s
-
-    wp.atomic_add(volume, 0, v_total)
-    wp.atomic_add(first, 0, f_total)
-    wp.atomic_add(second, 0, s_total)
-
-
-def compute_mesh_inertia(
-    density: float,
-    vertices: list,
-    indices: list,
-    is_solid: bool = True,
-    thickness: list[float] | float = 0.001,
-) -> tuple[float, wp.vec3, wp.mat33, float]:
-    """
-    Compute the mass, center of mass, inertia, and volume of a triangular mesh.
-
-    Args:
-        density: The density of the mesh material.
-        vertices: A list of vertex positions (3D coordinates).
-        indices: A list of triangle indices (each triangle is defined by 3 vertex indices).
-        is_solid: If True, compute inertia for a solid mesh; if False, for a hollow mesh using the given thickness.
-        thickness: Thickness of the mesh if it is hollow. Can be a single value or a list of values for each vertex.
-
-    Returns:
-        A tuple containing:
-            - mass: The mass of the mesh.
-            - com: The center of mass (3D coordinates).
-            - I: The inertia tensor (3x3 matrix).
-            - volume: The signed volume of the mesh.
-    """
-
-    indices = np.array(indices).flatten()
-    num_tris = len(indices) // 3
-
-    # Allocating for mass and inertia
-    com_warp = wp.zeros(1, dtype=wp.vec3)
-    I_warp = wp.zeros(1, dtype=wp.mat33)
-    vol_warp = wp.zeros(1, dtype=float)
-
-    wp_vertices = wp.array(vertices, dtype=wp.vec3)
-    wp_indices = wp.array(indices, dtype=int)
-
-    if is_solid:
-        wp.launch(
-            kernel=compute_solid_mesh_inertia,
-            dim=num_tris,
-            inputs=[
-                wp_indices,
-                wp_vertices,
-            ],
-            outputs=[
-                vol_warp,
-                com_warp,
-                I_warp,
-            ],
-        )
-    else:
-        if isinstance(thickness, float):
-            thickness = [thickness] * len(vertices)
-        wp.launch(
-            kernel=compute_hollow_mesh_inertia,
-            dim=num_tris,
-            inputs=[
-                wp_indices,
-                wp_vertices,
-                wp.array(thickness, dtype=float),
-            ],
-            outputs=[
-                vol_warp,
-                com_warp,
-                I_warp,
-            ],
-        )
-
-    V_tot = float(vol_warp.numpy()[0])  # signed volume
-    F_tot = com_warp.numpy()[0]  # first moment
-    S_tot = I_warp.numpy()[0]  # second moment
-
-    # If the winding is inward, flip signs
-    if V_tot < 0:
-        V_tot = -V_tot
-        F_tot = -F_tot
-        S_tot = -S_tot
-
-    mass = density * V_tot
-    if V_tot > 0.0:
-        com = F_tot / V_tot
-    else:
-        com = F_tot
-
-    S_tot *= density  # include density
-    I_origin = np.trace(S_tot) * np.eye(3) - S_tot  # inertia about origin
-    r = com
-    I_com = I_origin - mass * ((r @ r) * np.eye(3) - np.outer(r, r))
-
-    return mass, wp.vec3(*com), wp.mat33(*I_com), V_tot
-
-
-def transform_inertia(m, I, p, q) -> wp.mat33:
-    R = wp.quat_to_matrix(q)
-
-    # Steiner's theorem
-    return R @ I @ wp.transpose(R) + m * (wp.dot(p, p) * wp.mat33(np.eye(3)) - wp.outer(p, p))
diff --git a/warp/sim/integrator.py b/warp/sim/integrator.py
deleted file mode 100644
index b4b1b09d..00000000
--- a/warp/sim/integrator.py
+++ /dev/null
@@ -1,245 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-import warp as wp
-
-from .model import PARTICLE_FLAG_ACTIVE, Control, Model, State
-
-
-@wp.kernel
-def integrate_particles(
-    x: wp.array(dtype=wp.vec3),
-    v: wp.array(dtype=wp.vec3),
-    f: wp.array(dtype=wp.vec3),
-    w: wp.array(dtype=float),
-    particle_flags: wp.array(dtype=wp.uint32),
-    gravity: wp.vec3,
-    dt: float,
-    v_max: float,
-    x_new: wp.array(dtype=wp.vec3),
-    v_new: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-    x0 = x[tid]
-    v0 = v[tid]
-
-    if (particle_flags[tid] & PARTICLE_FLAG_ACTIVE) == 0:
-        x_new[tid] = x0
-        v_new[tid] = wp.vec3(0.0)
-        return
-
-    f0 = f[tid]
-
-    inv_mass = w[tid]
-
-    # simple semi-implicit Euler. v1 = v0 + a dt, x1 = x0 + v1 dt
-    v1 = v0 + (f0 * inv_mass + gravity * wp.step(-inv_mass)) * dt
-    # enforce velocity limit to prevent instability
-    v1_mag = wp.length(v1)
-    if v1_mag > v_max:
-        v1 *= v_max / v1_mag
-    x1 = x0 + v1 * dt
-
-    x_new[tid] = x1
-    v_new[tid] = v1
-
-
-@wp.func
-def integrate_rigid_body(
-    q: wp.transform,
-    qd: wp.spatial_vector,
-    f: wp.spatial_vector,
-    com: wp.vec3,
-    inertia: wp.mat33,
-    inv_mass: float,
-    inv_inertia: wp.mat33,
-    gravity: wp.vec3,
-    angular_damping: float,
-    dt: float,
-):
-    # unpack transform
-    x0 = wp.transform_get_translation(q)
-    r0 = wp.transform_get_rotation(q)
-
-    # unpack spatial twist
-    w0 = wp.spatial_top(qd)
-    v0 = wp.spatial_bottom(qd)
-
-    # unpack spatial wrench
-    t0 = wp.spatial_top(f)
-    f0 = wp.spatial_bottom(f)
-
-    x_com = x0 + wp.quat_rotate(r0, com)
-
-    # linear part
-    v1 = v0 + (f0 * inv_mass + gravity * wp.nonzero(inv_mass)) * dt
-    x1 = x_com + v1 * dt
-
-    # angular part (compute in body frame)
-    wb = wp.quat_rotate_inv(r0, w0)
-    tb = wp.quat_rotate_inv(r0, t0) - wp.cross(wb, inertia * wb)  # coriolis forces
-
-    w1 = wp.quat_rotate(r0, wb + inv_inertia * tb * dt)
-    r1 = wp.normalize(r0 + wp.quat(w1, 0.0) * r0 * 0.5 * dt)
-
-    # angular damping
-    w1 *= 1.0 - angular_damping * dt
-
-    q_new = wp.transform(x1 - wp.quat_rotate(r1, com), r1)
-    qd_new = wp.spatial_vector(w1, v1)
-
-    return q_new, qd_new
-
-
-# semi-implicit Euler integration
-@wp.kernel
-def integrate_bodies(
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-    body_f: wp.array(dtype=wp.spatial_vector),
-    body_com: wp.array(dtype=wp.vec3),
-    m: wp.array(dtype=float),
-    I: wp.array(dtype=wp.mat33),
-    inv_m: wp.array(dtype=float),
-    inv_I: wp.array(dtype=wp.mat33),
-    gravity: wp.vec3,
-    angular_damping: float,
-    dt: float,
-    # outputs
-    body_q_new: wp.array(dtype=wp.transform),
-    body_qd_new: wp.array(dtype=wp.spatial_vector),
-):
-    tid = wp.tid()
-
-    # positions
-    q = body_q[tid]
-    qd = body_qd[tid]
-    f = body_f[tid]
-
-    # masses
-    inv_mass = inv_m[tid]  # 1 / mass
-
-    inertia = I[tid]
-    inv_inertia = inv_I[tid]  # inverse of 3x3 inertia matrix
-
-    com = body_com[tid]
-
-    q_new, qd_new = integrate_rigid_body(
-        q,
-        qd,
-        f,
-        com,
-        inertia,
-        inv_mass,
-        inv_inertia,
-        gravity,
-        angular_damping,
-        dt,
-    )
-
-    body_q_new[tid] = q_new
-    body_qd_new[tid] = qd_new
-
-
-class Integrator:
-    """
-    Generic base class for integrators. Provides methods to integrate rigid bodies and particles.
-    """
-
-    def integrate_bodies(
-        self,
-        model: Model,
-        state_in: State,
-        state_out: State,
-        dt: float,
-        angular_damping: float = 0.0,
-    ):
-        """
-        Integrate the rigid bodies of the model.
-
-        Args:
-            model (Model): The model to integrate.
-            state_in (State): The input state.
-            state_out (State): The output state.
-            dt (float): The time step (typically in seconds).
-            angular_damping (float, optional): The angular damping factor. Defaults to 0.0.
-        """
-        if model.body_count:
-            wp.launch(
-                kernel=integrate_bodies,
-                dim=model.body_count,
-                inputs=[
-                    state_in.body_q,
-                    state_in.body_qd,
-                    state_in.body_f,
-                    model.body_com,
-                    model.body_mass,
-                    model.body_inertia,
-                    model.body_inv_mass,
-                    model.body_inv_inertia,
-                    model.gravity,
-                    angular_damping,
-                    dt,
-                ],
-                outputs=[state_out.body_q, state_out.body_qd],
-                device=model.device,
-            )
-
-    def integrate_particles(
-        self,
-        model: Model,
-        state_in: State,
-        state_out: State,
-        dt: float,
-    ):
-        """
-        Integrate the particles of the model.
-
-        Args:
-            model (Model): The model to integrate.
-            state_in (State): The input state.
-            state_out (State): The output state.
-            dt (float): The time step (typically in seconds).
-        """
-        if model.particle_count:
-            wp.launch(
-                kernel=integrate_particles,
-                dim=model.particle_count,
-                inputs=[
-                    state_in.particle_q,
-                    state_in.particle_qd,
-                    state_in.particle_f,
-                    model.particle_inv_mass,
-                    model.particle_flags,
-                    model.gravity,
-                    dt,
-                    model.particle_max_velocity,
-                ],
-                outputs=[state_out.particle_q, state_out.particle_qd],
-                device=model.device,
-            )
-
-    def simulate(self, model: Model, state_in: State, state_out: State, dt: float, control: Control = None):
-        """
-        Simulate the model for a given time step using the given control input.
-
-        Args:
-            model (Model): The model to simulate.
-            state_in (State): The input state.
-            state_out (State): The output state.
-            dt (float): The time step (typically in seconds).
-            control (Control): The control input. Defaults to `None` which means the control values from the :class:`Model` are used.
-        """
-        raise NotImplementedError()
diff --git a/warp/sim/integrator_euler.py b/warp/sim/integrator_euler.py
deleted file mode 100644
index 5da83e17..00000000
--- a/warp/sim/integrator_euler.py
+++ /dev/null
@@ -1,2000 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-"""This module contains time-integration objects for simulating
-models + state forward in time.
-
-"""
-
-import warp as wp
-
-from .collide import triangle_closest_point_barycentric
-from .integrator import Integrator
-from .model import PARTICLE_FLAG_ACTIVE, Control, Model, ModelShapeGeometry, ModelShapeMaterials, State
-from .particles import eval_particle_forces
-from .utils import quat_decompose, quat_twist
-
-
-@wp.kernel
-def eval_springs(
-    x: wp.array(dtype=wp.vec3),
-    v: wp.array(dtype=wp.vec3),
-    spring_indices: wp.array(dtype=int),
-    spring_rest_lengths: wp.array(dtype=float),
-    spring_stiffness: wp.array(dtype=float),
-    spring_damping: wp.array(dtype=float),
-    f: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-
-    i = spring_indices[tid * 2 + 0]
-    j = spring_indices[tid * 2 + 1]
-
-    if i == -1 or j == -1:
-        return
-
-    ke = spring_stiffness[tid]
-    kd = spring_damping[tid]
-    rest = spring_rest_lengths[tid]
-
-    xi = x[i]
-    xj = x[j]
-
-    vi = v[i]
-    vj = v[j]
-
-    xij = xi - xj
-    vij = vi - vj
-
-    l = wp.length(xij)
-    l_inv = 1.0 / l
-
-    # normalized spring direction
-    dir = xij * l_inv
-
-    c = l - rest
-    dcdt = wp.dot(dir, vij)
-
-    # damping based on relative velocity
-    fs = dir * (ke * c + kd * dcdt)
-
-    wp.atomic_sub(f, i, fs)
-    wp.atomic_add(f, j, fs)
-
-
-@wp.kernel
-def eval_triangles(
-    x: wp.array(dtype=wp.vec3),
-    v: wp.array(dtype=wp.vec3),
-    indices: wp.array2d(dtype=int),
-    pose: wp.array(dtype=wp.mat22),
-    activation: wp.array(dtype=float),
-    materials: wp.array2d(dtype=float),
-    f: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-
-    k_mu = materials[tid, 0]
-    k_lambda = materials[tid, 1]
-    k_damp = materials[tid, 2]
-    k_drag = materials[tid, 3]
-    k_lift = materials[tid, 4]
-
-    i = indices[tid, 0]
-    j = indices[tid, 1]
-    k = indices[tid, 2]
-
-    x0 = x[i]  # point zero
-    x1 = x[j]  # point one
-    x2 = x[k]  # point two
-
-    v0 = v[i]  # vel zero
-    v1 = v[j]  # vel one
-    v2 = v[k]  # vel two
-
-    x10 = x1 - x0  # barycentric coordinates (centered at p)
-    x20 = x2 - x0
-
-    v10 = v1 - v0
-    v20 = v2 - v0
-
-    Dm = pose[tid]
-
-    inv_rest_area = wp.determinant(Dm) * 2.0  # 1 / det(A) = det(A^-1)
-    rest_area = 1.0 / inv_rest_area
-
-    # scale stiffness coefficients to account for area
-    k_mu = k_mu * rest_area
-    k_lambda = k_lambda * rest_area
-    k_damp = k_damp * rest_area
-
-    # F = Xs*Xm^-1
-    F1 = x10 * Dm[0, 0] + x20 * Dm[1, 0]
-    F2 = x10 * Dm[0, 1] + x20 * Dm[1, 1]
-
-    # dFdt = Vs*Xm^-1
-    dFdt1 = v10 * Dm[0, 0] + v20 * Dm[1, 0]
-    dFdt2 = v10 * Dm[0, 1] + v20 * Dm[1, 1]
-
-    # deviatoric PK1 + damping term
-    P1 = F1 * k_mu + dFdt1 * k_damp
-    P2 = F2 * k_mu + dFdt2 * k_damp
-
-    # -----------------------------
-    # St. Venant-Kirchoff
-
-    # # Green strain, F'*F-I
-    # e00 = dot(f1, f1) - 1.0
-    # e10 = dot(f2, f1)
-    # e01 = dot(f1, f2)
-    # e11 = dot(f2, f2) - 1.0
-
-    # E = wp.mat22(e00, e01,
-    #              e10, e11)
-
-    # # local forces (deviatoric part)
-    # T = wp.mul(E, wp.transpose(Dm))
-
-    # # spatial forces, F*T
-    # fq = (f1*T[0,0] + f2*T[1,0])*k_mu*2.0
-    # fr = (f1*T[0,1] + f2*T[1,1])*k_mu*2.0
-    # alpha = 1.0
-
-    # -----------------------------
-    # Baraff & Witkin, note this model is not isotropic
-
-    # c1 = length(f1) - 1.0
-    # c2 = length(f2) - 1.0
-    # f1 = normalize(f1)*c1*k1
-    # f2 = normalize(f2)*c2*k1
-
-    # fq = f1*Dm[0,0] + f2*Dm[0,1]
-    # fr = f1*Dm[1,0] + f2*Dm[1,1]
-
-    # -----------------------------
-    # Neo-Hookean (with rest stability)
-
-    # force = P*Dm'
-    f1 = P1 * Dm[0, 0] + P2 * Dm[0, 1]
-    f2 = P1 * Dm[1, 0] + P2 * Dm[1, 1]
-    alpha = 1.0 + k_mu / k_lambda
-
-    # -----------------------------
-    # Area Preservation
-
-    n = wp.cross(x10, x20)
-    area = wp.length(n) * 0.5
-
-    # actuation
-    act = activation[tid]
-
-    # J-alpha
-    c = area * inv_rest_area - alpha + act
-
-    # dJdx
-    n = wp.normalize(n)
-    dcdq = wp.cross(x20, n) * inv_rest_area * 0.5
-    dcdr = wp.cross(n, x10) * inv_rest_area * 0.5
-
-    f_area = k_lambda * c
-
-    # -----------------------------
-    # Area Damping
-
-    dcdt = wp.dot(dcdq, v1) + wp.dot(dcdr, v2) - wp.dot(dcdq + dcdr, v0)
-    f_damp = k_damp * dcdt
-
-    f1 = f1 + dcdq * (f_area + f_damp)
-    f2 = f2 + dcdr * (f_area + f_damp)
-    f0 = f1 + f2
-
-    # -----------------------------
-    # Lift + Drag
-
-    vmid = (v0 + v1 + v2) * 0.3333
-    vdir = wp.normalize(vmid)
-
-    f_drag = vmid * (k_drag * area * wp.abs(wp.dot(n, vmid)))
-    f_lift = n * (k_lift * area * (wp.HALF_PI - wp.acos(wp.dot(n, vdir)))) * wp.dot(vmid, vmid)
-
-    f0 = f0 - f_drag - f_lift
-    f1 = f1 + f_drag + f_lift
-    f2 = f2 + f_drag + f_lift
-
-    # apply forces
-    wp.atomic_add(f, i, f0)
-    wp.atomic_sub(f, j, f1)
-    wp.atomic_sub(f, k, f2)
-
-
-# @wp.func
-# def triangle_closest_point(a: wp.vec3, b: wp.vec3, c: wp.vec3, p: wp.vec3):
-#     ab = b - a
-#     ac = c - a
-#     ap = p - a
-
-#     d1 = wp.dot(ab, ap)
-#     d2 = wp.dot(ac, ap)
-
-#     if (d1 <= 0.0 and d2 <= 0.0):
-#         return a
-
-#     bp = p - b
-#     d3 = wp.dot(ab, bp)
-#     d4 = wp.dot(ac, bp)
-
-#     if (d3 >= 0.0 and d4 <= d3):
-#         return b
-
-#     vc = d1 * d4 - d3 * d2
-#     v = d1 / (d1 - d3)
-#     if (vc <= 0.0 and d1 >= 0.0 and d3 <= 0.0):
-#         return a + ab * v
-
-#     cp = p - c
-#     d5 = dot(ab, cp)
-#     d6 = dot(ac, cp)
-
-#     if (d6 >= 0.0 and d5 <= d6):
-#         return c
-
-#     vb = d5 * d2 - d1 * d6
-#     w = d2 / (d2 - d6)
-#     if (vb <= 0.0 and d2 >= 0.0 and d6 <= 0.0):
-#         return a + ac * w
-
-#     va = d3 * d6 - d5 * d4
-#     w = (d4 - d3) / ((d4 - d3) + (d5 - d6))
-#     if (va <= 0.0 and (d4 - d3) >= 0.0 and (d5 - d6) >= 0.0):
-#         return b + (c - b) * w
-
-#     denom = 1.0 / (va + vb + vc)
-#     v = vb * denom
-#     w = vc * denom
-
-#     return a + ab * v + ac * w
-
-
-@wp.kernel
-def eval_triangles_contact(
-    # idx : wp.array(dtype=int), # list of indices for colliding particles
-    num_particles: int,  # size of particles
-    x: wp.array(dtype=wp.vec3),
-    v: wp.array(dtype=wp.vec3),
-    indices: wp.array2d(dtype=int),
-    materials: wp.array2d(dtype=float),
-    particle_radius: wp.array(dtype=float),
-    f: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-    face_no = tid // num_particles  # which face
-    particle_no = tid % num_particles  # which particle
-
-    # k_mu = materials[face_no, 0]
-    # k_lambda = materials[face_no, 1]
-    # k_damp = materials[face_no, 2]
-    # k_drag = materials[face_no, 3]
-    # k_lift = materials[face_no, 4]
-
-    # at the moment, just one particle
-    pos = x[particle_no]
-
-    i = indices[face_no, 0]
-    j = indices[face_no, 1]
-    k = indices[face_no, 2]
-
-    if i == particle_no or j == particle_no or k == particle_no:
-        return
-
-    p = x[i]  # point zero
-    q = x[j]  # point one
-    r = x[k]  # point two
-
-    # vp = v[i] # vel zero
-    # vq = v[j] # vel one
-    # vr = v[k] # vel two
-
-    # qp = q-p # barycentric coordinates (centered at p)
-    # rp = r-p
-
-    bary = triangle_closest_point_barycentric(p, q, r, pos)
-    closest = p * bary[0] + q * bary[1] + r * bary[2]
-
-    diff = pos - closest
-    dist = wp.dot(diff, diff)
-    n = wp.normalize(diff)
-    c = wp.min(dist - particle_radius[particle_no], 0.0)  # 0 unless within particle's contact radius
-    # c = wp.leaky_min(dot(n, x0)-0.01, 0.0, 0.0)
-    fn = n * c * 1e5
-
-    wp.atomic_sub(f, particle_no, fn)
-
-    # # apply forces (could do - f / 3 here)
-    wp.atomic_add(f, i, fn * bary[0])
-    wp.atomic_add(f, j, fn * bary[1])
-    wp.atomic_add(f, k, fn * bary[2])
-
-
-@wp.kernel
-def eval_triangles_body_contacts(
-    num_particles: int,  # number of particles (size of contact_point)
-    x: wp.array(dtype=wp.vec3),  # position of particles
-    v: wp.array(dtype=wp.vec3),
-    indices: wp.array(dtype=int),  # triangle indices
-    body_x: wp.array(dtype=wp.vec3),  # body body positions
-    body_r: wp.array(dtype=wp.quat),
-    body_v: wp.array(dtype=wp.vec3),
-    body_w: wp.array(dtype=wp.vec3),
-    contact_body: wp.array(dtype=int),
-    contact_point: wp.array(dtype=wp.vec3),  # position of contact points relative to body
-    contact_dist: wp.array(dtype=float),
-    contact_mat: wp.array(dtype=int),
-    materials: wp.array(dtype=float),
-    #   body_f : wp.array(dtype=wp.vec3),
-    #   body_t : wp.array(dtype=wp.vec3),
-    tri_f: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-
-    face_no = tid // num_particles  # which face
-    particle_no = tid % num_particles  # which particle
-
-    # -----------------------
-    # load body body point
-    c_body = contact_body[particle_no]
-    c_point = contact_point[particle_no]
-    c_dist = contact_dist[particle_no]
-    c_mat = contact_mat[particle_no]
-
-    # hard coded surface parameter tensor layout (ke, kd, kf, mu)
-    ke = materials[c_mat * 4 + 0]  # restitution coefficient
-    kd = materials[c_mat * 4 + 1]  # damping coefficient
-    kf = materials[c_mat * 4 + 2]  # friction coefficient
-    mu = materials[c_mat * 4 + 3]  # coulomb friction
-
-    x0 = body_x[c_body]  # position of colliding body
-    r0 = body_r[c_body]  # orientation of colliding body
-
-    v0 = body_v[c_body]
-    w0 = body_w[c_body]
-
-    # transform point to world space
-    pos = x0 + wp.quat_rotate(r0, c_point)
-    # use x0 as center, everything is offset from center of mass
-
-    # moment arm
-    r = pos - x0  # basically just c_point in the new coordinates
-    rhat = wp.normalize(r)
-    pos = pos + rhat * c_dist  # add on 'thickness' of shape, e.g.: radius of sphere/capsule
-
-    # contact point velocity
-    dpdt = v0 + wp.cross(w0, r)  # this is body velocity cross offset, so it's the velocity of the contact point.
-
-    # -----------------------
-    # load triangle
-    i = indices[face_no * 3 + 0]
-    j = indices[face_no * 3 + 1]
-    k = indices[face_no * 3 + 2]
-
-    p = x[i]  # point zero
-    q = x[j]  # point one
-    r = x[k]  # point two
-
-    vp = v[i]  # vel zero
-    vq = v[j]  # vel one
-    vr = v[k]  # vel two
-
-    bary = triangle_closest_point_barycentric(p, q, r, pos)
-    closest = p * bary[0] + q * bary[1] + r * bary[2]
-
-    diff = pos - closest  # vector from tri to point
-    dist = wp.dot(diff, diff)  # squared distance
-    n = wp.normalize(diff)  # points into the object
-    c = wp.min(dist - 0.05, 0.0)  # 0 unless within 0.05 of surface
-    # c = wp.leaky_min(wp.dot(n, x0)-0.01, 0.0, 0.0)
-    # fn = n * c * 1e6    # points towards cloth (both n and c are negative)
-
-    # wp.atomic_sub(tri_f, particle_no, fn)
-
-    fn = c * ke  # normal force (restitution coefficient * how far inside for ground) (negative)
-
-    vtri = vp * bary[0] + vq * bary[1] + vr * bary[2]  # bad approximation for centroid velocity
-    vrel = vtri - dpdt
-
-    vn = wp.dot(n, vrel)  # velocity component of body in negative normal direction
-    vt = vrel - n * vn  # velocity component not in normal direction
-
-    # contact damping
-    fd = -wp.max(vn, 0.0) * kd * wp.step(c)  # again, negative, into the ground
-
-    # # viscous friction
-    # ft = vt*kf
-
-    # Coulomb friction (box)
-    lower = mu * (fn + fd)
-    upper = -lower
-
-    nx = wp.cross(n, wp.vec3(0.0, 0.0, 1.0))  # basis vectors for tangent
-    nz = wp.cross(n, wp.vec3(1.0, 0.0, 0.0))
-
-    vx = wp.clamp(wp.dot(nx * kf, vt), lower, upper)
-    vz = wp.clamp(wp.dot(nz * kf, vt), lower, upper)
-
-    ft = (nx * vx + nz * vz) * (-wp.step(c))  # wp.vec3(vx, 0.0, vz)*wp.step(c)
-
-    # # Coulomb friction (smooth, but gradients are numerically unstable around |vt| = 0)
-    # #ft = wp.normalize(vt)*wp.min(kf*wp.length(vt), -mu*c*ke)
-
-    f_total = n * (fn + fd) + ft
-
-    wp.atomic_add(tri_f, i, f_total * bary[0])
-    wp.atomic_add(tri_f, j, f_total * bary[1])
-    wp.atomic_add(tri_f, k, f_total * bary[2])
-
-
-@wp.kernel
-def eval_bending(
-    x: wp.array(dtype=wp.vec3),
-    v: wp.array(dtype=wp.vec3),
-    indices: wp.array2d(dtype=int),
-    rest: wp.array(dtype=float),
-    bending_properties: wp.array2d(dtype=float),
-    f: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-    ke = bending_properties[tid, 0]
-    kd = bending_properties[tid, 1]
-
-    i = indices[tid, 0]
-    j = indices[tid, 1]
-    k = indices[tid, 2]
-    l = indices[tid, 3]
-
-    if i == -1 or j == -1 or k == -1 or l == -1:
-        return
-
-    rest_angle = rest[tid]
-
-    x1 = x[i]
-    x2 = x[j]
-    x3 = x[k]
-    x4 = x[l]
-
-    v1 = v[i]
-    v2 = v[j]
-    v3 = v[k]
-    v4 = v[l]
-
-    n1 = wp.cross(x3 - x1, x4 - x1)  # normal to face 1
-    n2 = wp.cross(x4 - x2, x3 - x2)  # normal to face 2
-
-    n1_length = wp.length(n1)
-    n2_length = wp.length(n2)
-
-    if n1_length < 1.0e-6 or n2_length < 1.0e-6:
-        return
-
-    rcp_n1 = 1.0 / n1_length
-    rcp_n2 = 1.0 / n2_length
-
-    cos_theta = wp.dot(n1, n2) * rcp_n1 * rcp_n2
-
-    n1 = n1 * rcp_n1 * rcp_n1
-    n2 = n2 * rcp_n2 * rcp_n2
-
-    e = x4 - x3
-    e_hat = wp.normalize(e)
-    e_length = wp.length(e)
-
-    s = wp.sign(wp.dot(wp.cross(n2, n1), e_hat))
-    angle = wp.acos(cos_theta) * s
-
-    d1 = n1 * e_length
-    d2 = n2 * e_length
-    d3 = n1 * wp.dot(x1 - x4, e_hat) + n2 * wp.dot(x2 - x4, e_hat)
-    d4 = n1 * wp.dot(x3 - x1, e_hat) + n2 * wp.dot(x3 - x2, e_hat)
-
-    # elastic
-    f_elastic = ke * (angle - rest_angle)
-
-    # damping
-    f_damp = kd * (wp.dot(d1, v1) + wp.dot(d2, v2) + wp.dot(d3, v3) + wp.dot(d4, v4))
-
-    # total force, proportional to edge length
-    f_total = -e_length * (f_elastic + f_damp)
-
-    wp.atomic_add(f, i, d1 * f_total)
-    wp.atomic_add(f, j, d2 * f_total)
-    wp.atomic_add(f, k, d3 * f_total)
-    wp.atomic_add(f, l, d4 * f_total)
-
-
-@wp.kernel
-def eval_tetrahedra(
-    x: wp.array(dtype=wp.vec3),
-    v: wp.array(dtype=wp.vec3),
-    indices: wp.array2d(dtype=int),
-    pose: wp.array(dtype=wp.mat33),
-    activation: wp.array(dtype=float),
-    materials: wp.array2d(dtype=float),
-    f: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-
-    i = indices[tid, 0]
-    j = indices[tid, 1]
-    k = indices[tid, 2]
-    l = indices[tid, 3]
-
-    act = activation[tid]
-
-    k_mu = materials[tid, 0]
-    k_lambda = materials[tid, 1]
-    k_damp = materials[tid, 2]
-
-    x0 = x[i]
-    x1 = x[j]
-    x2 = x[k]
-    x3 = x[l]
-
-    v0 = v[i]
-    v1 = v[j]
-    v2 = v[k]
-    v3 = v[l]
-
-    x10 = x1 - x0
-    x20 = x2 - x0
-    x30 = x3 - x0
-
-    v10 = v1 - v0
-    v20 = v2 - v0
-    v30 = v3 - v0
-
-    Ds = wp.matrix_from_cols(x10, x20, x30)
-    Dm = pose[tid]
-
-    inv_rest_volume = wp.determinant(Dm) * 6.0
-    rest_volume = 1.0 / inv_rest_volume
-
-    alpha = 1.0 + k_mu / k_lambda - k_mu / (4.0 * k_lambda)
-
-    # scale stiffness coefficients to account for area
-    k_mu = k_mu * rest_volume
-    k_lambda = k_lambda * rest_volume
-    k_damp = k_damp * rest_volume
-
-    # F = Xs*Xm^-1
-    F = Ds * Dm
-    dFdt = wp.matrix_from_cols(v10, v20, v30) * Dm
-
-    col1 = wp.vec3(F[0, 0], F[1, 0], F[2, 0])
-    col2 = wp.vec3(F[0, 1], F[1, 1], F[2, 1])
-    col3 = wp.vec3(F[0, 2], F[1, 2], F[2, 2])
-
-    # -----------------------------
-    # Neo-Hookean (with rest stability [Smith et al 2018])
-
-    Ic = wp.dot(col1, col1) + wp.dot(col2, col2) + wp.dot(col3, col3)
-
-    # deviatoric part
-    P = F * k_mu * (1.0 - 1.0 / (Ic + 1.0)) + dFdt * k_damp
-    H = P * wp.transpose(Dm)
-
-    f1 = wp.vec3(H[0, 0], H[1, 0], H[2, 0])
-    f2 = wp.vec3(H[0, 1], H[1, 1], H[2, 1])
-    f3 = wp.vec3(H[0, 2], H[1, 2], H[2, 2])
-
-    # -----------------------------
-    # C_sqrt
-
-    # alpha = 1.0
-
-    # r_s = wp.sqrt(wp.abs(dot(col1, col1) + dot(col2, col2) + dot(col3, col3) - 3.0))
-
-    # f1 = wp.vec3()
-    # f2 = wp.vec3()
-    # f3 = wp.vec3()
-
-    # if (r_s > 0.0):
-    #     r_s_inv = 1.0/r_s
-
-    #     C = r_s
-    #     dCdx = F*wp.transpose(Dm)*r_s_inv*wp.sign(r_s)
-
-    #     grad1 = vec3(dCdx[0,0], dCdx[1,0], dCdx[2,0])
-    #     grad2 = vec3(dCdx[0,1], dCdx[1,1], dCdx[2,1])
-    #     grad3 = vec3(dCdx[0,2], dCdx[1,2], dCdx[2,2])
-
-    #     f1 = grad1*C*k_mu
-    #     f2 = grad2*C*k_mu
-    #     f3 = grad3*C*k_mu
-
-    # -----------------------------
-    # C_spherical
-
-    # alpha = 1.0
-
-    # r_s = wp.sqrt(dot(col1, col1) + dot(col2, col2) + dot(col3, col3))
-    # r_s_inv = 1.0/r_s
-
-    # C = r_s - wp.sqrt(3.0)
-    # dCdx = F*wp.transpose(Dm)*r_s_inv
-
-    # grad1 = vec3(dCdx[0,0], dCdx[1,0], dCdx[2,0])
-    # grad2 = vec3(dCdx[0,1], dCdx[1,1], dCdx[2,1])
-    # grad3 = vec3(dCdx[0,2], dCdx[1,2], dCdx[2,2])
-
-    # f1 = grad1*C*k_mu
-    # f2 = grad2*C*k_mu
-    # f3 = grad3*C*k_mu
-
-    # ----------------------------
-    # C_D
-
-    # alpha = 1.0
-
-    # r_s = wp.sqrt(dot(col1, col1) + dot(col2, col2) + dot(col3, col3))
-
-    # C = r_s*r_s - 3.0
-    # dCdx = F*wp.transpose(Dm)*2.0
-
-    # grad1 = vec3(dCdx[0,0], dCdx[1,0], dCdx[2,0])
-    # grad2 = vec3(dCdx[0,1], dCdx[1,1], dCdx[2,1])
-    # grad3 = vec3(dCdx[0,2], dCdx[1,2], dCdx[2,2])
-
-    # f1 = grad1*C*k_mu
-    # f2 = grad2*C*k_mu
-    # f3 = grad3*C*k_mu
-
-    # ----------------------------
-    # Hookean
-
-    # alpha = 1.0
-
-    # I = wp.matrix_from_cols(wp.vec3(1.0, 0.0, 0.0),
-    #                         wp.vec3(0.0, 1.0, 0.0),
-    #                         wp.vec3(0.0, 0.0, 1.0))
-
-    # P = (F + wp.transpose(F) + I*(0.0-2.0))*k_mu
-    # H = P * wp.transpose(Dm)
-
-    # f1 = wp.vec3(H[0, 0], H[1, 0], H[2, 0])
-    # f2 = wp.vec3(H[0, 1], H[1, 1], H[2, 1])
-    # f3 = wp.vec3(H[0, 2], H[1, 2], H[2, 2])
-
-    # hydrostatic part
-    J = wp.determinant(F)
-
-    # print(J)
-    s = inv_rest_volume / 6.0
-    dJdx1 = wp.cross(x20, x30) * s
-    dJdx2 = wp.cross(x30, x10) * s
-    dJdx3 = wp.cross(x10, x20) * s
-
-    f_volume = (J - alpha + act) * k_lambda
-    f_damp = (wp.dot(dJdx1, v1) + wp.dot(dJdx2, v2) + wp.dot(dJdx3, v3)) * k_damp
-
-    f_total = f_volume + f_damp
-
-    f1 = f1 + dJdx1 * f_total
-    f2 = f2 + dJdx2 * f_total
-    f3 = f3 + dJdx3 * f_total
-    f0 = -(f1 + f2 + f3)
-
-    # apply forces
-    wp.atomic_sub(f, i, f0)
-    wp.atomic_sub(f, j, f1)
-    wp.atomic_sub(f, k, f2)
-    wp.atomic_sub(f, l, f3)
-
-
-@wp.kernel
-def eval_particle_ground_contacts(
-    particle_x: wp.array(dtype=wp.vec3),
-    particle_v: wp.array(dtype=wp.vec3),
-    particle_radius: wp.array(dtype=float),
-    particle_flags: wp.array(dtype=wp.uint32),
-    ke: float,
-    kd: float,
-    kf: float,
-    mu: float,
-    ground: wp.array(dtype=float),
-    # outputs
-    f: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-    if (particle_flags[tid] & PARTICLE_FLAG_ACTIVE) == 0:
-        return
-
-    x = particle_x[tid]
-    v = particle_v[tid]
-    radius = particle_radius[tid]
-
-    n = wp.vec3(ground[0], ground[1], ground[2])
-    c = wp.min(wp.dot(n, x) + ground[3] - radius, 0.0)
-
-    vn = wp.dot(n, v)
-    jn = c * ke
-
-    if c >= 0.0:
-        return
-
-    jd = min(vn, 0.0) * kd
-
-    # contact force
-    fn = jn + jd
-
-    # friction force
-    vt = v - n * vn
-    vs = wp.length(vt)
-
-    if vs > 0.0:
-        vt = vt / vs
-
-    # Coulomb condition
-    ft = wp.min(vs * kf, mu * wp.abs(fn))
-
-    # total force
-    f[tid] = f[tid] - n * fn - vt * ft
-
-
-@wp.kernel
-def eval_particle_contacts(
-    particle_x: wp.array(dtype=wp.vec3),
-    particle_v: wp.array(dtype=wp.vec3),
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-    particle_radius: wp.array(dtype=float),
-    particle_flags: wp.array(dtype=wp.uint32),
-    body_com: wp.array(dtype=wp.vec3),
-    shape_body: wp.array(dtype=int),
-    shape_materials: ModelShapeMaterials,
-    particle_ke: float,
-    particle_kd: float,
-    particle_kf: float,
-    particle_mu: float,
-    particle_ka: float,
-    contact_count: wp.array(dtype=int),
-    contact_particle: wp.array(dtype=int),
-    contact_shape: wp.array(dtype=int),
-    contact_body_pos: wp.array(dtype=wp.vec3),
-    contact_body_vel: wp.array(dtype=wp.vec3),
-    contact_normal: wp.array(dtype=wp.vec3),
-    contact_max: int,
-    body_f_in_world_frame: bool,
-    # outputs
-    particle_f: wp.array(dtype=wp.vec3),
-    body_f: wp.array(dtype=wp.spatial_vector),
-):
-    tid = wp.tid()
-
-    count = min(contact_max, contact_count[0])
-    if tid >= count:
-        return
-
-    shape_index = contact_shape[tid]
-    body_index = shape_body[shape_index]
-    particle_index = contact_particle[tid]
-    if (particle_flags[particle_index] & PARTICLE_FLAG_ACTIVE) == 0:
-        return
-
-    px = particle_x[particle_index]
-    pv = particle_v[particle_index]
-
-    X_wb = wp.transform_identity()
-    X_com = wp.vec3()
-    body_v_s = wp.spatial_vector()
-
-    if body_index >= 0:
-        X_wb = body_q[body_index]
-        X_com = body_com[body_index]
-        body_v_s = body_qd[body_index]
-
-    # body position in world space
-    bx = wp.transform_point(X_wb, contact_body_pos[tid])
-    r = bx - wp.transform_point(X_wb, X_com)
-
-    n = contact_normal[tid]
-    c = wp.dot(n, px - bx) - particle_radius[particle_index]
-
-    if c > particle_ka:
-        return
-
-    # take average material properties of shape and particle parameters
-    ke = 0.5 * (particle_ke + shape_materials.ke[shape_index])
-    kd = 0.5 * (particle_kd + shape_materials.kd[shape_index])
-    kf = 0.5 * (particle_kf + shape_materials.kf[shape_index])
-    mu = 0.5 * (particle_mu + shape_materials.mu[shape_index])
-
-    body_w = wp.spatial_top(body_v_s)
-    body_v = wp.spatial_bottom(body_v_s)
-
-    # compute the body velocity at the particle position
-    bv = body_v + wp.transform_vector(X_wb, contact_body_vel[tid])
-    if body_f_in_world_frame:
-        bv += wp.cross(body_w, bx)
-    else:
-        bv += wp.cross(body_w, r)
-
-    # relative velocity
-    v = pv - bv
-
-    # decompose relative velocity
-    vn = wp.dot(n, v)
-    vt = v - n * vn
-
-    # contact elastic
-    fn = n * c * ke
-
-    # contact damping
-    fd = n * wp.min(vn, 0.0) * kd
-
-    # viscous friction
-    # ft = vt*kf
-
-    # Coulomb friction (box)
-    # lower = mu * c * ke
-    # upper = -lower
-
-    # vx = wp.clamp(wp.dot(wp.vec3(kf, 0.0, 0.0), vt), lower, upper)
-    # vz = wp.clamp(wp.dot(wp.vec3(0.0, 0.0, kf), vt), lower, upper)
-
-    # ft = wp.vec3(vx, 0.0, vz)
-
-    # Coulomb friction (smooth, but gradients are numerically unstable around |vt| = 0)
-    ft = wp.normalize(vt) * wp.min(kf * wp.length(vt), abs(mu * c * ke))
-
-    f_total = fn + (fd + ft)
-
-    wp.atomic_sub(particle_f, particle_index, f_total)
-
-    if body_index >= 0:
-        if body_f_in_world_frame:
-            wp.atomic_sub(body_f, body_index, wp.spatial_vector(wp.cross(bx, f_total), f_total))
-        else:
-            wp.atomic_add(body_f, body_index, wp.spatial_vector(wp.cross(r, f_total), f_total))
-
-
-@wp.kernel
-def eval_rigid_contacts(
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-    body_com: wp.array(dtype=wp.vec3),
-    shape_materials: ModelShapeMaterials,
-    geo: ModelShapeGeometry,
-    shape_body: wp.array(dtype=int),
-    contact_count: wp.array(dtype=int),
-    contact_point0: wp.array(dtype=wp.vec3),
-    contact_point1: wp.array(dtype=wp.vec3),
-    contact_normal: wp.array(dtype=wp.vec3),
-    contact_shape0: wp.array(dtype=int),
-    contact_shape1: wp.array(dtype=int),
-    force_in_world_frame: bool,
-    friction_smoothing: float,
-    # outputs
-    body_f: wp.array(dtype=wp.spatial_vector),
-):
-    tid = wp.tid()
-
-    count = contact_count[0]
-    if tid >= count:
-        return
-
-    # retrieve contact thickness, compute average contact material properties
-    ke = 0.0  # contact normal force stiffness
-    kd = 0.0  # damping coefficient
-    kf = 0.0  # friction force stiffness
-    ka = 0.0  # adhesion distance
-    mu = 0.0  # friction coefficient
-    mat_nonzero = 0
-    thickness_a = 0.0
-    thickness_b = 0.0
-    shape_a = contact_shape0[tid]
-    shape_b = contact_shape1[tid]
-    if shape_a == shape_b:
-        return
-    body_a = -1
-    body_b = -1
-    if shape_a >= 0:
-        mat_nonzero += 1
-        ke += shape_materials.ke[shape_a]
-        kd += shape_materials.kd[shape_a]
-        kf += shape_materials.kf[shape_a]
-        ka += shape_materials.ka[shape_a]
-        mu += shape_materials.mu[shape_a]
-        thickness_a = geo.thickness[shape_a]
-        body_a = shape_body[shape_a]
-    if shape_b >= 0:
-        mat_nonzero += 1
-        ke += shape_materials.ke[shape_b]
-        kd += shape_materials.kd[shape_b]
-        kf += shape_materials.kf[shape_b]
-        ka += shape_materials.ka[shape_b]
-        mu += shape_materials.mu[shape_b]
-        thickness_b = geo.thickness[shape_b]
-        body_b = shape_body[shape_b]
-    if mat_nonzero > 0:
-        ke /= float(mat_nonzero)
-        kd /= float(mat_nonzero)
-        kf /= float(mat_nonzero)
-        ka /= float(mat_nonzero)
-        mu /= float(mat_nonzero)
-
-    # contact normal in world space
-    n = contact_normal[tid]
-    bx_a = contact_point0[tid]
-    bx_b = contact_point1[tid]
-    r_a = wp.vec3(0.0)
-    r_b = wp.vec3(0.0)
-    if body_a >= 0:
-        X_wb_a = body_q[body_a]
-        X_com_a = body_com[body_a]
-        bx_a = wp.transform_point(X_wb_a, bx_a) - thickness_a * n
-        r_a = bx_a - wp.transform_point(X_wb_a, X_com_a)
-
-    if body_b >= 0:
-        X_wb_b = body_q[body_b]
-        X_com_b = body_com[body_b]
-        bx_b = wp.transform_point(X_wb_b, bx_b) + thickness_b * n
-        r_b = bx_b - wp.transform_point(X_wb_b, X_com_b)
-
-    d = wp.dot(n, bx_a - bx_b)
-
-    if d >= ka:
-        return
-
-    # compute contact point velocity
-    bv_a = wp.vec3(0.0)
-    bv_b = wp.vec3(0.0)
-    if body_a >= 0:
-        body_v_s_a = body_qd[body_a]
-        body_w_a = wp.spatial_top(body_v_s_a)
-        body_v_a = wp.spatial_bottom(body_v_s_a)
-        if force_in_world_frame:
-            bv_a = body_v_a + wp.cross(body_w_a, bx_a)
-        else:
-            bv_a = body_v_a + wp.cross(body_w_a, r_a)
-
-    if body_b >= 0:
-        body_v_s_b = body_qd[body_b]
-        body_w_b = wp.spatial_top(body_v_s_b)
-        body_v_b = wp.spatial_bottom(body_v_s_b)
-        if force_in_world_frame:
-            bv_b = body_v_b + wp.cross(body_w_b, bx_b)
-        else:
-            bv_b = body_v_b + wp.cross(body_w_b, r_b)
-
-    # relative velocity
-    v = bv_a - bv_b
-
-    # print(v)
-
-    # decompose relative velocity
-    vn = wp.dot(n, v)
-    vt = v - n * vn
-
-    # contact elastic
-    fn = d * ke
-
-    # contact damping
-    fd = wp.min(vn, 0.0) * kd * wp.step(d)
-
-    # viscous friction
-    # ft = vt*kf
-
-    # Coulomb friction (box)
-    # lower = mu * d * ke
-    # upper = -lower
-
-    # vx = wp.clamp(wp.dot(wp.vec3(kf, 0.0, 0.0), vt), lower, upper)
-    # vz = wp.clamp(wp.dot(wp.vec3(0.0, 0.0, kf), vt), lower, upper)
-
-    # ft = wp.vec3(vx, 0.0, vz)
-
-    # Coulomb friction (smooth, but gradients are numerically unstable around |vt| = 0)
-    ft = wp.vec3(0.0)
-    if d < 0.0:
-        # use a smooth vector norm to avoid gradient instability at/around zero velocity
-        vs = wp.norm_huber(vt, delta=friction_smoothing)
-        if vs > 0.0:
-            fr = vt / vs
-            ft = fr * wp.min(kf * vs, -mu * (fn + fd))
-
-    f_total = n * (fn + fd) + ft
-    # f_total = n * (fn + fd)
-    # f_total = n * fn
-
-    if body_a >= 0:
-        if force_in_world_frame:
-            wp.atomic_add(body_f, body_a, wp.spatial_vector(wp.cross(bx_a, f_total), f_total))
-        else:
-            wp.atomic_sub(body_f, body_a, wp.spatial_vector(wp.cross(r_a, f_total), f_total))
-
-    if body_b >= 0:
-        if force_in_world_frame:
-            wp.atomic_sub(body_f, body_b, wp.spatial_vector(wp.cross(bx_b, f_total), f_total))
-        else:
-            wp.atomic_add(body_f, body_b, wp.spatial_vector(wp.cross(r_b, f_total), f_total))
-
-
-@wp.func
-def eval_joint_force(
-    q: float,
-    qd: float,
-    act: float,
-    target_ke: float,
-    target_kd: float,
-    limit_lower: float,
-    limit_upper: float,
-    limit_ke: float,
-    limit_kd: float,
-    mode: wp.int32,
-) -> float:
-    """Joint force evaluation for a single degree of freedom."""
-
-    limit_f = 0.0
-    damping_f = 0.0
-    target_f = 0.0
-
-    if mode == wp.sim.JOINT_MODE_FORCE:
-        target_f = act
-    elif mode == wp.sim.JOINT_MODE_TARGET_POSITION:
-        target_f = target_ke * (act - q) - target_kd * qd
-    elif mode == wp.sim.JOINT_MODE_TARGET_VELOCITY:
-        target_f = target_ke * (act - qd)
-
-    # compute limit forces, damping only active when limit is violated
-    if q < limit_lower:
-        limit_f = limit_ke * (limit_lower - q)
-        damping_f = -limit_kd * qd
-        if mode == wp.sim.JOINT_MODE_TARGET_VELOCITY:
-            target_f = 0.0  # override target force when limit is violated
-    elif q > limit_upper:
-        limit_f = limit_ke * (limit_upper - q)
-        damping_f = -limit_kd * qd
-        if mode == wp.sim.JOINT_MODE_TARGET_VELOCITY:
-            target_f = 0.0  # override target force when limit is violated
-
-    return limit_f + damping_f + target_f
-
-
-@wp.kernel
-def eval_body_joints(
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-    body_com: wp.array(dtype=wp.vec3),
-    joint_qd_start: wp.array(dtype=int),
-    joint_type: wp.array(dtype=int),
-    joint_enabled: wp.array(dtype=int),
-    joint_child: wp.array(dtype=int),
-    joint_parent: wp.array(dtype=int),
-    joint_X_p: wp.array(dtype=wp.transform),
-    joint_X_c: wp.array(dtype=wp.transform),
-    joint_axis: wp.array(dtype=wp.vec3),
-    joint_axis_start: wp.array(dtype=int),
-    joint_axis_dim: wp.array(dtype=int, ndim=2),
-    joint_axis_mode: wp.array(dtype=int),
-    joint_act: wp.array(dtype=float),
-    joint_target_ke: wp.array(dtype=float),
-    joint_target_kd: wp.array(dtype=float),
-    joint_limit_lower: wp.array(dtype=float),
-    joint_limit_upper: wp.array(dtype=float),
-    joint_limit_ke: wp.array(dtype=float),
-    joint_limit_kd: wp.array(dtype=float),
-    joint_attach_ke: float,
-    joint_attach_kd: float,
-    body_f: wp.array(dtype=wp.spatial_vector),
-):
-    tid = wp.tid()
-    type = joint_type[tid]
-
-    # early out for free joints
-    if joint_enabled[tid] == 0 or type == wp.sim.JOINT_FREE:
-        return
-
-    c_child = joint_child[tid]
-    c_parent = joint_parent[tid]
-
-    X_pj = joint_X_p[tid]
-    X_cj = joint_X_c[tid]
-
-    X_wp = X_pj
-    r_p = wp.vec3()
-    w_p = wp.vec3()
-    v_p = wp.vec3()
-
-    # parent transform and moment arm
-    if c_parent >= 0:
-        X_wp = body_q[c_parent] * X_wp
-        r_p = wp.transform_get_translation(X_wp) - wp.transform_point(body_q[c_parent], body_com[c_parent])
-
-        twist_p = body_qd[c_parent]
-
-        w_p = wp.spatial_top(twist_p)
-        v_p = wp.spatial_bottom(twist_p) + wp.cross(w_p, r_p)
-
-    # child transform and moment arm
-    X_wc = body_q[c_child] * X_cj
-    r_c = wp.transform_get_translation(X_wc) - wp.transform_point(body_q[c_child], body_com[c_child])
-
-    twist_c = body_qd[c_child]
-
-    w_c = wp.spatial_top(twist_c)
-    v_c = wp.spatial_bottom(twist_c) + wp.cross(w_c, r_c)
-
-    # joint properties (for 1D joints)
-    # q_start = joint_q_start[tid]
-    # qd_start = joint_qd_start[tid]
-    axis_start = joint_axis_start[tid]
-
-    lin_axis_count = joint_axis_dim[tid, 0]
-    ang_axis_count = joint_axis_dim[tid, 1]
-
-    x_p = wp.transform_get_translation(X_wp)
-    x_c = wp.transform_get_translation(X_wc)
-
-    q_p = wp.transform_get_rotation(X_wp)
-    q_c = wp.transform_get_rotation(X_wc)
-
-    # translational error
-    x_err = x_c - x_p
-    r_err = wp.quat_inverse(q_p) * q_c
-    v_err = v_c - v_p
-    w_err = w_c - w_p
-
-    # total force/torque on the parent
-    t_total = wp.vec3()
-    f_total = wp.vec3()
-
-    # reduce angular damping stiffness for stability
-    angular_damping_scale = 0.01
-
-    if type == wp.sim.JOINT_FIXED:
-        ang_err = wp.normalize(wp.vec3(r_err[0], r_err[1], r_err[2])) * wp.acos(r_err[3]) * 2.0
-
-        f_total += x_err * joint_attach_ke + v_err * joint_attach_kd
-        t_total += (
-            wp.transform_vector(X_wp, ang_err) * joint_attach_ke + w_err * joint_attach_kd * angular_damping_scale
-        )
-
-    if type == wp.sim.JOINT_PRISMATIC:
-        axis = joint_axis[axis_start]
-
-        # world space joint axis
-        axis_p = wp.transform_vector(X_wp, axis)
-
-        # evaluate joint coordinates
-        q = wp.dot(x_err, axis_p)
-        qd = wp.dot(v_err, axis_p)
-        act = joint_act[axis_start]
-
-        f_total = axis_p * -eval_joint_force(
-            q,
-            qd,
-            act,
-            joint_target_ke[axis_start],
-            joint_target_kd[axis_start],
-            joint_limit_lower[axis_start],
-            joint_limit_upper[axis_start],
-            joint_limit_ke[axis_start],
-            joint_limit_kd[axis_start],
-            joint_axis_mode[axis_start],
-        )
-
-        # attachment dynamics
-        ang_err = wp.normalize(wp.vec3(r_err[0], r_err[1], r_err[2])) * wp.acos(r_err[3]) * 2.0
-
-        # project off any displacement along the joint axis
-        f_total += (x_err - q * axis_p) * joint_attach_ke + (v_err - qd * axis_p) * joint_attach_kd
-        t_total += (
-            wp.transform_vector(X_wp, ang_err) * joint_attach_ke + w_err * joint_attach_kd * angular_damping_scale
-        )
-
-    if type == wp.sim.JOINT_REVOLUTE:
-        axis = joint_axis[axis_start]
-
-        axis_p = wp.transform_vector(X_wp, axis)
-        axis_c = wp.transform_vector(X_wc, axis)
-
-        # swing twist decomposition
-        twist = quat_twist(axis, r_err)
-
-        q = wp.acos(twist[3]) * 2.0 * wp.sign(wp.dot(axis, wp.vec3(twist[0], twist[1], twist[2])))
-        qd = wp.dot(w_err, axis_p)
-        act = joint_act[axis_start]
-
-        t_total = axis_p * -eval_joint_force(
-            q,
-            qd,
-            act,
-            joint_target_ke[axis_start],
-            joint_target_kd[axis_start],
-            joint_limit_lower[axis_start],
-            joint_limit_upper[axis_start],
-            joint_limit_ke[axis_start],
-            joint_limit_kd[axis_start],
-            joint_axis_mode[axis_start],
-        )
-
-        # attachment dynamics
-        swing_err = wp.cross(axis_p, axis_c)
-
-        f_total += x_err * joint_attach_ke + v_err * joint_attach_kd
-        t_total += swing_err * joint_attach_ke + (w_err - qd * axis_p) * joint_attach_kd * angular_damping_scale
-
-    if type == wp.sim.JOINT_BALL:
-        ang_err = wp.normalize(wp.vec3(r_err[0], r_err[1], r_err[2])) * wp.acos(r_err[3]) * 2.0
-
-        # TODO joint limits
-        # TODO expose target_kd or target_ke for ball joints
-        # t_total += target_kd * w_err + target_ke * wp.transform_vector(X_wp, ang_err)
-        f_total += x_err * joint_attach_ke + v_err * joint_attach_kd
-
-    if type == wp.sim.JOINT_COMPOUND:
-        q_pc = wp.quat_inverse(q_p) * q_c
-
-        # decompose to a compound rotation each axis
-        angles = quat_decompose(q_pc)
-
-        # reconstruct rotation axes
-        axis_0 = wp.vec3(1.0, 0.0, 0.0)
-        q_0 = wp.quat_from_axis_angle(axis_0, angles[0])
-
-        axis_1 = wp.quat_rotate(q_0, wp.vec3(0.0, 1.0, 0.0))
-        q_1 = wp.quat_from_axis_angle(axis_1, angles[1])
-
-        axis_2 = wp.quat_rotate(q_1 * q_0, wp.vec3(0.0, 0.0, 1.0))
-        # q_2 = wp.quat_from_axis_angle(axis_2, angles[2])
-
-        # q_w = q_p
-
-        axis_0 = wp.transform_vector(X_wp, axis_0)
-        axis_1 = wp.transform_vector(X_wp, axis_1)
-        axis_2 = wp.transform_vector(X_wp, axis_2)
-
-        # joint dynamics
-        # # TODO remove wp.quat_rotate(q_w, ...)?
-        # t_total += eval_joint_force(angles[0], wp.dot(wp.quat_rotate(q_w, axis_0), w_err), joint_target[axis_start+0], joint_target_ke[axis_start+0],joint_target_kd[axis_start+0], joint_act[axis_start+0], joint_limit_lower[axis_start+0], joint_limit_upper[axis_start+0], joint_limit_ke[axis_start+0], joint_limit_kd[axis_start+0], wp.quat_rotate(q_w, axis_0))
-        # t_total += eval_joint_force(angles[1], wp.dot(wp.quat_rotate(q_w, axis_1), w_err), joint_target[axis_start+1], joint_target_ke[axis_start+1],joint_target_kd[axis_start+1], joint_act[axis_start+1], joint_limit_lower[axis_start+1], joint_limit_upper[axis_start+1], joint_limit_ke[axis_start+1], joint_limit_kd[axis_start+1], wp.quat_rotate(q_w, axis_1))
-        # t_total += eval_joint_force(angles[2], wp.dot(wp.quat_rotate(q_w, axis_2), w_err), joint_target[axis_start+2], joint_target_ke[axis_start+2],joint_target_kd[axis_start+2], joint_act[axis_start+2], joint_limit_lower[axis_start+2], joint_limit_upper[axis_start+2], joint_limit_ke[axis_start+2], joint_limit_kd[axis_start+2], wp.quat_rotate(q_w, axis_2))
-
-        t_total += axis_0 * -eval_joint_force(
-            angles[0],
-            wp.dot(axis_0, w_err),
-            joint_act[axis_start + 0],
-            joint_target_ke[axis_start + 0],
-            joint_target_kd[axis_start + 0],
-            joint_limit_lower[axis_start + 0],
-            joint_limit_upper[axis_start + 0],
-            joint_limit_ke[axis_start + 0],
-            joint_limit_kd[axis_start + 0],
-            joint_axis_mode[axis_start + 0],
-        )
-        t_total += axis_1 * -eval_joint_force(
-            angles[1],
-            wp.dot(axis_1, w_err),
-            joint_act[axis_start + 1],
-            joint_target_ke[axis_start + 1],
-            joint_target_kd[axis_start + 1],
-            joint_limit_lower[axis_start + 1],
-            joint_limit_upper[axis_start + 1],
-            joint_limit_ke[axis_start + 1],
-            joint_limit_kd[axis_start + 1],
-            joint_axis_mode[axis_start + 1],
-        )
-        t_total += axis_2 * -eval_joint_force(
-            angles[2],
-            wp.dot(axis_2, w_err),
-            joint_act[axis_start + 2],
-            joint_target_ke[axis_start + 2],
-            joint_target_kd[axis_start + 2],
-            joint_limit_lower[axis_start + 2],
-            joint_limit_upper[axis_start + 2],
-            joint_limit_ke[axis_start + 2],
-            joint_limit_kd[axis_start + 2],
-            joint_axis_mode[axis_start + 2],
-        )
-
-        f_total += x_err * joint_attach_ke + v_err * joint_attach_kd
-
-    if type == wp.sim.JOINT_UNIVERSAL:
-        q_pc = wp.quat_inverse(q_p) * q_c
-
-        # decompose to a compound rotation each axis
-        angles = quat_decompose(q_pc)
-
-        # reconstruct rotation axes
-        axis_0 = wp.vec3(1.0, 0.0, 0.0)
-        q_0 = wp.quat_from_axis_angle(axis_0, angles[0])
-
-        axis_1 = wp.quat_rotate(q_0, wp.vec3(0.0, 1.0, 0.0))
-        q_1 = wp.quat_from_axis_angle(axis_1, angles[1])
-
-        axis_2 = wp.quat_rotate(q_1 * q_0, wp.vec3(0.0, 0.0, 1.0))
-
-        axis_0 = wp.transform_vector(X_wp, axis_0)
-        axis_1 = wp.transform_vector(X_wp, axis_1)
-        axis_2 = wp.transform_vector(X_wp, axis_2)
-
-        # joint dynamics
-
-        t_total += axis_0 * -eval_joint_force(
-            angles[0],
-            wp.dot(axis_0, w_err),
-            joint_act[axis_start + 0],
-            joint_target_ke[axis_start + 0],
-            joint_target_kd[axis_start + 0],
-            joint_limit_lower[axis_start + 0],
-            joint_limit_upper[axis_start + 0],
-            joint_limit_ke[axis_start + 0],
-            joint_limit_kd[axis_start + 0],
-            joint_axis_mode[axis_start + 0],
-        )
-        t_total += axis_1 * -eval_joint_force(
-            angles[1],
-            wp.dot(axis_1, w_err),
-            joint_act[axis_start + 1],
-            joint_target_ke[axis_start + 1],
-            joint_target_kd[axis_start + 1],
-            joint_limit_lower[axis_start + 1],
-            joint_limit_upper[axis_start + 1],
-            joint_limit_ke[axis_start + 1],
-            joint_limit_kd[axis_start + 1],
-            joint_axis_mode[axis_start + 1],
-        )
-
-        # last axis (fixed)
-        t_total += axis_2 * -eval_joint_force(
-            angles[2],
-            wp.dot(axis_2, w_err),
-            0.0,
-            joint_attach_ke,
-            joint_attach_kd * angular_damping_scale,
-            0.0,
-            0.0,
-            0.0,
-            0.0,
-            wp.sim.JOINT_MODE_FORCE,
-        )
-
-        f_total += x_err * joint_attach_ke + v_err * joint_attach_kd
-
-    if type == wp.sim.JOINT_D6:
-        pos = wp.vec3(0.0)
-        vel = wp.vec3(0.0)
-        if lin_axis_count >= 1:
-            axis_0 = wp.transform_vector(X_wp, joint_axis[axis_start + 0])
-            q0 = wp.dot(x_err, axis_0)
-            qd0 = wp.dot(v_err, axis_0)
-
-            f_total += axis_0 * -eval_joint_force(
-                q0,
-                qd0,
-                joint_act[axis_start + 0],
-                joint_target_ke[axis_start + 0],
-                joint_target_kd[axis_start + 0],
-                joint_limit_lower[axis_start + 0],
-                joint_limit_upper[axis_start + 0],
-                joint_limit_ke[axis_start + 0],
-                joint_limit_kd[axis_start + 0],
-                joint_axis_mode[axis_start + 0],
-            )
-
-            pos += q0 * axis_0
-            vel += qd0 * axis_0
-
-        if lin_axis_count >= 2:
-            axis_1 = wp.transform_vector(X_wp, joint_axis[axis_start + 1])
-            q1 = wp.dot(x_err, axis_1)
-            qd1 = wp.dot(v_err, axis_1)
-
-            f_total += axis_1 * -eval_joint_force(
-                q1,
-                qd1,
-                joint_act[axis_start + 1],
-                joint_target_ke[axis_start + 1],
-                joint_target_kd[axis_start + 1],
-                joint_limit_lower[axis_start + 1],
-                joint_limit_upper[axis_start + 1],
-                joint_limit_ke[axis_start + 1],
-                joint_limit_kd[axis_start + 1],
-                joint_axis_mode[axis_start + 1],
-            )
-
-            pos += q1 * axis_1
-            vel += qd1 * axis_1
-
-        if lin_axis_count == 3:
-            axis_2 = wp.transform_vector(X_wp, joint_axis[axis_start + 2])
-            q2 = wp.dot(x_err, axis_2)
-            qd2 = wp.dot(v_err, axis_2)
-
-            f_total += axis_2 * -eval_joint_force(
-                q2,
-                qd2,
-                joint_act[axis_start + 2],
-                joint_target_ke[axis_start + 2],
-                joint_target_kd[axis_start + 2],
-                joint_limit_lower[axis_start + 2],
-                joint_limit_upper[axis_start + 2],
-                joint_limit_ke[axis_start + 2],
-                joint_limit_kd[axis_start + 2],
-                joint_axis_mode[axis_start + 2],
-            )
-
-            pos += q2 * axis_2
-            vel += qd2 * axis_2
-
-        f_total += (x_err - pos) * joint_attach_ke + (v_err - vel) * joint_attach_kd
-
-        if ang_axis_count == 0:
-            ang_err = wp.normalize(wp.vec3(r_err[0], r_err[1], r_err[2])) * wp.acos(r_err[3]) * 2.0
-            t_total += (
-                wp.transform_vector(X_wp, ang_err) * joint_attach_ke + w_err * joint_attach_kd * angular_damping_scale
-            )
-
-        i_0 = lin_axis_count + axis_start + 0
-        i_1 = lin_axis_count + axis_start + 1
-        i_2 = lin_axis_count + axis_start + 2
-
-        if ang_axis_count == 1:
-            axis = joint_axis[i_0]
-
-            axis_p = wp.transform_vector(X_wp, axis)
-            axis_c = wp.transform_vector(X_wc, axis)
-
-            # swing twist decomposition
-            twist = quat_twist(axis, r_err)
-
-            q = wp.acos(twist[3]) * 2.0 * wp.sign(wp.dot(axis, wp.vec3(twist[0], twist[1], twist[2])))
-            qd = wp.dot(w_err, axis_p)
-
-            t_total = axis_p * -eval_joint_force(
-                q,
-                qd,
-                joint_act[i_0],
-                joint_target_ke[i_0],
-                joint_target_kd[i_0],
-                joint_limit_lower[i_0],
-                joint_limit_upper[i_0],
-                joint_limit_ke[i_0],
-                joint_limit_kd[i_0],
-                joint_axis_mode[i_0],
-            )
-
-            # attachment dynamics
-            swing_err = wp.cross(axis_p, axis_c)
-
-            t_total += swing_err * joint_attach_ke + (w_err - qd * axis_p) * joint_attach_kd * angular_damping_scale
-
-        if ang_axis_count == 2:
-            q_pc = wp.quat_inverse(q_p) * q_c
-
-            # decompose to a compound rotation each axis
-            angles = quat_decompose(q_pc)
-
-            orig_axis_0 = joint_axis[i_0]
-            orig_axis_1 = joint_axis[i_1]
-            orig_axis_2 = wp.cross(orig_axis_0, orig_axis_1)
-
-            # reconstruct rotation axes
-            axis_0 = orig_axis_0
-            q_0 = wp.quat_from_axis_angle(axis_0, angles[0])
-
-            axis_1 = wp.quat_rotate(q_0, orig_axis_1)
-            q_1 = wp.quat_from_axis_angle(axis_1, angles[1])
-
-            axis_2 = wp.quat_rotate(q_1 * q_0, orig_axis_2)
-
-            axis_0 = wp.transform_vector(X_wp, axis_0)
-            axis_1 = wp.transform_vector(X_wp, axis_1)
-            axis_2 = wp.transform_vector(X_wp, axis_2)
-
-            # joint dynamics
-
-            t_total += axis_0 * -eval_joint_force(
-                angles[0],
-                wp.dot(axis_0, w_err),
-                joint_act[i_0],
-                joint_target_ke[i_0],
-                joint_target_kd[i_0],
-                joint_limit_lower[i_0],
-                joint_limit_upper[i_0],
-                joint_limit_ke[i_0],
-                joint_limit_kd[i_0],
-                joint_axis_mode[i_0],
-            )
-            t_total += axis_1 * -eval_joint_force(
-                angles[1],
-                wp.dot(axis_1, w_err),
-                joint_act[i_1],
-                joint_target_ke[i_1],
-                joint_target_kd[i_1],
-                joint_limit_lower[i_1],
-                joint_limit_upper[i_1],
-                joint_limit_ke[i_1],
-                joint_limit_kd[i_1],
-                joint_axis_mode[i_1],
-            )
-
-            # last axis (fixed)
-            t_total += axis_2 * -eval_joint_force(
-                angles[2],
-                wp.dot(axis_2, w_err),
-                0.0,
-                joint_attach_ke,
-                joint_attach_kd * angular_damping_scale,
-                0.0,
-                0.0,
-                0.0,
-                0.0,
-                wp.sim.JOINT_MODE_FORCE,
-            )
-
-        if ang_axis_count == 3:
-            q_pc = wp.quat_inverse(q_p) * q_c
-
-            # decompose to a compound rotation each axis
-            angles = quat_decompose(q_pc)
-
-            orig_axis_0 = joint_axis[i_0]
-            orig_axis_1 = joint_axis[i_1]
-            orig_axis_2 = joint_axis[i_2]
-
-            # reconstruct rotation axes
-            axis_0 = orig_axis_0
-            q_0 = wp.quat_from_axis_angle(axis_0, angles[0])
-
-            axis_1 = wp.quat_rotate(q_0, orig_axis_1)
-            q_1 = wp.quat_from_axis_angle(axis_1, angles[1])
-
-            axis_2 = wp.quat_rotate(q_1 * q_0, orig_axis_2)
-
-            axis_0 = wp.transform_vector(X_wp, axis_0)
-            axis_1 = wp.transform_vector(X_wp, axis_1)
-            axis_2 = wp.transform_vector(X_wp, axis_2)
-
-            t_total += axis_0 * -eval_joint_force(
-                angles[0],
-                wp.dot(axis_0, w_err),
-                joint_act[i_0],
-                joint_target_ke[i_0],
-                joint_target_kd[i_0],
-                joint_limit_lower[i_0],
-                joint_limit_upper[i_0],
-                joint_limit_ke[i_0],
-                joint_limit_kd[i_0],
-                joint_axis_mode[i_0],
-            )
-            t_total += axis_1 * -eval_joint_force(
-                angles[1],
-                wp.dot(axis_1, w_err),
-                joint_act[i_1],
-                joint_target_ke[i_1],
-                joint_target_kd[i_1],
-                joint_limit_lower[i_1],
-                joint_limit_upper[i_1],
-                joint_limit_ke[i_1],
-                joint_limit_kd[i_1],
-                joint_axis_mode[i_1],
-            )
-            t_total += axis_2 * -eval_joint_force(
-                angles[2],
-                wp.dot(axis_2, w_err),
-                joint_act[i_2],
-                joint_target_ke[i_2],
-                joint_target_kd[i_2],
-                joint_limit_lower[i_2],
-                joint_limit_upper[i_2],
-                joint_limit_ke[i_2],
-                joint_limit_kd[i_2],
-                joint_axis_mode[i_2],
-            )
-
-    # write forces
-    if c_parent >= 0:
-        wp.atomic_add(body_f, c_parent, wp.spatial_vector(t_total + wp.cross(r_p, f_total), f_total))
-
-    wp.atomic_sub(body_f, c_child, wp.spatial_vector(t_total + wp.cross(r_c, f_total), f_total))
-
-
-@wp.func
-def compute_muscle_force(
-    i: int,
-    body_X_s: wp.array(dtype=wp.transform),
-    body_v_s: wp.array(dtype=wp.spatial_vector),
-    body_com: wp.array(dtype=wp.vec3),
-    muscle_links: wp.array(dtype=int),
-    muscle_points: wp.array(dtype=wp.vec3),
-    muscle_activation: float,
-    body_f_s: wp.array(dtype=wp.spatial_vector),
-):
-    link_0 = muscle_links[i]
-    link_1 = muscle_links[i + 1]
-
-    if link_0 == link_1:
-        return 0
-
-    r_0 = muscle_points[i]
-    r_1 = muscle_points[i + 1]
-
-    xform_0 = body_X_s[link_0]
-    xform_1 = body_X_s[link_1]
-
-    pos_0 = wp.transform_point(xform_0, r_0 - body_com[link_0])
-    pos_1 = wp.transform_point(xform_1, r_1 - body_com[link_1])
-
-    n = wp.normalize(pos_1 - pos_0)
-
-    # todo: add passive elastic and viscosity terms
-    f = n * muscle_activation
-
-    wp.atomic_sub(body_f_s, link_0, wp.spatial_vector(f, wp.cross(pos_0, f)))
-    wp.atomic_add(body_f_s, link_1, wp.spatial_vector(f, wp.cross(pos_1, f)))
-
-
-@wp.kernel
-def eval_muscles(
-    body_X_s: wp.array(dtype=wp.transform),
-    body_v_s: wp.array(dtype=wp.spatial_vector),
-    body_com: wp.array(dtype=wp.vec3),
-    muscle_start: wp.array(dtype=int),
-    muscle_params: wp.array(dtype=float),
-    muscle_links: wp.array(dtype=int),
-    muscle_points: wp.array(dtype=wp.vec3),
-    muscle_activation: wp.array(dtype=float),
-    # output
-    body_f_s: wp.array(dtype=wp.spatial_vector),
-):
-    tid = wp.tid()
-
-    m_start = muscle_start[tid]
-    m_end = muscle_start[tid + 1] - 1
-
-    activation = muscle_activation[tid]
-
-    for i in range(m_start, m_end):
-        compute_muscle_force(i, body_X_s, body_v_s, body_com, muscle_links, muscle_points, activation, body_f_s)
-
-
-def eval_spring_forces(model: Model, state: State, particle_f: wp.array):
-    if model.spring_count:
-        wp.launch(
-            kernel=eval_springs,
-            dim=model.spring_count,
-            inputs=[
-                state.particle_q,
-                state.particle_qd,
-                model.spring_indices,
-                model.spring_rest_length,
-                model.spring_stiffness,
-                model.spring_damping,
-            ],
-            outputs=[particle_f],
-            device=model.device,
-        )
-
-
-def eval_triangle_forces(model: Model, state: State, control: Control, particle_f: wp.array):
-    if model.tri_count:
-        wp.launch(
-            kernel=eval_triangles,
-            dim=model.tri_count,
-            inputs=[
-                state.particle_q,
-                state.particle_qd,
-                model.tri_indices,
-                model.tri_poses,
-                control.tri_activations,
-                model.tri_materials,
-            ],
-            outputs=[particle_f],
-            device=model.device,
-        )
-
-
-def eval_triangle_contact_forces(model: Model, state: State, particle_f: wp.array):
-    if model.enable_tri_collisions:
-        wp.launch(
-            kernel=eval_triangles_contact,
-            dim=model.tri_count * model.particle_count,
-            inputs=[
-                model.particle_count,
-                state.particle_q,
-                state.particle_qd,
-                model.tri_indices,
-                model.tri_materials,
-                model.particle_radius,
-            ],
-            outputs=[particle_f],
-            device=model.device,
-        )
-
-
-def eval_bending_forces(model: Model, state: State, particle_f: wp.array):
-    if model.edge_count:
-        wp.launch(
-            kernel=eval_bending,
-            dim=model.edge_count,
-            inputs=[
-                state.particle_q,
-                state.particle_qd,
-                model.edge_indices,
-                model.edge_rest_angle,
-                model.edge_bending_properties,
-            ],
-            outputs=[particle_f],
-            device=model.device,
-        )
-
-
-def eval_particle_ground_contact_forces(model: Model, state: State, particle_f: wp.array):
-    if model.ground and model.particle_count:
-        wp.launch(
-            kernel=eval_particle_ground_contacts,
-            dim=model.particle_count,
-            inputs=[
-                state.particle_q,
-                state.particle_qd,
-                model.particle_radius,
-                model.particle_flags,
-                model.soft_contact_ke,
-                model.soft_contact_kd,
-                model.soft_contact_kf,
-                model.soft_contact_mu,
-                model.ground_plane,
-            ],
-            outputs=[particle_f],
-            device=model.device,
-        )
-
-
-def eval_tetrahedral_forces(model: Model, state: State, control: Control, particle_f: wp.array):
-    if model.tet_count:
-        wp.launch(
-            kernel=eval_tetrahedra,
-            dim=model.tet_count,
-            inputs=[
-                state.particle_q,
-                state.particle_qd,
-                model.tet_indices,
-                model.tet_poses,
-                control.tet_activations,
-                model.tet_materials,
-            ],
-            outputs=[particle_f],
-            device=model.device,
-        )
-
-
-def eval_body_contact_forces(model: Model, state: State, particle_f: wp.array, friction_smoothing: float = 1.0):
-    if model.rigid_contact_max and (
-        (model.ground and model.shape_ground_contact_pair_count) or model.shape_contact_pair_count
-    ):
-        wp.launch(
-            kernel=eval_rigid_contacts,
-            dim=model.rigid_contact_max,
-            inputs=[
-                state.body_q,
-                state.body_qd,
-                model.body_com,
-                model.shape_materials,
-                model.shape_geo,
-                model.shape_body,
-                model.rigid_contact_count,
-                model.rigid_contact_point0,
-                model.rigid_contact_point1,
-                model.rigid_contact_normal,
-                model.rigid_contact_shape0,
-                model.rigid_contact_shape1,
-                False,
-                friction_smoothing,
-            ],
-            outputs=[state.body_f],
-            device=model.device,
-        )
-
-
-def eval_body_joint_forces(model: Model, state: State, control: Control, body_f: wp.array):
-    if model.joint_count:
-        wp.launch(
-            kernel=eval_body_joints,
-            dim=model.joint_count,
-            inputs=[
-                state.body_q,
-                state.body_qd,
-                model.body_com,
-                model.joint_qd_start,
-                model.joint_type,
-                model.joint_enabled,
-                model.joint_child,
-                model.joint_parent,
-                model.joint_X_p,
-                model.joint_X_c,
-                model.joint_axis,
-                model.joint_axis_start,
-                model.joint_axis_dim,
-                model.joint_axis_mode,
-                control.joint_act,
-                model.joint_target_ke,
-                model.joint_target_kd,
-                model.joint_limit_lower,
-                model.joint_limit_upper,
-                model.joint_limit_ke,
-                model.joint_limit_kd,
-                model.joint_attach_ke,
-                model.joint_attach_kd,
-            ],
-            outputs=[body_f],
-            device=model.device,
-        )
-
-
-def eval_particle_body_contact_forces(
-    model: Model, state: State, particle_f: wp.array, body_f: wp.array, body_f_in_world_frame: bool = False
-):
-    if model.particle_count and model.shape_count > 1:
-        wp.launch(
-            kernel=eval_particle_contacts,
-            dim=model.soft_contact_max,
-            inputs=[
-                state.particle_q,
-                state.particle_qd,
-                state.body_q,
-                state.body_qd,
-                model.particle_radius,
-                model.particle_flags,
-                model.body_com,
-                model.shape_body,
-                model.shape_materials,
-                model.soft_contact_ke,
-                model.soft_contact_kd,
-                model.soft_contact_kf,
-                model.soft_contact_mu,
-                model.particle_adhesion,
-                model.soft_contact_count,
-                model.soft_contact_particle,
-                model.soft_contact_shape,
-                model.soft_contact_body_pos,
-                model.soft_contact_body_vel,
-                model.soft_contact_normal,
-                model.soft_contact_max,
-                body_f_in_world_frame,
-            ],
-            # outputs
-            outputs=[particle_f, body_f],
-            device=model.device,
-        )
-
-
-def eval_muscle_forces(model: Model, state: State, control: Control, body_f: wp.array):
-    if model.muscle_count:
-        wp.launch(
-            kernel=eval_muscles,
-            dim=model.muscle_count,
-            inputs=[
-                state.body_q,
-                state.body_qd,
-                model.body_com,
-                model.muscle_start,
-                model.muscle_params,
-                model.muscle_bodies,
-                model.muscle_points,
-                control.muscle_activations,
-            ],
-            outputs=[body_f],
-            device=model.device,
-        )
-
-
-def compute_forces(
-    model: Model,
-    state: State,
-    control: Control,
-    particle_f: wp.array,
-    body_f: wp.array,
-    dt: float,
-    friction_smoothing: float = 1.0,
-):
-    # damped springs
-    eval_spring_forces(model, state, particle_f)
-
-    # triangle elastic and lift/drag forces
-    eval_triangle_forces(model, state, control, particle_f)
-
-    # triangle/triangle contacts
-    eval_triangle_contact_forces(model, state, particle_f)
-
-    # triangle bending
-    eval_bending_forces(model, state, particle_f)
-
-    # tetrahedral FEM
-    eval_tetrahedral_forces(model, state, control, particle_f)
-
-    # body joints
-    eval_body_joint_forces(model, state, control, body_f)
-
-    # particle-particle interactions
-    eval_particle_forces(model, state, particle_f)
-
-    # particle ground contacts
-    eval_particle_ground_contact_forces(model, state, particle_f)
-
-    # body contacts
-    eval_body_contact_forces(model, state, particle_f, friction_smoothing=friction_smoothing)
-
-    # particle shape contact
-    eval_particle_body_contact_forces(model, state, particle_f, body_f, body_f_in_world_frame=False)
-
-    # muscles
-    if False:
-        eval_muscle_forces(model, state, control, body_f)
-
-
-class SemiImplicitIntegrator(Integrator):
-    """A semi-implicit integrator using symplectic Euler
-
-    After constructing `Model` and `State` objects this time-integrator
-    may be used to advance the simulation state forward in time.
-
-    Semi-implicit time integration is a variational integrator that
-    preserves energy, however it not unconditionally stable, and requires a time-step
-    small enough to support the required stiffness and damping forces.
-
-    See: https://en.wikipedia.org/wiki/Semi-implicit_Euler_method
-
-    Example
-    -------
-
-    .. code-block:: python
-
-        integrator = wp.SemiImplicitIntegrator()
-
-        # simulation loop
-        for i in range(100):
-            state = integrator.simulate(model, state_in, state_out, dt)
-
-    """
-
-    def __init__(self, angular_damping: float = 0.05, friction_smoothing: float = 1.0):
-        """
-        Args:
-            angular_damping (float, optional): Angular damping factor. Defaults to 0.05.
-            friction_smoothing (float, optional): The delta value for the Huber norm (see :func:`warp.math.norm_huber`) used for the friction velocity normalization. Defaults to 1.0.
-        """
-        self.angular_damping = angular_damping
-        self.friction_smoothing = friction_smoothing
-
-    def simulate(self, model: Model, state_in: State, state_out: State, dt: float, control: Control = None):
-        with wp.ScopedTimer("simulate", False):
-            particle_f = None
-            body_f = None
-
-            if state_in.particle_count:
-                particle_f = state_in.particle_f
-
-            if state_in.body_count:
-                body_f = state_in.body_f
-
-            if control is None:
-                control = model.control(clone_variables=False)
-
-            compute_forces(model, state_in, control, particle_f, body_f, dt, friction_smoothing=self.friction_smoothing)
-
-            self.integrate_bodies(model, state_in, state_out, dt, self.angular_damping)
-
-            self.integrate_particles(model, state_in, state_out, dt)
-
-            return state_out
diff --git a/warp/sim/integrator_featherstone.py b/warp/sim/integrator_featherstone.py
deleted file mode 100644
index d6470193..00000000
--- a/warp/sim/integrator_featherstone.py
+++ /dev/null
@@ -1,2101 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-import warp as wp
-
-from .articulation import (
-    compute_2d_rotational_dofs,
-    compute_3d_rotational_dofs,
-    eval_fk,
-)
-from .integrator import Integrator
-from .integrator_euler import (
-    eval_bending_forces,
-    eval_joint_force,
-    eval_muscle_forces,
-    eval_particle_body_contact_forces,
-    eval_particle_forces,
-    eval_particle_ground_contact_forces,
-    eval_rigid_contacts,
-    eval_spring_forces,
-    eval_tetrahedral_forces,
-    eval_triangle_contact_forces,
-    eval_triangle_forces,
-)
-from .model import Control, Model, State
-
-
-# Frank & Park definition 3.20, pg 100
-@wp.func
-def transform_twist(t: wp.transform, x: wp.spatial_vector):
-    q = wp.transform_get_rotation(t)
-    p = wp.transform_get_translation(t)
-
-    w = wp.spatial_top(x)
-    v = wp.spatial_bottom(x)
-
-    w = wp.quat_rotate(q, w)
-    v = wp.quat_rotate(q, v) + wp.cross(p, w)
-
-    return wp.spatial_vector(w, v)
-
-
-@wp.func
-def transform_wrench(t: wp.transform, x: wp.spatial_vector):
-    q = wp.transform_get_rotation(t)
-    p = wp.transform_get_translation(t)
-
-    w = wp.spatial_top(x)
-    v = wp.spatial_bottom(x)
-
-    v = wp.quat_rotate(q, v)
-    w = wp.quat_rotate(q, w) + wp.cross(p, v)
-
-    return wp.spatial_vector(w, v)
-
-
-@wp.func
-def spatial_adjoint(R: wp.mat33, S: wp.mat33):
-    # T = [R  0]
-    #     [S  R]
-
-    # fmt: off
-    return wp.spatial_matrix(
-        R[0, 0], R[0, 1], R[0, 2],     0.0,     0.0,     0.0,
-        R[1, 0], R[1, 1], R[1, 2],     0.0,     0.0,     0.0,
-        R[2, 0], R[2, 1], R[2, 2],     0.0,     0.0,     0.0,
-        S[0, 0], S[0, 1], S[0, 2], R[0, 0], R[0, 1], R[0, 2],
-        S[1, 0], S[1, 1], S[1, 2], R[1, 0], R[1, 1], R[1, 2],
-        S[2, 0], S[2, 1], S[2, 2], R[2, 0], R[2, 1], R[2, 2],
-    )
-    # fmt: on
-
-
-@wp.kernel
-def compute_spatial_inertia(
-    body_inertia: wp.array(dtype=wp.mat33),
-    body_mass: wp.array(dtype=float),
-    # outputs
-    body_I_m: wp.array(dtype=wp.spatial_matrix),
-):
-    tid = wp.tid()
-    I = body_inertia[tid]
-    m = body_mass[tid]
-    # fmt: off
-    body_I_m[tid] = wp.spatial_matrix(
-        I[0, 0], I[0, 1], I[0, 2], 0.0, 0.0, 0.0,
-        I[1, 0], I[1, 1], I[1, 2], 0.0, 0.0, 0.0,
-        I[2, 0], I[2, 1], I[2, 2], 0.0, 0.0, 0.0,
-        0.0,     0.0,     0.0,     m,   0.0, 0.0,
-        0.0,     0.0,     0.0,     0.0, m,   0.0,
-        0.0,     0.0,     0.0,     0.0, 0.0, m,
-    )
-    # fmt: on
-
-
-@wp.kernel
-def compute_com_transforms(
-    body_com: wp.array(dtype=wp.vec3),
-    # outputs
-    body_X_com: wp.array(dtype=wp.transform),
-):
-    tid = wp.tid()
-    com = body_com[tid]
-    body_X_com[tid] = wp.transform(com, wp.quat_identity())
-
-
-# computes adj_t^-T*I*adj_t^-1 (tensor change of coordinates), Frank & Park, section 8.2.3, pg 290
-@wp.func
-def spatial_transform_inertia(t: wp.transform, I: wp.spatial_matrix):
-    t_inv = wp.transform_inverse(t)
-
-    q = wp.transform_get_rotation(t_inv)
-    p = wp.transform_get_translation(t_inv)
-
-    r1 = wp.quat_rotate(q, wp.vec3(1.0, 0.0, 0.0))
-    r2 = wp.quat_rotate(q, wp.vec3(0.0, 1.0, 0.0))
-    r3 = wp.quat_rotate(q, wp.vec3(0.0, 0.0, 1.0))
-
-    R = wp.matrix_from_cols(r1, r2, r3)
-    S = wp.skew(p) @ R
-
-    T = spatial_adjoint(R, S)
-
-    return wp.mul(wp.mul(wp.transpose(T), I), T)
-
-
-# compute transform across a joint
-@wp.func
-def jcalc_transform(
-    type: int,
-    joint_axis: wp.array(dtype=wp.vec3),
-    axis_start: int,
-    lin_axis_count: int,
-    ang_axis_count: int,
-    joint_q: wp.array(dtype=float),
-    start: int,
-):
-    if type == wp.sim.JOINT_PRISMATIC:
-        q = joint_q[start]
-        axis = joint_axis[axis_start]
-        X_jc = wp.transform(axis * q, wp.quat_identity())
-        return X_jc
-
-    if type == wp.sim.JOINT_REVOLUTE:
-        q = joint_q[start]
-        axis = joint_axis[axis_start]
-        X_jc = wp.transform(wp.vec3(), wp.quat_from_axis_angle(axis, q))
-        return X_jc
-
-    if type == wp.sim.JOINT_BALL:
-        qx = joint_q[start + 0]
-        qy = joint_q[start + 1]
-        qz = joint_q[start + 2]
-        qw = joint_q[start + 3]
-
-        X_jc = wp.transform(wp.vec3(), wp.quat(qx, qy, qz, qw))
-        return X_jc
-
-    if type == wp.sim.JOINT_FIXED:
-        X_jc = wp.transform_identity()
-        return X_jc
-
-    if type == wp.sim.JOINT_FREE or type == wp.sim.JOINT_DISTANCE:
-        px = joint_q[start + 0]
-        py = joint_q[start + 1]
-        pz = joint_q[start + 2]
-
-        qx = joint_q[start + 3]
-        qy = joint_q[start + 4]
-        qz = joint_q[start + 5]
-        qw = joint_q[start + 6]
-
-        X_jc = wp.transform(wp.vec3(px, py, pz), wp.quat(qx, qy, qz, qw))
-        return X_jc
-
-    if type == wp.sim.JOINT_COMPOUND:
-        rot, _ = compute_3d_rotational_dofs(
-            joint_axis[axis_start],
-            joint_axis[axis_start + 1],
-            joint_axis[axis_start + 2],
-            joint_q[start + 0],
-            joint_q[start + 1],
-            joint_q[start + 2],
-            0.0,
-            0.0,
-            0.0,
-        )
-
-        X_jc = wp.transform(wp.vec3(), rot)
-        return X_jc
-
-    if type == wp.sim.JOINT_UNIVERSAL:
-        rot, _ = compute_2d_rotational_dofs(
-            joint_axis[axis_start],
-            joint_axis[axis_start + 1],
-            joint_q[start + 0],
-            joint_q[start + 1],
-            0.0,
-            0.0,
-        )
-
-        X_jc = wp.transform(wp.vec3(), rot)
-        return X_jc
-
-    if type == wp.sim.JOINT_D6:
-        pos = wp.vec3(0.0)
-        rot = wp.quat_identity()
-
-        # unroll for loop to ensure joint actions remain differentiable
-        # (since differentiating through a for loop that updates a local variable is not supported)
-
-        if lin_axis_count > 0:
-            axis = joint_axis[axis_start + 0]
-            pos += axis * joint_q[start + 0]
-        if lin_axis_count > 1:
-            axis = joint_axis[axis_start + 1]
-            pos += axis * joint_q[start + 1]
-        if lin_axis_count > 2:
-            axis = joint_axis[axis_start + 2]
-            pos += axis * joint_q[start + 2]
-
-        ia = axis_start + lin_axis_count
-        iq = start + lin_axis_count
-        if ang_axis_count == 1:
-            axis = joint_axis[ia]
-            rot = wp.quat_from_axis_angle(axis, joint_q[iq])
-        if ang_axis_count == 2:
-            rot, _ = compute_2d_rotational_dofs(
-                joint_axis[ia + 0],
-                joint_axis[ia + 1],
-                joint_q[iq + 0],
-                joint_q[iq + 1],
-                0.0,
-                0.0,
-            )
-        if ang_axis_count == 3:
-            rot, _ = compute_3d_rotational_dofs(
-                joint_axis[ia + 0],
-                joint_axis[ia + 1],
-                joint_axis[ia + 2],
-                joint_q[iq + 0],
-                joint_q[iq + 1],
-                joint_q[iq + 2],
-                0.0,
-                0.0,
-                0.0,
-            )
-
-        X_jc = wp.transform(pos, rot)
-        return X_jc
-
-    # default case
-    return wp.transform_identity()
-
-
-# compute motion subspace and velocity for a joint
-@wp.func
-def jcalc_motion(
-    type: int,
-    joint_axis: wp.array(dtype=wp.vec3),
-    axis_start: int,
-    lin_axis_count: int,
-    ang_axis_count: int,
-    X_sc: wp.transform,
-    joint_q: wp.array(dtype=float),
-    joint_qd: wp.array(dtype=float),
-    q_start: int,
-    qd_start: int,
-    # outputs
-    joint_S_s: wp.array(dtype=wp.spatial_vector),
-):
-    if type == wp.sim.JOINT_PRISMATIC:
-        axis = joint_axis[axis_start]
-        S_s = transform_twist(X_sc, wp.spatial_vector(wp.vec3(), axis))
-        v_j_s = S_s * joint_qd[qd_start]
-        joint_S_s[qd_start] = S_s
-        return v_j_s
-
-    if type == wp.sim.JOINT_REVOLUTE:
-        axis = joint_axis[axis_start]
-        S_s = transform_twist(X_sc, wp.spatial_vector(axis, wp.vec3()))
-        v_j_s = S_s * joint_qd[qd_start]
-        joint_S_s[qd_start] = S_s
-        return v_j_s
-
-    if type == wp.sim.JOINT_UNIVERSAL:
-        axis_0 = joint_axis[axis_start + 0]
-        axis_1 = joint_axis[axis_start + 1]
-        q_off = wp.quat_from_matrix(wp.matrix_from_cols(axis_0, axis_1, wp.cross(axis_0, axis_1)))
-        local_0 = wp.quat_rotate(q_off, wp.vec3(1.0, 0.0, 0.0))
-        local_1 = wp.quat_rotate(q_off, wp.vec3(0.0, 1.0, 0.0))
-
-        axis_0 = local_0
-        q_0 = wp.quat_from_axis_angle(axis_0, joint_q[q_start + 0])
-
-        axis_1 = wp.quat_rotate(q_0, local_1)
-
-        S_0 = transform_twist(X_sc, wp.spatial_vector(axis_0, wp.vec3()))
-        S_1 = transform_twist(X_sc, wp.spatial_vector(axis_1, wp.vec3()))
-
-        joint_S_s[qd_start + 0] = S_0
-        joint_S_s[qd_start + 1] = S_1
-
-        return S_0 * joint_qd[qd_start + 0] + S_1 * joint_qd[qd_start + 1]
-
-    if type == wp.sim.JOINT_COMPOUND:
-        axis_0 = joint_axis[axis_start + 0]
-        axis_1 = joint_axis[axis_start + 1]
-        axis_2 = joint_axis[axis_start + 2]
-        q_off = wp.quat_from_matrix(wp.matrix_from_cols(axis_0, axis_1, axis_2))
-        local_0 = wp.quat_rotate(q_off, wp.vec3(1.0, 0.0, 0.0))
-        local_1 = wp.quat_rotate(q_off, wp.vec3(0.0, 1.0, 0.0))
-        local_2 = wp.quat_rotate(q_off, wp.vec3(0.0, 0.0, 1.0))
-
-        axis_0 = local_0
-        q_0 = wp.quat_from_axis_angle(axis_0, joint_q[q_start + 0])
-
-        axis_1 = wp.quat_rotate(q_0, local_1)
-        q_1 = wp.quat_from_axis_angle(axis_1, joint_q[q_start + 1])
-
-        axis_2 = wp.quat_rotate(q_1 * q_0, local_2)
-
-        S_0 = transform_twist(X_sc, wp.spatial_vector(axis_0, wp.vec3()))
-        S_1 = transform_twist(X_sc, wp.spatial_vector(axis_1, wp.vec3()))
-        S_2 = transform_twist(X_sc, wp.spatial_vector(axis_2, wp.vec3()))
-
-        joint_S_s[qd_start + 0] = S_0
-        joint_S_s[qd_start + 1] = S_1
-        joint_S_s[qd_start + 2] = S_2
-
-        return S_0 * joint_qd[qd_start + 0] + S_1 * joint_qd[qd_start + 1] + S_2 * joint_qd[qd_start + 2]
-
-    if type == wp.sim.JOINT_D6:
-        v_j_s = wp.spatial_vector()
-        if lin_axis_count > 0:
-            axis = joint_axis[axis_start + 0]
-            S_s = transform_twist(X_sc, wp.spatial_vector(wp.vec3(), axis))
-            v_j_s += S_s * joint_qd[qd_start + 0]
-            joint_S_s[qd_start + 0] = S_s
-        if lin_axis_count > 1:
-            axis = joint_axis[axis_start + 1]
-            S_s = transform_twist(X_sc, wp.spatial_vector(wp.vec3(), axis))
-            v_j_s += S_s * joint_qd[qd_start + 1]
-            joint_S_s[qd_start + 1] = S_s
-        if lin_axis_count > 2:
-            axis = joint_axis[axis_start + 2]
-            S_s = transform_twist(X_sc, wp.spatial_vector(wp.vec3(), axis))
-            v_j_s += S_s * joint_qd[qd_start + 2]
-            joint_S_s[qd_start + 2] = S_s
-        if ang_axis_count > 0:
-            axis = joint_axis[axis_start + lin_axis_count + 0]
-            S_s = transform_twist(X_sc, wp.spatial_vector(axis, wp.vec3()))
-            v_j_s += S_s * joint_qd[qd_start + lin_axis_count + 0]
-            joint_S_s[qd_start + lin_axis_count + 0] = S_s
-        if ang_axis_count > 1:
-            axis = joint_axis[axis_start + lin_axis_count + 1]
-            S_s = transform_twist(X_sc, wp.spatial_vector(axis, wp.vec3()))
-            v_j_s += S_s * joint_qd[qd_start + lin_axis_count + 1]
-            joint_S_s[qd_start + lin_axis_count + 1] = S_s
-        if ang_axis_count > 2:
-            axis = joint_axis[axis_start + lin_axis_count + 2]
-            S_s = transform_twist(X_sc, wp.spatial_vector(axis, wp.vec3()))
-            v_j_s += S_s * joint_qd[qd_start + lin_axis_count + 2]
-            joint_S_s[qd_start + lin_axis_count + 2] = S_s
-
-        return v_j_s
-
-    if type == wp.sim.JOINT_BALL:
-        S_0 = transform_twist(X_sc, wp.spatial_vector(1.0, 0.0, 0.0, 0.0, 0.0, 0.0))
-        S_1 = transform_twist(X_sc, wp.spatial_vector(0.0, 1.0, 0.0, 0.0, 0.0, 0.0))
-        S_2 = transform_twist(X_sc, wp.spatial_vector(0.0, 0.0, 1.0, 0.0, 0.0, 0.0))
-
-        joint_S_s[qd_start + 0] = S_0
-        joint_S_s[qd_start + 1] = S_1
-        joint_S_s[qd_start + 2] = S_2
-
-        return S_0 * joint_qd[qd_start + 0] + S_1 * joint_qd[qd_start + 1] + S_2 * joint_qd[qd_start + 2]
-
-    if type == wp.sim.JOINT_FIXED:
-        return wp.spatial_vector()
-
-    if type == wp.sim.JOINT_FREE or type == wp.sim.JOINT_DISTANCE:
-        v_j_s = transform_twist(
-            X_sc,
-            wp.spatial_vector(
-                joint_qd[qd_start + 0],
-                joint_qd[qd_start + 1],
-                joint_qd[qd_start + 2],
-                joint_qd[qd_start + 3],
-                joint_qd[qd_start + 4],
-                joint_qd[qd_start + 5],
-            ),
-        )
-
-        joint_S_s[qd_start + 0] = transform_twist(X_sc, wp.spatial_vector(1.0, 0.0, 0.0, 0.0, 0.0, 0.0))
-        joint_S_s[qd_start + 1] = transform_twist(X_sc, wp.spatial_vector(0.0, 1.0, 0.0, 0.0, 0.0, 0.0))
-        joint_S_s[qd_start + 2] = transform_twist(X_sc, wp.spatial_vector(0.0, 0.0, 1.0, 0.0, 0.0, 0.0))
-        joint_S_s[qd_start + 3] = transform_twist(X_sc, wp.spatial_vector(0.0, 0.0, 0.0, 1.0, 0.0, 0.0))
-        joint_S_s[qd_start + 4] = transform_twist(X_sc, wp.spatial_vector(0.0, 0.0, 0.0, 0.0, 1.0, 0.0))
-        joint_S_s[qd_start + 5] = transform_twist(X_sc, wp.spatial_vector(0.0, 0.0, 0.0, 0.0, 0.0, 1.0))
-
-        return v_j_s
-
-    wp.printf("jcalc_motion not implemented for joint type %d\n", type)
-
-    # default case
-    return wp.spatial_vector()
-
-
-# computes joint space forces/torques in tau
-@wp.func
-def jcalc_tau(
-    type: int,
-    joint_target_ke: wp.array(dtype=float),
-    joint_target_kd: wp.array(dtype=float),
-    joint_limit_ke: wp.array(dtype=float),
-    joint_limit_kd: wp.array(dtype=float),
-    joint_S_s: wp.array(dtype=wp.spatial_vector),
-    joint_q: wp.array(dtype=float),
-    joint_qd: wp.array(dtype=float),
-    joint_act: wp.array(dtype=float),
-    joint_axis_mode: wp.array(dtype=int),
-    joint_limit_lower: wp.array(dtype=float),
-    joint_limit_upper: wp.array(dtype=float),
-    coord_start: int,
-    dof_start: int,
-    axis_start: int,
-    lin_axis_count: int,
-    ang_axis_count: int,
-    body_f_s: wp.spatial_vector,
-    # outputs
-    tau: wp.array(dtype=float),
-):
-    if type == wp.sim.JOINT_PRISMATIC or type == wp.sim.JOINT_REVOLUTE:
-        S_s = joint_S_s[dof_start]
-
-        q = joint_q[coord_start]
-        qd = joint_qd[dof_start]
-        act = joint_act[axis_start]
-
-        lower = joint_limit_lower[axis_start]
-        upper = joint_limit_upper[axis_start]
-
-        limit_ke = joint_limit_ke[axis_start]
-        limit_kd = joint_limit_kd[axis_start]
-        target_ke = joint_target_ke[axis_start]
-        target_kd = joint_target_kd[axis_start]
-        mode = joint_axis_mode[axis_start]
-
-        # total torque / force on the joint
-        t = -wp.dot(S_s, body_f_s) + eval_joint_force(
-            q, qd, act, target_ke, target_kd, lower, upper, limit_ke, limit_kd, mode
-        )
-
-        tau[dof_start] = t
-
-        return
-
-    if type == wp.sim.JOINT_BALL:
-        # target_ke = joint_target_ke[axis_start]
-        # target_kd = joint_target_kd[axis_start]
-
-        for i in range(3):
-            S_s = joint_S_s[dof_start + i]
-
-            # w = joint_qd[dof_start + i]
-            # r = joint_q[coord_start + i]
-
-            tau[dof_start + i] = -wp.dot(S_s, body_f_s)  # - w * target_kd - r * target_ke
-
-        return
-
-    if type == wp.sim.JOINT_FREE or type == wp.sim.JOINT_DISTANCE:
-        for i in range(6):
-            S_s = joint_S_s[dof_start + i]
-            tau[dof_start + i] = -wp.dot(S_s, body_f_s)
-
-        return
-
-    if type == wp.sim.JOINT_COMPOUND or type == wp.sim.JOINT_UNIVERSAL or type == wp.sim.JOINT_D6:
-        axis_count = lin_axis_count + ang_axis_count
-
-        for i in range(axis_count):
-            S_s = joint_S_s[dof_start + i]
-
-            q = joint_q[coord_start + i]
-            qd = joint_qd[dof_start + i]
-            act = joint_act[axis_start + i]
-
-            lower = joint_limit_lower[axis_start + i]
-            upper = joint_limit_upper[axis_start + i]
-            limit_ke = joint_limit_ke[axis_start + i]
-            limit_kd = joint_limit_kd[axis_start + i]
-            target_ke = joint_target_ke[axis_start + i]
-            target_kd = joint_target_kd[axis_start + i]
-            mode = joint_axis_mode[axis_start + i]
-
-            f = eval_joint_force(q, qd, act, target_ke, target_kd, lower, upper, limit_ke, limit_kd, mode)
-
-            # total torque / force on the joint
-            t = -wp.dot(S_s, body_f_s) + f
-
-            tau[dof_start + i] = t
-
-        return
-
-
-@wp.func
-def jcalc_integrate(
-    type: int,
-    joint_q: wp.array(dtype=float),
-    joint_qd: wp.array(dtype=float),
-    joint_qdd: wp.array(dtype=float),
-    coord_start: int,
-    dof_start: int,
-    lin_axis_count: int,
-    ang_axis_count: int,
-    dt: float,
-    # outputs
-    joint_q_new: wp.array(dtype=float),
-    joint_qd_new: wp.array(dtype=float),
-):
-    if type == wp.sim.JOINT_FIXED:
-        return
-
-    # prismatic / revolute
-    if type == wp.sim.JOINT_PRISMATIC or type == wp.sim.JOINT_REVOLUTE:
-        qdd = joint_qdd[dof_start]
-        qd = joint_qd[dof_start]
-        q = joint_q[coord_start]
-
-        qd_new = qd + qdd * dt
-        q_new = q + qd_new * dt
-
-        joint_qd_new[dof_start] = qd_new
-        joint_q_new[coord_start] = q_new
-
-        return
-
-    # ball
-    if type == wp.sim.JOINT_BALL:
-        m_j = wp.vec3(joint_qdd[dof_start + 0], joint_qdd[dof_start + 1], joint_qdd[dof_start + 2])
-        w_j = wp.vec3(joint_qd[dof_start + 0], joint_qd[dof_start + 1], joint_qd[dof_start + 2])
-
-        r_j = wp.quat(
-            joint_q[coord_start + 0], joint_q[coord_start + 1], joint_q[coord_start + 2], joint_q[coord_start + 3]
-        )
-
-        # symplectic Euler
-        w_j_new = w_j + m_j * dt
-
-        drdt_j = wp.quat(w_j_new, 0.0) * r_j * 0.5
-
-        # new orientation (normalized)
-        r_j_new = wp.normalize(r_j + drdt_j * dt)
-
-        # update joint coords
-        joint_q_new[coord_start + 0] = r_j_new[0]
-        joint_q_new[coord_start + 1] = r_j_new[1]
-        joint_q_new[coord_start + 2] = r_j_new[2]
-        joint_q_new[coord_start + 3] = r_j_new[3]
-
-        # update joint vel
-        joint_qd_new[dof_start + 0] = w_j_new[0]
-        joint_qd_new[dof_start + 1] = w_j_new[1]
-        joint_qd_new[dof_start + 2] = w_j_new[2]
-
-        return
-
-    # free joint
-    if type == wp.sim.JOINT_FREE or type == wp.sim.JOINT_DISTANCE:
-        # dofs: qd = (omega_x, omega_y, omega_z, vel_x, vel_y, vel_z)
-        # coords: q = (trans_x, trans_y, trans_z, quat_x, quat_y, quat_z, quat_w)
-
-        # angular and linear acceleration
-        m_s = wp.vec3(joint_qdd[dof_start + 0], joint_qdd[dof_start + 1], joint_qdd[dof_start + 2])
-        a_s = wp.vec3(joint_qdd[dof_start + 3], joint_qdd[dof_start + 4], joint_qdd[dof_start + 5])
-
-        # angular and linear velocity
-        w_s = wp.vec3(joint_qd[dof_start + 0], joint_qd[dof_start + 1], joint_qd[dof_start + 2])
-        v_s = wp.vec3(joint_qd[dof_start + 3], joint_qd[dof_start + 4], joint_qd[dof_start + 5])
-
-        # symplectic Euler
-        w_s = w_s + m_s * dt
-        v_s = v_s + a_s * dt
-
-        # translation of origin
-        p_s = wp.vec3(joint_q[coord_start + 0], joint_q[coord_start + 1], joint_q[coord_start + 2])
-
-        # linear vel of origin (note q/qd switch order of linear angular elements)
-        # note we are converting the body twist in the space frame (w_s, v_s) to compute center of mass velocity
-        dpdt_s = v_s + wp.cross(w_s, p_s)
-
-        # quat and quat derivative
-        r_s = wp.quat(
-            joint_q[coord_start + 3], joint_q[coord_start + 4], joint_q[coord_start + 5], joint_q[coord_start + 6]
-        )
-
-        drdt_s = wp.quat(w_s, 0.0) * r_s * 0.5
-
-        # new orientation (normalized)
-        p_s_new = p_s + dpdt_s * dt
-        r_s_new = wp.normalize(r_s + drdt_s * dt)
-
-        # update transform
-        joint_q_new[coord_start + 0] = p_s_new[0]
-        joint_q_new[coord_start + 1] = p_s_new[1]
-        joint_q_new[coord_start + 2] = p_s_new[2]
-
-        joint_q_new[coord_start + 3] = r_s_new[0]
-        joint_q_new[coord_start + 4] = r_s_new[1]
-        joint_q_new[coord_start + 5] = r_s_new[2]
-        joint_q_new[coord_start + 6] = r_s_new[3]
-
-        # update joint_twist
-        joint_qd_new[dof_start + 0] = w_s[0]
-        joint_qd_new[dof_start + 1] = w_s[1]
-        joint_qd_new[dof_start + 2] = w_s[2]
-        joint_qd_new[dof_start + 3] = v_s[0]
-        joint_qd_new[dof_start + 4] = v_s[1]
-        joint_qd_new[dof_start + 5] = v_s[2]
-
-        return
-
-    # other joint types (compound, universal, D6)
-    if type == wp.sim.JOINT_COMPOUND or type == wp.sim.JOINT_UNIVERSAL or type == wp.sim.JOINT_D6:
-        axis_count = lin_axis_count + ang_axis_count
-
-        for i in range(axis_count):
-            qdd = joint_qdd[dof_start + i]
-            qd = joint_qd[dof_start + i]
-            q = joint_q[coord_start + i]
-
-            qd_new = qd + qdd * dt
-            q_new = q + qd_new * dt
-
-            joint_qd_new[dof_start + i] = qd_new
-            joint_q_new[coord_start + i] = q_new
-
-        return
-
-
-@wp.func
-def compute_link_transform(
-    i: int,
-    joint_type: wp.array(dtype=int),
-    joint_parent: wp.array(dtype=int),
-    joint_child: wp.array(dtype=int),
-    joint_q_start: wp.array(dtype=int),
-    joint_q: wp.array(dtype=float),
-    joint_X_p: wp.array(dtype=wp.transform),
-    joint_X_c: wp.array(dtype=wp.transform),
-    body_X_com: wp.array(dtype=wp.transform),
-    joint_axis: wp.array(dtype=wp.vec3),
-    joint_axis_start: wp.array(dtype=int),
-    joint_axis_dim: wp.array(dtype=int, ndim=2),
-    # outputs
-    body_q: wp.array(dtype=wp.transform),
-    body_q_com: wp.array(dtype=wp.transform),
-):
-    # parent transform
-    parent = joint_parent[i]
-    child = joint_child[i]
-
-    # parent transform in spatial coordinates
-    X_pj = joint_X_p[i]
-    X_cj = joint_X_c[i]
-    # parent anchor frame in world space
-    X_wpj = X_pj
-    if parent >= 0:
-        X_wp = body_q[parent]
-        X_wpj = X_wp * X_wpj
-
-    type = joint_type[i]
-    axis_start = joint_axis_start[i]
-    lin_axis_count = joint_axis_dim[i, 0]
-    ang_axis_count = joint_axis_dim[i, 1]
-    coord_start = joint_q_start[i]
-
-    # compute transform across joint
-    X_j = jcalc_transform(type, joint_axis, axis_start, lin_axis_count, ang_axis_count, joint_q, coord_start)
-
-    # transform from world to joint anchor frame at child body
-    X_wcj = X_wpj * X_j
-    # transform from world to child body frame
-    X_wc = X_wcj * wp.transform_inverse(X_cj)
-
-    # compute transform of center of mass
-    X_cm = body_X_com[child]
-    X_sm = X_wc * X_cm
-
-    # store geometry transforms
-    body_q[child] = X_wc
-    body_q_com[child] = X_sm
-
-
-@wp.kernel
-def eval_rigid_fk(
-    articulation_start: wp.array(dtype=int),
-    joint_type: wp.array(dtype=int),
-    joint_parent: wp.array(dtype=int),
-    joint_child: wp.array(dtype=int),
-    joint_q_start: wp.array(dtype=int),
-    joint_q: wp.array(dtype=float),
-    joint_X_p: wp.array(dtype=wp.transform),
-    joint_X_c: wp.array(dtype=wp.transform),
-    body_X_com: wp.array(dtype=wp.transform),
-    joint_axis: wp.array(dtype=wp.vec3),
-    joint_axis_start: wp.array(dtype=int),
-    joint_axis_dim: wp.array(dtype=int, ndim=2),
-    # outputs
-    body_q: wp.array(dtype=wp.transform),
-    body_q_com: wp.array(dtype=wp.transform),
-):
-    # one thread per-articulation
-    index = wp.tid()
-
-    start = articulation_start[index]
-    end = articulation_start[index + 1]
-
-    for i in range(start, end):
-        compute_link_transform(
-            i,
-            joint_type,
-            joint_parent,
-            joint_child,
-            joint_q_start,
-            joint_q,
-            joint_X_p,
-            joint_X_c,
-            body_X_com,
-            joint_axis,
-            joint_axis_start,
-            joint_axis_dim,
-            body_q,
-            body_q_com,
-        )
-
-
-@wp.func
-def spatial_cross(a: wp.spatial_vector, b: wp.spatial_vector):
-    w_a = wp.spatial_top(a)
-    v_a = wp.spatial_bottom(a)
-
-    w_b = wp.spatial_top(b)
-    v_b = wp.spatial_bottom(b)
-
-    w = wp.cross(w_a, w_b)
-    v = wp.cross(w_a, v_b) + wp.cross(v_a, w_b)
-
-    return wp.spatial_vector(w, v)
-
-
-@wp.func
-def spatial_cross_dual(a: wp.spatial_vector, b: wp.spatial_vector):
-    w_a = wp.spatial_top(a)
-    v_a = wp.spatial_bottom(a)
-
-    w_b = wp.spatial_top(b)
-    v_b = wp.spatial_bottom(b)
-
-    w = wp.cross(w_a, w_b) + wp.cross(v_a, v_b)
-    v = wp.cross(w_a, v_b)
-
-    return wp.spatial_vector(w, v)
-
-
-@wp.func
-def dense_index(stride: int, i: int, j: int):
-    return i * stride + j
-
-
-@wp.func
-def compute_link_velocity(
-    i: int,
-    joint_type: wp.array(dtype=int),
-    joint_parent: wp.array(dtype=int),
-    joint_child: wp.array(dtype=int),
-    joint_q_start: wp.array(dtype=int),
-    joint_qd_start: wp.array(dtype=int),
-    joint_q: wp.array(dtype=float),
-    joint_qd: wp.array(dtype=float),
-    joint_axis: wp.array(dtype=wp.vec3),
-    joint_axis_start: wp.array(dtype=int),
-    joint_axis_dim: wp.array(dtype=int, ndim=2),
-    body_I_m: wp.array(dtype=wp.spatial_matrix),
-    body_q: wp.array(dtype=wp.transform),
-    body_q_com: wp.array(dtype=wp.transform),
-    joint_X_p: wp.array(dtype=wp.transform),
-    joint_X_c: wp.array(dtype=wp.transform),
-    gravity: wp.vec3,
-    # outputs
-    joint_S_s: wp.array(dtype=wp.spatial_vector),
-    body_I_s: wp.array(dtype=wp.spatial_matrix),
-    body_v_s: wp.array(dtype=wp.spatial_vector),
-    body_f_s: wp.array(dtype=wp.spatial_vector),
-    body_a_s: wp.array(dtype=wp.spatial_vector),
-):
-    type = joint_type[i]
-    child = joint_child[i]
-    parent = joint_parent[i]
-    q_start = joint_q_start[i]
-    qd_start = joint_qd_start[i]
-
-    X_pj = joint_X_p[i]
-    # X_cj = joint_X_c[i]
-
-    # parent anchor frame in world space
-    X_wpj = X_pj
-    if parent >= 0:
-        X_wp = body_q[parent]
-        X_wpj = X_wp * X_wpj
-
-    # compute motion subspace and velocity across the joint (also stores S_s to global memory)
-    axis_start = joint_axis_start[i]
-    lin_axis_count = joint_axis_dim[i, 0]
-    ang_axis_count = joint_axis_dim[i, 1]
-    v_j_s = jcalc_motion(
-        type,
-        joint_axis,
-        axis_start,
-        lin_axis_count,
-        ang_axis_count,
-        X_wpj,
-        joint_q,
-        joint_qd,
-        q_start,
-        qd_start,
-        joint_S_s,
-    )
-
-    # parent velocity
-    v_parent_s = wp.spatial_vector()
-    a_parent_s = wp.spatial_vector()
-
-    if parent >= 0:
-        v_parent_s = body_v_s[parent]
-        a_parent_s = body_a_s[parent]
-
-    # body velocity, acceleration
-    v_s = v_parent_s + v_j_s
-    a_s = a_parent_s + spatial_cross(v_s, v_j_s)  # + joint_S_s[i]*self.joint_qdd[i]
-
-    # compute body forces
-    X_sm = body_q_com[child]
-    I_m = body_I_m[child]
-
-    # gravity and external forces (expressed in frame aligned with s but centered at body mass)
-    m = I_m[3, 3]
-
-    f_g = m * gravity
-    r_com = wp.transform_get_translation(X_sm)
-    f_g_s = wp.spatial_vector(wp.cross(r_com, f_g), f_g)
-
-    # body forces
-    I_s = spatial_transform_inertia(X_sm, I_m)
-
-    f_b_s = I_s * a_s + spatial_cross_dual(v_s, I_s * v_s)
-
-    body_v_s[child] = v_s
-    body_a_s[child] = a_s
-    body_f_s[child] = f_b_s - f_g_s
-    body_I_s[child] = I_s
-
-
-# Inverse dynamics via Recursive Newton-Euler algorithm (Featherstone Table 5.1)
-@wp.kernel
-def eval_rigid_id(
-    articulation_start: wp.array(dtype=int),
-    joint_type: wp.array(dtype=int),
-    joint_parent: wp.array(dtype=int),
-    joint_child: wp.array(dtype=int),
-    joint_q_start: wp.array(dtype=int),
-    joint_qd_start: wp.array(dtype=int),
-    joint_q: wp.array(dtype=float),
-    joint_qd: wp.array(dtype=float),
-    joint_axis: wp.array(dtype=wp.vec3),
-    joint_axis_start: wp.array(dtype=int),
-    joint_axis_dim: wp.array(dtype=int, ndim=2),
-    body_I_m: wp.array(dtype=wp.spatial_matrix),
-    body_q: wp.array(dtype=wp.transform),
-    body_q_com: wp.array(dtype=wp.transform),
-    joint_X_p: wp.array(dtype=wp.transform),
-    joint_X_c: wp.array(dtype=wp.transform),
-    gravity: wp.vec3,
-    # outputs
-    joint_S_s: wp.array(dtype=wp.spatial_vector),
-    body_I_s: wp.array(dtype=wp.spatial_matrix),
-    body_v_s: wp.array(dtype=wp.spatial_vector),
-    body_f_s: wp.array(dtype=wp.spatial_vector),
-    body_a_s: wp.array(dtype=wp.spatial_vector),
-):
-    # one thread per-articulation
-    index = wp.tid()
-
-    start = articulation_start[index]
-    end = articulation_start[index + 1]
-
-    # compute link velocities and coriolis forces
-    for i in range(start, end):
-        compute_link_velocity(
-            i,
-            joint_type,
-            joint_parent,
-            joint_child,
-            joint_q_start,
-            joint_qd_start,
-            joint_q,
-            joint_qd,
-            joint_axis,
-            joint_axis_start,
-            joint_axis_dim,
-            body_I_m,
-            body_q,
-            body_q_com,
-            joint_X_p,
-            joint_X_c,
-            gravity,
-            joint_S_s,
-            body_I_s,
-            body_v_s,
-            body_f_s,
-            body_a_s,
-        )
-
-
-@wp.kernel
-def eval_rigid_tau(
-    articulation_start: wp.array(dtype=int),
-    joint_type: wp.array(dtype=int),
-    joint_parent: wp.array(dtype=int),
-    joint_child: wp.array(dtype=int),
-    joint_q_start: wp.array(dtype=int),
-    joint_qd_start: wp.array(dtype=int),
-    joint_axis_start: wp.array(dtype=int),
-    joint_axis_dim: wp.array(dtype=int, ndim=2),
-    joint_axis_mode: wp.array(dtype=int),
-    joint_q: wp.array(dtype=float),
-    joint_qd: wp.array(dtype=float),
-    joint_act: wp.array(dtype=float),
-    joint_target_ke: wp.array(dtype=float),
-    joint_target_kd: wp.array(dtype=float),
-    joint_limit_lower: wp.array(dtype=float),
-    joint_limit_upper: wp.array(dtype=float),
-    joint_limit_ke: wp.array(dtype=float),
-    joint_limit_kd: wp.array(dtype=float),
-    joint_S_s: wp.array(dtype=wp.spatial_vector),
-    body_fb_s: wp.array(dtype=wp.spatial_vector),
-    body_f_ext: wp.array(dtype=wp.spatial_vector),
-    # outputs
-    body_ft_s: wp.array(dtype=wp.spatial_vector),
-    tau: wp.array(dtype=float),
-):
-    # one thread per-articulation
-    index = wp.tid()
-
-    start = articulation_start[index]
-    end = articulation_start[index + 1]
-    count = end - start
-
-    # compute joint forces
-    for offset in range(count):
-        # for backwards traversal
-        i = end - offset - 1
-
-        type = joint_type[i]
-        parent = joint_parent[i]
-        child = joint_child[i]
-        dof_start = joint_qd_start[i]
-        coord_start = joint_q_start[i]
-        axis_start = joint_axis_start[i]
-        lin_axis_count = joint_axis_dim[i, 0]
-        ang_axis_count = joint_axis_dim[i, 1]
-
-        # total forces on body
-        f_b_s = body_fb_s[child]
-        f_t_s = body_ft_s[child]
-        f_ext = body_f_ext[child]
-        f_s = f_b_s + f_t_s + f_ext
-
-        # compute joint-space forces, writes out tau
-        jcalc_tau(
-            type,
-            joint_target_ke,
-            joint_target_kd,
-            joint_limit_ke,
-            joint_limit_kd,
-            joint_S_s,
-            joint_q,
-            joint_qd,
-            joint_act,
-            joint_axis_mode,
-            joint_limit_lower,
-            joint_limit_upper,
-            coord_start,
-            dof_start,
-            axis_start,
-            lin_axis_count,
-            ang_axis_count,
-            f_s,
-            tau,
-        )
-
-        # update parent forces, todo: check that this is valid for the backwards pass
-        if parent >= 0:
-            wp.atomic_add(body_ft_s, parent, f_s)
-
-
-# builds spatial Jacobian J which is an (joint_count*6)x(dof_count) matrix
-@wp.kernel
-def eval_rigid_jacobian(
-    articulation_start: wp.array(dtype=int),
-    articulation_J_start: wp.array(dtype=int),
-    joint_ancestor: wp.array(dtype=int),
-    joint_qd_start: wp.array(dtype=int),
-    joint_S_s: wp.array(dtype=wp.spatial_vector),
-    # outputs
-    J: wp.array(dtype=float),
-):
-    # one thread per-articulation
-    index = wp.tid()
-
-    joint_start = articulation_start[index]
-    joint_end = articulation_start[index + 1]
-    joint_count = joint_end - joint_start
-
-    J_offset = articulation_J_start[index]
-
-    articulation_dof_start = joint_qd_start[joint_start]
-    articulation_dof_end = joint_qd_start[joint_end]
-    articulation_dof_count = articulation_dof_end - articulation_dof_start
-
-    for i in range(joint_count):
-        row_start = i * 6
-
-        j = joint_start + i
-        while j != -1:
-            joint_dof_start = joint_qd_start[j]
-            joint_dof_end = joint_qd_start[j + 1]
-            joint_dof_count = joint_dof_end - joint_dof_start
-
-            # fill out each row of the Jacobian walking up the tree
-            for dof in range(joint_dof_count):
-                col = (joint_dof_start - articulation_dof_start) + dof
-                S = joint_S_s[joint_dof_start + dof]
-
-                for k in range(6):
-                    J[J_offset + dense_index(articulation_dof_count, row_start + k, col)] = S[k]
-
-            j = joint_ancestor[j]
-
-
-@wp.func
-def spatial_mass(
-    body_I_s: wp.array(dtype=wp.spatial_matrix),
-    joint_start: int,
-    joint_count: int,
-    M_start: int,
-    # outputs
-    M: wp.array(dtype=float),
-):
-    stride = joint_count * 6
-    for l in range(joint_count):
-        I = body_I_s[joint_start + l]
-        for i in range(6):
-            for j in range(6):
-                M[M_start + dense_index(stride, l * 6 + i, l * 6 + j)] = I[i, j]
-
-
-@wp.kernel
-def eval_rigid_mass(
-    articulation_start: wp.array(dtype=int),
-    articulation_M_start: wp.array(dtype=int),
-    body_I_s: wp.array(dtype=wp.spatial_matrix),
-    # outputs
-    M: wp.array(dtype=float),
-):
-    # one thread per-articulation
-    index = wp.tid()
-
-    joint_start = articulation_start[index]
-    joint_end = articulation_start[index + 1]
-    joint_count = joint_end - joint_start
-
-    M_offset = articulation_M_start[index]
-
-    spatial_mass(body_I_s, joint_start, joint_count, M_offset, M)
-
-
-@wp.func
-def dense_gemm(
-    m: int,
-    n: int,
-    p: int,
-    transpose_A: bool,
-    transpose_B: bool,
-    add_to_C: bool,
-    A_start: int,
-    B_start: int,
-    C_start: int,
-    A: wp.array(dtype=float),
-    B: wp.array(dtype=float),
-    # outputs
-    C: wp.array(dtype=float),
-):
-    # multiply a `m x p` matrix A by a `p x n` matrix B to produce a `m x n` matrix C
-    for i in range(m):
-        for j in range(n):
-            sum = float(0.0)
-            for k in range(p):
-                if transpose_A:
-                    a_i = k * m + i
-                else:
-                    a_i = i * p + k
-                if transpose_B:
-                    b_j = j * p + k
-                else:
-                    b_j = k * n + j
-                sum += A[A_start + a_i] * B[B_start + b_j]
-
-            if add_to_C:
-                C[C_start + i * n + j] += sum
-            else:
-                C[C_start + i * n + j] = sum
-
-
-# @wp.func_grad(dense_gemm)
-# def adj_dense_gemm(
-#     m: int,
-#     n: int,
-#     p: int,
-#     transpose_A: bool,
-#     transpose_B: bool,
-#     add_to_C: bool,
-#     A_start: int,
-#     B_start: int,
-#     C_start: int,
-#     A: wp.array(dtype=float),
-#     B: wp.array(dtype=float),
-#     # outputs
-#     C: wp.array(dtype=float),
-# ):
-#     add_to_C = True
-#     if transpose_A:
-#         dense_gemm(p, m, n, False, True, add_to_C, A_start, B_start, C_start, B, wp.adjoint[C], wp.adjoint[A])
-#         dense_gemm(p, n, m, False, False, add_to_C, A_start, B_start, C_start, A, wp.adjoint[C], wp.adjoint[B])
-#     else:
-#         dense_gemm(
-#             m, p, n, False, not transpose_B, add_to_C, A_start, B_start, C_start, wp.adjoint[C], B, wp.adjoint[A]
-#         )
-#         dense_gemm(p, n, m, True, False, add_to_C, A_start, B_start, C_start, A, wp.adjoint[C], wp.adjoint[B])
-
-
-def create_inertia_matrix_kernel(num_joints, num_dofs):
-    @wp.kernel
-    def eval_dense_gemm_tile(
-        J_arr: wp.array3d(dtype=float), M_arr: wp.array3d(dtype=float), H_arr: wp.array3d(dtype=float)
-    ):
-        articulation = wp.tid()
-
-        J = wp.tile_load(J_arr[articulation], shape=(wp.static(6 * num_joints), num_dofs))
-        P = wp.tile_zeros(shape=(wp.static(6 * num_joints), num_dofs), dtype=float)
-
-        # compute P = M*J where M is a 6x6 block diagonal mass matrix
-        for i in range(int(num_joints)):
-            # 6x6 block matrices are on the diagonal
-            M_body = wp.tile_load(M_arr[articulation], shape=(6, 6), offset=(i * 6, i * 6))
-
-            # load a 6xN row from the Jacobian
-            J_body = wp.tile_view(J, offset=(i * 6, 0), shape=(6, num_dofs))
-
-            # compute weighted row
-            P_body = wp.tile_matmul(M_body, J_body)
-
-            # assign to the P slice
-            wp.tile_assign(P, P_body, offset=(i * 6, 0))
-
-        # compute H = J^T*P
-        H = wp.tile_matmul(wp.tile_transpose(J), P)
-
-        wp.tile_store(H_arr[articulation], H)
-
-    return eval_dense_gemm_tile
-
-
-def create_batched_cholesky_kernel(num_dofs):
-    assert num_dofs == 18
-
-    @wp.kernel
-    def eval_tiled_dense_cholesky_batched(
-        A: wp.array3d(dtype=float), R: wp.array2d(dtype=float), L: wp.array3d(dtype=float)
-    ):
-        articulation = wp.tid()
-
-        a = wp.tile_load(A[articulation], shape=(num_dofs, num_dofs), storage="shared")
-        r = wp.tile_load(R[articulation], shape=num_dofs, storage="shared")
-        a_r = wp.tile_diag_add(a, r)
-        l = wp.tile_cholesky(a_r)
-        wp.tile_store(L[articulation], wp.tile_transpose(l))
-
-    return eval_tiled_dense_cholesky_batched
-
-
-def create_inertia_matrix_cholesky_kernel(num_joints, num_dofs):
-    @wp.kernel
-    def eval_dense_gemm_and_cholesky_tile(
-        J_arr: wp.array3d(dtype=float),
-        M_arr: wp.array3d(dtype=float),
-        R_arr: wp.array2d(dtype=float),
-        H_arr: wp.array3d(dtype=float),
-        L_arr: wp.array3d(dtype=float),
-    ):
-        articulation = wp.tid()
-
-        J = wp.tile_load(J_arr[articulation], shape=(wp.static(6 * num_joints), num_dofs))
-        P = wp.tile_zeros(shape=(wp.static(6 * num_joints), num_dofs), dtype=float)
-
-        # compute P = M*J where M is a 6x6 block diagonal mass matrix
-        for i in range(int(num_joints)):
-            # 6x6 block matrices are on the diagonal
-            M_body = wp.tile_load(M_arr[articulation], shape=(6, 6), offset=(i * 6, i * 6))
-
-            # load a 6xN row from the Jacobian
-            J_body = wp.tile_view(J, offset=(i * 6, 0), shape=(6, num_dofs))
-
-            # compute weighted row
-            P_body = wp.tile_matmul(M_body, J_body)
-
-            # assign to the P slice
-            wp.tile_assign(P, P_body, offset=(i * 6, 0))
-
-        # compute H = J^T*P
-        H = wp.tile_matmul(wp.tile_transpose(J), P)
-        wp.tile_store(H_arr[articulation], H)
-
-        # cholesky L L^T = (H + diag(R))
-        R = wp.tile_load(R_arr[articulation], shape=num_dofs, storage="shared")
-        H_R = wp.tile_diag_add(H, R)
-        L = wp.tile_cholesky(H_R)
-        wp.tile_store(L_arr[articulation], L)
-
-    return eval_dense_gemm_and_cholesky_tile
-
-
-@wp.kernel
-def eval_dense_gemm_batched(
-    m: wp.array(dtype=int),
-    n: wp.array(dtype=int),
-    p: wp.array(dtype=int),
-    transpose_A: bool,
-    transpose_B: bool,
-    A_start: wp.array(dtype=int),
-    B_start: wp.array(dtype=int),
-    C_start: wp.array(dtype=int),
-    A: wp.array(dtype=float),
-    B: wp.array(dtype=float),
-    C: wp.array(dtype=float),
-):
-    # on the CPU each thread computes the whole matrix multiply
-    # on the GPU each block computes the multiply with one output per-thread
-    batch = wp.tid()  # /kNumThreadsPerBlock;
-    add_to_C = False
-
-    dense_gemm(
-        m[batch],
-        n[batch],
-        p[batch],
-        transpose_A,
-        transpose_B,
-        add_to_C,
-        A_start[batch],
-        B_start[batch],
-        C_start[batch],
-        A,
-        B,
-        C,
-    )
-
-
-@wp.func
-def dense_cholesky(
-    n: int,
-    A: wp.array(dtype=float),
-    R: wp.array(dtype=float),
-    A_start: int,
-    R_start: int,
-    # outputs
-    L: wp.array(dtype=float),
-):
-    # compute the Cholesky factorization of A = L L^T with diagonal regularization R
-    for j in range(n):
-        s = A[A_start + dense_index(n, j, j)] + R[R_start + j]
-
-        for k in range(j):
-            r = L[A_start + dense_index(n, j, k)]
-            s -= r * r
-
-        s = wp.sqrt(s)
-        invS = 1.0 / s
-
-        L[A_start + dense_index(n, j, j)] = s
-
-        for i in range(j + 1, n):
-            s = A[A_start + dense_index(n, i, j)]
-
-            for k in range(j):
-                s -= L[A_start + dense_index(n, i, k)] * L[A_start + dense_index(n, j, k)]
-
-            L[A_start + dense_index(n, i, j)] = s * invS
-
-
-@wp.func_grad(dense_cholesky)
-def adj_dense_cholesky(
-    n: int,
-    A: wp.array(dtype=float),
-    R: wp.array(dtype=float),
-    A_start: int,
-    R_start: int,
-    # outputs
-    L: wp.array(dtype=float),
-):
-    # nop, use dense_solve to differentiate through (A^-1)b = x
-    pass
-
-
-@wp.kernel
-def eval_dense_cholesky_batched(
-    A_starts: wp.array(dtype=int),
-    A_dim: wp.array(dtype=int),
-    A: wp.array(dtype=float),
-    R: wp.array(dtype=float),
-    L: wp.array(dtype=float),
-):
-    batch = wp.tid()
-
-    n = A_dim[batch]
-    A_start = A_starts[batch]
-    R_start = n * batch
-
-    dense_cholesky(n, A, R, A_start, R_start, L)
-
-
-@wp.func
-def dense_subs(
-    n: int,
-    L_start: int,
-    b_start: int,
-    L: wp.array(dtype=float),
-    b: wp.array(dtype=float),
-    # outputs
-    x: wp.array(dtype=float),
-):
-    # Solves (L L^T) x = b for x given the Cholesky factor L
-    # forward substitution solves the lower triangular system L y = b for y
-    for i in range(n):
-        s = b[b_start + i]
-
-        for j in range(i):
-            s -= L[L_start + dense_index(n, i, j)] * x[b_start + j]
-
-        x[b_start + i] = s / L[L_start + dense_index(n, i, i)]
-
-    # backward substitution solves the upper triangular system L^T x = y for x
-    for i in range(n - 1, -1, -1):
-        s = x[b_start + i]
-
-        for j in range(i + 1, n):
-            s -= L[L_start + dense_index(n, j, i)] * x[b_start + j]
-
-        x[b_start + i] = s / L[L_start + dense_index(n, i, i)]
-
-
-@wp.func
-def dense_solve(
-    n: int,
-    L_start: int,
-    b_start: int,
-    A: wp.array(dtype=float),
-    L: wp.array(dtype=float),
-    b: wp.array(dtype=float),
-    # outputs
-    x: wp.array(dtype=float),
-    tmp: wp.array(dtype=float),
-):
-    # helper function to include tmp argument for backward pass
-    dense_subs(n, L_start, b_start, L, b, x)
-
-
-@wp.func_grad(dense_solve)
-def adj_dense_solve(
-    n: int,
-    L_start: int,
-    b_start: int,
-    A: wp.array(dtype=float),
-    L: wp.array(dtype=float),
-    b: wp.array(dtype=float),
-    # outputs
-    x: wp.array(dtype=float),
-    tmp: wp.array(dtype=float),
-):
-    if not tmp or not wp.adjoint[x] or not wp.adjoint[A] or not wp.adjoint[L]:
-        return
-    for i in range(n):
-        tmp[b_start + i] = 0.0
-
-    dense_subs(n, L_start, b_start, L, wp.adjoint[x], tmp)
-
-    for i in range(n):
-        wp.adjoint[b][b_start + i] += tmp[b_start + i]
-
-    # A* = -adj_b*x^T
-    for i in range(n):
-        for j in range(n):
-            wp.adjoint[L][L_start + dense_index(n, i, j)] += -tmp[b_start + i] * x[b_start + j]
-
-    for i in range(n):
-        for j in range(n):
-            wp.adjoint[A][L_start + dense_index(n, i, j)] += -tmp[b_start + i] * x[b_start + j]
-
-
-@wp.kernel
-def eval_dense_solve_batched(
-    L_start: wp.array(dtype=int),
-    L_dim: wp.array(dtype=int),
-    b_start: wp.array(dtype=int),
-    A: wp.array(dtype=float),
-    L: wp.array(dtype=float),
-    b: wp.array(dtype=float),
-    # outputs
-    x: wp.array(dtype=float),
-    tmp: wp.array(dtype=float),
-):
-    batch = wp.tid()
-
-    dense_solve(L_dim[batch], L_start[batch], b_start[batch], A, L, b, x, tmp)
-
-
-@wp.kernel
-def integrate_generalized_joints(
-    joint_type: wp.array(dtype=int),
-    joint_q_start: wp.array(dtype=int),
-    joint_qd_start: wp.array(dtype=int),
-    joint_axis_dim: wp.array(dtype=int, ndim=2),
-    joint_q: wp.array(dtype=float),
-    joint_qd: wp.array(dtype=float),
-    joint_qdd: wp.array(dtype=float),
-    dt: float,
-    # outputs
-    joint_q_new: wp.array(dtype=float),
-    joint_qd_new: wp.array(dtype=float),
-):
-    # one thread per-articulation
-    index = wp.tid()
-
-    type = joint_type[index]
-    coord_start = joint_q_start[index]
-    dof_start = joint_qd_start[index]
-    lin_axis_count = joint_axis_dim[index, 0]
-    ang_axis_count = joint_axis_dim[index, 1]
-
-    jcalc_integrate(
-        type,
-        joint_q,
-        joint_qd,
-        joint_qdd,
-        coord_start,
-        dof_start,
-        lin_axis_count,
-        ang_axis_count,
-        dt,
-        joint_q_new,
-        joint_qd_new,
-    )
-
-
-class FeatherstoneIntegrator(Integrator):
-    """A semi-implicit integrator using symplectic Euler that operates
-    on reduced (also called generalized) coordinates to simulate articulated rigid body dynamics
-    based on Featherstone's composite rigid body algorithm (CRBA).
-
-    See: Featherstone, Roy. Rigid Body Dynamics Algorithms. Springer US, 2014.
-
-    Instead of maximal coordinates :attr:`State.body_q` (rigid body positions) and :attr:`State.body_qd`
-    (rigid body velocities) as is the case :class:`SemiImplicitIntegrator`, :class:`FeatherstoneIntegrator`
-    uses :attr:`State.joint_q` and :attr:`State.joint_qd` to represent the positions and velocities of
-    joints without allowing any redundant degrees of freedom.
-
-    After constructing :class:`Model` and :class:`State` objects this time-integrator
-    may be used to advance the simulation state forward in time.
-
-    Note:
-        Unlike :class:`SemiImplicitIntegrator` and :class:`XPBDIntegrator`, :class:`FeatherstoneIntegrator` does not simulate rigid bodies with nonzero mass as floating bodies if they are not connected through any joints. Floating-base systems require an explicit free joint with which the body is connected to the world, see :meth:`ModelBuilder.add_joint_free`.
-
-    Semi-implicit time integration is a variational integrator that
-    preserves energy, however it not unconditionally stable, and requires a time-step
-    small enough to support the required stiffness and damping forces.
-
-    See: https://en.wikipedia.org/wiki/Semi-implicit_Euler_method
-
-    Example
-    -------
-
-    .. code-block:: python
-
-        integrator = wp.FeatherstoneIntegrator(model)
-
-        # simulation loop
-        for i in range(100):
-            state = integrator.simulate(model, state_in, state_out, dt)
-
-    Note:
-        The :class:`FeatherstoneIntegrator` requires the :class:`Model` to be passed in as a constructor argument.
-
-    """
-
-    def __init__(
-        self,
-        model,
-        angular_damping=0.05,
-        update_mass_matrix_every=1,
-        friction_smoothing=1.0,
-        use_tile_gemm=False,
-        fuse_cholesky=True,
-    ):
-        """
-        Args:
-            model (Model): the model to be simulated.
-            angular_damping (float, optional): Angular damping factor. Defaults to 0.05.
-            update_mass_matrix_every (int, optional): How often to update the mass matrix (every n-th time the :meth:`simulate` function gets called). Defaults to 1.
-            friction_smoothing (float, optional): The delta value for the Huber norm (see :func:`warp.math.norm_huber`) used for the friction velocity normalization. Defaults to 1.0.
-        """
-        self.angular_damping = angular_damping
-        self.update_mass_matrix_every = update_mass_matrix_every
-        self.friction_smoothing = friction_smoothing
-        self.use_tile_gemm = use_tile_gemm
-        self.fuse_cholesky = fuse_cholesky
-
-        self._step = 0
-
-        self.compute_articulation_indices(model)
-        self.allocate_model_aux_vars(model)
-
-        if self.use_tile_gemm:
-            # create a custom kernel to evaluate the system matrix for this type
-            if self.fuse_cholesky:
-                self.eval_inertia_matrix_cholesky_kernel = create_inertia_matrix_cholesky_kernel(
-                    int(self.joint_count), int(self.dof_count)
-                )
-            else:
-                self.eval_inertia_matrix_kernel = create_inertia_matrix_kernel(
-                    int(self.joint_count), int(self.dof_count)
-                )
-
-            # ensure matrix is reloaded since otherwise an unload can happen during graph capture
-            # todo: should not be necessary?
-            wp.load_module(device=wp.get_device())
-
-    def compute_articulation_indices(self, model):
-        # calculate total size and offsets of Jacobian and mass matrices for entire system
-        if model.joint_count:
-            self.J_size = 0
-            self.M_size = 0
-            self.H_size = 0
-
-            articulation_J_start = []
-            articulation_M_start = []
-            articulation_H_start = []
-
-            articulation_M_rows = []
-            articulation_H_rows = []
-            articulation_J_rows = []
-            articulation_J_cols = []
-
-            articulation_dof_start = []
-            articulation_coord_start = []
-
-            articulation_start = model.articulation_start.numpy()
-            joint_q_start = model.joint_q_start.numpy()
-            joint_qd_start = model.joint_qd_start.numpy()
-
-            for i in range(model.articulation_count):
-                first_joint = articulation_start[i]
-                last_joint = articulation_start[i + 1]
-
-                first_coord = joint_q_start[first_joint]
-
-                first_dof = joint_qd_start[first_joint]
-                last_dof = joint_qd_start[last_joint]
-
-                joint_count = last_joint - first_joint
-                dof_count = last_dof - first_dof
-
-                articulation_J_start.append(self.J_size)
-                articulation_M_start.append(self.M_size)
-                articulation_H_start.append(self.H_size)
-                articulation_dof_start.append(first_dof)
-                articulation_coord_start.append(first_coord)
-
-                # bit of data duplication here, but will leave it as such for clarity
-                articulation_M_rows.append(joint_count * 6)
-                articulation_H_rows.append(dof_count)
-                articulation_J_rows.append(joint_count * 6)
-                articulation_J_cols.append(dof_count)
-
-                if self.use_tile_gemm:
-                    # store the joint and dof count assuming all
-                    # articulations have the same structure
-                    self.joint_count = joint_count
-                    self.dof_count = dof_count
-
-                self.J_size += 6 * joint_count * dof_count
-                self.M_size += 6 * joint_count * 6 * joint_count
-                self.H_size += dof_count * dof_count
-
-            # matrix offsets for batched gemm
-            self.articulation_J_start = wp.array(articulation_J_start, dtype=wp.int32, device=model.device)
-            self.articulation_M_start = wp.array(articulation_M_start, dtype=wp.int32, device=model.device)
-            self.articulation_H_start = wp.array(articulation_H_start, dtype=wp.int32, device=model.device)
-
-            self.articulation_M_rows = wp.array(articulation_M_rows, dtype=wp.int32, device=model.device)
-            self.articulation_H_rows = wp.array(articulation_H_rows, dtype=wp.int32, device=model.device)
-            self.articulation_J_rows = wp.array(articulation_J_rows, dtype=wp.int32, device=model.device)
-            self.articulation_J_cols = wp.array(articulation_J_cols, dtype=wp.int32, device=model.device)
-
-            self.articulation_dof_start = wp.array(articulation_dof_start, dtype=wp.int32, device=model.device)
-            self.articulation_coord_start = wp.array(articulation_coord_start, dtype=wp.int32, device=model.device)
-
-    def allocate_model_aux_vars(self, model):
-        # allocate mass, Jacobian matrices, and other auxiliary variables pertaining to the model
-        if model.joint_count:
-            # system matrices
-            self.M = wp.zeros((self.M_size,), dtype=wp.float32, device=model.device, requires_grad=model.requires_grad)
-            self.J = wp.zeros((self.J_size,), dtype=wp.float32, device=model.device, requires_grad=model.requires_grad)
-            self.P = wp.empty_like(self.J, requires_grad=model.requires_grad)
-            self.H = wp.empty((self.H_size,), dtype=wp.float32, device=model.device, requires_grad=model.requires_grad)
-
-            # zero since only upper triangle is set which can trigger NaN detection
-            self.L = wp.zeros_like(self.H)
-
-        if model.body_count:
-            self.body_I_m = wp.empty(
-                (model.body_count,), dtype=wp.spatial_matrix, device=model.device, requires_grad=model.requires_grad
-            )
-            wp.launch(
-                compute_spatial_inertia,
-                model.body_count,
-                inputs=[model.body_inertia, model.body_mass],
-                outputs=[self.body_I_m],
-                device=model.device,
-            )
-            self.body_X_com = wp.empty(
-                (model.body_count,), dtype=wp.transform, device=model.device, requires_grad=model.requires_grad
-            )
-            wp.launch(
-                compute_com_transforms,
-                model.body_count,
-                inputs=[model.body_com],
-                outputs=[self.body_X_com],
-                device=model.device,
-            )
-
-    def allocate_state_aux_vars(self, model, target, requires_grad):
-        # allocate auxiliary variables that vary with state
-        if model.body_count:
-            # joints
-            target.joint_qdd = wp.zeros_like(model.joint_qd, requires_grad=requires_grad)
-            target.joint_tau = wp.empty_like(model.joint_qd, requires_grad=requires_grad)
-            if requires_grad:
-                # used in the custom grad implementation of eval_dense_solve_batched
-                target.joint_solve_tmp = wp.zeros_like(model.joint_qd, requires_grad=True)
-            else:
-                target.joint_solve_tmp = None
-            target.joint_S_s = wp.empty(
-                (model.joint_dof_count,),
-                dtype=wp.spatial_vector,
-                device=model.device,
-                requires_grad=requires_grad,
-            )
-
-            # derived rigid body data (maximal coordinates)
-            target.body_q_com = wp.empty_like(model.body_q, requires_grad=requires_grad)
-            target.body_I_s = wp.empty(
-                (model.body_count,), dtype=wp.spatial_matrix, device=model.device, requires_grad=requires_grad
-            )
-            target.body_v_s = wp.empty(
-                (model.body_count,), dtype=wp.spatial_vector, device=model.device, requires_grad=requires_grad
-            )
-            target.body_a_s = wp.empty(
-                (model.body_count,), dtype=wp.spatial_vector, device=model.device, requires_grad=requires_grad
-            )
-            target.body_f_s = wp.zeros(
-                (model.body_count,), dtype=wp.spatial_vector, device=model.device, requires_grad=requires_grad
-            )
-            target.body_ft_s = wp.zeros(
-                (model.body_count,), dtype=wp.spatial_vector, device=model.device, requires_grad=requires_grad
-            )
-
-            target._featherstone_augmented = True
-
-    def simulate(self, model: Model, state_in: State, state_out: State, dt: float, control: Control = None):
-        requires_grad = state_in.requires_grad
-
-        # optionally create dynamical auxiliary variables
-        if requires_grad:
-            state_aug = state_out
-        else:
-            state_aug = self
-
-        if not getattr(state_aug, "_featherstone_augmented", False):
-            self.allocate_state_aux_vars(model, state_aug, requires_grad)
-        if control is None:
-            control = model.control(clone_variables=False)
-
-        with wp.ScopedTimer("simulate", False):
-            particle_f = None
-            body_f = None
-
-            if state_in.particle_count:
-                particle_f = state_in.particle_f
-
-            if state_in.body_count:
-                body_f = state_in.body_f
-
-            # damped springs
-            eval_spring_forces(model, state_in, particle_f)
-
-            # triangle elastic and lift/drag forces
-            eval_triangle_forces(model, state_in, control, particle_f)
-
-            # triangle/triangle contacts
-            eval_triangle_contact_forces(model, state_in, particle_f)
-
-            # triangle bending
-            eval_bending_forces(model, state_in, particle_f)
-
-            # tetrahedral FEM
-            eval_tetrahedral_forces(model, state_in, control, particle_f)
-
-            # particle-particle interactions
-            eval_particle_forces(model, state_in, particle_f)
-
-            # particle ground contacts
-            eval_particle_ground_contact_forces(model, state_in, particle_f)
-
-            # particle shape contact
-            eval_particle_body_contact_forces(model, state_in, particle_f, body_f, body_f_in_world_frame=True)
-
-            # muscles
-            if False:
-                eval_muscle_forces(model, state_in, control, body_f)
-
-            # ----------------------------
-            # articulations
-
-            if model.joint_count:
-                # evaluate body transforms
-                wp.launch(
-                    eval_rigid_fk,
-                    dim=model.articulation_count,
-                    inputs=[
-                        model.articulation_start,
-                        model.joint_type,
-                        model.joint_parent,
-                        model.joint_child,
-                        model.joint_q_start,
-                        state_in.joint_q,
-                        model.joint_X_p,
-                        model.joint_X_c,
-                        self.body_X_com,
-                        model.joint_axis,
-                        model.joint_axis_start,
-                        model.joint_axis_dim,
-                    ],
-                    outputs=[state_in.body_q, state_aug.body_q_com],
-                    device=model.device,
-                )
-
-                # print("body_X_sc:")
-                # print(state_in.body_q.numpy())
-
-                # evaluate joint inertias, motion vectors, and forces
-                state_aug.body_f_s.zero_()
-                wp.launch(
-                    eval_rigid_id,
-                    dim=model.articulation_count,
-                    inputs=[
-                        model.articulation_start,
-                        model.joint_type,
-                        model.joint_parent,
-                        model.joint_child,
-                        model.joint_q_start,
-                        model.joint_qd_start,
-                        state_in.joint_q,
-                        state_in.joint_qd,
-                        model.joint_axis,
-                        model.joint_axis_start,
-                        model.joint_axis_dim,
-                        self.body_I_m,
-                        state_in.body_q,
-                        state_aug.body_q_com,
-                        model.joint_X_p,
-                        model.joint_X_c,
-                        model.gravity,
-                    ],
-                    outputs=[
-                        state_aug.joint_S_s,
-                        state_aug.body_I_s,
-                        state_aug.body_v_s,
-                        state_aug.body_f_s,
-                        state_aug.body_a_s,
-                    ],
-                    device=model.device,
-                )
-
-                if model.rigid_contact_max and (
-                    (model.ground and model.shape_ground_contact_pair_count) or model.shape_contact_pair_count
-                ):
-                    wp.launch(
-                        kernel=eval_rigid_contacts,
-                        dim=model.rigid_contact_max,
-                        inputs=[
-                            state_in.body_q,
-                            state_aug.body_v_s,
-                            model.body_com,
-                            model.shape_materials,
-                            model.shape_geo,
-                            model.shape_body,
-                            model.rigid_contact_count,
-                            model.rigid_contact_point0,
-                            model.rigid_contact_point1,
-                            model.rigid_contact_normal,
-                            model.rigid_contact_shape0,
-                            model.rigid_contact_shape1,
-                            True,
-                            self.friction_smoothing,
-                        ],
-                        outputs=[body_f],
-                        device=model.device,
-                    )
-
-                    # if model.rigid_contact_count.numpy()[0] > 0:
-                    #     print(body_f.numpy())
-
-                if model.articulation_count:
-                    # evaluate joint torques
-                    state_aug.body_ft_s.zero_()
-                    wp.launch(
-                        eval_rigid_tau,
-                        dim=model.articulation_count,
-                        inputs=[
-                            model.articulation_start,
-                            model.joint_type,
-                            model.joint_parent,
-                            model.joint_child,
-                            model.joint_q_start,
-                            model.joint_qd_start,
-                            model.joint_axis_start,
-                            model.joint_axis_dim,
-                            model.joint_axis_mode,
-                            state_in.joint_q,
-                            state_in.joint_qd,
-                            control.joint_act,
-                            model.joint_target_ke,
-                            model.joint_target_kd,
-                            model.joint_limit_lower,
-                            model.joint_limit_upper,
-                            model.joint_limit_ke,
-                            model.joint_limit_kd,
-                            state_aug.joint_S_s,
-                            state_aug.body_f_s,
-                            body_f,
-                        ],
-                        outputs=[
-                            state_aug.body_ft_s,
-                            state_aug.joint_tau,
-                        ],
-                        device=model.device,
-                    )
-
-                    # print("joint_tau:")
-                    # print(state_aug.joint_tau.numpy())
-                    # print("body_q:")
-                    # print(state_in.body_q.numpy())
-                    # print("body_qd:")
-                    # print(state_in.body_qd.numpy())
-
-                    if self._step % self.update_mass_matrix_every == 0:
-                        # build J
-                        wp.launch(
-                            eval_rigid_jacobian,
-                            dim=model.articulation_count,
-                            inputs=[
-                                model.articulation_start,
-                                self.articulation_J_start,
-                                model.joint_ancestor,
-                                model.joint_qd_start,
-                                state_aug.joint_S_s,
-                            ],
-                            outputs=[self.J],
-                            device=model.device,
-                        )
-
-                        # build M
-                        wp.launch(
-                            eval_rigid_mass,
-                            dim=model.articulation_count,
-                            inputs=[
-                                model.articulation_start,
-                                self.articulation_M_start,
-                                state_aug.body_I_s,
-                            ],
-                            outputs=[self.M],
-                            device=model.device,
-                        )
-
-                        if self.use_tile_gemm:
-                            # reshape arrays
-                            M_tiled = self.M.reshape((-1, 6 * self.joint_count, 6 * self.joint_count))
-                            J_tiled = self.J.reshape((-1, 6 * self.joint_count, self.dof_count))
-                            R_tiled = model.joint_armature.reshape((-1, self.dof_count))
-                            H_tiled = self.H.reshape((-1, self.dof_count, self.dof_count))
-                            L_tiled = self.L.reshape((-1, self.dof_count, self.dof_count))
-                            assert H_tiled.shape == (model.articulation_count, 18, 18)
-                            assert L_tiled.shape == (model.articulation_count, 18, 18)
-                            assert R_tiled.shape == (model.articulation_count, 18)
-
-                            if self.fuse_cholesky:
-                                wp.launch_tiled(
-                                    self.eval_inertia_matrix_cholesky_kernel,
-                                    dim=model.articulation_count,
-                                    inputs=[J_tiled, M_tiled, R_tiled],
-                                    outputs=[H_tiled, L_tiled],
-                                    device=model.device,
-                                    block_dim=64,
-                                )
-
-                            else:
-                                wp.launch_tiled(
-                                    self.eval_inertia_matrix_kernel,
-                                    dim=model.articulation_count,
-                                    inputs=[J_tiled, M_tiled],
-                                    outputs=[H_tiled],
-                                    device=model.device,
-                                    block_dim=256,
-                                )
-
-                                wp.launch(
-                                    eval_dense_cholesky_batched,
-                                    dim=model.articulation_count,
-                                    inputs=[
-                                        self.articulation_H_start,
-                                        self.articulation_H_rows,
-                                        self.H,
-                                        model.joint_armature,
-                                    ],
-                                    outputs=[self.L],
-                                    device=model.device,
-                                )
-
-                            # import numpy as np
-                            # J = J_tiled.numpy()
-                            # M = M_tiled.numpy()
-                            # R = R_tiled.numpy()
-                            # for i in range(model.articulation_count):
-                            #     r = R[i,:,0]
-                            #     H = J[i].T @ M[i] @ J[i]
-                            #     L = np.linalg.cholesky(H + np.diag(r))
-                            #     np.testing.assert_allclose(H, H_tiled.numpy()[i], rtol=1e-2, atol=1e-2)
-                            #     np.testing.assert_allclose(L, L_tiled.numpy()[i], rtol=1e-1, atol=1e-1)
-
-                        else:
-                            # form P = M*J
-                            wp.launch(
-                                eval_dense_gemm_batched,
-                                dim=model.articulation_count,
-                                inputs=[
-                                    self.articulation_M_rows,
-                                    self.articulation_J_cols,
-                                    self.articulation_J_rows,
-                                    False,
-                                    False,
-                                    self.articulation_M_start,
-                                    self.articulation_J_start,
-                                    # P start is the same as J start since it has the same dims as J
-                                    self.articulation_J_start,
-                                    self.M,
-                                    self.J,
-                                ],
-                                outputs=[self.P],
-                                device=model.device,
-                            )
-
-                            # form H = J^T*P
-                            wp.launch(
-                                eval_dense_gemm_batched,
-                                dim=model.articulation_count,
-                                inputs=[
-                                    self.articulation_J_cols,
-                                    self.articulation_J_cols,
-                                    # P rows is the same as J rows
-                                    self.articulation_J_rows,
-                                    True,
-                                    False,
-                                    self.articulation_J_start,
-                                    # P start is the same as J start since it has the same dims as J
-                                    self.articulation_J_start,
-                                    self.articulation_H_start,
-                                    self.J,
-                                    self.P,
-                                ],
-                                outputs=[self.H],
-                                device=model.device,
-                            )
-
-                            # compute decomposition
-                            wp.launch(
-                                eval_dense_cholesky_batched,
-                                dim=model.articulation_count,
-                                inputs=[
-                                    self.articulation_H_start,
-                                    self.articulation_H_rows,
-                                    self.H,
-                                    model.joint_armature,
-                                ],
-                                outputs=[self.L],
-                                device=model.device,
-                            )
-
-                        # print("joint_act:")
-                        # print(control.joint_act.numpy())
-                        # print("joint_tau:")
-                        # print(state_aug.joint_tau.numpy())
-                        # print("H:")
-                        # print(self.H.numpy())
-                        # print("L:")
-                        # print(self.L.numpy())
-
-                    # solve for qdd
-                    state_aug.joint_qdd.zero_()
-                    wp.launch(
-                        eval_dense_solve_batched,
-                        dim=model.articulation_count,
-                        inputs=[
-                            self.articulation_H_start,
-                            self.articulation_H_rows,
-                            self.articulation_dof_start,
-                            self.H,
-                            self.L,
-                            state_aug.joint_tau,
-                        ],
-                        outputs=[
-                            state_aug.joint_qdd,
-                            state_aug.joint_solve_tmp,
-                        ],
-                        device=model.device,
-                    )
-                    # print("joint_qdd:")
-                    # print(state_aug.joint_qdd.numpy())
-                    # print("\n\n")
-
-            # -------------------------------------
-            # integrate bodies
-
-            if model.joint_count:
-                wp.launch(
-                    kernel=integrate_generalized_joints,
-                    dim=model.joint_count,
-                    inputs=[
-                        model.joint_type,
-                        model.joint_q_start,
-                        model.joint_qd_start,
-                        model.joint_axis_dim,
-                        state_in.joint_q,
-                        state_in.joint_qd,
-                        state_aug.joint_qdd,
-                        dt,
-                    ],
-                    outputs=[state_out.joint_q, state_out.joint_qd],
-                    device=model.device,
-                )
-
-                # update maximal coordinates
-                eval_fk(model, state_out.joint_q, state_out.joint_qd, None, state_out)
-
-            self.integrate_particles(model, state_in, state_out, dt)
-
-            self._step += 1
-
-            return state_out
diff --git a/warp/sim/integrator_vbd.py b/warp/sim/integrator_vbd.py
deleted file mode 100644
index e5a4a5a1..00000000
--- a/warp/sim/integrator_vbd.py
+++ /dev/null
@@ -1,2487 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2024 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-import numpy as np
-
-import warp as wp
-
-from ..types import float32, matrix
-from .collide import (
-    TriMeshCollisionDetector,
-    TriMeshCollisionInfo,
-    triangle_closest_point,
-)
-from .integrator import Integrator
-from .model import PARTICLE_FLAG_ACTIVE, Control, Model, ModelShapeMaterials, State
-
-VBD_DEBUG_PRINTING_OPTIONS = {
-    # "elasticity_force_hessian",
-    # "contact_force_hessian",
-    # "contact_force_hessian_vt",
-    # "contact_force_hessian_ee",
-    # "overall_force_hessian",
-    # "inertia_force_hessian",
-    # "connectivity",
-    # "contact_info",
-}
-
-
-class mat66(matrix(shape=(6, 6), dtype=float32)):
-    pass
-
-
-class mat32(matrix(shape=(3, 2), dtype=float32)):
-    pass
-
-
-class mat43(matrix(shape=(4, 3), dtype=float32)):
-    pass
-
-
-@wp.struct
-class ForceElementAdjacencyInfo:
-    r"""
-    - vertex_adjacent_[element]: the flatten adjacency information. Its size is \sum_{i\inV} 2*N_i, where N_i is the
-    number of vertex i's adjacent [element]. For each adjacent element it stores 2 information:
-        - the id of the adjacent element
-        - the order of the vertex in the element, which is essential to compute the force and hessian for the vertex
-    - vertex_adjacent_[element]_offsets: stores where each vertex information starts in the  flatten adjacency array.
-    Its size is |V|+1 such that the number of vertex i's adjacent [element] can be computed as
-    vertex_adjacent_[element]_offsets[i+1]-vertex_adjacent_[element]_offsets[i].
-    """
-
-    v_adj_faces: wp.array(dtype=int)
-    v_adj_faces_offsets: wp.array(dtype=int)
-
-    v_adj_edges: wp.array(dtype=int)
-    v_adj_edges_offsets: wp.array(dtype=int)
-
-    def to(self, device):
-        if device.is_cpu:
-            return self
-        else:
-            adjacency_gpu = ForceElementAdjacencyInfo()
-            adjacency_gpu.v_adj_faces = self.v_adj_faces.to(device)
-            adjacency_gpu.v_adj_faces_offsets = self.v_adj_faces_offsets.to(device)
-
-            adjacency_gpu.v_adj_edges = self.v_adj_edges.to(device)
-            adjacency_gpu.v_adj_edges_offsets = self.v_adj_edges_offsets.to(device)
-
-            return adjacency_gpu
-
-
-@wp.func
-def get_vertex_num_adjacent_edges(adjacency: ForceElementAdjacencyInfo, vertex: wp.int32):
-    return (adjacency.v_adj_edges_offsets[vertex + 1] - adjacency.v_adj_edges_offsets[vertex]) >> 1
-
-
-@wp.func
-def get_vertex_adjacent_edge_id_order(adjacency: ForceElementAdjacencyInfo, vertex: wp.int32, edge: wp.int32):
-    offset = adjacency.v_adj_edges_offsets[vertex]
-    return adjacency.v_adj_edges[offset + edge * 2], adjacency.v_adj_edges[offset + edge * 2 + 1]
-
-
-@wp.func
-def get_vertex_num_adjacent_faces(adjacency: ForceElementAdjacencyInfo, vertex: wp.int32):
-    return (adjacency.v_adj_faces_offsets[vertex + 1] - adjacency.v_adj_faces_offsets[vertex]) >> 1
-
-
-@wp.func
-def get_vertex_adjacent_face_id_order(adjacency: ForceElementAdjacencyInfo, vertex: wp.int32, face: wp.int32):
-    offset = adjacency.v_adj_faces_offsets[vertex]
-    return adjacency.v_adj_faces[offset + face * 2], adjacency.v_adj_faces[offset + face * 2 + 1]
-
-
-@wp.kernel
-def _test_compute_force_element_adjacency(
-    adjacency: ForceElementAdjacencyInfo,
-    edge_indices: wp.array(dtype=wp.int32, ndim=2),
-    face_indices: wp.array(dtype=wp.int32, ndim=2),
-):
-    wp.printf("num vertices: %d\n", adjacency.v_adj_edges_offsets.shape[0] - 1)
-    for vertex in range(adjacency.v_adj_edges_offsets.shape[0] - 1):
-        num_adj_edges = get_vertex_num_adjacent_edges(adjacency, vertex)
-        for i_bd in range(num_adj_edges):
-            bd_id, v_order = get_vertex_adjacent_edge_id_order(adjacency, vertex, i_bd)
-
-            if edge_indices[bd_id, v_order] != vertex:
-                print("Error!!!")
-                wp.printf("vertex: %d | num_adj_edges: %d\n", vertex, num_adj_edges)
-                wp.printf("--iBd: %d | ", i_bd)
-                wp.printf("edge id: %d | v_order: %d\n", bd_id, v_order)
-
-        num_adj_faces = get_vertex_num_adjacent_faces(adjacency, vertex)
-
-        for i_face in range(num_adj_faces):
-            face, v_order = get_vertex_adjacent_face_id_order(
-                adjacency,
-                vertex,
-                i_face,
-            )
-
-            if face_indices[face, v_order] != vertex:
-                print("Error!!!")
-                wp.printf("vertex: %d | num_adj_faces: %d\n", vertex, num_adj_faces)
-                wp.printf("--i_face: %d | face id: %d | v_order: %d\n", i_face, face, v_order)
-                wp.printf(
-                    "--face: %d %d %d\n",
-                    face_indices[face, 0],
-                    face_indices[face, 1],
-                    face_indices[face, 2],
-                )
-
-
-@wp.func
-def build_orthonormal_basis(n: wp.vec3):
-    """
-    Builds an orthonormal basis given a normal vector `n`. Return the two axes that is perpendicular to `n`.
-
-    :param n: A 3D vector (list or array-like) representing the normal vector
-    """
-    b1 = wp.vec3()
-    b2 = wp.vec3()
-    if n[2] < 0.0:
-        a = 1.0 / (1.0 - n[2])
-        b = n[0] * n[1] * a
-        b1[0] = 1.0 - n[0] * n[0] * a
-        b1[1] = -b
-        b1[2] = n[0]
-
-        b2[0] = b
-        b2[1] = n[1] * n[1] * a - 1.0
-        b2[2] = -n[1]
-    else:
-        a = 1.0 / (1.0 + n[2])
-        b = -n[0] * n[1] * a
-        b1[0] = 1.0 - n[0] * n[0] * a
-        b1[1] = b
-        b1[2] = -n[0]
-
-        b2[0] = b
-        b2[1] = 1.0 - n[1] * n[1] * a
-        b2[2] = -n[1]
-
-    return b1, b2
-
-
-@wp.func
-def calculate_triangle_deformation_gradient(
-    face: int, tri_indices: wp.array(dtype=wp.int32, ndim=2), pos: wp.array(dtype=wp.vec3), tri_pose: wp.mat22
-):
-    F = mat32()
-    v1 = pos[tri_indices[face, 1]] - pos[tri_indices[face, 0]]
-    v2 = pos[tri_indices[face, 2]] - pos[tri_indices[face, 0]]
-
-    F[0, 0] = v1[0]
-    F[1, 0] = v1[1]
-    F[2, 0] = v1[2]
-    F[0, 1] = v2[0]
-    F[1, 1] = v2[1]
-    F[2, 1] = v2[2]
-
-    F = F * tri_pose
-    return F
-
-
-@wp.func
-def green_strain(F: mat32):
-    return 0.5 * (wp.transpose(F) * F - wp.identity(n=2, dtype=float))
-
-
-@wp.func
-def assemble_membrane_hessian(h: mat66, m1: float, m2: float):
-    h_vert = wp.mat33(
-        m1 * (h[0, 0] * m1 + h[3, 0] * m2) + m2 * (h[0, 3] * m1 + h[3, 3] * m2),
-        m1 * (h[0, 1] * m1 + h[3, 1] * m2) + m2 * (h[0, 4] * m1 + h[3, 4] * m2),
-        m1 * (h[0, 2] * m1 + h[3, 2] * m2) + m2 * (h[0, 5] * m1 + h[3, 5] * m2),
-        m1 * (h[1, 0] * m1 + h[4, 0] * m2) + m2 * (h[1, 3] * m1 + h[4, 3] * m2),
-        m1 * (h[1, 1] * m1 + h[4, 1] * m2) + m2 * (h[1, 4] * m1 + h[4, 4] * m2),
-        m1 * (h[1, 2] * m1 + h[4, 2] * m2) + m2 * (h[1, 5] * m1 + h[4, 5] * m2),
-        m1 * (h[2, 0] * m1 + h[5, 0] * m2) + m2 * (h[2, 3] * m1 + h[5, 3] * m2),
-        m1 * (h[2, 1] * m1 + h[5, 1] * m2) + m2 * (h[2, 4] * m1 + h[5, 4] * m2),
-        m1 * (h[2, 2] * m1 + h[5, 2] * m2) + m2 * (h[2, 5] * m1 + h[5, 5] * m2),
-    )
-
-    return h_vert
-
-
-@wp.func
-def evaluate_stvk_force_hessian(
-    face: int,
-    v_order: int,
-    pos: wp.array(dtype=wp.vec3),
-    tri_indices: wp.array(dtype=wp.int32, ndim=2),
-    tri_pose: wp.mat22,
-    area: float,
-    mu: float,
-    lmbd: float,
-    damping: float,
-):
-    D2W_DFDF = mat66()
-    F = calculate_triangle_deformation_gradient(face, tri_indices, pos, tri_pose)
-    G = green_strain(F)
-
-    S = 2.0 * mu * G + lmbd * (G[0, 0] + G[1, 1]) * wp.identity(n=2, dtype=float)
-
-    F12 = -area * F * S * wp.transpose(tri_pose)
-
-    Dm_inv1_1 = tri_pose[0, 0]
-    Dm_inv2_1 = tri_pose[1, 0]
-    Dm_inv1_2 = tri_pose[0, 1]
-    Dm_inv2_2 = tri_pose[1, 1]
-
-    F1_1 = F[0, 0]
-    F2_1 = F[1, 0]
-    F3_1 = F[2, 0]
-    F1_2 = F[0, 1]
-    F2_2 = F[1, 1]
-    F3_2 = F[2, 1]
-
-    F1_1_sqr = F1_1 * F1_1
-    F2_1_sqr = F2_1 * F2_1
-    F3_1_sqr = F3_1 * F3_1
-    F1_2_sqr = F1_2 * F1_2
-    F2_2_sqr = F2_2 * F2_2
-    F3_2_sqr = F3_2 * F3_2
-
-    e_uu = G[0, 0]
-    e_vv = G[1, 1]
-    e_uv = G[0, 1]
-    e_uuvvSum = e_uu + e_vv
-
-    D2W_DFDF[0, 0] = F1_1 * (F1_1 * lmbd + 2.0 * F1_1 * mu) + 2.0 * mu * e_uu + lmbd * (e_uuvvSum) + F1_2_sqr * mu
-
-    D2W_DFDF[1, 0] = F1_1 * (F2_1 * lmbd + 2.0 * F2_1 * mu) + F1_2 * F2_2 * mu
-    D2W_DFDF[0, 1] = D2W_DFDF[1, 0]
-
-    D2W_DFDF[2, 0] = F1_1 * (F3_1 * lmbd + 2.0 * F3_1 * mu) + F1_2 * F3_2 * mu
-    D2W_DFDF[0, 2] = D2W_DFDF[2, 0]
-
-    D2W_DFDF[3, 0] = 2.0 * mu * e_uv + F1_1 * F1_2 * lmbd + F1_1 * F1_2 * mu
-    D2W_DFDF[0, 3] = D2W_DFDF[3, 0]
-
-    D2W_DFDF[4, 0] = F1_1 * F2_2 * lmbd + F1_2 * F2_1 * mu
-    D2W_DFDF[0, 4] = D2W_DFDF[4, 0]
-
-    D2W_DFDF[5, 0] = F1_1 * F3_2 * lmbd + F1_2 * F3_1 * mu
-    D2W_DFDF[0, 5] = D2W_DFDF[5, 0]
-
-    D2W_DFDF[1, 1] = F2_1 * (F2_1 * lmbd + 2.0 * F2_1 * mu) + 2.0 * mu * e_uu + lmbd * (e_uuvvSum) + F2_2_sqr * mu
-
-    D2W_DFDF[2, 1] = F2_1 * (F3_1 * lmbd + 2.0 * F3_1 * mu) + F2_2 * F3_2 * mu
-    D2W_DFDF[1, 2] = D2W_DFDF[2, 1]
-
-    D2W_DFDF[3, 1] = F1_2 * F2_1 * lmbd + F1_1 * F2_2 * mu
-    D2W_DFDF[1, 3] = D2W_DFDF[3, 1]
-
-    D2W_DFDF[4, 1] = 2.0 * mu * e_uv + F2_1 * F2_2 * lmbd + F2_1 * F2_2 * mu
-    D2W_DFDF[1, 4] = D2W_DFDF[4, 1]
-
-    D2W_DFDF[5, 1] = F2_1 * F3_2 * lmbd + F2_2 * F3_1 * mu
-    D2W_DFDF[1, 5] = D2W_DFDF[5, 1]
-
-    D2W_DFDF[2, 2] = F3_1 * (F3_1 * lmbd + 2.0 * F3_1 * mu) + 2.0 * mu * e_uu + lmbd * (e_uuvvSum) + F3_2_sqr * mu
-
-    D2W_DFDF[3, 2] = F1_2 * F3_1 * lmbd + F1_1 * F3_2 * mu
-    D2W_DFDF[2, 3] = D2W_DFDF[3, 2]
-
-    D2W_DFDF[4, 2] = F2_2 * F3_1 * lmbd + F2_1 * F3_2 * mu
-    D2W_DFDF[2, 4] = D2W_DFDF[4, 2]
-
-    D2W_DFDF[5, 2] = 2.0 * mu * e_uv + F3_1 * F3_2 * lmbd + F3_1 * F3_2 * mu
-    D2W_DFDF[2, 5] = D2W_DFDF[5, 2]
-
-    D2W_DFDF[3, 3] = F1_2 * (F1_2 * lmbd + 2.0 * F1_2 * mu) + 2.0 * mu * e_vv + lmbd * (e_uuvvSum) + F1_1_sqr * mu
-
-    D2W_DFDF[4, 3] = F1_2 * (F2_2 * lmbd + 2.0 * F2_2 * mu) + F1_1 * F2_1 * mu
-    D2W_DFDF[3, 4] = D2W_DFDF[4, 3]
-
-    D2W_DFDF[5, 3] = F1_2 * (F3_2 * lmbd + 2.0 * F3_2 * mu) + F1_1 * F3_1 * mu
-    D2W_DFDF[3, 5] = D2W_DFDF[5, 3]
-
-    D2W_DFDF[4, 4] = F2_2 * (F2_2 * lmbd + 2.0 * F2_2 * mu) + 2.0 * mu * e_vv + lmbd * (e_uuvvSum) + F2_1_sqr * mu
-
-    D2W_DFDF[5, 4] = F2_2 * (F3_2 * lmbd + 2.0 * F3_2 * mu) + F2_1 * F3_1 * mu
-    D2W_DFDF[4, 5] = D2W_DFDF[5, 4]
-
-    D2W_DFDF[5, 5] = F3_2 * (F3_2 * lmbd + 2.0 * F3_2 * mu) + 2.0 * mu * e_vv + lmbd * (e_uuvvSum) + F3_1_sqr * mu
-
-    D2W_DFDF = D2W_DFDF * area
-
-    # m1s = wp.vec3(-Dm_inv1_1 - Dm_inv2_1, Dm_inv1_1, Dm_inv2_1)
-    # m2s = wp.vec3(-Dm_inv1_2 - Dm_inv2_2, Dm_inv1_2, Dm_inv2_2)
-    #
-    # m1 = m1s[v_order]
-    # m2 = m2s[v_order]
-
-    if v_order == 0:
-        m1 = -Dm_inv1_1 - Dm_inv2_1
-        m2 = -Dm_inv1_2 - Dm_inv2_2
-        f = wp.vec3(-F12[0, 0] - F12[0, 1], -F12[1, 0] - F12[1, 1], -F12[2, 0] - F12[2, 1])
-    elif v_order == 1:
-        m1 = Dm_inv1_1
-        m2 = Dm_inv1_2
-        f = wp.vec3(F12[0, 0], F12[1, 0], F12[2, 0])
-    else:
-        m1 = Dm_inv2_1
-        m2 = Dm_inv2_2
-        f = wp.vec3(F12[0, 1], F12[1, 1], F12[2, 1])
-
-    h = assemble_membrane_hessian(D2W_DFDF, m1, m2)
-
-    return f, h
-
-
-@wp.func
-def mat_vec_cross_from_3_basis(e1: wp.vec3, e2: wp.vec3, e3: wp.vec3, a: wp.vec3):
-    e1_cross_a = wp.cross(e1, a)
-    e2_cross_a = wp.cross(e2, a)
-    e3_cross_a = wp.cross(e3, a)
-
-    return wp.mat33(
-        e1_cross_a[0],
-        e2_cross_a[0],
-        e3_cross_a[0],
-        e1_cross_a[1],
-        e2_cross_a[1],
-        e3_cross_a[1],
-        e1_cross_a[2],
-        e2_cross_a[2],
-        e3_cross_a[2],
-    )
-
-
-@wp.func
-def mat_vec_cross(mat: wp.mat33, a: wp.vec3):
-    e1 = wp.vec3(mat[0, 0], mat[1, 0], mat[2, 0])
-    e2 = wp.vec3(mat[0, 1], mat[1, 1], mat[2, 1])
-    e3 = wp.vec3(mat[0, 2], mat[1, 2], mat[2, 2])
-
-    return mat_vec_cross_from_3_basis(e1, e2, e3, a)
-
-
-@wp.func
-def evaluate_dihedral_angle_based_bending_force_hessian(
-    bending_index: int,
-    v_order: int,
-    pos: wp.array(dtype=wp.vec3),
-    pos_prev: wp.array(dtype=wp.vec3),
-    edge_indices: wp.array(dtype=wp.int32, ndim=2),
-    edge_rest_angle: wp.array(dtype=float),
-    edge_rest_length: wp.array(dtype=float),
-    stiffness: float,
-    damping: float,
-    dt: float,
-):
-    if edge_indices[bending_index, 0] == -1 or edge_indices[bending_index, 1] == -1:
-        return wp.vec3(0.0), wp.mat33(0.0)
-
-    x1 = pos[edge_indices[bending_index, 0]]
-    x2 = pos[edge_indices[bending_index, 2]]
-    x3 = pos[edge_indices[bending_index, 3]]
-    x4 = pos[edge_indices[bending_index, 1]]
-
-    e1 = wp.vec3(1.0, 0.0, 0.0)
-    e2 = wp.vec3(0.0, 1.0, 0.0)
-    e3 = wp.vec3(0.0, 0.0, 1.0)
-
-    n1 = wp.cross((x2 - x1), (x3 - x1))
-    n2 = wp.cross((x3 - x4), (x2 - x4))
-    n1_norm = wp.length(n1)
-    n2_norm = wp.length(n2)
-
-    # degenerated bending edge
-    if n1_norm < 1.0e-6 or n2_norm < 1.0e-6:
-        return wp.vec3(0.0), wp.mat33(0.0)
-
-    n1_n = n1 / n1_norm
-    n2_n = n2 / n2_norm
-
-    # avoid the infinite gradient of acos at -1 or 1
-    cos_theta = wp.dot(n1_n, n2_n)
-    if wp.abs(cos_theta) > 0.9999:
-        cos_theta = 0.9999 * wp.sign(cos_theta)
-
-    angle_sign = wp.sign(wp.dot(wp.cross(n2, n1), x3 - x2))
-    theta = wp.acos(cos_theta) * angle_sign
-    rest_angle = edge_rest_angle[bending_index]
-
-    dE_dtheta = stiffness * (theta - rest_angle)
-
-    d_theta_d_cos_theta = angle_sign * (-1.0 / wp.sqrt(1.0 - cos_theta * cos_theta))
-    sin_theta = angle_sign * wp.sqrt(1.0 - cos_theta * cos_theta)
-    one_over_sin_theta = 1.0 / sin_theta
-    d_one_over_sin_theta_d_cos_theta = cos_theta / (sin_theta * sin_theta * sin_theta)
-
-    e_rest_len = edge_rest_length[bending_index]
-
-    if v_order == 0:
-        d_cos_theta_dx1 = 1.0 / n1_norm * (-wp.cross(x3 - x1, n2_n) + wp.cross(x2 - x1, n2_n))
-        d_one_over_sin_theta_dx1 = d_cos_theta_dx1 * d_one_over_sin_theta_d_cos_theta
-
-        d_theta_dx1 = d_theta_d_cos_theta * d_cos_theta_dx1
-        d2_theta_dx1_dx1 = -wp.outer(d_one_over_sin_theta_dx1, d_cos_theta_dx1)
-
-        dE_dx1 = e_rest_len * dE_dtheta * d_theta_d_cos_theta * d_cos_theta_dx1
-
-        d2_E_dx1_dx1 = (
-            e_rest_len * stiffness * (wp.outer(d_theta_dx1, d_theta_dx1) + (theta - rest_angle) * d2_theta_dx1_dx1)
-        )
-
-        bending_force = -dE_dx1
-        bending_hessian = d2_E_dx1_dx1
-    elif v_order == 1:
-        d_cos_theta_dx4 = 1.0 / n2_norm * (-wp.cross(x2 - x4, n1_n) + wp.cross(x3 - x4, n1_n))
-        d_one_over_sin_theta_dx4 = d_cos_theta_dx4 * d_one_over_sin_theta_d_cos_theta
-
-        d_theta_dx4 = d_theta_d_cos_theta * d_cos_theta_dx4
-        d2_theta_dx4_dx4 = -wp.outer(d_one_over_sin_theta_dx4, d_cos_theta_dx4)
-
-        dE_dx4 = e_rest_len * dE_dtheta * d_theta_d_cos_theta * d_cos_theta_dx4
-        d2_E_dx4_dx4 = (
-            e_rest_len * stiffness * (wp.outer(d_theta_dx4, d_theta_dx4) + (theta - rest_angle) * (d2_theta_dx4_dx4))
-        )
-
-        bending_force = -dE_dx4
-        bending_hessian = d2_E_dx4_dx4
-    elif v_order == 2:
-        d_cos_theta_dx2 = 1.0 / n1_norm * wp.cross(x3 - x1, n2_n) - 1.0 / n2_norm * wp.cross(x3 - x4, n1_n)
-        dn1_dx2 = mat_vec_cross_from_3_basis(e1, e2, e3, x3 - x1)
-        dn2_dx2 = -mat_vec_cross_from_3_basis(e1, e2, e3, x3 - x4)
-        d_one_over_sin_theta_dx2 = d_cos_theta_dx2 * d_one_over_sin_theta_d_cos_theta
-        d2_cos_theta_dx2_dx2 = -mat_vec_cross(dn2_dx2, (x3 - x1)) / (n1_norm * n2_norm) + mat_vec_cross(
-            dn1_dx2, x3 - x4
-        ) / (n1_norm * n2_norm)
-
-        d_theta_dx2 = d_theta_d_cos_theta * d_cos_theta_dx2
-        d2_theta_dx2_dx2 = (
-            -wp.outer(d_one_over_sin_theta_dx2, d_cos_theta_dx2) - one_over_sin_theta * d2_cos_theta_dx2_dx2
-        )
-
-        dE_dx2 = e_rest_len * dE_dtheta * d_theta_d_cos_theta * d_cos_theta_dx2
-        d2_E_dx2_dx2 = (
-            e_rest_len * stiffness * (wp.outer(d_theta_dx2, d_theta_dx2) + (theta - rest_angle) * d2_theta_dx2_dx2)
-        )
-
-        bending_force = -dE_dx2
-        bending_hessian = d2_E_dx2_dx2
-    else:
-        d_cos_theta_dx3 = -1.0 / n1_norm * wp.cross(x2 - x1, n2_n) + 1.0 / n2_norm * wp.cross(x2 - x4, n1_n)
-        dn1_dx3 = -mat_vec_cross_from_3_basis(e1, e2, e3, x2 - x1)
-        dn2_dx3 = mat_vec_cross_from_3_basis(e1, e2, e3, x2 - x4)
-        d_one_over_sin_theta_dx3 = d_cos_theta_dx3 * d_one_over_sin_theta_d_cos_theta
-        d2_cos_theta_dx3_dx3 = mat_vec_cross(dn2_dx3, (x2 - x1)) / (n1_norm * n2_norm) - mat_vec_cross(
-            dn1_dx3, x2 - x4
-        ) / (n1_norm * n2_norm)
-
-        d_theta_dx3 = d_theta_d_cos_theta * d_cos_theta_dx3
-        d2_theta_dx3_dx3 = (
-            -wp.outer(d_one_over_sin_theta_dx3, d_cos_theta_dx3) - one_over_sin_theta * d2_cos_theta_dx3_dx3
-        )
-
-        dE_dx3 = e_rest_len * dE_dtheta * d_theta_d_cos_theta * d_cos_theta_dx3
-
-        d2_E_dx3_dx3 = (
-            e_rest_len * stiffness * (wp.outer(d_theta_dx3, d_theta_dx3) + (theta - rest_angle) * d2_theta_dx3_dx3)
-        )
-
-        bending_force = -dE_dx3
-        bending_hessian = d2_E_dx3_dx3
-
-    displacement = pos_prev[edge_indices[bending_index, v_order]] - pos[edge_indices[bending_index, v_order]]
-    h_d = bending_hessian * (damping / dt)
-    f_d = h_d * displacement
-
-    bending_force = bending_force + f_d
-    bending_hessian = bending_hessian + h_d
-
-    return bending_force, bending_hessian
-
-
-@wp.func
-def evaluate_ground_contact_force_hessian(
-    particle_pos: wp.vec3,
-    particle_prev_pos: wp.vec3,
-    particle_radius: float,
-    ground_normal: wp.vec3,
-    ground_level: float,
-    soft_contact_ke: float,
-    soft_contact_kd: float,
-    friction_mu: float,
-    friction_epsilon: float,
-    dt: float,
-):
-    penetration_depth = -(wp.dot(ground_normal, particle_pos) + ground_level - particle_radius)
-
-    if penetration_depth > 0:
-        ground_contact_force_norm = penetration_depth * soft_contact_ke
-        ground_contact_force = ground_normal * ground_contact_force_norm
-        ground_contact_hessian = soft_contact_ke * wp.outer(ground_normal, ground_normal)
-
-        dx = particle_pos - particle_prev_pos
-
-        if wp.dot(dx, ground_normal) < 0:
-            damping_hessian = (soft_contact_kd / dt) * ground_contact_hessian
-            ground_contact_hessian = ground_contact_hessian + damping_hessian
-            ground_contact_force = ground_contact_force - damping_hessian * dx
-
-        # friction
-        e0, e1 = build_orthonormal_basis(ground_normal)
-
-        T = mat32(e0[0], e1[0], e0[1], e1[1], e0[2], e1[2])
-
-        relative_translation = dx
-        u = wp.transpose(T) * relative_translation
-        eps_u = friction_epsilon * dt
-
-        friction_force, friction_hessian = compute_friction(friction_mu, ground_contact_force_norm, T, u, eps_u)
-        ground_contact_force = ground_contact_force + friction_force
-        ground_contact_hessian = ground_contact_hessian + friction_hessian
-    else:
-        ground_contact_force = wp.vec3(0.0, 0.0, 0.0)
-        ground_contact_hessian = wp.mat33(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
-
-    return ground_contact_force, ground_contact_hessian
-
-
-@wp.func
-def evaluate_body_particle_contact(
-    particle_index: int,
-    particle_pos: wp.vec3,
-    particle_prev_pos: wp.vec3,
-    contact_index: int,
-    soft_contact_ke: float,
-    soft_contact_kd: float,
-    friction_mu: float,
-    friction_epsilon: float,
-    particle_radius: wp.array(dtype=float),
-    shape_materials: ModelShapeMaterials,
-    shape_body: wp.array(dtype=int),
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-    body_com: wp.array(dtype=wp.vec3),
-    contact_shape: wp.array(dtype=int),
-    contact_body_pos: wp.array(dtype=wp.vec3),
-    contact_body_vel: wp.array(dtype=wp.vec3),
-    contact_normal: wp.array(dtype=wp.vec3),
-    dt: float,
-):
-    shape_index = contact_shape[contact_index]
-    body_index = shape_body[shape_index]
-
-    X_wb = wp.transform_identity()
-    X_com = wp.vec3()
-    if body_index >= 0:
-        X_wb = body_q[body_index]
-        X_com = body_com[body_index]
-
-    # body position in world space
-    bx = wp.transform_point(X_wb, contact_body_pos[contact_index])
-    r = bx - wp.transform_point(X_wb, X_com)
-
-    n = contact_normal[contact_index]
-
-    penetration_depth = -(wp.dot(n, particle_pos - bx) - particle_radius[particle_index])
-    if penetration_depth > 0:
-        body_contact_force_norm = penetration_depth * soft_contact_ke
-        body_contact_force = n * body_contact_force_norm
-        body_contact_hessian = soft_contact_ke * wp.outer(n, n)
-
-        mu = shape_materials.mu[shape_index]
-
-        dx = particle_pos - particle_prev_pos
-
-        if wp.dot(n, dx) < 0:
-            damping_hessian = (soft_contact_kd / dt) * body_contact_hessian
-            body_contact_hessian = body_contact_hessian + damping_hessian
-            body_contact_force = body_contact_force - damping_hessian * dx
-
-        # body velocity
-        body_v_s = wp.spatial_vector()
-        if body_index >= 0:
-            body_v_s = body_qd[body_index]
-
-        body_w = wp.spatial_top(body_v_s)
-        body_v = wp.spatial_bottom(body_v_s)
-
-        # compute the body velocity at the particle position
-        bv = body_v + wp.cross(body_w, r) + wp.transform_vector(X_wb, contact_body_vel[contact_index])
-
-        relative_translation = dx - bv * dt
-
-        # friction
-        e0, e1 = build_orthonormal_basis(n)
-
-        T = mat32(e0[0], e1[0], e0[1], e1[1], e0[2], e1[2])
-
-        u = wp.transpose(T) * relative_translation
-        eps_u = friction_epsilon * dt
-
-        friction_force, friction_hessian = compute_friction(mu, body_contact_force_norm, T, u, eps_u)
-        body_contact_force = body_contact_force + friction_force
-        body_contact_hessian = body_contact_hessian + friction_hessian
-    else:
-        body_contact_force = wp.vec3(0.0, 0.0, 0.0)
-        body_contact_hessian = wp.mat33(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
-
-    return body_contact_force, body_contact_hessian
-
-
-@wp.func
-def evaluate_self_contact_force_norm(dis: float, collision_radius: float, k: float):
-    # Adjust distance and calculate penetration depth
-
-    penetration_depth = collision_radius - dis
-
-    # Initialize outputs
-    dEdD = wp.float32(0.0)
-    d2E_dDdD = wp.float32(0.0)
-
-    # C2 continuity calculation
-    tau = collision_radius * 0.5
-    if tau > dis > 1e-5:
-        k2 = 0.5 * tau * tau * k
-        dEdD = -k2 / dis
-        d2E_dDdD = k2 / (dis * dis)
-    else:
-        dEdD = -k * penetration_depth
-        d2E_dDdD = k
-
-    return dEdD, d2E_dDdD
-
-
-@wp.func
-def damp_collision(
-    displacement: wp.vec3,
-    collision_normal: wp.vec3,
-    collision_hessian: wp.mat33,
-    collision_damping: float,
-    dt: float,
-):
-    if wp.dot(displacement, collision_normal) > 0:
-        damping_hessian = (collision_damping / dt) * collision_hessian
-        damping_force = damping_hessian * displacement
-        return damping_force, damping_hessian
-    else:
-        return wp.vec3(0.0), wp.mat33(0.0)
-
-
-@wp.func
-def evaluate_edge_edge_contact(
-    v: int,
-    v_order: int,
-    e1: int,
-    e2: int,
-    pos: wp.array(dtype=wp.vec3),
-    pos_prev: wp.array(dtype=wp.vec3),
-    edge_indices: wp.array(dtype=wp.int32, ndim=2),
-    collision_radius: float,
-    collision_stiffness: float,
-    collision_damping: float,
-    friction_coefficient: float,
-    friction_epsilon: float,
-    dt: float,
-    edge_edge_parallel_epsilon: float,
-):
-    r"""
-    Returns the edge-edge contact force and hessian, including the friction force.
-    Args:
-        v:
-        v_order: \in {0, 1, 2, 3}, 0, 1 is vertex 0, 1 of e1, 2,3 is vertex 0, 1 of e2
-        e0
-        e1
-        pos
-        pos_prev,
-        edge_indices
-        collision_radius
-        collision_stiffness
-        dt
-        edge_edge_parallel_epsilon: threshold to determine whether 2 edges are parallel
-    """
-    e1_v1 = edge_indices[e1, 2]
-    e1_v2 = edge_indices[e1, 3]
-
-    e1_v1_pos = pos[e1_v1]
-    e1_v2_pos = pos[e1_v2]
-
-    e2_v1 = edge_indices[e2, 2]
-    e2_v2 = edge_indices[e2, 3]
-
-    e2_v1_pos = pos[e2_v1]
-    e2_v2_pos = pos[e2_v2]
-
-    st = wp.closest_point_edge_edge(e1_v1_pos, e1_v2_pos, e2_v1_pos, e2_v2_pos, edge_edge_parallel_epsilon)
-    s = st[0]
-    t = st[1]
-    e1_vec = e1_v2_pos - e1_v1_pos
-    e2_vec = e2_v2_pos - e2_v1_pos
-    c1 = e1_v1_pos + e1_vec * s
-    c2 = e2_v1_pos + e2_vec * t
-
-    # c1, c2, s, t = closest_point_edge_edge_2(e1_v1_pos, e1_v2_pos, e2_v1_pos, e2_v2_pos)
-
-    diff = c1 - c2
-    dis = st[2]
-    collision_normal = diff / dis
-
-    if dis < collision_radius:
-        bs = wp.vec4(1.0 - s, s, -1.0 + t, -t)
-        v_bary = bs[v_order]
-
-        dEdD, d2E_dDdD = evaluate_self_contact_force_norm(dis, collision_radius, collision_stiffness)
-
-        collision_force = -dEdD * v_bary * collision_normal
-        collision_hessian = d2E_dDdD * v_bary * v_bary * wp.outer(collision_normal, collision_normal)
-
-        # friction
-        c1_prev = pos_prev[e1_v1] + (pos_prev[e1_v2] - pos_prev[e1_v1]) * s
-        c2_prev = pos_prev[e2_v1] + (pos_prev[e2_v2] - pos_prev[e2_v1]) * t
-
-        dx = (c1 - c1_prev) - (c2 - c2_prev)
-        axis_1, axis_2 = build_orthonormal_basis(collision_normal)
-
-        T = mat32(
-            axis_1[0],
-            axis_2[0],
-            axis_1[1],
-            axis_2[1],
-            axis_1[2],
-            axis_2[2],
-        )
-
-        u = wp.transpose(T) * dx
-        eps_U = friction_epsilon * dt
-
-        # fmt: off
-        if wp.static("contact_force_hessian_ee" in VBD_DEBUG_PRINTING_OPTIONS):
-            wp.printf(
-                "    collision force:\n    %f %f %f,\n    collision hessian:\n    %f %f %f,\n    %f %f %f,\n    %f %f %f\n",
-                collision_force[0], collision_force[1], collision_force[2], collision_hessian[0, 0], collision_hessian[0, 1], collision_hessian[0, 2], collision_hessian[1, 0], collision_hessian[1, 1], collision_hessian[1, 2], collision_hessian[2, 0], collision_hessian[2, 1], collision_hessian[2, 2],
-            )
-        # fmt: on
-
-        friction_force, friction_hessian = compute_friction(friction_coefficient, -dEdD, T, u, eps_U)
-        friction_force = friction_force * v_bary
-        friction_hessian = friction_hessian * v_bary * v_bary
-
-        # # fmt: off
-        # if wp.static("contact_force_hessian_ee" in VBD_DEBUG_PRINTING_OPTIONS):
-        #     wp.printf(
-        #         "    friction force:\n    %f %f %f,\n    friction hessian:\n    %f %f %f,\n    %f %f %f,\n    %f %f %f\n",
-        #         friction_force[0], friction_force[1], friction_force[2], friction_hessian[0, 0], friction_hessian[0, 1], friction_hessian[0, 2], friction_hessian[1, 0], friction_hessian[1, 1], friction_hessian[1, 2], friction_hessian[2, 0], friction_hessian[2, 1], friction_hessian[2, 2],
-        #     )
-        # # fmt: on
-
-        if v_order == 0:
-            displacement = pos_prev[e1_v1] - e1_v1_pos
-        elif v_order == 1:
-            displacement = pos_prev[e1_v2] - e1_v2_pos
-        elif v_order == 2:
-            displacement = pos_prev[e2_v1] - e2_v1_pos
-        else:
-            displacement = pos_prev[e2_v2] - e2_v2_pos
-
-        collision_normal_normal_sign = wp.vec4(1.0, 1.0, -1.0, -1.0)
-        if wp.dot(displacement, collision_normal * collision_normal_normal_sign[v_order]) > 0:
-            damping_hessian = (collision_damping / dt) * collision_hessian
-            collision_hessian = collision_hessian + damping_hessian
-            collision_force = collision_force + damping_hessian * displacement
-
-        collision_force = collision_force + friction_force
-        collision_hessian = collision_hessian + friction_hessian
-    else:
-        collision_force = wp.vec3(0.0, 0.0, 0.0)
-        collision_hessian = wp.mat33(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
-
-    return collision_force, collision_hessian
-
-
-@wp.func
-def evaluate_edge_edge_contact_2_vertices(
-    e1: int,
-    e2: int,
-    pos: wp.array(dtype=wp.vec3),
-    pos_prev: wp.array(dtype=wp.vec3),
-    edge_indices: wp.array(dtype=wp.int32, ndim=2),
-    collision_radius: float,
-    collision_stiffness: float,
-    collision_damping: float,
-    friction_coefficient: float,
-    friction_epsilon: float,
-    dt: float,
-    edge_edge_parallel_epsilon: float,
-):
-    r"""
-    Returns the edge-edge contact force and hessian, including the friction force.
-    Args:
-        v:
-        v_order: \in {0, 1, 2, 3}, 0, 1 is vertex 0, 1 of e1, 2,3 is vertex 0, 1 of e2
-        e0
-        e1
-        pos
-        edge_indices
-        collision_radius
-        collision_stiffness
-        dt
-    """
-    e1_v1 = edge_indices[e1, 2]
-    e1_v2 = edge_indices[e1, 3]
-
-    e1_v1_pos = pos[e1_v1]
-    e1_v2_pos = pos[e1_v2]
-
-    e2_v1 = edge_indices[e2, 2]
-    e2_v2 = edge_indices[e2, 3]
-
-    e2_v1_pos = pos[e2_v1]
-    e2_v2_pos = pos[e2_v2]
-
-    st = wp.closest_point_edge_edge(e1_v1_pos, e1_v2_pos, e2_v1_pos, e2_v2_pos, edge_edge_parallel_epsilon)
-    s = st[0]
-    t = st[1]
-    e1_vec = e1_v2_pos - e1_v1_pos
-    e2_vec = e2_v2_pos - e2_v1_pos
-    c1 = e1_v1_pos + e1_vec * s
-    c2 = e2_v1_pos + e2_vec * t
-
-    # c1, c2, s, t = closest_point_edge_edge_2(e1_v1_pos, e1_v2_pos, e2_v1_pos, e2_v2_pos)
-
-    diff = c1 - c2
-    dis = st[2]
-    collision_normal = diff / dis
-
-    if dis < collision_radius:
-        bs = wp.vec4(1.0 - s, s, -1.0 + t, -t)
-
-        dEdD, d2E_dDdD = evaluate_self_contact_force_norm(dis, collision_radius, collision_stiffness)
-
-        collision_force = -dEdD * collision_normal
-        collision_hessian = d2E_dDdD * wp.outer(collision_normal, collision_normal)
-
-        # friction
-        c1_prev = pos_prev[e1_v1] + (pos_prev[e1_v2] - pos_prev[e1_v1]) * s
-        c2_prev = pos_prev[e2_v1] + (pos_prev[e2_v2] - pos_prev[e2_v1]) * t
-
-        dx = (c1 - c1_prev) - (c2 - c2_prev)
-        axis_1, axis_2 = build_orthonormal_basis(collision_normal)
-
-        T = mat32(
-            axis_1[0],
-            axis_2[0],
-            axis_1[1],
-            axis_2[1],
-            axis_1[2],
-            axis_2[2],
-        )
-
-        u = wp.transpose(T) * dx
-        eps_U = friction_epsilon * dt
-
-        # fmt: off
-        if wp.static("contact_force_hessian_ee" in VBD_DEBUG_PRINTING_OPTIONS):
-            wp.printf(
-                "    collision force:\n    %f %f %f,\n    collision hessian:\n    %f %f %f,\n    %f %f %f,\n    %f %f %f\n",
-                collision_force[0], collision_force[1], collision_force[2], collision_hessian[0, 0], collision_hessian[0, 1], collision_hessian[0, 2], collision_hessian[1, 0], collision_hessian[1, 1], collision_hessian[1, 2], collision_hessian[2, 0], collision_hessian[2, 1], collision_hessian[2, 2],
-            )
-        # fmt: on
-
-        friction_force, friction_hessian = compute_friction(friction_coefficient, -dEdD, T, u, eps_U)
-
-        # # fmt: off
-        # if wp.static("contact_force_hessian_ee" in VBD_DEBUG_PRINTING_OPTIONS):
-        #     wp.printf(
-        #         "    friction force:\n    %f %f %f,\n    friction hessian:\n    %f %f %f,\n    %f %f %f,\n    %f %f %f\n",
-        #         friction_force[0], friction_force[1], friction_force[2], friction_hessian[0, 0], friction_hessian[0, 1], friction_hessian[0, 2], friction_hessian[1, 0], friction_hessian[1, 1], friction_hessian[1, 2], friction_hessian[2, 0], friction_hessian[2, 1], friction_hessian[2, 2],
-        #     )
-        # # fmt: on
-
-        displacement_0 = pos_prev[e1_v1] - e1_v1_pos
-        displacement_1 = pos_prev[e1_v2] - e1_v2_pos
-
-        collision_force_0 = collision_force * bs[0]
-        collision_force_1 = collision_force * bs[1]
-
-        collision_hessian_0 = collision_hessian * bs[0] * bs[0]
-        collision_hessian_1 = collision_hessian * bs[1] * bs[1]
-
-        collision_normal_normal_sign = wp.vec4(1.0, 1.0, -1.0, -1.0)
-        damping_force, damping_hessian = damp_collision(
-            displacement_0,
-            collision_normal * collision_normal_normal_sign[0],
-            collision_hessian_0,
-            collision_damping,
-            dt,
-        )
-
-        collision_force_0 += damping_force + bs[0] * friction_force
-        collision_hessian_0 += damping_hessian + bs[0] * bs[0] * friction_hessian
-
-        damping_force, damping_hessian = damp_collision(
-            displacement_1,
-            collision_normal * collision_normal_normal_sign[1],
-            collision_hessian_1,
-            collision_damping,
-            dt,
-        )
-        collision_force_1 += damping_force + bs[1] * friction_force
-        collision_hessian_1 += damping_hessian + bs[1] * bs[1] * friction_hessian
-
-        return True, collision_force_0, collision_force_1, collision_hessian_0, collision_hessian_1
-    else:
-        collision_force = wp.vec3(0.0, 0.0, 0.0)
-        collision_hessian = wp.mat33(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
-
-        return False, collision_force, collision_force, collision_hessian, collision_hessian
-
-
-@wp.func
-def evaluate_vertex_triangle_collision_force_hessian(
-    v: int,
-    v_order: int,
-    tri: int,
-    pos: wp.array(dtype=wp.vec3),
-    pos_prev: wp.array(dtype=wp.vec3),
-    tri_indices: wp.array(dtype=wp.int32, ndim=2),
-    collision_radius: float,
-    collision_stiffness: float,
-    collision_damping: float,
-    friction_coefficient: float,
-    friction_epsilon: float,
-    dt: float,
-):
-    a = pos[tri_indices[tri, 0]]
-    b = pos[tri_indices[tri, 1]]
-    c = pos[tri_indices[tri, 2]]
-
-    p = pos[v]
-
-    closest_p, bary, feature_type = triangle_closest_point(a, b, c, p)
-
-    diff = p - closest_p
-    dis = wp.length(diff)
-    collision_normal = diff / dis
-
-    if dis < collision_radius:
-        bs = wp.vec4(-bary[0], -bary[1], -bary[2], 1.0)
-        v_bary = bs[v_order]
-
-        dEdD, d2E_dDdD = evaluate_self_contact_force_norm(dis, collision_radius, collision_stiffness)
-
-        collision_force = -dEdD * v_bary * collision_normal
-        collision_hessian = d2E_dDdD * v_bary * v_bary * wp.outer(collision_normal, collision_normal)
-
-        # friction force
-        dx_v = p - pos_prev[v]
-
-        closest_p_prev = (
-            bary[0] * pos_prev[tri_indices[tri, 0]]
-            + bary[1] * pos_prev[tri_indices[tri, 1]]
-            + bary[2] * pos_prev[tri_indices[tri, 2]]
-        )
-
-        dx = dx_v - (closest_p - closest_p_prev)
-
-        e0, e1 = build_orthonormal_basis(collision_normal)
-
-        T = mat32(e0[0], e1[0], e0[1], e1[1], e0[2], e1[2])
-
-        u = wp.transpose(T) * dx
-        eps_U = friction_epsilon * dt
-
-        friction_force, friction_hessian = compute_friction(friction_coefficient, -dEdD, T, u, eps_U)
-
-        # fmt: off
-        if wp.static("contact_force_hessian_vt" in VBD_DEBUG_PRINTING_OPTIONS):
-            wp.printf(
-                "v: %d dEdD: %f\nnormal force: %f %f %f\nfriction force: %f %f %f\n",
-                v,
-                dEdD,
-                collision_force[0], collision_force[1], collision_force[2], friction_force[0], friction_force[1], friction_force[2],
-            )
-        # fmt: on
-
-        if v_order == 0:
-            displacement = pos_prev[tri_indices[tri, 0]] - a
-        elif v_order == 1:
-            displacement = pos_prev[tri_indices[tri, 1]] - b
-        elif v_order == 2:
-            displacement = pos_prev[tri_indices[tri, 2]] - c
-        else:
-            displacement = pos_prev[v] - p
-
-        collision_normal_normal_sign = wp.vec4(-1.0, -1.0, -1.0, 1.0)
-        if wp.dot(displacement, collision_normal * collision_normal_normal_sign[v_order]) > 0:
-            damping_hessian = (collision_damping / dt) * collision_hessian
-            collision_hessian = collision_hessian + damping_hessian
-            collision_force = collision_force + damping_hessian * displacement
-
-        collision_force = collision_force + v_bary * friction_force
-        collision_hessian = collision_hessian + v_bary * v_bary * friction_hessian
-    else:
-        collision_force = wp.vec3(0.0, 0.0, 0.0)
-        collision_hessian = wp.mat33(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
-
-    return collision_force, collision_hessian
-
-
-@wp.func
-def evaluate_vertex_triangle_collision_force_hessian_4_vertices(
-    v: int,
-    tri: int,
-    pos: wp.array(dtype=wp.vec3),
-    pos_prev: wp.array(dtype=wp.vec3),
-    tri_indices: wp.array(dtype=wp.int32, ndim=2),
-    collision_radius: float,
-    collision_stiffness: float,
-    collision_damping: float,
-    friction_coefficient: float,
-    friction_epsilon: float,
-    dt: float,
-):
-    a = pos[tri_indices[tri, 0]]
-    b = pos[tri_indices[tri, 1]]
-    c = pos[tri_indices[tri, 2]]
-
-    p = pos[v]
-
-    closest_p, bary, feature_type = triangle_closest_point(a, b, c, p)
-
-    diff = p - closest_p
-    dis = wp.length(diff)
-    collision_normal = diff / dis
-
-    if dis < collision_radius:
-        bs = wp.vec4(-bary[0], -bary[1], -bary[2], 1.0)
-
-        dEdD, d2E_dDdD = evaluate_self_contact_force_norm(dis, collision_radius, collision_stiffness)
-
-        collision_force = -dEdD * collision_normal
-        collision_hessian = d2E_dDdD * wp.outer(collision_normal, collision_normal)
-
-        # friction force
-        dx_v = p - pos_prev[v]
-
-        closest_p_prev = (
-            bary[0] * pos_prev[tri_indices[tri, 0]]
-            + bary[1] * pos_prev[tri_indices[tri, 1]]
-            + bary[2] * pos_prev[tri_indices[tri, 2]]
-        )
-
-        dx = dx_v - (closest_p - closest_p_prev)
-
-        e0, e1 = build_orthonormal_basis(collision_normal)
-
-        T = mat32(e0[0], e1[0], e0[1], e1[1], e0[2], e1[2])
-
-        u = wp.transpose(T) * dx
-        eps_U = friction_epsilon * dt
-
-        friction_force, friction_hessian = compute_friction(friction_coefficient, -dEdD, T, u, eps_U)
-
-        # fmt: off
-        if wp.static("contact_force_hessian_vt" in VBD_DEBUG_PRINTING_OPTIONS):
-            wp.printf(
-                "v: %d dEdD: %f\nnormal force: %f %f %f\nfriction force: %f %f %f\n",
-                v,
-                dEdD,
-                collision_force[0], collision_force[1], collision_force[2], friction_force[0], friction_force[1],
-                friction_force[2],
-            )
-        # fmt: on
-
-        displacement_0 = pos_prev[tri_indices[tri, 0]] - a
-        displacement_1 = pos_prev[tri_indices[tri, 1]] - b
-        displacement_2 = pos_prev[tri_indices[tri, 2]] - c
-        displacement_3 = pos_prev[v] - p
-
-        collision_force_0 = collision_force * bs[0]
-        collision_force_1 = collision_force * bs[1]
-        collision_force_2 = collision_force * bs[2]
-        collision_force_3 = collision_force * bs[3]
-
-        collision_hessian_0 = collision_hessian * bs[0] * bs[0]
-        collision_hessian_1 = collision_hessian * bs[1] * bs[1]
-        collision_hessian_2 = collision_hessian * bs[2] * bs[2]
-        collision_hessian_3 = collision_hessian * bs[3] * bs[3]
-
-        collision_normal_normal_sign = wp.vec4(-1.0, -1.0, -1.0, 1.0)
-        damping_force, damping_hessian = damp_collision(
-            displacement_0,
-            collision_normal * collision_normal_normal_sign[0],
-            collision_hessian_0,
-            collision_damping,
-            dt,
-        )
-
-        collision_force_0 += damping_force + bs[0] * friction_force
-        collision_hessian_0 += damping_hessian + bs[0] * bs[0] * friction_hessian
-
-        damping_force, damping_hessian = damp_collision(
-            displacement_1,
-            collision_normal * collision_normal_normal_sign[1],
-            collision_hessian_1,
-            collision_damping,
-            dt,
-        )
-        collision_force_1 += damping_force + bs[1] * friction_force
-        collision_hessian_1 += damping_hessian + bs[1] * bs[1] * friction_hessian
-
-        damping_force, damping_hessian = damp_collision(
-            displacement_2,
-            collision_normal * collision_normal_normal_sign[2],
-            collision_hessian_2,
-            collision_damping,
-            dt,
-        )
-        collision_force_2 += damping_force + bs[2] * friction_force
-        collision_hessian_2 += damping_hessian + bs[2] * bs[2] * friction_hessian
-
-        damping_force, damping_hessian = damp_collision(
-            displacement_3,
-            collision_normal * collision_normal_normal_sign[3],
-            collision_hessian_3,
-            collision_damping,
-            dt,
-        )
-        collision_force_3 += damping_force + bs[3] * friction_force
-        collision_hessian_3 += damping_hessian + bs[3] * bs[3] * friction_hessian
-        return (
-            True,
-            collision_force_0,
-            collision_force_1,
-            collision_force_2,
-            collision_force_3,
-            collision_hessian_0,
-            collision_hessian_1,
-            collision_hessian_2,
-            collision_hessian_3,
-        )
-    else:
-        collision_force = wp.vec3(0.0, 0.0, 0.0)
-        collision_hessian = wp.mat33(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
-
-        return (
-            False,
-            collision_force,
-            collision_force,
-            collision_force,
-            collision_force,
-            collision_hessian,
-            collision_hessian,
-            collision_hessian,
-            collision_hessian,
-        )
-
-
-@wp.func
-def compute_friction(mu: float, normal_contact_force: float, T: mat32, u: wp.vec2, eps_u: float):
-    """
-    Returns the 1D friction force and hessian.
-    Args:
-        mu: Friction coefficient.
-        normal_contact_force: normal contact force.
-        T: Transformation matrix (3x2 matrix).
-        u: 2D displacement vector.
-    """
-    # Friction
-    u_norm = wp.length(u)
-
-    if u_norm > 0.0:
-        # IPC friction
-        if u_norm > eps_u:
-            # constant stage
-            f1_SF_over_x = 1.0 / u_norm
-        else:
-            # smooth transition
-            f1_SF_over_x = (-u_norm / eps_u + 2.0) / eps_u
-
-        force = -mu * normal_contact_force * T * (f1_SF_over_x * u)
-
-        # Different from IPC, we treat the contact normal as constant
-        # this significantly improves the stability
-        hessian = mu * normal_contact_force * T * (f1_SF_over_x * wp.identity(2, float)) * wp.transpose(T)
-    else:
-        force = wp.vec3(0.0, 0.0, 0.0)
-        hessian = wp.mat33(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
-
-    return force, hessian
-
-
-@wp.kernel
-def forward_step(
-    dt: float,
-    gravity: wp.vec3,
-    prev_pos: wp.array(dtype=wp.vec3),
-    pos: wp.array(dtype=wp.vec3),
-    vel: wp.array(dtype=wp.vec3),
-    inv_mass: wp.array(dtype=float),
-    external_force: wp.array(dtype=wp.vec3),
-    particle_flags: wp.array(dtype=wp.uint32),
-    inertia: wp.array(dtype=wp.vec3),
-):
-    particle = wp.tid()
-
-    prev_pos[particle] = pos[particle]
-    if not particle_flags[particle] & PARTICLE_FLAG_ACTIVE:
-        inertia[particle] = prev_pos[particle]
-        return
-    vel_new = vel[particle] + (gravity + external_force[particle] * inv_mass[particle]) * dt
-    pos[particle] = pos[particle] + vel_new * dt
-    inertia[particle] = pos[particle]
-
-
-@wp.kernel
-def forward_step_penetration_free(
-    dt: float,
-    gravity: wp.vec3,
-    prev_pos: wp.array(dtype=wp.vec3),
-    pos: wp.array(dtype=wp.vec3),
-    vel: wp.array(dtype=wp.vec3),
-    inv_mass: wp.array(dtype=float),
-    external_force: wp.array(dtype=wp.vec3),
-    particle_flags: wp.array(dtype=wp.uint32),
-    pos_prev_collision_detection: wp.array(dtype=wp.vec3),
-    particle_conservative_bounds: wp.array(dtype=float),
-    inertia: wp.array(dtype=wp.vec3),
-):
-    particle_index = wp.tid()
-
-    prev_pos[particle_index] = pos[particle_index]
-    if not particle_flags[particle_index] & PARTICLE_FLAG_ACTIVE:
-        inertia[particle_index] = prev_pos[particle_index]
-        return
-    vel_new = vel[particle_index] + (gravity + external_force[particle_index] * inv_mass[particle_index]) * dt
-    pos_inertia = pos[particle_index] + vel_new * dt
-    inertia[particle_index] = pos_inertia
-
-    pos[particle_index] = apply_conservative_bound_truncation(
-        particle_index, pos_inertia, pos_prev_collision_detection, particle_conservative_bounds
-    )
-
-
-@wp.kernel
-def compute_particle_conservative_bound(
-    # inputs
-    conservative_bound_relaxation: float,
-    collision_query_radius: float,
-    adjacency: ForceElementAdjacencyInfo,
-    collision_info: TriMeshCollisionInfo,
-    # outputs
-    particle_conservative_bounds: wp.array(dtype=float),
-):
-    particle_index = wp.tid()
-    min_dist = wp.min(collision_query_radius, collision_info.vertex_colliding_triangles_min_dist[particle_index])
-
-    # bound from neighbor triangles
-    for i_adj_tri in range(
-        get_vertex_num_adjacent_faces(
-            adjacency,
-            particle_index,
-        )
-    ):
-        tri_index, vertex_order = get_vertex_adjacent_face_id_order(
-            adjacency,
-            particle_index,
-            i_adj_tri,
-        )
-        min_dist = wp.min(min_dist, collision_info.triangle_colliding_vertices_min_dist[tri_index])
-
-    # bound from neighbor edges
-    for i_adj_edge in range(
-        get_vertex_num_adjacent_edges(
-            adjacency,
-            particle_index,
-        )
-    ):
-        nei_edge_index, vertex_order_on_edge = get_vertex_adjacent_edge_id_order(
-            adjacency,
-            particle_index,
-            i_adj_edge,
-        )
-        # vertex is on the edge; otherwise it only effects the bending energy
-        if vertex_order_on_edge == 2 or vertex_order_on_edge == 3:
-            # collisions of neighbor edges
-            min_dist = wp.min(min_dist, collision_info.edge_colliding_edges_min_dist[nei_edge_index])
-
-    particle_conservative_bounds[particle_index] = conservative_bound_relaxation * min_dist
-
-
-@wp.kernel
-def validate_conservative_bound(
-    pos: wp.array(dtype=wp.vec3),
-    pos_prev_collision_detection: wp.array(dtype=wp.vec3),
-    particle_conservative_bounds: wp.array(dtype=float),
-):
-    v_index = wp.tid()
-
-    displacement = wp.length(pos[v_index] - pos_prev_collision_detection[v_index])
-
-    if displacement > particle_conservative_bounds[v_index] * 1.01 and displacement > 1e-5:
-        # wp.expect_eq(displacement <= particle_conservative_bounds[v_index] * 1.01, True)
-        wp.printf(
-            "Vertex %d has moved by %f exceeded the limit of %f\n",
-            v_index,
-            displacement,
-            particle_conservative_bounds[v_index],
-        )
-
-
-@wp.func
-def apply_conservative_bound_truncation(
-    v_index: wp.int32,
-    pos_new: wp.vec3,
-    pos_prev_collision_detection: wp.array(dtype=wp.vec3),
-    particle_conservative_bounds: wp.array(dtype=float),
-):
-    particle_pos_prev_collision_detection = pos_prev_collision_detection[v_index]
-    accumulated_displacement = pos_new - particle_pos_prev_collision_detection
-    conservative_bound = particle_conservative_bounds[v_index]
-
-    accumulated_displacement_norm = wp.length(accumulated_displacement)
-    if accumulated_displacement_norm > conservative_bound and conservative_bound > 1e-5:
-        accumulated_displacement_norm_truncated = conservative_bound
-        accumulated_displacement = accumulated_displacement * (
-            accumulated_displacement_norm_truncated / accumulated_displacement_norm
-        )
-
-        return particle_pos_prev_collision_detection + accumulated_displacement
-    else:
-        return pos_new
-
-
-@wp.kernel
-def VBD_solve_trimesh_no_self_contact(
-    dt: float,
-    particle_ids_in_color: wp.array(dtype=wp.int32),
-    prev_pos: wp.array(dtype=wp.vec3),
-    pos: wp.array(dtype=wp.vec3),
-    vel: wp.array(dtype=wp.vec3),
-    mass: wp.array(dtype=float),
-    inertia: wp.array(dtype=wp.vec3),
-    particle_flags: wp.array(dtype=wp.uint32),
-    tri_indices: wp.array(dtype=wp.int32, ndim=2),
-    tri_poses: wp.array(dtype=wp.mat22),
-    tri_materials: wp.array(dtype=float, ndim=2),
-    tri_areas: wp.array(dtype=float),
-    edge_indices: wp.array(dtype=wp.int32, ndim=2),
-    edge_rest_angles: wp.array(dtype=float),
-    edge_rest_length: wp.array(dtype=float),
-    edge_bending_properties: wp.array(dtype=float, ndim=2),
-    adjacency: ForceElementAdjacencyInfo,
-    particle_forces: wp.array(dtype=wp.vec3),
-    particle_hessians: wp.array(dtype=wp.mat33),
-    # contact info
-    soft_contact_ke: float,
-    soft_contact_kd: float,
-    friction_mu: float,
-    friction_epsilon: float,
-    # ground-particle contact
-    has_ground: bool,
-    ground: wp.array(dtype=float),
-    particle_radius: wp.array(dtype=float),
-    # output
-    pos_new: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-
-    particle_index = particle_ids_in_color[tid]
-    particle_pos = pos[particle_index]
-
-    if not particle_flags[particle_index] & PARTICLE_FLAG_ACTIVE:
-        pos_new[particle_index] = particle_pos
-        return
-
-    particle_prev_pos = pos[particle_index]
-
-    dt_sqr_reciprocal = 1.0 / (dt * dt)
-
-    # inertia force and hessian
-    f = mass[particle_index] * (inertia[particle_index] - pos[particle_index]) * (dt_sqr_reciprocal)
-    h = mass[particle_index] * dt_sqr_reciprocal * wp.identity(n=3, dtype=float)
-
-    # elastic force and hessian
-    for i_adj_tri in range(get_vertex_num_adjacent_faces(adjacency, particle_index)):
-        tri_id, particle_order = get_vertex_adjacent_face_id_order(adjacency, particle_index, i_adj_tri)
-
-        # fmt: off
-        if wp.static("connectivity" in VBD_DEBUG_PRINTING_OPTIONS):
-            wp.printf(
-                "particle: %d | num_adj_faces: %d | ",
-                particle_index,
-                get_vertex_num_adjacent_faces(particle_index, adjacency),
-            )
-            wp.printf("i_face: %d | face id: %d | v_order: %d | ", i_adj_tri, tri_id, particle_order)
-            wp.printf(
-                "face: %d %d %d\n",
-                tri_indices[tri_id, 0],
-                tri_indices[tri_id, 1],
-                tri_indices[tri_id, 2],
-            )
-        # fmt: on
-
-        f_tri, h_tri = evaluate_stvk_force_hessian(
-            tri_id,
-            particle_order,
-            pos,
-            tri_indices,
-            tri_poses[tri_id],
-            tri_areas[tri_id],
-            tri_materials[tri_id, 0],
-            tri_materials[tri_id, 1],
-            tri_materials[tri_id, 2],
-        )
-        # compute damping
-        k_d = tri_materials[tri_id, 2]
-        h_d = h_tri * (k_d / dt)
-
-        f_d = h_d * (prev_pos[particle_index] - pos[particle_index])
-
-        f = f + f_tri + f_d
-        h = h + h_tri + h_d
-
-        # fmt: off
-        if wp.static("elasticity_force_hessian" in VBD_DEBUG_PRINTING_OPTIONS):
-            wp.printf(
-                "particle: %d, i_adj_tri: %d, particle_order: %d, \nforce:\n %f %f %f, \nhessian:, \n%f %f %f, \n%f %f %f, \n%f %f %f\n",
-                particle_index,
-                i_adj_tri,
-                particle_order,
-                f[0], f[1], f[2], h[0, 0], h[0, 1], h[0, 2], h[1, 0], h[1, 1], h[1, 2], h[2, 0], h[2, 1], h[2, 2],
-            )
-        # fmt: on
-
-    for i_adj_edge in range(get_vertex_num_adjacent_edges(adjacency, particle_index)):
-        nei_edge_index, vertex_order_on_edge = get_vertex_adjacent_edge_id_order(adjacency, particle_index, i_adj_edge)
-        f_edge, h_edge = evaluate_dihedral_angle_based_bending_force_hessian(
-            nei_edge_index,
-            vertex_order_on_edge,
-            pos,
-            prev_pos,
-            edge_indices,
-            edge_rest_angles,
-            edge_rest_length,
-            edge_bending_properties[nei_edge_index, 0],
-            edge_bending_properties[nei_edge_index, 1],
-            dt,
-        )
-
-        f = f + f_edge
-        h = h + h_edge
-
-    if has_ground:
-        ground_normal = wp.vec3(ground[0], ground[1], ground[2])
-        ground_level = ground[3]
-        ground_contact_force, ground_contact_hessian = evaluate_ground_contact_force_hessian(
-            particle_pos,
-            particle_prev_pos,
-            particle_radius[particle_index],
-            ground_normal,
-            ground_level,
-            soft_contact_ke,
-            soft_contact_kd,
-            friction_mu,
-            friction_epsilon,
-            dt,
-        )
-
-        f += ground_contact_force
-        h += ground_contact_hessian
-
-    f += particle_forces[particle_index]
-    h += particle_hessians[particle_index]
-    if abs(wp.determinant(h)) > 1e-5:
-        hInv = wp.inverse(h)
-        pos_new[particle_index] = particle_pos + hInv * f
-
-
-@wp.kernel
-def VBD_copy_particle_positions_back(
-    particle_ids_in_color: wp.array(dtype=wp.int32),
-    pos: wp.array(dtype=wp.vec3),
-    pos_new: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-    particle = particle_ids_in_color[tid]
-
-    pos[particle] = pos_new[particle]
-
-
-@wp.kernel
-def update_velocity(
-    dt: float, prev_pos: wp.array(dtype=wp.vec3), pos: wp.array(dtype=wp.vec3), vel: wp.array(dtype=wp.vec3)
-):
-    particle = wp.tid()
-    vel[particle] = (pos[particle] - prev_pos[particle]) / dt
-
-
-@wp.kernel
-def convert_body_particle_contact_data_kernel(
-    # inputs
-    body_particle_contact_buffer_pre_alloc: int,
-    soft_contact_particle: wp.array(dtype=int),
-    contact_count: wp.array(dtype=int),
-    contact_max: int,
-    # outputs
-    body_particle_contact_buffer: wp.array(dtype=int),
-    body_particle_contact_count: wp.array(dtype=int),
-):
-    contact_index = wp.tid()
-    count = min(contact_max, contact_count[0])
-    if contact_index >= count:
-        return
-
-    particle_index = soft_contact_particle[contact_index]
-    offset = particle_index * body_particle_contact_buffer_pre_alloc
-
-    contact_counter = wp.atomic_add(body_particle_contact_count, particle_index, 1)
-    if contact_counter < body_particle_contact_buffer_pre_alloc:
-        body_particle_contact_buffer[offset + contact_counter] = contact_index
-
-
-@wp.kernel
-def VBD_accumulate_contact_force_and_hessian(
-    # inputs
-    dt: float,
-    current_color: int,
-    pos_prev: wp.array(dtype=wp.vec3),
-    pos: wp.array(dtype=wp.vec3),
-    particle_colors: wp.array(dtype=int),
-    tri_indices: wp.array(dtype=wp.int32, ndim=2),
-    edge_indices: wp.array(dtype=wp.int32, ndim=2),
-    # self contact
-    collision_info_array: wp.array(dtype=TriMeshCollisionInfo),
-    collision_radius: float,
-    soft_contact_ke: float,
-    soft_contact_kd: float,
-    friction_mu: float,
-    friction_epsilon: float,
-    edge_edge_parallel_epsilon: float,
-    # body-particle contact
-    particle_radius: wp.array(dtype=float),
-    soft_contact_particle: wp.array(dtype=int),
-    contact_count: wp.array(dtype=int),
-    contact_max: int,
-    shape_materials: ModelShapeMaterials,
-    shape_body: wp.array(dtype=int),
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-    body_com: wp.array(dtype=wp.vec3),
-    contact_shape: wp.array(dtype=int),
-    contact_body_pos: wp.array(dtype=wp.vec3),
-    contact_body_vel: wp.array(dtype=wp.vec3),
-    contact_normal: wp.array(dtype=wp.vec3),
-    # outputs: particle force and hessian
-    particle_forces: wp.array(dtype=wp.vec3),
-    particle_hessians: wp.array(dtype=wp.mat33),
-):
-    t_id = wp.tid()
-    collision_info = collision_info_array[0]
-
-    # process edge-edge collisions
-    if t_id * 2 < collision_info.edge_colliding_edges.shape[0]:
-        e1_idx = collision_info.edge_colliding_edges[2 * t_id]
-        e2_idx = collision_info.edge_colliding_edges[2 * t_id + 1]
-
-        if e1_idx != -1 and e2_idx != -1:
-            e1_v1 = edge_indices[e1_idx, 2]
-            e1_v2 = edge_indices[e1_idx, 3]
-            if particle_colors[e1_v1] == current_color or particle_colors[e1_v2] == current_color:
-                has_contact, collision_force_0, collision_force_1, collision_hessian_0, collision_hessian_1 = (
-                    evaluate_edge_edge_contact_2_vertices(
-                        e1_idx,
-                        e2_idx,
-                        pos,
-                        pos_prev,
-                        edge_indices,
-                        collision_radius,
-                        soft_contact_ke,
-                        soft_contact_kd,
-                        friction_mu,
-                        friction_epsilon,
-                        dt,
-                        edge_edge_parallel_epsilon,
-                    )
-                )
-
-                if has_contact:
-                    # here we only handle the e1 side, because e2 will also detection this contact and add force and hessian on its own
-                    if particle_colors[e1_v1] == current_color:
-                        wp.atomic_add(particle_forces, e1_v1, collision_force_0)
-                        wp.atomic_add(particle_hessians, e1_v1, collision_hessian_0)
-                    if particle_colors[e1_v2] == current_color:
-                        wp.atomic_add(particle_forces, e1_v2, collision_force_1)
-                        wp.atomic_add(particle_hessians, e1_v2, collision_hessian_1)
-
-    # process vertex-triangle collisions
-    if t_id * 2 < collision_info.vertex_colliding_triangles.shape[0]:
-        particle_idx = collision_info.vertex_colliding_triangles[2 * t_id]
-        tri_idx = collision_info.vertex_colliding_triangles[2 * t_id + 1]
-
-        if particle_idx != -1 and tri_idx != -1:
-            tri_a = tri_indices[tri_idx, 0]
-            tri_b = tri_indices[tri_idx, 1]
-            tri_c = tri_indices[tri_idx, 2]
-            if (
-                particle_colors[particle_idx] == current_color
-                or particle_colors[tri_a] == current_color
-                or particle_colors[tri_b] == current_color
-                or particle_colors[tri_c] == current_color
-            ):
-                (
-                    has_contact,
-                    collision_force_0,
-                    collision_force_1,
-                    collision_force_2,
-                    collision_force_3,
-                    collision_hessian_0,
-                    collision_hessian_1,
-                    collision_hessian_2,
-                    collision_hessian_3,
-                ) = evaluate_vertex_triangle_collision_force_hessian_4_vertices(
-                    particle_idx,
-                    tri_idx,
-                    pos,
-                    pos_prev,
-                    tri_indices,
-                    collision_radius,
-                    soft_contact_ke,
-                    soft_contact_kd,
-                    friction_mu,
-                    friction_epsilon,
-                    dt,
-                )
-
-                if has_contact:
-                    # particle
-                    if particle_colors[particle_idx] == current_color:
-                        wp.atomic_add(particle_forces, particle_idx, collision_force_3)
-                        wp.atomic_add(particle_hessians, particle_idx, collision_hessian_3)
-
-                    # tri_a
-                    if particle_colors[tri_a] == current_color:
-                        wp.atomic_add(particle_forces, tri_a, collision_force_0)
-                        wp.atomic_add(particle_hessians, tri_a, collision_hessian_0)
-
-                    # tri_b
-                    if particle_colors[tri_b] == current_color:
-                        wp.atomic_add(particle_forces, tri_b, collision_force_1)
-                        wp.atomic_add(particle_hessians, tri_b, collision_hessian_1)
-
-                    # tri_c
-                    if particle_colors[tri_c] == current_color:
-                        wp.atomic_add(particle_forces, tri_c, collision_force_2)
-                        wp.atomic_add(particle_hessians, tri_c, collision_hessian_2)
-
-    particle_body_contact_count = min(contact_max, contact_count[0])
-
-    if t_id < particle_body_contact_count:
-        particle_idx = soft_contact_particle[t_id]
-
-        if particle_colors[particle_idx] == current_color:
-            body_contact_force, body_contact_hessian = evaluate_body_particle_contact(
-                particle_idx,
-                pos[particle_idx],
-                pos_prev[particle_idx],
-                t_id,
-                soft_contact_ke,
-                soft_contact_kd,
-                friction_mu,
-                friction_epsilon,
-                particle_radius,
-                shape_materials,
-                shape_body,
-                body_q,
-                body_qd,
-                body_com,
-                contact_shape,
-                contact_body_pos,
-                contact_body_vel,
-                contact_normal,
-                dt,
-            )
-            wp.atomic_add(particle_forces, particle_idx, body_contact_force)
-            wp.atomic_add(particle_hessians, particle_idx, body_contact_hessian)
-
-
-@wp.kernel
-def VBD_accumulate_contact_force_and_hessian_no_self_contact(
-    # inputs
-    dt: float,
-    current_color: int,
-    pos_prev: wp.array(dtype=wp.vec3),
-    pos: wp.array(dtype=wp.vec3),
-    particle_colors: wp.array(dtype=int),
-    # body-particle contact
-    soft_contact_ke: float,
-    soft_contact_kd: float,
-    friction_mu: float,
-    friction_epsilon: float,
-    particle_radius: wp.array(dtype=float),
-    soft_contact_particle: wp.array(dtype=int),
-    contact_count: wp.array(dtype=int),
-    contact_max: int,
-    shape_materials: ModelShapeMaterials,
-    shape_body: wp.array(dtype=int),
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-    body_com: wp.array(dtype=wp.vec3),
-    contact_shape: wp.array(dtype=int),
-    contact_body_pos: wp.array(dtype=wp.vec3),
-    contact_body_vel: wp.array(dtype=wp.vec3),
-    contact_normal: wp.array(dtype=wp.vec3),
-    # outputs: particle force and hessian
-    particle_forces: wp.array(dtype=wp.vec3),
-    particle_hessians: wp.array(dtype=wp.mat33),
-):
-    t_id = wp.tid()
-
-    particle_body_contact_count = min(contact_max, contact_count[0])
-
-    if t_id < particle_body_contact_count:
-        particle_idx = soft_contact_particle[t_id]
-
-        if particle_colors[particle_idx] == current_color:
-            body_contact_force, body_contact_hessian = evaluate_body_particle_contact(
-                particle_idx,
-                pos[particle_idx],
-                pos_prev[particle_idx],
-                t_id,
-                soft_contact_ke,
-                soft_contact_kd,
-                friction_mu,
-                friction_epsilon,
-                particle_radius,
-                shape_materials,
-                shape_body,
-                body_q,
-                body_qd,
-                body_com,
-                contact_shape,
-                contact_body_pos,
-                contact_body_vel,
-                contact_normal,
-                dt,
-            )
-            wp.atomic_add(particle_forces, particle_idx, body_contact_force)
-            wp.atomic_add(particle_hessians, particle_idx, body_contact_hessian)
-
-
-@wp.kernel
-def VBD_solve_trimesh_with_self_contact_penetration_free(
-    dt: float,
-    particle_ids_in_color: wp.array(dtype=wp.int32),
-    pos_prev: wp.array(dtype=wp.vec3),
-    pos: wp.array(dtype=wp.vec3),
-    vel: wp.array(dtype=wp.vec3),
-    mass: wp.array(dtype=float),
-    inertia: wp.array(dtype=wp.vec3),
-    particle_flags: wp.array(dtype=wp.uint32),
-    tri_indices: wp.array(dtype=wp.int32, ndim=2),
-    tri_poses: wp.array(dtype=wp.mat22),
-    tri_materials: wp.array(dtype=float, ndim=2),
-    tri_areas: wp.array(dtype=float),
-    edge_indices: wp.array(dtype=wp.int32, ndim=2),
-    edge_rest_angles: wp.array(dtype=float),
-    edge_rest_length: wp.array(dtype=float),
-    edge_bending_properties: wp.array(dtype=float, ndim=2),
-    adjacency: ForceElementAdjacencyInfo,
-    particle_forces: wp.array(dtype=wp.vec3),
-    particle_hessians: wp.array(dtype=wp.mat33),
-    pos_prev_collision_detection: wp.array(dtype=wp.vec3),
-    particle_conservative_bounds: wp.array(dtype=float),
-    # ground-particle contact
-    has_ground: bool,
-    ground: wp.array(dtype=float),
-    soft_contact_ke: float,
-    soft_contact_kd: float,
-    friction_mu: float,
-    friction_epsilon: float,
-    particle_radius: wp.array(dtype=float),
-    # output
-    pos_new: wp.array(dtype=wp.vec3),
-):
-    t_id = wp.tid()
-
-    particle_index = particle_ids_in_color[t_id]
-    particle_pos = pos[particle_index]
-    particle_prev_pos = pos_prev[particle_index]
-
-    if not particle_flags[particle_index] & PARTICLE_FLAG_ACTIVE:
-        pos_new[particle_index] = particle_pos
-        return
-
-    dt_sqr_reciprocal = 1.0 / (dt * dt)
-
-    # inertia force and hessian
-    f = mass[particle_index] * (inertia[particle_index] - pos[particle_index]) * (dt_sqr_reciprocal)
-    h = particle_hessians[particle_index] + mass[particle_index] * dt_sqr_reciprocal * wp.identity(n=3, dtype=float)
-
-    # fmt: off
-    if wp.static("inertia_force_hessian" in VBD_DEBUG_PRINTING_OPTIONS):
-        wp.printf(
-            "particle: %d after accumulate inertia\nforce:\n %f %f %f, \nhessian:, \n%f %f %f, \n%f %f %f, \n%f %f %f\n",
-            particle_index,
-            f[0], f[1], f[2], h[0, 0], h[0, 1], h[0, 2], h[1, 0], h[1, 1], h[1, 2], h[2, 0], h[2, 1], h[2, 2],
-        )
-
-    # elastic force and hessian
-    for i_adj_tri in range(get_vertex_num_adjacent_faces(adjacency, particle_index)):
-        tri_index, vertex_order = get_vertex_adjacent_face_id_order(adjacency, particle_index, i_adj_tri)
-
-        # fmt: off
-        if wp.static("connectivity" in VBD_DEBUG_PRINTING_OPTIONS):
-            wp.printf(
-                "particle: %d | num_adj_faces: %d | ",
-                particle_index,
-                get_vertex_num_adjacent_faces(particle_index, adjacency),
-            )
-            wp.printf("i_face: %d | face id: %d | v_order: %d | ", i_adj_tri, tri_index, vertex_order)
-            wp.printf(
-                "face: %d %d %d\n",
-                tri_indices[tri_index, 0],
-                tri_indices[tri_index, 1],
-                tri_indices[tri_index, 2],
-            )
-        # fmt: on
-
-        f_tri, h_tri = evaluate_stvk_force_hessian(
-            tri_index,
-            vertex_order,
-            pos,
-            tri_indices,
-            tri_poses[tri_index],
-            tri_areas[tri_index],
-            tri_materials[tri_index, 0],
-            tri_materials[tri_index, 1],
-            tri_materials[tri_index, 2],
-        )
-        # compute damping
-        k_d = tri_materials[tri_index, 2]
-        h_d = h_tri * (k_d / dt)
-
-        f_d = h_d * (particle_prev_pos - particle_pos)
-
-        f = f + f_tri + f_d
-        h = h + h_tri + h_d
-
-
-    for i_adj_edge in range(get_vertex_num_adjacent_edges(adjacency, particle_index)):
-        nei_edge_index, vertex_order_on_edge = get_vertex_adjacent_edge_id_order(adjacency, particle_index, i_adj_edge)
-        # vertex is on the edge; otherwise it only effects the bending energy n
-        if edge_bending_properties[nei_edge_index, 0] != 0:
-            f_edge, h_edge = evaluate_dihedral_angle_based_bending_force_hessian(
-                nei_edge_index, vertex_order_on_edge, pos, pos_prev, edge_indices, edge_rest_angles, edge_rest_length,
-                edge_bending_properties[nei_edge_index, 0], edge_bending_properties[nei_edge_index, 1], dt
-            )
-
-            f = f + f_edge
-            h = h + h_edge
-
-    if has_ground:
-        ground_normal = wp.vec3(ground[0], ground[1], ground[2])
-        ground_level = ground[3]
-        ground_contact_force, ground_contact_hessian = evaluate_ground_contact_force_hessian(
-            particle_pos,
-            particle_prev_pos,
-            particle_radius[particle_index],
-            ground_normal,
-            ground_level,
-            soft_contact_ke,
-            soft_contact_kd,
-            friction_mu,
-            friction_epsilon,
-            dt,
-        )
-
-        f = f + ground_contact_force
-        h = h + ground_contact_hessian
-
-    # fmt: off
-    if wp.static("overall_force_hessian" in VBD_DEBUG_PRINTING_OPTIONS):
-        wp.printf(
-            "vertex: %d final\noverall force:\n %f %f %f, \noverall hessian:, \n%f %f %f, \n%f %f %f, \n%f %f %f\n",
-            particle_index,
-            f[0], f[1], f[2], h[0, 0], h[0, 1], h[0, 2], h[1, 0], h[1, 1], h[1, 2], h[2, 0], h[2, 1], h[2, 2],
-        )
-
-    # # fmt: on
-    h = h + particle_hessians[particle_index]
-    f = f + particle_forces[particle_index]
-    if abs(wp.determinant(h)) > 1e-5:
-
-        h_inv = wp.inverse(h)
-        particle_pos_new = pos[particle_index] + h_inv * f
-
-        pos_new[particle_index] = apply_conservative_bound_truncation(
-            particle_index, particle_pos_new, pos_prev_collision_detection, particle_conservative_bounds
-        )
-
-
-class VBDIntegrator(Integrator):
-    """An implicit integrator using Vertex Block Descent (VBD) for cloth simulation.
-
-    References:
-        - Anka He Chen, Ziheng Liu, Yin Yang, and Cem Yuksel. 2024. Vertex Block Descent. ACM Trans. Graph. 43, 4, Article 116 (July 2024), 16 pages. https://doi.org/10.1145/3658179
-
-    Note that VBDIntegrator's constructor requires a :class:`Model` object as input, so that it can do some precomputation and preallocate the space.
-    After construction, you must provide the same :class:`Model` object that you used that was used during construction.
-    Currently, you must manually provide particle coloring and assign it to `model.particle_color_groups` to make VBD work.
-
-    VBDIntegrator.simulate accepts three arguments: class:`Model`, :class:`State`, and :class:`Control` (optional) objects, this time-integrator
-    may be used to advance the simulation state forward in time.
-
-    Example
-    -------
-
-    .. code-block:: python
-
-        model.particle_color_groups = # load or generate particle coloring
-        integrator = wp.VBDIntegrator(model)
-
-        # simulation loop
-        for i in range(100):
-            state = integrator.simulate(model, state_in, state_out, dt, control)
-
-    """
-
-    def __init__(
-        self,
-        model: Model,
-        iterations=10,
-        handle_self_contact=False,
-        penetration_free_conservative_bound_relaxation=0.42,
-        friction_epsilon=1e-2,
-        body_particle_contact_buffer_pre_alloc=4,
-        vertex_collision_buffer_pre_alloc=32,
-        edge_collision_buffer_pre_alloc=64,
-        triangle_collision_buffer_pre_alloc=32,
-        edge_edge_parallel_epsilon=1e-5,
-    ):
-        self.device = model.device
-        self.model = model
-        self.iterations = iterations
-
-        # add new attributes for VBD solve
-        self.particle_q_prev = wp.zeros_like(model.particle_q, device=self.device)
-        self.inertia = wp.zeros_like(model.particle_q, device=self.device)
-
-        self.adjacency = self.compute_force_element_adjacency(model).to(self.device)
-
-        self.body_particle_contact_count = wp.zeros((model.particle_count,), dtype=wp.int32, device=self.device)
-
-        self.handle_self_contact = handle_self_contact
-
-        if handle_self_contact:
-            if self.model.soft_contact_margin < self.model.soft_contact_radius:
-                raise ValueError(
-                    "model.soft_contact_margin is smaller than self.model.soft_contact_radius, this will result in missing contacts and cause instability. \n"
-                    "It is advisable to make model.soft_contact_margin 1.5~2 times larger than self.model.soft_contact_radius."
-                )
-
-            self.conservative_bound_relaxation = penetration_free_conservative_bound_relaxation
-            self.pos_prev_collision_detection = wp.zeros_like(model.particle_q, device=self.device)
-            self.particle_conservative_bounds = wp.full((model.particle_count,), dtype=float, device=self.device)
-
-            self.trimesh_collision_detector = TriMeshCollisionDetector(
-                self.model,
-                vertex_collision_buffer_pre_alloc=vertex_collision_buffer_pre_alloc,
-                edge_collision_buffer_pre_alloc=edge_collision_buffer_pre_alloc,
-                triangle_collision_buffer_pre_alloc=triangle_collision_buffer_pre_alloc,
-                edge_edge_parallel_epsilon=edge_edge_parallel_epsilon,
-            )
-
-            self.trimesh_collision_info = wp.array(
-                [self.trimesh_collision_detector.collision_info], dtype=TriMeshCollisionInfo, device=self.device
-            )
-
-            self.collision_evaluation_kernel_launch_size = max(
-                self.trimesh_collision_detector.vertex_colliding_triangles.shape[0] // 2,
-                self.trimesh_collision_detector.edge_colliding_edges.shape[0] // 2,
-                self.model.soft_contact_max,
-            )
-        else:
-            self.collision_evaluation_kernel_launch_size = self.model.soft_contact_max
-
-        # spaces for particle force and hessian
-        self.particle_forces = wp.zeros(self.model.particle_count, dtype=wp.vec3, device=self.device)
-        self.particle_hessians = wp.zeros(self.model.particle_count, dtype=wp.mat33, device=self.device)
-
-        self.friction_epsilon = friction_epsilon
-
-        if len(self.model.particle_color_groups) == 0:
-            raise ValueError(
-                "model.particle_color_groups is empty! When using the VBDIntegrator you must call ModelBuilder.color() "
-                "or ModelBuilder.set_coloring() before calling ModelBuilder.finalize()."
-            )
-
-        # tests
-        # wp.launch(kernel=_test_compute_force_element_adjacency,
-        #           inputs=[self.adjacency, model.edge_indices, model.tri_indices],
-        #           dim=1, device=self.device)
-
-    def compute_force_element_adjacency(self, model):
-        adjacency = ForceElementAdjacencyInfo()
-        edges_array = model.edge_indices.to("cpu")
-
-        if edges_array.size:
-            # build vertex-edge adjacency data
-            num_vertex_adjacent_edges = wp.zeros(shape=(self.model.particle_count,), dtype=wp.int32, device="cpu")
-
-            wp.launch(
-                kernel=self.count_num_adjacent_edges,
-                inputs=[edges_array, num_vertex_adjacent_edges],
-                dim=1,
-                device="cpu",
-            )
-
-            num_vertex_adjacent_edges = num_vertex_adjacent_edges.numpy()
-            vertex_adjacent_edges_offsets = np.empty(shape=(self.model.particle_count + 1,), dtype=wp.int32)
-            vertex_adjacent_edges_offsets[1:] = np.cumsum(2 * num_vertex_adjacent_edges)[:]
-            vertex_adjacent_edges_offsets[0] = 0
-            adjacency.v_adj_edges_offsets = wp.array(vertex_adjacent_edges_offsets, dtype=wp.int32, device="cpu")
-
-            # temporal variables to record how much adjacent edges has been filled to each vertex
-            vertex_adjacent_edges_fill_count = wp.zeros(
-                shape=(self.model.particle_count,), dtype=wp.int32, device="cpu"
-            )
-
-            edge_adjacency_array_size = 2 * num_vertex_adjacent_edges.sum()
-            # vertex order: o0: 0, o1: 1, v0: 2, v1: 3,
-            adjacency.v_adj_edges = wp.empty(shape=(edge_adjacency_array_size,), dtype=wp.int32, device="cpu")
-
-            wp.launch(
-                kernel=self.fill_adjacent_edges,
-                inputs=[
-                    edges_array,
-                    adjacency.v_adj_edges_offsets,
-                    vertex_adjacent_edges_fill_count,
-                    adjacency.v_adj_edges,
-                ],
-                dim=1,
-                device="cpu",
-            )
-        else:
-            adjacency.v_adj_edges_offsets = wp.empty(shape=(0,), dtype=wp.int32, device="cpu")
-            adjacency.v_adj_edges = wp.empty(shape=(0,), dtype=wp.int32, device="cpu")
-
-        # compute adjacent triangles
-
-        # count number of adjacent faces for each vertex
-        face_indices = model.tri_indices.to("cpu")
-        num_vertex_adjacent_faces = wp.zeros(shape=(self.model.particle_count,), dtype=wp.int32, device="cpu")
-        wp.launch(
-            kernel=self.count_num_adjacent_faces, inputs=[face_indices, num_vertex_adjacent_faces], dim=1, device="cpu"
-        )
-
-        # preallocate memory based on counting results
-        num_vertex_adjacent_faces = num_vertex_adjacent_faces.numpy()
-        vertex_adjacent_faces_offsets = np.empty(shape=(self.model.particle_count + 1,), dtype=wp.int32)
-        vertex_adjacent_faces_offsets[1:] = np.cumsum(2 * num_vertex_adjacent_faces)[:]
-        vertex_adjacent_faces_offsets[0] = 0
-        adjacency.v_adj_faces_offsets = wp.array(vertex_adjacent_faces_offsets, dtype=wp.int32, device="cpu")
-
-        vertex_adjacent_faces_fill_count = wp.zeros(shape=(self.model.particle_count,), dtype=wp.int32, device="cpu")
-
-        face_adjacency_array_size = 2 * num_vertex_adjacent_faces.sum()
-        # (face, vertex_order) * num_adj_faces * num_particles
-        # vertex order: v0: 0, v1: 1, o0: 2, v2: 3
-        adjacency.v_adj_faces = wp.empty(shape=(face_adjacency_array_size,), dtype=wp.int32, device="cpu")
-
-        wp.launch(
-            kernel=self.fill_adjacent_faces,
-            inputs=[
-                face_indices,
-                adjacency.v_adj_faces_offsets,
-                vertex_adjacent_faces_fill_count,
-                adjacency.v_adj_faces,
-            ],
-            dim=1,
-            device="cpu",
-        )
-
-        return adjacency
-
-    def simulate(self, model: Model, state_in: State, state_out: State, dt: float, control: Control = None):
-        if model is not self.model:
-            raise ValueError("model must be the one used to initialize VBDIntegrator")
-
-        if self.handle_self_contact:
-            self.simulate_one_step_with_collisions_penetration_free(model, state_in, state_out, dt, control)
-        else:
-            self.simulate_one_step_no_self_contact(model, state_in, state_out, dt, control)
-
-    def simulate_one_step_no_self_contact(
-        self, model: Model, state_in: State, state_out: State, dt: float, control: Control = None
-    ):
-        wp.launch(
-            kernel=forward_step,
-            inputs=[
-                dt,
-                model.gravity,
-                self.particle_q_prev,
-                state_in.particle_q,
-                state_in.particle_qd,
-                self.model.particle_inv_mass,
-                state_in.particle_f,
-                self.model.particle_flags,
-                self.inertia,
-            ],
-            dim=self.model.particle_count,
-            device=self.device,
-        )
-
-        for _iter in range(self.iterations):
-            self.particle_forces.zero_()
-            self.particle_hessians.zero_()
-            for color in range(len(self.model.particle_color_groups)):
-                wp.launch(
-                    kernel=VBD_accumulate_contact_force_and_hessian_no_self_contact,
-                    dim=self.collision_evaluation_kernel_launch_size,
-                    inputs=[
-                        dt,
-                        color,
-                        self.particle_q_prev,
-                        state_in.particle_q,
-                        self.model.particle_colors,
-                        # body-particle contact
-                        self.model.soft_contact_ke,
-                        self.model.soft_contact_kd,
-                        self.model.soft_contact_mu,
-                        self.friction_epsilon,
-                        self.model.particle_radius,
-                        self.model.soft_contact_particle,
-                        self.model.soft_contact_count,
-                        self.model.soft_contact_max,
-                        self.model.shape_materials,
-                        self.model.shape_body,
-                        self.model.body_q,
-                        self.model.body_qd,
-                        self.model.body_com,
-                        self.model.soft_contact_shape,
-                        self.model.soft_contact_body_pos,
-                        self.model.soft_contact_body_vel,
-                        self.model.soft_contact_normal,
-                    ],
-                    outputs=[self.particle_forces, self.particle_hessians],
-                    device=self.device,
-                )
-
-                wp.launch(
-                    kernel=VBD_solve_trimesh_no_self_contact,
-                    inputs=[
-                        dt,
-                        self.model.particle_color_groups[color],
-                        self.particle_q_prev,
-                        state_in.particle_q,
-                        state_in.particle_qd,
-                        self.model.particle_mass,
-                        self.inertia,
-                        self.model.particle_flags,
-                        self.model.tri_indices,
-                        self.model.tri_poses,
-                        self.model.tri_materials,
-                        self.model.tri_areas,
-                        self.model.edge_indices,
-                        self.model.edge_rest_angle,
-                        self.model.edge_rest_length,
-                        self.model.edge_bending_properties,
-                        self.adjacency,
-                        self.particle_forces,
-                        self.particle_hessians,
-                        self.model.soft_contact_ke,
-                        self.model.soft_contact_kd,
-                        self.model.soft_contact_mu,
-                        self.friction_epsilon,
-                        #   ground-particle contact
-                        self.model.ground,
-                        self.model.ground_plane,
-                        self.model.particle_radius,
-                    ],
-                    outputs=[
-                        state_out.particle_q,
-                    ],
-                    dim=self.model.particle_color_groups[color].size,
-                    device=self.device,
-                )
-
-                wp.launch(
-                    kernel=VBD_copy_particle_positions_back,
-                    inputs=[self.model.particle_color_groups[color], state_in.particle_q, state_out.particle_q],
-                    dim=self.model.particle_color_groups[color].size,
-                    device=self.device,
-                )
-
-        wp.launch(
-            kernel=update_velocity,
-            inputs=[dt, self.particle_q_prev, state_out.particle_q, state_out.particle_qd],
-            dim=self.model.particle_count,
-            device=self.device,
-        )
-
-    def simulate_one_step_with_collisions_penetration_free(
-        self, model: Model, state_in: State, state_out: State, dt: float, control: Control = None
-    ):
-        # collision detection before initialization to compute conservative bounds for initialization
-        self.collision_detection_penetration_free(state_in, dt)
-
-        wp.launch(
-            kernel=forward_step_penetration_free,
-            inputs=[
-                dt,
-                model.gravity,
-                self.particle_q_prev,
-                state_in.particle_q,
-                state_in.particle_qd,
-                self.model.particle_inv_mass,
-                state_in.particle_f,
-                self.model.particle_flags,
-                self.pos_prev_collision_detection,
-                self.particle_conservative_bounds,
-                self.inertia,
-            ],
-            dim=self.model.particle_count,
-            device=self.device,
-        )
-
-        # after initialization, we do another collision detection to update the bounds
-        self.collision_detection_penetration_free(state_in, dt)
-
-        for _iter in range(self.iterations):
-            self.particle_forces.zero_()
-            self.particle_hessians.zero_()
-
-            for color in range(len(self.model.particle_color_groups)):
-                wp.launch(
-                    kernel=VBD_accumulate_contact_force_and_hessian,
-                    dim=self.collision_evaluation_kernel_launch_size,
-                    inputs=[
-                        dt,
-                        color,
-                        self.particle_q_prev,
-                        state_in.particle_q,
-                        self.model.particle_colors,
-                        self.model.tri_indices,
-                        self.model.edge_indices,
-                        # self-contact
-                        self.trimesh_collision_info,
-                        self.model.soft_contact_radius,
-                        self.model.soft_contact_ke,
-                        self.model.soft_contact_kd,
-                        self.model.soft_contact_mu,
-                        self.friction_epsilon,
-                        self.trimesh_collision_detector.edge_edge_parallel_epsilon,
-                        # body-particle contact
-                        self.model.particle_radius,
-                        self.model.soft_contact_particle,
-                        self.model.soft_contact_count,
-                        self.model.soft_contact_max,
-                        self.model.shape_materials,
-                        self.model.shape_body,
-                        self.model.body_q,
-                        self.model.body_qd,
-                        self.model.body_com,
-                        self.model.soft_contact_shape,
-                        self.model.soft_contact_body_pos,
-                        self.model.soft_contact_body_vel,
-                        self.model.soft_contact_normal,
-                    ],
-                    outputs=[self.particle_forces, self.particle_hessians],
-                    device=self.device,
-                )
-
-                wp.launch(
-                    kernel=VBD_solve_trimesh_with_self_contact_penetration_free,
-                    dim=self.model.particle_color_groups[color].shape[0],
-                    inputs=[
-                        dt,
-                        self.model.particle_color_groups[color],
-                        self.particle_q_prev,
-                        state_in.particle_q,
-                        state_in.particle_qd,
-                        self.model.particle_mass,
-                        self.inertia,
-                        self.model.particle_flags,
-                        self.model.tri_indices,
-                        self.model.tri_poses,
-                        self.model.tri_materials,
-                        self.model.tri_areas,
-                        self.model.edge_indices,
-                        self.model.edge_rest_angle,
-                        self.model.edge_rest_length,
-                        self.model.edge_bending_properties,
-                        self.adjacency,
-                        self.particle_forces,
-                        self.particle_hessians,
-                        self.pos_prev_collision_detection,
-                        self.particle_conservative_bounds,
-                        self.model.ground,
-                        self.model.ground_plane,
-                        self.model.soft_contact_ke,
-                        self.model.soft_contact_kd,
-                        self.model.soft_contact_mu,
-                        self.friction_epsilon,
-                        self.model.particle_radius,
-                    ],
-                    outputs=[
-                        state_out.particle_q,
-                    ],
-                    device=self.device,
-                )
-
-                wp.launch(
-                    kernel=VBD_copy_particle_positions_back,
-                    inputs=[self.model.particle_color_groups[color], state_in.particle_q, state_out.particle_q],
-                    dim=self.model.particle_color_groups[color].size,
-                    device=self.device,
-                )
-
-        wp.launch(
-            kernel=update_velocity,
-            inputs=[dt, self.particle_q_prev, state_out.particle_q, state_out.particle_qd],
-            dim=self.model.particle_count,
-            device=self.device,
-        )
-
-    def collision_detection_penetration_free(self, current_state, dt):
-        self.trimesh_collision_detector.refit(current_state.particle_q)
-        self.trimesh_collision_detector.vertex_triangle_collision_detection(self.model.soft_contact_margin)
-        self.trimesh_collision_detector.edge_edge_collision_detection(self.model.soft_contact_margin)
-
-        self.pos_prev_collision_detection.assign(current_state.particle_q)
-        wp.launch(
-            kernel=compute_particle_conservative_bound,
-            inputs=[
-                self.conservative_bound_relaxation,
-                self.model.soft_contact_margin,
-                self.adjacency,
-                self.trimesh_collision_detector.collision_info,
-            ],
-            outputs=[
-                self.particle_conservative_bounds,
-            ],
-            dim=self.model.particle_count,
-            device=self.device,
-        )
-
-    def rebuild_bvh(self, state: State):
-        """This function will rebuild the BVHs used for detecting self-contacts using the input `state`.
-
-        When the simulated object deforms significantly, simply refitting the BVH can lead to deterioration of the BVH's
-        quality. In these cases, rebuilding the entire tree is necessary to achieve better querying efficiency.
-
-        Args:
-            state (wp.sim.State):  The state whose particle positions (:attr:`State.particle_q`) will be used for rebuilding the BVHs.
-        """
-        self.trimesh_collision_detector.rebuild(state.particle_q)
-
-    @wp.kernel
-    def count_num_adjacent_edges(
-        edges_array: wp.array(dtype=wp.int32, ndim=2), num_vertex_adjacent_edges: wp.array(dtype=wp.int32)
-    ):
-        for edge_id in range(edges_array.shape[0]):
-            o0 = edges_array[edge_id, 0]
-            o1 = edges_array[edge_id, 1]
-
-            v0 = edges_array[edge_id, 2]
-            v1 = edges_array[edge_id, 3]
-
-            num_vertex_adjacent_edges[v0] = num_vertex_adjacent_edges[v0] + 1
-            num_vertex_adjacent_edges[v1] = num_vertex_adjacent_edges[v1] + 1
-
-            if o0 != -1:
-                num_vertex_adjacent_edges[o0] = num_vertex_adjacent_edges[o0] + 1
-            if o1 != -1:
-                num_vertex_adjacent_edges[o1] = num_vertex_adjacent_edges[o1] + 1
-
-    @wp.kernel
-    def fill_adjacent_edges(
-        edges_array: wp.array(dtype=wp.int32, ndim=2),
-        vertex_adjacent_edges_offsets: wp.array(dtype=wp.int32),
-        vertex_adjacent_edges_fill_count: wp.array(dtype=wp.int32),
-        vertex_adjacent_edges: wp.array(dtype=wp.int32),
-    ):
-        for edge_id in range(edges_array.shape[0]):
-            v0 = edges_array[edge_id, 2]
-            v1 = edges_array[edge_id, 3]
-
-            fill_count_v0 = vertex_adjacent_edges_fill_count[v0]
-            buffer_offset_v0 = vertex_adjacent_edges_offsets[v0]
-            vertex_adjacent_edges[buffer_offset_v0 + fill_count_v0 * 2] = edge_id
-            vertex_adjacent_edges[buffer_offset_v0 + fill_count_v0 * 2 + 1] = 2
-            vertex_adjacent_edges_fill_count[v0] = fill_count_v0 + 1
-
-            fill_count_v1 = vertex_adjacent_edges_fill_count[v1]
-            buffer_offset_v1 = vertex_adjacent_edges_offsets[v1]
-            vertex_adjacent_edges[buffer_offset_v1 + fill_count_v1 * 2] = edge_id
-            vertex_adjacent_edges[buffer_offset_v1 + fill_count_v1 * 2 + 1] = 3
-            vertex_adjacent_edges_fill_count[v1] = fill_count_v1 + 1
-
-            o0 = edges_array[edge_id, 0]
-            if o0 != -1:
-                fill_count_o0 = vertex_adjacent_edges_fill_count[o0]
-                buffer_offset_o0 = vertex_adjacent_edges_offsets[o0]
-                vertex_adjacent_edges[buffer_offset_o0 + fill_count_o0 * 2] = edge_id
-                vertex_adjacent_edges[buffer_offset_o0 + fill_count_o0 * 2 + 1] = 0
-                vertex_adjacent_edges_fill_count[o0] = fill_count_o0 + 1
-
-            o1 = edges_array[edge_id, 1]
-            if o1 != -1:
-                fill_count_o1 = vertex_adjacent_edges_fill_count[o1]
-                buffer_offset_o1 = vertex_adjacent_edges_offsets[o1]
-                vertex_adjacent_edges[buffer_offset_o1 + fill_count_o1 * 2] = edge_id
-                vertex_adjacent_edges[buffer_offset_o1 + fill_count_o1 * 2 + 1] = 1
-                vertex_adjacent_edges_fill_count[o1] = fill_count_o1 + 1
-
-    @wp.kernel
-    def count_num_adjacent_faces(
-        face_indices: wp.array(dtype=wp.int32, ndim=2), num_vertex_adjacent_faces: wp.array(dtype=wp.int32)
-    ):
-        for face in range(face_indices.shape[0]):
-            v0 = face_indices[face, 0]
-            v1 = face_indices[face, 1]
-            v2 = face_indices[face, 2]
-
-            num_vertex_adjacent_faces[v0] = num_vertex_adjacent_faces[v0] + 1
-            num_vertex_adjacent_faces[v1] = num_vertex_adjacent_faces[v1] + 1
-            num_vertex_adjacent_faces[v2] = num_vertex_adjacent_faces[v2] + 1
-
-    @wp.kernel
-    def fill_adjacent_faces(
-        face_indices: wp.array(dtype=wp.int32, ndim=2),
-        vertex_adjacent_faces_offsets: wp.array(dtype=wp.int32),
-        vertex_adjacent_faces_fill_count: wp.array(dtype=wp.int32),
-        vertex_adjacent_faces: wp.array(dtype=wp.int32),
-    ):
-        for face in range(face_indices.shape[0]):
-            v0 = face_indices[face, 0]
-            v1 = face_indices[face, 1]
-            v2 = face_indices[face, 2]
-
-            fill_count_v0 = vertex_adjacent_faces_fill_count[v0]
-            buffer_offset_v0 = vertex_adjacent_faces_offsets[v0]
-            vertex_adjacent_faces[buffer_offset_v0 + fill_count_v0 * 2] = face
-            vertex_adjacent_faces[buffer_offset_v0 + fill_count_v0 * 2 + 1] = 0
-            vertex_adjacent_faces_fill_count[v0] = fill_count_v0 + 1
-
-            fill_count_v1 = vertex_adjacent_faces_fill_count[v1]
-            buffer_offset_v1 = vertex_adjacent_faces_offsets[v1]
-            vertex_adjacent_faces[buffer_offset_v1 + fill_count_v1 * 2] = face
-            vertex_adjacent_faces[buffer_offset_v1 + fill_count_v1 * 2 + 1] = 1
-            vertex_adjacent_faces_fill_count[v1] = fill_count_v1 + 1
-
-            fill_count_v2 = vertex_adjacent_faces_fill_count[v2]
-            buffer_offset_v2 = vertex_adjacent_faces_offsets[v2]
-            vertex_adjacent_faces[buffer_offset_v2 + fill_count_v2 * 2] = face
-            vertex_adjacent_faces[buffer_offset_v2 + fill_count_v2 * 2 + 1] = 2
-            vertex_adjacent_faces_fill_count[v2] = fill_count_v2 + 1
diff --git a/warp/sim/integrator_xpbd.py b/warp/sim/integrator_xpbd.py
deleted file mode 100644
index c76741cb..00000000
--- a/warp/sim/integrator_xpbd.py
+++ /dev/null
@@ -1,3295 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-import warp as wp
-
-from .integrator import Integrator
-from .model import (
-    JOINT_MODE_FORCE,
-    JOINT_MODE_TARGET_POSITION,
-    JOINT_MODE_TARGET_VELOCITY,
-    PARTICLE_FLAG_ACTIVE,
-    Control,
-    Model,
-    ModelShapeMaterials,
-    State,
-)
-from .utils import vec_abs, vec_leaky_max, vec_leaky_min, vec_max, vec_min, velocity_at_point
-
-
-@wp.kernel
-def solve_particle_ground_contacts(
-    particle_x: wp.array(dtype=wp.vec3),
-    particle_v: wp.array(dtype=wp.vec3),
-    invmass: wp.array(dtype=float),
-    particle_radius: wp.array(dtype=float),
-    particle_flags: wp.array(dtype=wp.uint32),
-    ke: float,
-    kd: float,
-    kf: float,
-    mu: float,
-    ground: wp.array(dtype=float),
-    dt: float,
-    relaxation: float,
-    delta: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-    if (particle_flags[tid] & PARTICLE_FLAG_ACTIVE) == 0:
-        return
-
-    wi = invmass[tid]
-    if wi == 0.0:
-        return
-
-    x = particle_x[tid]
-    v = particle_v[tid]
-
-    n = wp.vec3(ground[0], ground[1], ground[2])
-    c = wp.min(wp.dot(n, x) + ground[3] - particle_radius[tid], 0.0)
-
-    if c > 0.0:
-        return
-
-    # normal
-    lambda_n = c
-    delta_n = n * lambda_n
-
-    # friction
-    vn = wp.dot(n, v)
-    vt = v - n * vn
-
-    lambda_f = wp.max(mu * lambda_n, 0.0 - wp.length(vt) * dt)
-    delta_f = wp.normalize(vt) * lambda_f
-
-    wp.atomic_add(delta, tid, (delta_f - delta_n) * relaxation)
-
-
-@wp.kernel
-def apply_particle_shape_restitution(
-    particle_x_new: wp.array(dtype=wp.vec3),
-    particle_v_new: wp.array(dtype=wp.vec3),
-    particle_x_old: wp.array(dtype=wp.vec3),
-    particle_v_old: wp.array(dtype=wp.vec3),
-    particle_invmass: wp.array(dtype=float),
-    particle_radius: wp.array(dtype=float),
-    particle_flags: wp.array(dtype=wp.uint32),
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-    body_com: wp.array(dtype=wp.vec3),
-    body_m_inv: wp.array(dtype=float),
-    body_I_inv: wp.array(dtype=wp.mat33),
-    shape_body: wp.array(dtype=int),
-    shape_materials: ModelShapeMaterials,
-    particle_ka: float,
-    restitution: float,
-    contact_count: wp.array(dtype=int),
-    contact_particle: wp.array(dtype=int),
-    contact_shape: wp.array(dtype=int),
-    contact_body_pos: wp.array(dtype=wp.vec3),
-    contact_body_vel: wp.array(dtype=wp.vec3),
-    contact_normal: wp.array(dtype=wp.vec3),
-    contact_max: int,
-    dt: float,
-    relaxation: float,
-    particle_v_out: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-
-    count = min(contact_max, contact_count[0])
-    if tid >= count:
-        return
-
-    shape_index = contact_shape[tid]
-    body_index = shape_body[shape_index]
-    particle_index = contact_particle[tid]
-
-    if (particle_flags[particle_index] & PARTICLE_FLAG_ACTIVE) == 0:
-        return
-
-    # x_new = particle_x_new[particle_index]
-    v_new = particle_v_new[particle_index]
-    px = particle_x_old[particle_index]
-    v_old = particle_v_old[particle_index]
-
-    X_wb = wp.transform_identity()
-    # X_com = wp.vec3()
-
-    if body_index >= 0:
-        X_wb = body_q[body_index]
-        # X_com = body_com[body_index]
-
-    # body position in world space
-    bx = wp.transform_point(X_wb, contact_body_pos[tid])
-    # r = bx - wp.transform_point(X_wb, X_com)
-
-    n = contact_normal[tid]
-    c = wp.dot(n, px - bx) - particle_radius[particle_index]
-
-    if c > particle_ka:
-        return
-
-    rel_vel_old = wp.dot(n, v_old)
-    rel_vel_new = wp.dot(n, v_new)
-
-    if rel_vel_old < 0.0:
-        # dv = -n * wp.max(-rel_vel_new + wp.max(-restitution * rel_vel_old, 0.0), 0.0)
-        dv = n * (-rel_vel_new + wp.max(-restitution * rel_vel_old, 0.0))
-
-        # compute inverse masses
-        # w1 = particle_invmass[particle_index]
-        # w2 = 0.0
-        # if body_index >= 0:
-        #     angular = wp.cross(r, n)
-        #     q = wp.transform_get_rotation(X_wb)
-        #     rot_angular = wp.quat_rotate_inv(q, angular)
-        #     I_inv = body_I_inv[body_index]
-        #     w2 = body_m_inv[body_index] + wp.dot(rot_angular, I_inv * rot_angular)
-        # denom = w1 + w2
-        # if denom == 0.0:
-        #     return
-
-        wp.atomic_add(particle_v_out, tid, dv)
-
-
-@wp.kernel
-def apply_particle_ground_restitution(
-    particle_x_new: wp.array(dtype=wp.vec3),
-    particle_v_new: wp.array(dtype=wp.vec3),
-    particle_x_old: wp.array(dtype=wp.vec3),
-    particle_v_old: wp.array(dtype=wp.vec3),
-    particle_invmass: wp.array(dtype=float),
-    particle_radius: wp.array(dtype=float),
-    particle_flags: wp.array(dtype=wp.uint32),
-    particle_ka: float,
-    restitution: float,
-    ground: wp.array(dtype=float),
-    dt: float,
-    relaxation: float,
-    particle_v_out: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-    if (particle_flags[tid] & PARTICLE_FLAG_ACTIVE) == 0:
-        return
-
-    wi = particle_invmass[tid]
-    if wi == 0.0:
-        return
-
-    x = particle_x_old[tid]
-    v_old = particle_v_old[tid]
-    v_new = particle_v_new[tid]
-
-    n = wp.vec3(ground[0], ground[1], ground[2])
-    c = wp.dot(n, x) + ground[3] - particle_radius[tid]
-
-    if c > particle_ka:
-        return
-
-    vn = wp.dot(n, v_old)
-    vn_new = wp.dot(n, v_new)
-
-    if vn < 0.0:
-        dv = n * (-vn_new + wp.max(-restitution * vn, 0.0))
-        wp.atomic_add(particle_v_out, tid, dv)
-
-
-@wp.kernel
-def solve_particle_shape_contacts(
-    particle_x: wp.array(dtype=wp.vec3),
-    particle_v: wp.array(dtype=wp.vec3),
-    particle_invmass: wp.array(dtype=float),
-    particle_radius: wp.array(dtype=float),
-    particle_flags: wp.array(dtype=wp.uint32),
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-    body_com: wp.array(dtype=wp.vec3),
-    body_m_inv: wp.array(dtype=float),
-    body_I_inv: wp.array(dtype=wp.mat33),
-    shape_body: wp.array(dtype=int),
-    shape_materials: ModelShapeMaterials,
-    particle_mu: float,
-    particle_ka: float,
-    contact_count: wp.array(dtype=int),
-    contact_particle: wp.array(dtype=int),
-    contact_shape: wp.array(dtype=int),
-    contact_body_pos: wp.array(dtype=wp.vec3),
-    contact_body_vel: wp.array(dtype=wp.vec3),
-    contact_normal: wp.array(dtype=wp.vec3),
-    contact_max: int,
-    dt: float,
-    relaxation: float,
-    # outputs
-    delta: wp.array(dtype=wp.vec3),
-    body_delta: wp.array(dtype=wp.spatial_vector),
-):
-    tid = wp.tid()
-
-    count = min(contact_max, contact_count[0])
-    if tid >= count:
-        return
-
-    shape_index = contact_shape[tid]
-    body_index = shape_body[shape_index]
-    particle_index = contact_particle[tid]
-
-    if (particle_flags[particle_index] & PARTICLE_FLAG_ACTIVE) == 0:
-        return
-
-    px = particle_x[particle_index]
-    pv = particle_v[particle_index]
-
-    X_wb = wp.transform_identity()
-    X_com = wp.vec3()
-
-    if body_index >= 0:
-        X_wb = body_q[body_index]
-        X_com = body_com[body_index]
-
-    # body position in world space
-    bx = wp.transform_point(X_wb, contact_body_pos[tid])
-    r = bx - wp.transform_point(X_wb, X_com)
-
-    n = contact_normal[tid]
-    c = wp.dot(n, px - bx) - particle_radius[particle_index]
-
-    if c > particle_ka:
-        return
-
-    # take average material properties of shape and particle parameters
-    mu = 0.5 * (particle_mu + shape_materials.mu[shape_index])
-
-    # body velocity
-    body_v_s = wp.spatial_vector()
-    if body_index >= 0:
-        body_v_s = body_qd[body_index]
-
-    body_w = wp.spatial_top(body_v_s)
-    body_v = wp.spatial_bottom(body_v_s)
-
-    # compute the body velocity at the particle position
-    bv = body_v + wp.cross(body_w, r) + wp.transform_vector(X_wb, contact_body_vel[tid])
-
-    # relative velocity
-    v = pv - bv
-
-    # normal
-    lambda_n = c
-    delta_n = n * lambda_n
-
-    # friction
-    vn = wp.dot(n, v)
-    vt = v - n * vn
-
-    # compute inverse masses
-    w1 = particle_invmass[particle_index]
-    w2 = 0.0
-    if body_index >= 0:
-        angular = wp.cross(r, n)
-        q = wp.transform_get_rotation(X_wb)
-        rot_angular = wp.quat_rotate_inv(q, angular)
-        I_inv = body_I_inv[body_index]
-        w2 = body_m_inv[body_index] + wp.dot(rot_angular, I_inv * rot_angular)
-    denom = w1 + w2
-    if denom == 0.0:
-        return
-
-    lambda_f = wp.max(mu * lambda_n, -wp.length(vt) * dt)
-    delta_f = wp.normalize(vt) * lambda_f
-    delta_total = (delta_f - delta_n) / denom * relaxation
-
-    wp.atomic_add(delta, particle_index, w1 * delta_total)
-
-    if body_index >= 0:
-        delta_t = wp.cross(r, delta_total)
-        wp.atomic_sub(body_delta, body_index, wp.spatial_vector(delta_t, delta_total))
-
-
-@wp.kernel
-def solve_particle_particle_contacts(
-    grid: wp.uint64,
-    particle_x: wp.array(dtype=wp.vec3),
-    particle_v: wp.array(dtype=wp.vec3),
-    particle_invmass: wp.array(dtype=float),
-    particle_radius: wp.array(dtype=float),
-    particle_flags: wp.array(dtype=wp.uint32),
-    k_mu: float,
-    k_cohesion: float,
-    max_radius: float,
-    dt: float,
-    relaxation: float,
-    # outputs
-    deltas: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-
-    # order threads by cell
-    i = wp.hash_grid_point_id(grid, tid)
-    if i == -1:
-        # hash grid has not been built yet
-        return
-    if (particle_flags[i] & PARTICLE_FLAG_ACTIVE) == 0:
-        return
-
-    x = particle_x[i]
-    v = particle_v[i]
-    radius = particle_radius[i]
-    w1 = particle_invmass[i]
-
-    # particle contact
-    query = wp.hash_grid_query(grid, x, radius + max_radius + k_cohesion)
-    index = int(0)
-
-    delta = wp.vec3(0.0)
-
-    while wp.hash_grid_query_next(query, index):
-        if (particle_flags[index] & PARTICLE_FLAG_ACTIVE) != 0 and index != i:
-            # compute distance to point
-            n = x - particle_x[index]
-            d = wp.length(n)
-            err = d - radius - particle_radius[index]
-
-            # compute inverse masses
-            w2 = particle_invmass[index]
-            denom = w1 + w2
-
-            if err <= k_cohesion and denom > 0.0:
-                n = n / d
-                vrel = v - particle_v[index]
-
-                # normal
-                lambda_n = err
-                delta_n = n * lambda_n
-
-                # friction
-                vn = wp.dot(n, vrel)
-                vt = v - n * vn
-
-                lambda_f = wp.max(k_mu * lambda_n, -wp.length(vt) * dt)
-                delta_f = wp.normalize(vt) * lambda_f
-                delta += (delta_f - delta_n) / denom
-
-    wp.atomic_add(deltas, i, delta * w1 * relaxation)
-
-
-@wp.kernel
-def solve_springs(
-    x: wp.array(dtype=wp.vec3),
-    v: wp.array(dtype=wp.vec3),
-    invmass: wp.array(dtype=float),
-    spring_indices: wp.array(dtype=int),
-    spring_rest_lengths: wp.array(dtype=float),
-    spring_stiffness: wp.array(dtype=float),
-    spring_damping: wp.array(dtype=float),
-    dt: float,
-    lambdas: wp.array(dtype=float),
-    delta: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-
-    i = spring_indices[tid * 2 + 0]
-    j = spring_indices[tid * 2 + 1]
-
-    if i == -1 or j == -1:
-        return
-
-    ke = spring_stiffness[tid]
-    kd = spring_damping[tid]
-    rest = spring_rest_lengths[tid]
-
-    xi = x[i]
-    xj = x[j]
-
-    vi = v[i]
-    vj = v[j]
-
-    xij = xi - xj
-    vij = vi - vj
-
-    l = wp.length(xij)
-
-    if l == 0.0:
-        return
-
-    n = xij / l
-
-    c = l - rest
-    grad_c_xi = n
-    grad_c_xj = -1.0 * n
-
-    wi = invmass[i]
-    wj = invmass[j]
-
-    denom = wi + wj
-
-    # Note strict inequality for damping -- 0 damping is ok
-    if denom <= 0.0 or ke <= 0.0 or kd < 0.0:
-        return
-
-    alpha = 1.0 / (ke * dt * dt)
-    gamma = kd / (ke * dt)
-
-    grad_c_dot_v = dt * wp.dot(grad_c_xi, vij)  # Note: dt because from the paper we want x_i - x^n, not v...
-    dlambda = -1.0 * (c + alpha * lambdas[tid] + gamma * grad_c_dot_v) / ((1.0 + gamma) * denom + alpha)
-
-    dxi = wi * dlambda * grad_c_xi
-    dxj = wj * dlambda * grad_c_xj
-
-    lambdas[tid] = lambdas[tid] + dlambda
-
-    wp.atomic_add(delta, i, dxi)
-    wp.atomic_add(delta, j, dxj)
-
-
-@wp.kernel
-def bending_constraint(
-    x: wp.array(dtype=wp.vec3),
-    v: wp.array(dtype=wp.vec3),
-    invmass: wp.array(dtype=float),
-    indices: wp.array2d(dtype=int),
-    rest: wp.array(dtype=float),
-    bending_properties: wp.array2d(dtype=float),
-    dt: float,
-    lambdas: wp.array(dtype=float),
-    delta: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-    eps = 1.0e-6
-
-    ke = bending_properties[tid, 0]
-    kd = bending_properties[tid, 1]
-
-    i = indices[tid, 0]
-    j = indices[tid, 1]
-    k = indices[tid, 2]
-    l = indices[tid, 3]
-
-    if i == -1 or j == -1 or k == -1 or l == -1:
-        return
-
-    rest_angle = rest[tid]
-
-    x1 = x[i]
-    x2 = x[j]
-    x3 = x[k]
-    x4 = x[l]
-
-    v1 = v[i]
-    v2 = v[j]
-    v3 = v[k]
-    v4 = v[l]
-
-    w1 = invmass[i]
-    w2 = invmass[j]
-    w3 = invmass[k]
-    w4 = invmass[l]
-
-    n1 = wp.cross(x3 - x1, x4 - x1)  # normal to face 1
-    n2 = wp.cross(x4 - x2, x3 - x2)  # normal to face 2
-
-    n1_length = wp.length(n1)
-    n2_length = wp.length(n2)
-
-    if n1_length < eps or n2_length < eps:
-        return
-
-    n1 /= n1_length
-    n2 /= n2_length
-
-    cos_theta = wp.dot(n1, n2)
-
-    e = x4 - x3
-    e_hat = wp.normalize(e)
-    e_length = wp.length(e)
-
-    derivative_flip = wp.sign(wp.dot(wp.cross(n1, n2), e))
-    derivative_flip *= -1.0
-    angle = wp.acos(cos_theta)
-
-    grad_x1 = n1 * e_length * derivative_flip
-    grad_x2 = n2 * e_length * derivative_flip
-    grad_x3 = (n1 * wp.dot(x1 - x4, e_hat) + n2 * wp.dot(x2 - x4, e_hat)) * derivative_flip
-    grad_x4 = (n1 * wp.dot(x3 - x1, e_hat) + n2 * wp.dot(x3 - x2, e_hat)) * derivative_flip
-    c = angle - rest_angle
-    denominator = (
-        w1 * wp.length_sq(grad_x1)
-        + w2 * wp.length_sq(grad_x2)
-        + w3 * wp.length_sq(grad_x3)
-        + w4 * wp.length_sq(grad_x4)
-    )
-
-    # Note strict inequality for damping -- 0 damping is ok
-    if denominator <= 0.0 or ke <= 0.0 or kd < 0.0:
-        return
-
-    alpha = 1.0 / (ke * dt * dt)
-    gamma = kd / (ke * dt)
-
-    grad_dot_v = dt * (wp.dot(grad_x1, v1) + wp.dot(grad_x2, v2) + wp.dot(grad_x3, v3) + wp.dot(grad_x4, v4))
-
-    dlambda = -1.0 * (c + alpha * lambdas[tid] + gamma * grad_dot_v) / ((1.0 + gamma) * denominator + alpha)
-
-    delta0 = w1 * dlambda * grad_x1
-    delta1 = w2 * dlambda * grad_x2
-    delta2 = w3 * dlambda * grad_x3
-    delta3 = w4 * dlambda * grad_x4
-
-    lambdas[tid] = lambdas[tid] + dlambda
-
-    wp.atomic_add(delta, i, delta0)
-    wp.atomic_add(delta, j, delta1)
-    wp.atomic_add(delta, k, delta2)
-    wp.atomic_add(delta, l, delta3)
-
-
-@wp.kernel
-def solve_tetrahedra(
-    x: wp.array(dtype=wp.vec3),
-    v: wp.array(dtype=wp.vec3),
-    inv_mass: wp.array(dtype=float),
-    indices: wp.array(dtype=int, ndim=2),
-    rest_matrix: wp.array(dtype=wp.mat33),
-    activation: wp.array(dtype=float),
-    materials: wp.array(dtype=float, ndim=2),
-    dt: float,
-    relaxation: float,
-    delta: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-
-    i = indices[tid, 0]
-    j = indices[tid, 1]
-    k = indices[tid, 2]
-    l = indices[tid, 3]
-
-    # act = activation[tid]
-
-    # k_mu = materials[tid, 0]
-    # k_lambda = materials[tid, 1]
-    # k_damp = materials[tid, 2]
-
-    x0 = x[i]
-    x1 = x[j]
-    x2 = x[k]
-    x3 = x[l]
-
-    # v0 = v[i]
-    # v1 = v[j]
-    # v2 = v[k]
-    # v3 = v[l]
-
-    w0 = inv_mass[i]
-    w1 = inv_mass[j]
-    w2 = inv_mass[k]
-    w3 = inv_mass[l]
-
-    x10 = x1 - x0
-    x20 = x2 - x0
-    x30 = x3 - x0
-
-    Ds = wp.matrix_from_cols(x10, x20, x30)
-    Dm = rest_matrix[tid]
-    inv_QT = wp.transpose(Dm)
-
-    inv_rest_volume = wp.determinant(Dm) * 6.0
-
-    # F = Xs*Xm^-1
-    F = Ds * Dm
-
-    f1 = wp.vec3(F[0, 0], F[1, 0], F[2, 0])
-    f2 = wp.vec3(F[0, 1], F[1, 1], F[2, 1])
-    f3 = wp.vec3(F[0, 2], F[1, 2], F[2, 2])
-
-    tr = wp.dot(f1, f1) + wp.dot(f2, f2) + wp.dot(f3, f3)
-
-    C = float(0.0)
-    dC = wp.mat33(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
-    compliance = float(0.0)
-
-    stretching_compliance = relaxation
-    volume_compliance = relaxation
-
-    num_terms = 2
-    for term in range(0, num_terms):
-        if term == 0:
-            # deviatoric, stable
-            C = tr - 3.0
-            dC = F * 2.0
-            compliance = stretching_compliance
-        elif term == 1:
-            # volume conservation
-            C = wp.determinant(F) - 1.0
-            dC = wp.matrix_from_cols(wp.cross(f2, f3), wp.cross(f3, f1), wp.cross(f1, f2))
-            compliance = volume_compliance
-
-        if C != 0.0:
-            dP = dC * inv_QT
-            grad1 = wp.vec3(dP[0][0], dP[1][0], dP[2][0])
-            grad2 = wp.vec3(dP[0][1], dP[1][1], dP[2][1])
-            grad3 = wp.vec3(dP[0][2], dP[1][2], dP[2][2])
-            grad0 = -grad1 - grad2 - grad3
-
-            w = (
-                wp.dot(grad0, grad0) * w0
-                + wp.dot(grad1, grad1) * w1
-                + wp.dot(grad2, grad2) * w2
-                + wp.dot(grad3, grad3) * w3
-            )
-
-            if w > 0.0:
-                alpha = compliance / dt / dt
-                if inv_rest_volume > 0.0:
-                    alpha *= inv_rest_volume
-                dlambda = -C / (w + alpha)
-
-                wp.atomic_add(delta, i, w0 * dlambda * grad0)
-                wp.atomic_add(delta, j, w1 * dlambda * grad1)
-                wp.atomic_add(delta, k, w2 * dlambda * grad2)
-                wp.atomic_add(delta, l, w3 * dlambda * grad3)
-                # wp.atomic_add(particle.num_corr, id0, 1)
-                # wp.atomic_add(particle.num_corr, id1, 1)
-                # wp.atomic_add(particle.num_corr, id2, 1)
-                # wp.atomic_add(particle.num_corr, id3, 1)
-
-    # C_Spherical
-    # r_s = wp.sqrt(wp.dot(f1, f1) + wp.dot(f2, f2) + wp.dot(f3, f3))
-    # r_s_inv = 1.0/r_s
-    # C = r_s - wp.sqrt(3.0)
-    # dCdx = F*wp.transpose(Dm)*r_s_inv
-    # alpha = 1.0
-
-    # C_D
-    # r_s = wp.sqrt(wp.dot(f1, f1) + wp.dot(f2, f2) + wp.dot(f3, f3))
-    # C = r_s*r_s - 3.0
-    # dCdx = F*wp.transpose(Dm)*2.0
-    # alpha = 1.0
-
-    # grad1 = wp.vec3(dCdx[0, 0], dCdx[1, 0], dCdx[2, 0])
-    # grad2 = wp.vec3(dCdx[0, 1], dCdx[1, 1], dCdx[2, 1])
-    # grad3 = wp.vec3(dCdx[0, 2], dCdx[1, 2], dCdx[2, 2])
-    # grad0 = (grad1 + grad2 + grad3) * (0.0 - 1.0)
-
-    # denom = (
-    #     wp.dot(grad0, grad0) * w0 + wp.dot(grad1, grad1) * w1 + wp.dot(grad2, grad2) * w2 + wp.dot(grad3, grad3) * w3
-    # )
-    # multiplier = C / (denom + 1.0 / (k_mu * dt * dt * rest_volume))
-
-    # delta0 = grad0 * multiplier
-    # delta1 = grad1 * multiplier
-    # delta2 = grad2 * multiplier
-    # delta3 = grad3 * multiplier
-
-    # # hydrostatic part
-    # J = wp.determinant(F)
-
-    # C_vol = J - alpha
-    # # dCdx = wp.matrix_from_cols(wp.cross(f2, f3), wp.cross(f3, f1), wp.cross(f1, f2))*wp.transpose(Dm)
-
-    # # grad1 = wp.vec3(dCdx[0,0], dCdx[1,0], dCdx[2,0])
-    # # grad2 = wp.vec3(dCdx[0,1], dCdx[1,1], dCdx[2,1])
-    # # grad3 = wp.vec3(dCdx[0,2], dCdx[1,2], dCdx[2,2])
-    # # grad0 = (grad1 + grad2 + grad3)*(0.0 - 1.0)
-
-    # s = inv_rest_volume / 6.0
-    # grad1 = wp.cross(x20, x30) * s
-    # grad2 = wp.cross(x30, x10) * s
-    # grad3 = wp.cross(x10, x20) * s
-    # grad0 = -(grad1 + grad2 + grad3)
-
-    # denom = (
-    #     wp.dot(grad0, grad0) * w0 + wp.dot(grad1, grad1) * w1 + wp.dot(grad2, grad2) * w2 + wp.dot(grad3, grad3) * w3
-    # )
-    # multiplier = C_vol / (denom + 1.0 / (k_lambda * dt * dt * rest_volume))
-
-    # delta0 += grad0 * multiplier
-    # delta1 += grad1 * multiplier
-    # delta2 += grad2 * multiplier
-    # delta3 += grad3 * multiplier
-
-    # # # apply forces
-    # # wp.atomic_sub(delta, i, delta0 * w0 * relaxation)
-    # # wp.atomic_sub(delta, j, delta1 * w1 * relaxation)
-    # # wp.atomic_sub(delta, k, delta2 * w2 * relaxation)
-    # # wp.atomic_sub(delta, l, delta3 * w3 * relaxation)
-
-
-@wp.kernel
-def solve_tetrahedra2(
-    x: wp.array(dtype=wp.vec3),
-    v: wp.array(dtype=wp.vec3),
-    inv_mass: wp.array(dtype=float),
-    indices: wp.array(dtype=int, ndim=2),
-    pose: wp.array(dtype=wp.mat33),
-    activation: wp.array(dtype=float),
-    materials: wp.array(dtype=float, ndim=2),
-    dt: float,
-    relaxation: float,
-    delta: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-
-    i = indices[tid, 0]
-    j = indices[tid, 1]
-    k = indices[tid, 2]
-    l = indices[tid, 3]
-
-    # act = activation[tid]
-
-    k_mu = materials[tid, 0]
-    k_lambda = materials[tid, 1]
-    # k_damp = materials[tid, 2]
-
-    x0 = x[i]
-    x1 = x[j]
-    x2 = x[k]
-    x3 = x[l]
-
-    # v0 = v[i]
-    # v1 = v[j]
-    # v2 = v[k]
-    # v3 = v[l]
-
-    w0 = inv_mass[i]
-    w1 = inv_mass[j]
-    w2 = inv_mass[k]
-    w3 = inv_mass[l]
-
-    x10 = x1 - x0
-    x20 = x2 - x0
-    x30 = x3 - x0
-
-    Ds = wp.matrix_from_cols(x10, x20, x30)
-    Dm = pose[tid]
-
-    inv_rest_volume = wp.determinant(Dm) * 6.0
-    rest_volume = 1.0 / inv_rest_volume
-
-    # F = Xs*Xm^-1
-    F = Ds * Dm
-
-    f1 = wp.vec3(F[0, 0], F[1, 0], F[2, 0])
-    f2 = wp.vec3(F[0, 1], F[1, 1], F[2, 1])
-    f3 = wp.vec3(F[0, 2], F[1, 2], F[2, 2])
-
-    # C_sqrt
-    # tr = wp.dot(f1, f1) + wp.dot(f2, f2) + wp.dot(f3, f3)
-    # r_s = wp.sqrt(abs(tr - 3.0))
-    # C = r_s
-
-    # if (r_s == 0.0):
-    #     return
-
-    # if (tr < 3.0):
-    #     r_s = 0.0 - r_s
-
-    # dCdx = F*wp.transpose(Dm)*(1.0/r_s)
-    # alpha = 1.0 + k_mu / k_lambda
-
-    # C_Neo
-    r_s = wp.sqrt(wp.dot(f1, f1) + wp.dot(f2, f2) + wp.dot(f3, f3))
-    if r_s == 0.0:
-        return
-    # tr = wp.dot(f1, f1) + wp.dot(f2, f2) + wp.dot(f3, f3)
-    # if (tr < 3.0):
-    #     r_s = -r_s
-    r_s_inv = 1.0 / r_s
-    C = r_s
-    dCdx = F * wp.transpose(Dm) * r_s_inv
-    alpha = 1.0 + k_mu / k_lambda
-
-    # C_Spherical
-    # r_s = wp.sqrt(wp.dot(f1, f1) + wp.dot(f2, f2) + wp.dot(f3, f3))
-    # r_s_inv = 1.0/r_s
-    # C = r_s - wp.sqrt(3.0)
-    # dCdx = F*wp.transpose(Dm)*r_s_inv
-    # alpha = 1.0
-
-    # C_D
-    # r_s = wp.sqrt(wp.dot(f1, f1) + wp.dot(f2, f2) + wp.dot(f3, f3))
-    # C = r_s*r_s - 3.0
-    # dCdx = F*wp.transpose(Dm)*2.0
-    # alpha = 1.0
-
-    grad1 = wp.vec3(dCdx[0, 0], dCdx[1, 0], dCdx[2, 0])
-    grad2 = wp.vec3(dCdx[0, 1], dCdx[1, 1], dCdx[2, 1])
-    grad3 = wp.vec3(dCdx[0, 2], dCdx[1, 2], dCdx[2, 2])
-    grad0 = (grad1 + grad2 + grad3) * (0.0 - 1.0)
-
-    denom = (
-        wp.dot(grad0, grad0) * w0 + wp.dot(grad1, grad1) * w1 + wp.dot(grad2, grad2) * w2 + wp.dot(grad3, grad3) * w3
-    )
-    multiplier = C / (denom + 1.0 / (k_mu * dt * dt * rest_volume))
-
-    delta0 = grad0 * multiplier
-    delta1 = grad1 * multiplier
-    delta2 = grad2 * multiplier
-    delta3 = grad3 * multiplier
-
-    # hydrostatic part
-    J = wp.determinant(F)
-
-    C_vol = J - alpha
-    # dCdx = wp.matrix_from_cols(wp.cross(f2, f3), wp.cross(f3, f1), wp.cross(f1, f2))*wp.transpose(Dm)
-
-    # grad1 = wp.vec3(dCdx[0,0], dCdx[1,0], dCdx[2,0])
-    # grad2 = wp.vec3(dCdx[0,1], dCdx[1,1], dCdx[2,1])
-    # grad3 = wp.vec3(dCdx[0,2], dCdx[1,2], dCdx[2,2])
-    # grad0 = (grad1 + grad2 + grad3)*(0.0 - 1.0)
-
-    s = inv_rest_volume / 6.0
-    grad1 = wp.cross(x20, x30) * s
-    grad2 = wp.cross(x30, x10) * s
-    grad3 = wp.cross(x10, x20) * s
-    grad0 = -(grad1 + grad2 + grad3)
-
-    denom = (
-        wp.dot(grad0, grad0) * w0 + wp.dot(grad1, grad1) * w1 + wp.dot(grad2, grad2) * w2 + wp.dot(grad3, grad3) * w3
-    )
-    multiplier = C_vol / (denom + 1.0 / (k_lambda * dt * dt * rest_volume))
-
-    delta0 += grad0 * multiplier
-    delta1 += grad1 * multiplier
-    delta2 += grad2 * multiplier
-    delta3 += grad3 * multiplier
-
-    # apply forces
-    wp.atomic_sub(delta, i, delta0 * w0 * relaxation)
-    wp.atomic_sub(delta, j, delta1 * w1 * relaxation)
-    wp.atomic_sub(delta, k, delta2 * w2 * relaxation)
-    wp.atomic_sub(delta, l, delta3 * w3 * relaxation)
-
-
-@wp.kernel
-def apply_particle_deltas(
-    x_orig: wp.array(dtype=wp.vec3),
-    x_pred: wp.array(dtype=wp.vec3),
-    particle_flags: wp.array(dtype=wp.uint32),
-    delta: wp.array(dtype=wp.vec3),
-    dt: float,
-    v_max: float,
-    x_out: wp.array(dtype=wp.vec3),
-    v_out: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-    if (particle_flags[tid] & PARTICLE_FLAG_ACTIVE) == 0:
-        return
-
-    x0 = x_orig[tid]
-    xp = x_pred[tid]
-
-    # constraint deltas
-    d = delta[tid]
-
-    x_new = xp + d
-    v_new = (x_new - x0) / dt
-
-    # enforce velocity limit to prevent instability
-    v_new_mag = wp.length(v_new)
-    if v_new_mag > v_max:
-        v_new *= v_max / v_new_mag
-
-    x_out[tid] = x_new
-    v_out[tid] = v_new
-
-
-@wp.kernel
-def apply_body_deltas(
-    q_in: wp.array(dtype=wp.transform),
-    qd_in: wp.array(dtype=wp.spatial_vector),
-    body_com: wp.array(dtype=wp.vec3),
-    body_I: wp.array(dtype=wp.mat33),
-    body_inv_m: wp.array(dtype=float),
-    body_inv_I: wp.array(dtype=wp.mat33),
-    deltas: wp.array(dtype=wp.spatial_vector),
-    constraint_inv_weights: wp.array(dtype=float),
-    dt: float,
-    # outputs
-    q_out: wp.array(dtype=wp.transform),
-    qd_out: wp.array(dtype=wp.spatial_vector),
-):
-    tid = wp.tid()
-    inv_m = body_inv_m[tid]
-    if inv_m == 0.0:
-        q_out[tid] = q_in[tid]
-        qd_out[tid] = qd_in[tid]
-        return
-    inv_I = body_inv_I[tid]
-
-    tf = q_in[tid]
-    delta = deltas[tid]
-
-    p0 = wp.transform_get_translation(tf)
-    q0 = wp.transform_get_rotation(tf)
-
-    weight = 1.0
-    if constraint_inv_weights:
-        inv_weight = constraint_inv_weights[tid]
-        if inv_weight > 0.0:
-            weight = 1.0 / inv_weight
-
-    dp = wp.spatial_bottom(delta) * (inv_m * weight)
-    dq = wp.spatial_top(delta) * weight
-    dq = wp.quat_rotate(q0, inv_I * wp.quat_rotate_inv(q0, dq))
-
-    # update orientation
-    q1 = q0 + 0.5 * wp.quat(dq * dt, 0.0) * q0
-    q1 = wp.normalize(q1)
-
-    # update position
-    com = body_com[tid]
-    x_com = p0 + wp.quat_rotate(q0, com)
-    p1 = x_com + dp * dt
-    p1 -= wp.quat_rotate(q1, com)
-
-    q_out[tid] = wp.transform(p1, q1)
-
-    v0 = wp.spatial_bottom(qd_in[tid])
-    w0 = wp.spatial_top(qd_in[tid])
-
-    # update linear and angular velocity
-    v1 = v0 + dp
-    # angular part (compute in body frame)
-    wb = wp.quat_rotate_inv(q0, w0 + dq)
-    tb = -wp.cross(wb, body_I[tid] * wb)  # coriolis forces
-    w1 = wp.quat_rotate(q0, wb + inv_I * tb * dt)
-
-    # XXX this improves gradient stability
-    if wp.length(v1) < 1e-4:
-        v1 = wp.vec3(0.0)
-    if wp.length(w1) < 1e-4:
-        w1 = wp.vec3(0.0)
-
-    qd_out[tid] = wp.spatial_vector(w1, v1)
-
-
-@wp.kernel
-def apply_body_delta_velocities(
-    deltas: wp.array(dtype=wp.spatial_vector),
-    qd_out: wp.array(dtype=wp.spatial_vector),
-):
-    tid = wp.tid()
-    wp.atomic_add(qd_out, tid, deltas[tid])
-
-
-@wp.kernel
-def apply_joint_actions(
-    body_q: wp.array(dtype=wp.transform),
-    body_com: wp.array(dtype=wp.vec3),
-    joint_type: wp.array(dtype=int),
-    joint_parent: wp.array(dtype=int),
-    joint_child: wp.array(dtype=int),
-    joint_X_p: wp.array(dtype=wp.transform),
-    joint_X_c: wp.array(dtype=wp.transform),
-    joint_axis_start: wp.array(dtype=int),
-    joint_axis_dim: wp.array(dtype=int, ndim=2),
-    joint_axis: wp.array(dtype=wp.vec3),
-    joint_axis_mode: wp.array(dtype=int),
-    joint_act: wp.array(dtype=float),
-    body_f: wp.array(dtype=wp.spatial_vector),
-):
-    tid = wp.tid()
-    type = joint_type[tid]
-    if type == wp.sim.JOINT_FIXED:
-        return
-    if type == wp.sim.JOINT_FREE:
-        return
-    if type == wp.sim.JOINT_DISTANCE:
-        return
-    if type == wp.sim.JOINT_BALL:
-        return
-
-    # rigid body indices of the child and parent
-    id_c = joint_child[tid]
-    id_p = joint_parent[tid]
-
-    X_pj = joint_X_p[tid]
-    # X_cj = joint_X_c[tid]
-
-    X_wp = X_pj
-    pose_p = X_pj
-    com_p = wp.vec3(0.0)
-    # parent transform and moment arm
-    if id_p >= 0:
-        pose_p = body_q[id_p]
-        X_wp = pose_p * X_wp
-        com_p = body_com[id_p]
-    r_p = wp.transform_get_translation(X_wp) - wp.transform_point(pose_p, com_p)
-
-    # child transform and moment arm
-    pose_c = body_q[id_c]
-    X_wc = pose_c
-    com_c = body_com[id_c]
-    r_c = wp.transform_get_translation(X_wc) - wp.transform_point(pose_c, com_c)
-
-    # # local joint rotations
-    # q_p = wp.transform_get_rotation(X_wp)
-    # q_c = wp.transform_get_rotation(X_wc)
-
-    # joint properties (for 1D joints)
-    axis_start = joint_axis_start[tid]
-    lin_axis_count = joint_axis_dim[tid, 0]
-    ang_axis_count = joint_axis_dim[tid, 1]
-
-    # total force/torque on the parent
-    t_total = wp.vec3()
-    f_total = wp.vec3()
-
-    # handle angular constraints
-    if type == wp.sim.JOINT_REVOLUTE:
-        mode = joint_axis_mode[axis_start]
-        if mode == wp.sim.JOINT_MODE_FORCE:
-            axis = joint_axis[axis_start]
-            act = joint_act[axis_start]
-            a_p = wp.transform_vector(X_wp, axis)
-            t_total += act * a_p
-    elif type == wp.sim.JOINT_PRISMATIC:
-        mode = joint_axis_mode[axis_start]
-        if mode == wp.sim.JOINT_MODE_FORCE:
-            axis = joint_axis[axis_start]
-            act = joint_act[axis_start]
-            a_p = wp.transform_vector(X_wp, axis)
-            f_total += act * a_p
-    elif type == wp.sim.JOINT_COMPOUND:
-        # q_off = wp.transform_get_rotation(X_cj)
-        # q_pc = wp.quat_inverse(q_off)*wp.quat_inverse(q_p)*q_c*q_off
-        # # decompose to a compound rotation each axis
-        # angles = quat_decompose(q_pc)
-
-        # # reconstruct rotation axes
-        # axis_0 = wp.vec3(1.0, 0.0, 0.0)
-        # q_0 = wp.quat_from_axis_angle(axis_0, angles[0])
-
-        # axis_1 = wp.quat_rotate(q_0, wp.vec3(0.0, 1.0, 0.0))
-        # q_1 = wp.quat_from_axis_angle(axis_1, angles[1])
-
-        # axis_2 = wp.quat_rotate(q_1*q_0, wp.vec3(0.0, 0.0, 1.0))
-
-        # q_w = q_p*q_off
-        # t_total += joint_act[qd_start+0] * wp.quat_rotate(q_w, axis_0)
-        # t_total += joint_act[qd_start+1] * wp.quat_rotate(q_w, axis_1)
-        # t_total += joint_act[qd_start+2] * wp.quat_rotate(q_w, axis_2)
-
-        if joint_axis_mode[axis_start + 0] == wp.sim.JOINT_MODE_FORCE:
-            axis_0 = joint_axis[axis_start + 0]
-            t_total += joint_act[axis_start + 0] * wp.transform_vector(X_wp, axis_0)
-        if joint_axis_mode[axis_start + 1] == wp.sim.JOINT_MODE_FORCE:
-            axis_1 = joint_axis[axis_start + 1]
-            t_total += joint_act[axis_start + 1] * wp.transform_vector(X_wp, axis_1)
-        if joint_axis_mode[axis_start + 2] == wp.sim.JOINT_MODE_FORCE:
-            axis_2 = joint_axis[axis_start + 2]
-            t_total += joint_act[axis_start + 2] * wp.transform_vector(X_wp, axis_2)
-
-    elif type == wp.sim.JOINT_UNIVERSAL:
-        # q_off = wp.transform_get_rotation(X_cj)
-        # q_pc = wp.quat_inverse(q_off)*wp.quat_inverse(q_p)*q_c*q_off
-
-        # # decompose to a compound rotation each axis
-        # angles = quat_decompose(q_pc)
-
-        # # reconstruct rotation axes
-        # axis_0 = wp.vec3(1.0, 0.0, 0.0)
-        # q_0 = wp.quat_from_axis_angle(axis_0, angles[0])
-
-        # axis_1 = wp.quat_rotate(q_0, wp.vec3(0.0, 1.0, 0.0))
-        # q_1 = wp.quat_from_axis_angle(axis_1, angles[1])
-
-        # axis_2 = wp.quat_rotate(q_1*q_0, wp.vec3(0.0, 0.0, 1.0))
-
-        # q_w = q_p*q_off
-
-        # free axes
-        # t_total += joint_act[qd_start+0] * wp.quat_rotate(q_w, axis_0)
-        # t_total += joint_act[qd_start+1] * wp.quat_rotate(q_w, axis_1)
-
-        if joint_axis_mode[axis_start + 0] == wp.sim.JOINT_MODE_FORCE:
-            axis_0 = joint_axis[axis_start + 0]
-            t_total += joint_act[axis_start + 0] * wp.transform_vector(X_wp, axis_0)
-        if joint_axis_mode[axis_start + 1] == wp.sim.JOINT_MODE_FORCE:
-            axis_1 = joint_axis[axis_start + 1]
-            t_total += joint_act[axis_start + 1] * wp.transform_vector(X_wp, axis_1)
-
-    elif type == wp.sim.JOINT_D6:
-        # unroll for loop to ensure joint actions remain differentiable
-        # (since differentiating through a dynamic for loop that updates a local variable is not supported)
-
-        if lin_axis_count > 0:
-            if joint_axis_mode[axis_start + 0] == wp.sim.JOINT_MODE_FORCE:
-                axis = joint_axis[axis_start + 0]
-                act = joint_act[axis_start + 0]
-                a_p = wp.transform_vector(X_wp, axis)
-                f_total += act * a_p
-        if lin_axis_count > 1:
-            if joint_axis_mode[axis_start + 1] == wp.sim.JOINT_MODE_FORCE:
-                axis = joint_axis[axis_start + 1]
-                act = joint_act[axis_start + 1]
-                a_p = wp.transform_vector(X_wp, axis)
-                f_total += act * a_p
-        if lin_axis_count > 2:
-            if joint_axis_mode[axis_start + 2] == wp.sim.JOINT_MODE_FORCE:
-                axis = joint_axis[axis_start + 2]
-                act = joint_act[axis_start + 2]
-                a_p = wp.transform_vector(X_wp, axis)
-                f_total += act * a_p
-
-        if ang_axis_count > 0:
-            if joint_axis_mode[axis_start + lin_axis_count + 0] == wp.sim.JOINT_MODE_FORCE:
-                axis = joint_axis[axis_start + lin_axis_count + 0]
-                act = joint_act[axis_start + lin_axis_count + 0]
-                a_p = wp.transform_vector(X_wp, axis)
-                t_total += act * a_p
-        if ang_axis_count > 1:
-            if joint_axis_mode[axis_start + lin_axis_count + 1] == wp.sim.JOINT_MODE_FORCE:
-                axis = joint_axis[axis_start + lin_axis_count + 1]
-                act = joint_act[axis_start + lin_axis_count + 1]
-                a_p = wp.transform_vector(X_wp, axis)
-                t_total += act * a_p
-        if ang_axis_count > 2:
-            if joint_axis_mode[axis_start + lin_axis_count + 2] == wp.sim.JOINT_MODE_FORCE:
-                axis = joint_axis[axis_start + lin_axis_count + 2]
-                act = joint_act[axis_start + lin_axis_count + 2]
-                a_p = wp.transform_vector(X_wp, axis)
-                t_total += act * a_p
-
-    else:
-        print("joint type not handled in apply_joint_actions")
-
-    # write forces
-    if id_p >= 0:
-        wp.atomic_sub(body_f, id_p, wp.spatial_vector(t_total + wp.cross(r_p, f_total), f_total))
-    wp.atomic_add(body_f, id_c, wp.spatial_vector(t_total + wp.cross(r_c, f_total), f_total))
-
-
-@wp.func
-def update_joint_axis_mode(mode: wp.int32, axis: wp.vec3, input_axis_mode: wp.vec3i):
-    # update the 3D axis mode flags given the axis vector and mode of this axis
-    mode_x = wp.max(wp.int32(wp.nonzero(axis[0])) * mode, input_axis_mode[0])
-    mode_y = wp.max(wp.int32(wp.nonzero(axis[1])) * mode, input_axis_mode[1])
-    mode_z = wp.max(wp.int32(wp.nonzero(axis[2])) * mode, input_axis_mode[2])
-    return wp.vec3i(mode_x, mode_y, mode_z)
-
-
-@wp.func
-def update_joint_axis_limits(axis: wp.vec3, limit_lower: float, limit_upper: float, input_limits: wp.spatial_vector):
-    # update the 3D linear/angular limits (spatial_vector [lower, upper]) given the axis vector and limits
-    lo_temp = axis * limit_lower
-    up_temp = axis * limit_upper
-    lo = vec_min(lo_temp, up_temp)
-    up = vec_max(lo_temp, up_temp)
-    input_lower = wp.spatial_top(input_limits)
-    input_upper = wp.spatial_bottom(input_limits)
-    lower = vec_min(input_lower, lo)
-    upper = vec_max(input_upper, up)
-    return wp.spatial_vector(lower, upper)
-
-
-@wp.func
-def update_joint_axis_target_ke_kd(
-    axis: wp.vec3, target: float, target_ke: float, target_kd: float, input_target_ke_kd: wp.mat33
-):
-    # update the 3D linear/angular target, target_ke, and target_kd (mat33 [target, ke, kd]) given the axis vector and target, target_ke, target_kd
-    axis_target = input_target_ke_kd[0]
-    axis_ke = input_target_ke_kd[1]
-    axis_kd = input_target_ke_kd[2]
-    stiffness = axis * target_ke
-    axis_target += stiffness * target  # weighted target (to be normalized later by sum of target_ke)
-    axis_ke += vec_abs(stiffness)
-    axis_kd += vec_abs(axis * target_kd)
-    return wp.mat33(
-        axis_target[0],
-        axis_target[1],
-        axis_target[2],
-        axis_ke[0],
-        axis_ke[1],
-        axis_ke[2],
-        axis_kd[0],
-        axis_kd[1],
-        axis_kd[2],
-    )
-
-
-@wp.func
-def compute_linear_correction_3d(
-    dx: wp.vec3,
-    r1: wp.vec3,
-    r2: wp.vec3,
-    tf1: wp.transform,
-    tf2: wp.transform,
-    m_inv1: float,
-    m_inv2: float,
-    I_inv1: wp.mat33,
-    I_inv2: wp.mat33,
-    lambda_in: float,
-    compliance: float,
-    damping: float,
-    dt: float,
-) -> float:
-    c = wp.length(dx)
-    if c == 0.0:
-        # print("c == 0.0 in positional correction")
-        return 0.0
-
-    n = wp.normalize(dx)
-
-    q1 = wp.transform_get_rotation(tf1)
-    q2 = wp.transform_get_rotation(tf2)
-
-    # Eq. 2-3 (make sure to project into the frame of the body)
-    r1xn = wp.quat_rotate_inv(q1, wp.cross(r1, n))
-    r2xn = wp.quat_rotate_inv(q2, wp.cross(r2, n))
-
-    w1 = m_inv1 + wp.dot(r1xn, I_inv1 * r1xn)
-    w2 = m_inv2 + wp.dot(r2xn, I_inv2 * r2xn)
-    w = w1 + w2
-    if w == 0.0:
-        return 0.0
-    alpha = compliance
-    gamma = compliance * damping
-
-    # Eq. 4-5
-    d_lambda = -c - alpha * lambda_in
-    # TODO consider damping for velocity correction?
-    # delta_lambda = -(err + alpha * lambda_in + gamma * derr)
-    if w + alpha > 0.0:
-        d_lambda /= w * (dt + gamma) + alpha / dt
-
-    return d_lambda
-
-
-@wp.func
-def compute_angular_correction_3d(
-    corr: wp.vec3,
-    q1: wp.quat,
-    q2: wp.quat,
-    m_inv1: float,
-    m_inv2: float,
-    I_inv1: wp.mat33,
-    I_inv2: wp.mat33,
-    alpha_tilde: float,
-    # lambda_prev: float,
-    relaxation: float,
-    dt: float,
-):
-    # compute and apply the correction impulse for an angular constraint
-    theta = wp.length(corr)
-    if theta == 0.0:
-        return 0.0
-
-    n = wp.normalize(corr)
-
-    # project variables to body rest frame as they are in local matrix
-    n1 = wp.quat_rotate_inv(q1, n)
-    n2 = wp.quat_rotate_inv(q2, n)
-
-    # Eq. 11-12
-    w1 = wp.dot(n1, I_inv1 * n1)
-    w2 = wp.dot(n2, I_inv2 * n2)
-    w = w1 + w2
-    if w == 0.0:
-        return 0.0
-
-    # Eq. 13-14
-    lambda_prev = 0.0
-    d_lambda = (-theta - alpha_tilde * lambda_prev) / (w * dt + alpha_tilde / dt)
-    # TODO consider lambda_prev?
-    # p = d_lambda * n * relaxation
-
-    # Eq. 15-16
-    return d_lambda
-
-
-@wp.kernel
-def solve_simple_body_joints(
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-    body_com: wp.array(dtype=wp.vec3),
-    body_inv_m: wp.array(dtype=float),
-    body_inv_I: wp.array(dtype=wp.mat33),
-    joint_type: wp.array(dtype=int),
-    joint_enabled: wp.array(dtype=int),
-    joint_parent: wp.array(dtype=int),
-    joint_child: wp.array(dtype=int),
-    joint_X_p: wp.array(dtype=wp.transform),
-    joint_X_c: wp.array(dtype=wp.transform),
-    joint_limit_lower: wp.array(dtype=float),
-    joint_limit_upper: wp.array(dtype=float),
-    joint_axis_start: wp.array(dtype=int),
-    joint_axis_dim: wp.array(dtype=int, ndim=2),
-    joint_axis_mode: wp.array(dtype=int),
-    joint_axis: wp.array(dtype=wp.vec3),
-    joint_target: wp.array(dtype=float),
-    joint_target_ke: wp.array(dtype=float),
-    joint_target_kd: wp.array(dtype=float),
-    joint_linear_compliance: wp.array(dtype=float),
-    joint_angular_compliance: wp.array(dtype=float),
-    angular_relaxation: float,
-    linear_relaxation: float,
-    dt: float,
-    deltas: wp.array(dtype=wp.spatial_vector),
-):
-    tid = wp.tid()
-    type = joint_type[tid]
-
-    if joint_enabled[tid] == 0:
-        return
-    if type == wp.sim.JOINT_FREE:
-        return
-    if type == wp.sim.JOINT_COMPOUND:
-        return
-    if type == wp.sim.JOINT_UNIVERSAL:
-        return
-    if type == wp.sim.JOINT_DISTANCE:
-        return
-    if type == wp.sim.JOINT_D6:
-        return
-
-    # rigid body indices of the child and parent
-    id_c = joint_child[tid]
-    id_p = joint_parent[tid]
-
-    X_pj = joint_X_p[tid]
-    X_cj = joint_X_c[tid]
-
-    X_wp = X_pj
-    m_inv_p = 0.0
-    I_inv_p = wp.mat33(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
-    pose_p = X_pj
-    com_p = wp.vec3(0.0)
-    # parent transform and moment arm
-    if id_p >= 0:
-        pose_p = body_q[id_p]
-        X_wp = pose_p * X_wp
-        com_p = body_com[id_p]
-        m_inv_p = body_inv_m[id_p]
-        I_inv_p = body_inv_I[id_p]
-    r_p = wp.transform_get_translation(X_wp) - wp.transform_point(pose_p, com_p)
-
-    # child transform and moment arm
-    pose_c = body_q[id_c]
-    X_wc = pose_c * X_cj
-    com_c = body_com[id_c]
-    m_inv_c = body_inv_m[id_c]
-    I_inv_c = body_inv_I[id_c]
-    r_c = wp.transform_get_translation(X_wc) - wp.transform_point(pose_c, com_c)
-
-    if m_inv_p == 0.0 and m_inv_c == 0.0:
-        # connection between two immovable bodies
-        return
-
-    # accumulate constraint deltas
-    lin_delta_p = wp.vec3(0.0)
-    ang_delta_p = wp.vec3(0.0)
-    lin_delta_c = wp.vec3(0.0)
-    ang_delta_c = wp.vec3(0.0)
-
-    # rel_pose = wp.transform_inverse(X_wp) * X_wc
-    # rel_p = wp.transform_get_translation(rel_pose)
-
-    # joint connection points
-    # x_p = wp.transform_get_translation(X_wp)
-    x_c = wp.transform_get_translation(X_wc)
-
-    # linear_compliance = joint_linear_compliance[tid]
-    angular_compliance = joint_angular_compliance[tid]
-    damping = 0.0
-
-    axis_start = joint_axis_start[tid]
-    # mode = joint_axis_mode[axis_start]
-
-    # local joint rotations
-    q_p = wp.transform_get_rotation(X_wp)
-    q_c = wp.transform_get_rotation(X_wc)
-    inertial_q_p = wp.transform_get_rotation(pose_p)
-    inertial_q_c = wp.transform_get_rotation(pose_c)
-
-    # joint properties (for 1D joints)
-    axis = joint_axis[axis_start]
-
-    if type == wp.sim.JOINT_FIXED:
-        limit_lower = 0.0
-        limit_upper = 0.0
-    else:
-        limit_lower = joint_limit_lower[axis_start]
-        limit_upper = joint_limit_upper[axis_start]
-
-    # linear_alpha_tilde = linear_compliance / dt / dt
-    angular_alpha_tilde = angular_compliance / dt / dt
-
-    # prevent division by zero
-    # linear_alpha_tilde = wp.max(linear_alpha_tilde, 1e-6)
-    # angular_alpha_tilde = wp.max(angular_alpha_tilde, 1e-6)
-
-    # accumulate constraint deltas
-    lin_delta_p = wp.vec3(0.0)
-    ang_delta_p = wp.vec3(0.0)
-    lin_delta_c = wp.vec3(0.0)
-    ang_delta_c = wp.vec3(0.0)
-
-    # handle angular constraints
-    if type == wp.sim.JOINT_REVOLUTE:
-        # align joint axes
-        a_p = wp.quat_rotate(q_p, axis)
-        a_c = wp.quat_rotate(q_c, axis)
-        # Eq. 20
-        corr = wp.cross(a_p, a_c)
-        ncorr = wp.normalize(corr)
-
-        angular_relaxation = 0.2
-        # angular_correction(
-        #     corr, inertial_q_p, inertial_q_c, m_inv_p, m_inv_c, I_inv_p, I_inv_c,
-        #     angular_alpha_tilde, angular_relaxation, deltas, id_p, id_c)
-        lambda_n = compute_angular_correction_3d(
-            corr, inertial_q_p, inertial_q_c, m_inv_p, m_inv_c, I_inv_p, I_inv_c, angular_alpha_tilde, damping, dt
-        )
-        lambda_n *= angular_relaxation
-        ang_delta_p -= lambda_n * ncorr
-        ang_delta_c += lambda_n * ncorr
-
-        # limit joint angles (Alg. 3)
-        pi = 3.14159265359
-        two_pi = 2.0 * pi
-        if limit_lower > -two_pi or limit_upper < two_pi:
-            # find a perpendicular vector to joint axis
-            a = axis
-            # https://math.stackexchange.com/a/3582461
-            g = wp.sign(a[2])
-            h = a[2] + g
-            b = wp.vec3(g - a[0] * a[0] / h, -a[0] * a[1] / h, -a[0])
-            c = wp.normalize(wp.cross(a, b))
-            # b = c  # TODO verify
-
-            # joint axis
-            n = wp.quat_rotate(q_p, a)
-            # the axes n1 and n2 are aligned with the two bodies
-            n1 = wp.quat_rotate(q_p, b)
-            n2 = wp.quat_rotate(q_c, b)
-
-            phi = wp.asin(wp.dot(wp.cross(n1, n2), n))
-            # print("phi")
-            # print(phi)
-            if wp.dot(n1, n2) < 0.0:
-                phi = pi - phi
-            if phi > pi:
-                phi -= two_pi
-            if phi < -pi:
-                phi += two_pi
-            if phi < limit_lower or phi > limit_upper:
-                phi = wp.clamp(phi, limit_lower, limit_upper)
-                # print("clamped phi")
-                # print(phi)
-                # rot = wp.quat(phi, n[0], n[1], n[2])
-                # rot = wp.quat(n, phi)
-                rot = wp.quat_from_axis_angle(n, phi)
-                n1 = wp.quat_rotate(rot, n1)
-                corr = wp.cross(n1, n2)
-                # print("corr")
-                # print(corr)
-                # TODO expose
-                # angular_alpha_tilde = 0.0001 / dt / dt
-                # angular_relaxation = 0.5
-                # TODO fix this constraint
-                # angular_correction(
-                #     corr, inertial_q_p, inertial_q_c, m_inv_p, m_inv_c, I_inv_p, I_inv_c,
-                #     angular_alpha_tilde, angular_relaxation, deltas, id_p, id_c)
-                lambda_n = compute_angular_correction_3d(
-                    corr,
-                    inertial_q_p,
-                    inertial_q_c,
-                    m_inv_p,
-                    m_inv_c,
-                    I_inv_p,
-                    I_inv_c,
-                    angular_alpha_tilde,
-                    damping,
-                    dt,
-                )
-                lambda_n *= angular_relaxation
-                ncorr = wp.normalize(corr)
-                ang_delta_p -= lambda_n * ncorr
-                ang_delta_c += lambda_n * ncorr
-
-        # handle joint targets
-        target_ke = joint_target_ke[axis_start]
-        # target_kd = joint_target_kd[axis_start]
-        target = joint_target[axis_start]
-        if target_ke > 0.0:
-            # find a perpendicular vector to joint axis
-            a = axis
-            # https://math.stackexchange.com/a/3582461
-            g = wp.sign(a[2])
-            h = a[2] + g
-            b = wp.vec3(g - a[0] * a[0] / h, -a[0] * a[1] / h, -a[0])
-            c = wp.normalize(wp.cross(a, b))
-            b = c
-
-            q = wp.quat_from_axis_angle(a_p, target)
-            b_target = wp.quat_rotate(q, wp.quat_rotate(q_p, b))
-            b2 = wp.quat_rotate(q_c, b)
-            # Eq. 21
-            d_target = wp.cross(b_target, b2)
-
-            target_compliance = 1.0 / target_ke  # / dt / dt
-            # angular_correction(
-            #     d_target, inertial_q_p, inertial_q_c, m_inv_p, m_inv_c, I_inv_p, I_inv_c,
-            #     target_compliance, angular_relaxation, deltas, id_p, id_c)
-            lambda_n = compute_angular_correction_3d(
-                d_target, inertial_q_p, inertial_q_c, m_inv_p, m_inv_c, I_inv_p, I_inv_c, target_compliance, damping, dt
-            )
-            lambda_n *= angular_relaxation
-            ncorr = wp.normalize(d_target)
-            # TODO fix
-            ang_delta_p -= lambda_n * ncorr
-            ang_delta_c += lambda_n * ncorr
-
-    if (type == wp.sim.JOINT_FIXED) or (type == wp.sim.JOINT_PRISMATIC):
-        # align the mutual orientations of the two bodies
-        # Eq. 18-19
-        q = q_p * wp.quat_inverse(q_c)
-        corr = -2.0 * wp.vec3(q[0], q[1], q[2])
-        # angular_correction(
-        #     -corr, inertial_q_p, inertial_q_c, m_inv_p, m_inv_c, I_inv_p, I_inv_c,
-        #     angular_alpha_tilde, angular_relaxation, deltas, id_p, id_c)
-        lambda_n = compute_angular_correction_3d(
-            corr, inertial_q_p, inertial_q_c, m_inv_p, m_inv_c, I_inv_p, I_inv_c, angular_alpha_tilde, damping, dt
-        )
-        lambda_n *= angular_relaxation
-        ncorr = wp.normalize(corr)
-        ang_delta_p -= lambda_n * ncorr
-        ang_delta_c += lambda_n * ncorr
-
-    # handle positional constraints
-
-    # joint connection points
-    x_p = wp.transform_get_translation(X_wp)
-    x_c = wp.transform_get_translation(X_wc)
-
-    # compute error between the joint attachment points on both bodies
-    # delta x is the difference of point r_2 minus point r_1 (Fig. 3)
-    dx = x_c - x_p
-
-    # rotate the error vector into the joint frame
-    q_dx = q_p
-    # q_dx = q_c
-    # q_dx = wp.transform_get_rotation(pose_p)
-    dx = wp.quat_rotate_inv(q_dx, dx)
-
-    lower_pos_limits = wp.vec3(0.0)
-    upper_pos_limits = wp.vec3(0.0)
-    if type == wp.sim.JOINT_PRISMATIC:
-        lower_pos_limits = axis * limit_lower
-        upper_pos_limits = axis * limit_upper
-
-    # compute linear constraint violations
-    corr = wp.vec3(0.0)
-    zero = wp.vec3(0.0)
-    corr -= vec_leaky_min(zero, upper_pos_limits - dx)
-    corr -= vec_leaky_max(zero, lower_pos_limits - dx)
-
-    # if (type == wp.sim.JOINT_PRISMATIC):
-    #     if mode == JOINT_MODE_TARGET_POSITION:
-    #         target = wp.clamp(target, limit_lower, limit_upper)
-    #         if target_ke > 0.0:
-    #             err = dx - target * axis
-    #             compliance = 1.0 / target_ke
-    #         damping = axis_damping[dim]
-    #     elif mode == JOINT_MODE_TARGET_VELOCITY:
-    #         if target_ke > 0.0:
-    #             err = (derr - target) * dt
-    #             compliance = 1.0 / target_ke
-    #         damping = axis_damping[dim]
-
-    # rotate correction vector into world frame
-    corr = wp.quat_rotate(q_dx, corr)
-
-    lambda_in = 0.0
-    linear_alpha = joint_linear_compliance[tid]
-    lambda_n = compute_linear_correction_3d(
-        corr, r_p, r_c, pose_p, pose_c, m_inv_p, m_inv_c, I_inv_p, I_inv_c, lambda_in, linear_alpha, damping, dt
-    )
-    lambda_n *= linear_relaxation
-    n = wp.normalize(corr)
-
-    lin_delta_p -= n * lambda_n
-    lin_delta_c += n * lambda_n
-    ang_delta_p -= wp.cross(r_p, n) * lambda_n
-    ang_delta_c += wp.cross(r_c, n) * lambda_n
-
-    if id_p >= 0:
-        wp.atomic_add(deltas, id_p, wp.spatial_vector(ang_delta_p, lin_delta_p))
-    if id_c >= 0:
-        wp.atomic_add(deltas, id_c, wp.spatial_vector(ang_delta_c, lin_delta_c))
-
-
-@wp.kernel
-def solve_body_joints(
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-    body_com: wp.array(dtype=wp.vec3),
-    body_inv_m: wp.array(dtype=float),
-    body_inv_I: wp.array(dtype=wp.mat33),
-    joint_type: wp.array(dtype=int),
-    joint_enabled: wp.array(dtype=int),
-    joint_parent: wp.array(dtype=int),
-    joint_child: wp.array(dtype=int),
-    joint_X_p: wp.array(dtype=wp.transform),
-    joint_X_c: wp.array(dtype=wp.transform),
-    joint_limit_lower: wp.array(dtype=float),
-    joint_limit_upper: wp.array(dtype=float),
-    joint_axis_start: wp.array(dtype=int),
-    joint_axis_dim: wp.array(dtype=int, ndim=2),
-    joint_axis_mode: wp.array(dtype=int),
-    joint_axis: wp.array(dtype=wp.vec3),
-    joint_act: wp.array(dtype=float),
-    joint_target_ke: wp.array(dtype=float),
-    joint_target_kd: wp.array(dtype=float),
-    joint_linear_compliance: wp.array(dtype=float),
-    joint_angular_compliance: wp.array(dtype=float),
-    angular_relaxation: float,
-    linear_relaxation: float,
-    dt: float,
-    deltas: wp.array(dtype=wp.spatial_vector),
-):
-    tid = wp.tid()
-    type = joint_type[tid]
-
-    if joint_enabled[tid] == 0:
-        return
-    if type == wp.sim.JOINT_FREE:
-        return
-    # if type == wp.sim.JOINT_FIXED:
-    #     return
-    # if type == wp.sim.JOINT_REVOLUTE:
-    #     return
-    # if type == wp.sim.JOINT_PRISMATIC:
-    #     return
-    # if type == wp.sim.JOINT_BALL:
-    #     return
-
-    # rigid body indices of the child and parent
-    id_c = joint_child[tid]
-    id_p = joint_parent[tid]
-
-    X_pj = joint_X_p[tid]
-    X_cj = joint_X_c[tid]
-
-    X_wp = X_pj
-    m_inv_p = 0.0
-    I_inv_p = wp.mat33(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
-    pose_p = X_pj
-    com_p = wp.vec3(0.0)
-    vel_p = wp.vec3(0.0)
-    omega_p = wp.vec3(0.0)
-    # parent transform and moment arm
-    if id_p >= 0:
-        pose_p = body_q[id_p]
-        X_wp = pose_p * X_wp
-        com_p = body_com[id_p]
-        m_inv_p = body_inv_m[id_p]
-        I_inv_p = body_inv_I[id_p]
-        vel_p = wp.spatial_bottom(body_qd[id_p])
-        omega_p = wp.spatial_top(body_qd[id_p])
-
-    # child transform and moment arm
-    pose_c = body_q[id_c]
-    X_wc = pose_c * X_cj
-    com_c = body_com[id_c]
-    m_inv_c = body_inv_m[id_c]
-    I_inv_c = body_inv_I[id_c]
-    vel_c = wp.spatial_bottom(body_qd[id_c])
-    omega_c = wp.spatial_top(body_qd[id_c])
-
-    if m_inv_p == 0.0 and m_inv_c == 0.0:
-        # connection between two immovable bodies
-        return
-
-    # accumulate constraint deltas
-    lin_delta_p = wp.vec3(0.0)
-    ang_delta_p = wp.vec3(0.0)
-    lin_delta_c = wp.vec3(0.0)
-    ang_delta_c = wp.vec3(0.0)
-
-    rel_pose = wp.transform_inverse(X_wp) * X_wc
-    rel_p = wp.transform_get_translation(rel_pose)
-
-    # joint connection points
-    # x_p = wp.transform_get_translation(X_wp)
-    x_c = wp.transform_get_translation(X_wc)
-
-    linear_compliance = joint_linear_compliance[tid]
-    angular_compliance = joint_angular_compliance[tid]
-
-    axis_start = joint_axis_start[tid]
-    lin_axis_count = joint_axis_dim[tid, 0]
-    ang_axis_count = joint_axis_dim[tid, 1]
-
-    world_com_p = wp.transform_point(pose_p, com_p)
-    world_com_c = wp.transform_point(pose_c, com_c)
-
-    # handle positional constraints
-    if type == wp.sim.JOINT_DISTANCE:
-        r_p = wp.transform_get_translation(X_wp) - world_com_p
-        r_c = wp.transform_get_translation(X_wc) - world_com_c
-        lower = joint_limit_lower[axis_start]
-        upper = joint_limit_upper[axis_start]
-        if lower < 0.0 and upper < 0.0:
-            # no limits
-            return
-        d = wp.length(rel_p)
-        err = 0.0
-        if lower >= 0.0 and d < lower:
-            err = d - lower
-            # use a more descriptive direction vector for the constraint
-            # in case the joint parent and child anchors are very close
-            rel_p = err * wp.normalize(world_com_c - world_com_p)
-        elif upper >= 0.0 and d > upper:
-            err = d - upper
-
-        if wp.abs(err) > 1e-9:
-            # compute gradients
-            linear_c = rel_p
-            linear_p = -linear_c
-            r_c = x_c - world_com_c
-            angular_p = -wp.cross(r_p, linear_c)
-            angular_c = wp.cross(r_c, linear_c)
-            # constraint time derivative
-            derr = (
-                wp.dot(linear_p, vel_p)
-                + wp.dot(linear_c, vel_c)
-                + wp.dot(angular_p, omega_p)
-                + wp.dot(angular_c, omega_c)
-            )
-            lambda_in = 0.0
-            compliance = linear_compliance
-            ke = joint_target_ke[axis_start]
-            if ke > 0.0:
-                compliance = 1.0 / ke
-            damping = joint_target_kd[axis_start]
-            d_lambda = compute_positional_correction(
-                err,
-                derr,
-                pose_p,
-                pose_c,
-                m_inv_p,
-                m_inv_c,
-                I_inv_p,
-                I_inv_c,
-                linear_p,
-                linear_c,
-                angular_p,
-                angular_c,
-                lambda_in,
-                compliance,
-                damping,
-                dt,
-            )
-
-            lin_delta_p += linear_p * (d_lambda * linear_relaxation)
-            ang_delta_p += angular_p * (d_lambda * angular_relaxation)
-            lin_delta_c += linear_c * (d_lambda * linear_relaxation)
-            ang_delta_c += angular_c * (d_lambda * angular_relaxation)
-
-    else:
-        # compute joint target, stiffness, damping
-        ke_sum = float(0.0)
-        axis_limits = wp.spatial_vector(0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
-        axis_mode = wp.vec3i(0, 0, 0)
-        axis_target_ke_kd = wp.mat33(0.0)
-        # avoid a for loop here since local variables would need to be modified which is not yet differentiable
-        if lin_axis_count > 0:
-            axis = joint_axis[axis_start]
-            lo_temp = axis * joint_limit_lower[axis_start]
-            up_temp = axis * joint_limit_upper[axis_start]
-            axis_limits = wp.spatial_vector(vec_min(lo_temp, up_temp), vec_max(lo_temp, up_temp))
-            mode = joint_axis_mode[axis_start]
-            if mode != JOINT_MODE_FORCE:  # position or velocity target
-                ke = joint_target_ke[axis_start]
-                kd = joint_target_kd[axis_start]
-                target = joint_act[axis_start]
-                axis_mode = update_joint_axis_mode(mode, axis, axis_mode)
-                axis_target_ke_kd = update_joint_axis_target_ke_kd(axis, target, ke, kd, axis_target_ke_kd)
-                ke_sum += ke
-        if lin_axis_count > 1:
-            axis_idx = axis_start + 1
-            axis = joint_axis[axis_idx]
-            lower = joint_limit_lower[axis_idx]
-            upper = joint_limit_upper[axis_idx]
-            axis_limits = update_joint_axis_limits(axis, lower, upper, axis_limits)
-            mode = joint_axis_mode[axis_idx]
-            if mode != JOINT_MODE_FORCE:  # position or velocity target
-                ke = joint_target_ke[axis_idx]
-                kd = joint_target_kd[axis_idx]
-                target = joint_act[axis_idx]
-                axis_mode = update_joint_axis_mode(mode, axis, axis_mode)
-                axis_target_ke_kd = update_joint_axis_target_ke_kd(axis, target, ke, kd, axis_target_ke_kd)
-                ke_sum += ke
-        if lin_axis_count > 2:
-            axis_idx = axis_start + 2
-            axis = joint_axis[axis_idx]
-            lower = joint_limit_lower[axis_idx]
-            upper = joint_limit_upper[axis_idx]
-            axis_limits = update_joint_axis_limits(axis, lower, upper, axis_limits)
-            mode = joint_axis_mode[axis_idx]
-            if mode != JOINT_MODE_FORCE:  # position or velocity target
-                ke = joint_target_ke[axis_idx]
-                kd = joint_target_kd[axis_idx]
-                target = joint_act[axis_idx]
-                axis_mode = update_joint_axis_mode(mode, axis, axis_mode)
-                axis_target_ke_kd = update_joint_axis_target_ke_kd(axis, target, ke, kd, axis_target_ke_kd)
-                ke_sum += ke
-
-        axis_target = axis_target_ke_kd[0]
-        axis_stiffness = axis_target_ke_kd[1]
-        axis_damping = axis_target_ke_kd[2]
-        if ke_sum > 0.0:
-            axis_target /= ke_sum
-        axis_limits_lower = wp.spatial_top(axis_limits)
-        axis_limits_upper = wp.spatial_bottom(axis_limits)
-
-        frame_p = wp.quat_to_matrix(wp.transform_get_rotation(X_wp))
-        # note that x_c appearing in both is correct
-        r_p = x_c - world_com_p
-        r_c = x_c - wp.transform_point(pose_c, com_c)
-
-        # for loop will be unrolled, so we can modify local variables
-        for dim in range(3):
-            e = rel_p[dim]
-            mode = axis_mode[dim]
-
-            # compute gradients
-            linear_c = wp.vec3(frame_p[0, dim], frame_p[1, dim], frame_p[2, dim])
-            linear_p = -linear_c
-            angular_p = -wp.cross(r_p, linear_c)
-            angular_c = wp.cross(r_c, linear_c)
-            # constraint time derivative
-            derr = (
-                wp.dot(linear_p, vel_p)
-                + wp.dot(linear_c, vel_c)
-                + wp.dot(angular_p, omega_p)
-                + wp.dot(angular_c, omega_c)
-            )
-
-            err = 0.0
-            compliance = linear_compliance
-            damping = 0.0
-            # consider joint limits irrespective of axis mode
-            lower = axis_limits_lower[dim]
-            upper = axis_limits_upper[dim]
-            if e < lower:
-                err = e - lower
-            elif e > upper:
-                err = e - upper
-            else:
-                target = axis_target[dim]
-                if mode == JOINT_MODE_TARGET_POSITION:
-                    target = wp.clamp(target, lower, upper)
-                    if axis_stiffness[dim] > 0.0:
-                        err = e - target
-                        compliance = 1.0 / axis_stiffness[dim]
-                    damping = axis_damping[dim]
-                elif mode == JOINT_MODE_TARGET_VELOCITY:
-                    if axis_stiffness[dim] > 0.0:
-                        err = (derr - target) * dt
-                        compliance = 1.0 / axis_stiffness[dim]
-                    damping = axis_damping[dim]
-                    derr = 0.0
-
-            if wp.abs(err) > 1e-9:
-                lambda_in = 0.0
-                d_lambda = compute_positional_correction(
-                    err,
-                    derr,
-                    pose_p,
-                    pose_c,
-                    m_inv_p,
-                    m_inv_c,
-                    I_inv_p,
-                    I_inv_c,
-                    linear_p,
-                    linear_c,
-                    angular_p,
-                    angular_c,
-                    lambda_in,
-                    compliance,
-                    damping,
-                    dt,
-                )
-
-                lin_delta_p += linear_p * (d_lambda * linear_relaxation)
-                ang_delta_p += angular_p * (d_lambda * angular_relaxation)
-                lin_delta_c += linear_c * (d_lambda * linear_relaxation)
-                ang_delta_c += angular_c * (d_lambda * angular_relaxation)
-
-    if (
-        type == wp.sim.JOINT_FIXED
-        or type == wp.sim.JOINT_PRISMATIC
-        or type == wp.sim.JOINT_REVOLUTE
-        or type == wp.sim.JOINT_UNIVERSAL
-        or type == wp.sim.JOINT_COMPOUND
-        or type == wp.sim.JOINT_D6
-    ):
-        # handle angular constraints
-
-        # local joint rotations
-        q_p = wp.transform_get_rotation(X_wp)
-        q_c = wp.transform_get_rotation(X_wc)
-
-        # make quats lie in same hemisphere
-        if wp.dot(q_p, q_c) < 0.0:
-            q_c *= -1.0
-
-        rel_q = wp.quat_inverse(q_p) * q_c
-
-        qtwist = wp.normalize(wp.quat(rel_q[0], 0.0, 0.0, rel_q[3]))
-        qswing = rel_q * wp.quat_inverse(qtwist)
-
-        # decompose to a compound rotation each axis
-        s = wp.sqrt(rel_q[0] * rel_q[0] + rel_q[3] * rel_q[3])
-        invs = 1.0 / s
-        invscube = invs * invs * invs
-
-        # handle axis-angle joints
-
-        # rescale twist from quaternion space to angular
-        err_0 = 2.0 * wp.asin(wp.clamp(qtwist[0], -1.0, 1.0))
-        err_1 = qswing[1]
-        err_2 = qswing[2]
-        # analytic gradients of swing-twist decomposition
-        grad_0 = wp.quat(invs - rel_q[0] * rel_q[0] * invscube, 0.0, 0.0, -(rel_q[3] * rel_q[0]) * invscube)
-        grad_1 = wp.quat(
-            -rel_q[3] * (rel_q[3] * rel_q[2] + rel_q[0] * rel_q[1]) * invscube,
-            rel_q[3] * invs,
-            -rel_q[0] * invs,
-            rel_q[0] * (rel_q[3] * rel_q[2] + rel_q[0] * rel_q[1]) * invscube,
-        )
-        grad_2 = wp.quat(
-            rel_q[3] * (rel_q[3] * rel_q[1] - rel_q[0] * rel_q[2]) * invscube,
-            rel_q[0] * invs,
-            rel_q[3] * invs,
-            rel_q[0] * (rel_q[2] * rel_q[0] - rel_q[3] * rel_q[1]) * invscube,
-        )
-        grad_0 *= 2.0 / wp.abs(qtwist[3])
-        # grad_0 *= 2.0 / wp.sqrt(1.0-qtwist[0]*qtwist[0])	# derivative of asin(x) = 1/sqrt(1-x^2)
-
-        # rescale swing
-        swing_sq = qswing[3] * qswing[3]
-        # if swing axis magnitude close to zero vector, just treat in quaternion space
-        angularEps = 1.0e-4
-        if swing_sq + angularEps < 1.0:
-            d = wp.sqrt(1.0 - qswing[3] * qswing[3])
-            theta = 2.0 * wp.acos(wp.clamp(qswing[3], -1.0, 1.0))
-            scale = theta / d
-
-            err_1 *= scale
-            err_2 *= scale
-
-            grad_1 *= scale
-            grad_2 *= scale
-
-        errs = wp.vec3(err_0, err_1, err_2)
-        grad_x = wp.vec3(grad_0[0], grad_1[0], grad_2[0])
-        grad_y = wp.vec3(grad_0[1], grad_1[1], grad_2[1])
-        grad_z = wp.vec3(grad_0[2], grad_1[2], grad_2[2])
-        grad_w = wp.vec3(grad_0[3], grad_1[3], grad_2[3])
-
-        # compute joint target, stiffness, damping
-        ke_sum = float(0.0)
-        axis_limits = wp.spatial_vector(0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
-        axis_mode = wp.vec3i(0, 0, 0)
-        axis_target_ke_kd = wp.mat33(0.0)
-        # avoid a for loop here since local variables would need to be modified which is not yet differentiable
-        if ang_axis_count > 0:
-            axis_idx = axis_start + lin_axis_count
-            axis = joint_axis[axis_idx]
-            lo_temp = axis * joint_limit_lower[axis_idx]
-            up_temp = axis * joint_limit_upper[axis_idx]
-            axis_limits = wp.spatial_vector(vec_min(lo_temp, up_temp), vec_max(lo_temp, up_temp))
-            mode = joint_axis_mode[axis_idx]
-            if mode != JOINT_MODE_FORCE:  # position or velocity target
-                ke = joint_target_ke[axis_idx]
-                kd = joint_target_kd[axis_idx]
-                target = joint_act[axis_idx]
-                axis_mode = update_joint_axis_mode(mode, axis, axis_mode)
-                axis_target_ke_kd = update_joint_axis_target_ke_kd(axis, target, ke, kd, axis_target_ke_kd)
-                ke_sum += ke
-        if ang_axis_count > 1:
-            axis_idx = axis_start + lin_axis_count + 1
-            axis = joint_axis[axis_idx]
-            lower = joint_limit_lower[axis_idx]
-            upper = joint_limit_upper[axis_idx]
-            axis_limits = update_joint_axis_limits(axis, lower, upper, axis_limits)
-            mode = joint_axis_mode[axis_idx]
-            if mode != JOINT_MODE_FORCE:  # position or velocity target
-                ke = joint_target_ke[axis_idx]
-                kd = joint_target_kd[axis_idx]
-                target = joint_act[axis_idx]
-                axis_mode = update_joint_axis_mode(mode, axis, axis_mode)
-                axis_target_ke_kd = update_joint_axis_target_ke_kd(axis, target, ke, kd, axis_target_ke_kd)
-                ke_sum += ke
-        if ang_axis_count > 2:
-            axis_idx = axis_start + lin_axis_count + 2
-            axis = joint_axis[axis_idx]
-            lower = joint_limit_lower[axis_idx]
-            upper = joint_limit_upper[axis_idx]
-            axis_limits = update_joint_axis_limits(axis, lower, upper, axis_limits)
-            mode = joint_axis_mode[axis_idx]
-            if mode != JOINT_MODE_FORCE:  # position or velocity target
-                ke = joint_target_ke[axis_idx]
-                kd = joint_target_kd[axis_idx]
-                target = joint_act[axis_idx]
-                axis_mode = update_joint_axis_mode(mode, axis, axis_mode)
-                axis_target_ke_kd = update_joint_axis_target_ke_kd(axis, target, ke, kd, axis_target_ke_kd)
-                ke_sum += ke
-
-        axis_target = axis_target_ke_kd[0]
-        axis_stiffness = axis_target_ke_kd[1]
-        axis_damping = axis_target_ke_kd[2]
-        if ke_sum > 0.0:
-            axis_target /= ke_sum
-        axis_limits_lower = wp.spatial_top(axis_limits)
-        axis_limits_upper = wp.spatial_bottom(axis_limits)
-
-        # if type == wp.sim.JOINT_D6:
-        #     wp.printf("axis_target: %f %f %f\t axis_stiffness: %f %f %f\t axis_damping: %f %f %f\t axis_limits_lower: %f %f %f \t axis_limits_upper: %f %f %f\n",
-        #               axis_target[0], axis_target[1], axis_target[2],
-        #               axis_stiffness[0], axis_stiffness[1], axis_stiffness[2],
-        #               axis_damping[0], axis_damping[1], axis_damping[2],
-        #               axis_limits_lower[0], axis_limits_lower[1], axis_limits_lower[2],
-        #               axis_limits_upper[0], axis_limits_upper[1], axis_limits_upper[2])
-        #     # wp.printf("wp.sqrt(1.0-qtwist[0]*qtwist[0]) = %f\n", wp.sqrt(1.0-qtwist[0]*qtwist[0]))
-
-        for dim in range(3):
-            e = errs[dim]
-            mode = axis_mode[dim]
-
-            # analytic gradients of swing-twist decomposition
-            grad = wp.quat(grad_x[dim], grad_y[dim], grad_z[dim], grad_w[dim])
-
-            quat_c = 0.5 * q_p * grad * wp.quat_inverse(q_c)
-            angular_c = wp.vec3(quat_c[0], quat_c[1], quat_c[2])
-            angular_p = -angular_c
-            # time derivative of the constraint
-            derr = wp.dot(angular_p, omega_p) + wp.dot(angular_c, omega_c)
-
-            err = 0.0
-            compliance = angular_compliance
-            damping = 0.0
-
-            # consider joint limits irrespective of mode
-            lower = axis_limits_lower[dim]
-            upper = axis_limits_upper[dim]
-            if e < lower:
-                err = e - lower
-            elif e > upper:
-                err = e - upper
-            else:
-                target = axis_target[dim]
-                if mode == JOINT_MODE_TARGET_POSITION:
-                    target = wp.clamp(target, lower, upper)
-                    if axis_stiffness[dim] > 0.0:
-                        err = e - target
-                        compliance = 1.0 / axis_stiffness[dim]
-                    damping = axis_damping[dim]
-                elif mode == JOINT_MODE_TARGET_VELOCITY:
-                    if axis_stiffness[dim] > 0.0:
-                        err = (derr - target) * dt
-                        compliance = 1.0 / axis_stiffness[dim]
-                    damping = axis_damping[dim]
-                    derr = 0.0
-
-            d_lambda = (
-                compute_angular_correction(
-                    err, derr, pose_p, pose_c, I_inv_p, I_inv_c, angular_p, angular_c, 0.0, compliance, damping, dt
-                )
-                * angular_relaxation
-            )
-
-            # update deltas
-            ang_delta_p += angular_p * d_lambda
-            ang_delta_c += angular_c * d_lambda
-
-    if id_p >= 0:
-        wp.atomic_add(deltas, id_p, wp.spatial_vector(ang_delta_p, lin_delta_p))
-    if id_c >= 0:
-        wp.atomic_add(deltas, id_c, wp.spatial_vector(ang_delta_c, lin_delta_c))
-
-
-@wp.func
-def compute_contact_constraint_delta(
-    err: float,
-    tf_a: wp.transform,
-    tf_b: wp.transform,
-    m_inv_a: float,
-    m_inv_b: float,
-    I_inv_a: wp.mat33,
-    I_inv_b: wp.mat33,
-    linear_a: wp.vec3,
-    linear_b: wp.vec3,
-    angular_a: wp.vec3,
-    angular_b: wp.vec3,
-    relaxation: float,
-    dt: float,
-) -> float:
-    denom = 0.0
-    denom += wp.length_sq(linear_a) * m_inv_a
-    denom += wp.length_sq(linear_b) * m_inv_b
-
-    q1 = wp.transform_get_rotation(tf_a)
-    q2 = wp.transform_get_rotation(tf_b)
-
-    # Eq. 2-3 (make sure to project into the frame of the body)
-    rot_angular_a = wp.quat_rotate_inv(q1, angular_a)
-    rot_angular_b = wp.quat_rotate_inv(q2, angular_b)
-
-    denom += wp.dot(rot_angular_a, I_inv_a * rot_angular_a)
-    denom += wp.dot(rot_angular_b, I_inv_b * rot_angular_b)
-
-    delta_lambda = -err
-    if denom > 0.0:
-        delta_lambda /= dt * denom
-
-    return delta_lambda * relaxation
-
-
-@wp.func
-def compute_positional_correction(
-    err: float,
-    derr: float,
-    tf_a: wp.transform,
-    tf_b: wp.transform,
-    m_inv_a: float,
-    m_inv_b: float,
-    I_inv_a: wp.mat33,
-    I_inv_b: wp.mat33,
-    linear_a: wp.vec3,
-    linear_b: wp.vec3,
-    angular_a: wp.vec3,
-    angular_b: wp.vec3,
-    lambda_in: float,
-    compliance: float,
-    damping: float,
-    dt: float,
-) -> float:
-    denom = 0.0
-    denom += wp.length_sq(linear_a) * m_inv_a
-    denom += wp.length_sq(linear_b) * m_inv_b
-
-    q1 = wp.transform_get_rotation(tf_a)
-    q2 = wp.transform_get_rotation(tf_b)
-
-    # Eq. 2-3 (make sure to project into the frame of the body)
-    rot_angular_a = wp.quat_rotate_inv(q1, angular_a)
-    rot_angular_b = wp.quat_rotate_inv(q2, angular_b)
-
-    denom += wp.dot(rot_angular_a, I_inv_a * rot_angular_a)
-    denom += wp.dot(rot_angular_b, I_inv_b * rot_angular_b)
-
-    alpha = compliance
-    gamma = compliance * damping
-
-    delta_lambda = -(err + alpha * lambda_in + gamma * derr)
-    if denom + alpha > 0.0:
-        delta_lambda /= (dt + gamma) * denom + alpha / dt
-
-    return delta_lambda
-
-
-@wp.func
-def compute_angular_correction(
-    err: float,
-    derr: float,
-    tf_a: wp.transform,
-    tf_b: wp.transform,
-    I_inv_a: wp.mat33,
-    I_inv_b: wp.mat33,
-    angular_a: wp.vec3,
-    angular_b: wp.vec3,
-    lambda_in: float,
-    compliance: float,
-    damping: float,
-    dt: float,
-) -> float:
-    denom = 0.0
-
-    q1 = wp.transform_get_rotation(tf_a)
-    q2 = wp.transform_get_rotation(tf_b)
-
-    # Eq. 2-3 (make sure to project into the frame of the body)
-    rot_angular_a = wp.quat_rotate_inv(q1, angular_a)
-    rot_angular_b = wp.quat_rotate_inv(q2, angular_b)
-
-    denom += wp.dot(rot_angular_a, I_inv_a * rot_angular_a)
-    denom += wp.dot(rot_angular_b, I_inv_b * rot_angular_b)
-
-    alpha = compliance
-    gamma = compliance * damping
-
-    delta_lambda = -(err + alpha * lambda_in + gamma * derr)
-    if denom + alpha > 0.0:
-        delta_lambda /= (dt + gamma) * denom + alpha / dt
-
-    return delta_lambda
-
-
-@wp.kernel
-def solve_body_contact_positions(
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-    body_com: wp.array(dtype=wp.vec3),
-    body_m_inv: wp.array(dtype=float),
-    body_I_inv: wp.array(dtype=wp.mat33),
-    shape_body: wp.array(dtype=int),
-    contact_count: wp.array(dtype=int),
-    contact_point0: wp.array(dtype=wp.vec3),
-    contact_point1: wp.array(dtype=wp.vec3),
-    contact_offset0: wp.array(dtype=wp.vec3),
-    contact_offset1: wp.array(dtype=wp.vec3),
-    contact_normal: wp.array(dtype=wp.vec3),
-    contact_thickness: wp.array(dtype=float),
-    contact_shape0: wp.array(dtype=int),
-    contact_shape1: wp.array(dtype=int),
-    shape_materials: ModelShapeMaterials,
-    relaxation: float,
-    dt: float,
-    contact_torsional_friction: float,
-    contact_rolling_friction: float,
-    # outputs
-    deltas: wp.array(dtype=wp.spatial_vector),
-    contact_inv_weight: wp.array(dtype=float),
-):
-    tid = wp.tid()
-
-    count = contact_count[0]
-    if tid >= count:
-        return
-
-    shape_a = contact_shape0[tid]
-    shape_b = contact_shape1[tid]
-    if shape_a == shape_b:
-        return
-    body_a = -1
-    if shape_a >= 0:
-        body_a = shape_body[shape_a]
-    body_b = -1
-    if shape_b >= 0:
-        body_b = shape_body[shape_b]
-    if body_a == body_b:
-        return
-
-    # find body to world transform
-    X_wb_a = wp.transform_identity()
-    X_wb_b = wp.transform_identity()
-    if body_a >= 0:
-        X_wb_a = body_q[body_a]
-    if body_b >= 0:
-        X_wb_b = body_q[body_b]
-
-    # compute body position in world space
-    bx_a = wp.transform_point(X_wb_a, contact_point0[tid])
-    bx_b = wp.transform_point(X_wb_b, contact_point1[tid])
-
-    thickness = contact_thickness[tid]
-    n = -contact_normal[tid]
-    d = wp.dot(n, bx_b - bx_a) - thickness
-
-    if d >= 0.0:
-        return
-
-    m_inv_a = 0.0
-    m_inv_b = 0.0
-    I_inv_a = wp.mat33(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
-    I_inv_b = wp.mat33(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
-    # center of mass in body frame
-    com_a = wp.vec3(0.0)
-    com_b = wp.vec3(0.0)
-    # body to world transform
-    X_wb_a = wp.transform_identity()
-    X_wb_b = wp.transform_identity()
-    # angular velocities
-    omega_a = wp.vec3(0.0)
-    omega_b = wp.vec3(0.0)
-    # contact offset in body frame
-    offset_a = contact_offset0[tid]
-    offset_b = contact_offset1[tid]
-
-    if body_a >= 0:
-        X_wb_a = body_q[body_a]
-        com_a = body_com[body_a]
-        m_inv_a = body_m_inv[body_a]
-        I_inv_a = body_I_inv[body_a]
-        omega_a = wp.spatial_top(body_qd[body_a])
-
-    if body_b >= 0:
-        X_wb_b = body_q[body_b]
-        com_b = body_com[body_b]
-        m_inv_b = body_m_inv[body_b]
-        I_inv_b = body_I_inv[body_b]
-        omega_b = wp.spatial_top(body_qd[body_b])
-
-    # use average contact material properties
-    mat_nonzero = 0
-    mu = 0.0
-    if shape_a >= 0:
-        mat_nonzero += 1
-        mu += shape_materials.mu[shape_a]
-    if shape_b >= 0:
-        mat_nonzero += 1
-        mu += shape_materials.mu[shape_b]
-    if mat_nonzero > 0:
-        mu /= float(mat_nonzero)
-
-    r_a = bx_a - wp.transform_point(X_wb_a, com_a)
-    r_b = bx_b - wp.transform_point(X_wb_b, com_b)
-
-    angular_a = -wp.cross(r_a, n)
-    angular_b = wp.cross(r_b, n)
-
-    if contact_inv_weight:
-        if body_a >= 0:
-            wp.atomic_add(contact_inv_weight, body_a, 1.0)
-        if body_b >= 0:
-            wp.atomic_add(contact_inv_weight, body_b, 1.0)
-
-    lambda_n = compute_contact_constraint_delta(
-        d, X_wb_a, X_wb_b, m_inv_a, m_inv_b, I_inv_a, I_inv_b, -n, n, angular_a, angular_b, relaxation, dt
-    )
-
-    lin_delta_a = -n * lambda_n
-    lin_delta_b = n * lambda_n
-    ang_delta_a = angular_a * lambda_n
-    ang_delta_b = angular_b * lambda_n
-
-    # linear friction
-    if mu > 0.0:
-        # add on displacement from surface offsets, this ensures we include any rotational effects due to thickness from feature
-        # need to use the current rotation to account for friction due to angular effects (e.g.: slipping contact)
-        bx_a += wp.transform_vector(X_wb_a, offset_a)
-        bx_b += wp.transform_vector(X_wb_b, offset_b)
-
-        # update delta
-        delta = bx_b - bx_a
-        friction_delta = delta - wp.dot(n, delta) * n
-
-        perp = wp.normalize(friction_delta)
-
-        r_a = bx_a - wp.transform_point(X_wb_a, com_a)
-        r_b = bx_b - wp.transform_point(X_wb_b, com_b)
-
-        angular_a = -wp.cross(r_a, perp)
-        angular_b = wp.cross(r_b, perp)
-
-        err = wp.length(friction_delta)
-
-        if err > 0.0:
-            lambda_fr = compute_contact_constraint_delta(
-                err, X_wb_a, X_wb_b, m_inv_a, m_inv_b, I_inv_a, I_inv_b, -perp, perp, angular_a, angular_b, 1.0, dt
-            )
-
-            # limit friction based on incremental normal force, good approximation to limiting on total force
-            lambda_fr = wp.max(lambda_fr, -lambda_n * mu)
-
-            lin_delta_a -= perp * lambda_fr
-            lin_delta_b += perp * lambda_fr
-
-            ang_delta_a += angular_a * lambda_fr
-            ang_delta_b += angular_b * lambda_fr
-
-    torsional_friction = mu * contact_torsional_friction
-
-    delta_omega = omega_b - omega_a
-
-    if torsional_friction > 0.0:
-        err = wp.dot(delta_omega, n) * dt
-
-        if wp.abs(err) > 0.0:
-            lin = wp.vec3(0.0)
-            lambda_torsion = compute_contact_constraint_delta(
-                err, X_wb_a, X_wb_b, m_inv_a, m_inv_b, I_inv_a, I_inv_b, lin, lin, -n, n, 1.0, dt
-            )
-
-            lambda_torsion = wp.clamp(lambda_torsion, -lambda_n * torsional_friction, lambda_n * torsional_friction)
-
-            ang_delta_a -= n * lambda_torsion
-            ang_delta_b += n * lambda_torsion
-
-    rolling_friction = mu * contact_rolling_friction
-    if rolling_friction > 0.0:
-        delta_omega -= wp.dot(n, delta_omega) * n
-        err = wp.length(delta_omega) * dt
-        if err > 0.0:
-            lin = wp.vec3(0.0)
-            roll_n = wp.normalize(delta_omega)
-            lambda_roll = compute_contact_constraint_delta(
-                err, X_wb_a, X_wb_b, m_inv_a, m_inv_b, I_inv_a, I_inv_b, lin, lin, -roll_n, roll_n, 1.0, dt
-            )
-
-            lambda_roll = wp.max(lambda_roll, -lambda_n * rolling_friction)
-
-            ang_delta_a -= roll_n * lambda_roll
-            ang_delta_b += roll_n * lambda_roll
-
-    if body_a >= 0:
-        wp.atomic_add(deltas, body_a, wp.spatial_vector(ang_delta_a, lin_delta_a))
-    if body_b >= 0:
-        wp.atomic_add(deltas, body_b, wp.spatial_vector(ang_delta_b, lin_delta_b))
-
-
-@wp.kernel
-def update_body_velocities(
-    poses: wp.array(dtype=wp.transform),
-    poses_prev: wp.array(dtype=wp.transform),
-    body_com: wp.array(dtype=wp.vec3),
-    dt: float,
-    qd_out: wp.array(dtype=wp.spatial_vector),
-):
-    tid = wp.tid()
-
-    pose = poses[tid]
-    pose_prev = poses_prev[tid]
-
-    x = wp.transform_get_translation(pose)
-    x_prev = wp.transform_get_translation(pose_prev)
-
-    q = wp.transform_get_rotation(pose)
-    q_prev = wp.transform_get_rotation(pose_prev)
-
-    # Update body velocities according to Alg. 2
-    # XXX we consider the body COM as the origin of the body frame
-    x_com = x + wp.quat_rotate(q, body_com[tid])
-    x_com_prev = x_prev + wp.quat_rotate(q_prev, body_com[tid])
-
-    # XXX consider the velocity of the COM
-    v = (x_com - x_com_prev) / dt
-    dq = q * wp.quat_inverse(q_prev)
-
-    omega = 2.0 / dt * wp.vec3(dq[0], dq[1], dq[2])
-    if dq[3] < 0.0:
-        omega = -omega
-
-    qd_out[tid] = wp.spatial_vector(omega, v)
-
-
-@wp.kernel
-def apply_rigid_restitution(
-    body_q: wp.array(dtype=wp.transform),
-    body_qd: wp.array(dtype=wp.spatial_vector),
-    body_q_prev: wp.array(dtype=wp.transform),
-    body_qd_prev: wp.array(dtype=wp.spatial_vector),
-    body_com: wp.array(dtype=wp.vec3),
-    body_m_inv: wp.array(dtype=float),
-    body_I_inv: wp.array(dtype=wp.mat33),
-    shape_body: wp.array(dtype=int),
-    contact_count: wp.array(dtype=int),
-    contact_normal: wp.array(dtype=wp.vec3),
-    contact_shape0: wp.array(dtype=int),
-    contact_shape1: wp.array(dtype=int),
-    shape_materials: ModelShapeMaterials,
-    contact_point0: wp.array(dtype=wp.vec3),
-    contact_point1: wp.array(dtype=wp.vec3),
-    contact_offset0: wp.array(dtype=wp.vec3),
-    contact_offset1: wp.array(dtype=wp.vec3),
-    contact_thickness: wp.array(dtype=float),
-    contact_inv_weight: wp.array(dtype=float),
-    gravity: wp.vec3,
-    dt: float,
-    # outputs
-    deltas: wp.array(dtype=wp.spatial_vector),
-):
-    tid = wp.tid()
-
-    count = contact_count[0]
-    if tid >= count:
-        return
-    shape_a = contact_shape0[tid]
-    shape_b = contact_shape1[tid]
-    if shape_a == shape_b:
-        return
-    body_a = -1
-    body_b = -1
-
-    # use average contact material properties
-    mat_nonzero = 0
-    restitution = 0.0
-    if shape_a >= 0:
-        mat_nonzero += 1
-        restitution += shape_materials.restitution[shape_a]
-        body_a = shape_body[shape_a]
-    if shape_b >= 0:
-        mat_nonzero += 1
-        restitution += shape_materials.restitution[shape_b]
-        body_b = shape_body[shape_b]
-    if mat_nonzero > 0:
-        restitution /= float(mat_nonzero)
-    if body_a == body_b:
-        return
-
-    m_inv_a = 0.0
-    m_inv_b = 0.0
-    I_inv_a = wp.mat33(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
-    I_inv_b = wp.mat33(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
-    # body to world transform
-    X_wb_a_prev = wp.transform_identity()
-    X_wb_b_prev = wp.transform_identity()
-    # center of mass in body frame
-    com_a = wp.vec3(0.0)
-    com_b = wp.vec3(0.0)
-    # previous velocity at contact points
-    v_a = wp.vec3(0.0)
-    v_b = wp.vec3(0.0)
-    # new velocity at contact points
-    v_a_new = wp.vec3(0.0)
-    v_b_new = wp.vec3(0.0)
-    # inverse mass used to compute the impulse
-    inv_mass = 0.0
-
-    if body_a >= 0:
-        X_wb_a_prev = body_q_prev[body_a]
-        # X_wb_a = body_q[body_a]
-        m_inv_a = body_m_inv[body_a]
-        I_inv_a = body_I_inv[body_a]
-        com_a = body_com[body_a]
-
-    if body_b >= 0:
-        X_wb_b_prev = body_q_prev[body_b]
-        # X_wb_b = body_q[body_b]
-        m_inv_b = body_m_inv[body_b]
-        I_inv_b = body_I_inv[body_b]
-        com_b = body_com[body_b]
-
-    # compute body position in world space
-    bx_a = wp.transform_point(X_wb_a_prev, contact_point0[tid] + contact_offset0[tid])
-    bx_b = wp.transform_point(X_wb_b_prev, contact_point1[tid] + contact_offset1[tid])
-
-    thickness = contact_thickness[tid]
-    n = contact_normal[tid]
-    d = -wp.dot(n, bx_b - bx_a) - thickness
-    if d >= 0.0:
-        return
-
-    r_a = bx_a - wp.transform_point(X_wb_a_prev, com_a)
-    r_b = bx_b - wp.transform_point(X_wb_b_prev, com_b)
-
-    rxn_a = wp.vec3(0.0)
-    rxn_b = wp.vec3(0.0)
-    if body_a >= 0:
-        v_a = velocity_at_point(body_qd_prev[body_a], r_a) + gravity * dt
-        v_a_new = velocity_at_point(body_qd[body_a], r_a)
-        q_a = wp.transform_get_rotation(X_wb_a_prev)
-        rxn_a = wp.quat_rotate_inv(q_a, wp.cross(r_a, n))
-        # Eq. 2
-        inv_mass_a = m_inv_a + wp.dot(rxn_a, I_inv_a * rxn_a)
-        # if contact_inv_weight:
-        #     if contact_inv_weight[body_a] > 0.0:
-        #         inv_mass_a *= contact_inv_weight[body_a]
-        inv_mass += inv_mass_a
-    if body_b >= 0:
-        v_b = velocity_at_point(body_qd_prev[body_b], r_b) + gravity * dt
-        v_b_new = velocity_at_point(body_qd[body_b], r_b)
-        q_b = wp.transform_get_rotation(X_wb_b_prev)
-        rxn_b = wp.quat_rotate_inv(q_b, wp.cross(r_b, n))
-        # Eq. 3
-        inv_mass_b = m_inv_b + wp.dot(rxn_b, I_inv_b * rxn_b)
-        # if contact_inv_weight:
-        #     if contact_inv_weight[body_b] > 0.0:
-        #         inv_mass_b *= contact_inv_weight[body_b]
-        inv_mass += inv_mass_b
-
-    if inv_mass == 0.0:
-        return
-
-    # Eq. 29
-    rel_vel_old = wp.dot(n, v_a - v_b)
-    rel_vel_new = wp.dot(n, v_a_new - v_b_new)
-
-    if rel_vel_old >= 0.0:
-        return
-
-    # Eq. 34
-    dv = (-rel_vel_new - restitution * rel_vel_old) / inv_mass
-
-    # Eq. 33
-    if body_a >= 0:
-        dv_a = dv
-        # if contact_inv_weight:
-        #     if contact_inv_weight[body_a] > 0.0:
-        #         dv_a *= contact_inv_weight[body_a]
-        q_a = wp.transform_get_rotation(X_wb_a_prev)
-        dq = wp.quat_rotate(q_a, I_inv_a * rxn_a * dv_a)
-        wp.atomic_add(deltas, body_a, wp.spatial_vector(dq, n * m_inv_a * dv_a))
-
-    if body_b >= 0:
-        dv_b = -dv
-        # if contact_inv_weight:
-        #     if contact_inv_weight[body_b] > 0.0:
-        #         dv_b *= contact_inv_weight[body_b]
-        q_b = wp.transform_get_rotation(X_wb_b_prev)
-        dq = wp.quat_rotate(q_b, I_inv_b * rxn_b * dv_b)
-        wp.atomic_add(deltas, body_b, wp.spatial_vector(dq, n * m_inv_b * dv_b))
-
-
-class XPBDIntegrator(Integrator):
-    """An implicit integrator using eXtended Position-Based Dynamics (XPBD) for rigid and soft body simulation.
-
-    References:
-        - Miles Macklin, Matthias Mller, and Nuttapong Chentanez. 2016. XPBD: position-based simulation of compliant constrained dynamics. In Proceedings of the 9th International Conference on Motion in Games (MIG '16). Association for Computing Machinery, New York, NY, USA, 49-54. https://doi.org/10.1145/2994258.2994272
-        - Matthias Mller, Miles Macklin, Nuttapong Chentanez, Stefan Jeschke, and Tae-Yong Kim. 2020. Detailed rigid body simulation with extended position based dynamics. In Proceedings of the ACM SIGGRAPH/Eurographics Symposium on Computer Animation (SCA '20). Eurographics Association, Goslar, DEU, Article 10, 1-12. https://doi.org/10.1111/cgf.14105
-
-    After constructing :class:`Model`, :class:`State`, and :class:`Control` (optional) objects, this time-integrator
-    may be used to advance the simulation state forward in time.
-
-    Example
-    -------
-
-    .. code-block:: python
-
-        integrator = wp.XPBDIntegrator()
-
-        # simulation loop
-        for i in range(100):
-            state = integrator.simulate(model, state_in, state_out, dt, control)
-
-    """
-
-    def __init__(
-        self,
-        iterations=2,
-        soft_body_relaxation=0.9,
-        soft_contact_relaxation=0.9,
-        joint_linear_relaxation=0.7,
-        joint_angular_relaxation=0.4,
-        rigid_contact_relaxation=0.8,
-        rigid_contact_con_weighting=True,
-        angular_damping=0.0,
-        enable_restitution=False,
-    ):
-        self.iterations = iterations
-
-        self.soft_body_relaxation = soft_body_relaxation
-        self.soft_contact_relaxation = soft_contact_relaxation
-
-        self.joint_linear_relaxation = joint_linear_relaxation
-        self.joint_angular_relaxation = joint_angular_relaxation
-
-        self.rigid_contact_relaxation = rigid_contact_relaxation
-        self.rigid_contact_con_weighting = rigid_contact_con_weighting
-
-        self.angular_damping = angular_damping
-
-        self.enable_restitution = enable_restitution
-
-        self.compute_body_velocity_from_position_delta = False
-
-        # helper variables to track constraint resolution vars
-        self._particle_delta_counter = 0
-        self._body_delta_counter = 0
-
-    def apply_particle_deltas(
-        self,
-        model: Model,
-        state_in: State,
-        state_out: State,
-        particle_deltas: wp.array,
-        dt: float,
-    ):
-        if state_in.requires_grad:
-            particle_q = state_out.particle_q
-            # allocate new particle arrays so gradients can be tracked correctly without overwriting
-            new_particle_q = wp.empty_like(state_out.particle_q)
-            new_particle_qd = wp.empty_like(state_out.particle_qd)
-            self._particle_delta_counter += 1
-        else:
-            if self._particle_delta_counter == 0:
-                particle_q = state_out.particle_q
-                new_particle_q = state_in.particle_q
-                new_particle_qd = state_in.particle_qd
-            else:
-                particle_q = state_in.particle_q
-                new_particle_q = state_out.particle_q
-                new_particle_qd = state_out.particle_qd
-            self._particle_delta_counter = 1 - self._particle_delta_counter
-
-        wp.launch(
-            kernel=apply_particle_deltas,
-            dim=model.particle_count,
-            inputs=[
-                self.particle_q_init,
-                particle_q,
-                model.particle_flags,
-                particle_deltas,
-                dt,
-                model.particle_max_velocity,
-            ],
-            outputs=[new_particle_q, new_particle_qd],
-            device=model.device,
-        )
-
-        if state_in.requires_grad:
-            state_out.particle_q = new_particle_q
-            state_out.particle_qd = new_particle_qd
-
-        return new_particle_q, new_particle_qd
-
-    def apply_body_deltas(
-        self,
-        model: Model,
-        state_in: State,
-        state_out: State,
-        body_deltas: wp.array,
-        dt: float,
-        rigid_contact_inv_weight: wp.array = None,
-    ):
-        with wp.ScopedTimer("apply_body_deltas", False):
-            if state_in.requires_grad:
-                body_q = state_out.body_q
-                body_qd = state_out.body_qd
-                new_body_q = wp.clone(body_q)
-                new_body_qd = wp.clone(body_qd)
-                self._body_delta_counter += 1
-            else:
-                if self._body_delta_counter == 0:
-                    body_q = state_out.body_q
-                    body_qd = state_out.body_qd
-                    new_body_q = state_in.body_q
-                    new_body_qd = state_in.body_qd
-                else:
-                    body_q = state_in.body_q
-                    body_qd = state_in.body_qd
-                    new_body_q = state_out.body_q
-                    new_body_qd = state_out.body_qd
-                self._body_delta_counter = 1 - self._body_delta_counter
-
-            wp.launch(
-                kernel=apply_body_deltas,
-                dim=model.body_count,
-                inputs=[
-                    body_q,
-                    body_qd,
-                    model.body_com,
-                    model.body_inertia,
-                    model.body_inv_mass,
-                    model.body_inv_inertia,
-                    body_deltas,
-                    rigid_contact_inv_weight,
-                    dt,
-                ],
-                outputs=[
-                    new_body_q,
-                    new_body_qd,
-                ],
-                device=model.device,
-            )
-
-            if state_in.requires_grad:
-                state_out.body_q = new_body_q
-                state_out.body_qd = new_body_qd
-
-        return new_body_q, new_body_qd
-
-    def simulate(self, model: Model, state_in: State, state_out: State, dt: float, control: Control = None):
-        requires_grad = state_in.requires_grad
-        self._particle_delta_counter = 0
-        self._body_delta_counter = 0
-
-        particle_q = None
-        particle_qd = None
-        particle_deltas = None
-
-        body_q = None
-        body_qd = None
-        body_deltas = None
-
-        rigid_contact_inv_weight = None
-
-        if model.rigid_contact_max > 0:
-            if self.rigid_contact_con_weighting:
-                rigid_contact_inv_weight = wp.zeros_like(model.rigid_contact_thickness)
-            rigid_contact_inv_weight_init = None
-
-        if control is None:
-            control = model.control(clone_variables=False)
-
-        with wp.ScopedTimer("simulate", False):
-            if model.particle_count:
-                particle_q = state_out.particle_q
-                particle_qd = state_out.particle_qd
-
-                self.particle_q_init = wp.clone(state_in.particle_q)
-                if self.enable_restitution:
-                    self.particle_qd_init = wp.clone(state_in.particle_qd)
-                particle_deltas = wp.empty_like(state_out.particle_qd)
-
-                self.integrate_particles(model, state_in, state_out, dt)
-
-            if model.body_count:
-                body_q = state_out.body_q
-                body_qd = state_out.body_qd
-
-                if self.compute_body_velocity_from_position_delta or self.enable_restitution:
-                    body_q_init = wp.clone(state_in.body_q)
-                    body_qd_init = wp.clone(state_in.body_qd)
-
-                body_deltas = wp.empty_like(state_out.body_qd)
-
-                if model.joint_count:
-                    wp.launch(
-                        kernel=apply_joint_actions,
-                        dim=model.joint_count,
-                        inputs=[
-                            state_in.body_q,
-                            model.body_com,
-                            model.joint_type,
-                            model.joint_parent,
-                            model.joint_child,
-                            model.joint_X_p,
-                            model.joint_X_c,
-                            model.joint_axis_start,
-                            model.joint_axis_dim,
-                            model.joint_axis,
-                            model.joint_axis_mode,
-                            control.joint_act,
-                        ],
-                        outputs=[state_in.body_f],
-                        device=model.device,
-                    )
-
-                self.integrate_bodies(model, state_in, state_out, dt, self.angular_damping)
-
-            spring_constraint_lambdas = None
-            if model.spring_count:
-                spring_constraint_lambdas = wp.empty_like(model.spring_rest_length)
-            edge_constraint_lambdas = None
-            if model.edge_count:
-                edge_constraint_lambdas = wp.empty_like(model.edge_rest_angle)
-
-            for i in range(self.iterations):
-                with wp.ScopedTimer(f"iteration_{i}", False):
-                    if model.body_count:
-                        if requires_grad and i > 0:
-                            body_deltas = wp.zeros_like(body_deltas)
-                        else:
-                            body_deltas.zero_()
-
-                    if model.particle_count:
-                        if requires_grad and i > 0:
-                            particle_deltas = wp.zeros_like(particle_deltas)
-                        else:
-                            particle_deltas.zero_()
-
-                        # particle ground contact
-                        if model.ground:
-                            wp.launch(
-                                kernel=solve_particle_ground_contacts,
-                                dim=model.particle_count,
-                                inputs=[
-                                    particle_q,
-                                    particle_qd,
-                                    model.particle_inv_mass,
-                                    model.particle_radius,
-                                    model.particle_flags,
-                                    model.soft_contact_ke,
-                                    model.soft_contact_kd,
-                                    model.soft_contact_kf,
-                                    model.soft_contact_mu,
-                                    model.ground_plane,
-                                    dt,
-                                    self.soft_contact_relaxation,
-                                ],
-                                outputs=[particle_deltas],
-                                device=model.device,
-                            )
-
-                        # particle-rigid body contacts (besides ground plane)
-                        if model.shape_count > 1:
-                            wp.launch(
-                                kernel=solve_particle_shape_contacts,
-                                dim=model.soft_contact_max,
-                                inputs=[
-                                    particle_q,
-                                    particle_qd,
-                                    model.particle_inv_mass,
-                                    model.particle_radius,
-                                    model.particle_flags,
-                                    body_q,
-                                    body_qd,
-                                    model.body_com,
-                                    model.body_inv_mass,
-                                    model.body_inv_inertia,
-                                    model.shape_body,
-                                    model.shape_materials,
-                                    model.soft_contact_mu,
-                                    model.particle_adhesion,
-                                    model.soft_contact_count,
-                                    model.soft_contact_particle,
-                                    model.soft_contact_shape,
-                                    model.soft_contact_body_pos,
-                                    model.soft_contact_body_vel,
-                                    model.soft_contact_normal,
-                                    model.soft_contact_max,
-                                    dt,
-                                    self.soft_contact_relaxation,
-                                ],
-                                # outputs
-                                outputs=[particle_deltas, body_deltas],
-                                device=model.device,
-                            )
-
-                        if model.particle_max_radius > 0.0 and model.particle_count > 1:
-                            # assert model.particle_grid.reserved, "model.particle_grid must be built, see HashGrid.build()"
-                            wp.launch(
-                                kernel=solve_particle_particle_contacts,
-                                dim=model.particle_count,
-                                inputs=[
-                                    model.particle_grid.id,
-                                    particle_q,
-                                    particle_qd,
-                                    model.particle_inv_mass,
-                                    model.particle_radius,
-                                    model.particle_flags,
-                                    model.particle_mu,
-                                    model.particle_cohesion,
-                                    model.particle_max_radius,
-                                    dt,
-                                    self.soft_contact_relaxation,
-                                ],
-                                outputs=[particle_deltas],
-                                device=model.device,
-                            )
-
-                        # distance constraints
-                        if model.spring_count:
-                            spring_constraint_lambdas.zero_()
-                            wp.launch(
-                                kernel=solve_springs,
-                                dim=model.spring_count,
-                                inputs=[
-                                    particle_q,
-                                    particle_qd,
-                                    model.particle_inv_mass,
-                                    model.spring_indices,
-                                    model.spring_rest_length,
-                                    model.spring_stiffness,
-                                    model.spring_damping,
-                                    dt,
-                                    spring_constraint_lambdas,
-                                ],
-                                outputs=[particle_deltas],
-                                device=model.device,
-                            )
-
-                        # bending constraints
-                        if model.edge_count:
-                            edge_constraint_lambdas.zero_()
-                            wp.launch(
-                                kernel=bending_constraint,
-                                dim=model.edge_count,
-                                inputs=[
-                                    particle_q,
-                                    particle_qd,
-                                    model.particle_inv_mass,
-                                    model.edge_indices,
-                                    model.edge_rest_angle,
-                                    model.edge_bending_properties,
-                                    dt,
-                                    edge_constraint_lambdas,
-                                ],
-                                outputs=[particle_deltas],
-                                device=model.device,
-                            )
-
-                        # tetrahedral FEM
-                        if model.tet_count:
-                            wp.launch(
-                                kernel=solve_tetrahedra,
-                                dim=model.tet_count,
-                                inputs=[
-                                    particle_q,
-                                    particle_qd,
-                                    model.particle_inv_mass,
-                                    model.tet_indices,
-                                    model.tet_poses,
-                                    model.tet_activations,
-                                    model.tet_materials,
-                                    dt,
-                                    self.soft_body_relaxation,
-                                ],
-                                outputs=[particle_deltas],
-                                device=model.device,
-                            )
-
-                        particle_q, particle_qd = self.apply_particle_deltas(
-                            model, state_in, state_out, particle_deltas, dt
-                        )
-
-                    # handle rigid bodies
-                    # ----------------------------
-
-                    if model.joint_count:
-                        # wp.launch(
-                        #     kernel=solve_simple_body_joints,
-                        #     dim=model.joint_count,
-                        #     inputs=[
-                        #         body_q,
-                        #         body_qd,
-                        #         model.body_com,
-                        #         model.body_inv_mass,
-                        #         model.body_inv_inertia,
-                        #         model.joint_type,
-                        #         model.joint_enabled,
-                        #         model.joint_parent,
-                        #         model.joint_child,
-                        #         model.joint_X_p,
-                        #         model.joint_X_c,
-                        #         model.joint_limit_lower,
-                        #         model.joint_limit_upper,
-                        #         model.joint_axis_start,
-                        #         model.joint_axis_dim,
-                        #         model.joint_axis_mode,
-                        #         model.joint_axis,
-                        #         control.joint_target,
-                        #         model.joint_target_ke,
-                        #         model.joint_target_kd,
-                        #         model.joint_linear_compliance,
-                        #         model.joint_angular_compliance,
-                        #         self.joint_angular_relaxation,
-                        #         self.joint_linear_relaxation,
-                        #         dt,
-                        #     ],
-                        #     outputs=[body_deltas],
-                        #     device=model.device,
-                        # )
-
-                        wp.launch(
-                            kernel=solve_body_joints,
-                            dim=model.joint_count,
-                            inputs=[
-                                body_q,
-                                body_qd,
-                                model.body_com,
-                                model.body_inv_mass,
-                                model.body_inv_inertia,
-                                model.joint_type,
-                                model.joint_enabled,
-                                model.joint_parent,
-                                model.joint_child,
-                                model.joint_X_p,
-                                model.joint_X_c,
-                                model.joint_limit_lower,
-                                model.joint_limit_upper,
-                                model.joint_axis_start,
-                                model.joint_axis_dim,
-                                model.joint_axis_mode,
-                                model.joint_axis,
-                                control.joint_act,
-                                model.joint_target_ke,
-                                model.joint_target_kd,
-                                model.joint_linear_compliance,
-                                model.joint_angular_compliance,
-                                self.joint_angular_relaxation,
-                                self.joint_linear_relaxation,
-                                dt,
-                            ],
-                            outputs=[body_deltas],
-                            device=model.device,
-                        )
-
-                        body_q, body_qd = self.apply_body_deltas(model, state_in, state_out, body_deltas, dt)
-
-                    # Solve rigid contact constraints
-                    if model.rigid_contact_max and (
-                        (model.ground and model.shape_ground_contact_pair_count) or model.shape_contact_pair_count
-                    ):
-                        if self.rigid_contact_con_weighting:
-                            rigid_contact_inv_weight.zero_()
-                        body_deltas.zero_()
-
-                        wp.launch(
-                            kernel=solve_body_contact_positions,
-                            dim=model.rigid_contact_max,
-                            inputs=[
-                                body_q,
-                                body_qd,
-                                model.body_com,
-                                model.body_inv_mass,
-                                model.body_inv_inertia,
-                                model.shape_body,
-                                model.rigid_contact_count,
-                                model.rigid_contact_point0,
-                                model.rigid_contact_point1,
-                                model.rigid_contact_offset0,
-                                model.rigid_contact_offset1,
-                                model.rigid_contact_normal,
-                                model.rigid_contact_thickness,
-                                model.rigid_contact_shape0,
-                                model.rigid_contact_shape1,
-                                model.shape_materials,
-                                self.rigid_contact_relaxation,
-                                dt,
-                                model.rigid_contact_torsional_friction,
-                                model.rigid_contact_rolling_friction,
-                            ],
-                            outputs=[
-                                body_deltas,
-                                rigid_contact_inv_weight,
-                            ],
-                            device=model.device,
-                        )
-
-                        # if model.rigid_contact_count.numpy()[0] > 0:
-                        #     print("rigid_contact_count:", model.rigid_contact_count.numpy().flatten())
-                        #     # print("rigid_active_contact_distance:", rigid_active_contact_distance.numpy().flatten())
-                        #     # print("rigid_active_contact_point0:", rigid_active_contact_point0.numpy().flatten())
-                        #     # print("rigid_active_contact_point1:", rigid_active_contact_point1.numpy().flatten())
-                        #     print("body_deltas:", body_deltas.numpy().flatten())
-
-                        # print(rigid_active_contact_distance.numpy().flatten())
-
-                        if self.enable_restitution and i == 0:
-                            # remember contact constraint weighting from the first iteration
-                            if self.rigid_contact_con_weighting:
-                                rigid_contact_inv_weight_init = wp.clone(rigid_contact_inv_weight)
-                            else:
-                                rigid_contact_inv_weight_init = None
-
-                        body_q, body_qd = self.apply_body_deltas(
-                            model, state_in, state_out, body_deltas, dt, rigid_contact_inv_weight
-                        )
-
-            if model.particle_count:
-                if particle_q.ptr != state_out.particle_q.ptr:
-                    state_out.particle_q.assign(particle_q)
-                    state_out.particle_qd.assign(particle_qd)
-
-            if model.body_count:
-                if body_q.ptr != state_out.body_q.ptr:
-                    state_out.body_q.assign(body_q)
-                    state_out.body_qd.assign(body_qd)
-
-            # update body velocities from position changes
-            if self.compute_body_velocity_from_position_delta and model.body_count and not requires_grad:
-                # causes gradient issues (probably due to numerical problems
-                # when computing velocities from position changes)
-                if requires_grad:
-                    out_body_qd = wp.clone(state_out.body_qd)
-                else:
-                    out_body_qd = state_out.body_qd
-
-                # update body velocities
-                wp.launch(
-                    kernel=update_body_velocities,
-                    dim=model.body_count,
-                    inputs=[state_out.body_q, body_q_init, model.body_com, dt],
-                    outputs=[out_body_qd],
-                    device=model.device,
-                )
-
-            if self.enable_restitution:
-                if model.particle_count:
-                    wp.launch(
-                        kernel=apply_particle_shape_restitution,
-                        dim=model.particle_count,
-                        inputs=[
-                            particle_q,
-                            particle_qd,
-                            self.particle_q_init,
-                            self.particle_qd_init,
-                            model.particle_inv_mass,
-                            model.particle_radius,
-                            model.particle_flags,
-                            body_q,
-                            body_qd,
-                            model.body_com,
-                            model.body_inv_mass,
-                            model.body_inv_inertia,
-                            model.shape_body,
-                            model.shape_materials,
-                            model.particle_adhesion,
-                            model.soft_contact_restitution,
-                            model.soft_contact_count,
-                            model.soft_contact_particle,
-                            model.soft_contact_shape,
-                            model.soft_contact_body_pos,
-                            model.soft_contact_body_vel,
-                            model.soft_contact_normal,
-                            model.soft_contact_max,
-                            dt,
-                            self.soft_contact_relaxation,
-                        ],
-                        outputs=[state_out.particle_qd],
-                        device=model.device,
-                    )
-                    if model.ground:
-                        wp.launch(
-                            kernel=apply_particle_ground_restitution,
-                            dim=model.particle_count,
-                            inputs=[
-                                particle_q,
-                                particle_qd,
-                                self.particle_q_init,
-                                self.particle_qd_init,
-                                model.particle_inv_mass,
-                                model.particle_radius,
-                                model.particle_flags,
-                                model.particle_adhesion,
-                                model.soft_contact_restitution,
-                                model.ground_plane,
-                                dt,
-                                self.soft_contact_relaxation,
-                            ],
-                            outputs=[state_out.particle_qd],
-                            device=model.device,
-                        )
-
-                if model.body_count:
-                    body_deltas.zero_()
-                    wp.launch(
-                        kernel=apply_rigid_restitution,
-                        dim=model.rigid_contact_max,
-                        inputs=[
-                            state_out.body_q,
-                            state_out.body_qd,
-                            body_q_init,
-                            body_qd_init,
-                            model.body_com,
-                            model.body_inv_mass,
-                            model.body_inv_inertia,
-                            model.shape_body,
-                            model.rigid_contact_count,
-                            model.rigid_contact_normal,
-                            model.rigid_contact_shape0,
-                            model.rigid_contact_shape1,
-                            model.shape_materials,
-                            model.rigid_contact_point0,
-                            model.rigid_contact_point1,
-                            model.rigid_contact_offset0,
-                            model.rigid_contact_offset1,
-                            model.rigid_contact_thickness,
-                            rigid_contact_inv_weight_init,
-                            model.gravity,
-                            dt,
-                        ],
-                        outputs=[
-                            body_deltas,
-                        ],
-                        device=model.device,
-                    )
-
-                    wp.launch(
-                        kernel=apply_body_delta_velocities,
-                        dim=model.body_count,
-                        inputs=[
-                            body_deltas,
-                        ],
-                        outputs=[state_out.body_qd],
-                        device=model.device,
-                    )
-
-            return state_out
diff --git a/warp/sim/model.py b/warp/sim/model.py
deleted file mode 100644
index d9771230..00000000
--- a/warp/sim/model.py
+++ /dev/null
@@ -1,4821 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-"""A module for building simulation models and state."""
-
-from __future__ import annotations
-
-import copy
-import math
-from typing import List, Tuple
-
-import numpy as np
-
-import warp as wp
-
-from .graph_coloring import ColoringAlgorithm, color_trimesh, combine_independent_particle_coloring
-from .inertia import (
-    compute_box_inertia,
-    compute_capsule_inertia,
-    compute_cone_inertia,
-    compute_cylinder_inertia,
-    compute_mesh_inertia,
-    compute_sphere_inertia,
-    transform_inertia,
-)
-
-Vec3 = List[float]
-Vec4 = List[float]
-Quat = List[float]
-Mat33 = List[float]
-Transform = Tuple[Vec3, Quat]
-
-# Particle flags
-PARTICLE_FLAG_ACTIVE = wp.constant(wp.uint32(1 << 0))
-
-# Shape geometry types
-GEO_SPHERE = wp.constant(0)
-GEO_BOX = wp.constant(1)
-GEO_CAPSULE = wp.constant(2)
-GEO_CYLINDER = wp.constant(3)
-GEO_CONE = wp.constant(4)
-GEO_MESH = wp.constant(5)
-GEO_SDF = wp.constant(6)
-GEO_PLANE = wp.constant(7)
-GEO_NONE = wp.constant(8)
-
-# Types of joints linking rigid bodies
-JOINT_PRISMATIC = wp.constant(0)
-JOINT_REVOLUTE = wp.constant(1)
-JOINT_BALL = wp.constant(2)
-JOINT_FIXED = wp.constant(3)
-JOINT_FREE = wp.constant(4)
-JOINT_COMPOUND = wp.constant(5)
-JOINT_UNIVERSAL = wp.constant(6)
-JOINT_DISTANCE = wp.constant(7)
-JOINT_D6 = wp.constant(8)
-
-# Joint axis control mode types
-JOINT_MODE_FORCE = wp.constant(0)
-JOINT_MODE_TARGET_POSITION = wp.constant(1)
-JOINT_MODE_TARGET_VELOCITY = wp.constant(2)
-
-
-def flag_to_int(flag):
-    """Converts a flag to an integer."""
-    if type(flag) in wp.types.int_types:
-        return flag.value
-    return int(flag)
-
-
-# Material properties pertaining to rigid shape contact dynamics
-@wp.struct
-class ModelShapeMaterials:
-    ke: wp.array(dtype=float)  # The contact elastic stiffness (only used by the Euler integrators)
-    kd: wp.array(dtype=float)  # The contact damping stiffness (only used by the Euler integrators)
-    kf: wp.array(dtype=float)  # The contact friction stiffness (only used by the Euler integrators)
-    ka: wp.array(
-        dtype=float
-    )  # The contact adhesion distance (values greater than 0 mean adhesive contact; only used by the Euler integrators)
-    mu: wp.array(dtype=float)  # The coefficient of friction
-    restitution: wp.array(dtype=float)  # The coefficient of restitution (only used by XPBD integrator)
-
-
-# Shape properties of geometry
-@wp.struct
-class ModelShapeGeometry:
-    type: wp.array(dtype=wp.int32)  # The type of geometry (GEO_SPHERE, GEO_BOX, etc.)
-    is_solid: wp.array(dtype=wp.uint8)  # Indicates whether the shape is solid or hollow
-    thickness: wp.array(
-        dtype=float
-    )  # The thickness of the shape (used for collision detection, and inertia computation of hollow shapes)
-    source: wp.array(dtype=wp.uint64)  # Pointer to the source geometry (in case of a mesh, zero otherwise)
-    scale: wp.array(dtype=wp.vec3)  # The 3D scale of the shape
-
-
-# Axis (linear or angular) of a joint that can have bounds and be driven towards a target
-class JointAxis:
-    """
-    Describes a joint axis that can have limits and be driven towards a target.
-
-    Attributes:
-
-        axis (3D vector or JointAxis): The 3D axis that this JointAxis object describes, or alternatively another JointAxis object to copy from
-        limit_lower (float): The lower position limit of the joint axis
-        limit_upper (float): The upper position limit of the joint axis
-        limit_ke (float): The elastic stiffness of the joint axis limits, only respected by :class:`SemiImplicitIntegrator` and :class:`FeatherstoneIntegrator`
-        limit_kd (float): The damping stiffness of the joint axis limits, only respected by :class:`SemiImplicitIntegrator` and :class:`FeatherstoneIntegrator`
-        action (float): The force applied by default to this joint axis, or the target position or velocity (depending on the mode, see `Joint modes`_) of the joint axis
-        target_ke (float): The proportional gain of the joint axis target drive PD controller
-        target_kd (float): The derivative gain of the joint axis target drive PD controller
-        mode (int): The mode of the joint axis, see `Joint modes`_
-    """
-
-    def __init__(
-        self,
-        axis,
-        limit_lower=-math.inf,
-        limit_upper=math.inf,
-        limit_ke=100.0,
-        limit_kd=10.0,
-        action=None,
-        target_ke=0.0,
-        target_kd=0.0,
-        mode=JOINT_MODE_FORCE,
-    ):
-        if isinstance(axis, JointAxis):
-            self.axis = axis.axis
-            self.limit_lower = axis.limit_lower
-            self.limit_upper = axis.limit_upper
-            self.limit_ke = axis.limit_ke
-            self.limit_kd = axis.limit_kd
-            self.action = axis.action
-            self.target_ke = axis.target_ke
-            self.target_kd = axis.target_kd
-            self.mode = axis.mode
-        else:
-            self.axis = wp.normalize(wp.vec3(axis))
-            self.limit_lower = limit_lower
-            self.limit_upper = limit_upper
-            self.limit_ke = limit_ke
-            self.limit_kd = limit_kd
-            if action is not None:
-                self.action = action
-            elif mode == JOINT_MODE_TARGET_POSITION and (limit_lower > 0.0 or limit_upper < 0.0):
-                self.action = 0.5 * (limit_lower + limit_upper)
-            else:
-                self.action = 0.0
-            self.target_ke = target_ke
-            self.target_kd = target_kd
-            self.mode = mode
-
-
-class SDF:
-    """Describes a signed distance field for simulation
-
-    Attributes:
-
-        volume (Volume): The volume defining the SDF
-        I (Mat33): 3x3 inertia matrix of the SDF
-        mass (float): The total mass of the SDF
-        com (Vec3): The center of mass of the SDF
-    """
-
-    def __init__(self, volume=None, I=None, mass=1.0, com=None):
-        self.volume = volume
-        self.I = I if I is not None else wp.mat33(np.eye(3))
-        self.mass = mass
-        self.com = com if com is not None else wp.vec3()
-
-        # Need to specify these for now
-        self.has_inertia = True
-        self.is_solid = True
-
-    def finalize(self, device=None):
-        return self.volume.id
-
-    def __hash__(self):
-        return hash(self.volume.id)
-
-
-class Mesh:
-    """Describes a triangle collision mesh for simulation
-
-    Example mesh creation from a triangle OBJ mesh file:
-    ====================================================
-
-    See :func:`load_mesh` which is provided as a utility function.
-
-    .. code-block:: python
-
-        import numpy as np
-        import warp as wp
-        import warp.sim
-        import openmesh
-
-        m = openmesh.read_trimesh("mesh.obj")
-        mesh_points = np.array(m.points())
-        mesh_indices = np.array(m.face_vertex_indices(), dtype=np.int32).flatten()
-        mesh = wp.sim.Mesh(mesh_points, mesh_indices)
-
-    Attributes:
-
-        vertices (List[Vec3]): Mesh 3D vertices points
-        indices (List[int]): Mesh indices as a flattened list of vertex indices describing triangles
-        I (Mat33): 3x3 inertia matrix of the mesh assuming density of 1.0 (around the center of mass)
-        mass (float): The total mass of the body assuming density of 1.0
-        com (Vec3): The center of mass of the body
-    """
-
-    def __init__(self, vertices: list[Vec3], indices: list[int], compute_inertia=True, is_solid=True):
-        """Construct a Mesh object from a triangle mesh
-
-        The mesh center of mass and inertia tensor will automatically be
-        calculated using a density of 1.0. This computation is only valid
-        if the mesh is closed (two-manifold).
-
-        Args:
-            vertices: List of vertices in the mesh
-            indices: List of triangle indices, 3 per-element
-            compute_inertia: If True, the mass, inertia tensor and center of mass will be computed assuming density of 1.0
-            is_solid: If True, the mesh is assumed to be a solid during inertia computation, otherwise it is assumed to be a hollow surface
-        """
-
-        self.vertices = np.array(vertices).reshape(-1, 3)
-        self.indices = np.array(indices, dtype=np.int32).flatten()
-        self.is_solid = is_solid
-        self.has_inertia = compute_inertia
-
-        if compute_inertia:
-            self.mass, self.com, self.I, _ = compute_mesh_inertia(1.0, vertices, indices, is_solid=is_solid)
-        else:
-            self.I = wp.mat33(np.eye(3))
-            self.mass = 1.0
-            self.com = wp.vec3()
-
-    # construct simulation ready buffers from points
-    def finalize(self, device=None):
-        """
-        Constructs a simulation-ready :class:`Mesh` object from the mesh data and returns its ID.
-
-        Args:
-            device: The device on which to allocate the mesh buffers
-
-        Returns:
-            The ID of the simulation-ready :class:`Mesh`
-        """
-        with wp.ScopedDevice(device):
-            pos = wp.array(self.vertices, dtype=wp.vec3)
-            vel = wp.zeros_like(pos)
-            indices = wp.array(self.indices, dtype=wp.int32)
-
-            self.mesh = wp.Mesh(points=pos, velocities=vel, indices=indices)
-            return self.mesh.id
-
-    def __hash__(self):
-        """
-        Computes a hash of the mesh data for use in caching. The hash considers the mesh vertices, indices, and whether the mesh is solid or not.
-        """
-        return hash((tuple(np.array(self.vertices).flatten()), tuple(np.array(self.indices).flatten()), self.is_solid))
-
-
-class State:
-    """Time-varying state data for a :class:`Model`.
-
-    Time-varying state data includes particle positions, velocities, rigid body states, and
-    anything that is output from the integrator as derived data, e.g.: forces.
-
-    The exact attributes depend on the contents of the model. State objects should
-    generally be created using the :func:`Model.state()` function.
-    """
-
-    def __init__(self):
-        self.particle_q: wp.array | None = None
-        """Array of 3D particle positions with shape ``(particle_count,)`` and type :class:`vec3`."""
-
-        self.particle_qd: wp.array | None = None
-        """Array of 3D particle velocities with shape ``(particle_count,)`` and type :class:`vec3`."""
-
-        self.particle_f: wp.array | None = None
-        """Array of 3D particle forces with shape ``(particle_count,)`` and type :class:`vec3`."""
-
-        self.body_q: wp.array | None = None
-        """Array of body coordinates (7-dof transforms) in maximal coordinates with shape ``(body_count,)`` and type :class:`transform`."""
-
-        self.body_qd: wp.array | None = None
-        """Array of body velocities in maximal coordinates (first three entries represent angular velocity,
-        last three entries represent linear velocity) with shape ``(body_count,)`` and type :class:`spatial_vector`.
-        """
-
-        self.body_f: wp.array | None = None
-        """Array of body forces in maximal coordinates (first three entries represent torque, last three
-        entries represent linear force) with shape ``(body_count,)`` and type :class:`spatial_vector`.
-
-        .. note::
-            :attr:`body_f` represents external wrenches in world frame and denotes wrenches measured w.r.t.
-            to the body's center of mass for all integrators except :class:`FeatherstoneIntegrator`, which
-            assumes the wrenches are measured w.r.t. world origin.
-        """
-
-        self.joint_q: wp.array | None = None
-        """Array of generalized joint coordinates with shape ``(joint_coord_count,)`` and type ``float``."""
-
-        self.joint_qd: wp.array | None = None
-        """Array of generalized joint velocities with shape ``(joint_dof_count,)`` and type ``float``."""
-
-    def clear_forces(self) -> None:
-        """Clear all forces (for particles and bodies) in the state object."""
-        with wp.ScopedTimer("clear_forces", False):
-            if self.particle_count:
-                self.particle_f.zero_()
-
-            if self.body_count:
-                self.body_f.zero_()
-
-    @property
-    def requires_grad(self) -> bool:
-        """Indicates whether the state arrays have gradient computation enabled."""
-        if self.particle_q:
-            return self.particle_q.requires_grad
-        if self.body_q:
-            return self.body_q.requires_grad
-        return False
-
-    @property
-    def body_count(self) -> int:
-        """The number of bodies represented in the state."""
-        if self.body_q is None:
-            return 0
-        return len(self.body_q)
-
-    @property
-    def particle_count(self) -> int:
-        """The number of particles represented in the state."""
-        if self.particle_q is None:
-            return 0
-        return len(self.particle_q)
-
-    @property
-    def joint_coord_count(self) -> int:
-        """The number of generalized joint position coordinates represented in the state."""
-        if self.joint_q is None:
-            return 0
-        return len(self.joint_q)
-
-    @property
-    def joint_dof_count(self) -> int:
-        """The number of generalized joint velocity coordinates represented in the state."""
-        if self.joint_qd is None:
-            return 0
-        return len(self.joint_qd)
-
-
-class Control:
-    """Time-varying control data for a :class:`Model`.
-
-    Time-varying control data includes joint control inputs, muscle activations,
-    and activation forces for triangle and tetrahedral elements.
-
-    The exact attributes depend on the contents of the model. Control objects
-    should generally be created using the :func:`Model.control()` function.
-    """
-
-    def __init__(self, model: Model | None = None):
-        if model:
-            wp.utils.warn(
-                "Passing arguments to Control's __init__ is deprecated\n"
-                "and will be disallowed in a future version. Use Control() without arguments\ninstead.",
-                category=DeprecationWarning,
-                stacklevel=2,
-            )
-
-        self.joint_act: wp.array | None = None
-        """Array of joint control inputs with shape ``(joint_axis_count,)`` and type ``float``."""
-
-        self.tri_activations: wp.array | None = None
-        """Array of triangle element activations with shape ``(tri_count,)`` and type ``float``."""
-
-        self.tet_activations: wp.array | None = None
-        """Array of tetrahedral element activations with shape with shape ``(tet_count,) and type ``float``."""
-
-        self.muscle_activations: wp.array | None = None
-        """Array of muscle activations with shape ``(muscle_count,)`` and type ``float``."""
-
-    def clear(self) -> None:
-        """Reset the control inputs to zero."""
-
-        if self.joint_act is not None:
-            self.joint_act.zero_()
-        if self.tri_activations is not None:
-            self.tri_activations.zero_()
-        if self.tet_activations is not None:
-            self.tet_activations.zero_()
-        if self.muscle_activations is not None:
-            self.muscle_activations.zero_()
-
-    def reset(self) -> None:
-        """Reset the control inputs to zero."""
-
-        wp.utils.warn(
-            "Control.reset() is deprecated and will be removed\nin a future version. Use Control.clear() instead.",
-            category=DeprecationWarning,
-            stacklevel=2,
-        )
-
-        self.clear()
-
-
-def compute_shape_mass(type, scale, src, density, is_solid, thickness):
-    """Computes the mass, center of mass and 3x3 inertia tensor of a shape
-
-    Args:
-        type: The type of shape (GEO_SPHERE, GEO_BOX, etc.)
-        scale: The scale of the shape
-        src: The source shape (Mesh or SDF)
-        density: The density of the shape
-        is_solid: Whether the shape is solid or hollow
-        thickness: The thickness of the shape (used for collision detection, and inertia computation of hollow shapes)
-
-    Returns:
-        The mass, center of mass and 3x3 inertia tensor of the shape
-    """
-    if density == 0.0 or type == GEO_PLANE:  # zero density means fixed
-        return 0.0, wp.vec3(), wp.mat33()
-
-    if type == GEO_SPHERE:
-        solid = compute_sphere_inertia(density, scale[0])
-        if is_solid:
-            return solid
-        else:
-            hollow = compute_sphere_inertia(density, scale[0] - thickness)
-            return solid[0] - hollow[0], solid[1], solid[2] - hollow[2]
-    elif type == GEO_BOX:
-        w, h, d = scale * 2.0
-        solid = compute_box_inertia(density, w, h, d)
-        if is_solid:
-            return solid
-        else:
-            hollow = compute_box_inertia(density, w - thickness, h - thickness, d - thickness)
-            return solid[0] - hollow[0], solid[1], solid[2] - hollow[2]
-    elif type == GEO_CAPSULE:
-        r, h = scale[0], scale[1] * 2.0
-        solid = compute_capsule_inertia(density, r, h)
-        if is_solid:
-            return solid
-        else:
-            hollow = compute_capsule_inertia(density, r - thickness, h - 2.0 * thickness)
-            return solid[0] - hollow[0], solid[1], solid[2] - hollow[2]
-    elif type == GEO_CYLINDER:
-        r, h = scale[0], scale[1] * 2.0
-        solid = compute_cylinder_inertia(density, r, h)
-        if is_solid:
-            return solid
-        else:
-            hollow = compute_cylinder_inertia(density, r - thickness, h - 2.0 * thickness)
-            return solid[0] - hollow[0], solid[1], solid[2] - hollow[2]
-    elif type == GEO_CONE:
-        r, h = scale[0], scale[1] * 2.0
-        solid = compute_cone_inertia(density, r, h)
-        if is_solid:
-            return solid
-        else:
-            hollow = compute_cone_inertia(density, r - thickness, h - 2.0 * thickness)
-            return solid[0] - hollow[0], solid[1], solid[2] - hollow[2]
-    elif type == GEO_MESH or type == GEO_SDF:
-        if src.has_inertia and src.mass > 0.0 and src.is_solid == is_solid:
-            m, c, I = src.mass, src.com, src.I
-
-            sx, sy, sz = scale
-
-            mass_ratio = sx * sy * sz * density
-            m_new = m * mass_ratio
-
-            c_new = wp.cw_mul(c, scale)
-
-            Ixx = I[0, 0] * (sy**2 + sz**2) / 2 * mass_ratio
-            Iyy = I[1, 1] * (sx**2 + sz**2) / 2 * mass_ratio
-            Izz = I[2, 2] * (sx**2 + sy**2) / 2 * mass_ratio
-            Ixy = I[0, 1] * sx * sy * mass_ratio
-            Ixz = I[0, 2] * sx * sz * mass_ratio
-            Iyz = I[1, 2] * sy * sz * mass_ratio
-
-            I_new = wp.mat33([[Ixx, Ixy, Ixz], [Ixy, Iyy, Iyz], [Ixz, Iyz, Izz]])
-
-            return m_new, c_new, I_new
-        elif type == GEO_MESH:
-            # fall back to computing inertia from mesh geometry
-            vertices = np.array(src.vertices) * np.array(scale)
-            m, c, I, vol = compute_mesh_inertia(density, vertices, src.indices, is_solid, thickness)
-            return m, c, I
-    raise ValueError(f"Unsupported shape type: {type}")
-
-
-class Model:
-    """Holds the definition of the simulation model
-
-    This class holds the non-time varying description of the system, i.e.:
-    all geometry, constraints, and parameters used to describe the simulation.
-
-    Attributes:
-        requires_grad (float): Indicates whether the model was finalized (see :meth:`ModelBuilder.finalize`) with gradient computation enabled
-        num_envs (int): Number of articulation environments that were added to the ModelBuilder via `add_builder`
-
-        particle_q (array): Particle positions, shape [particle_count, 3], float
-        particle_qd (array): Particle velocities, shape [particle_count, 3], float
-        particle_mass (array): Particle mass, shape [particle_count], float
-        particle_inv_mass (array): Particle inverse mass, shape [particle_count], float
-        particle_radius (array): Particle radius, shape [particle_count], float
-        particle_max_radius (float): Maximum particle radius (useful for HashGrid construction)
-        particle_ke (array): Particle normal contact stiffness (used by :class:`SemiImplicitIntegrator`), shape [particle_count], float
-        particle_kd (array): Particle normal contact damping (used by :class:`SemiImplicitIntegrator`), shape [particle_count], float
-        particle_kf (array): Particle friction force stiffness (used by :class:`SemiImplicitIntegrator`), shape [particle_count], float
-        particle_mu (array): Particle friction coefficient, shape [particle_count], float
-        particle_cohesion (array): Particle cohesion strength, shape [particle_count], float
-        particle_adhesion (array): Particle adhesion strength, shape [particle_count], float
-        particle_grid (HashGrid): HashGrid instance used for accelerated simulation of particle interactions
-        particle_flags (array): Particle enabled state, shape [particle_count], bool
-        particle_max_velocity (float): Maximum particle velocity (to prevent instability)
-
-        shape_transform (array): Rigid shape transforms, shape [shape_count, 7], float
-        shape_visible (array): Rigid shape visibility, shape [shape_count], bool
-        shape_body (array): Rigid shape body index, shape [shape_count], int
-        body_shapes (dict): Mapping from body index to list of attached shape indices
-        shape_materials (ModelShapeMaterials): Rigid shape contact materials, shape [shape_count], float
-        shape_shape_geo (ModelShapeGeometry): Shape geometry properties (geo type, scale, thickness, etc.), shape [shape_count, 3], float
-        shape_geo_src (list): List of `wp.Mesh` instances used for rendering of mesh geometry
-
-        shape_collision_group (list): Collision group of each shape, shape [shape_count], int
-        shape_collision_group_map (dict): Mapping from collision group to list of shape indices
-        shape_collision_filter_pairs (set): Pairs of shape indices that should not collide
-        shape_collision_radius (array): Collision radius of each shape used for bounding sphere broadphase collision checking, shape [shape_count], float
-        shape_ground_collision (list): Indicates whether each shape should collide with the ground, shape [shape_count], bool
-        shape_shape_collision (list): Indicates whether each shape should collide with any other shape, shape [shape_count], bool
-        shape_contact_pairs (array): Pairs of shape indices that may collide, shape [contact_pair_count, 2], int
-        shape_ground_contact_pairs (array): Pairs of shape, ground indices that may collide, shape [ground_contact_pair_count, 2], int
-
-        spring_indices (array): Particle spring indices, shape [spring_count*2], int
-        spring_rest_length (array): Particle spring rest length, shape [spring_count], float
-        spring_stiffness (array): Particle spring stiffness, shape [spring_count], float
-        spring_damping (array): Particle spring damping, shape [spring_count], float
-        spring_control (array): Particle spring activation, shape [spring_count], float
-
-        tri_indices (array): Triangle element indices, shape [tri_count*3], int
-        tri_poses (array): Triangle element rest pose, shape [tri_count, 2, 2], float
-        tri_activations (array): Triangle element activations, shape [tri_count], float
-        tri_materials (array): Triangle element materials, shape [tri_count, 5], float
-        tri_areas (array): Triangle element rest areas, shape [tri_count], float
-
-        edge_indices (array): Bending edge indices, shape [edge_count*4], int, each row is [o0, o1, v1, v2], where v1, v2 are on the edge
-        edge_rest_angle (array): Bending edge rest angle, shape [edge_count], float
-        edge_rest_length (array): Bending edge rest length, shape [edge_count], float
-        edge_bending_properties (array): Bending edge stiffness and damping parameters, shape [edge_count, 2], float
-
-        tet_indices (array): Tetrahedral element indices, shape [tet_count*4], int
-        tet_poses (array): Tetrahedral rest poses, shape [tet_count, 3, 3], float
-        tet_activations (array): Tetrahedral volumetric activations, shape [tet_count], float
-        tet_materials (array): Tetrahedral elastic parameters in form :math:`k_{mu}, k_{lambda}, k_{damp}`, shape [tet_count, 3]
-
-        muscle_start (array): Start index of the first muscle point per muscle, shape [muscle_count], int
-        muscle_params (array): Muscle parameters, shape [muscle_count, 5], float
-        muscle_bodies (array): Body indices of the muscle waypoints, int
-        muscle_points (array): Local body offset of the muscle waypoints, float
-        muscle_activations (array): Muscle activations, shape [muscle_count], float
-
-        body_q (array): Poses of rigid bodies used for state initialization, shape [body_count, 7], float
-        body_qd (array): Velocities of rigid bodies used for state initialization, shape [body_count, 6], float
-        body_com (array): Rigid body center of mass (in local frame), shape [body_count, 7], float
-        body_inertia (array): Rigid body inertia tensor (relative to COM), shape [body_count, 3, 3], float
-        body_inv_inertia (array): Rigid body inverse inertia tensor (relative to COM), shape [body_count, 3, 3], float
-        body_mass (array): Rigid body mass, shape [body_count], float
-        body_inv_mass (array): Rigid body inverse mass, shape [body_count], float
-        body_name (list): Rigid body names, shape [body_count], str
-
-        joint_q (array): Generalized joint positions used for state initialization, shape [joint_coord_count], float
-        joint_qd (array): Generalized joint velocities used for state initialization, shape [joint_dof_count], float
-        joint_act (array): Generalized joint control inputs, shape [joint_axis_count], float
-        joint_type (array): Joint type, shape [joint_count], int
-        joint_parent (array): Joint parent body indices, shape [joint_count], int
-        joint_child (array): Joint child body indices, shape [joint_count], int
-        joint_ancestor (array): Maps from joint index to the index of the joint that has the current joint parent body as child (-1 if no such joint ancestor exists), shape [joint_count], int
-        joint_X_p (array): Joint transform in parent frame, shape [joint_count, 7], float
-        joint_X_c (array): Joint mass frame in child frame, shape [joint_count, 7], float
-        joint_axis (array): Joint axis in child frame, shape [joint_axis_count, 3], float
-        joint_armature (array): Armature for each joint axis (only used by :class:`FeatherstoneIntegrator`), shape [joint_dof_count], float
-        joint_target_ke (array): Joint stiffness, shape [joint_axis_count], float
-        joint_target_kd (array): Joint damping, shape [joint_axis_count], float
-        joint_axis_start (array): Start index of the first axis per joint, shape [joint_count], int
-        joint_axis_dim (array): Number of linear and angular axes per joint, shape [joint_count, 2], int
-        joint_axis_mode (array): Joint axis mode, shape [joint_axis_count], int. See `Joint modes`_.
-        joint_linear_compliance (array): Joint linear compliance, shape [joint_count], float
-        joint_angular_compliance (array): Joint linear compliance, shape [joint_count], float
-        joint_enabled (array): Controls which joint is simulated (bodies become disconnected if False), shape [joint_count], int
-
-            Note:
-
-               This setting is not supported by :class:`FeatherstoneIntegrator`.
-
-        joint_limit_lower (array): Joint lower position limits, shape [joint_axis_count], float
-        joint_limit_upper (array): Joint upper position limits, shape [joint_axis_count], float
-        joint_limit_ke (array): Joint position limit stiffness (used by the Euler integrators), shape [joint_axis_count], float
-        joint_limit_kd (array): Joint position limit damping (used by the Euler integrators), shape [joint_axis_count], float
-        joint_twist_lower (array): Joint lower twist limit, shape [joint_count], float
-        joint_twist_upper (array): Joint upper twist limit, shape [joint_count], float
-        joint_q_start (array): Start index of the first position coordinate per joint (note the last value is an additional sentinel entry to allow for querying the q dimensionality of joint i via ``joint_q_start[i+1] - joint_q_start[i]``), shape [joint_count + 1], int
-        joint_qd_start (array): Start index of the first velocity coordinate per joint (note the last value is an additional sentinel entry to allow for querying the qd dimensionality of joint i via ``joint_qd_start[i+1] - joint_qd_start[i]``), shape [joint_count + 1], int
-        articulation_start (array): Articulation start index, shape [articulation_count], int
-        joint_name (list): Joint names, shape [joint_count], str
-        joint_attach_ke (float): Joint attachment force stiffness (used by :class:`SemiImplicitIntegrator`)
-        joint_attach_kd (float): Joint attachment force damping (used by :class:`SemiImplicitIntegrator`)
-
-        soft_contact_radius (float): Contact radius used for self-collisions in the VBD integrator.
-        soft_contact_margin (float): Contact margin for generation of soft contacts
-        soft_contact_ke (float): Stiffness of soft contacts (used by the Euler integrators)
-        soft_contact_kd (float): Damping of soft contacts (used by the Euler integrators)
-        soft_contact_kf (float): Stiffness of friction force in soft contacts (used by the Euler integrators)
-        soft_contact_mu (float): Friction coefficient of soft contacts
-        soft_contact_restitution (float): Restitution coefficient of soft contacts (used by :class:`XPBDIntegrator`)
-
-        soft_contact_count (array): Number of active particle-shape contacts, shape [1], int
-        soft_contact_particle (array), Index of particle per soft contact point, shape [soft_contact_max], int
-        soft_contact_shape (array), Index of shape per soft contact point, shape [soft_contact_max], int
-        soft_contact_body_pos (array), Positional offset of soft contact point in body frame, shape [soft_contact_max], vec3
-        soft_contact_body_vel (array), Linear velocity of soft contact point in body frame, shape [soft_contact_max], vec3
-        soft_contact_normal (array), Contact surface normal of soft contact point in world space, shape [soft_contact_max], vec3
-        soft_contact_tids (array), Thread indices of the soft contact points, shape [soft_contact_max], int
-
-        rigid_contact_max (int): Maximum number of potential rigid body contact points to generate ignoring the `rigid_mesh_contact_max` limit.
-        rigid_contact_max_limited (int): Maximum number of potential rigid body contact points to generate respecting the `rigid_mesh_contact_max` limit.
-        rigid_mesh_contact_max (int): Maximum number of rigid body contact points to generate per mesh (0 = unlimited, default)
-        rigid_contact_margin (float): Contact margin for generation of rigid body contacts
-        rigid_contact_torsional_friction (float): Torsional friction coefficient for rigid body contacts (used by :class:`XPBDIntegrator`)
-        rigid_contact_rolling_friction (float): Rolling friction coefficient for rigid body contacts (used by :class:`XPBDIntegrator`)
-
-        rigid_contact_count (array): Number of active shape-shape contacts, shape [1], int
-        rigid_contact_point0 (array): Contact point relative to frame of body 0, shape [rigid_contact_max], vec3
-        rigid_contact_point1 (array): Contact point relative to frame of body 1, shape [rigid_contact_max], vec3
-        rigid_contact_offset0 (array): Contact offset due to contact thickness relative to body 0, shape [rigid_contact_max], vec3
-        rigid_contact_offset1 (array): Contact offset due to contact thickness relative to body 1, shape [rigid_contact_max], vec3
-        rigid_contact_normal (array): Contact normal in world space, shape [rigid_contact_max], vec3
-        rigid_contact_thickness (array): Total contact thickness, shape [rigid_contact_max], float
-        rigid_contact_shape0 (array): Index of shape 0 per contact, shape [rigid_contact_max], int
-        rigid_contact_shape1 (array): Index of shape 1 per contact, shape [rigid_contact_max], int
-        rigid_contact_tids (array): Triangle indices of the contact points, shape [rigid_contact_max], int
-        rigid_contact_pairwise_counter (array): Pairwise counter for contact generation, shape [rigid_contact_max], int
-        rigid_contact_broad_shape0 (array): Broadphase shape index of shape 0 per contact, shape [rigid_contact_max], int
-        rigid_contact_broad_shape1 (array): Broadphase shape index of shape 1 per contact, shape [rigid_contact_max], int
-        rigid_contact_point_id (array): Contact point ID, shape [rigid_contact_max], int
-        rigid_contact_point_limit (array): Contact point limit, shape [rigid_contact_max], int
-
-        ground (bool): Whether the ground plane and ground contacts are enabled
-        ground_plane (array): Ground plane 3D normal and offset, shape [4], float
-        up_vector (np.ndarray): Up vector of the world, shape [3], float
-        up_axis (int): Up axis, 0 for x, 1 for y, 2 for z
-        gravity (np.ndarray): Gravity vector, shape [3], float
-
-        particle_count (int): Total number of particles in the system
-        body_count (int): Total number of bodies in the system
-        shape_count (int): Total number of shapes in the system
-        joint_count (int): Total number of joints in the system
-        tri_count (int): Total number of triangles in the system
-        tet_count (int): Total number of tetrahedra in the system
-        edge_count (int): Total number of edges in the system
-        spring_count (int): Total number of springs in the system
-        contact_count (int): Total number of contacts in the system
-        muscle_count (int): Total number of muscles in the system
-        articulation_count (int): Total number of articulations in the system
-        joint_dof_count (int): Total number of velocity degrees of freedom of all joints in the system
-        joint_coord_count (int): Total number of position degrees of freedom of all joints in the system
-
-        particle_color_groups (list of array): The coloring of all the particles, used for VBD's Gauss-Seidel iteration. Each array contains indices of particles sharing the same color.
-        particle_colors (array): Contains the color assignment for every particle
-
-        device (wp.Device): Device on which the Model was allocated
-
-    Note:
-        It is strongly recommended to use the ModelBuilder to construct a simulation rather
-        than creating your own Model object directly, however it is possible to do so if
-        desired.
-    """
-
-    def __init__(self, device=None):
-        self.requires_grad = False
-        self.num_envs = 0
-
-        self.particle_q = None
-        self.particle_qd = None
-        self.particle_mass = None
-        self.particle_inv_mass = None
-        self.particle_radius = None
-        self.particle_max_radius = 0.0
-        self.particle_ke = 1.0e3
-        self.particle_kd = 1.0e2
-        self.particle_kf = 1.0e2
-        self.particle_mu = 0.5
-        self.particle_cohesion = 0.0
-        self.particle_adhesion = 0.0
-        self.particle_grid = None
-        self.particle_flags = None
-        self.particle_max_velocity = 1e5
-
-        self.shape_transform = None
-        self.shape_body = None
-        self.shape_visible = None
-        self.body_shapes = {}
-        self.shape_materials = ModelShapeMaterials()
-        self.shape_geo = ModelShapeGeometry()
-        self.shape_geo_src = None
-
-        self.shape_collision_group = None
-        self.shape_collision_group_map = None
-        self.shape_collision_filter_pairs = None
-        self.shape_collision_radius = None
-        self.shape_ground_collision = None
-        self.shape_shape_collision = None
-        self.shape_contact_pairs = None
-        self.shape_ground_contact_pairs = None
-
-        self.spring_indices = None
-        self.spring_rest_length = None
-        self.spring_stiffness = None
-        self.spring_damping = None
-        self.spring_control = None
-        self.spring_constraint_lambdas = None
-
-        self.tri_indices = None
-        self.tri_poses = None
-        self.tri_activations = None
-        self.tri_materials = None
-        self.tri_areas = None
-
-        self.edge_indices = None
-        self.edge_rest_angle = None
-        self.edge_rest_length = None
-        self.edge_bending_properties = None
-        self.edge_constraint_lambdas = None
-
-        self.tet_indices = None
-        self.tet_poses = None
-        self.tet_activations = None
-        self.tet_materials = None
-
-        self.muscle_start = None
-        self.muscle_params = None
-        self.muscle_bodies = None
-        self.muscle_points = None
-        self.muscle_activations = None
-
-        self.body_q = None
-        self.body_qd = None
-        self.body_com = None
-        self.body_inertia = None
-        self.body_inv_inertia = None
-        self.body_mass = None
-        self.body_inv_mass = None
-        self.body_name = None
-
-        self.joint_q = None
-        self.joint_qd = None
-        self.joint_act = None
-        self.joint_type = None
-        self.joint_parent = None
-        self.joint_child = None
-        self.joint_ancestor = None
-        self.joint_X_p = None
-        self.joint_X_c = None
-        self.joint_axis = None
-        self.joint_armature = None
-        self.joint_target_ke = None
-        self.joint_target_kd = None
-        self.joint_axis_start = None
-        self.joint_axis_dim = None
-        self.joint_axis_mode = None
-        self.joint_linear_compliance = None
-        self.joint_angular_compliance = None
-        self.joint_enabled = None
-        self.joint_limit_lower = None
-        self.joint_limit_upper = None
-        self.joint_limit_ke = None
-        self.joint_limit_kd = None
-        self.joint_twist_lower = None
-        self.joint_twist_upper = None
-        self.joint_q_start = None
-        self.joint_qd_start = None
-        self.articulation_start = None
-        self.joint_name = None
-
-        # todo: per-joint values?
-        self.joint_attach_ke = 1.0e3
-        self.joint_attach_kd = 1.0e2
-
-        self.soft_contact_radius = 0.2
-        self.soft_contact_margin = 0.2
-        self.soft_contact_ke = 1.0e3
-        self.soft_contact_kd = 10.0
-        self.soft_contact_kf = 1.0e3
-        self.soft_contact_mu = 0.5
-        self.soft_contact_restitution = 0.0
-
-        self.soft_contact_count = 0
-        self.soft_contact_particle = None
-        self.soft_contact_shape = None
-        self.soft_contact_body_pos = None
-        self.soft_contact_body_vel = None
-        self.soft_contact_normal = None
-        self.soft_contact_tids = None
-
-        self.rigid_contact_max = 0
-        self.rigid_contact_max_limited = 0
-        self.rigid_mesh_contact_max = 0
-        self.rigid_contact_margin = None
-        self.rigid_contact_torsional_friction = None
-        self.rigid_contact_rolling_friction = None
-
-        self.rigid_contact_count = None
-        self.rigid_contact_point0 = None
-        self.rigid_contact_point1 = None
-        self.rigid_contact_offset0 = None
-        self.rigid_contact_offset1 = None
-        self.rigid_contact_normal = None
-        self.rigid_contact_thickness = None
-        self.rigid_contact_shape0 = None
-        self.rigid_contact_shape1 = None
-        self.rigid_contact_tids = None
-        self.rigid_contact_pairwise_counter = None
-        self.rigid_contact_broad_shape0 = None
-        self.rigid_contact_broad_shape1 = None
-        self.rigid_contact_point_id = None
-        self.rigid_contact_point_limit = None
-
-        # toggles ground contact for all shapes
-        self.ground = True
-        self.ground_plane = None
-        self.up_vector = np.array((0.0, 1.0, 0.0))
-        self.up_axis = 1
-        self.gravity = np.array((0.0, -9.80665, 0.0))
-
-        self.particle_count = 0
-        self.body_count = 0
-        self.shape_count = 0
-        self.joint_count = 0
-        self.joint_axis_count = 0
-        self.tri_count = 0
-        self.tet_count = 0
-        self.edge_count = 0
-        self.spring_count = 0
-        self.muscle_count = 0
-        self.articulation_count = 0
-        self.joint_dof_count = 0
-        self.joint_coord_count = 0
-
-        # indices of particles sharing the same color
-        self.particle_color_groups = []
-        # the color of each particles
-        self.particle_colors = None
-
-        self.device = wp.get_device(device)
-
-    def state(self, requires_grad=None) -> State:
-        """Returns a state object for the model
-
-        The returned state will be initialized with the initial configuration given in
-        the model description.
-
-        Args:
-            requires_grad (bool): Manual overwrite whether the state variables should have `requires_grad` enabled (defaults to `None` to use the model's setting :attr:`requires_grad`)
-
-        Returns:
-            State: The state object
-        """
-
-        s = State()
-        if requires_grad is None:
-            requires_grad = self.requires_grad
-
-        # particles
-        if self.particle_count:
-            s.particle_q = wp.clone(self.particle_q, requires_grad=requires_grad)
-            s.particle_qd = wp.clone(self.particle_qd, requires_grad=requires_grad)
-            s.particle_f = wp.zeros_like(self.particle_qd, requires_grad=requires_grad)
-
-        # articulations
-        if self.body_count:
-            s.body_q = wp.clone(self.body_q, requires_grad=requires_grad)
-            s.body_qd = wp.clone(self.body_qd, requires_grad=requires_grad)
-            s.body_f = wp.zeros_like(self.body_qd, requires_grad=requires_grad)
-
-        if self.joint_count:
-            s.joint_q = wp.clone(self.joint_q, requires_grad=requires_grad)
-            s.joint_qd = wp.clone(self.joint_qd, requires_grad=requires_grad)
-
-        return s
-
-    def control(self, requires_grad=None, clone_variables=True) -> Control:
-        """
-        Returns a control object for the model.
-
-        The returned control object will be initialized with the control inputs given in the model description.
-
-        Args:
-            requires_grad (bool): Manual overwrite whether the control variables should have `requires_grad` enabled (defaults to `None` to use the model's setting :attr:`requires_grad`)
-            clone_variables (bool): Whether to clone the control inputs or use the original data
-
-        Returns:
-            Control: The control object
-        """
-        c = Control()
-        if requires_grad is None:
-            requires_grad = self.requires_grad
-        if clone_variables:
-            if self.joint_count:
-                c.joint_act = wp.clone(self.joint_act, requires_grad=requires_grad)
-            if self.tri_count:
-                c.tri_activations = wp.clone(self.tri_activations, requires_grad=requires_grad)
-            if self.tet_count:
-                c.tet_activations = wp.clone(self.tet_activations, requires_grad=requires_grad)
-            if self.muscle_count:
-                c.muscle_activations = wp.clone(self.muscle_activations, requires_grad=requires_grad)
-        else:
-            c.joint_act = self.joint_act
-            c.tri_activations = self.tri_activations
-            c.tet_activations = self.tet_activations
-            c.muscle_activations = self.muscle_activations
-        return c
-
-    def _allocate_soft_contacts(self, target, count, requires_grad=False):
-        with wp.ScopedDevice(self.device):
-            target.soft_contact_count = wp.zeros(1, dtype=wp.int32)
-            target.soft_contact_particle = wp.zeros(count, dtype=int)
-            target.soft_contact_shape = wp.zeros(count, dtype=int)
-            target.soft_contact_body_pos = wp.zeros(count, dtype=wp.vec3, requires_grad=requires_grad)
-            target.soft_contact_body_vel = wp.zeros(count, dtype=wp.vec3, requires_grad=requires_grad)
-            target.soft_contact_normal = wp.zeros(count, dtype=wp.vec3, requires_grad=requires_grad)
-            target.soft_contact_tids = wp.zeros(self.particle_count * (self.shape_count - 1), dtype=int)
-
-    def allocate_soft_contacts(self, count, requires_grad=False):
-        self._allocate_soft_contacts(self, count, requires_grad)
-
-    def find_shape_contact_pairs(self):
-        # find potential contact pairs based on collision groups and collision mask (pairwise filtering)
-        import copy
-        import itertools
-
-        filters = copy.copy(self.shape_collision_filter_pairs)
-        for a, b in self.shape_collision_filter_pairs:
-            filters.add((b, a))
-        contact_pairs = []
-        # iterate over collision groups (islands)
-        for group, shapes in self.shape_collision_group_map.items():
-            for shape_a, shape_b in itertools.product(shapes, shapes):
-                if not self.shape_shape_collision[shape_a]:
-                    continue
-                if not self.shape_shape_collision[shape_b]:
-                    continue
-                if shape_a < shape_b and (shape_a, shape_b) not in filters:
-                    contact_pairs.append((shape_a, shape_b))
-            if group != -1 and -1 in self.shape_collision_group_map:
-                # shapes with collision group -1 collide with all other shapes
-                for shape_a, shape_b in itertools.product(shapes, self.shape_collision_group_map[-1]):
-                    if shape_a < shape_b and (shape_a, shape_b) not in filters:
-                        contact_pairs.append((shape_a, shape_b))
-        self.shape_contact_pairs = wp.array(np.array(contact_pairs), dtype=wp.int32, device=self.device)
-        self.shape_contact_pair_count = len(contact_pairs)
-        # find ground contact pairs
-        ground_contact_pairs = []
-        ground_id = self.shape_count - 1
-        for i in range(ground_id):
-            if self.shape_ground_collision[i]:
-                ground_contact_pairs.append((i, ground_id))
-        self.shape_ground_contact_pairs = wp.array(np.array(ground_contact_pairs), dtype=wp.int32, device=self.device)
-        self.shape_ground_contact_pair_count = len(ground_contact_pairs)
-
-    def count_contact_points(self):
-        """
-        Counts the maximum number of rigid contact points that need to be allocated.
-        This function returns two values corresponding to the maximum number of potential contacts
-        excluding the limiting from `Model.rigid_mesh_contact_max` and the maximum number of
-        contact points that may be generated when considering the `Model.rigid_mesh_contact_max` limit.
-
-        :returns:
-            - potential_count (int): Potential number of contact points
-            - actual_count (int): Actual number of contact points
-        """
-        from .collide import count_contact_points
-
-        # calculate the potential number of shape pair contact points
-        contact_count = wp.zeros(2, dtype=wp.int32, device=self.device)
-        wp.launch(
-            kernel=count_contact_points,
-            dim=self.shape_contact_pair_count,
-            inputs=[
-                self.shape_contact_pairs,
-                self.shape_geo,
-                self.rigid_mesh_contact_max,
-            ],
-            outputs=[contact_count],
-            device=self.device,
-            record_tape=False,
-        )
-        # count ground contacts
-        wp.launch(
-            kernel=count_contact_points,
-            dim=self.shape_ground_contact_pair_count,
-            inputs=[
-                self.shape_ground_contact_pairs,
-                self.shape_geo,
-                self.rigid_mesh_contact_max,
-            ],
-            outputs=[contact_count],
-            device=self.device,
-            record_tape=False,
-        )
-        counts = contact_count.numpy()
-        potential_count = int(counts[0])
-        actual_count = int(counts[1])
-        return potential_count, actual_count
-
-    def allocate_rigid_contacts(self, target=None, count=None, limited_contact_count=None, requires_grad=False):
-        if count is not None:
-            # potential number of contact points to consider
-            self.rigid_contact_max = count
-        if limited_contact_count is not None:
-            self.rigid_contact_max_limited = limited_contact_count
-        if target is None:
-            target = self
-
-        with wp.ScopedDevice(self.device):
-            # serves as counter of the number of active contact points
-            target.rigid_contact_count = wp.zeros(1, dtype=wp.int32)
-            # contact point ID within the (shape_a, shape_b) contact pair
-            target.rigid_contact_point_id = wp.zeros(self.rigid_contact_max, dtype=wp.int32)
-            # position of contact point in body 0's frame before the integration step
-            target.rigid_contact_point0 = wp.zeros(
-                self.rigid_contact_max_limited, dtype=wp.vec3, requires_grad=requires_grad
-            )
-            # position of contact point in body 1's frame before the integration step
-            target.rigid_contact_point1 = wp.zeros(
-                self.rigid_contact_max_limited, dtype=wp.vec3, requires_grad=requires_grad
-            )
-            # moment arm before the integration step resulting from thickness displacement added to contact point 0 in body 0's frame (used in XPBD contact friction handling)
-            target.rigid_contact_offset0 = wp.zeros(
-                self.rigid_contact_max_limited, dtype=wp.vec3, requires_grad=requires_grad
-            )
-            # moment arm before the integration step resulting from thickness displacement added to contact point 1 in body 1's frame (used in XPBD contact friction handling)
-            target.rigid_contact_offset1 = wp.zeros(
-                self.rigid_contact_max_limited, dtype=wp.vec3, requires_grad=requires_grad
-            )
-            # contact normal in world frame
-            target.rigid_contact_normal = wp.zeros(
-                self.rigid_contact_max_limited, dtype=wp.vec3, requires_grad=requires_grad
-            )
-            # combined thickness of both shapes
-            target.rigid_contact_thickness = wp.zeros(
-                self.rigid_contact_max_limited, dtype=wp.float32, requires_grad=requires_grad
-            )
-            # ID of the first shape in the contact pair
-            target.rigid_contact_shape0 = wp.zeros(self.rigid_contact_max_limited, dtype=wp.int32)
-            # ID of the second shape in the contact pair
-            target.rigid_contact_shape1 = wp.zeros(self.rigid_contact_max_limited, dtype=wp.int32)
-
-            # shape IDs of potential contact pairs found during broadphase
-            target.rigid_contact_broad_shape0 = wp.zeros(self.rigid_contact_max, dtype=wp.int32)
-            target.rigid_contact_broad_shape1 = wp.zeros(self.rigid_contact_max, dtype=wp.int32)
-
-            if self.rigid_mesh_contact_max > 0:
-                # add additional buffers to track how many contact points are generated per contact pair
-                # (significantly increases memory usage, only enable if mesh contacts need to be pruned)
-                if self.shape_count >= 46340:
-                    # clip the number of potential contacts to avoid signed 32-bit integer overflow
-                    # i.e. when the number of shapes exceeds sqrt(2**31 - 1)
-                    max_pair_count = 2**31 - 1
-                else:
-                    max_pair_count = self.shape_count * self.shape_count
-                # maximum number of contact points per contact pair
-                target.rigid_contact_point_limit = wp.zeros(max_pair_count, dtype=wp.int32)
-                # currently found contacts per contact pair
-                target.rigid_contact_pairwise_counter = wp.zeros(max_pair_count, dtype=wp.int32)
-            else:
-                target.rigid_contact_point_limit = None
-                target.rigid_contact_pairwise_counter = None
-
-            # ID of thread that found the current contact point
-            target.rigid_contact_tids = wp.zeros(self.rigid_contact_max, dtype=wp.int32)
-
-    @property
-    def soft_contact_max(self):
-        """Maximum number of soft contacts that can be registered"""
-        if self.soft_contact_particle is None:
-            return 0
-        return len(self.soft_contact_particle)
-
-
-class ModelBuilder:
-    """A helper class for building simulation models at runtime.
-
-    Use the ModelBuilder to construct a simulation scene. The ModelBuilder
-    and builds the scene representation using standard Python data structures (lists),
-    this means it is not differentiable. Once :func:`finalize()`
-    has been called the ModelBuilder transfers all data to Warp tensors and returns
-    an object that may be used for simulation.
-
-    Example
-    -------
-
-    .. code-block:: python
-
-        import warp as wp
-        import warp.sim
-
-        builder = wp.sim.ModelBuilder()
-
-        # anchor point (zero mass)
-        builder.add_particle((0, 1.0, 0.0), (0.0, 0.0, 0.0), 0.0)
-
-        # build chain
-        for i in range(1, 10):
-            builder.add_particle((i, 1.0, 0.0), (0.0, 0.0, 0.0), 1.0)
-            builder.add_spring(i - 1, i, 1.0e3, 0.0, 0)
-
-        # create model
-        model = builder.finalize("cuda")
-
-        state = model.state()
-        control = model.control()  # optional, to support time-varying control inputs
-        integrator = wp.sim.SemiImplicitIntegrator()
-
-        for i in range(100):
-            state.clear_forces()
-            integrator.simulate(model, state, state, dt=1.0 / 60.0, control=control)
-
-    Note:
-        It is strongly recommended to use the ModelBuilder to construct a simulation rather
-        than creating your own Model object directly, however it is possible to do so if
-        desired.
-    """
-
-    # Default particle settings
-    default_particle_radius = 0.1
-
-    # Default triangle soft mesh settings
-    default_tri_ke = 100.0
-    default_tri_ka = 100.0
-    default_tri_kd = 10.0
-    default_tri_drag = 0.0
-    default_tri_lift = 0.0
-
-    # Default distance constraint properties
-    default_spring_ke = 100.0
-    default_spring_kd = 0.0
-
-    # Default edge bending properties
-    default_edge_ke = 100.0
-    default_edge_kd = 0.0
-
-    # Default rigid shape contact material properties
-    default_shape_ke = 1.0e5
-    default_shape_kd = 1000.0
-    default_shape_kf = 1000.0
-    default_shape_ka = 0.0
-    default_shape_mu = 0.5
-    default_shape_restitution = 0.0
-    default_shape_density = 1000.0
-    default_shape_thickness = 1e-5
-
-    # Default joint settings
-    default_joint_limit_ke = 100.0
-    default_joint_limit_kd = 1.0
-
-    def __init__(self, up_vector=(0.0, 1.0, 0.0), gravity=-9.80665):
-        self.num_envs = 0
-
-        # particles
-        self.particle_q = []
-        self.particle_qd = []
-        self.particle_mass = []
-        self.particle_radius = []
-        self.particle_flags = []
-        self.particle_max_velocity = 1e5
-        # list of np.array
-        self.particle_color_groups = []
-
-        # shapes (each shape has an entry in these arrays)
-        # transform from shape to body
-        self.shape_transform = []
-        # maps from shape index to body index
-        self.shape_body = []
-        self.shape_visible = []
-        self.shape_geo_type = []
-        self.shape_geo_scale = []
-        self.shape_geo_src = []
-        self.shape_geo_is_solid = []
-        self.shape_geo_thickness = []
-        self.shape_material_ke = []
-        self.shape_material_kd = []
-        self.shape_material_kf = []
-        self.shape_material_ka = []
-        self.shape_material_mu = []
-        self.shape_material_restitution = []
-        # collision groups within collisions are handled
-        self.shape_collision_group = []
-        self.shape_collision_group_map = {}
-        self.last_collision_group = 0
-        # radius to use for broadphase collision checking
-        self.shape_collision_radius = []
-        # whether the shape collides with the ground
-        self.shape_ground_collision = []
-        # whether the shape collides with any other shape
-        self.shape_shape_collision = []
-
-        # filtering to ignore certain collision pairs
-        self.shape_collision_filter_pairs = set()
-
-        # geometry
-        self.geo_meshes = []
-        self.geo_sdfs = []
-
-        # springs
-        self.spring_indices = []
-        self.spring_rest_length = []
-        self.spring_stiffness = []
-        self.spring_damping = []
-        self.spring_control = []
-
-        # triangles
-        self.tri_indices = []
-        self.tri_poses = []
-        self.tri_activations = []
-        self.tri_materials = []
-        self.tri_areas = []
-
-        # edges (bending)
-        self.edge_indices = []
-        self.edge_rest_angle = []
-        self.edge_rest_length = []
-        self.edge_bending_properties = []
-
-        # tetrahedra
-        self.tet_indices = []
-        self.tet_poses = []
-        self.tet_activations = []
-        self.tet_materials = []
-
-        # muscles
-        self.muscle_start = []
-        self.muscle_params = []
-        self.muscle_activations = []
-        self.muscle_bodies = []
-        self.muscle_points = []
-
-        # rigid bodies
-        self.body_mass = []
-        self.body_inertia = []
-        self.body_inv_mass = []
-        self.body_inv_inertia = []
-        self.body_com = []
-        self.body_q = []
-        self.body_qd = []
-        self.body_name = []
-        self.body_shapes = {}  # mapping from body to shapes
-
-        # rigid joints
-        self.joint_parent = []  # index of the parent body                      (constant)
-        self.joint_parents = {}  # mapping from joint to parent bodies
-        self.joint_child = []  # index of the child body                       (constant)
-        self.joint_axis = []  # joint axis in child joint frame               (constant)
-        self.joint_X_p = []  # frame of joint in parent                      (constant)
-        self.joint_X_c = []  # frame of child com (in child coordinates)     (constant)
-        self.joint_q = []
-        self.joint_qd = []
-
-        self.joint_type = []
-        self.joint_name = []
-        self.joint_armature = []
-        self.joint_target_ke = []
-        self.joint_target_kd = []
-        self.joint_axis_mode = []
-        self.joint_limit_lower = []
-        self.joint_limit_upper = []
-        self.joint_limit_ke = []
-        self.joint_limit_kd = []
-        self.joint_act = []
-
-        self.joint_twist_lower = []
-        self.joint_twist_upper = []
-
-        self.joint_linear_compliance = []
-        self.joint_angular_compliance = []
-        self.joint_enabled = []
-
-        self.joint_q_start = []
-        self.joint_qd_start = []
-        self.joint_axis_start = []
-        self.joint_axis_dim = []
-        self.articulation_start = []
-
-        self.joint_dof_count = 0
-        self.joint_coord_count = 0
-        self.joint_axis_total_count = 0
-
-        self.up_vector = wp.vec3(up_vector)
-        self.up_axis = int(np.argmax(np.abs(up_vector)))
-        self.gravity = gravity
-        # indicates whether a ground plane has been created
-        self._ground_created = False
-        # constructor parameters for ground plane shape
-        self._ground_params = {
-            "plane": (*up_vector, 0.0),
-            "width": 0.0,
-            "length": 0.0,
-            "ke": self.default_shape_ke,
-            "kd": self.default_shape_kd,
-            "kf": self.default_shape_kf,
-            "mu": self.default_shape_mu,
-            "restitution": self.default_shape_restitution,
-        }
-
-        # Maximum number of soft contacts that can be registered
-        self.soft_contact_max = 64 * 1024
-
-        # maximum number of contact points to generate per mesh shape
-        self.rigid_mesh_contact_max = 0  # 0 = unlimited
-
-        # contacts to be generated within the given distance margin to be generated at
-        # every simulation substep (can be 0 if only one PBD solver iteration is used)
-        self.rigid_contact_margin = 0.1
-        # torsional friction coefficient (only considered by XPBD so far)
-        self.rigid_contact_torsional_friction = 0.5
-        # rolling friction coefficient (only considered by XPBD so far)
-        self.rigid_contact_rolling_friction = 0.001
-
-        # number of rigid contact points to allocate in the model during self.finalize() per environment
-        # if setting is None, the number of worst-case number of contacts will be calculated in self.finalize()
-        self.num_rigid_contacts_per_env = None
-
-    @property
-    def shape_count(self):
-        return len(self.shape_geo_type)
-
-    @property
-    def body_count(self):
-        return len(self.body_q)
-
-    @property
-    def joint_count(self):
-        return len(self.joint_type)
-
-    @property
-    def joint_axis_count(self):
-        return len(self.joint_axis)
-
-    @property
-    def particle_count(self):
-        return len(self.particle_q)
-
-    @property
-    def tri_count(self):
-        return len(self.tri_poses)
-
-    @property
-    def tet_count(self):
-        return len(self.tet_poses)
-
-    @property
-    def edge_count(self):
-        return len(self.edge_rest_angle)
-
-    @property
-    def spring_count(self):
-        return len(self.spring_rest_length)
-
-    @property
-    def muscle_count(self):
-        return len(self.muscle_start)
-
-    @property
-    def articulation_count(self):
-        return len(self.articulation_start)
-
-    # an articulation is a set of contiguous bodies bodies from articulation_start[i] to articulation_start[i+1]
-    # these are used for computing forward kinematics e.g.:
-    #
-    # model.eval_articulation_fk()
-    # model.eval_articulation_j()
-    # model.eval_articulation_m()
-    #
-    # articulations are automatically 'closed' when calling finalize
-
-    def add_articulation(self):
-        self.articulation_start.append(self.joint_count)
-
-    def add_builder(
-        self,
-        builder: ModelBuilder,
-        xform: Transform | None = None,
-        update_num_env_count: bool = True,
-        separate_collision_group: bool = True,
-    ):
-        """Copies the data from `builder`, another `ModelBuilder` to this `ModelBuilder`.
-
-        Args:
-            builder (ModelBuilder): a model builder to add model data from.
-            xform (:ref:`transform <transform>`): offset transform applied to root bodies.
-            update_num_env_count (bool): if True, the number of environments is incremented by 1.
-            separate_collision_group (bool): if True, the shapes from the articulations in `builder` will all be put into a single new collision group, otherwise, only the shapes in collision group > -1 will be moved to a new group.
-        """
-
-        start_particle_idx = self.particle_count
-        if builder.particle_count:
-            self.particle_max_velocity = builder.particle_max_velocity
-            if xform is not None:
-                pos_offset = wp.transform_get_translation(xform)
-            else:
-                pos_offset = np.zeros(3)
-            self.particle_q.extend((np.array(builder.particle_q) + pos_offset).tolist())
-            # other particle attributes are added below
-
-        if builder.spring_count:
-            self.spring_indices.extend((np.array(builder.spring_indices, dtype=np.int32) + start_particle_idx).tolist())
-        if builder.edge_count:
-            # Update edge indices by adding offset, preserving -1 values
-            edge_indices = np.array(builder.edge_indices, dtype=np.int32)
-            mask = edge_indices != -1
-            edge_indices[mask] += start_particle_idx
-            self.edge_indices.extend(edge_indices.tolist())
-        if builder.tri_count:
-            self.tri_indices.extend((np.array(builder.tri_indices, dtype=np.int32) + start_particle_idx).tolist())
-        if builder.tet_count:
-            self.tet_indices.extend((np.array(builder.tet_indices, dtype=np.int32) + start_particle_idx).tolist())
-
-        builder_coloring_translated = [group + start_particle_idx for group in builder.particle_color_groups]
-        self.particle_color_groups = combine_independent_particle_coloring(
-            self.particle_color_groups, builder_coloring_translated
-        )
-
-        start_body_idx = self.body_count
-        start_shape_idx = self.shape_count
-        for s, b in enumerate(builder.shape_body):
-            if b > -1:
-                new_b = b + start_body_idx
-                self.shape_body.append(new_b)
-                self.shape_transform.append(builder.shape_transform[s])
-            else:
-                self.shape_body.append(-1)
-                # apply offset transform to root bodies
-                if xform is not None:
-                    self.shape_transform.append(xform * wp.transform(*builder.shape_transform[s]))
-                else:
-                    self.shape_transform.append(builder.shape_transform[s])
-
-        for b, shapes in builder.body_shapes.items():
-            self.body_shapes[b + start_body_idx] = [s + start_shape_idx for s in shapes]
-
-        if builder.joint_count:
-            joint_X_p = copy.deepcopy(builder.joint_X_p)
-            joint_q = copy.deepcopy(builder.joint_q)
-            if xform is not None:
-                for i in range(len(joint_X_p)):
-                    if builder.joint_type[i] == wp.sim.JOINT_FREE:
-                        qi = builder.joint_q_start[i]
-                        xform_prev = wp.transform(joint_q[qi : qi + 3], joint_q[qi + 3 : qi + 7])
-                        tf = xform * xform_prev
-                        joint_q[qi : qi + 3] = tf.p
-                        joint_q[qi + 3 : qi + 7] = tf.q
-                    elif builder.joint_parent[i] == -1:
-                        joint_X_p[i] = xform * wp.transform(*joint_X_p[i])
-            self.joint_X_p.extend(joint_X_p)
-            self.joint_q.extend(joint_q)
-
-            # offset the indices
-            self.articulation_start.extend([a + self.joint_count for a in builder.articulation_start])
-            self.joint_parent.extend([p + self.body_count if p != -1 else -1 for p in builder.joint_parent])
-            self.joint_child.extend([c + self.body_count for c in builder.joint_child])
-
-            self.joint_q_start.extend([c + self.joint_coord_count for c in builder.joint_q_start])
-            self.joint_qd_start.extend([c + self.joint_dof_count for c in builder.joint_qd_start])
-
-            self.joint_axis_start.extend([a + self.joint_axis_total_count for a in builder.joint_axis_start])
-
-        for i in range(builder.body_count):
-            if xform is not None:
-                self.body_q.append(xform * wp.transform(*builder.body_q[i]))
-            else:
-                self.body_q.append(builder.body_q[i])
-
-        # apply collision group
-        if separate_collision_group:
-            self.shape_collision_group.extend([self.last_collision_group + 1 for _ in builder.shape_collision_group])
-        else:
-            self.shape_collision_group.extend(
-                [(g + self.last_collision_group if g > -1 else -1) for g in builder.shape_collision_group]
-            )
-        shape_count = self.shape_count
-        for i, j in builder.shape_collision_filter_pairs:
-            self.shape_collision_filter_pairs.add((i + shape_count, j + shape_count))
-        for group, shapes in builder.shape_collision_group_map.items():
-            if separate_collision_group:
-                extend_group = self.last_collision_group + 1
-            else:
-                extend_group = group + self.last_collision_group if group > -1 else -1
-
-            if extend_group not in self.shape_collision_group_map:
-                self.shape_collision_group_map[extend_group] = []
-
-            self.shape_collision_group_map[extend_group].extend([s + shape_count for s in shapes])
-
-        # update last collision group counter
-        if separate_collision_group:
-            self.last_collision_group += 1
-        elif builder.last_collision_group > -1:
-            self.last_collision_group += builder.last_collision_group
-
-        more_builder_attrs = [
-            "body_inertia",
-            "body_mass",
-            "body_inv_inertia",
-            "body_inv_mass",
-            "body_com",
-            "body_qd",
-            "body_name",
-            "joint_type",
-            "joint_enabled",
-            "joint_X_c",
-            "joint_armature",
-            "joint_axis",
-            "joint_axis_dim",
-            "joint_axis_mode",
-            "joint_name",
-            "joint_qd",
-            "joint_act",
-            "joint_limit_lower",
-            "joint_limit_upper",
-            "joint_limit_ke",
-            "joint_limit_kd",
-            "joint_target_ke",
-            "joint_target_kd",
-            "joint_linear_compliance",
-            "joint_angular_compliance",
-            "shape_visible",
-            "shape_geo_type",
-            "shape_geo_scale",
-            "shape_geo_src",
-            "shape_geo_is_solid",
-            "shape_geo_thickness",
-            "shape_material_ke",
-            "shape_material_kd",
-            "shape_material_kf",
-            "shape_material_ka",
-            "shape_material_mu",
-            "shape_material_restitution",
-            "shape_collision_radius",
-            "shape_ground_collision",
-            "shape_shape_collision",
-            "particle_qd",
-            "particle_mass",
-            "particle_radius",
-            "particle_flags",
-            "edge_rest_angle",
-            "edge_rest_length",
-            "edge_bending_properties",
-            "spring_rest_length",
-            "spring_stiffness",
-            "spring_damping",
-            "spring_control",
-            "tri_poses",
-            "tri_activations",
-            "tri_materials",
-            "tri_areas",
-            "tet_poses",
-            "tet_activations",
-            "tet_materials",
-        ]
-
-        for attr in more_builder_attrs:
-            getattr(self, attr).extend(getattr(builder, attr))
-
-        self.joint_dof_count += builder.joint_dof_count
-        self.joint_coord_count += builder.joint_coord_count
-        self.joint_axis_total_count += builder.joint_axis_total_count
-
-        self.up_vector = builder.up_vector
-        self.gravity = builder.gravity
-        self._ground_params = builder._ground_params
-
-        if update_num_env_count:
-            self.num_envs += 1
-
-    # register a rigid body and return its index.
-    def add_body(
-        self,
-        origin: Transform | None = None,
-        armature: float = 0.0,
-        com: Vec3 | None = None,
-        I_m: Mat33 | None = None,
-        m: float = 0.0,
-        name: str | None = None,
-    ) -> int:
-        """Adds a rigid body to the model.
-
-        Args:
-            origin: The location of the body in the world frame
-            armature: Artificial inertia added to the body
-            com: The center of mass of the body w.r.t its origin
-            I_m: The 3x3 inertia tensor of the body (specified relative to the center of mass)
-            m: Mass of the body
-            name: Name of the body (optional)
-
-        Returns:
-            The index of the body in the model
-
-        Note:
-            If the mass (m) is zero then the body is treated as kinematic with no dynamics
-
-        """
-
-        if origin is None:
-            origin = wp.transform()
-
-        if com is None:
-            com = wp.vec3()
-
-        if I_m is None:
-            I_m = wp.mat33()
-
-        body_id = len(self.body_mass)
-
-        # body data
-        inertia = I_m + wp.mat33(np.eye(3)) * armature
-        self.body_inertia.append(inertia)
-        self.body_mass.append(m)
-        self.body_com.append(com)
-
-        if m > 0.0:
-            self.body_inv_mass.append(1.0 / m)
-        else:
-            self.body_inv_mass.append(0.0)
-
-        if any(x for x in inertia):
-            self.body_inv_inertia.append(wp.inverse(inertia))
-        else:
-            self.body_inv_inertia.append(inertia)
-
-        self.body_q.append(origin)
-        self.body_qd.append(wp.spatial_vector())
-
-        self.body_name.append(name or f"body {body_id}")
-        self.body_shapes[body_id] = []
-        return body_id
-
-    def add_joint(
-        self,
-        joint_type: wp.constant,
-        parent: int,
-        child: int,
-        linear_axes: list[JointAxis] | None = None,
-        angular_axes: list[JointAxis] | None = None,
-        name: str | None = None,
-        parent_xform: wp.transform | None = None,
-        child_xform: wp.transform | None = None,
-        linear_compliance: float = 0.0,
-        angular_compliance: float = 0.0,
-        armature: float = 1e-2,
-        collision_filter_parent: bool = True,
-        enabled: bool = True,
-    ) -> int:
-        """
-        Generic method to add any type of joint to this ModelBuilder.
-
-        Args:
-            joint_type (constant): The type of joint to add (see `Joint types`_)
-            parent (int): The index of the parent body (-1 is the world)
-            child (int): The index of the child body
-            linear_axes (list(:class:`JointAxis`)): The linear axes (see :class:`JointAxis`) of the joint
-            angular_axes (list(:class:`JointAxis`)): The angular axes (see :class:`JointAxis`) of the joint
-            name (str): The name of the joint (optional)
-            parent_xform (:ref:`transform <transform>`): The transform of the joint in the parent body's local frame
-            child_xform (:ref:`transform <transform>`): The transform of the joint in the child body's local frame
-            linear_compliance (float): The linear compliance of the joint
-            angular_compliance (float): The angular compliance of the joint
-            armature (float): Artificial inertia added around the joint axes (only considered by :class:`FeatherstoneIntegrator`)
-            collision_filter_parent (bool): Whether to filter collisions between shapes of the parent and child bodies
-            enabled (bool): Whether the joint is enabled (not considered by :class:`FeatherstoneIntegrator`)
-
-        Returns:
-            The index of the added joint
-        """
-        if linear_axes is None:
-            linear_axes = []
-
-        if angular_axes is None:
-            angular_axes = []
-
-        if parent_xform is None:
-            parent_xform = wp.transform()
-
-        if child_xform is None:
-            child_xform = wp.transform()
-
-        if len(self.articulation_start) == 0:
-            # automatically add an articulation if none exists
-            self.add_articulation()
-        self.joint_type.append(joint_type)
-        self.joint_parent.append(parent)
-        if child not in self.joint_parents:
-            self.joint_parents[child] = [parent]
-        else:
-            self.joint_parents[child].append(parent)
-        self.joint_child.append(child)
-        self.joint_X_p.append(wp.transform(parent_xform))
-        self.joint_X_c.append(wp.transform(child_xform))
-        self.joint_name.append(name or f"joint {self.joint_count}")
-        self.joint_axis_start.append(len(self.joint_axis))
-        self.joint_axis_dim.append((len(linear_axes), len(angular_axes)))
-        self.joint_axis_total_count += len(linear_axes) + len(angular_axes)
-
-        self.joint_linear_compliance.append(linear_compliance)
-        self.joint_angular_compliance.append(angular_compliance)
-        self.joint_enabled.append(enabled)
-
-        def add_axis_dim(dim: JointAxis):
-            self.joint_axis.append(dim.axis)
-            self.joint_axis_mode.append(dim.mode)
-            self.joint_act.append(dim.action)
-            self.joint_target_ke.append(dim.target_ke)
-            self.joint_target_kd.append(dim.target_kd)
-            self.joint_limit_ke.append(dim.limit_ke)
-            self.joint_limit_kd.append(dim.limit_kd)
-            if np.isfinite(dim.limit_lower):
-                self.joint_limit_lower.append(dim.limit_lower)
-            else:
-                self.joint_limit_lower.append(-1e6)
-            if np.isfinite(dim.limit_upper):
-                self.joint_limit_upper.append(dim.limit_upper)
-            else:
-                self.joint_limit_upper.append(1e6)
-
-        for dim in linear_axes:
-            add_axis_dim(dim)
-        for dim in angular_axes:
-            add_axis_dim(dim)
-
-        if joint_type == JOINT_PRISMATIC:
-            dof_count = 1
-            coord_count = 1
-        elif joint_type == JOINT_REVOLUTE:
-            dof_count = 1
-            coord_count = 1
-        elif joint_type == JOINT_BALL:
-            dof_count = 3
-            coord_count = 4
-        elif joint_type == JOINT_FREE or joint_type == JOINT_DISTANCE:
-            dof_count = 6
-            coord_count = 7
-        elif joint_type == JOINT_FIXED:
-            dof_count = 0
-            coord_count = 0
-        elif joint_type == JOINT_UNIVERSAL:
-            dof_count = 2
-            coord_count = 2
-        elif joint_type == JOINT_COMPOUND:
-            dof_count = 3
-            coord_count = 3
-        elif joint_type == JOINT_D6:
-            dof_count = len(linear_axes) + len(angular_axes)
-            coord_count = dof_count
-
-        for _i in range(coord_count):
-            self.joint_q.append(0.0)
-
-        for _i in range(dof_count):
-            self.joint_qd.append(0.0)
-            self.joint_armature.append(armature)
-
-        if joint_type == JOINT_FREE or joint_type == JOINT_DISTANCE or joint_type == JOINT_BALL:
-            # ensure that a valid quaternion is used for the angular dofs
-            self.joint_q[-1] = 1.0
-
-        self.joint_q_start.append(self.joint_coord_count)
-        self.joint_qd_start.append(self.joint_dof_count)
-
-        self.joint_dof_count += dof_count
-        self.joint_coord_count += coord_count
-
-        if collision_filter_parent and parent > -1:
-            for child_shape in self.body_shapes[child]:
-                for parent_shape in self.body_shapes[parent]:
-                    self.shape_collision_filter_pairs.add((parent_shape, child_shape))
-
-        return self.joint_count - 1
-
-    def add_joint_revolute(
-        self,
-        parent: int,
-        child: int,
-        parent_xform: wp.transform | None = None,
-        child_xform: wp.transform | None = None,
-        axis: Vec3 = (1.0, 0.0, 0.0),
-        target: float | None = None,
-        target_ke: float = 0.0,
-        target_kd: float = 0.0,
-        mode: int = JOINT_MODE_FORCE,
-        limit_lower: float = -2 * math.pi,
-        limit_upper: float = 2 * math.pi,
-        limit_ke: float | None = None,
-        limit_kd: float | None = None,
-        linear_compliance: float = 0.0,
-        angular_compliance: float = 0.0,
-        armature: float = 1e-2,
-        name: str | None = None,
-        collision_filter_parent: bool = True,
-        enabled: bool = True,
-    ) -> int:
-        """Adds a revolute (hinge) joint to the model. It has one degree of freedom.
-
-        Args:
-            parent: The index of the parent body
-            child: The index of the child body
-            parent_xform (:ref:`transform <transform>`): The transform of the joint in the parent body's local frame
-            child_xform (:ref:`transform <transform>`): The transform of the joint in the child body's local frame
-            axis (3D vector or JointAxis): The axis of rotation in the parent body's local frame, can be a JointAxis object whose settings will be used instead of the other arguments
-            target: The target angle (in radians) or target velocity of the joint (if None, the joint is considered to be in force control mode)
-            target_ke: The stiffness of the joint target
-            target_kd: The damping of the joint target
-            limit_lower: The lower limit of the joint
-            limit_upper: The upper limit of the joint
-            limit_ke: The stiffness of the joint limit (None to use the default value :attr:`default_joint_limit_ke`)
-            limit_kd: The damping of the joint limit (None to use the default value :attr:`default_joint_limit_kd`)
-            linear_compliance: The linear compliance of the joint
-            angular_compliance: The angular compliance of the joint
-            armature: Artificial inertia added around the joint axis
-            name: The name of the joint
-            collision_filter_parent: Whether to filter collisions between shapes of the parent and child bodies
-            enabled: Whether the joint is enabled
-
-        Returns:
-            The index of the added joint
-
-        """
-        if parent_xform is None:
-            parent_xform = wp.transform()
-
-        if child_xform is None:
-            child_xform = wp.transform()
-
-        limit_ke = limit_ke if limit_ke is not None else self.default_joint_limit_ke
-        limit_kd = limit_kd if limit_kd is not None else self.default_joint_limit_kd
-
-        action = 0.0
-        if target is None and mode == JOINT_MODE_TARGET_POSITION:
-            action = 0.5 * (limit_lower + limit_upper)
-        elif target is not None:
-            action = target
-            if mode == JOINT_MODE_FORCE:
-                mode = JOINT_MODE_TARGET_POSITION
-        ax = JointAxis(
-            axis=axis,
-            limit_lower=limit_lower,
-            limit_upper=limit_upper,
-            action=action,
-            target_ke=target_ke,
-            target_kd=target_kd,
-            mode=mode,
-            limit_ke=limit_ke,
-            limit_kd=limit_kd,
-        )
-        return self.add_joint(
-            JOINT_REVOLUTE,
-            parent,
-            child,
-            parent_xform=parent_xform,
-            child_xform=child_xform,
-            angular_axes=[ax],
-            linear_compliance=linear_compliance,
-            angular_compliance=angular_compliance,
-            armature=armature,
-            name=name,
-            collision_filter_parent=collision_filter_parent,
-            enabled=enabled,
-        )
-
-    def add_joint_prismatic(
-        self,
-        parent: int,
-        child: int,
-        parent_xform: wp.transform | None = None,
-        child_xform: wp.transform | None = None,
-        axis: Vec3 = (1.0, 0.0, 0.0),
-        target: float | None = None,
-        target_ke: float = 0.0,
-        target_kd: float = 0.0,
-        mode: int = JOINT_MODE_FORCE,
-        limit_lower: float = -1e4,
-        limit_upper: float = 1e4,
-        limit_ke: float | None = None,
-        limit_kd: float | None = None,
-        linear_compliance: float = 0.0,
-        angular_compliance: float = 0.0,
-        armature: float = 1e-2,
-        name: str | None = None,
-        collision_filter_parent: bool = True,
-        enabled: bool = True,
-    ) -> int:
-        """Adds a prismatic (sliding) joint to the model. It has one degree of freedom.
-
-        Args:
-            parent: The index of the parent body
-            child: The index of the child body
-            parent_xform (:ref:`transform <transform>`): The transform of the joint in the parent body's local frame
-            child_xform (:ref:`transform <transform>`): The transform of the joint in the child body's local frame
-            axis (3D vector or JointAxis): The axis of rotation in the parent body's local frame, can be a JointAxis object whose settings will be used instead of the other arguments
-            target: The target position or velocity of the joint (if None, the joint is considered to be in force control mode)
-            target_ke: The stiffness of the joint target
-            target_kd: The damping of the joint target
-            limit_lower: The lower limit of the joint
-            limit_upper: The upper limit of the joint
-            limit_ke: The stiffness of the joint limit (None to use the default value :attr:`default_joint_limit_ke`)
-            limit_kd: The damping of the joint limit (None to use the default value :attr:`default_joint_limit_ke`)
-            linear_compliance: The linear compliance of the joint
-            angular_compliance: The angular compliance of the joint
-            armature: Artificial inertia added around the joint axis
-            name: The name of the joint
-            collision_filter_parent: Whether to filter collisions between shapes of the parent and child bodies
-            enabled: Whether the joint is enabled
-
-        Returns:
-            The index of the added joint
-
-        """
-        if parent_xform is None:
-            parent_xform = wp.transform()
-
-        if child_xform is None:
-            child_xform = wp.transform()
-
-        limit_ke = limit_ke if limit_ke is not None else self.default_joint_limit_ke
-        limit_kd = limit_kd if limit_kd is not None else self.default_joint_limit_kd
-
-        action = 0.0
-        if target is None and mode == JOINT_MODE_TARGET_POSITION:
-            action = 0.5 * (limit_lower + limit_upper)
-        elif target is not None:
-            action = target
-            if mode == JOINT_MODE_FORCE:
-                mode = JOINT_MODE_TARGET_POSITION
-        ax = JointAxis(
-            axis=axis,
-            limit_lower=limit_lower,
-            limit_upper=limit_upper,
-            action=action,
-            target_ke=target_ke,
-            target_kd=target_kd,
-            mode=mode,
-            limit_ke=limit_ke,
-            limit_kd=limit_kd,
-        )
-        return self.add_joint(
-            JOINT_PRISMATIC,
-            parent,
-            child,
-            parent_xform=parent_xform,
-            child_xform=child_xform,
-            linear_axes=[ax],
-            linear_compliance=linear_compliance,
-            angular_compliance=angular_compliance,
-            armature=armature,
-            name=name,
-            collision_filter_parent=collision_filter_parent,
-            enabled=enabled,
-        )
-
-    def add_joint_ball(
-        self,
-        parent: int,
-        child: int,
-        parent_xform: wp.transform | None = None,
-        child_xform: wp.transform | None = None,
-        linear_compliance: float = 0.0,
-        angular_compliance: float = 0.0,
-        armature: float = 1e-2,
-        name: str | None = None,
-        collision_filter_parent: bool = True,
-        enabled: bool = True,
-    ) -> int:
-        """Adds a ball (spherical) joint to the model. Its position is defined by a 4D quaternion (xyzw) and its velocity is a 3D vector.
-
-        Args:
-            parent: The index of the parent body
-            child: The index of the child body
-            parent_xform (:ref:`transform <transform>`): The transform of the joint in the parent body's local frame
-            child_xform (:ref:`transform <transform>`): The transform of the joint in the child body's local frame
-            linear_compliance: The linear compliance of the joint
-            angular_compliance: The angular compliance of the joint
-            armature (float): Artificial inertia added around the joint axis (only considered by FeatherstoneIntegrator)
-            name: The name of the joint
-            collision_filter_parent: Whether to filter collisions between shapes of the parent and child bodies
-            enabled: Whether the joint is enabled
-
-        Returns:
-            The index of the added joint
-
-        """
-        if parent_xform is None:
-            parent_xform = wp.transform()
-
-        if child_xform is None:
-            child_xform = wp.transform()
-
-        return self.add_joint(
-            JOINT_BALL,
-            parent,
-            child,
-            parent_xform=parent_xform,
-            child_xform=child_xform,
-            linear_compliance=linear_compliance,
-            angular_compliance=angular_compliance,
-            armature=armature,
-            name=name,
-            collision_filter_parent=collision_filter_parent,
-            enabled=enabled,
-        )
-
-    def add_joint_fixed(
-        self,
-        parent: int,
-        child: int,
-        parent_xform: wp.transform | None = None,
-        child_xform: wp.transform | None = None,
-        linear_compliance: float = 0.0,
-        angular_compliance: float = 0.0,
-        armature: float = 1e-2,
-        name: str | None = None,
-        collision_filter_parent: bool = True,
-        enabled: bool = True,
-    ) -> int:
-        """Adds a fixed (static) joint to the model. It has no degrees of freedom.
-        See :meth:`collapse_fixed_joints` for a helper function that removes these fixed joints and merges the connecting bodies to simplify the model and improve stability.
-
-        Args:
-            parent: The index of the parent body
-            child: The index of the child body
-            parent_xform (:ref:`transform <transform>`): The transform of the joint in the parent body's local frame
-            child_xform (:ref:`transform <transform>`): The transform of the joint in the child body's local frame
-            linear_compliance: The linear compliance of the joint
-            angular_compliance: The angular compliance of the joint
-            armature (float): Artificial inertia added around the joint axis (only considered by FeatherstoneIntegrator)
-            name: The name of the joint
-            collision_filter_parent: Whether to filter collisions between shapes of the parent and child bodies
-            enabled: Whether the joint is enabled
-
-        Returns:
-            The index of the added joint
-
-        """
-        if parent_xform is None:
-            parent_xform = wp.transform()
-
-        if child_xform is None:
-            child_xform = wp.transform()
-
-        return self.add_joint(
-            JOINT_FIXED,
-            parent,
-            child,
-            parent_xform=parent_xform,
-            child_xform=child_xform,
-            linear_compliance=linear_compliance,
-            angular_compliance=angular_compliance,
-            armature=armature,
-            name=name,
-            collision_filter_parent=collision_filter_parent,
-            enabled=enabled,
-        )
-
-    def add_joint_free(
-        self,
-        child: int,
-        parent_xform: wp.transform | None = None,
-        child_xform: wp.transform | None = None,
-        armature: float = 0.0,
-        parent: int = -1,
-        name: str | None = None,
-        collision_filter_parent: bool = True,
-        enabled: bool = True,
-    ) -> int:
-        """Adds a free joint to the model.
-        It has 7 positional degrees of freedom (first 3 linear and then 4 angular dimensions for the orientation quaternion in `xyzw` notation) and 6 velocity degrees of freedom (first 3 angular and then 3 linear velocity dimensions).
-
-        Args:
-            child: The index of the child body
-            parent_xform (:ref:`transform <transform>`): The transform of the joint in the parent body's local frame
-            child_xform (:ref:`transform <transform>`): The transform of the joint in the child body's local frame
-            armature (float): Artificial inertia added around the joint axis (only considered by FeatherstoneIntegrator)
-            parent: The index of the parent body (-1 by default to use the world frame, e.g. to make the child body and its children a floating-base mechanism)
-            name: The name of the joint
-            collision_filter_parent: Whether to filter collisions between shapes of the parent and child bodies
-            enabled: Whether the joint is enabled
-
-        Returns:
-            The index of the added joint
-
-        """
-        if parent_xform is None:
-            parent_xform = wp.transform()
-
-        if child_xform is None:
-            child_xform = wp.transform()
-
-        return self.add_joint(
-            JOINT_FREE,
-            parent,
-            child,
-            parent_xform=parent_xform,
-            child_xform=child_xform,
-            armature=armature,
-            name=name,
-            collision_filter_parent=collision_filter_parent,
-            enabled=enabled,
-        )
-
-    def add_joint_distance(
-        self,
-        parent: int,
-        child: int,
-        parent_xform: wp.transform | None = None,
-        child_xform: wp.transform | None = None,
-        min_distance: float = -1.0,
-        max_distance: float = 1.0,
-        compliance: float = 0.0,
-        collision_filter_parent: bool = True,
-        enabled: bool = True,
-    ) -> int:
-        """Adds a distance joint to the model. The distance joint constraints the distance between the joint anchor points on the two bodies (see :ref:`FK-IK`) it connects to the interval [`min_distance`, `max_distance`].
-        It has 7 positional degrees of freedom (first 3 linear and then 4 angular dimensions for the orientation quaternion in `xyzw` notation) and 6 velocity degrees of freedom (first 3 angular and then 3 linear velocity dimensions).
-
-        Args:
-            parent: The index of the parent body
-            child: The index of the child body
-            parent_xform (:ref:`transform <transform>`): The transform of the joint in the parent body's local frame
-            child_xform (:ref:`transform <transform>`): The transform of the joint in the child body's local frame
-            min_distance: The minimum distance between the bodies (no limit if negative)
-            max_distance: The maximum distance between the bodies (no limit if negative)
-            compliance: The compliance of the joint
-            collision_filter_parent: Whether to filter collisions between shapes of the parent and child bodies
-            enabled: Whether the joint is enabled
-
-        Returns:
-            The index of the added joint
-
-        .. note:: Distance joints are currently only supported in the :class:`XPBDIntegrator` at the moment.
-
-        """
-        if parent_xform is None:
-            parent_xform = wp.transform()
-
-        if child_xform is None:
-            child_xform = wp.transform()
-
-        ax = JointAxis(
-            axis=(1.0, 0.0, 0.0),
-            limit_lower=min_distance,
-            limit_upper=max_distance,
-        )
-        return self.add_joint(
-            JOINT_DISTANCE,
-            parent,
-            child,
-            parent_xform=parent_xform,
-            child_xform=child_xform,
-            linear_axes=[ax],
-            linear_compliance=compliance,
-            collision_filter_parent=collision_filter_parent,
-            enabled=enabled,
-        )
-
-    def add_joint_universal(
-        self,
-        parent: int,
-        child: int,
-        axis_0: JointAxis,
-        axis_1: JointAxis,
-        parent_xform: wp.transform | None = None,
-        child_xform: wp.transform | None = None,
-        linear_compliance: float = 0.0,
-        angular_compliance: float = 0.0,
-        armature: float = 1e-2,
-        name: str | None = None,
-        collision_filter_parent: bool = True,
-        enabled: bool = True,
-    ) -> int:
-        """Adds a universal joint to the model. U-joints have two degrees of freedom, one for each axis.
-
-        Args:
-            parent: The index of the parent body
-            child: The index of the child body
-            axis_0 (3D vector or JointAxis): The first axis of the joint, can be a JointAxis object whose settings will be used instead of the other arguments
-            axis_1 (3D vector or JointAxis): The second axis of the joint, can be a JointAxis object whose settings will be used instead of the other arguments
-            parent_xform (:ref:`transform <transform>`): The transform of the joint in the parent body's local frame
-            child_xform (:ref:`transform <transform>`): The transform of the joint in the child body's local frame
-            linear_compliance: The linear compliance of the joint
-            angular_compliance: The angular compliance of the joint
-            armature: Artificial inertia added around the joint axes
-            name: The name of the joint
-            collision_filter_parent: Whether to filter collisions between shapes of the parent and child bodies
-            enabled: Whether the joint is enabled
-
-        Returns:
-            The index of the added joint
-
-        """
-        if parent_xform is None:
-            parent_xform = wp.transform()
-
-        if child_xform is None:
-            child_xform = wp.transform()
-
-        return self.add_joint(
-            JOINT_UNIVERSAL,
-            parent,
-            child,
-            angular_axes=[JointAxis(axis_0), JointAxis(axis_1)],
-            parent_xform=parent_xform,
-            child_xform=child_xform,
-            linear_compliance=linear_compliance,
-            angular_compliance=angular_compliance,
-            armature=armature,
-            name=name,
-            collision_filter_parent=collision_filter_parent,
-            enabled=enabled,
-        )
-
-    def add_joint_compound(
-        self,
-        parent: int,
-        child: int,
-        axis_0: JointAxis,
-        axis_1: JointAxis,
-        axis_2: JointAxis,
-        parent_xform: wp.transform | None = None,
-        child_xform: wp.transform | None = None,
-        linear_compliance: float = 0.0,
-        angular_compliance: float = 0.0,
-        armature: float = 1e-2,
-        name: str | None = None,
-        collision_filter_parent: bool = True,
-        enabled: bool = True,
-    ) -> int:
-        """Adds a compound joint to the model, which has 3 degrees of freedom, one for each axis.
-        Similar to the ball joint (see :meth:`add_ball_joint`), the compound joint allows bodies to move in a 3D rotation relative to each other,
-        except that the rotation is defined by 3 axes instead of a quaternion.
-        Depending on the choice of axes, the orientation can be specified through Euler angles, e.g. `z-x-z` or `x-y-x`, or through a Tait-Bryan angle sequence, e.g. `z-y-x` or `x-y-z`.
-
-        Args:
-            parent: The index of the parent body
-            child: The index of the child body
-            axis_0 (3D vector or JointAxis): The first axis of the joint, can be a JointAxis object whose settings will be used instead of the other arguments
-            axis_1 (3D vector or JointAxis): The second axis of the joint, can be a JointAxis object whose settings will be used instead of the other arguments
-            axis_2 (3D vector or JointAxis): The third axis of the joint, can be a JointAxis object whose settings will be used instead of the other arguments
-            parent_xform (:ref:`transform <transform>`): The transform of the joint in the parent body's local frame
-            child_xform (:ref:`transform <transform>`): The transform of the joint in the child body's local frame
-            linear_compliance: The linear compliance of the joint
-            angular_compliance: The angular compliance of the joint
-            armature: Artificial inertia added around the joint axes
-            name: The name of the joint
-            collision_filter_parent: Whether to filter collisions between shapes of the parent and child bodies
-            enabled: Whether the joint is enabled
-
-        Returns:
-            The index of the added joint
-
-        """
-        if parent_xform is None:
-            parent_xform = wp.transform()
-
-        if child_xform is None:
-            child_xform = wp.transform()
-
-        return self.add_joint(
-            JOINT_COMPOUND,
-            parent,
-            child,
-            angular_axes=[JointAxis(axis_0), JointAxis(axis_1), JointAxis(axis_2)],
-            parent_xform=parent_xform,
-            child_xform=child_xform,
-            linear_compliance=linear_compliance,
-            angular_compliance=angular_compliance,
-            armature=armature,
-            name=name,
-            collision_filter_parent=collision_filter_parent,
-            enabled=enabled,
-        )
-
-    def add_joint_d6(
-        self,
-        parent: int,
-        child: int,
-        linear_axes: list[JointAxis] | None = None,
-        angular_axes: list[JointAxis] | None = None,
-        name: str | None = None,
-        parent_xform: wp.transform | None = None,
-        child_xform: wp.transform | None = None,
-        linear_compliance: float = 0.0,
-        angular_compliance: float = 0.0,
-        armature: float = 1e-2,
-        collision_filter_parent: bool = True,
-        enabled: bool = True,
-    ):
-        """Adds a generic joint with custom linear and angular axes. The number of axes determines the number of degrees of freedom of the joint.
-
-        Args:
-            parent: The index of the parent body
-            child: The index of the child body
-            linear_axes: A list of linear axes
-            angular_axes: A list of angular axes
-            name: The name of the joint
-            parent_xform (:ref:`transform <transform>`): The transform of the joint in the parent body's local frame
-            child_xform (:ref:`transform <transform>`): The transform of the joint in the child body's local frame
-            linear_compliance: The linear compliance of the joint
-            angular_compliance: The angular compliance of the joint
-            armature: Artificial inertia added around the joint axes
-            collision_filter_parent: Whether to filter collisions between shapes of the parent and child bodies
-            enabled: Whether the joint is enabled
-
-        Returns:
-            The index of the added joint
-
-        """
-        if linear_axes is None:
-            linear_axes = []
-
-        if angular_axes is None:
-            angular_axes = []
-
-        if parent_xform is None:
-            parent_xform = wp.transform()
-
-        if child_xform is None:
-            child_xform = wp.transform()
-
-        return self.add_joint(
-            JOINT_D6,
-            parent,
-            child,
-            parent_xform=parent_xform,
-            child_xform=child_xform,
-            linear_axes=[JointAxis(a) for a in linear_axes],
-            angular_axes=[JointAxis(a) for a in angular_axes],
-            linear_compliance=linear_compliance,
-            angular_compliance=angular_compliance,
-            armature=armature,
-            name=name,
-            collision_filter_parent=collision_filter_parent,
-            enabled=enabled,
-        )
-
-    def plot_articulation(
-        self,
-        show_body_names=True,
-        show_joint_names=True,
-        show_joint_types=True,
-        plot_shapes=True,
-        show_shape_types=True,
-        show_legend=True,
-    ):
-        """
-        Visualizes the model's articulation graph using matplotlib and networkx.
-        Uses the spring layout algorithm from networkx to arrange the nodes.
-        Bodies are shown as orange squares, shapes are shown as blue circles.
-
-        Args:
-            show_body_names (bool): Whether to show the body names or indices
-            show_joint_names (bool): Whether to show the joint names or indices
-            show_joint_types (bool): Whether to show the joint types
-            plot_shapes (bool): Whether to render the shapes connected to the rigid bodies
-            show_shape_types (bool): Whether to show the shape geometry types
-            show_legend (bool): Whether to show a legend
-        """
-        import matplotlib.pyplot as plt
-        import networkx as nx
-
-        def joint_type_str(type):
-            if type == JOINT_FREE:
-                return "free"
-            elif type == JOINT_BALL:
-                return "ball"
-            elif type == JOINT_PRISMATIC:
-                return "prismatic"
-            elif type == JOINT_REVOLUTE:
-                return "revolute"
-            elif type == JOINT_D6:
-                return "D6"
-            elif type == JOINT_UNIVERSAL:
-                return "universal"
-            elif type == JOINT_COMPOUND:
-                return "compound"
-            elif type == JOINT_FIXED:
-                return "fixed"
-            elif type == JOINT_DISTANCE:
-                return "distance"
-            return "unknown"
-
-        def shape_type_str(type):
-            if type == GEO_SPHERE:
-                return "sphere"
-            if type == GEO_BOX:
-                return "box"
-            if type == GEO_CAPSULE:
-                return "capsule"
-            if type == GEO_CYLINDER:
-                return "cylinder"
-            if type == GEO_CONE:
-                return "cone"
-            if type == GEO_MESH:
-                return "mesh"
-            if type == GEO_SDF:
-                return "sdf"
-            if type == GEO_PLANE:
-                return "plane"
-            if type == GEO_NONE:
-                return "none"
-            return "unknown"
-
-        if show_body_names:
-            vertices = ["world", *self.body_name]
-        else:
-            vertices = ["-1"] + [str(i) for i in range(self.body_count)]
-        if plot_shapes:
-            for i in range(self.shape_count):
-                shape_label = f"shape_{i}"
-                if show_shape_types:
-                    shape_label += f"\n({shape_type_str(self.shape_geo_type[i])})"
-                vertices.append(shape_label)
-        edges = []
-        edge_labels = []
-        for i in range(self.joint_count):
-            edge = (self.joint_child[i] + 1, self.joint_parent[i] + 1)
-            edges.append(edge)
-            if show_joint_names:
-                joint_label = self.joint_name[i]
-            else:
-                joint_label = str(i)
-            if show_joint_types:
-                joint_label += f"\n({joint_type_str(self.joint_type[i])})"
-            edge_labels.append(joint_label)
-
-        if plot_shapes:
-            for i in range(self.shape_count):
-                edges.append((len(self.body_name) + i + 1, self.shape_body[i] + 1))
-
-        # plot graph
-        G = nx.Graph()
-        for i in range(len(vertices)):
-            G.add_node(i, label=vertices[i])
-        for i in range(len(edges)):
-            label = edge_labels[i] if i < len(edge_labels) else ""
-            G.add_edge(edges[i][0], edges[i][1], label=label)
-        pos = nx.spring_layout(G)
-        nx.draw_networkx_edges(G, pos, node_size=0, edgelist=edges[: self.joint_count])
-        # render body vertices
-        draw_args = {"node_size": 100}
-        bodies = nx.subgraph(G, list(range(self.body_count + 1)))
-        nx.draw_networkx_nodes(bodies, pos, node_color="orange", node_shape="s", **draw_args)
-        if plot_shapes:
-            # render shape vertices
-            shapes = nx.subgraph(G, list(range(self.body_count + 1, len(vertices))))
-            nx.draw_networkx_nodes(shapes, pos, node_color="skyblue", **draw_args)
-            nx.draw_networkx_edges(
-                G, pos, node_size=0, edgelist=edges[self.joint_count :], edge_color="gray", style="dashed"
-            )
-        edge_labels = nx.get_edge_attributes(G, "label")
-        nx.draw_networkx_edge_labels(
-            G, pos, edge_labels=edge_labels, font_size=6, bbox={"alpha": 0.6, "color": "w", "lw": 0}
-        )
-        # add node labels
-        nx.draw_networkx_labels(G, pos, dict(enumerate(vertices)), font_size=6)
-        if show_legend:
-            plt.plot([], [], "s", color="orange", label="body")
-            plt.plot([], [], "k-", label="joint")
-            if plot_shapes:
-                plt.plot([], [], "o", color="skyblue", label="shape")
-                plt.plot([], [], "k--", label="shape-body connection")
-            plt.legend(loc="upper left", fontsize=6)
-        plt.show()
-
-    def collapse_fixed_joints(self, verbose=wp.config.verbose):
-        """Removes fixed joints from the model and merges the bodies they connect. This is useful for simplifying the model for faster and more stable simulation."""
-
-        body_data = {}
-        body_children = {-1: []}
-        visited = {}
-        for i in range(self.body_count):
-            name = self.body_name[i]
-            body_data[i] = {
-                "shapes": self.body_shapes[i],
-                "q": self.body_q[i],
-                "qd": self.body_qd[i],
-                "mass": self.body_mass[i],
-                "inertia": self.body_inertia[i],
-                "inv_mass": self.body_inv_mass[i],
-                "inv_inertia": self.body_inv_inertia[i],
-                "com": self.body_com[i],
-                "name": name,
-                "original_id": i,
-            }
-            visited[i] = False
-            body_children[i] = []
-
-        joint_data = {}
-        for i in range(self.joint_count):
-            name = self.joint_name[i]
-            parent = self.joint_parent[i]
-            child = self.joint_child[i]
-            body_children[parent].append(child)
-
-            q_start = self.joint_q_start[i]
-            qd_start = self.joint_qd_start[i]
-            if i < self.joint_count - 1:
-                q_dim = self.joint_q_start[i + 1] - q_start
-                qd_dim = self.joint_qd_start[i + 1] - qd_start
-            else:
-                q_dim = len(self.joint_q) - q_start
-                qd_dim = len(self.joint_qd) - qd_start
-
-            data = {
-                "type": self.joint_type[i],
-                "q": self.joint_q[q_start : q_start + q_dim],
-                "qd": self.joint_qd[qd_start : qd_start + qd_dim],
-                "armature": self.joint_armature[qd_start : qd_start + qd_dim],
-                "q_start": q_start,
-                "qd_start": qd_start,
-                "linear_compliance": self.joint_linear_compliance[i],
-                "angular_compliance": self.joint_angular_compliance[i],
-                "name": name,
-                "parent_xform": wp.transform_expand(self.joint_X_p[i]),
-                "child_xform": wp.transform_expand(self.joint_X_c[i]),
-                "enabled": self.joint_enabled[i],
-                "axes": [],
-                "axis_dim": self.joint_axis_dim[i],
-                "parent": parent,
-                "child": child,
-                "original_id": i,
-            }
-            num_lin_axes, num_ang_axes = self.joint_axis_dim[i]
-            start_ax = self.joint_axis_start[i]
-            for j in range(start_ax, start_ax + num_lin_axes + num_ang_axes):
-                data["axes"].append(
-                    {
-                        "axis": self.joint_axis[j],
-                        "axis_mode": self.joint_axis_mode[j],
-                        "target_ke": self.joint_target_ke[j],
-                        "target_kd": self.joint_target_kd[j],
-                        "limit_ke": self.joint_limit_ke[j],
-                        "limit_kd": self.joint_limit_kd[j],
-                        "limit_lower": self.joint_limit_lower[j],
-                        "limit_upper": self.joint_limit_upper[j],
-                        "act": self.joint_act[j],
-                    }
-                )
-
-            joint_data[(parent, child)] = data
-
-        # sort body children so we traverse the tree in the same order as the bodies are listed
-        for children in body_children.values():
-            children.sort(key=lambda x: body_data[x]["original_id"])
-
-        retained_joints = []
-        retained_bodies = []
-        body_remap = {-1: -1}
-
-        # depth first search over the joint graph
-        def dfs(parent_body: int, child_body: int, incoming_xform: wp.transform, last_dynamic_body: int):
-            nonlocal visited
-            nonlocal retained_joints
-            nonlocal retained_bodies
-            nonlocal body_data
-            nonlocal body_remap
-
-            joint = joint_data[(parent_body, child_body)]
-            if joint["type"] == JOINT_FIXED:
-                joint_xform = joint["parent_xform"] * wp.transform_inverse(joint["child_xform"])
-                incoming_xform = incoming_xform * joint_xform
-                parent_name = self.body_name[parent_body] if parent_body > -1 else "world"
-                child_name = self.body_name[child_body]
-                last_dynamic_body_name = self.body_name[last_dynamic_body] if last_dynamic_body > -1 else "world"
-                if verbose:
-                    print(
-                        f"Remove fixed joint {joint['name']} between {parent_name} and {child_name}, "
-                        f"merging {child_name} into {last_dynamic_body_name}"
-                    )
-                child_id = body_data[child_body]["original_id"]
-                for shape in self.body_shapes[child_id]:
-                    self.shape_transform[shape] = incoming_xform * self.shape_transform[shape]
-                    if verbose:
-                        print(
-                            f"  Shape {shape} moved to body {last_dynamic_body_name} with transform {self.shape_transform[shape]}"
-                        )
-                    if last_dynamic_body > -1:
-                        self.shape_body[shape] = body_data[last_dynamic_body]["id"]
-                        body_data[last_dynamic_body]["shapes"].append(shape)
-                    else:
-                        self.shape_body[shape] = -1
-
-                if last_dynamic_body > -1:
-                    source_m = body_data[last_dynamic_body]["mass"]
-                    source_com = body_data[last_dynamic_body]["com"]
-                    # add inertia to last_dynamic_body
-                    m = body_data[child_body]["mass"]
-                    com = wp.transform_point(incoming_xform, body_data[child_body]["com"])
-                    inertia = body_data[child_body]["inertia"]
-                    body_data[last_dynamic_body]["inertia"] += wp.sim.transform_inertia(
-                        m, inertia, incoming_xform.p, incoming_xform.q
-                    )
-                    body_data[last_dynamic_body]["mass"] += m
-                    body_data[last_dynamic_body]["com"] = (m * com + source_m * source_com) / (m + source_m)
-                    # indicate to recompute inverse mass, inertia for this body
-                    body_data[last_dynamic_body]["inv_mass"] = None
-            else:
-                joint["parent_xform"] = incoming_xform * joint["parent_xform"]
-                joint["parent"] = last_dynamic_body
-                last_dynamic_body = child_body
-                incoming_xform = wp.transform()
-                retained_joints.append(joint)
-                new_id = len(retained_bodies)
-                body_data[child_body]["id"] = new_id
-                retained_bodies.append(child_body)
-                for shape in body_data[child_body]["shapes"]:
-                    self.shape_body[shape] = new_id
-
-            visited[parent_body] = True
-            if visited[child_body] or child_body not in body_children:
-                return
-            for child in body_children[child_body]:
-                if not visited[child]:
-                    dfs(child_body, child, incoming_xform, last_dynamic_body)
-
-        for body in body_children[-1]:
-            if not visited[body]:
-                dfs(-1, body, wp.transform(), -1)
-
-        # repopulate the model
-        self.body_name.clear()
-        self.body_q.clear()
-        self.body_qd.clear()
-        self.body_mass.clear()
-        self.body_inertia.clear()
-        self.body_com.clear()
-        self.body_inv_mass.clear()
-        self.body_inv_inertia.clear()
-        self.body_shapes.clear()
-        for i in retained_bodies:
-            body = body_data[i]
-            new_id = len(self.body_name)
-            body_remap[body["original_id"]] = new_id
-            self.body_name.append(body["name"])
-            self.body_q.append(list(body["q"]))
-            self.body_qd.append(list(body["qd"]))
-            m = body["mass"]
-            inertia = body["inertia"]
-            self.body_mass.append(m)
-            self.body_inertia.append(inertia)
-            self.body_com.append(body["com"])
-            if body["inv_mass"] is None:
-                # recompute inverse mass and inertia
-                if m > 0.0:
-                    self.body_inv_mass.append(1.0 / m)
-                    self.body_inv_inertia.append(wp.inverse(inertia))
-                else:
-                    self.body_inv_mass.append(0.0)
-                    self.body_inv_inertia.append(wp.mat33(0.0))
-            else:
-                self.body_inv_mass.append(body["inv_mass"])
-                self.body_inv_inertia.append(body["inv_inertia"])
-            self.body_shapes[new_id] = body["shapes"]
-            body_remap[body["original_id"]] = new_id
-
-        # sort joints so they appear in the same order as before
-        retained_joints.sort(key=lambda x: x["original_id"])
-
-        joint_remap = {}
-        for i, joint in enumerate(retained_joints):
-            joint_remap[joint["original_id"]] = i
-        # update articulation_start
-        for i, old_i in enumerate(self.articulation_start):
-            start_i = old_i
-            while start_i not in joint_remap:
-                start_i += 1
-                if start_i >= self.joint_count:
-                    break
-            self.articulation_start[i] = joint_remap.get(start_i, start_i)
-        # remove empty articulation starts, i.e. where the start and end are the same
-        self.articulation_start = list(set(self.articulation_start))
-
-        self.joint_name.clear()
-        self.joint_type.clear()
-        self.joint_parent.clear()
-        self.joint_child.clear()
-        self.joint_q.clear()
-        self.joint_qd.clear()
-        self.joint_q_start.clear()
-        self.joint_qd_start.clear()
-        self.joint_enabled.clear()
-        self.joint_linear_compliance.clear()
-        self.joint_angular_compliance.clear()
-        self.joint_armature.clear()
-        self.joint_X_p.clear()
-        self.joint_X_c.clear()
-        self.joint_axis.clear()
-        self.joint_axis_mode.clear()
-        self.joint_target_ke.clear()
-        self.joint_target_kd.clear()
-        self.joint_limit_lower.clear()
-        self.joint_limit_upper.clear()
-        self.joint_limit_ke.clear()
-        self.joint_limit_kd.clear()
-        self.joint_axis_dim.clear()
-        self.joint_axis_start.clear()
-        self.joint_act.clear()
-        for joint in retained_joints:
-            self.joint_name.append(joint["name"])
-            self.joint_type.append(joint["type"])
-            self.joint_parent.append(body_remap[joint["parent"]])
-            self.joint_child.append(body_remap[joint["child"]])
-            self.joint_q_start.append(len(self.joint_q))
-            self.joint_qd_start.append(len(self.joint_qd))
-            self.joint_q.extend(joint["q"])
-            self.joint_qd.extend(joint["qd"])
-            self.joint_armature.extend(joint["armature"])
-            self.joint_enabled.append(joint["enabled"])
-            self.joint_linear_compliance.append(joint["linear_compliance"])
-            self.joint_angular_compliance.append(joint["angular_compliance"])
-            self.joint_X_p.append(list(joint["parent_xform"]))
-            self.joint_X_c.append(list(joint["child_xform"]))
-            self.joint_axis_dim.append(joint["axis_dim"])
-            self.joint_axis_start.append(len(self.joint_axis))
-            for axis in joint["axes"]:
-                self.joint_axis.append(axis["axis"])
-                self.joint_axis_mode.append(axis["axis_mode"])
-                self.joint_target_ke.append(axis["target_ke"])
-                self.joint_target_kd.append(axis["target_kd"])
-                self.joint_limit_lower.append(axis["limit_lower"])
-                self.joint_limit_upper.append(axis["limit_upper"])
-                self.joint_limit_ke.append(axis["limit_ke"])
-                self.joint_limit_kd.append(axis["limit_kd"])
-                self.joint_act.append(axis["act"])
-
-    # muscles
-    def add_muscle(
-        self, bodies: list[int], positions: list[Vec3], f0: float, lm: float, lt: float, lmax: float, pen: float
-    ) -> float:
-        """Adds a muscle-tendon activation unit.
-
-        Args:
-            bodies: A list of body indices for each waypoint
-            positions: A list of positions of each waypoint in the body's local frame
-            f0: Force scaling
-            lm: Muscle length
-            lt: Tendon length
-            lmax: Maximally efficient muscle length
-
-        Returns:
-            The index of the muscle in the model
-
-        .. note:: The simulation support for muscles is in progress and not yet fully functional.
-
-        """
-
-        n = len(bodies)
-
-        self.muscle_start.append(len(self.muscle_bodies))
-        self.muscle_params.append((f0, lm, lt, lmax, pen))
-        self.muscle_activations.append(0.0)
-
-        for i in range(n):
-            self.muscle_bodies.append(bodies[i])
-            self.muscle_points.append(positions[i])
-
-        # return the index of the muscle
-        return len(self.muscle_start) - 1
-
-    # shapes
-    def add_shape_plane(
-        self,
-        plane: Vec4 | tuple[float, float, float, float] = (0.0, 1.0, 0.0, 0.0),
-        pos: Vec3 | None = None,
-        rot: Quat | None = None,
-        width: float = 10.0,
-        length: float = 10.0,
-        body: int = -1,
-        ke: float | None = None,
-        kd: float | None = None,
-        kf: float | None = None,
-        ka: float | None = None,
-        mu: float | None = None,
-        restitution: float | None = None,
-        thickness: float | None = None,
-        has_ground_collision: bool = False,
-        has_shape_collision: bool = True,
-        is_visible: bool = True,
-        collision_group: int = -1,
-    ) -> int:
-        """Add a plane collision shape.
-
-        If ``pos`` and ``rot`` are defined, the plane is assumed to have its normal as (0, 1, 0).
-        Otherwise, the plane equation defined through the ``plane`` argument is used.
-
-        Args:
-            plane: The plane equation in form a*x + b*y + c*z + d = 0
-            pos: The position of the plane in world coordinates
-            rot: The rotation of the plane in world coordinates
-            width: The extent along x of the plane (infinite if 0)
-            length: The extent along z of the plane (infinite if 0)
-            body: The body index to attach the shape to (-1 by default to keep the plane static)
-            ke: The contact elastic stiffness (None to use the default value :attr:`default_shape_ke`)
-            kd: The contact damping stiffness (None to use the default value :attr:`default_shape_kd`)
-            kf: The contact friction stiffness (None to use the default value :attr:`default_shape_kf`)
-            ka: The contact adhesion distance (None to use the default value :attr:`default_shape_ka`)
-            mu: The coefficient of friction (None to use the default value :attr:`default_shape_mu`)
-            restitution: The coefficient of restitution (None to use the default value :attr:`default_shape_restitution`)
-            thickness: The thickness of the plane (0 by default) for collision handling (None to use the default value :attr:`default_shape_thickness`)
-            has_ground_collision: If True, the shape will collide with the ground plane if `Model.ground` is True
-            has_shape_collision: If True, the shape will collide with other shapes
-            is_visible: Whether the plane is visible
-            collision_group: The collision group of the shape
-
-        Returns:
-            The index of the added shape
-
-        """
-        if pos is None or rot is None:
-            # compute position and rotation from plane equation
-            normal = np.array(plane[:3])
-            normal /= np.linalg.norm(normal)
-            pos = plane[3] * normal
-            if np.allclose(normal, (0.0, 1.0, 0.0)):
-                # no rotation necessary
-                rot = (0.0, 0.0, 0.0, 1.0)
-            else:
-                c = np.cross(normal, (0.0, 1.0, 0.0))
-                angle = np.arcsin(np.linalg.norm(c))
-                axis = np.abs(c) / np.linalg.norm(c)
-                rot = wp.quat_from_axis_angle(wp.vec3(*axis), wp.float32(angle))
-        scale = wp.vec3(width, length, 0.0)
-
-        return self._add_shape(
-            body,
-            pos,
-            rot,
-            GEO_PLANE,
-            scale,
-            None,
-            0.0,
-            ke,
-            kd,
-            kf,
-            ka,
-            mu,
-            restitution,
-            thickness,
-            has_ground_collision=has_ground_collision,
-            has_shape_collision=has_shape_collision,
-            is_visible=is_visible,
-            collision_group=collision_group,
-        )
-
-    def add_shape_sphere(
-        self,
-        body,
-        pos: Vec3 | tuple[float, float, float] = (0.0, 0.0, 0.0),
-        rot: Quat | tuple[float, float, float, float] = (0.0, 0.0, 0.0, 1.0),
-        radius: float = 1.0,
-        density: float | None = None,
-        ke: float | None = None,
-        kd: float | None = None,
-        kf: float | None = None,
-        ka: float | None = None,
-        mu: float | None = None,
-        restitution: float | None = None,
-        is_solid: bool = True,
-        thickness: float | None = None,
-        has_ground_collision: bool = True,
-        has_shape_collision: bool = True,
-        collision_group: int = -1,
-        is_visible: bool = True,
-    ) -> int:
-        """Add a sphere collision shape to a body.
-
-        Args:
-            body: The index of the parent body this shape belongs to (use -1 for static shapes)
-            pos: The location of the shape with respect to the parent frame
-            rot: The rotation of the shape with respect to the parent frame
-            radius: The radius of the sphere
-            density: The density of the shape (None to use the default value :attr:`default_shape_density`)
-            ke: The contact elastic stiffness (None to use the default value :attr:`default_shape_ke`)
-            kd: The contact damping stiffness (None to use the default value :attr:`default_shape_kd`)
-            kf: The contact friction stiffness (None to use the default value :attr:`default_shape_kf`)
-            ka: The contact adhesion distance (None to use the default value :attr:`default_shape_ka`)
-            mu: The coefficient of friction (None to use the default value :attr:`default_shape_mu`)
-            restitution: The coefficient of restitution (None to use the default value :attr:`default_shape_restitution`)
-            is_solid: Whether the sphere is solid or hollow
-            thickness: Thickness to use for computing inertia of a hollow sphere, and for collision handling (None to use the default value :attr:`default_shape_thickness`)
-            has_ground_collision: If True, the shape will collide with the ground plane if `Model.ground` is True
-            has_shape_collision: If True, the shape will collide with other shapes
-            collision_group: The collision group of the shape
-            is_visible: Whether the sphere is visible
-
-        Returns:
-            The index of the added shape
-
-        """
-
-        thickness = self.default_shape_thickness if thickness is None else thickness
-        return self._add_shape(
-            body,
-            wp.vec3(pos),
-            wp.quat(rot),
-            GEO_SPHERE,
-            wp.vec3(radius, 0.0, 0.0),
-            None,
-            density,
-            ke,
-            kd,
-            kf,
-            ka,
-            mu,
-            restitution,
-            thickness + radius,
-            is_solid,
-            has_ground_collision=has_ground_collision,
-            has_shape_collision=has_shape_collision,
-            collision_group=collision_group,
-            is_visible=is_visible,
-        )
-
-    def add_shape_box(
-        self,
-        body: int,
-        pos: Vec3 | tuple[float, float, float] = (0.0, 0.0, 0.0),
-        rot: Quat | tuple[float, float, float, float] = (0.0, 0.0, 0.0, 1.0),
-        hx: float = 0.5,
-        hy: float = 0.5,
-        hz: float = 0.5,
-        density: float | None = None,
-        ke: float | None = None,
-        kd: float | None = None,
-        kf: float | None = None,
-        ka: float | None = None,
-        mu: float | None = None,
-        restitution: float | None = None,
-        is_solid: bool = True,
-        thickness: float | None = None,
-        has_ground_collision: bool = True,
-        has_shape_collision: bool = True,
-        collision_group: int = -1,
-        is_visible: bool = True,
-    ) -> int:
-        """Add a box collision shape to a body.
-
-        Args:
-            body: The index of the parent body this shape belongs to (use -1 for static shapes)
-            pos: The location of the shape with respect to the parent frame
-            rot: The rotation of the shape with respect to the parent frame
-            hx: The half-extent along the x-axis
-            hy: The half-extent along the y-axis
-            hz: The half-extent along the z-axis
-            density: The density of the shape (None to use the default value :attr:`default_shape_density`)
-            ke: The contact elastic stiffness (None to use the default value :attr:`default_shape_ke`)
-            kd: The contact damping stiffness (None to use the default value :attr:`default_shape_kd`)
-            kf: The contact friction stiffness (None to use the default value :attr:`default_shape_kf`)
-            ka: The contact adhesion distance (None to use the default value :attr:`default_shape_ka`)
-            mu: The coefficient of friction (None to use the default value :attr:`default_shape_mu`)
-            restitution: The coefficient of restitution (None to use the default value :attr:`default_shape_restitution`)
-            is_solid: Whether the box is solid or hollow
-            thickness: Thickness to use for computing inertia of a hollow box, and for collision handling (None to use the default value :attr:`default_shape_thickness`)
-            has_ground_collision: If True, the shape will collide with the ground plane if `Model.ground` is True
-            has_shape_collision: If True, the shape will collide with other shapes
-            collision_group: The collision group of the shape
-            is_visible: Whether the box is visible
-
-        Returns:
-            The index of the added shape
-        """
-
-        return self._add_shape(
-            body,
-            wp.vec3(pos),
-            wp.quat(rot),
-            GEO_BOX,
-            wp.vec3(hx, hy, hz),
-            None,
-            density,
-            ke,
-            kd,
-            kf,
-            ka,
-            mu,
-            restitution,
-            thickness,
-            is_solid,
-            has_ground_collision=has_ground_collision,
-            has_shape_collision=has_shape_collision,
-            collision_group=collision_group,
-            is_visible=is_visible,
-        )
-
-    def add_shape_capsule(
-        self,
-        body: int,
-        pos: Vec3 | tuple[float, float, float] = (0.0, 0.0, 0.0),
-        rot: Quat | tuple[float, float, float, float] = (0.0, 0.0, 0.0, 1.0),
-        radius: float = 1.0,
-        half_height: float = 0.5,
-        up_axis: int = 1,
-        density: float | None = None,
-        ke: float | None = None,
-        kd: float | None = None,
-        kf: float | None = None,
-        ka: float | None = None,
-        mu: float | None = None,
-        restitution: float | None = None,
-        is_solid: bool = True,
-        thickness: float | None = None,
-        has_ground_collision: bool = True,
-        has_shape_collision: bool = True,
-        collision_group: int = -1,
-        is_visible: bool = True,
-    ) -> int:
-        """Add a capsule collision shape to a body.
-
-        Args:
-            body: The index of the parent body this shape belongs to (use -1 for static shapes)
-            pos: The location of the shape with respect to the parent frame
-            rot: The rotation of the shape with respect to the parent frame
-            radius: The radius of the capsule
-            half_height: The half length of the center cylinder along the up axis
-            up_axis: The axis along which the capsule is aligned (0=x, 1=y, 2=z)
-            density: The density of the shape (None to use the default value :attr:`default_shape_density`)
-            ke: The contact elastic stiffness (None to use the default value :attr:`default_shape_ke`)
-            kd: The contact damping stiffness (None to use the default value :attr:`default_shape_kd`)
-            kf: The contact friction stiffness (None to use the default value :attr:`default_shape_kf`)
-            ka: The contact adhesion distance (None to use the default value :attr:`default_shape_ka`)
-            mu: The coefficient of friction (None to use the default value :attr:`default_shape_mu`)
-            restitution: The coefficient of restitution (None to use the default value :attr:`default_shape_restitution`)
-            is_solid: Whether the capsule is solid or hollow
-            thickness: Thickness to use for computing inertia of a hollow capsule, and for collision handling (None to use the default value :attr:`default_shape_thickness`)
-            has_ground_collision: If True, the shape will collide with the ground plane if `Model.ground` is True
-            has_shape_collision: If True, the shape will collide with other shapes
-            collision_group: The collision group of the shape
-            is_visible: Whether the capsule is visible
-
-        Returns:
-            The index of the added shape
-
-        """
-
-        q = wp.quat(rot)
-        sqh = math.sqrt(0.5)
-        if up_axis == 0:
-            q = wp.mul(q, wp.quat(0.0, 0.0, -sqh, sqh))
-        elif up_axis == 2:
-            q = wp.mul(q, wp.quat(sqh, 0.0, 0.0, sqh))
-
-        thickness = self.default_shape_thickness if thickness is None else thickness
-        return self._add_shape(
-            body,
-            wp.vec3(pos),
-            wp.quat(q),
-            GEO_CAPSULE,
-            wp.vec3(radius, half_height, 0.0),
-            None,
-            density,
-            ke,
-            kd,
-            kf,
-            ka,
-            mu,
-            restitution,
-            thickness + radius,
-            is_solid,
-            has_ground_collision=has_ground_collision,
-            has_shape_collision=has_shape_collision,
-            collision_group=collision_group,
-            is_visible=is_visible,
-        )
-
-    def add_shape_cylinder(
-        self,
-        body: int,
-        pos: Vec3 | tuple[float, float, float] = (0.0, 0.0, 0.0),
-        rot: Quat | tuple[float, float, float, float] = (0.0, 0.0, 0.0, 1.0),
-        radius: float = 1.0,
-        half_height: float = 0.5,
-        up_axis: int = 1,
-        density: float | None = None,
-        ke: float | None = None,
-        kd: float | None = None,
-        kf: float | None = None,
-        ka: float | None = None,
-        mu: float | None = None,
-        restitution: float | None = None,
-        is_solid: bool = True,
-        thickness: float | None = None,
-        has_ground_collision: bool = True,
-        has_shape_collision: bool = True,
-        collision_group: int = -1,
-        is_visible: bool = True,
-    ) -> int:
-        """Add a cylinder collision shape to a body.
-
-        Args:
-            body: The index of the parent body this shape belongs to (use -1 for static shapes)
-            pos: The location of the shape with respect to the parent frame
-            rot: The rotation of the shape with respect to the parent frame
-            radius: The radius of the cylinder
-            half_height: The half length of the cylinder along the up axis
-            up_axis: The axis along which the cylinder is aligned (0=x, 1=y, 2=z)
-            density: The density of the shape (None to use the default value :attr:`default_shape_density`)
-            ke: The contact elastic stiffness (None to use the default value :attr:`default_shape_ke`)
-            kd: The contact damping stiffness (None to use the default value :attr:`default_shape_kd`)
-            kf: The contact friction stiffness (None to use the default value :attr:`default_shape_kf`)
-            ka: The contact adhesion distance (None to use the default value :attr:`default_shape_ka`)
-            mu: The coefficient of friction (None to use the default value :attr:`default_shape_mu`)
-            restitution: The coefficient of restitution (None to use the default value :attr:`default_shape_restitution`)
-            is_solid: Whether the cylinder is solid or hollow
-            thickness: Thickness to use for computing inertia of a hollow cylinder, and for collision handling (None to use the default value :attr:`default_shape_thickness`)
-            has_ground_collision: If True, the shape will collide with the ground plane if `Model.ground` is True
-            has_shape_collision: If True, the shape will collide with other shapes
-            collision_group: The collision group of the shape
-            is_visible: Whether the cylinder is visible
-
-        Note:
-            Cylinders are currently not supported in rigid body collision handling.
-
-        Returns:
-            The index of the added shape
-
-        """
-
-        q = rot
-        sqh = math.sqrt(0.5)
-        if up_axis == 0:
-            q = wp.mul(rot, wp.quat(0.0, 0.0, -sqh, sqh))
-        elif up_axis == 2:
-            q = wp.mul(rot, wp.quat(sqh, 0.0, 0.0, sqh))
-
-        return self._add_shape(
-            body,
-            wp.vec3(pos),
-            wp.quat(q),
-            GEO_CYLINDER,
-            wp.vec3(radius, half_height, 0.0),
-            None,
-            density,
-            ke,
-            kd,
-            kf,
-            ka,
-            mu,
-            restitution,
-            thickness,
-            is_solid,
-            has_ground_collision=has_ground_collision,
-            has_shape_collision=has_shape_collision,
-            collision_group=collision_group,
-            is_visible=is_visible,
-        )
-
-    def add_shape_cone(
-        self,
-        body: int,
-        pos: Vec3 | tuple[float, float, float] = (0.0, 0.0, 0.0),
-        rot: Quat | tuple[float, float, float, float] = (0.0, 0.0, 0.0, 1.0),
-        radius: float = 1.0,
-        half_height: float = 0.5,
-        up_axis: int = 1,
-        density: float | None = None,
-        ke: float | None = None,
-        kd: float | None = None,
-        kf: float | None = None,
-        ka: float | None = None,
-        mu: float | None = None,
-        restitution: float | None = None,
-        is_solid: bool = True,
-        thickness: float | None = None,
-        has_ground_collision: bool = True,
-        has_shape_collision: bool = True,
-        collision_group: int = -1,
-        is_visible: bool = True,
-    ) -> int:
-        """Add a cone collision shape to a body.
-
-        Args:
-            body: The index of the parent body this shape belongs to (use -1 for static shapes)
-            pos: The location of the shape with respect to the parent frame
-            rot: The rotation of the shape with respect to the parent frame
-            radius: The radius of the cone
-            half_height: The half length of the cone along the up axis
-            up_axis: The axis along which the cone is aligned (0=x, 1=y, 2=z)
-            density: The density of the shape (None to use the default value :attr:`default_shape_density`)
-            ke: The contact elastic stiffness (None to use the default value :attr:`default_shape_ke`)
-            kd: The contact damping stiffness (None to use the default value :attr:`default_shape_kd`)
-            kf: The contact friction stiffness (None to use the default value :attr:`default_shape_kf`)
-            ka: The contact adhesion distance (None to use the default value :attr:`default_shape_ka`)
-            mu: The coefficient of friction (None to use the default value :attr:`default_shape_mu`)
-            restitution: The coefficient of restitution (None to use the default value :attr:`default_shape_restitution`)
-            is_solid: Whether the cone is solid or hollow
-            thickness: Thickness to use for computing inertia of a hollow cone, and for collision handling (None to use the default value :attr:`default_shape_thickness`)
-            has_ground_collision: If True, the shape will collide with the ground plane if `Model.ground` is True
-            has_shape_collision: If True, the shape will collide with other shapes
-            collision_group: The collision group of the shape
-            is_visible: Whether the cone is visible
-
-        Note:
-            Cones are currently not supported in rigid body collision handling.
-
-        Returns:
-            The index of the added shape
-
-        """
-
-        q = rot
-        sqh = math.sqrt(0.5)
-        if up_axis == 0:
-            q = wp.mul(rot, wp.quat(0.0, 0.0, -sqh, sqh))
-        elif up_axis == 2:
-            q = wp.mul(rot, wp.quat(sqh, 0.0, 0.0, sqh))
-
-        return self._add_shape(
-            body,
-            wp.vec3(pos),
-            wp.quat(q),
-            GEO_CONE,
-            wp.vec3(radius, half_height, 0.0),
-            None,
-            density,
-            ke,
-            kd,
-            kf,
-            ka,
-            mu,
-            restitution,
-            thickness,
-            is_solid,
-            has_ground_collision=has_ground_collision,
-            has_shape_collision=has_shape_collision,
-            collision_group=collision_group,
-            is_visible=is_visible,
-        )
-
-    def add_shape_mesh(
-        self,
-        body: int,
-        pos: Vec3 | None = None,
-        rot: Quat | None = None,
-        mesh: Mesh | None = None,
-        scale: Vec3 | None = None,
-        density: float | None = None,
-        ke: float | None = None,
-        kd: float | None = None,
-        kf: float | None = None,
-        ka: float | None = None,
-        mu: float | None = None,
-        restitution: float | None = None,
-        is_solid: bool = True,
-        thickness: float | None = None,
-        has_ground_collision: bool = True,
-        has_shape_collision: bool = True,
-        collision_group: int = -1,
-        is_visible: bool = True,
-    ) -> int:
-        """Add a triangle mesh collision shape to a body.
-
-        Args:
-            body: The index of the parent body this shape belongs to (use -1 for static shapes)
-            pos: The location of the shape with respect to the parent frame
-              (None to use the default value ``wp.vec3(0.0, 0.0, 0.0)``)
-            rot: The rotation of the shape with respect to the parent frame
-              (None to use the default value ``wp.quat(0.0, 0.0, 0.0, 1.0)``)
-            mesh: The mesh object
-            scale: Scale to use for the collider. (None to use the default value ``wp.vec3(1.0, 1.0, 1.0)``)
-            density: The density of the shape (None to use the default value :attr:`default_shape_density`)
-            ke: The contact elastic stiffness (None to use the default value :attr:`default_shape_ke`)
-            kd: The contact damping stiffness (None to use the default value :attr:`default_shape_kd`)
-            kf: The contact friction stiffness (None to use the default value :attr:`default_shape_kf`)
-            ka: The contact adhesion distance (None to use the default value :attr:`default_shape_ka`)
-            mu: The coefficient of friction (None to use the default value :attr:`default_shape_mu`)
-            restitution: The coefficient of restitution (None to use the default value :attr:`default_shape_restitution`)
-            is_solid: If True, the mesh is solid, otherwise it is a hollow surface with the given wall thickness
-            thickness: Thickness to use for computing inertia of a hollow mesh, and for collision handling (None to use the default value :attr:`default_shape_thickness`)
-            has_ground_collision: If True, the shape will collide with the ground plane if `Model.ground` is True
-            has_shape_collision: If True, the shape will collide with other shapes
-            collision_group: The collision group of the shape
-            is_visible: Whether the mesh is visible
-
-        Returns:
-            The index of the added shape
-
-        """
-
-        if pos is None:
-            pos = wp.vec3(0.0, 0.0, 0.0)
-
-        if rot is None:
-            rot = wp.quat(0.0, 0.0, 0.0, 1.0)
-
-        if scale is None:
-            scale = wp.vec3(1.0, 1.0, 1.0)
-
-        return self._add_shape(
-            body,
-            pos,
-            rot,
-            GEO_MESH,
-            wp.vec3(scale[0], scale[1], scale[2]),
-            mesh,
-            density,
-            ke,
-            kd,
-            kf,
-            ka,
-            mu,
-            restitution,
-            thickness,
-            is_solid,
-            has_ground_collision=has_ground_collision,
-            has_shape_collision=has_shape_collision,
-            collision_group=collision_group,
-            is_visible=is_visible,
-        )
-
-    def add_shape_sdf(
-        self,
-        body: int,
-        pos: Vec3 | tuple[float, float, float] = (0.0, 0.0, 0.0),
-        rot: Quat | tuple[float, float, float, float] = (0.0, 0.0, 0.0, 1.0),
-        sdf: SDF | None = None,
-        scale: Vec3 | tuple[float, float, float] = (1.0, 1.0, 1.0),
-        density: float | None = None,
-        ke: float | None = None,
-        kd: float | None = None,
-        kf: float | None = None,
-        ka: float | None = None,
-        mu: float | None = None,
-        restitution: float | None = None,
-        is_solid: bool = True,
-        thickness: float | None = None,
-        has_ground_collision: bool = True,
-        has_shape_collision: bool = True,
-        collision_group: int = -1,
-        is_visible: bool = True,
-    ) -> int:
-        """Add a SDF collision shape to a body.
-
-        Args:
-            body: The index of the parent body this shape belongs to (use -1 for static shapes)
-            pos: The location of the shape with respect to the parent frame
-            rot: The rotation of the shape with respect to the parent frame
-            sdf: The sdf object
-            scale: Scale to use for the collider
-            density: The density of the shape (None to use the default value :attr:`default_shape_density`)
-            ke: The contact elastic stiffness (None to use the default value :attr:`default_shape_ke`)
-            kd: The contact damping stiffness (None to use the default value :attr:`default_shape_kd`)
-            kf: The contact friction stiffness (None to use the default value :attr:`default_shape_kf`)
-            ka: The contact adhesion distance (None to use the default value :attr:`default_shape_ka`)
-            mu: The coefficient of friction (None to use the default value :attr:`default_shape_mu`)
-            restitution: The coefficient of restitution (None to use the default value :attr:`default_shape_restitution`)
-            is_solid: If True, the SDF is solid, otherwise it is a hollow surface with the given wall thickness
-            thickness: Thickness to use for collision handling (None to use the default value :attr:`default_shape_thickness`)
-            has_ground_collision: If True, the shape will collide with the ground plane if `Model.ground` is True
-            has_shape_collision: If True, the shape will collide with other shapes
-            collision_group: The collision group of the shape
-            is_visible: Whether the shape is visible
-
-        Returns:
-            The index of the added shape
-
-        """
-        return self._add_shape(
-            body,
-            wp.vec3(pos),
-            wp.quat(rot),
-            GEO_SDF,
-            wp.vec3(scale[0], scale[1], scale[2]),
-            sdf,
-            density,
-            ke,
-            kd,
-            kf,
-            ka,
-            mu,
-            restitution,
-            thickness,
-            is_solid,
-            has_ground_collision=has_ground_collision,
-            has_shape_collision=has_shape_collision,
-            collision_group=collision_group,
-            is_visible=is_visible,
-        )
-
-    def _shape_radius(self, type, scale, src):
-        """
-        Calculates the radius of a sphere that encloses the shape, used for broadphase collision detection.
-        """
-        if type == GEO_SPHERE:
-            return scale[0]
-        elif type == GEO_BOX:
-            return np.linalg.norm(scale)
-        elif type == GEO_CAPSULE or type == GEO_CYLINDER or type == GEO_CONE:
-            return scale[0] + scale[1]
-        elif type == GEO_MESH:
-            vmax = np.max(np.abs(src.vertices), axis=0) * np.max(scale)
-            return np.linalg.norm(vmax)
-        elif type == GEO_PLANE:
-            if scale[0] > 0.0 and scale[1] > 0.0:
-                # finite plane
-                return np.linalg.norm(scale)
-            else:
-                return 1.0e6
-        else:
-            return 10.0
-
-    def _add_shape(
-        self,
-        body,
-        pos,
-        rot,
-        type,
-        scale,
-        src=None,
-        density=None,
-        ke=None,
-        kd=None,
-        kf=None,
-        ka=None,
-        mu=None,
-        restitution=None,
-        thickness=None,
-        is_solid=True,
-        collision_group=-1,
-        collision_filter_parent=True,
-        has_ground_collision=True,
-        has_shape_collision=True,
-        is_visible: bool = True,
-    ) -> int:
-        self.shape_body.append(body)
-        shape = self.shape_count
-        if body in self.body_shapes:
-            # no contacts between shapes of the same body
-            for same_body_shape in self.body_shapes[body]:
-                self.shape_collision_filter_pairs.add((same_body_shape, shape))
-            self.body_shapes[body].append(shape)
-        else:
-            self.body_shapes[body] = [shape]
-        ke = ke if ke is not None else self.default_shape_ke
-        kd = kd if kd is not None else self.default_shape_kd
-        kf = kf if kf is not None else self.default_shape_kf
-        ka = ka if ka is not None else self.default_shape_ka
-        mu = mu if mu is not None else self.default_shape_mu
-        restitution = restitution if restitution is not None else self.default_shape_restitution
-        thickness = thickness if thickness is not None else self.default_shape_thickness
-        density = density if density is not None else self.default_shape_density
-        self.shape_transform.append(wp.transform(pos, rot))
-        self.shape_visible.append(is_visible)
-        self.shape_geo_type.append(type)
-        self.shape_geo_scale.append((scale[0], scale[1], scale[2]))
-        self.shape_geo_src.append(src)
-        self.shape_geo_thickness.append(thickness)
-        self.shape_geo_is_solid.append(is_solid)
-        self.shape_material_ke.append(ke)
-        self.shape_material_kd.append(kd)
-        self.shape_material_kf.append(kf)
-        self.shape_material_ka.append(ka)
-        self.shape_material_mu.append(mu)
-        self.shape_material_restitution.append(restitution)
-        self.shape_collision_group.append(collision_group)
-        if collision_group not in self.shape_collision_group_map:
-            self.shape_collision_group_map[collision_group] = []
-        self.last_collision_group = max(self.last_collision_group, collision_group)
-        self.shape_collision_group_map[collision_group].append(shape)
-        self.shape_collision_radius.append(self._shape_radius(type, scale, src))
-        if collision_filter_parent and body > -1 and body in self.joint_parents:
-            for parent_body in self.joint_parents[body]:
-                if parent_body > -1:
-                    for parent_shape in self.body_shapes[parent_body]:
-                        self.shape_collision_filter_pairs.add((parent_shape, shape))
-        if body == -1:
-            has_ground_collision = False
-        self.shape_ground_collision.append(has_ground_collision)
-        self.shape_shape_collision.append(has_shape_collision)
-
-        if density > 0.0:
-            (m, c, I) = compute_shape_mass(type, scale, src, density, is_solid, thickness)
-            com_body = wp.transform_point(wp.transform(pos, rot), c)
-            self._update_body_mass(body, m, I, com_body, rot)
-        return shape
-
-    # particles
-    def add_particle(
-        self,
-        pos: Vec3,
-        vel: Vec3,
-        mass: float,
-        radius: float | None = None,
-        flags: wp.uint32 = PARTICLE_FLAG_ACTIVE,
-    ) -> int:
-        """Adds a single particle to the model
-
-        Args:
-            pos: The initial position of the particle
-            vel: The initial velocity of the particle
-            mass: The mass of the particle
-            radius: The radius of the particle used in collision handling. If None, the radius is set to the default value (:attr:`default_particle_radius`).
-            flags: The flags that control the dynamical behavior of the particle, see PARTICLE_FLAG_* constants
-
-        Note:
-            Set the mass equal to zero to create a 'kinematic' particle that does is not subject to dynamics.
-
-        Returns:
-            The index of the particle in the system
-        """
-        self.particle_q.append(pos)
-        self.particle_qd.append(vel)
-        self.particle_mass.append(mass)
-        if radius is None:
-            radius = self.default_particle_radius
-        self.particle_radius.append(radius)
-        self.particle_flags.append(flags)
-
-        particle_id = self.particle_count - 1
-
-        return particle_id
-
-    def add_spring(self, i: int, j, ke: float, kd: float, control: float):
-        """Adds a spring between two particles in the system
-
-        Args:
-            i: The index of the first particle
-            j: The index of the second particle
-            ke: The elastic stiffness of the spring
-            kd: The damping stiffness of the spring
-            control: The actuation level of the spring
-
-        Note:
-            The spring is created with a rest-length based on the distance
-            between the particles in their initial configuration.
-
-        """
-        self.spring_indices.append(i)
-        self.spring_indices.append(j)
-        self.spring_stiffness.append(ke)
-        self.spring_damping.append(kd)
-        self.spring_control.append(control)
-
-        # compute rest length
-        p = self.particle_q[i]
-        q = self.particle_q[j]
-
-        delta = np.subtract(p, q)
-        l = np.sqrt(np.dot(delta, delta))
-
-        self.spring_rest_length.append(l)
-
-    def add_triangle(
-        self,
-        i: int,
-        j: int,
-        k: int,
-        tri_ke: float | None = None,
-        tri_ka: float | None = None,
-        tri_kd: float | None = None,
-        tri_drag: float | None = None,
-        tri_lift: float | None = None,
-    ) -> float:
-        """Adds a triangular FEM element between three particles in the system.
-
-        Triangles are modeled as viscoelastic elements with elastic stiffness and damping
-        parameters specified on the model. See model.tri_ke, model.tri_kd.
-
-        Args:
-            i: The index of the first particle
-            j: The index of the second particle
-            k: The index of the third particle
-
-        Return:
-            The area of the triangle
-
-        Note:
-            The triangle is created with a rest-length based on the distance
-            between the particles in their initial configuration.
-        """
-        # TODO: Expose elastic parameters on a per-element basis
-        tri_ke = tri_ke if tri_ke is not None else self.default_tri_ke
-        tri_ka = tri_ka if tri_ka is not None else self.default_tri_ka
-        tri_kd = tri_kd if tri_kd is not None else self.default_tri_kd
-        tri_drag = tri_drag if tri_drag is not None else self.default_tri_drag
-        tri_lift = tri_lift if tri_lift is not None else self.default_tri_lift
-
-        # compute basis for 2D rest pose
-        p = self.particle_q[i]
-        q = self.particle_q[j]
-        r = self.particle_q[k]
-
-        qp = q - p
-        rp = r - p
-
-        # construct basis aligned with the triangle
-        n = wp.normalize(wp.cross(qp, rp))
-        e1 = wp.normalize(qp)
-        e2 = wp.normalize(wp.cross(n, e1))
-
-        R = np.array((e1, e2))
-        M = np.array((qp, rp))
-
-        D = R @ M.T
-
-        area = np.linalg.det(D) / 2.0
-
-        if area <= 0.0:
-            print("inverted or degenerate triangle element")
-            return 0.0
-        else:
-            inv_D = np.linalg.inv(D)
-
-            self.tri_indices.append((i, j, k))
-            self.tri_poses.append(inv_D.tolist())
-            self.tri_activations.append(0.0)
-            self.tri_materials.append((tri_ke, tri_ka, tri_kd, tri_drag, tri_lift))
-            self.tri_areas.append(area)
-            return area
-
-    def add_triangles(
-        self,
-        i: list[int],
-        j: list[int],
-        k: list[int],
-        tri_ke: list[float] | None = None,
-        tri_ka: list[float] | None = None,
-        tri_kd: list[float] | None = None,
-        tri_drag: list[float] | None = None,
-        tri_lift: list[float] | None = None,
-    ) -> list[float]:
-        """Adds triangular FEM elements between groups of three particles in the system.
-
-        Triangles are modeled as viscoelastic elements with elastic stiffness and damping
-        Parameters specified on the model. See model.tri_ke, model.tri_kd.
-
-        Args:
-            i: The indices of the first particle
-            j: The indices of the second particle
-            k: The indices of the third particle
-
-        Return:
-            The areas of the triangles
-
-        Note:
-            A triangle is created with a rest-length based on the distance
-            between the particles in their initial configuration.
-
-        """
-        # compute basis for 2D rest pose
-        p = np.array(self.particle_q)[i]
-        q = np.array(self.particle_q)[j]
-        r = np.array(self.particle_q)[k]
-
-        qp = q - p
-        rp = r - p
-
-        def normalized(a):
-            l = np.linalg.norm(a, axis=-1, keepdims=True)
-            l[l == 0] = 1.0
-            return a / l
-
-        n = normalized(np.cross(qp, rp))
-        e1 = normalized(qp)
-        e2 = normalized(np.cross(n, e1))
-
-        R = np.concatenate((e1[..., None], e2[..., None]), axis=-1)
-        M = np.concatenate((qp[..., None], rp[..., None]), axis=-1)
-
-        D = np.matmul(R.transpose(0, 2, 1), M)
-
-        areas = np.linalg.det(D) / 2.0
-        areas[areas < 0.0] = 0.0
-        valid_inds = (areas > 0.0).nonzero()[0]
-        if len(valid_inds) < len(areas):
-            print("inverted or degenerate triangle elements")
-
-        D[areas == 0.0] = np.eye(2)[None, ...]
-        inv_D = np.linalg.inv(D)
-
-        inds = np.concatenate((i[valid_inds, None], j[valid_inds, None], k[valid_inds, None]), axis=-1)
-
-        self.tri_indices.extend(inds.tolist())
-        self.tri_poses.extend(inv_D[valid_inds].tolist())
-        self.tri_activations.extend([0.0] * len(valid_inds))
-
-        def init_if_none(arr, defaultValue):
-            if arr is None:
-                return [defaultValue] * len(areas)
-            return arr
-
-        tri_ke = init_if_none(tri_ke, self.default_tri_ke)
-        tri_ka = init_if_none(tri_ka, self.default_tri_ka)
-        tri_kd = init_if_none(tri_kd, self.default_tri_kd)
-        tri_drag = init_if_none(tri_drag, self.default_tri_drag)
-        tri_lift = init_if_none(tri_lift, self.default_tri_lift)
-
-        self.tri_materials.extend(
-            zip(
-                np.array(tri_ke)[valid_inds],
-                np.array(tri_ka)[valid_inds],
-                np.array(tri_kd)[valid_inds],
-                np.array(tri_drag)[valid_inds],
-                np.array(tri_lift)[valid_inds],
-            )
-        )
-        areas = areas.tolist()
-        self.tri_areas.extend(areas)
-        return areas
-
-    def add_tetrahedron(
-        self, i: int, j: int, k: int, l: int, k_mu: float = 1.0e3, k_lambda: float = 1.0e3, k_damp: float = 0.0
-    ) -> float:
-        """Adds a tetrahedral FEM element between four particles in the system.
-
-        Tetrahedra are modeled as viscoelastic elements with a NeoHookean energy
-        density based on [Smith et al. 2018].
-
-        Args:
-            i: The index of the first particle
-            j: The index of the second particle
-            k: The index of the third particle
-            l: The index of the fourth particle
-            k_mu: The first elastic Lame parameter
-            k_lambda: The second elastic Lame parameter
-            k_damp: The element's damping stiffness
-
-        Return:
-            The volume of the tetrahedron
-
-        Note:
-            The tetrahedron is created with a rest-pose based on the particle's initial configuration
-
-        """
-        # compute basis for 2D rest pose
-        p = np.array(self.particle_q[i])
-        q = np.array(self.particle_q[j])
-        r = np.array(self.particle_q[k])
-        s = np.array(self.particle_q[l])
-
-        qp = q - p
-        rp = r - p
-        sp = s - p
-
-        Dm = np.array((qp, rp, sp)).T
-        volume = np.linalg.det(Dm) / 6.0
-
-        if volume <= 0.0:
-            print("inverted tetrahedral element")
-        else:
-            inv_Dm = np.linalg.inv(Dm)
-
-            self.tet_indices.append((i, j, k, l))
-            self.tet_poses.append(inv_Dm.tolist())
-            self.tet_activations.append(0.0)
-            self.tet_materials.append((k_mu, k_lambda, k_damp))
-
-        return volume
-
-    def add_edge(
-        self,
-        i: int,
-        j: int,
-        k: int,
-        l: int,
-        rest: float | None = None,
-        edge_ke: float | None = None,
-        edge_kd: float | None = None,
-    ) -> None:
-        """Adds a bending edge element between four particles in the system.
-
-        Bending elements are designed to be between two connected triangles. Then
-        bending energy is based of [Bridson et al. 2002]. Bending stiffness is controlled
-        by the `model.tri_kb` parameter.
-
-        Args:
-            i: The index of the first particle, i.e., opposite vertex 0
-            j: The index of the second particle, i.e., opposite vertex 1
-            k: The index of the third particle, i.e., vertex 0
-            l: The index of the fourth particle, i.e., vertex 1
-            rest: The rest angle across the edge in radians, if not specified it will be computed
-
-        Note:
-            The edge lies between the particles indexed by 'k' and 'l' parameters with the opposing
-            vertices indexed by 'i' and 'j'. This defines two connected triangles with counter clockwise
-            winding: (i, k, l), (j, l, k).
-
-        """
-        edge_ke = edge_ke if edge_ke is not None else self.default_edge_ke
-        edge_kd = edge_kd if edge_kd is not None else self.default_edge_kd
-
-        # compute rest angle
-        x3 = self.particle_q[k]
-        x4 = self.particle_q[l]
-        if rest is None:
-            x1 = self.particle_q[i]
-            x2 = self.particle_q[j]
-
-            n1 = wp.normalize(wp.cross(x3 - x1, x4 - x1))
-            n2 = wp.normalize(wp.cross(x4 - x2, x3 - x2))
-            e = wp.normalize(x4 - x3)
-
-            d = np.clip(np.dot(n2, n1), -1.0, 1.0)
-
-            angle = math.acos(d)
-            sign = np.sign(np.dot(np.cross(n2, n1), e))
-
-            rest = angle * sign
-
-        self.edge_indices.append((i, j, k, l))
-        self.edge_rest_angle.append(rest)
-        self.edge_rest_length.append(wp.length(x4 - x3))
-        self.edge_bending_properties.append((edge_ke, edge_kd))
-
-    def add_edges(
-        self,
-        i,
-        j,
-        k,
-        l,
-        rest: list[float] | None = None,
-        edge_ke: list[float] | None = None,
-        edge_kd: list[float] | None = None,
-    ) -> None:
-        """Adds bending edge elements between groups of four particles in the system.
-
-        Bending elements are designed to be between two connected triangles. Then
-        bending energy is based of [Bridson et al. 2002]. Bending stiffness is controlled
-        by the `model.tri_kb` parameter.
-
-        Args:
-            i: The index of the first particle, i.e., opposite vertex 0
-            j: The index of the second particle, i.e., opposite vertex 1
-            k: The index of the third particle, i.e., vertex 0
-            l: The index of the fourth particle, i.e., vertex 1
-            rest: The rest angles across the edges in radians, if not specified they will be computed
-
-        Note:
-            The edge lies between the particles indexed by 'k' and 'l' parameters with the opposing
-            vertices indexed by 'i' and 'j'. This defines two connected triangles with counter clockwise
-            winding: (i, k, l), (j, l, k).
-
-        """
-        x3 = np.array(self.particle_q)[k]
-        x4 = np.array(self.particle_q)[l]
-        if rest is None:
-            # compute rest angle
-            x1 = np.array(self.particle_q)[i]
-            x2 = np.array(self.particle_q)[j]
-            x3 = np.array(self.particle_q)[k]
-            x4 = np.array(self.particle_q)[l]
-
-            def normalized(a):
-                l = np.linalg.norm(a, axis=-1, keepdims=True)
-                l[l == 0] = 1.0
-                return a / l
-
-            n1 = normalized(np.cross(x3 - x1, x4 - x1))
-            n2 = normalized(np.cross(x4 - x2, x3 - x2))
-            e = normalized(x4 - x3)
-
-            def dot(a, b):
-                return (a * b).sum(axis=-1)
-
-            d = np.clip(dot(n2, n1), -1.0, 1.0)
-
-            angle = np.arccos(d)
-            sign = np.sign(dot(np.cross(n2, n1), e))
-
-            rest = angle * sign
-
-        inds = np.concatenate((i[:, None], j[:, None], k[:, None], l[:, None]), axis=-1)
-
-        self.edge_indices.extend(inds.tolist())
-        self.edge_rest_angle.extend(rest.tolist())
-        self.edge_rest_length.extend(np.linalg.norm(x4 - x3, axis=1).tolist())
-
-        def init_if_none(arr, defaultValue):
-            if arr is None:
-                return [defaultValue] * len(i)
-            return arr
-
-        edge_ke = init_if_none(edge_ke, self.default_edge_ke)
-        edge_kd = init_if_none(edge_kd, self.default_edge_kd)
-
-        self.edge_bending_properties.extend(zip(edge_ke, edge_kd))
-
-    def add_cloth_grid(
-        self,
-        pos: Vec3,
-        rot: Quat,
-        vel: Vec3,
-        dim_x: int,
-        dim_y: int,
-        cell_x: float,
-        cell_y: float,
-        mass: float,
-        reverse_winding: bool = False,
-        fix_left: bool = False,
-        fix_right: bool = False,
-        fix_top: bool = False,
-        fix_bottom: bool = False,
-        tri_ke: float | None = None,
-        tri_ka: float | None = None,
-        tri_kd: float | None = None,
-        tri_drag: float | None = None,
-        tri_lift: float | None = None,
-        edge_ke: float | None = None,
-        edge_kd: float | None = None,
-        add_springs: bool = False,
-        spring_ke: float | None = None,
-        spring_kd: float | None = None,
-        particle_radius: float | None = None,
-    ) -> None:
-        """Helper to create a regular planar cloth grid
-
-        Creates a rectangular grid of particles with FEM triangles and bending elements
-        automatically.
-
-        Args:
-            pos: The position of the cloth in world space
-            rot: The orientation of the cloth in world space
-            vel: The velocity of the cloth in world space
-            dim_x_: The number of rectangular cells along the x-axis
-            dim_y: The number of rectangular cells along the y-axis
-            cell_x: The width of each cell in the x-direction
-            cell_y: The width of each cell in the y-direction
-            mass: The mass of each particle
-            reverse_winding: Flip the winding of the mesh
-            fix_left: Make the left-most edge of particles kinematic (fixed in place)
-            fix_right: Make the right-most edge of particles kinematic
-            fix_top: Make the top-most edge of particles kinematic
-            fix_bottom: Make the bottom-most edge of particles kinematic
-        """
-        tri_ke = tri_ke if tri_ke is not None else self.default_tri_ke
-        tri_ka = tri_ka if tri_ka is not None else self.default_tri_ka
-        tri_kd = tri_kd if tri_kd is not None else self.default_tri_kd
-        tri_drag = tri_drag if tri_drag is not None else self.default_tri_drag
-        tri_lift = tri_lift if tri_lift is not None else self.default_tri_lift
-        edge_ke = edge_ke if edge_ke is not None else self.default_edge_ke
-        edge_kd = edge_kd if edge_kd is not None else self.default_edge_kd
-        spring_ke = spring_ke if spring_ke is not None else self.default_spring_ke
-        spring_kd = spring_kd if spring_kd is not None else self.default_spring_kd
-        particle_radius = particle_radius if particle_radius is not None else self.default_particle_radius
-
-        def grid_index(x, y, dim_x):
-            return y * dim_x + x
-
-        start_vertex = len(self.particle_q)
-        start_tri = len(self.tri_indices)
-
-        for y in range(0, dim_y + 1):
-            for x in range(0, dim_x + 1):
-                g = wp.vec3(x * cell_x, y * cell_y, 0.0)
-                p = wp.quat_rotate(rot, g) + pos
-                m = mass
-
-                particle_flag = PARTICLE_FLAG_ACTIVE
-
-                if x == 0 and fix_left:
-                    m = 0.0
-                    particle_flag = wp.uint32(int(particle_flag) & ~int(PARTICLE_FLAG_ACTIVE))
-                elif x == dim_x and fix_right:
-                    m = 0.0
-                    particle_flag = wp.uint32(int(particle_flag) & ~int(PARTICLE_FLAG_ACTIVE))
-                elif y == 0 and fix_bottom:
-                    m = 0.0
-                    particle_flag = wp.uint32(int(particle_flag) & ~int(PARTICLE_FLAG_ACTIVE))
-                elif y == dim_y and fix_top:
-                    m = 0.0
-                    particle_flag = wp.uint32(int(particle_flag) & ~int(PARTICLE_FLAG_ACTIVE))
-
-                self.add_particle(p, vel, m, flags=particle_flag, radius=particle_radius)
-
-                if x > 0 and y > 0:
-                    if reverse_winding:
-                        tri1 = (
-                            start_vertex + grid_index(x - 1, y - 1, dim_x + 1),
-                            start_vertex + grid_index(x, y - 1, dim_x + 1),
-                            start_vertex + grid_index(x, y, dim_x + 1),
-                        )
-
-                        tri2 = (
-                            start_vertex + grid_index(x - 1, y - 1, dim_x + 1),
-                            start_vertex + grid_index(x, y, dim_x + 1),
-                            start_vertex + grid_index(x - 1, y, dim_x + 1),
-                        )
-
-                        self.add_triangle(*tri1, tri_ke, tri_ka, tri_kd, tri_drag, tri_lift)
-                        self.add_triangle(*tri2, tri_ke, tri_ka, tri_kd, tri_drag, tri_lift)
-
-                    else:
-                        tri1 = (
-                            start_vertex + grid_index(x - 1, y - 1, dim_x + 1),
-                            start_vertex + grid_index(x, y - 1, dim_x + 1),
-                            start_vertex + grid_index(x - 1, y, dim_x + 1),
-                        )
-
-                        tri2 = (
-                            start_vertex + grid_index(x, y - 1, dim_x + 1),
-                            start_vertex + grid_index(x, y, dim_x + 1),
-                            start_vertex + grid_index(x - 1, y, dim_x + 1),
-                        )
-
-                        self.add_triangle(*tri1, tri_ke, tri_ka, tri_kd, tri_drag, tri_lift)
-                        self.add_triangle(*tri2, tri_ke, tri_ka, tri_kd, tri_drag, tri_lift)
-
-        end_tri = len(self.tri_indices)
-
-        # bending constraints, could create these explicitly for a grid but this
-        # is a good test of the adjacency structure
-        adj = wp.utils.MeshAdjacency(self.tri_indices[start_tri:end_tri], end_tri - start_tri)
-
-        spring_indices = set()
-
-        for _k, e in adj.edges.items():
-            self.add_edge(
-                e.o0, e.o1, e.v0, e.v1, edge_ke=edge_ke, edge_kd=edge_kd
-            )  # opposite 0, opposite 1, vertex 0, vertex 1
-
-            # skip constraints open edges
-            spring_indices.add((min(e.v0, e.v1), max(e.v0, e.v1)))
-            if e.f0 != -1:
-                spring_indices.add((min(e.o0, e.v0), max(e.o0, e.v0)))
-                spring_indices.add((min(e.o0, e.v1), max(e.o0, e.v1)))
-            if e.f1 != -1:
-                spring_indices.add((min(e.o1, e.v0), max(e.o1, e.v0)))
-                spring_indices.add((min(e.o1, e.v1), max(e.o1, e.v1)))
-
-            if e.f0 != -1 and e.f1 != -1:
-                spring_indices.add((min(e.o0, e.o1), max(e.o0, e.o1)))
-
-        if add_springs:
-            for i, j in spring_indices:
-                self.add_spring(i, j, spring_ke, spring_kd, control=0.0)
-
-    def add_cloth_mesh(
-        self,
-        pos: Vec3,
-        rot: Quat,
-        scale: float,
-        vel: Vec3,
-        vertices: list[Vec3],
-        indices: list[int],
-        density: float,
-        edge_callback=None,
-        face_callback=None,
-        tri_ke: float | None = None,
-        tri_ka: float | None = None,
-        tri_kd: float | None = None,
-        tri_drag: float | None = None,
-        tri_lift: float | None = None,
-        edge_ke: float | None = None,
-        edge_kd: float | None = None,
-        add_springs: bool = False,
-        spring_ke: float | None = None,
-        spring_kd: float | None = None,
-        particle_radius: float | None = None,
-    ) -> None:
-        """Helper to create a cloth model from a regular triangle mesh
-
-        Creates one FEM triangle element and one bending element for every face
-        and edge in the input triangle mesh
-
-        Args:
-            pos: The position of the cloth in world space
-            rot: The orientation of the cloth in world space
-            vel: The velocity of the cloth in world space
-            vertices: A list of vertex positions
-            indices: A list of triangle indices, 3 entries per-face
-            density: The density per-area of the mesh
-            edge_callback: A user callback when an edge is created
-            face_callback: A user callback when a face is created
-            particle_radius: The particle_radius which controls particle based collisions.
-        Note:
-
-            The mesh should be two manifold.
-        """
-        tri_ke = tri_ke if tri_ke is not None else self.default_tri_ke
-        tri_ka = tri_ka if tri_ka is not None else self.default_tri_ka
-        tri_kd = tri_kd if tri_kd is not None else self.default_tri_kd
-        tri_drag = tri_drag if tri_drag is not None else self.default_tri_drag
-        tri_lift = tri_lift if tri_lift is not None else self.default_tri_lift
-        edge_ke = edge_ke if edge_ke is not None else self.default_edge_ke
-        edge_kd = edge_kd if edge_kd is not None else self.default_edge_kd
-        spring_ke = spring_ke if spring_ke is not None else self.default_spring_ke
-        spring_kd = spring_kd if spring_kd is not None else self.default_spring_kd
-        particle_radius = particle_radius if particle_radius is not None else self.default_particle_radius
-
-        num_tris = int(len(indices) / 3)
-
-        start_vertex = len(self.particle_q)
-        start_tri = len(self.tri_indices)
-
-        # particles
-        for v in vertices:
-            p = wp.quat_rotate(rot, v * scale) + pos
-
-            self.add_particle(p, vel, 0.0, radius=particle_radius)
-
-        # triangles
-        inds = start_vertex + np.array(indices)
-        inds = inds.reshape(-1, 3)
-        areas = self.add_triangles(
-            inds[:, 0],
-            inds[:, 1],
-            inds[:, 2],
-            [tri_ke] * num_tris,
-            [tri_ka] * num_tris,
-            [tri_kd] * num_tris,
-            [tri_drag] * num_tris,
-            [tri_lift] * num_tris,
-        )
-
-        for t in range(num_tris):
-            area = areas[t]
-
-            self.particle_mass[inds[t, 0]] += density * area / 3.0
-            self.particle_mass[inds[t, 1]] += density * area / 3.0
-            self.particle_mass[inds[t, 2]] += density * area / 3.0
-
-        end_tri = len(self.tri_indices)
-
-        adj = wp.utils.MeshAdjacency(self.tri_indices[start_tri:end_tri], end_tri - start_tri)
-
-        edge_indices = np.fromiter(
-            (x for e in adj.edges.values() for x in (e.o0, e.o1, e.v0, e.v1)),
-            int,
-        ).reshape(-1, 4)
-        self.add_edges(
-            edge_indices[:, 0],
-            edge_indices[:, 1],
-            edge_indices[:, 2],
-            edge_indices[:, 3],
-            edge_ke=[edge_ke] * len(edge_indices),
-            edge_kd=[edge_kd] * len(edge_indices),
-        )
-
-        if add_springs:
-            spring_indices = set()
-            for i, j, k, l in edge_indices:
-                spring_indices.add((min(k, l), max(k, l)))
-                if i != -1:
-                    spring_indices.add((min(i, k), max(i, k)))
-                    spring_indices.add((min(i, l), max(i, l)))
-                if j != -1:
-                    spring_indices.add((min(j, k), max(j, k)))
-                    spring_indices.add((min(j, l), max(j, l)))
-                if i != -1 and j != -1:
-                    spring_indices.add((min(i, j), max(i, j)))
-
-            for i, j in spring_indices:
-                self.add_spring(i, j, spring_ke, spring_kd, control=0.0)
-
-    def add_particle_grid(
-        self,
-        pos: Vec3,
-        rot: Quat,
-        vel: Vec3,
-        dim_x: int,
-        dim_y: int,
-        dim_z: int,
-        cell_x: float,
-        cell_y: float,
-        cell_z: float,
-        mass: float,
-        jitter: float,
-        radius_mean: float | None = None,
-        radius_std: float = 0.0,
-    ) -> None:
-        radius_mean = radius_mean if radius_mean is not None else self.default_particle_radius
-
-        rng = np.random.default_rng(42)
-        for z in range(dim_z):
-            for y in range(dim_y):
-                for x in range(dim_x):
-                    v = wp.vec3(x * cell_x, y * cell_y, z * cell_z)
-                    m = mass
-
-                    p = wp.quat_rotate(rot, v) + pos + wp.vec3(rng.random(3) * jitter)
-
-                    if radius_std > 0.0:
-                        r = radius_mean + rng.standard_normal() * radius_std
-                    else:
-                        r = radius_mean
-                    self.add_particle(p, vel, m, r)
-
-    def add_soft_grid(
-        self,
-        pos: Vec3,
-        rot: Quat,
-        vel: Vec3,
-        dim_x: int,
-        dim_y: int,
-        dim_z: int,
-        cell_x: float,
-        cell_y: float,
-        cell_z: float,
-        density: float,
-        k_mu: float,
-        k_lambda: float,
-        k_damp: float,
-        fix_left: bool = False,
-        fix_right: bool = False,
-        fix_top: bool = False,
-        fix_bottom: bool = False,
-        tri_ke: float | None = None,
-        tri_ka: float | None = None,
-        tri_kd: float | None = None,
-        tri_drag: float | None = None,
-        tri_lift: float | None = None,
-    ) -> None:
-        """Helper to create a rectangular tetrahedral FEM grid
-
-        Creates a regular grid of FEM tetrahedra and surface triangles. Useful for example
-        to create beams and sheets. Each hexahedral cell is decomposed into 5
-        tetrahedral elements.
-
-        Args:
-            pos: The position of the solid in world space
-            rot: The orientation of the solid in world space
-            vel: The velocity of the solid in world space
-            dim_x_: The number of rectangular cells along the x-axis
-            dim_y: The number of rectangular cells along the y-axis
-            dim_z: The number of rectangular cells along the z-axis
-            cell_x: The width of each cell in the x-direction
-            cell_y: The width of each cell in the y-direction
-            cell_z: The width of each cell in the z-direction
-            density: The density of each particle
-            k_mu: The first elastic Lame parameter
-            k_lambda: The second elastic Lame parameter
-            k_damp: The damping stiffness
-            fix_left: Make the left-most edge of particles kinematic (fixed in place)
-            fix_right: Make the right-most edge of particles kinematic
-            fix_top: Make the top-most edge of particles kinematic
-            fix_bottom: Make the bottom-most edge of particles kinematic
-        """
-        tri_ke = tri_ke if tri_ke is not None else self.default_tri_ke
-        tri_ka = tri_ka if tri_ka is not None else self.default_tri_ka
-        tri_kd = tri_kd if tri_kd is not None else self.default_tri_kd
-        tri_drag = tri_drag if tri_drag is not None else self.default_tri_drag
-        tri_lift = tri_lift if tri_lift is not None else self.default_tri_lift
-
-        start_vertex = len(self.particle_q)
-
-        mass = cell_x * cell_y * cell_z * density
-
-        for z in range(dim_z + 1):
-            for y in range(dim_y + 1):
-                for x in range(dim_x + 1):
-                    v = wp.vec3(x * cell_x, y * cell_y, z * cell_z)
-                    m = mass
-
-                    if fix_left and x == 0:
-                        m = 0.0
-
-                    if fix_right and x == dim_x:
-                        m = 0.0
-
-                    if fix_top and y == dim_y:
-                        m = 0.0
-
-                    if fix_bottom and y == 0:
-                        m = 0.0
-
-                    p = wp.quat_rotate(rot, v) + pos
-
-                    self.add_particle(p, vel, m)
-
-        # dict of open faces
-        faces = {}
-
-        def add_face(i: int, j: int, k: int):
-            key = tuple(sorted((i, j, k)))
-
-            if key not in faces:
-                faces[key] = (i, j, k)
-            else:
-                del faces[key]
-
-        def add_tet(i: int, j: int, k: int, l: int):
-            self.add_tetrahedron(i, j, k, l, k_mu, k_lambda, k_damp)
-
-            add_face(i, k, j)
-            add_face(j, k, l)
-            add_face(i, j, l)
-            add_face(i, l, k)
-
-        def grid_index(x, y, z):
-            return (dim_x + 1) * (dim_y + 1) * z + (dim_x + 1) * y + x
-
-        for z in range(dim_z):
-            for y in range(dim_y):
-                for x in range(dim_x):
-                    v0 = grid_index(x, y, z) + start_vertex
-                    v1 = grid_index(x + 1, y, z) + start_vertex
-                    v2 = grid_index(x + 1, y, z + 1) + start_vertex
-                    v3 = grid_index(x, y, z + 1) + start_vertex
-                    v4 = grid_index(x, y + 1, z) + start_vertex
-                    v5 = grid_index(x + 1, y + 1, z) + start_vertex
-                    v6 = grid_index(x + 1, y + 1, z + 1) + start_vertex
-                    v7 = grid_index(x, y + 1, z + 1) + start_vertex
-
-                    if (x & 1) ^ (y & 1) ^ (z & 1):
-                        add_tet(v0, v1, v4, v3)
-                        add_tet(v2, v3, v6, v1)
-                        add_tet(v5, v4, v1, v6)
-                        add_tet(v7, v6, v3, v4)
-                        add_tet(v4, v1, v6, v3)
-
-                    else:
-                        add_tet(v1, v2, v5, v0)
-                        add_tet(v3, v0, v7, v2)
-                        add_tet(v4, v7, v0, v5)
-                        add_tet(v6, v5, v2, v7)
-                        add_tet(v5, v2, v7, v0)
-
-        # add triangles
-        for _k, v in faces.items():
-            self.add_triangle(v[0], v[1], v[2], tri_ke, tri_ka, tri_kd, tri_drag, tri_lift)
-
-    def add_soft_mesh(
-        self,
-        pos: Vec3,
-        rot: Quat,
-        scale: float,
-        vel: Vec3,
-        vertices: list[Vec3],
-        indices: list[int],
-        density: float,
-        k_mu: float,
-        k_lambda: float,
-        k_damp: float,
-        tri_ke: float | None = None,
-        tri_ka: float | None = None,
-        tri_kd: float | None = None,
-        tri_drag: float | None = None,
-        tri_lift: float | None = None,
-    ) -> None:
-        """Helper to create a tetrahedral model from an input tetrahedral mesh
-
-        Args:
-            pos: The position of the solid in world space
-            rot: The orientation of the solid in world space
-            vel: The velocity of the solid in world space
-            vertices: A list of vertex positions, array of 3D points
-            indices: A list of tetrahedron indices, 4 entries per-element, flattened array
-            density: The density per-area of the mesh
-            k_mu: The first elastic Lame parameter
-            k_lambda: The second elastic Lame parameter
-            k_damp: The damping stiffness
-        """
-        tri_ke = tri_ke if tri_ke is not None else self.default_tri_ke
-        tri_ka = tri_ka if tri_ka is not None else self.default_tri_ka
-        tri_kd = tri_kd if tri_kd is not None else self.default_tri_kd
-        tri_drag = tri_drag if tri_drag is not None else self.default_tri_drag
-        tri_lift = tri_lift if tri_lift is not None else self.default_tri_lift
-
-        num_tets = int(len(indices) / 4)
-
-        start_vertex = len(self.particle_q)
-
-        # dict of open faces
-        faces = {}
-
-        def add_face(i, j, k):
-            key = tuple(sorted((i, j, k)))
-
-            if key not in faces:
-                faces[key] = (i, j, k)
-            else:
-                del faces[key]
-
-        pos = wp.vec3(pos[0], pos[1], pos[2])
-        # add particles
-        for v in vertices:
-            p = wp.quat_rotate(rot, wp.vec3(v[0], v[1], v[2]) * scale) + pos
-
-            self.add_particle(p, vel, 0.0)
-
-        # add tetrahedra
-        for t in range(num_tets):
-            v0 = start_vertex + indices[t * 4 + 0]
-            v1 = start_vertex + indices[t * 4 + 1]
-            v2 = start_vertex + indices[t * 4 + 2]
-            v3 = start_vertex + indices[t * 4 + 3]
-
-            volume = self.add_tetrahedron(v0, v1, v2, v3, k_mu, k_lambda, k_damp)
-
-            # distribute volume fraction to particles
-            if volume > 0.0:
-                self.particle_mass[v0] += density * volume / 4.0
-                self.particle_mass[v1] += density * volume / 4.0
-                self.particle_mass[v2] += density * volume / 4.0
-                self.particle_mass[v3] += density * volume / 4.0
-
-                # build open faces
-                add_face(v0, v2, v1)
-                add_face(v1, v2, v3)
-                add_face(v0, v1, v3)
-                add_face(v0, v3, v2)
-
-        # add triangles
-        for _k, v in faces.items():
-            try:
-                self.add_triangle(v[0], v[1], v[2], tri_ke, tri_ka, tri_kd, tri_drag, tri_lift)
-            except np.linalg.LinAlgError:
-                continue
-
-    # incrementally updates rigid body mass with additional mass and inertia expressed at a local to the body
-    def _update_body_mass(self, i, m, I, p, q):
-        if i == -1:
-            return
-
-        # find new COM
-        new_mass = self.body_mass[i] + m
-
-        if new_mass == 0.0:  # no mass
-            return
-
-        new_com = (self.body_com[i] * self.body_mass[i] + p * m) / new_mass
-
-        # shift inertia to new COM
-        com_offset = new_com - self.body_com[i]
-        shape_offset = new_com - p
-
-        new_inertia = transform_inertia(
-            self.body_mass[i], self.body_inertia[i], com_offset, wp.quat_identity()
-        ) + transform_inertia(m, I, shape_offset, q)
-
-        self.body_mass[i] = new_mass
-        self.body_inertia[i] = new_inertia
-        self.body_com[i] = new_com
-
-        if new_mass > 0.0:
-            self.body_inv_mass[i] = 1.0 / new_mass
-        else:
-            self.body_inv_mass[i] = 0.0
-
-        if any(x for x in new_inertia):
-            self.body_inv_inertia[i] = wp.inverse(new_inertia)
-        else:
-            self.body_inv_inertia[i] = new_inertia
-
-    def set_ground_plane(
-        self,
-        normal=None,
-        offset=0.0,
-        ke: float | None = None,
-        kd: float | None = None,
-        kf: float | None = None,
-        mu: float | None = None,
-        restitution: float | None = None,
-    ) -> None:
-        """Create a ground plane for the world.
-
-        If the normal is not specified, the ``up_vector`` of the :class:`ModelBuilder` is used.
-        """
-        ke = ke if ke is not None else self.default_shape_ke
-        kd = kd if kd is not None else self.default_shape_kd
-        kf = kf if kf is not None else self.default_shape_kf
-        mu = mu if mu is not None else self.default_shape_mu
-        restitution = restitution if restitution is not None else self.default_shape_restitution
-
-        if normal is None:
-            normal = self.up_vector
-        self._ground_params = {
-            "plane": (*normal, offset),
-            "width": 0.0,
-            "length": 0.0,
-            "ke": ke,
-            "kd": kd,
-            "kf": kf,
-            "mu": mu,
-            "restitution": restitution,
-        }
-
-    def _create_ground_plane(self) -> None:
-        ground_id = self.add_shape_plane(**self._ground_params)
-        self._ground_created = True
-        # disable ground collisions as they will be treated separately
-        for i in range(self.shape_count - 1):
-            self.shape_collision_filter_pairs.add((i, ground_id))
-
-    def set_coloring(self, particle_color_groups):
-        """Set coloring information with user-provided coloring.
-
-        Args:
-            particle_color_groups: A list of list or `np.array` with `dtype`=`int`. The length of the list is the number of colors
-                and each list or `np.array` contains the indices of vertices with this color.
-        """
-        particle_color_groups = [
-            color_group if isinstance(color_group, np.ndarray) else np.array(color_group)
-            for color_group in particle_color_groups
-        ]
-        self.particle_color_groups = particle_color_groups
-
-    def color(
-        self,
-        include_bending=False,
-        balance_colors=True,
-        target_max_min_color_ratio=1.1,
-        coloring_algorithm=ColoringAlgorithm.MCS,
-    ) -> None:
-        """Run coloring algorithm to generate coloring information.
-
-        Args:
-            include_bending_energy: Whether to consider bending energy for trimeshes in the coloring process. If set to `True`, the generated
-                graph will contain all the edges connecting o1 and o2; otherwise, the graph will be equivalent to the trimesh.
-            balance_colors: Whether to apply the color balancing algorithm to balance the size of each color
-            target_max_min_color_ratio: the color balancing algorithm will stop when the ratio between the largest color and
-                the smallest color reaches this value
-            algorithm: Value should be an enum type of ColoringAlgorithm, otherwise it will raise an error. ColoringAlgorithm.mcs means using the MCS coloring algorithm,
-                while ColoringAlgorithm.ordered_greedy means using the degree-ordered greedy algorithm. The MCS algorithm typically generates 30% to 50% fewer colors
-                compared to the ordered greedy algorithm, while maintaining the same linear complexity. Although MCS has a constant overhead that makes it about twice
-                as slow as the greedy algorithm, it produces significantly better coloring results. We recommend using MCS, especially if coloring is only part of the
-                preprocessing.
-
-        Note:
-
-            References to the coloring algorithm:
-
-            MCS: Pereira, F. M. Q., & Palsberg, J. (2005, November). Register allocation via coloring of chordal graphs. In Asian Symposium on Programming Languages and Systems (pp. 315-329). Berlin, Heidelberg: Springer Berlin Heidelberg.
-
-            Ordered Greedy: Ton-That, Q. M., Kry, P. G., & Andrews, S. (2023). Parallel block Neo-Hookean XPBD using graph clustering. Computers & Graphics, 110, 1-10.
-
-        """
-        # ignore bending energy if it is too small
-        edge_indices = np.array(self.edge_indices)
-
-        self.particle_color_groups = color_trimesh(
-            len(self.particle_q),
-            edge_indices,
-            include_bending,
-            algorithm=coloring_algorithm,
-            balance_colors=balance_colors,
-            target_max_min_color_ratio=target_max_min_color_ratio,
-        )
-
-    def finalize(self, device=None, requires_grad=False) -> Model:
-        """Convert this builder object to a concrete model for simulation.
-
-        After building simulation elements this method should be called to transfer
-        all data to device memory ready for simulation.
-
-        Args:
-            device: The simulation device to use, e.g.: 'cpu', 'cuda'
-            requires_grad: Whether to enable gradient computation for the model
-
-        Returns:
-
-            A model object.
-        """
-
-        # ensure the env count is set correctly
-        self.num_envs = max(1, self.num_envs)
-
-        # add ground plane if not already created
-        if not self._ground_created:
-            self._create_ground_plane()
-
-        # construct particle inv masses
-        ms = np.array(self.particle_mass, dtype=np.float32)
-        # static particles (with zero mass) have zero inverse mass
-        particle_inv_mass = np.divide(1.0, ms, out=np.zeros_like(ms), where=ms != 0.0)
-
-        with wp.ScopedDevice(device):
-            # -------------------------------------
-            # construct Model (non-time varying) data
-
-            m = Model(device)
-            m.requires_grad = requires_grad
-
-            m.ground_plane_params = self._ground_params["plane"]
-
-            m.num_envs = self.num_envs
-
-            # ---------------------
-            # particles
-
-            # state (initial)
-            m.particle_q = wp.array(self.particle_q, dtype=wp.vec3, requires_grad=requires_grad)
-            m.particle_qd = wp.array(self.particle_qd, dtype=wp.vec3, requires_grad=requires_grad)
-            m.particle_mass = wp.array(self.particle_mass, dtype=wp.float32, requires_grad=requires_grad)
-            m.particle_inv_mass = wp.array(particle_inv_mass, dtype=wp.float32, requires_grad=requires_grad)
-            m.particle_radius = wp.array(self.particle_radius, dtype=wp.float32, requires_grad=requires_grad)
-            m.particle_flags = wp.array([flag_to_int(f) for f in self.particle_flags], dtype=wp.uint32)
-            m.particle_max_radius = np.max(self.particle_radius) if len(self.particle_radius) > 0 else 0.0
-            m.particle_max_velocity = self.particle_max_velocity
-
-            particle_colors = np.empty(self.particle_count, dtype=int)
-            for color in range(len(self.particle_color_groups)):
-                particle_colors[self.particle_color_groups[color]] = color
-            m.particle_colors = wp.array(particle_colors, dtype=int)
-            m.particle_color_groups = [wp.array(group, dtype=int) for group in self.particle_color_groups]
-
-            # hash-grid for particle interactions
-            m.particle_grid = wp.HashGrid(128, 128, 128)
-
-            # ---------------------
-            # collision geometry
-
-            m.shape_transform = wp.array(self.shape_transform, dtype=wp.transform, requires_grad=requires_grad)
-            m.shape_body = wp.array(self.shape_body, dtype=wp.int32)
-            m.shape_visible = wp.array(self.shape_visible, dtype=wp.bool)
-            m.body_shapes = self.body_shapes
-
-            # build list of ids for geometry sources (meshes, sdfs)
-            geo_sources = []
-            finalized_meshes = {}  # do not duplicate meshes
-            for geo in self.shape_geo_src:
-                geo_hash = hash(geo)  # avoid repeated hash computations
-                if geo:
-                    if geo_hash not in finalized_meshes:
-                        finalized_meshes[geo_hash] = geo.finalize(device=device)
-                    geo_sources.append(finalized_meshes[geo_hash])
-                else:
-                    # add null pointer
-                    geo_sources.append(0)
-
-            m.shape_geo.type = wp.array(self.shape_geo_type, dtype=wp.int32)
-            m.shape_geo.source = wp.array(geo_sources, dtype=wp.uint64)
-            m.shape_geo.scale = wp.array(self.shape_geo_scale, dtype=wp.vec3, requires_grad=requires_grad)
-            m.shape_geo.is_solid = wp.array(self.shape_geo_is_solid, dtype=wp.uint8)
-            m.shape_geo.thickness = wp.array(self.shape_geo_thickness, dtype=wp.float32, requires_grad=requires_grad)
-            m.shape_geo_src = self.shape_geo_src  # used for rendering
-            # store refs to geometry
-            m.geo_meshes = self.geo_meshes
-            m.geo_sdfs = self.geo_sdfs
-
-            m.shape_materials.ke = wp.array(self.shape_material_ke, dtype=wp.float32, requires_grad=requires_grad)
-            m.shape_materials.kd = wp.array(self.shape_material_kd, dtype=wp.float32, requires_grad=requires_grad)
-            m.shape_materials.kf = wp.array(self.shape_material_kf, dtype=wp.float32, requires_grad=requires_grad)
-            m.shape_materials.ka = wp.array(self.shape_material_ka, dtype=wp.float32, requires_grad=requires_grad)
-            m.shape_materials.mu = wp.array(self.shape_material_mu, dtype=wp.float32, requires_grad=requires_grad)
-            m.shape_materials.restitution = wp.array(
-                self.shape_material_restitution, dtype=wp.float32, requires_grad=requires_grad
-            )
-
-            m.shape_collision_filter_pairs = self.shape_collision_filter_pairs
-            m.shape_collision_group = self.shape_collision_group
-            m.shape_collision_group_map = self.shape_collision_group_map
-            m.shape_collision_radius = wp.array(
-                self.shape_collision_radius, dtype=wp.float32, requires_grad=requires_grad
-            )
-            m.shape_ground_collision = self.shape_ground_collision
-            m.shape_shape_collision = self.shape_shape_collision
-
-            # ---------------------
-            # springs
-
-            m.spring_indices = wp.array(self.spring_indices, dtype=wp.int32)
-            m.spring_rest_length = wp.array(self.spring_rest_length, dtype=wp.float32, requires_grad=requires_grad)
-            m.spring_stiffness = wp.array(self.spring_stiffness, dtype=wp.float32, requires_grad=requires_grad)
-            m.spring_damping = wp.array(self.spring_damping, dtype=wp.float32, requires_grad=requires_grad)
-            m.spring_control = wp.array(self.spring_control, dtype=wp.float32, requires_grad=requires_grad)
-
-            # ---------------------
-            # triangles
-
-            m.tri_indices = wp.array(self.tri_indices, dtype=wp.int32)
-            m.tri_poses = wp.array(self.tri_poses, dtype=wp.mat22, requires_grad=requires_grad)
-            m.tri_activations = wp.array(self.tri_activations, dtype=wp.float32, requires_grad=requires_grad)
-            m.tri_materials = wp.array(self.tri_materials, dtype=wp.float32, requires_grad=requires_grad)
-            m.tri_areas = wp.array(self.tri_areas, dtype=wp.float32, requires_grad=requires_grad)
-
-            # ---------------------
-            # edges
-
-            m.edge_indices = wp.array(self.edge_indices, dtype=wp.int32)
-            m.edge_rest_angle = wp.array(self.edge_rest_angle, dtype=wp.float32, requires_grad=requires_grad)
-            m.edge_rest_length = wp.array(self.edge_rest_length, dtype=wp.float32, requires_grad=requires_grad)
-            m.edge_bending_properties = wp.array(
-                self.edge_bending_properties, dtype=wp.float32, requires_grad=requires_grad
-            )
-
-            # ---------------------
-            # tetrahedra
-
-            m.tet_indices = wp.array(self.tet_indices, dtype=wp.int32)
-            m.tet_poses = wp.array(self.tet_poses, dtype=wp.mat33, requires_grad=requires_grad)
-            m.tet_activations = wp.array(self.tet_activations, dtype=wp.float32, requires_grad=requires_grad)
-            m.tet_materials = wp.array(self.tet_materials, dtype=wp.float32, requires_grad=requires_grad)
-
-            # -----------------------
-            # muscles
-
-            # close the muscle waypoint indices
-            muscle_start = copy.copy(self.muscle_start)
-            muscle_start.append(len(self.muscle_bodies))
-
-            m.muscle_start = wp.array(muscle_start, dtype=wp.int32)
-            m.muscle_params = wp.array(self.muscle_params, dtype=wp.float32, requires_grad=requires_grad)
-            m.muscle_bodies = wp.array(self.muscle_bodies, dtype=wp.int32)
-            m.muscle_points = wp.array(self.muscle_points, dtype=wp.vec3, requires_grad=requires_grad)
-            m.muscle_activations = wp.array(self.muscle_activations, dtype=wp.float32, requires_grad=requires_grad)
-
-            # --------------------------------------
-            # rigid bodies
-
-            m.body_q = wp.array(self.body_q, dtype=wp.transform, requires_grad=requires_grad)
-            m.body_qd = wp.array(self.body_qd, dtype=wp.spatial_vector, requires_grad=requires_grad)
-            m.body_inertia = wp.array(self.body_inertia, dtype=wp.mat33, requires_grad=requires_grad)
-            m.body_inv_inertia = wp.array(self.body_inv_inertia, dtype=wp.mat33, requires_grad=requires_grad)
-            m.body_mass = wp.array(self.body_mass, dtype=wp.float32, requires_grad=requires_grad)
-            m.body_inv_mass = wp.array(self.body_inv_mass, dtype=wp.float32, requires_grad=requires_grad)
-            m.body_com = wp.array(self.body_com, dtype=wp.vec3, requires_grad=requires_grad)
-            m.body_name = self.body_name
-
-            # joints
-            m.joint_type = wp.array(self.joint_type, dtype=wp.int32)
-            m.joint_parent = wp.array(self.joint_parent, dtype=wp.int32)
-            m.joint_child = wp.array(self.joint_child, dtype=wp.int32)
-            m.joint_X_p = wp.array(self.joint_X_p, dtype=wp.transform, requires_grad=requires_grad)
-            m.joint_X_c = wp.array(self.joint_X_c, dtype=wp.transform, requires_grad=requires_grad)
-            m.joint_axis_start = wp.array(self.joint_axis_start, dtype=wp.int32)
-            m.joint_axis_dim = wp.array(np.array(self.joint_axis_dim), dtype=wp.int32, ndim=2)
-            m.joint_axis = wp.array(self.joint_axis, dtype=wp.vec3, requires_grad=requires_grad)
-            m.joint_q = wp.array(self.joint_q, dtype=wp.float32, requires_grad=requires_grad)
-            m.joint_qd = wp.array(self.joint_qd, dtype=wp.float32, requires_grad=requires_grad)
-            m.joint_name = self.joint_name
-            # compute joint ancestors
-            child_to_joint = {}
-            for i, child in enumerate(self.joint_child):
-                child_to_joint[child] = i
-            parent_joint = []
-            for parent in self.joint_parent:
-                parent_joint.append(child_to_joint.get(parent, -1))
-            m.joint_ancestor = wp.array(parent_joint, dtype=wp.int32)
-
-            # dynamics properties
-            m.joint_armature = wp.array(self.joint_armature, dtype=wp.float32, requires_grad=requires_grad)
-            m.joint_target_ke = wp.array(self.joint_target_ke, dtype=wp.float32, requires_grad=requires_grad)
-            m.joint_target_kd = wp.array(self.joint_target_kd, dtype=wp.float32, requires_grad=requires_grad)
-            m.joint_axis_mode = wp.array(self.joint_axis_mode, dtype=wp.int32)
-            m.joint_act = wp.array(self.joint_act, dtype=wp.float32, requires_grad=requires_grad)
-
-            m.joint_limit_lower = wp.array(self.joint_limit_lower, dtype=wp.float32, requires_grad=requires_grad)
-            m.joint_limit_upper = wp.array(self.joint_limit_upper, dtype=wp.float32, requires_grad=requires_grad)
-            m.joint_limit_ke = wp.array(self.joint_limit_ke, dtype=wp.float32, requires_grad=requires_grad)
-            m.joint_limit_kd = wp.array(self.joint_limit_kd, dtype=wp.float32, requires_grad=requires_grad)
-            m.joint_linear_compliance = wp.array(
-                self.joint_linear_compliance, dtype=wp.float32, requires_grad=requires_grad
-            )
-            m.joint_angular_compliance = wp.array(
-                self.joint_angular_compliance, dtype=wp.float32, requires_grad=requires_grad
-            )
-            m.joint_enabled = wp.array(self.joint_enabled, dtype=wp.int32)
-
-            # 'close' the start index arrays with a sentinel value
-            joint_q_start = copy.copy(self.joint_q_start)
-            joint_q_start.append(self.joint_coord_count)
-            joint_qd_start = copy.copy(self.joint_qd_start)
-            joint_qd_start.append(self.joint_dof_count)
-            articulation_start = copy.copy(self.articulation_start)
-            articulation_start.append(self.joint_count)
-
-            m.joint_q_start = wp.array(joint_q_start, dtype=wp.int32)
-            m.joint_qd_start = wp.array(joint_qd_start, dtype=wp.int32)
-            m.articulation_start = wp.array(articulation_start, dtype=wp.int32)
-
-            # counts
-            m.joint_count = self.joint_count
-            m.joint_axis_count = self.joint_axis_count
-            m.joint_dof_count = self.joint_dof_count
-            m.joint_coord_count = self.joint_coord_count
-            m.particle_count = len(self.particle_q)
-            m.body_count = len(self.body_q)
-            m.shape_count = len(self.shape_geo_type)
-            m.tri_count = len(self.tri_poses)
-            m.tet_count = len(self.tet_poses)
-            m.edge_count = len(self.edge_rest_angle)
-            m.spring_count = len(self.spring_rest_length)
-            m.muscle_count = len(self.muscle_start)
-            m.articulation_count = len(self.articulation_start)
-
-            # contacts
-            if m.particle_count:
-                m.allocate_soft_contacts(self.soft_contact_max, requires_grad=requires_grad)
-            m.find_shape_contact_pairs()
-            if self.num_rigid_contacts_per_env is None:
-                contact_count, limited_contact_count = m.count_contact_points()
-            else:
-                contact_count = limited_contact_count = self.num_rigid_contacts_per_env * self.num_envs
-            if contact_count:
-                if wp.config.verbose:
-                    print(f"Allocating {contact_count} rigid contacts.")
-                m.allocate_rigid_contacts(
-                    count=contact_count, limited_contact_count=limited_contact_count, requires_grad=requires_grad
-                )
-            m.rigid_mesh_contact_max = self.rigid_mesh_contact_max
-            m.rigid_contact_margin = self.rigid_contact_margin
-            m.rigid_contact_torsional_friction = self.rigid_contact_torsional_friction
-            m.rigid_contact_rolling_friction = self.rigid_contact_rolling_friction
-
-            # enable ground plane
-            m.ground_plane = wp.array(self._ground_params["plane"], dtype=wp.float32, requires_grad=requires_grad)
-            m.gravity = np.array(self.up_vector, dtype=wp.float32) * self.gravity
-            m.up_axis = self.up_axis
-            m.up_vector = np.array(self.up_vector, dtype=wp.float32)
-
-            m.enable_tri_collisions = False
-
-            return m
diff --git a/warp/sim/particles.py b/warp/sim/particles.py
deleted file mode 100644
index 7515987f..00000000
--- a/warp/sim/particles.py
+++ /dev/null
@@ -1,121 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-import warp as wp
-
-from .model import PARTICLE_FLAG_ACTIVE
-
-
-@wp.func
-def particle_force(n: wp.vec3, v: wp.vec3, c: float, k_n: float, k_d: float, k_f: float, k_mu: float):
-    # compute normal and tangential friction force for a single contact
-    vn = wp.dot(n, v)
-    jn = c * k_n
-    jd = min(vn, 0.0) * k_d
-
-    # contact force
-    fn = jn + jd
-
-    # friction force
-    vt = v - n * vn
-    vs = wp.length(vt)
-
-    if vs > 0.0:
-        vt = vt / vs
-
-    # Coulomb condition
-    ft = wp.min(vs * k_f, k_mu * wp.abs(fn))
-
-    # total force
-    return -n * fn - vt * ft
-
-
-@wp.kernel
-def eval_particle_forces_kernel(
-    grid: wp.uint64,
-    particle_x: wp.array(dtype=wp.vec3),
-    particle_v: wp.array(dtype=wp.vec3),
-    particle_radius: wp.array(dtype=float),
-    particle_flags: wp.array(dtype=wp.uint32),
-    k_contact: float,
-    k_damp: float,
-    k_friction: float,
-    k_mu: float,
-    k_cohesion: float,
-    max_radius: float,
-    # outputs
-    particle_f: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-
-    # order threads by cell
-    i = wp.hash_grid_point_id(grid, tid)
-    if i == -1:
-        # hash grid has not been built yet
-        return
-    if (particle_flags[i] & PARTICLE_FLAG_ACTIVE) == 0:
-        return
-
-    x = particle_x[i]
-    v = particle_v[i]
-    radius = particle_radius[i]
-
-    f = wp.vec3()
-
-    # particle contact
-    query = wp.hash_grid_query(grid, x, radius + max_radius + k_cohesion)
-    index = int(0)
-
-    count = int(0)
-
-    while wp.hash_grid_query_next(query, index):
-        if (particle_flags[index] & PARTICLE_FLAG_ACTIVE) != 0 and index != i:
-            # compute distance to point
-            n = x - particle_x[index]
-            d = wp.length(n)
-            err = d - radius - particle_radius[index]
-
-            count += 1
-
-            if err <= k_cohesion:
-                n = n / d
-                vrel = v - particle_v[index]
-
-                f = f + particle_force(n, vrel, err, k_contact, k_damp, k_friction, k_mu)
-
-    particle_f[i] = f
-
-
-def eval_particle_forces(model, state, forces):
-    if model.particle_count > 1 and model.particle_max_radius > 0.0:
-        wp.launch(
-            kernel=eval_particle_forces_kernel,
-            dim=model.particle_count,
-            inputs=[
-                model.particle_grid.id,
-                state.particle_q,
-                state.particle_qd,
-                model.particle_radius,
-                model.particle_flags,
-                model.particle_ke,
-                model.particle_kd,
-                model.particle_kf,
-                model.particle_mu,
-                model.particle_cohesion,
-                model.particle_max_radius,
-            ],
-            outputs=[forces],
-            device=model.device,
-        )
diff --git a/warp/sim/render.py b/warp/sim/render.py
deleted file mode 100644
index 8d6847c0..00000000
--- a/warp/sim/render.py
+++ /dev/null
@@ -1,431 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-from collections import defaultdict
-
-import numpy as np
-
-import warp as wp
-import warp.render
-import warp.sim
-from warp.render.utils import solidify_mesh, tab10_color_map
-
-# TODO allow NaNs in Warp kernels
-NAN = wp.constant(-1.0e8)
-
-
-@wp.kernel
-def compute_contact_points(
-    body_q: wp.array(dtype=wp.transform),
-    shape_body: wp.array(dtype=int),
-    contact_count: wp.array(dtype=int),
-    contact_shape0: wp.array(dtype=int),
-    contact_shape1: wp.array(dtype=int),
-    contact_point0: wp.array(dtype=wp.vec3),
-    contact_point1: wp.array(dtype=wp.vec3),
-    # outputs
-    contact_pos0: wp.array(dtype=wp.vec3),
-    contact_pos1: wp.array(dtype=wp.vec3),
-):
-    tid = wp.tid()
-    count = contact_count[0]
-    if tid >= count:
-        contact_pos0[tid] = wp.vec3(NAN, NAN, NAN)
-        contact_pos1[tid] = wp.vec3(NAN, NAN, NAN)
-        return
-    shape_a = contact_shape0[tid]
-    shape_b = contact_shape1[tid]
-    if shape_a == shape_b:
-        contact_pos0[tid] = wp.vec3(NAN, NAN, NAN)
-        contact_pos1[tid] = wp.vec3(NAN, NAN, NAN)
-        return
-
-    body_a = shape_body[shape_a]
-    body_b = shape_body[shape_b]
-    X_wb_a = wp.transform_identity()
-    X_wb_b = wp.transform_identity()
-    if body_a >= 0:
-        X_wb_a = body_q[body_a]
-    if body_b >= 0:
-        X_wb_b = body_q[body_b]
-
-    contact_pos0[tid] = wp.transform_point(X_wb_a, contact_point0[tid])
-    contact_pos1[tid] = wp.transform_point(X_wb_b, contact_point1[tid])
-
-
-def CreateSimRenderer(renderer):
-    class SimRenderer(renderer):
-        use_unique_colors = True
-
-        def __init__(
-            self,
-            model: warp.sim.Model,
-            path,
-            scaling=1.0,
-            fps=60,
-            up_axis=None,
-            show_rigid_contact_points=False,
-            contact_points_radius=1e-3,
-            show_joints=False,
-            **render_kwargs,
-        ):
-            # create USD stage
-            if up_axis is None:
-                up_axis = "XYZ"[model.up_axis]
-            super().__init__(path, scaling=scaling, fps=fps, up_axis=up_axis, **render_kwargs)
-            self.scaling = scaling
-            self.cam_axis = "XYZ".index(up_axis.upper())
-            self.show_rigid_contact_points = show_rigid_contact_points
-            self.show_joints = show_joints
-            self.contact_points_radius = contact_points_radius
-            self.populate(model)
-
-        def populate(self, model: warp.sim.Model):
-            self.skip_rendering = False
-
-            self.model = model
-            self.num_envs = model.num_envs
-            self.body_names = []
-
-            if self.show_rigid_contact_points and model.rigid_contact_max:
-                self.contact_points0 = wp.array(
-                    np.zeros((model.rigid_contact_max, 3)), dtype=wp.vec3, device=model.device
-                )
-                self.contact_points1 = wp.array(
-                    np.zeros((model.rigid_contact_max, 3)), dtype=wp.vec3, device=model.device
-                )
-
-                self.contact_points0_colors = [(1.0, 0.5, 0.0)] * model.rigid_contact_max
-                self.contact_points1_colors = [(0.0, 0.5, 1.0)] * model.rigid_contact_max
-
-            self.body_env = []  # mapping from body index to its environment index
-            env_id = 0
-            self.bodies_per_env = model.body_count // self.num_envs
-            # create rigid body nodes
-            for b in range(model.body_count):
-                body_name = f"body_{b}_{self.model.body_name[b].replace(' ', '_')}"
-                self.body_names.append(body_name)
-                self.register_body(body_name)
-                if b > 0 and b % self.bodies_per_env == 0:
-                    env_id += 1
-                self.body_env.append(env_id)
-
-            # create rigid shape children
-            if self.model.shape_count:
-                # mapping from hash of geometry to shape ID
-                self.geo_shape = {}
-
-                self.instance_count = 0
-
-                self.body_name = {}  # mapping from body name to its body ID
-                self.body_shapes = defaultdict(list)  # mapping from body index to its shape IDs
-
-                shape_body = model.shape_body.numpy()
-                shape_geo_src = model.shape_geo_src
-                shape_geo_type = model.shape_geo.type.numpy()
-                shape_geo_scale = model.shape_geo.scale.numpy()
-                shape_geo_thickness = model.shape_geo.thickness.numpy()
-                shape_geo_is_solid = model.shape_geo.is_solid.numpy()
-                shape_transform = model.shape_transform.numpy()
-                shape_visible = model.shape_visible.numpy()
-
-                p = np.zeros(3, dtype=np.float32)
-                q = np.array([0.0, 0.0, 0.0, 1.0], dtype=np.float32)
-                scale = np.ones(3)
-                color = (1.0, 1.0, 1.0)
-                # loop over shapes excluding the ground plane
-                for s in range(model.shape_count - 1):
-                    geo_type = shape_geo_type[s]
-                    geo_scale = [float(v) for v in shape_geo_scale[s]]
-                    geo_thickness = float(shape_geo_thickness[s])
-                    geo_is_solid = bool(shape_geo_is_solid[s])
-                    geo_src = shape_geo_src[s]
-                    name = f"shape_{s}"
-
-                    # shape transform in body frame
-                    body = int(shape_body[s])
-                    if body >= 0 and body < len(self.body_names):
-                        body = self.body_names[body]
-                    else:
-                        body = None
-
-                    if self.use_unique_colors and body is not None:
-                        color = self._get_new_color()
-
-                    # shape transform in body frame
-                    X_bs = wp.transform_expand(shape_transform[s])
-                    # check whether we can instance an already created shape with the same geometry
-                    geo_hash = hash((int(geo_type), geo_src, *geo_scale, geo_thickness, geo_is_solid))
-                    if geo_hash in self.geo_shape:
-                        shape = self.geo_shape[geo_hash]
-                    else:
-                        if geo_type == warp.sim.GEO_PLANE:
-                            if s == model.shape_count - 1 and not model.ground:
-                                continue  # hide ground plane
-
-                            # plane mesh
-                            width = geo_scale[0] if geo_scale[0] > 0.0 else 100.0
-                            length = geo_scale[1] if geo_scale[1] > 0.0 else 100.0
-
-                            shape = self.render_plane(
-                                name, p, q, width, length, color, parent_body=body, is_template=True
-                            )
-
-                        elif geo_type == warp.sim.GEO_SPHERE:
-                            shape = self.render_sphere(
-                                name, p, q, geo_scale[0], parent_body=body, is_template=True, color=color
-                            )
-
-                        elif geo_type == warp.sim.GEO_CAPSULE:
-                            shape = self.render_capsule(
-                                name, p, q, geo_scale[0], geo_scale[1], parent_body=body, is_template=True, color=color
-                            )
-
-                        elif geo_type == warp.sim.GEO_CYLINDER:
-                            shape = self.render_cylinder(
-                                name, p, q, geo_scale[0], geo_scale[1], parent_body=body, is_template=True, color=color
-                            )
-
-                        elif geo_type == warp.sim.GEO_CONE:
-                            shape = self.render_cone(
-                                name, p, q, geo_scale[0], geo_scale[1], parent_body=body, is_template=True, color=color
-                            )
-
-                        elif geo_type == warp.sim.GEO_BOX:
-                            shape = self.render_box(
-                                name, p, q, geo_scale, parent_body=body, is_template=True, color=color
-                            )
-
-                        elif geo_type == warp.sim.GEO_MESH:
-                            if not geo_is_solid:
-                                faces, vertices = solidify_mesh(geo_src.indices, geo_src.vertices, geo_thickness)
-                            else:
-                                faces, vertices = geo_src.indices, geo_src.vertices
-
-                            shape = self.render_mesh(
-                                name,
-                                vertices,
-                                faces,
-                                pos=p,
-                                rot=q,
-                                scale=geo_scale,
-                                colors=color,
-                                parent_body=body,
-                                is_template=True,
-                            )
-
-                        elif geo_type == warp.sim.GEO_SDF:
-                            continue
-
-                        self.geo_shape[geo_hash] = shape
-
-                    if shape_visible[s]:
-                        # TODO support dynamic visibility
-                        self.add_shape_instance(
-                            name, shape, body, X_bs.p, X_bs.q, scale, custom_index=s, visible=shape_visible[s]
-                        )
-                    self.instance_count += 1
-
-                if self.show_joints and model.joint_count:
-                    joint_type = model.joint_type.numpy()
-                    joint_axis = model.joint_axis.numpy()
-                    joint_axis_start = model.joint_axis_start.numpy()
-                    joint_axis_dim = model.joint_axis_dim.numpy()
-                    joint_parent = model.joint_parent.numpy()
-                    joint_child = model.joint_child.numpy()
-                    joint_tf = model.joint_X_p.numpy()
-                    shape_collision_radius = model.shape_collision_radius.numpy()
-                    y_axis = wp.vec3(0.0, 1.0, 0.0)
-                    color = (1.0, 0.0, 1.0)
-
-                    shape = self.render_arrow(
-                        "joint_arrow",
-                        None,
-                        None,
-                        base_radius=0.01,
-                        base_height=0.4,
-                        cap_radius=0.02,
-                        cap_height=0.1,
-                        parent_body=None,
-                        is_template=True,
-                        color=color,
-                    )
-                    for i, t in enumerate(joint_type):
-                        if t not in {
-                            warp.sim.JOINT_REVOLUTE,
-                            # warp.sim.JOINT_PRISMATIC,
-                            warp.sim.JOINT_UNIVERSAL,
-                            warp.sim.JOINT_COMPOUND,
-                            warp.sim.JOINT_D6,
-                        }:
-                            continue
-                        tf = joint_tf[i]
-                        body = int(joint_parent[i])
-                        if body >= 0 and body < len(self.body_names):
-                            body = self.body_names[body]
-                        else:
-                            body = None
-                        # if body == -1:
-                        #     continue
-                        num_linear_axes = int(joint_axis_dim[i][0])
-                        num_angular_axes = int(joint_axis_dim[i][1])
-
-                        # find a good scale for the arrow based on the average radius
-                        # of the shapes attached to the joint child body
-                        scale = np.ones(3)
-                        child = int(joint_child[i])
-                        if child >= 0:
-                            radii = []
-                            for s in model.body_shapes[child]:
-                                radii.append(shape_collision_radius[s])
-                            if len(radii) > 0:
-                                scale *= np.mean(radii) * 2.0
-
-                        for a in range(num_linear_axes, num_linear_axes + num_angular_axes):
-                            index = joint_axis_start[i] + a
-                            axis = joint_axis[index]
-                            if np.linalg.norm(axis) < 1e-6:
-                                continue
-                            p = wp.vec3(tf[:3])
-                            q = wp.quat(tf[3:])
-                            # compute rotation between axis and y
-                            axis = axis / np.linalg.norm(axis)
-                            q = q * wp.quat_between_vectors(wp.vec3(axis), y_axis)
-                            name = f"joint_{i}_{a}"
-                            self.add_shape_instance(name, shape, body, p, q, scale, color1=color, color2=color)
-                            self.instance_count += 1
-
-            if model.ground:
-                self.render_ground(plane=model.ground_plane_params)
-
-            if hasattr(self, "complete_setup"):
-                self.complete_setup()
-
-        def _get_new_color(self):
-            return tab10_color_map(self.instance_count)
-
-        def render(self, state: warp.sim.State):
-            """
-            Updates the renderer with the given simulation state.
-
-            Args:
-                state (warp.sim.State): The simulation state to render.
-            """
-            if self.skip_rendering:
-                return
-
-            if self.model.particle_count:
-                particle_q = state.particle_q.numpy()
-
-                # render particles
-                self.render_points(
-                    "particles", particle_q, radius=self.model.particle_radius.numpy(), colors=(0.8, 0.3, 0.2)
-                )
-
-                # render tris
-                if self.model.tri_count:
-                    self.render_mesh(
-                        "surface",
-                        particle_q,
-                        self.model.tri_indices.numpy().flatten(),
-                        colors=(0.75, 0.25, 0.0),
-                    )
-
-                # render springs
-                if self.model.spring_count:
-                    self.render_line_list(
-                        "springs", particle_q, self.model.spring_indices.numpy().flatten(), (0.25, 0.5, 0.25), 0.02
-                    )
-
-            # render muscles
-            if self.model.muscle_count:
-                body_q = state.body_q.numpy()
-
-                muscle_start = self.model.muscle_start.numpy()
-                muscle_links = self.model.muscle_bodies.numpy()
-                muscle_points = self.model.muscle_points.numpy()
-                muscle_activation = self.model.muscle_activation.numpy()
-
-                # for s in self.skeletons:
-
-                #     # for mesh, link in s.mesh_map.items():
-
-                #     #     if link != -1:
-                #     #         X_sc = wp.transform_expand(self.state.body_X_sc[link].tolist())
-
-                #     #         #self.renderer.add_mesh(mesh, "../assets/snu/OBJ/" + mesh + ".usd", X_sc, 1.0, self.render_time)
-                #     #         self.renderer.add_mesh(mesh, "../assets/snu/OBJ/" + mesh + ".usd", X_sc, 1.0, self.render_time)
-
-                for m in range(self.model.muscle_count):
-                    start = int(muscle_start[m])
-                    end = int(muscle_start[m + 1])
-
-                    points = []
-
-                    for w in range(start, end):
-                        link = muscle_links[w]
-                        point = muscle_points[w]
-
-                        X_sc = wp.transform_expand(body_q[link][0])
-
-                        points.append(wp.transform_point(X_sc, point).tolist())
-
-                    self.render_line_strip(
-                        name=f"muscle_{m}", vertices=points, radius=0.0075, color=(muscle_activation[m], 0.2, 0.5)
-                    )
-
-            # update bodies
-            if self.model.body_count:
-                self.update_body_transforms(state.body_q)
-
-                if self.show_rigid_contact_points and self.model.rigid_contact_max:
-                    wp.launch(
-                        kernel=compute_contact_points,
-                        dim=self.model.rigid_contact_max,
-                        inputs=[
-                            state.body_q,
-                            self.model.shape_body,
-                            self.model.rigid_contact_count,
-                            self.model.rigid_contact_shape0,
-                            self.model.rigid_contact_shape1,
-                            self.model.rigid_contact_point0,
-                            self.model.rigid_contact_point1,
-                        ],
-                        outputs=[
-                            self.contact_points0,
-                            self.contact_points1,
-                        ],
-                        device=self.model.device,
-                    )
-
-                    self.render_points(
-                        "contact_points0",
-                        self.contact_points0.numpy(),
-                        radius=self.contact_points_radius * self.scaling,
-                        colors=self.contact_points0_colors,
-                    )
-                    self.render_points(
-                        "contact_points1",
-                        self.contact_points1.numpy(),
-                        radius=self.contact_points_radius * self.scaling,
-                        colors=self.contact_points1_colors,
-                    )
-
-    return SimRenderer
-
-
-SimRendererUsd = CreateSimRenderer(wp.render.UsdRenderer)
-SimRendererOpenGL = CreateSimRenderer(wp.render.OpenGLRenderer)
-SimRenderer = SimRendererUsd
diff --git a/warp/sim/utils.py b/warp/sim/utils.py
deleted file mode 100644
index f3b09afd..00000000
--- a/warp/sim/utils.py
+++ /dev/null
@@ -1,431 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-from __future__ import annotations
-
-import numpy as np
-
-import warp as wp
-
-
-@wp.func
-def velocity_at_point(qd: wp.spatial_vector, r: wp.vec3):
-    """
-    Returns the velocity of a point relative to the frame with the given spatial velocity.
-
-    Args:
-        qd (spatial_vector): The spatial velocity of the frame.
-        r (vec3): The position of the point relative to the frame.
-
-    Returns:
-        vec3: The velocity of the point.
-    """
-    return wp.cross(wp.spatial_top(qd), r) + wp.spatial_bottom(qd)
-
-
-@wp.func
-def quat_twist(axis: wp.vec3, q: wp.quat):
-    """
-    Returns the twist around an axis.
-    """
-
-    # project imaginary part onto axis
-    a = wp.vec3(q[0], q[1], q[2])
-    proj = wp.dot(a, axis)
-    a = proj * axis
-    # if proj < 0.0:
-    #     # ensure twist points in same direction as axis
-    #     a = -a
-    return wp.normalize(wp.quat(a[0], a[1], a[2], q[3]))
-
-
-@wp.func
-def quat_twist_angle(axis: wp.vec3, q: wp.quat):
-    """
-    Returns the angle of the twist around an axis.
-    """
-    return 2.0 * wp.acos(quat_twist(axis, q)[3])
-
-
-@wp.func
-def quat_decompose(q: wp.quat):
-    """
-    Decompose a quaternion into a sequence of 3 rotations around x,y',z' respectively, i.e.: q = q_z''q_y'q_x.
-    """
-
-    R = wp.matrix_from_cols(
-        wp.quat_rotate(q, wp.vec3(1.0, 0.0, 0.0)),
-        wp.quat_rotate(q, wp.vec3(0.0, 1.0, 0.0)),
-        wp.quat_rotate(q, wp.vec3(0.0, 0.0, 1.0)),
-    )
-
-    # https://www.sedris.org/wg8home/Documents/WG80485.pdf
-    phi = wp.atan2(R[1, 2], R[2, 2])
-    sinp = -R[0, 2]
-    if wp.abs(sinp) >= 1.0:
-        theta = wp.HALF_PI * wp.sign(sinp)
-    else:
-        theta = wp.asin(-R[0, 2])
-    psi = wp.atan2(R[0, 1], R[0, 0])
-
-    return -wp.vec3(phi, theta, psi)
-
-
-@wp.func
-def quat_to_rpy(q: wp.quat):
-    """
-    Convert a quaternion into Euler angles (roll, pitch, yaw)
-    roll is rotation around x in radians (counterclockwise)
-    pitch is rotation around y in radians (counterclockwise)
-    yaw is rotation around z in radians (counterclockwise)
-    """
-    x = q[0]
-    y = q[1]
-    z = q[2]
-    w = q[3]
-    t0 = 2.0 * (w * x + y * z)
-    t1 = 1.0 - 2.0 * (x * x + y * y)
-    roll_x = wp.atan2(t0, t1)
-
-    t2 = 2.0 * (w * y - z * x)
-    t2 = wp.clamp(t2, -1.0, 1.0)
-    pitch_y = wp.asin(t2)
-
-    t3 = 2.0 * (w * z + x * y)
-    t4 = 1.0 - 2.0 * (y * y + z * z)
-    yaw_z = wp.atan2(t3, t4)
-
-    return wp.vec3(roll_x, pitch_y, yaw_z)
-
-
-@wp.func
-def quat_to_euler(q: wp.quat, i: int, j: int, k: int) -> wp.vec3:
-    """
-    Convert a quaternion into Euler angles.
-
-    :math:`i, j, k` are the indices in :math:`[0, 1, 2]` of the axes to use
-    (:math:`i \\neq j, j \\neq k`).
-
-    Reference: https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0276302
-
-    Args:
-        q (quat): The quaternion to convert
-        i (int): The index of the first axis
-        j (int): The index of the second axis
-        k (int): The index of the third axis
-
-    Returns:
-        vec3: The Euler angles (in radians)
-    """
-    # i, j, k are actually assumed to follow 1-based indexing but
-    # we want to be compatible with quat_from_euler
-    i += 1
-    j += 1
-    k += 1
-    not_proper = True
-    if i == k:
-        not_proper = False
-        k = 6 - i - j  # because i + j + k = 1 + 2 + 3 = 6
-    e = float((i - j) * (j - k) * (k - i)) / 2.0  # Levi-Civita symbol
-    a = q[0]
-    b = q[i]
-    c = q[j]
-    d = q[k] * e
-    if not_proper:
-        a -= q[j]
-        b += q[k] * e
-        c += q[0]
-        d -= q[i]
-    t2 = wp.acos(2.0 * (a * a + b * b) / (a * a + b * b + c * c + d * d) - 1.0)
-    tp = wp.atan2(b, a)
-    tm = wp.atan2(d, c)
-    t1 = 0.0
-    t3 = 0.0
-    if wp.abs(t2) < 1e-6:
-        t3 = 2.0 * tp - t1
-    elif wp.abs(t2 - wp.HALF_PI) < 1e-6:
-        t3 = 2.0 * tm + t1
-    else:
-        t1 = tp - tm
-        t3 = tp + tm
-    if not_proper:
-        t2 -= wp.HALF_PI
-        t3 *= e
-    return wp.vec3(t1, t2, t3)
-
-
-@wp.func
-def quat_from_euler(e: wp.vec3, i: int, j: int, k: int) -> wp.quat:
-    """
-    Convert Euler angles to a quaternion.
-
-    :math:`i, j, k` are the indices in :math:`[0, 1, 2]` of the axes in which the Euler angles are provided
-    (:math:`i \\neq j, j \\neq k`), e.g. (0, 1, 2) for Euler sequence XYZ.
-
-    Args:
-        e (vec3): The Euler angles (in radians)
-        i (int): The index of the first axis
-        j (int): The index of the second axis
-        k (int): The index of the third axis
-
-    Returns:
-        quat: The quaternion
-    """
-    # Half angles
-    half_e = e / 2.0
-
-    # Precompute sines and cosines of half angles
-    cr = wp.cos(half_e[i])
-    sr = wp.sin(half_e[i])
-    cp = wp.cos(half_e[j])
-    sp = wp.sin(half_e[j])
-    cy = wp.cos(half_e[k])
-    sy = wp.sin(half_e[k])
-
-    # Components of the quaternion based on the rotation sequence
-    return wp.quat(
-        (cy * sr * cp - sy * cr * sp),
-        (cy * cr * sp + sy * sr * cp),
-        (sy * cr * cp - cy * sr * sp),
-        (cy * cr * cp + sy * sr * sp),
-    )
-
-
-@wp.func
-def transform_twist(t: wp.transform, x: wp.spatial_vector):
-    # Frank & Park definition 3.20, pg 100
-
-    q = wp.transform_get_rotation(t)
-    p = wp.transform_get_translation(t)
-
-    w = wp.spatial_top(x)
-    v = wp.spatial_bottom(x)
-
-    w = wp.quat_rotate(q, w)
-    v = wp.quat_rotate(q, v) + wp.cross(p, w)
-
-    return wp.spatial_vector(w, v)
-
-
-@wp.func
-def transform_wrench(t: wp.transform, x: wp.spatial_vector):
-    q = wp.transform_get_rotation(t)
-    p = wp.transform_get_translation(t)
-
-    w = wp.spatial_top(x)
-    v = wp.spatial_bottom(x)
-
-    v = wp.quat_rotate(q, v)
-    w = wp.quat_rotate(q, w) + wp.cross(p, v)
-
-    return wp.spatial_vector(w, v)
-
-
-@wp.func
-def transform_inertia(t: wp.transform, I: wp.spatial_matrix):
-    """
-    Computes adj_t^-T*I*adj_t^-1 (tensor change of coordinates).
-    (Frank & Park, section 8.2.3, pg 290)
-    """
-
-    t_inv = wp.transform_inverse(t)
-
-    q = wp.transform_get_rotation(t_inv)
-    p = wp.transform_get_translation(t_inv)
-
-    r1 = wp.quat_rotate(q, wp.vec3(1.0, 0.0, 0.0))
-    r2 = wp.quat_rotate(q, wp.vec3(0.0, 1.0, 0.0))
-    r3 = wp.quat_rotate(q, wp.vec3(0.0, 0.0, 1.0))
-
-    R = wp.matrix_from_cols(r1, r2, r3)
-    S = wp.mul(wp.skew(p), R)
-
-    T = wp.spatial_adjoint(R, S)
-
-    return wp.mul(wp.mul(wp.transpose(T), I), T)
-
-
-@wp.func
-def boltzmann(a: float, b: float, alpha: float):
-    e1 = wp.exp(alpha * a)
-    e2 = wp.exp(alpha * b)
-    return (a * e1 + b * e2) / (e1 + e2)
-
-
-@wp.func
-def smooth_max(a: float, b: float, eps: float):
-    d = a - b
-    return 0.5 * (a + b + wp.sqrt(d * d + eps))
-
-
-@wp.func
-def smooth_min(a: float, b: float, eps: float):
-    d = a - b
-    return 0.5 * (a + b - wp.sqrt(d * d + eps))
-
-
-@wp.func
-def leaky_max(a: float, b: float):
-    return smooth_max(a, b, 1e-5)
-
-
-@wp.func
-def leaky_min(a: float, b: float):
-    return smooth_min(a, b, 1e-5)
-
-
-@wp.func
-def vec_min(a: wp.vec3, b: wp.vec3):
-    return wp.vec3(wp.min(a[0], b[0]), wp.min(a[1], b[1]), wp.min(a[2], b[2]))
-
-
-@wp.func
-def vec_max(a: wp.vec3, b: wp.vec3):
-    return wp.vec3(wp.max(a[0], b[0]), wp.max(a[1], b[1]), wp.max(a[2], b[2]))
-
-
-@wp.func
-def vec_leaky_min(a: wp.vec3, b: wp.vec3):
-    return wp.vec3(leaky_min(a[0], b[0]), leaky_min(a[1], b[1]), leaky_min(a[2], b[2]))
-
-
-@wp.func
-def vec_leaky_max(a: wp.vec3, b: wp.vec3):
-    return wp.vec3(leaky_max(a[0], b[0]), leaky_max(a[1], b[1]), leaky_max(a[2], b[2]))
-
-
-@wp.func
-def vec_abs(a: wp.vec3):
-    return wp.vec3(wp.abs(a[0]), wp.abs(a[1]), wp.abs(a[2]))
-
-
-def load_mesh(filename: str, method: str | None = None):
-    """Load a 3D triangular surface mesh from a file.
-
-    Args:
-        filename (str): The path to the 3D model file (obj, and other formats
-          supported by the different methods) to load.
-        method (str): The method to use for loading the mesh (default ``None``).
-          Can be either ``"trimesh"``, ``"meshio"``, ``"pcu"``, or ``"openmesh"``.
-          If ``None``, every method is tried and the first successful mesh import
-          where the number of vertices is greater than 0 is returned.
-
-    Returns:
-        Tuple of (mesh_points, mesh_indices), where mesh_points is a Nx3 numpy array of vertex positions (float32),
-        and mesh_indices is a Mx3 numpy array of vertex indices (int32) for the triangular faces.
-    """
-    import os
-
-    if not os.path.exists(filename):
-        raise FileNotFoundError(f"File not found: {filename}")
-
-    def load_mesh_with_method(method):
-        if method == "meshio":
-            import meshio
-
-            m = meshio.read(filename)
-            mesh_points = np.array(m.points)
-            mesh_indices = np.array(m.cells[0].data, dtype=np.int32)
-        elif method == "openmesh":
-            import openmesh
-
-            m = openmesh.read_trimesh(filename)
-            mesh_points = np.array(m.points())
-            mesh_indices = np.array(m.face_vertex_indices(), dtype=np.int32)
-        elif method == "pcu":
-            import point_cloud_utils as pcu
-
-            mesh_points, mesh_indices = pcu.load_mesh_vf(filename)
-            mesh_indices = mesh_indices.flatten()
-        else:
-            import trimesh
-
-            m = trimesh.load(filename)
-            if hasattr(m, "geometry"):
-                # multiple meshes are contained in a scene; combine to one mesh
-                mesh_points = []
-                mesh_indices = []
-                index_offset = 0
-                for geom in m.geometry.values():
-                    vertices = np.array(geom.vertices, dtype=np.float32)
-                    faces = np.array(geom.faces.flatten(), dtype=np.int32)
-                    mesh_points.append(vertices)
-                    mesh_indices.append(faces + index_offset)
-                    index_offset += len(vertices)
-                mesh_points = np.concatenate(mesh_points, axis=0)
-                mesh_indices = np.concatenate(mesh_indices)
-            else:
-                # a single mesh
-                mesh_points = np.array(m.vertices, dtype=np.float32)
-                mesh_indices = np.array(m.faces.flatten(), dtype=np.int32)
-        return mesh_points, mesh_indices
-
-    if method is None:
-        methods = ["trimesh", "meshio", "pcu", "openmesh"]
-        for method in methods:
-            try:
-                mesh = load_mesh_with_method(method)
-                if mesh is not None and len(mesh[0]) > 0:
-                    return mesh
-            except Exception:
-                pass
-        raise ValueError(f"Failed to load mesh using any of the methods: {methods}")
-    else:
-        mesh = load_mesh_with_method(method)
-        if mesh is None or len(mesh[0]) == 0:
-            raise ValueError(f"Failed to load mesh using method {method}")
-        return mesh
-
-
-def visualize_meshes(
-    meshes: list[tuple[list, list]], num_cols=0, num_rows=0, titles=None, scale_axes=True, show_plot=True
-):
-    # render meshes in a grid with matplotlib
-    import matplotlib.pyplot as plt
-
-    if titles is None:
-        titles = []
-
-    num_cols = min(num_cols, len(meshes))
-    num_rows = min(num_rows, len(meshes))
-    if num_cols and not num_rows:
-        num_rows = int(np.ceil(len(meshes) / num_cols))
-    elif num_rows and not num_cols:
-        num_cols = int(np.ceil(len(meshes) / num_rows))
-    else:
-        num_cols = len(meshes)
-        num_rows = 1
-
-    vertices = [np.array(v).reshape((-1, 3)) for v, _ in meshes]
-    faces = [np.array(f, dtype=np.int32).reshape((-1, 3)) for _, f in meshes]
-    if scale_axes:
-        ranges = np.array([v.max(axis=0) - v.min(axis=0) for v in vertices])
-        max_range = ranges.max()
-        mid_points = np.array([v.max(axis=0) + v.min(axis=0) for v in vertices]) * 0.5
-
-    fig = plt.figure(figsize=(12, 6))
-    for i, (vertices, faces) in enumerate(meshes):
-        ax = fig.add_subplot(num_rows, num_cols, i + 1, projection="3d")
-        if i < len(titles):
-            ax.set_title(titles[i])
-        ax.plot_trisurf(vertices[:, 0], vertices[:, 1], vertices[:, 2], triangles=faces, edgecolor="k")
-        if scale_axes:
-            mid = mid_points[i]
-            ax.set_xlim(mid[0] - max_range, mid[0] + max_range)
-            ax.set_ylim(mid[1] - max_range, mid[1] + max_range)
-            ax.set_zlim(mid[2] - max_range, mid[2] + max_range)
-    if show_plot:
-        plt.show()
-    return fig
diff --git a/warp/sparse.py b/warp/sparse.py
index e0983b1a..51ae3a2c 100644
--- a/warp/sparse.py
+++ b/warp/sparse.py
@@ -13,8 +13,11 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
+from __future__ import annotations
+
 import ctypes
-from typing import Any, Generic, Optional, Tuple, TypeVar, Union
+import weakref
+from typing import Any, Generic, TypeVar, Union
 
 import warp as wp
 import warp.types
@@ -40,6 +43,7 @@ __all__ = [
     "BsrMatrix",
     "bsr_assign",
     "bsr_axpy",
+    "bsr_block_index",
     "bsr_copy",
     "bsr_diag",
     "bsr_from_triplets",
@@ -49,6 +53,7 @@ __all__ = [
     "bsr_mm",
     "bsr_mm_work_arrays",
     "bsr_mv",
+    "bsr_row_index",
     "bsr_scale",
     "bsr_set_diag",
     "bsr_set_from_triplets",
@@ -105,7 +110,7 @@ class BsrMatrix(Generic[_BlockType]):
         return type_scalar_type(self.values.dtype)
 
     @property
-    def block_shape(self) -> Tuple[int, int]:
+    def block_shape(self) -> tuple[int, int]:
         """Shape of the individual blocks."""
         return getattr(self.values.dtype, "_shape_", (1, 1))
 
@@ -115,7 +120,7 @@ class BsrMatrix(Generic[_BlockType]):
         return type_size(self.values.dtype)
 
     @property
-    def shape(self) -> Tuple[int, int]:
+    def shape(self) -> tuple[int, int]:
         """Shape of the matrix, i.e. number of rows/columns of blocks times number of rows/columns per block."""
         block_shape = self.block_shape
         return (self.nrow * block_shape[0], self.ncol * block_shape[1])
@@ -155,58 +160,80 @@ class BsrMatrix(Generic[_BlockType]):
         )
         return out
 
-    def nnz_sync(self):
-        """Ensures that any ongoing transfer of the exact nnz number from the device offsets array to the host has completed,
+    def nnz_sync(self) -> int:
+        """
+        Synchronize the number of non-zeros from the device offsets array to the host.
+
+        Ensures that any ongoing transfer of the exact nnz number from the device offsets array to the host has completed,
         or, if none has been scheduled yet, starts a new transfer and waits for it to complete.
-        Then updates the nnz upper bound.
 
-        See also :meth:`copy_nnz_async`.
+        Then updates the host-side nnz upper bound to match the exact one, and returns it.
+
+        See also :meth:`notify_nnz_async`.
         """
 
         buf, event = self._nnz_transfer_if_any()
         if buf is None:
-            self.copy_nnz_async()
-            buf, event = self._nnz_transfer_if_any()
+            buf, event = self._copy_nnz_async()
 
         if event is not None:
             wp.synchronize_event(event)
         self.nnz = int(buf.numpy()[0])
         return self.nnz
 
-    def copy_nnz_async(self) -> None:
+    def notify_nnz_changed(self, nnz: int | None = None) -> None:
+        """Notify the matrix that the number of non-zeros has been changed from outside of the ``warp.sparse`` builtin functions.
+
+        Should be called in particular when the offsets array has been modified, or when the nnz upper bound has changed.
+        Makes sure that the matrix is properly resized and starts the asynchronous transfer of the actual non-zero count.
+
+        Args:
+            nnz: The new upper-bound for the number of non-zeros. If not provided, it will be read from the device offsets array (requires a synchronization).
         """
-        Start the asynchronous transfer of the exact nnz from the device offsets array to host and records an event for completion.
 
-        Needs to be called whenever the offsets array has been modified from outside ``warp.sparse``.
+        if nnz is None:
+            self.nnz_sync()
+        else:
+            self._copy_nnz_async()
 
-        See also :meth:`nnz_sync`.
+        _bsr_ensure_fits(self, nnz=nnz)
+
+    def copy_nnz_async(self) -> None:
         """
+        Starts the asynchronous transfer of the exact nnz from the device offsets array to host and records an event for completion.
 
+        Deprecated; prefer :meth:`notify_nnz_changed` instead, which will make sure to resize arrays if necessary.
+        """
+        wp.utils.warn(
+            "The `copy_nnz_async` method is deprecated and will be removed in a future version. Prefer `notify_nnz_changed` instead.",
+            DeprecationWarning,
+        )
+        self._copy_nnz_async()
+
+    def _copy_nnz_async(self) -> tuple[wp.array, wp.Event]:
         buf, event = self._setup_nnz_transfer()
-        stream = wp.get_stream(self.device) if self.device.is_cuda else None
-        wp.copy(src=self.offsets, dest=buf, src_offset=self.nrow, count=1, stream=stream)
-        if event is not None:
-            stream.record_event(event)
+        if buf is not None:
+            stream = wp.get_stream(self.device) if self.device.is_cuda else None
+            wp.copy(src=self.offsets, dest=buf, src_offset=self.nrow, count=1, stream=stream)
+            if event is not None:
+                stream.record_event(event, external=True)
+        return buf, event
 
-    def _setup_nnz_transfer(self):
+    def _setup_nnz_transfer(self) -> tuple[wp.array, wp.Event]:
         buf, event = self._nnz_transfer_if_any()
         if buf is not None:
             return buf, event
 
         buf, event = _allocate_transfer_buf(self.device)
-        if buf is not None:
-            BsrMatrix.__setattr__(self, "_nnz_transfer", (buf, event))
+        BsrMatrix.__setattr__(self, "_nnz_transfer", (buf, event))
+
+        weakref.finalize(self, _redeem_transfer_buf, self.device, buf, event)
 
         return buf, event
 
-    def _nnz_transfer_if_any(self):
+    def _nnz_transfer_if_any(self) -> tuple[wp.array, wp.Event]:
         return getattr(self, "_nnz_transfer", (None, None))
 
-    def __del__(self):
-        buf, event = self._nnz_transfer_if_any()
-        if buf is not None:
-            _redeem_transfer_buf(self.device, buf, event)
-
     # Overloaded math operators
     def __add__(self, y):
         return bsr_axpy(y, bsr_copy(self))
@@ -314,6 +341,7 @@ def bsr_matrix_t(dtype: BlockType):
     key = f"{BsrMatrix.__qualname__}_{type_str}"
 
     if key not in _struct_cache:
+        BsrMatrixTyped.dtype = dtype  # necessary for eval_annotations
         _struct_cache[key] = wp.codegen.Struct(
             key=key,
             cls=BsrMatrixTyped,
@@ -353,17 +381,23 @@ def bsr_zeros(
     return bsr
 
 
-def _bsr_ensure_fits(bsr: BsrMatrix, nrow: Optional[int] = None, nnz: Optional[int] = None) -> None:
-    if nrow is None:
-        nrow = bsr.nrow
+def _bsr_resize(bsr: BsrMatrix, rows_of_blocks: int | None = None, cols_of_blocks: int | None = None) -> None:
+    if rows_of_blocks is not None:
+        bsr.nrow = int(rows_of_blocks)
+    if cols_of_blocks is not None:
+        bsr.ncol = int(cols_of_blocks)
+
+    if bsr.offsets.size < bsr.nrow + 1:
+        bsr.offsets = wp.empty(shape=(bsr.nrow + 1,), dtype=int, device=bsr.offsets.device)
+
+
+def _bsr_ensure_fits(bsr: BsrMatrix, nnz: int | None = None) -> None:
     if nnz is None:
         nnz = bsr.nnz
     else:
         # update nnz upper bound
         bsr.nnz = int(nnz)
 
-    if bsr.offsets.size < nrow + 1:
-        bsr.offsets = wp.empty(shape=(nrow + 1,), dtype=int, device=bsr.offsets.device)
     if bsr.columns.size < nnz:
         bsr.columns = wp.empty(shape=(nnz,), dtype=int, device=bsr.columns.device)
     if bsr.values.size < nnz:
@@ -372,11 +406,7 @@ def _bsr_ensure_fits(bsr: BsrMatrix, nrow: Optional[int] = None, nnz: Optional[i
         )
 
 
-def bsr_set_zero(
-    bsr: BsrMatrix,
-    rows_of_blocks: Optional[int] = None,
-    cols_of_blocks: Optional[int] = None,
-):
+def bsr_set_zero(bsr: BsrMatrix, rows_of_blocks: int | None = None, cols_of_blocks: int | None = None):
     """Set a BSR matrix to zero, possibly changing its size.
 
     Args:
@@ -384,15 +414,10 @@ def bsr_set_zero(
         rows_of_blocks: If not ``None``, the new number of rows of blocks.
         cols_of_blocks: If not ``None``, the new number of columns of blocks.
     """
+    _bsr_resize(bsr, rows_of_blocks, cols_of_blocks)
 
-    if rows_of_blocks is not None:
-        bsr.nrow = int(rows_of_blocks)
-    if cols_of_blocks is not None:
-        bsr.ncol = int(cols_of_blocks)
-
-    _bsr_ensure_fits(bsr, nnz=0)
     bsr.offsets.zero_()
-    bsr.copy_nnz_async()
+    bsr.notify_nnz_changed(nnz=0)
 
 
 def _as_3d_array(arr, block_shape):
@@ -406,11 +431,11 @@ def _as_3d_array(arr, block_shape):
     )
 
 
-def _optional_ctypes_pointer(array: Optional[wp.array], ctype):
+def _optional_ctypes_pointer(array: wp.array | None, ctype):
     return None if array is None else ctypes.cast(array.ptr, ctypes.POINTER(ctype))
 
 
-def _optional_ctypes_event(event: Optional[wp.Event]):
+def _optional_ctypes_event(event: wp.Event | None):
     return None if event is None else event.cuda_event
 
 
@@ -454,10 +479,10 @@ def _bsr_accumulate_triplet_values(
 
 def bsr_set_from_triplets(
     dest: BsrMatrix[BlockType[Rows, Cols, Scalar]],
-    rows: "Array[int]",
-    columns: "Array[int]",
-    values: Optional["Array[Union[Scalar, BlockType[Rows, Cols, Scalar]]]"] = None,
-    count: Optional["Array[int]"] = None,
+    rows: Array[int],
+    columns: Array[int],
+    values: Array[Scalar | BlockType[Rows, Cols, Scalar]] | None = None,
+    count: Array[int] | None = None,
     prune_numerical_zeros: bool = True,
     masked: bool = False,
 ):
@@ -597,9 +622,9 @@ def bsr_set_from_triplets(
 def bsr_from_triplets(
     rows_of_blocks: int,
     cols_of_blocks: int,
-    rows: "Array[int]",
-    columns: "Array[int]",
-    values: "Array[Union[Scalar, BlockType[Rows, Cols, Scalar]]]",
+    rows: Array[int],
+    columns: Array[int],
+    values: Array[Scalar | BlockType[Rows, Cols, Scalar]],
     prune_numerical_zeros: bool = True,
 ):
     """Constructs a BSR matrix with values defined by coordinate-oriented (COO) triplets.
@@ -666,7 +691,7 @@ class _BsrScalingExpression(_BsrExpression):
         return self.mat.scalar_type
 
     @property
-    def block_shape(self) -> Tuple[int, int]:
+    def block_shape(self) -> tuple[int, int]:
         return self.mat.block_shape
 
     @property
@@ -674,7 +699,7 @@ class _BsrScalingExpression(_BsrExpression):
         return self.mat.block_size
 
     @property
-    def shape(self) -> Tuple[int, int]:
+    def shape(self) -> tuple[int, int]:
         return self.mat.shape
 
     @property
@@ -744,36 +769,49 @@ def _extract_matrix_and_scale(bsr: BsrMatrixOrExpression):
 
 
 @wp.func
-def _bsr_row_index(
+def bsr_row_index(
     offsets: wp.array(dtype=int),
     row_count: int,
-    block: int,
-):
-    """Index of the row containing a block, or -1 if non-existing."""
-    return wp.where(block < offsets[row_count], wp.lower_bound(offsets, 0, row_count + 1, block + 1), 0) - 1
+    block_index: int,
+) -> int:
+    """Returns the index of the row containing a given block, or -1 if no such row exists.
+
+    Args:
+        offsets: Array of size at least ``1 + row_count`` containing the offsets of the blocks in each row.
+        row_count: Number of rows of blocks.
+        block_index: Index of the block.
+    """
+    return wp.where(block_index < offsets[row_count], wp.lower_bound(offsets, 0, row_count + 1, block_index + 1), 0) - 1
 
 
 @wp.func
-def _bsr_block_index(
+def bsr_block_index(
     row: int,
     col: int,
     bsr_offsets: wp.array(dtype=int),
     bsr_columns: wp.array(dtype=int),
-):
-    """Index of the block at block-coordinates (row, col), or -1 if non-existing.
-    Assumes bsr_columns is sorted.
+) -> int:
+    """
+    Returns the index of the block at block-coordinates (row, col), or -1 if no such block exists.
+    Assumes that the segments of ``bsr_columns`` corresponding to each row are sorted.
+
+    Args:
+        row: Row of the block.
+        col: Column of the block.
+        bsr_offsets: Array of size at least ``1 + row`` containing the offsets of the blocks in each row.
+        bsr_columns: Array of size at least equal to ``bsr_offsets[row + 1]`` containing the column indices of the blocks.
     """
 
     if row < 0:
         return -1
 
-    mask_row_beg = bsr_offsets[row]
-    mask_row_end = bsr_offsets[row + 1]
+    row_beg = bsr_offsets[row]
+    row_end = bsr_offsets[row + 1]
 
-    if mask_row_beg == mask_row_end:
+    if row_beg == row_end:
         return -1
 
-    block_index = wp.lower_bound(bsr_columns, mask_row_beg, mask_row_end, col)
+    block_index = wp.lower_bound(bsr_columns, row_beg, row_end, col)
     return wp.where(bsr_columns[block_index] == col, block_index, -1)
 
 
@@ -792,7 +830,7 @@ def _bsr_assign_list_blocks(
     block, subrow, subcol = wp.tid()
     dest_block = (block * src_subcols + subcol) * src_subrows + subrow
 
-    row = _bsr_row_index(src_offsets, src_row_count, block)
+    row = bsr_row_index(src_offsets, src_row_count, block)
     if row == -1:
         dest_rows[dest_block] = row  # invalid
         dest_cols[dest_block] = row
@@ -821,7 +859,7 @@ def _bsr_assign_copy_blocks(
     src_block = wp.tid()
     src_block, subrow, subcol = wp.tid()
 
-    src_row = _bsr_row_index(src_offsets, src_row_count, src_block)
+    src_row = bsr_row_index(src_offsets, src_row_count, src_block)
     if src_row == -1:
         return
 
@@ -832,7 +870,7 @@ def _bsr_assign_copy_blocks(
     dest_row = dest_subrow // dest_subrows
     dest_col = dest_subcol // dest_subcols
 
-    dest_block = _bsr_block_index(dest_row, dest_col, dest_offsets, dest_columns)
+    dest_block = bsr_block_index(dest_row, dest_col, dest_offsets, dest_columns)
     if dest_block == -1:
         return
 
@@ -870,7 +908,7 @@ def bsr_assign(
       structure_only: If ``True``, only the non-zero indices are copied, and uninitialized value storage is allocated
         to accommodate at least ``src.nnz`` blocks. If ``structure_only`` is ``False``, values are also copied with implicit
         casting if the two matrices use distinct scalar types.
-      masked: If ``True``, prevent the assignment operation from adding new non-zero blocks to ``dest``.
+      masked: If ``True``, keep the non-zero topology of ``dest`` unchanged.
     """
 
     src, src_scale = _extract_matrix_and_scale(src)
@@ -917,15 +955,13 @@ def bsr_assign(
                 f"Incompatible destination matrix size, expected ({dest_nrow}, {dest_ncol}), got ({dest.nrow}, {dest.ncol})"
             )
     else:
-        dest.nrow = dest_nrow
-        dest.ncol = dest_ncol
-        _bsr_ensure_fits(dest, nnz=nnz_alloc)
+        _bsr_resize(dest, rows_of_blocks=dest_nrow, cols_of_blocks=dest_ncol)
 
     if dest.block_shape == src.block_shape and not masked:
         # Direct copy
 
         wp.copy(dest=dest.offsets, src=src.offsets, count=src.nrow + 1)
-        dest.copy_nnz_async()
+        dest.notify_nnz_changed(nnz=nnz_alloc)
 
         if nnz_alloc > 0:
             wp.copy(dest=dest.columns, src=src.columns, count=nnz_alloc)
@@ -935,59 +971,60 @@ def bsr_assign(
                 bsr_scale(dest, src_scale)
 
     else:
-        # Masked and/or multiple src blocks per dest block, go through COO format
-
-        # Compute destination rows and columns
-        dest_rows = wp.empty(nnz_alloc, dtype=int, device=dest.device)
-        dest_cols = wp.empty(nnz_alloc, dtype=int, device=dest.device)
-        wp.launch(
-            _bsr_assign_list_blocks,
-            dim=(src.nnz, src_subrows, src_subcols),
-            device=dest.device,
-            inputs=[
-                src_subrows,
-                src_subcols,
-                dest_subrows,
-                dest_subcols,
-                src.nrow,
-                src.offsets,
-                src.columns,
-                dest_rows,
-                dest_cols,
-            ],
-        )
+        if not masked:
+            # Compute destination rows and columns
+            dest_rows = wp.empty(nnz_alloc, dtype=int, device=dest.device)
+            dest_cols = wp.empty(nnz_alloc, dtype=int, device=dest.device)
+            wp.launch(
+                _bsr_assign_list_blocks,
+                dim=(src.nnz, src_subrows, src_subcols),
+                device=dest.device,
+                inputs=[
+                    src_subrows,
+                    src_subcols,
+                    dest_subrows,
+                    dest_subcols,
+                    src.nrow,
+                    src.offsets,
+                    src.columns,
+                    dest_rows,
+                    dest_cols,
+                ],
+            )
 
-        # Compute destination offsets from triplets
-        from warp.context import runtime
+            _bsr_ensure_fits(dest, nnz=nnz_alloc)
 
-        if dest.device.is_cpu:
-            native_func = runtime.core.wp_bsr_matrix_from_triplets_host
-        else:
-            native_func = runtime.core.wp_bsr_matrix_from_triplets_device
+            # Compute destination offsets from triplets
+            from warp.context import runtime
 
-        nnz_buf, nnz_event = dest._setup_nnz_transfer()
-        with wp.ScopedDevice(dest.device):
-            native_func(
-                dest.block_size,
-                0,  # scalar_size_in_bytes
-                dest.nrow,
-                dest.ncol,
-                nnz_alloc,
-                None,  # device nnz
-                ctypes.cast(dest_rows.ptr, ctypes.POINTER(ctypes.c_int32)),
-                ctypes.cast(dest_cols.ptr, ctypes.POINTER(ctypes.c_int32)),
-                None,  # triplet values
-                0,  # zero_value_mask
-                masked,
-                None,  # summed block offsets
-                None,  # summed block indices
-                ctypes.cast(dest.offsets.ptr, ctypes.POINTER(ctypes.c_int32)),
-                ctypes.cast(dest.columns.ptr, ctypes.POINTER(ctypes.c_int32)),
-                _optional_ctypes_pointer(nnz_buf, ctype=ctypes.c_int32),
-                _optional_ctypes_event(nnz_event),
-            )
+            if dest.device.is_cpu:
+                native_func = runtime.core.wp_bsr_matrix_from_triplets_host
+            else:
+                native_func = runtime.core.wp_bsr_matrix_from_triplets_device
+
+            nnz_buf, nnz_event = dest._setup_nnz_transfer()
+            with wp.ScopedDevice(dest.device):
+                native_func(
+                    dest.block_size,
+                    0,  # scalar_size_in_bytes
+                    dest.nrow,
+                    dest.ncol,
+                    nnz_alloc,
+                    None,  # device nnz
+                    ctypes.cast(dest_rows.ptr, ctypes.POINTER(ctypes.c_int32)),
+                    ctypes.cast(dest_cols.ptr, ctypes.POINTER(ctypes.c_int32)),
+                    None,  # triplet values
+                    0,  # zero_value_mask
+                    masked,
+                    None,  # summed block offsets
+                    None,  # summed block indices
+                    ctypes.cast(dest.offsets.ptr, ctypes.POINTER(ctypes.c_int32)),
+                    ctypes.cast(dest.columns.ptr, ctypes.POINTER(ctypes.c_int32)),
+                    _optional_ctypes_pointer(nnz_buf, ctype=ctypes.c_int32),
+                    _optional_ctypes_event(nnz_event),
+                )
 
-        # merge block values
+        # copy block values
         if not structure_only:
             dest.values.zero_()
             wp.launch(
@@ -1013,8 +1050,8 @@ def bsr_assign(
 
 def bsr_copy(
     A: BsrMatrixOrExpression,
-    scalar_type: Optional[Scalar] = None,
-    block_shape: Optional[Tuple[int, int]] = None,
+    scalar_type: Scalar | None = None,
+    block_shape: tuple[int, int] | None = None,
     structure_only: bool = False,
 ):
     """Return a copy of matrix ``A``, possibly changing its scalar type.
@@ -1053,9 +1090,12 @@ def bsr_copy(
 def _bsr_transpose_values(
     col_count: int,
     scale: Any,
+    bsr_offsets: wp.array(dtype=int),
+    bsr_columns: wp.array(dtype=int),
     bsr_values: wp.array3d(dtype=Any),
     block_index_map: wp.array(dtype=int),
     transposed_bsr_offsets: wp.array(dtype=int),
+    transposed_bsr_columns: wp.array(dtype=int),
     transposed_bsr_values: wp.array3d(dtype=Any),
 ):
     block, i, j = wp.tid()
@@ -1063,14 +1103,31 @@ def _bsr_transpose_values(
     if block >= transposed_bsr_offsets[col_count]:
         return
 
-    transposed_bsr_values[block, i, j] = bsr_values[block_index_map[block], j, i] * scale
+    if block_index_map:
+        src_block = block_index_map[block]
+    else:
+        row = bsr_row_index(transposed_bsr_offsets, col_count, block)
+        col = transposed_bsr_columns[block]
+        src_block = bsr_block_index(col, row, bsr_offsets, bsr_columns)
+        if src_block == -1:
+            return
+
+    transposed_bsr_values[block, i, j] = bsr_values[src_block, j, i] * scale
 
 
 def bsr_set_transpose(
     dest: BsrMatrix[BlockType[Cols, Rows, Scalar]],
     src: BsrMatrixOrExpression[BlockType[Rows, Cols, Scalar]],
+    masked: bool = False,
 ):
-    """Assign the transposed matrix ``src`` to matrix ``dest``."""
+    """
+    Assign the transposed matrix ``src`` to matrix ``dest``.
+
+    Args:
+        dest: Sparse matrix to populate.
+        src: Sparse matrix to transpose.
+        masked: If ``True``, keep the non-zero topology of ``dest`` unchanged.
+    """
 
     src, src_scale = _extract_matrix_and_scale(src)
 
@@ -1087,47 +1144,63 @@ def bsr_set_transpose(
     if dest.block_shape != transpose_block_shape:
         raise ValueError(f"Destination block shape must be {transpose_block_shape}, got {dest.block_shape}")
 
-    nnz = src.nnz
-    dest.nrow = src.ncol
-    dest.ncol = src.nrow
+    if masked:
+        if dest.nrow != src.ncol or dest.ncol != src.nrow:
+            raise ValueError(
+                f"Destination matrix must have {src.ncol} rows and {src.nrow} columns, got {dest.nrow} and {dest.ncol}"
+            )
+        block_index_map = None
+        dest.values.zero_()
+    else:
+        _bsr_resize(dest, rows_of_blocks=src.ncol, cols_of_blocks=src.nrow)
 
-    if nnz == 0:
-        bsr_set_zero(dest)
-        return
+        nnz = src.nnz
+        if nnz == 0:
+            bsr_set_zero(dest)
+            return
 
-    # Increase dest array sizes if needed
-    _bsr_ensure_fits(dest, nnz=nnz)
+        # Increase dest array sizes if needed
+        _bsr_ensure_fits(dest, nnz=nnz)
 
-    from warp.context import runtime
+        from warp.context import runtime
 
-    if dest.values.device.is_cpu:
-        native_func = runtime.core.wp_bsr_transpose_host
-    else:
-        native_func = runtime.core.wp_bsr_transpose_device
+        if dest.values.device.is_cpu:
+            native_func = runtime.core.wp_bsr_transpose_host
+        else:
+            native_func = runtime.core.wp_bsr_transpose_device
 
-    block_index_map = wp.empty(shape=2 * nnz, dtype=int, device=src.device)
+        block_index_map = wp.empty(shape=2 * nnz, dtype=int, device=src.device)
 
-    with wp.ScopedDevice(dest.device):
-        native_func(
-            src.nrow,
-            src.ncol,
-            nnz,
-            ctypes.cast(src.offsets.ptr, ctypes.POINTER(ctypes.c_int32)),
-            ctypes.cast(src.columns.ptr, ctypes.POINTER(ctypes.c_int32)),
-            ctypes.cast(dest.offsets.ptr, ctypes.POINTER(ctypes.c_int32)),
-            ctypes.cast(dest.columns.ptr, ctypes.POINTER(ctypes.c_int32)),
-            ctypes.cast(block_index_map.ptr, ctypes.POINTER(ctypes.c_int32)),
-        )
+        with wp.ScopedDevice(dest.device):
+            native_func(
+                src.nrow,
+                src.ncol,
+                nnz,
+                ctypes.cast(src.offsets.ptr, ctypes.POINTER(ctypes.c_int32)),
+                ctypes.cast(src.columns.ptr, ctypes.POINTER(ctypes.c_int32)),
+                ctypes.cast(dest.offsets.ptr, ctypes.POINTER(ctypes.c_int32)),
+                ctypes.cast(dest.columns.ptr, ctypes.POINTER(ctypes.c_int32)),
+                ctypes.cast(block_index_map.ptr, ctypes.POINTER(ctypes.c_int32)),
+            )
 
-        dest.copy_nnz_async()
+            dest._copy_nnz_async()
 
-        wp.launch(
-            _bsr_transpose_values,
-            dim=(nnz, *dest.block_shape),
-            device=dest.device,
-            inputs=[src.ncol, dest.scalar_type(src_scale), src.scalar_values, block_index_map, dest.offsets],
-            outputs=[dest.scalar_values],
-        )
+    wp.launch(
+        _bsr_transpose_values,
+        dim=(dest.nnz, *dest.block_shape),
+        device=dest.device,
+        inputs=[
+            src.ncol,
+            dest.scalar_type(src_scale),
+            src.offsets,
+            src.columns,
+            src.scalar_values,
+            block_index_map,
+            dest.offsets,
+            dest.columns,
+        ],
+        outputs=[dest.scalar_values],
+    )
 
 
 def bsr_transposed(A: BsrMatrixOrExpression) -> BsrMatrix:
@@ -1159,12 +1232,12 @@ def _bsr_get_diag_kernel(
 ):
     row, br, bc = wp.tid()
 
-    diag = _bsr_block_index(row, row, A_offsets, A_columns)
+    diag = bsr_block_index(row, row, A_offsets, A_columns)
     if diag != -1:
         out[row, br, bc] = scale * A_values[diag, br, bc]
 
 
-def bsr_get_diag(A: BsrMatrixOrExpression[BlockType], out: "Optional[Array[BlockType]]" = None) -> "Array[BlockType]":
+def bsr_get_diag(A: BsrMatrixOrExpression[BlockType], out: Array[BlockType] | None = None) -> Array[BlockType]:
     """Return the array of blocks that constitute the diagonal of a sparse matrix.
 
     Args:
@@ -1210,9 +1283,9 @@ def _bsr_set_diag_kernel(
 
 def bsr_set_diag(
     A: BsrMatrix[BlockType],
-    diag: "Union[BlockType, Array[BlockType]]",
-    rows_of_blocks: Optional[int] = None,
-    cols_of_blocks: Optional[int] = None,
+    diag: BlockType | Array[BlockType],
+    rows_of_blocks: int | None = None,
+    cols_of_blocks: int | None = None,
 ) -> None:
     """Set ``A`` as a block-diagonal matrix.
 
@@ -1246,11 +1319,10 @@ def bsr_set_diag(
             cols_of_blocks = diag.shape[0]
 
     if rows_of_blocks is not None:
-        A.nrow = rows_of_blocks
-        A.ncol = cols_of_blocks
+        _bsr_resize(A, rows_of_blocks, cols_of_blocks)
 
     nnz = min(A.nrow, A.ncol)
-    _bsr_ensure_fits(A, nnz=nnz)
+    A.notify_nnz_changed(nnz=nnz)  # notify change of nnz upper bound
 
     wp.launch(
         kernel=_bsr_set_diag_kernel,
@@ -1259,21 +1331,21 @@ def bsr_set_diag(
         inputs=[nnz, A.offsets, A.columns],
     )
 
+    A.notify_nnz_changed(nnz=nnz)  # notify change of offsets
+
     if is_array(diag):
         wp.copy(src=diag, dest=A.values, count=nnz)
     elif diag is not None:
         A.values.fill_(diag)
 
-    A.copy_nnz_async()
-
 
 def bsr_diag(
-    diag: Optional[Union[BlockType, Array[BlockType]]] = None,
-    rows_of_blocks: Optional[int] = None,
-    cols_of_blocks: Optional[int] = None,
-    block_type: Optional[BlockType] = None,
+    diag: BlockType | Array[BlockType] | None = None,
+    rows_of_blocks: int | None = None,
+    cols_of_blocks: int | None = None,
+    block_type: BlockType | None = None,
     device=None,
-) -> BsrMatrix["BlockType"]:
+) -> BsrMatrix[BlockType]:
     """Create and return a block-diagonal BSR matrix from an given block value or array of block values.
 
     Args:
@@ -1326,7 +1398,7 @@ def bsr_diag(
     return A
 
 
-def bsr_set_identity(A: BsrMatrix, rows_of_blocks: Optional[int] = None) -> None:
+def bsr_set_identity(A: BsrMatrix, rows_of_blocks: int | None = None) -> None:
     """Set ``A`` as the identity matrix.
 
     Args:
@@ -1393,7 +1465,7 @@ def bsr_scale(x: BsrMatrixOrExpression, alpha: Scalar) -> BsrMatrix:
 
     if alpha != 1.0 and x.nnz > 0:
         if alpha == 0.0:
-            bsr_set_zero(x)
+            x.values.zero_()
         else:
             alpha = x.scalar_type(alpha)
 
@@ -1410,7 +1482,7 @@ def bsr_scale(x: BsrMatrixOrExpression, alpha: Scalar) -> BsrMatrix:
 @wp.kernel(enable_backward=False)
 def _bsr_get_block_row(row_count: int, bsr_offsets: wp.array(dtype=int), rows: wp.array(dtype=int)):
     block = wp.tid()
-    rows[block] = _bsr_row_index(bsr_offsets, row_count, block)
+    rows[block] = bsr_row_index(bsr_offsets, row_count, block)
 
 
 @wp.kernel
@@ -1428,11 +1500,34 @@ def _bsr_axpy_add_block(
     row = rows[i + src_offset]
     col = cols[i + src_offset]
 
-    block = _bsr_block_index(row, col, dst_offsets, dst_columns)
+    block = bsr_block_index(row, col, dst_offsets, dst_columns)
     if block != -1:
         dst_values[block, br, bc] += scale * src_values[i, br, bc]
 
 
+@wp.kernel
+def _bsr_axpy_masked(
+    alpha: Any,
+    row_count: int,
+    src_offsets: wp.array(dtype=int),
+    src_columns: wp.array(dtype=int),
+    src_values: wp.array3d(dtype=Any),
+    dst_offsets: wp.array(dtype=int),
+    dst_columns: wp.array(dtype=int),
+    dst_values: wp.array3d(dtype=Any),
+):
+    block, br, bc = wp.tid()
+
+    row = bsr_row_index(dst_offsets, row_count, block)
+    if row == -1:
+        return
+
+    col = dst_columns[block]
+    src_block = bsr_block_index(row, col, src_offsets, src_columns)
+    if src_block != -1:
+        dst_values[block, br, bc] += alpha * src_values[src_block, br, bc]
+
+
 class bsr_axpy_work_arrays:
     """Opaque structure for persisting :func:`bsr_axpy` temporary work buffers across calls."""
 
@@ -1461,11 +1556,11 @@ class bsr_axpy_work_arrays:
 
 def bsr_axpy(
     x: BsrMatrixOrExpression,
-    y: Optional[BsrMatrix[BlockType[Rows, Cols, Scalar]]] = None,
+    y: BsrMatrix[BlockType[Rows, Cols, Scalar]] | None = None,
     alpha: Scalar = 1.0,
     beta: Scalar = 1.0,
     masked: bool = False,
-    work_arrays: Optional[bsr_axpy_work_arrays] = None,
+    work_arrays: bsr_axpy_work_arrays | None = None,
 ) -> BsrMatrix[BlockType[Rows, Cols, Scalar]]:
     """
     Perform the sparse matrix addition ``y := alpha * X + beta * y`` on BSR matrices ``x`` and ``y`` and return ``y``.
@@ -1477,8 +1572,7 @@ def bsr_axpy(
         y: Mutable second operand and output matrix. If ``y`` is not provided, it will be allocated and treated as zero.
         alpha: Uniform scaling factor for ``x``.
         beta: Uniform scaling factor for ``y``.
-        masked: If ``True``, discard all blocks from ``x`` which are not
-          existing non-zeros of ``y``.
+        masked: If ``True``, keep the non-zero topology of ``y`` unchanged.
         work_arrays: In most cases, this function will require the use of temporary storage.
           This storage can be reused across calls by passing an instance of
           :class:`bsr_axpy_work_arrays` in ``work_arrays``.
@@ -1501,23 +1595,23 @@ def bsr_axpy(
 
     # Handle easy cases first
     if beta == 0.0 or y_nnz == 0:
-        bsr_assign(src=x, dest=y)
+        bsr_assign(src=x, dest=y, masked=masked)
         return bsr_scale(y, alpha=alpha)
 
     if alpha == 0.0 or x_nnz == 0:
         return bsr_scale(y, alpha=beta)
 
-    if not isinstance(alpha, y.scalar_type):
-        alpha = y.scalar_type(alpha)
-    if not isinstance(beta, y.scalar_type):
-        beta = y.scalar_type(beta)
-
     if x == y:
         # Aliasing case
-        return bsr_scale(y, alpha=alpha.value + beta.value)
+        return bsr_scale(y, alpha=alpha + beta)
 
     # General case
 
+    if not isinstance(alpha, y.scalar_type):
+        alpha = y.scalar_type(alpha)
+    if not isinstance(beta, y.scalar_type):
+        beta = y.scalar_type(beta)
+
     if x.values.device != y.values.device:
         raise ValueError(f"All arguments must reside on the same device, got {x.values.device} and {y.values.device}")
 
@@ -1531,90 +1625,108 @@ def bsr_axpy(
             f"Matrices must have the same number of rows and columns, got ({x.nrow}, {x.ncol}) and ({y.nrow}, {y.ncol})"
         )
 
-    if work_arrays is None:
-        work_arrays = bsr_axpy_work_arrays()
-
-    sum_nnz = x_nnz + y_nnz
     device = y.values.device
-    work_arrays._allocate(device, y, sum_nnz)
+    if masked:
+        bsr_scale(y, alpha=beta.value)
+        wp.launch(
+            kernel=_bsr_axpy_masked,
+            device=device,
+            dim=(y_nnz, y.block_shape[0], y.block_shape[1]),
+            inputs=[
+                alpha,
+                x.nrow,
+                x.offsets,
+                x.columns,
+                x.scalar_values,
+                y.offsets,
+                y.columns,
+                y.scalar_values,
+            ],
+        )
 
-    wp.copy(work_arrays._sum_cols, y.columns, 0, 0, y_nnz)
-    y.uncompress_rows(out=work_arrays._sum_rows)
+    else:
+        if work_arrays is None:
+            work_arrays = bsr_axpy_work_arrays()
 
-    wp.copy(work_arrays._sum_cols, x.columns, y_nnz, 0, x_nnz)
-    x.uncompress_rows(out=work_arrays._sum_rows[y_nnz:])
+        sum_nnz = x_nnz + y_nnz
+        work_arrays._allocate(device, y, sum_nnz)
 
-    # Save old y values before overwriting matrix
-    wp.copy(dest=work_arrays._old_y_values, src=y.values, count=y.nnz)
+        wp.copy(work_arrays._sum_cols, y.columns, 0, 0, y_nnz)
+        y.uncompress_rows(out=work_arrays._sum_rows)
 
-    # Increase dest array sizes if needed
-    if not masked:
+        wp.copy(work_arrays._sum_cols, x.columns, y_nnz, 0, x_nnz)
+        x.uncompress_rows(out=work_arrays._sum_rows[y_nnz:])
+
+        # Save old y values before overwriting matrix
+        wp.copy(dest=work_arrays._old_y_values, src=y.values, count=y.nnz)
+
+        # Increase dest array sizes if needed
         _bsr_ensure_fits(y, nnz=sum_nnz)
 
-    from warp.context import runtime
+        from warp.context import runtime
 
-    if device.is_cpu:
-        native_func = runtime.core.wp_bsr_matrix_from_triplets_host
-    else:
-        native_func = runtime.core.wp_bsr_matrix_from_triplets_device
+        if device.is_cpu:
+            native_func = runtime.core.wp_bsr_matrix_from_triplets_host
+        else:
+            native_func = runtime.core.wp_bsr_matrix_from_triplets_device
 
-    old_y_nnz = y_nnz
-    nnz_buf, nnz_event = y._setup_nnz_transfer()
+        old_y_nnz = y_nnz
+        nnz_buf, nnz_event = y._setup_nnz_transfer()
 
-    with wp.ScopedDevice(y.device):
-        native_func(
-            y.block_size,
-            0,  # scalar_size_in_bytes
-            y.nrow,
-            y.ncol,
-            sum_nnz,
-            None,  # device nnz
-            ctypes.cast(work_arrays._sum_rows.ptr, ctypes.POINTER(ctypes.c_int32)),
-            ctypes.cast(work_arrays._sum_cols.ptr, ctypes.POINTER(ctypes.c_int32)),
-            None,  # triplet values
-            0,  # zero_value_mask
-            masked,
-            None,  # summed block offsets
-            None,  # summed block indices
-            ctypes.cast(y.offsets.ptr, ctypes.POINTER(ctypes.c_int32)),
-            ctypes.cast(y.columns.ptr, ctypes.POINTER(ctypes.c_int32)),
-            _optional_ctypes_pointer(nnz_buf, ctype=ctypes.c_int32),
-            _optional_ctypes_event(nnz_event),
-        )
+        with wp.ScopedDevice(y.device):
+            native_func(
+                y.block_size,
+                0,  # scalar_size_in_bytes
+                y.nrow,
+                y.ncol,
+                sum_nnz,
+                None,  # device nnz
+                ctypes.cast(work_arrays._sum_rows.ptr, ctypes.POINTER(ctypes.c_int32)),
+                ctypes.cast(work_arrays._sum_cols.ptr, ctypes.POINTER(ctypes.c_int32)),
+                None,  # triplet values
+                0,  # zero_value_mask
+                masked,
+                None,  # summed block offsets
+                None,  # summed block indices
+                ctypes.cast(y.offsets.ptr, ctypes.POINTER(ctypes.c_int32)),
+                ctypes.cast(y.columns.ptr, ctypes.POINTER(ctypes.c_int32)),
+                _optional_ctypes_pointer(nnz_buf, ctype=ctypes.c_int32),
+                _optional_ctypes_event(nnz_event),
+            )
 
-    y.values.zero_()
+        y.values.zero_()
 
-    wp.launch(
-        kernel=_bsr_axpy_add_block,
-        device=device,
-        dim=(old_y_nnz, y.block_shape[0], y.block_shape[1]),
-        inputs=[
-            0,
-            beta,
-            work_arrays._sum_rows,
-            work_arrays._sum_cols,
-            y.offsets,
-            y.columns,
-            _as_3d_array(work_arrays._old_y_values, y.block_shape),
-            y.scalar_values,
-        ],
-    )
+        wp.launch(
+            kernel=_bsr_axpy_add_block,
+            device=device,
+            dim=(old_y_nnz, y.block_shape[0], y.block_shape[1]),
+            inputs=[
+                0,
+                beta,
+                work_arrays._sum_rows,
+                work_arrays._sum_cols,
+                y.offsets,
+                y.columns,
+                _as_3d_array(work_arrays._old_y_values, y.block_shape),
+                y.scalar_values,
+            ],
+        )
 
-    wp.launch(
-        kernel=_bsr_axpy_add_block,
-        device=device,
-        dim=(x_nnz, y.block_shape[0], y.block_shape[1]),
-        inputs=[
-            old_y_nnz,
-            alpha,
-            work_arrays._sum_rows,
-            work_arrays._sum_cols,
-            y.offsets,
-            y.columns,
-            x.scalar_values,
-            y.scalar_values,
-        ],
-    )
+        wp.launch(
+            kernel=_bsr_axpy_add_block,
+            device=device,
+            dim=(x_nnz, y.block_shape[0], y.block_shape[1]),
+            inputs=[
+                old_y_nnz,
+                alpha,
+                work_arrays._sum_rows,
+                work_arrays._sum_cols,
+                y.offsets,
+                y.columns,
+                x.scalar_values,
+                y.scalar_values,
+            ],
+        )
 
     return y
 
@@ -1700,7 +1812,7 @@ def _bsr_mm_list_coeffs(
     x_block = wp.lower_bound(mm_offsets, 0, x_nnz + 1, mm_block + 1) - 1
     pos = mm_block - mm_offsets[x_block]
 
-    row = _bsr_row_index(x_offsets, x_nrow, x_block)
+    row = bsr_row_index(x_offsets, x_nrow, x_block)
 
     row_min_col = mm_row_min[row]
     if row_min_col == -1:
@@ -1762,7 +1874,7 @@ def _bsr_mm_compute_values(
 ):
     mm_block = wp.tid()
 
-    row = _bsr_row_index(mm_offsets, mm_row_count, mm_block)
+    row = bsr_row_index(mm_offsets, mm_row_count, mm_block)
     if row == -1:
         return
 
@@ -1777,12 +1889,12 @@ def _bsr_mm_compute_values(
             x_block = summed_triplet_src_blocks[tpl_idx]
             x_col = x_columns[x_block]
             if x_block != -1:
-                y_block = _bsr_block_index(x_col, col, y_offsets, y_columns)
+                y_block = bsr_block_index(x_col, col, y_offsets, y_columns)
                 mm_val += x_values[x_block] * y_values[y_block]
     else:
         for x_block in range(block_beg, block_end):
             x_col = x_columns[x_block]
-            y_block = _bsr_block_index(x_col, col, y_offsets, y_columns)
+            y_block = bsr_block_index(x_col, col, y_offsets, y_columns)
             if y_block != -1:
                 mm_val += x_values[x_block] * y_values[y_block]
 
@@ -1801,8 +1913,8 @@ def make_bsr_mm_compute_values_tiled_outer(subblock_rows, subblock_cols, block_d
 
     @dynamic_func(suffix=suffix)
     def _outer_product(
-        x_values: wp.array2d(dtype=scalar_type),
-        y_values: wp.array2d(dtype=scalar_type),
+        x_values: wp.array2d(dtype=Any),
+        y_values: wp.array2d(dtype=Any),
         brow_off: int,
         bcol_off: int,
         block_col: int,
@@ -1821,20 +1933,20 @@ def make_bsr_mm_compute_values_tiled_outer(subblock_rows, subblock_cols, block_d
 
     @dynamic_kernel(suffix=suffix, kernel_options={"enable_backward": False})
     def bsr_mm_compute_values(
-        alpha: scalar_type,
+        alpha: Any,
         x_offsets: wp.array(dtype=int),
         x_columns: wp.array(dtype=int),
-        x_values: wp.array3d(dtype=scalar_type),
+        x_values: wp.array3d(dtype=Any),
         y_offsets: wp.array(dtype=int),
         y_columns: wp.array(dtype=int),
-        y_values: wp.array3d(dtype=scalar_type),
+        y_values: wp.array3d(dtype=Any),
         mm_row_min: wp.array(dtype=int),
         summed_triplet_offsets: wp.array(dtype=int),
         summed_triplet_src_blocks: wp.indexedarray(dtype=int),
         mm_row_count: int,
         mm_offsets: wp.array(dtype=int),
         mm_cols: wp.array(dtype=int),
-        mm_values: wp.array3d(dtype=scalar_type),
+        mm_values: wp.array3d(dtype=Any),
     ):
         mm_block, subrow, subcol, lane = wp.tid()
 
@@ -1844,7 +1956,7 @@ def make_bsr_mm_compute_values_tiled_outer(subblock_rows, subblock_cols, block_d
         brow_count = wp.min(mm_values.shape[1] - brow_off, subblock_rows)
         bcol_count = wp.min(mm_values.shape[2] - bcol_off, subblock_cols)
 
-        mm_row = _bsr_row_index(mm_offsets, mm_row_count, mm_block)
+        mm_row = bsr_row_index(mm_offsets, mm_row_count, mm_block)
         if mm_row == -1:
             return
 
@@ -1866,7 +1978,7 @@ def make_bsr_mm_compute_values_tiled_outer(subblock_rows, subblock_cols, block_d
                 x_block = summed_triplet_src_blocks[tpl_block]
                 if x_block != -1:
                     x_col = x_columns[x_block]
-                    y_block = _bsr_block_index(x_col, mm_col, y_offsets, y_columns)
+                    y_block = bsr_block_index(x_col, mm_col, y_offsets, y_columns)
                     lane_val += _outer_product(
                         x_values[x_block], y_values[y_block], brow_off, bcol_off, block_col, brow_count, bcol_count
                     )
@@ -1877,7 +1989,7 @@ def make_bsr_mm_compute_values_tiled_outer(subblock_rows, subblock_cols, block_d
                 x_block += block_beg
 
                 x_col = x_columns[x_block]
-                y_block = _bsr_block_index(x_col, mm_col, y_offsets, y_columns)
+                y_block = bsr_block_index(x_col, mm_col, y_offsets, y_columns)
 
                 if y_block != -1:
                     lane_val += _outer_product(
@@ -1950,11 +2062,11 @@ class bsr_mm_work_arrays:
 def bsr_mm(
     x: BsrMatrixOrExpression[BlockType[Rows, Any, Scalar]],
     y: BsrMatrixOrExpression[BlockType[Any, Cols, Scalar]],
-    z: Optional[BsrMatrix[BlockType[Rows, Cols, Scalar]]] = None,
+    z: BsrMatrix[BlockType[Rows, Cols, Scalar]] | None = None,
     alpha: Scalar = 1.0,
     beta: Scalar = 0.0,
     masked: bool = False,
-    work_arrays: Optional[bsr_mm_work_arrays] = None,
+    work_arrays: bsr_mm_work_arrays | None = None,
     reuse_topology: bool = False,
     tile_size: int = 0,
 ) -> BsrMatrix[BlockType[Rows, Cols, Scalar]]:
@@ -1970,7 +2082,7 @@ def bsr_mm(
         z: Mutable affine operand and result matrix. If ``z`` is not provided, it will be allocated and treated as zero.
         alpha: Uniform scaling factor for the ``x @ y`` product
         beta: Uniform scaling factor for ``z``
-        masked: If ``True``, ignore all blocks from ``x @ y`` which are not existing non-zeros of ``y``
+        masked: If ``True``, keep the non-zero topology of ``z`` unchanged.
         work_arrays: In most cases, this function will require the use of temporary storage.
           This storage can be reused across calls by passing an instance of
           :class:`bsr_mm_work_arrays` in ``work_arrays``.
@@ -2218,7 +2330,7 @@ def bsr_mm(
         max_tiles_per_sm = 2048 // tile_size  # assume 64 resident warps per SM
         use_tiles = device.is_cuda and (
             max(x.block_size, y.block_size, z.block_size) > max_subblock_dim**2
-            or mm_nnz < max_tiles_per_sm * device.sm_count
+            or z.nnz < max_tiles_per_sm * device.sm_count
         )
 
     if use_tiles:
@@ -2394,7 +2506,7 @@ def make_bsr_mv_transpose_kernel(block_rows: int):
     ):
         block, subcol = wp.tid()
 
-        row = _bsr_row_index(A_offsets, A_row_count, block)
+        row = bsr_row_index(A_offsets, A_row_count, block)
         if row == -1:
             return
 
@@ -2455,14 +2567,14 @@ def _vec_array_view(array: wp.array, dtype: type, expected_scalar_count: int) ->
 
 def bsr_mv(
     A: BsrMatrixOrExpression[BlockType[Rows, Cols, Scalar]],
-    x: "Array[Vector[Cols, Scalar] | Scalar]",
-    y: Optional["Array[Vector[Rows, Scalar] | Scalar]"] = None,
+    x: Array[Vector[Cols, Scalar] | Scalar],
+    y: Array[Vector[Rows, Scalar] | Scalar] | None = None,
     alpha: Scalar = 1.0,
     beta: Scalar = 0.0,
     transpose: bool = False,
-    work_buffer: Optional["Array[Vector[Rows, Scalar] | Scalar]"] = None,
+    work_buffer: Array[Vector[Rows, Scalar] | Scalar] | None = None,
     tile_size: int = 0,
-) -> "Array[Vector[Rows, Scalar] | Scalar]":
+) -> Array[Vector[Rows, Scalar] | Scalar]:
     """Perform the sparse matrix-vector product ``y := alpha * A * x + beta * y`` and return ``y``.
 
     The ``x`` and ``y`` vectors are allowed to alias.
diff --git a/warp/tests/cuda/test_streams.py b/warp/tests/cuda/test_streams.py
index eabfab72..9b830071 100644
--- a/warp/tests/cuda/test_streams.py
+++ b/warp/tests/cuda/test_streams.py
@@ -365,6 +365,41 @@ def test_event_elapsed_time_graph(test, device):
     test.assertGreater(elapsed, 0)
 
 
+def test_event_external(test, device):
+    with wp.ScopedDevice(device):
+        # event used to synchronize two graphs (external event)
+        event = wp.Event()
+
+        n = 1_000_000
+        a = wp.zeros(n, dtype=float)
+        b = wp.zeros(n, dtype=float)
+        c = wp.zeros(n, dtype=float)
+
+        with wp.ScopedCapture() as capture1:
+            wp.launch(inc, dim=n, inputs=[a])
+            wp.launch(inc, dim=n, inputs=[b])
+            # record in first graph
+            wp.record_event(event, external=True)
+
+        with wp.ScopedCapture() as capture2:
+            # wait in second graph
+            wp.wait_event(event, external=True)
+            wp.launch(sum, dim=n, inputs=[a, b, c])
+
+        stream1 = wp.Stream()
+        stream2 = wp.Stream()
+        num_iters = 10
+
+        for _ in range(num_iters):
+            # Launch graphs on different streams, but they should be
+            # synchronized using the external event.
+            wp.capture_launch(capture1.graph, stream=stream1)
+            wp.capture_launch(capture2.graph, stream=stream2)
+
+        expected = np.full(n, 2 * num_iters, dtype=np.float32)
+        assert_np_equal(c.numpy(), expected)
+
+
 def test_stream_priority_basics(test, device):
     standard_stream = wp.Stream(device)
     test.assertEqual(standard_stream.priority, 0, "Default priority of streams must be 0.")
@@ -470,6 +505,25 @@ def test_stream_event_is_complete(test, device):
                 test.assertEqual(a.numpy()[0], (iter + 1) * threads)
 
 
+def test_graph_destroy_during_capture(test, device):
+    with wp.ScopedDevice(device):
+        n = 10
+        a = wp.zeros(n, dtype=float)
+
+        with wp.ScopedCapture() as capture1:
+            wp.launch(inc, dim=n, inputs=[a])
+
+        wp.capture_launch(capture1.graph)
+
+        with wp.ScopedCapture() as capture2:
+            del capture1  # <--- should be deferred
+            wp.launch(inc, dim=n, inputs=[a])
+
+        wp.capture_launch(capture2.graph)
+
+        assert_np_equal(a.numpy(), np.full(n, 2, dtype=np.float32))
+
+
 devices = get_selected_cuda_test_devices()
 
 
@@ -628,6 +682,9 @@ add_function_test(TestStreams, "test_stream_event_is_complete", test_stream_even
 add_function_test(TestStreams, "test_event_synchronize", test_event_synchronize, devices=devices)
 add_function_test(TestStreams, "test_event_elapsed_time", test_event_elapsed_time, devices=devices)
 add_function_test(TestStreams, "test_event_elapsed_time_graph", test_event_elapsed_time_graph, devices=devices)
+add_function_test(TestStreams, "test_event_external", test_event_external, devices=devices)
+
+add_function_test(TestStreams, "test_graph_destroy_during_capture", test_graph_destroy_during_capture, devices=devices)
 
 if __name__ == "__main__":
     wp.clear_kernel_cache()
diff --git a/warp/tests/geometry/test_bvh.py b/warp/tests/geometry/test_bvh.py
index 410be29c..68e5e841 100644
--- a/warp/tests/geometry/test_bvh.py
+++ b/warp/tests/geometry/test_bvh.py
@@ -95,7 +95,7 @@ def test_bvh(test, type, device):
     query_start = wp.vec3(0.0, 0.0, 0.0)
     query_dir = wp.normalize(wp.vec3(1.0, 1.0, 1.0))
 
-    for test_case in range(2):
+    for test_case in range(3):
         if type == "AABB":
             wp.launch(
                 kernel=bvh_query_aabb,
@@ -120,14 +120,18 @@ def test_bvh(test, type, device):
 
             test.assertEqual(host_intersected, device_intersected[i])
 
-        if test_case == 0:
+        if test_case == 0 or test_case == 1:
             lowers = rng.random(size=(num_bounds, 3)) * 5.0
             uppers = lowers + rng.random(size=(num_bounds, 3)) * 5.0
             wp.copy(device_lowers, wp.array(lowers, dtype=wp.vec3, device=device))
             wp.copy(device_uppers, wp.array(uppers, dtype=wp.vec3, device=device))
-            bvh.refit()
             bounds_intersected.zero_()
 
+            if test_case == 0:
+                bvh.refit()
+            else:
+                bvh.rebuild()
+
 
 def test_bvh_query_aabb(test, device):
     test_bvh(test, "AABB", device)
@@ -161,7 +165,132 @@ def test_gh_288(test, device):
         test.assertEqual(device_intersected.sum(), num_bounds)
 
 
+def get_random_aabbs(
+    n,
+    center,
+    relative_shift,
+    relative_size,
+    rng,
+):
+    centers = rng.uniform(-0.5, 0.5, size=n * 3).reshape(n, 3) * relative_shift + center
+    diffs = 0.5 * rng.random(n * 3).reshape(n, 3) * relative_size
+
+    lowers = centers - diffs
+    uppers = centers + diffs
+
+    return lowers, uppers
+
+
+@wp.kernel
+def compute_num_contact_with_checksums(
+    lowers: wp.array(dtype=wp.vec3),
+    uppers: wp.array(dtype=wp.vec3),
+    bvh_id: wp.uint64,
+    counts: wp.array(dtype=int),
+    check_sums: wp.array(dtype=int),
+):
+    tid = wp.tid()
+
+    upper = uppers[tid]
+    lower = lowers[tid]
+
+    query = wp.bvh_query_aabb(bvh_id, lower, upper)
+    count = int(0)
+
+    check_sum = int(0)
+    index = int(0)
+    while wp.bvh_query_next(query, index):
+        check_sum = check_sum ^ index
+        count += 1
+
+    counts[tid] = count
+    check_sums[tid] = check_sum
+
+
+def test_capture_bvh_rebuild(test, device):
+    with wp.ScopedDevice(device):
+        rng = np.random.default_rng(123)
+
+        num_item_bounds = 100000
+        item_bound_size = 0.01
+
+        relative_shift = 2
+
+        num_test_bounds = 10000
+        test_bound_relative_size = 0.05
+
+        center = np.array([0.0, 0.0, 0.0])
+
+        item_lowers_np, item_uppers_np = get_random_aabbs(num_item_bounds, center, relative_shift, item_bound_size, rng)
+        item_lowers = wp.array(item_lowers_np, dtype=wp.vec3)
+        item_uppers = wp.array(item_uppers_np, dtype=wp.vec3)
+        bvh_1 = wp.Bvh(item_lowers, item_uppers)
+        item_lowers_2 = wp.zeros_like(item_lowers)
+        item_uppers_2 = wp.zeros_like(item_lowers)
+
+        test_lowers_np, test_uppers_np = get_random_aabbs(
+            num_test_bounds, center, relative_shift, test_bound_relative_size, rng
+        )
+        test_lowers = wp.array(test_lowers_np, dtype=wp.vec3)
+        test_uppers = wp.array(test_uppers_np, dtype=wp.vec3)
+
+        item_lowers_2_np, item_uppers_2_np = get_random_aabbs(
+            num_item_bounds,
+            center,
+            relative_shift,
+            item_bound_size,
+            rng,
+        )
+        item_lowers_2.assign(item_lowers_2_np)
+        item_uppers_2.assign(item_uppers_2_np)
+
+        counts_1 = wp.empty(n=num_test_bounds, dtype=int)
+        checksums_1 = wp.empty(n=num_test_bounds, dtype=int)
+        counts_2 = wp.empty(n=num_test_bounds, dtype=int)
+        checksums_2 = wp.empty(n=num_test_bounds, dtype=int)
+
+        wp.load_module(device=device)
+        with wp.ScopedCapture(force_module_load=False) as capture:
+            wp.copy(item_lowers, item_lowers_2)
+            wp.copy(item_uppers, item_uppers_2)
+            bvh_1.rebuild()
+            wp.launch(
+                kernel=compute_num_contact_with_checksums,
+                dim=num_test_bounds,
+                inputs=[test_lowers, test_uppers, bvh_1.id],
+                outputs=[counts_1, checksums_1],
+            )
+
+        cuda_graph = capture.graph
+
+        for _ in range(10):
+            item_lowers_2_np, item_uppers_2_np = get_random_aabbs(
+                num_item_bounds,
+                center,
+                relative_shift,
+                item_bound_size,
+                rng,
+            )
+            item_lowers_2.assign(item_lowers_2_np)
+            item_uppers_2.assign(item_uppers_2_np)
+
+            wp.capture_launch(cuda_graph)
+
+            bvh_2 = wp.Bvh(item_lowers_2, item_uppers_2)
+            wp.launch(
+                kernel=compute_num_contact_with_checksums,
+                dim=num_test_bounds,
+                inputs=[test_lowers, test_uppers, bvh_2.id],
+                outputs=[counts_2, checksums_2],
+                device=device,
+            )
+
+            assert_array_equal(counts_1, counts_2)
+            assert_array_equal(checksums_1, checksums_2)
+
+
 devices = get_test_devices()
+cuda_devices = get_cuda_test_devices()
 
 
 class TestBvh(unittest.TestCase):
@@ -195,6 +324,8 @@ add_function_test(TestBvh, "test_bvh_aabb", test_bvh_query_aabb, devices=devices
 add_function_test(TestBvh, "test_bvh_ray", test_bvh_query_ray, devices=devices)
 add_function_test(TestBvh, "test_gh_288", test_gh_288, devices=devices)
 
+add_function_test(TestBvh, "test_capture_bvh_rebuild", test_capture_bvh_rebuild, devices=cuda_devices)
+
 if __name__ == "__main__":
     wp.clear_kernel_cache()
     unittest.main(verbosity=2)
diff --git a/warp/tests/interop/test_jax.py b/warp/tests/interop/test_jax.py
index eff43ed5..861b0ce2 100644
--- a/warp/tests/interop/test_jax.py
+++ b/warp/tests/interop/test_jax.py
@@ -432,6 +432,15 @@ def in_out_func(
     wp.launch(accum_kernel, dim=a.size, inputs=[a, b])  # modifies `b`
 
 
+def double_func(
+    # inputs
+    a: wp.array(dtype=float),
+    # outputs
+    b: wp.array(dtype=float),
+):
+    wp.launch(scale_kernel, dim=a.shape, inputs=[a, 2.0], outputs=[b])
+
+
 @unittest.skipUnless(_jax_version() >= (0, 5, 0), "Jax version too old")
 def test_ffi_jax_kernel_add(test, device):
     # two inputs and one output
@@ -736,6 +745,238 @@ def test_ffi_jax_callable_in_out(test, device):
     assert_np_equal(c, np.full(10, 2, dtype=np.float32))
 
 
+@unittest.skipUnless(_jax_version() >= (0, 5, 0), "Jax version too old")
+def test_ffi_jax_callable_graph_cache(test, device):
+    # test graph caching limits
+    import jax
+    import jax.numpy as jp
+
+    from warp.jax_experimental.ffi import GraphMode, clear_jax_callable_graph_cache, jax_callable
+
+    # --- test with default cache settings ---
+
+    jax_double = jax_callable(double_func, graph_mode=GraphMode.WARP)
+    f = jax.jit(jax_double)
+    arrays = []
+
+    test.assertEqual(jax_double.graph_cache_max, wp.jax_experimental.ffi.jax_callable_default_graph_cache_max)
+
+    with jax.default_device(wp.device_to_jax(device)):
+        for i in range(10):
+            n = 10 + i
+            a = jp.arange(n, dtype=jp.float32)
+            (b,) = f(a)
+
+            assert_np_equal(b, 2 * np.arange(n, dtype=np.float32))
+
+            # ensure graph cache is always growing
+            test.assertEqual(jax_double.graph_cache_size, i + 1)
+
+            # keep JAX array alive to prevent the memory from being reused, thus forcing a new graph capture each time
+            arrays.append(a)
+
+    # --- test clearing one callable's cache ---
+
+    clear_jax_callable_graph_cache(jax_double)
+
+    test.assertEqual(jax_double.graph_cache_size, 0)
+
+    # --- test with a custom cache limit ---
+
+    graph_cache_max = 5
+    jax_double = jax_callable(double_func, graph_mode=GraphMode.WARP, graph_cache_max=graph_cache_max)
+    f = jax.jit(jax_double)
+    arrays = []
+
+    test.assertEqual(jax_double.graph_cache_max, graph_cache_max)
+
+    with jax.default_device(wp.device_to_jax(device)):
+        for i in range(10):
+            n = 10 + i
+            a = jp.arange(n, dtype=jp.float32)
+            (b,) = f(a)
+
+            assert_np_equal(b, 2 * np.arange(n, dtype=np.float32))
+
+            # ensure graph cache size is capped
+            test.assertEqual(jax_double.graph_cache_size, min(i + 1, graph_cache_max))
+
+            # keep JAX array alive to prevent the memory from being reused, thus forcing a new graph capture
+            arrays.append(a)
+
+    # --- test clearing all callables' caches ---
+
+    clear_jax_callable_graph_cache()
+
+    with wp.jax_experimental.ffi._FFI_REGISTRY_LOCK:
+        for c in wp.jax_experimental.ffi._FFI_CALLABLE_REGISTRY.values():
+            test.assertEqual(c.graph_cache_size, 0)
+
+    # --- test with a custom default cache limit ---
+
+    saved_max = wp.jax_experimental.ffi.jax_callable_default_graph_cache_max
+    try:
+        wp.jax_experimental.ffi.jax_callable_default_graph_cache_max = 5
+        jax_double = jax_callable(double_func, graph_mode=GraphMode.WARP)
+        f = jax.jit(jax_double)
+        arrays = []
+
+        test.assertEqual(jax_double.graph_cache_max, wp.jax_experimental.ffi.jax_callable_default_graph_cache_max)
+
+        with jax.default_device(wp.device_to_jax(device)):
+            for i in range(10):
+                n = 10 + i
+                a = jp.arange(n, dtype=jp.float32)
+                (b,) = f(a)
+
+                assert_np_equal(b, 2 * np.arange(n, dtype=np.float32))
+
+                # ensure graph cache size is capped
+                test.assertEqual(
+                    jax_double.graph_cache_size,
+                    min(i + 1, wp.jax_experimental.ffi.jax_callable_default_graph_cache_max),
+                )
+
+                # keep JAX array alive to prevent the memory from being reused, thus forcing a new graph capture
+                arrays.append(a)
+
+        clear_jax_callable_graph_cache()
+
+    finally:
+        wp.jax_experimental.ffi.jax_callable_default_graph_cache_max = saved_max
+
+
+@unittest.skipUnless(_jax_version() >= (0, 5, 0), "Jax version too old")
+def test_ffi_jax_callable_pmap_mul_forward(test, device):
+    import jax
+    import jax.numpy as jp
+
+    from warp.jax_experimental.ffi import jax_callable
+
+    if jax.local_device_count() < 2:
+        test.skipTest("requires >= 2 local devices")
+
+    @wp.kernel
+    def mul2(a: wp.array(dtype=float), out: wp.array(dtype=float)):
+        tid = wp.tid()
+        out[tid] = 2.0 * a[tid]
+
+    def mul2_py(a: wp.array(dtype=float), out: wp.array(dtype=float)):
+        wp.launch(mul2, dim=a.shape, inputs=[a], outputs=[out])
+
+    j = jax_callable(mul2_py, num_outputs=1)
+
+    per_device = 8
+    ndev = jax.local_device_count()
+    x = jp.arange(ndev * per_device, dtype=jp.float32).reshape((ndev, per_device))
+
+    def per_device_fwd(v):
+        (y,) = j(v)
+        return y
+
+    y = jax.pmap(per_device_fwd)(x)
+    test.assertTrue(np.allclose(np.asarray(y), 2.0 * np.asarray(x), rtol=1e-5, atol=1e-6))
+
+
+@unittest.skipUnless(_jax_version() >= (0, 5, 0), "Jax version too old")
+def test_ffi_jax_callable_pmap_multi_output_forward(test, device):
+    import jax
+    import jax.numpy as jp
+
+    from warp.jax_experimental.ffi import jax_callable
+
+    if jax.local_device_count() < 2:
+        test.skipTest("requires >= 2 local devices")
+
+    @wp.kernel
+    def multi_out(
+        a: wp.array(dtype=float), b: wp.array(dtype=float), s: float, c: wp.array(dtype=float), d: wp.array(dtype=float)
+    ):
+        tid = wp.tid()
+        c[tid] = a[tid] + b[tid]
+        d[tid] = s * a[tid]
+
+    def multi_out_py(
+        a: wp.array(dtype=float),
+        b: wp.array(dtype=float),
+        s: float,
+        c: wp.array(dtype=float),
+        d: wp.array(dtype=float),
+    ):
+        wp.launch(multi_out, dim=a.shape, inputs=[a, b, s], outputs=[c, d])
+
+    j = jax_callable(multi_out_py, num_outputs=2)
+
+    per_device = 7
+    ndev = jax.local_device_count()
+    a = jp.arange(ndev * per_device, dtype=jp.float32).reshape((ndev, per_device))
+    b = jp.ones((ndev, per_device), dtype=jp.float32)
+    s = 3.0
+
+    def per_device_fwd(aa, bb):
+        c, d = j(aa, bb, s)
+        return c + d  # simple combine to exercise both outputs
+
+    out = jax.pmap(per_device_fwd)(a, b)
+
+    a_np = np.arange(ndev * per_device, dtype=np.float32).reshape((ndev, per_device))
+    b_np = np.ones((ndev, per_device), dtype=np.float32)
+    ref = (a_np + b_np) + s * a_np
+    test.assertTrue(np.allclose(np.asarray(out), ref, rtol=1e-5, atol=1e-6))
+
+
+@unittest.skipUnless(_jax_version() >= (0, 5, 0), "Jax version too old")
+def test_ffi_jax_callable_pmap_multi_stage_forward(test, device):
+    import jax
+    import jax.numpy as jp
+
+    from warp.jax_experimental.ffi import jax_callable
+
+    if jax.local_device_count() < 2:
+        test.skipTest("requires >= 2 local devices")
+
+    @wp.kernel
+    def add_kernel(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):
+        tid = wp.tid()
+        out[tid] = a[tid] + b[tid]
+
+    @wp.kernel
+    def axpy_kernel(x: wp.array(dtype=float), y: wp.array(dtype=float), alpha: float, out: wp.array(dtype=float)):
+        tid = wp.tid()
+        out[tid] = alpha * x[tid] + y[tid]
+
+    def multi_stage_py(
+        a: wp.array(dtype=float),
+        b: wp.array(dtype=float),
+        alpha: float,
+        tmp: wp.array(dtype=float),
+        out: wp.array(dtype=float),
+    ):
+        wp.launch(add_kernel, dim=a.shape, inputs=[a, b], outputs=[tmp])
+        wp.launch(axpy_kernel, dim=a.shape, inputs=[tmp, b, alpha], outputs=[out])
+
+    j = jax_callable(multi_stage_py, num_outputs=2)
+
+    per_device = 9
+    ndev = jax.local_device_count()
+    a = jp.arange(ndev * per_device, dtype=jp.float32).reshape((ndev, per_device))
+    b = jp.ones((ndev, per_device), dtype=jp.float32)
+    alpha = 2.5
+
+    def per_device_fwd(aa, bb):
+        tmp, out = j(aa, bb, alpha)
+        return tmp + out
+
+    combined = jax.pmap(per_device_fwd)(a, b)
+
+    a_np = np.arange(ndev * per_device, dtype=np.float32).reshape((ndev, per_device))
+    b_np = np.ones((ndev, per_device), dtype=np.float32)
+    tmp_ref = a_np + b_np
+    out_ref = alpha * (a_np + b_np) + b_np
+    ref = tmp_ref + out_ref
+    test.assertTrue(np.allclose(np.asarray(combined), ref, rtol=1e-5, atol=1e-6))
+
+
 @unittest.skipUnless(_jax_version() >= (0, 5, 0), "Jax version too old")
 def test_ffi_callback(test, device):
     # in-out arguments
@@ -936,6 +1177,30 @@ try:
         add_function_test(
             TestJax, "test_ffi_jax_callable_in_out", test_ffi_jax_callable_in_out, devices=jax_compatible_cuda_devices
         )
+        add_function_test(
+            TestJax,
+            "test_ffi_jax_callable_graph_cache",
+            test_ffi_jax_callable_graph_cache,
+            devices=jax_compatible_cuda_devices,
+        )
+        add_function_test(
+            TestJax,
+            "test_ffi_jax_callable_pmap_multi_output_forward",
+            test_ffi_jax_callable_pmap_multi_output_forward,
+            devices=jax_compatible_cuda_devices,
+        )
+        add_function_test(
+            TestJax,
+            "test_ffi_jax_callable_pmap_mul_forward",
+            test_ffi_jax_callable_pmap_mul_forward,
+            devices=jax_compatible_cuda_devices,
+        )
+        add_function_test(
+            TestJax,
+            "test_ffi_jax_callable_pmap_multi_stage_forward",
+            test_ffi_jax_callable_pmap_multi_stage_forward,
+            devices=jax_compatible_cuda_devices,
+        )
 
         # ffi callback tests
         add_function_test(TestJax, "test_ffi_callback", test_ffi_callback, devices=jax_compatible_cuda_devices)
diff --git a/warp/tests/interop/test_paddle.py b/warp/tests/interop/test_paddle.py
index 8464a55b..71df40cd 100644
--- a/warp/tests/interop/test_paddle.py
+++ b/warp/tests/interop/test_paddle.py
@@ -213,7 +213,7 @@ def test_from_paddle(test, device):
     def wrap_vec_tensor_with_grad(n, desired_warp_dtype):
         t = paddle.zeros((10, n), dtype=paddle.float32).to(device=paddle_device)
         a = wp.from_paddle(t, desired_warp_dtype)
-        a.reuqires_grad = True
+        a.requires_grad = True
         assert a.dtype == desired_warp_dtype
         assert a.shape == (10,)
 
diff --git a/warp/tests/sim/__init__.py b/warp/tests/sim/__init__.py
deleted file mode 100644
index e69de29b..00000000
diff --git a/warp/tests/sim/disabled_kinematics.py b/warp/tests/sim/disabled_kinematics.py
deleted file mode 100644
index 2a145ca7..00000000
--- a/warp/tests/sim/disabled_kinematics.py
+++ /dev/null
@@ -1,244 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-import math
-import unittest
-
-import warp as wp
-import warp.examples
-import warp.sim
-from warp.tests.unittest_utils import *
-
-
-def build_ant(num_envs):
-    builder = wp.sim.ModelBuilder()
-    for i in range(num_envs):
-        wp.sim.parse_mjcf(os.path.join(warp.examples.get_asset_directory(), "nv_ant.xml"), builder, up_axis="y")
-
-        coord_count = 15
-        dof_count = 14
-
-        coord_start = i * coord_count
-        dof_start = i * dof_count
-
-        # base
-        p = [i * 2.0, 0.70, 0.0]
-        q = wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), -math.pi * 0.5)
-        builder.joint_q[coord_start : coord_start + 3] = p
-        builder.joint_q[coord_start + 3 : coord_start + 7] = q
-
-        # joints
-        builder.joint_q[coord_start + 7 : coord_start + coord_count] = [0.0, 1.0, 0.0, -1.0, 0.0, -1.0, 0.0, 1.0]
-        builder.joint_qd[dof_start + 6 : dof_start + dof_count] = [1.0, 1.0, 1.0, -1.0, 1.0, -1.0, 1.0, 1.0]
-
-    return builder
-
-
-def build_complex_joint_mechanism(chain_length):
-    builder = wp.sim.ModelBuilder()
-    com0 = wp.vec3(1.0, 2.0, 3.0)
-    com1 = wp.vec3(4.0, 5.0, 6.0)
-    com2 = wp.vec3(7.0, 8.0, 9.0)
-    ax0 = wp.normalize(wp.vec3(-1.0, 2.0, 3.0))
-    ax1 = wp.normalize(wp.vec3(4.0, -1.0, 2.0))
-    ax2 = wp.normalize(wp.vec3(-3.0, 4.0, -1.0))
-    # declare some transforms with nonzero translation and orientation
-    tf0 = wp.transform(wp.vec3(1.0, 2.0, 3.0), wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), math.pi * 0.25))
-    tf1 = wp.transform(wp.vec3(4.0, 5.0, 6.0), wp.quat_from_axis_angle(wp.vec3(0.0, 1.0, 0.0), math.pi * 0.5))
-    tf2 = wp.transform(wp.vec3(7.0, 8.0, 9.0), wp.quat_from_axis_angle(wp.vec3(0.0, 0.0, 1.0), math.pi * 0.75))
-
-    parent = -1
-    for _i in range(chain_length):
-        b0 = builder.add_body(com=com0)
-        builder.add_joint_fixed(parent=parent, child=b0, parent_xform=tf1, child_xform=tf0)
-        assert builder.articulation_count == 1
-
-        b1 = builder.add_body(com=com1)
-        builder.add_joint_revolute(parent=b0, child=b1, parent_xform=tf1, child_xform=tf2, axis=ax1)
-        builder.joint_q[-1] = 0.3
-        builder.joint_qd[-1] = 1.0
-
-        b2 = builder.add_body(com=com2)
-        builder.add_joint_universal(parent=b1, child=b2, parent_xform=tf2, child_xform=tf0, axis_0=ax0, axis_1=ax1)
-        builder.joint_q[-2:] = [0.3, 0.5]
-        builder.joint_qd[-2:] = [1.0, -1.0]
-
-        b3 = builder.add_body(com=com0)
-        builder.add_joint_ball(parent=b2, child=b3, parent_xform=tf0, child_xform=tf1)
-        builder.joint_q[-4:] = list(wp.quat_from_axis_angle(ax0, 0.7))
-        builder.joint_qd[-3:] = [1.0, -0.6, 1.5]
-
-        b4 = builder.add_body(com=com1)
-        builder.add_joint_compound(
-            parent=b3,
-            child=b4,
-            parent_xform=tf2,
-            child_xform=tf1,
-            axis_0=(0, 0, 1),
-            axis_1=(1, 0, 0),
-            axis_2=(0, 1, 0),
-        )
-        builder.joint_q[-3:] = [0.3, 0.5, 0.27]
-        builder.joint_qd[-3:] = [1.23, -1.0, 0.5]
-
-        b5 = builder.add_body(com=com2)
-        builder.add_joint_prismatic(
-            parent=b4,
-            child=b5,
-            parent_xform=tf2,
-            child_xform=tf0,
-            axis=ax0,
-        )
-        builder.joint_q[-1] = 0.92
-        builder.joint_qd[-1] = -0.63
-
-        b6 = builder.add_body(com=com0)
-        builder.add_joint_d6(
-            parent=b5,
-            child=b6,
-            parent_xform=tf0,
-            child_xform=tf2,
-            linear_axes=[ax0, ax1, wp.cross(ax0, ax1)],
-            angular_axes=[ax1, ax2, wp.cross(ax1, ax2)],
-        )
-        builder.joint_q[-6:] = [0.3, 0.5, 0.7, 0.9, 1.1, 1.3]
-        builder.joint_qd[-6:] = [1.0, -1.0, 0.5, 0.8, -0.3, 0.1]
-
-        b7 = builder.add_body(com=com1)
-        builder.add_joint_free(
-            parent=b6,
-            child=b7,
-            parent_xform=tf1,
-            child_xform=tf2,
-        )
-        builder.joint_q[-7:] = [0.5, -0.9, 1.4, *wp.quat_rpy(0.3, -0.5, 0.7)]
-        builder.joint_qd[-6:] = [1.0, -1.0, 0.5, 0.8, -0.3, 0.1]
-
-        b8 = builder.add_body(com=com2)
-        builder.add_joint_distance(
-            parent=b7,
-            child=b8,
-            parent_xform=tf1,
-            child_xform=tf2,
-        )
-        builder.joint_q[-7:] = [-0.3, -0.7, 0.2, *wp.quat_rpy(0.1, 0.1, 0.4)]
-        builder.joint_qd[-6:] = [-0.34, 0.5, -0.6, -0.4, 0.2, 0.1]
-
-        # D6 joint that behaves like a fixed joint
-        b9 = builder.add_body(com=com0)
-        builder.add_joint_d6(
-            parent=b8,
-            child=b9,
-            parent_xform=tf0,
-            child_xform=tf2,
-            linear_axes=[],
-            angular_axes=[],
-        )
-
-        b10 = builder.add_body(com=com0)
-        builder.add_joint_d6(
-            parent=b9,
-            child=b10,
-            parent_xform=tf1,
-            child_xform=tf2,
-            linear_axes=[ax1],
-            angular_axes=[ax2, ax0],
-        )
-        builder.joint_q[-3:] = [0.3, 0.5, 0.7]
-        builder.joint_qd[-3:] = [1.0, -1.0, 0.5]
-
-        b11 = builder.add_body(com=com1)
-        builder.add_joint_d6(
-            parent=b10,
-            child=b11,
-            parent_xform=tf1,
-            child_xform=tf2,
-            linear_axes=[ax1, ax0, wp.cross(ax1, ax0)],
-            angular_axes=[],
-        )
-        builder.joint_q[-3:] = [0.3, 0.5, 0.7]
-        builder.joint_qd[-3:] = [1.0, -1.0, 0.5]
-
-        b12 = builder.add_body(com=com2)
-        builder.add_joint_d6(
-            parent=b11,
-            child=b12,
-            parent_xform=tf1,
-            child_xform=tf2,
-            linear_axes=[],
-            angular_axes=[ax1, ax2, wp.cross(ax1, ax2)],
-        )
-        builder.joint_q[-3:] = [0.3, 0.5, 0.7]
-        builder.joint_qd[-3:] = [1.0, -1.0, 0.5]
-
-        parent = b12
-
-    return builder
-
-
-def check_fk_ik(builder, device):
-    model = builder.finalize(device)
-    state = model.state()
-
-    q_fk = model.joint_q.numpy()
-    qd_fk = model.joint_qd.numpy()
-
-    wp.sim.eval_fk(model, model.joint_q, model.joint_qd, None, state)
-
-    q_ik = wp.zeros_like(model.joint_q)
-    qd_ik = wp.zeros_like(model.joint_qd)
-
-    wp.sim.eval_ik(model, state, q_ik, qd_ik)
-
-    # adjust numpy print settings
-    # np.set_printoptions(precision=4, floatmode="fixed", suppress=True)
-    # print("q:")
-    # print(np.array(q_fk))
-    # print(q_ik.numpy())
-
-    # print("qd:")
-    # print(np.array(qd_fk))
-    # print(qd_ik.numpy())
-
-    assert_np_equal(q_ik.numpy(), q_fk, tol=1e-4)
-    assert_np_equal(qd_ik.numpy(), qd_fk, tol=1e-4)
-
-
-def test_fk_ik_ant(test, device):
-    builder = build_ant(3)
-    check_fk_ik(builder, device)
-
-
-def test_fk_ik_complex_joint_mechanism(test, device):
-    builder = build_complex_joint_mechanism(2)
-    check_fk_ik(builder, device)
-
-
-devices = get_test_devices()
-
-
-class TestKinematics(unittest.TestCase):
-    pass
-
-
-add_function_test(TestKinematics, "test_fk_ik_ant", test_fk_ik_ant, devices=devices)
-add_function_test(
-    TestKinematics, "test_fk_ik_complex_joint_mechanism", test_fk_ik_complex_joint_mechanism, devices=devices
-)
-
-
-if __name__ == "__main__":
-    wp.clear_kernel_cache()
-    unittest.main(verbosity=2, failfast=False)
diff --git a/warp/tests/sim/test_cloth.py b/warp/tests/sim/test_cloth.py
deleted file mode 100644
index 9a460462..00000000
--- a/warp/tests/sim/test_cloth.py
+++ /dev/null
@@ -1,863 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2024 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-import unittest
-from functools import partial
-
-import numpy as np
-
-import warp as wp
-import warp.sim
-import warp.sim.integrator
-import warp.sim.integrator_euler
-import warp.sim.integrator_vbd
-import warp.sim.integrator_xpbd
-import warp.sim.particles
-import warp.sim.render
-from warp.sim.model import PARTICLE_FLAG_ACTIVE
-from warp.tests.unittest_utils import *
-
-# fmt: off
-CLOTH_POINTS = [
-    (-50.0000000, 0.0000000, -50.0000000),
-    (-38.8888893, 11.1111107, -50.0000000),
-    (-27.7777786, 22.2222214, -50.0000000),
-    (-16.6666679, 33.3333321, -50.0000000),
-    (-5.5555558, 44.4444427, -50.0000000),
-    (5.5555558, 55.5555573, -50.0000000),
-    (16.6666679, 66.6666641, -50.0000000),
-    (27.7777786, 77.7777786, -50.0000000),
-    (38.8888893, 88.8888855, -50.0000000),
-    (50.0000000, 100.0000000, -50.0000000),
-    (-50.0000000, 0.0000000, -38.8888893),
-    (-38.8888893, 11.1111107, -38.8888893),
-    (-27.7777786, 22.2222214, -38.8888893),
-    (-16.6666679, 33.3333321, -38.8888893),
-    (-5.5555558, 44.4444427, -38.8888893),
-    (5.5555558, 55.5555573, -38.8888893),
-    (16.6666679, 66.6666641, -38.8888893),
-    (27.7777786, 77.7777786, -38.8888893),
-    (38.8888893, 88.8888855, -38.8888893),
-    (50.0000000, 100.0000000, -38.8888893),
-    (-50.0000000, 0.0000000, -27.7777786),
-    (-38.8888893, 11.1111107, -27.7777786),
-    (-27.7777786, 22.2222214, -27.7777786),
-    (-16.6666679, 33.3333321, -27.7777786),
-    (-5.5555558, 44.4444427, -27.7777786),
-    (5.5555558, 55.5555573, -27.7777786),
-    (16.6666679, 66.6666641, -27.7777786),
-    (27.7777786, 77.7777786, -27.7777786),
-    (38.8888893, 88.8888855, -27.7777786),
-    (50.0000000, 100.0000000, -27.7777786),
-    (-50.0000000, 0.0000000, -16.6666679),
-    (-38.8888893, 11.1111107, -16.6666679),
-    (-27.7777786, 22.2222214, -16.6666679),
-    (-16.6666679, 33.3333321, -16.6666679),
-    (-5.5555558, 44.4444427, -16.6666679),
-    (5.5555558, 55.5555573, -16.6666679),
-    (16.6666679, 66.6666641, -16.6666679),
-    (27.7777786, 77.7777786, -16.6666679),
-    (38.8888893, 88.8888855, -16.6666679),
-    (50.0000000, 100.0000000, -16.6666679),
-    (-50.0000000, 0.0000000, -5.5555558),
-    (-38.8888893, 11.1111107, -5.5555558),
-    (-27.7777786, 22.2222214, -5.5555558),
-    (-16.6666679, 33.3333321, -5.5555558),
-    (-5.5555558, 44.4444427, -5.5555558),
-    (5.5555558, 55.5555573, -5.5555558),
-    (16.6666679, 66.6666641, -5.5555558),
-    (27.7777786, 77.7777786, -5.5555558),
-    (38.8888893, 88.8888855, -5.5555558),
-    (50.0000000, 100.0000000, -5.5555558),
-    (-50.0000000, 0.0000000, 5.5555558),
-    (-38.8888893, 11.1111107, 5.5555558),
-    (-27.7777786, 22.2222214, 5.5555558),
-    (-16.6666679, 33.3333321, 5.5555558),
-    (-5.5555558, 44.4444427, 5.5555558),
-    (5.5555558, 55.5555573, 5.5555558),
-    (16.6666679, 66.6666641, 5.5555558),
-    (27.7777786, 77.7777786, 5.5555558),
-    (38.8888893, 88.8888855, 5.5555558),
-    (50.0000000, 100.0000000, 5.5555558),
-    (-50.0000000, 0.0000000, 16.6666679),
-    (-38.8888893, 11.1111107, 16.6666679),
-    (-27.7777786, 22.2222214, 16.6666679),
-    (-16.6666679, 33.3333321, 16.6666679),
-    (-5.5555558, 44.4444427, 16.6666679),
-    (5.5555558, 55.5555573, 16.6666679),
-    (16.6666679, 66.6666641, 16.6666679),
-    (27.7777786, 77.7777786, 16.6666679),
-    (38.8888893, 88.8888855, 16.6666679),
-    (50.0000000, 100.0000000, 16.6666679),
-    (-50.0000000, 0.0000000, 27.7777786),
-    (-38.8888893, 11.1111107, 27.7777786),
-    (-27.7777786, 22.2222214, 27.7777786),
-    (-16.6666679, 33.3333321, 27.7777786),
-    (-5.5555558, 44.4444427, 27.7777786),
-    (5.5555558, 55.5555573, 27.7777786),
-    (16.6666679, 66.6666641, 27.7777786),
-    (27.7777786, 77.7777786, 27.7777786),
-    (38.8888893, 88.8888855, 27.7777786),
-    (50.0000000, 100.0000000, 27.7777786),
-    (-50.0000000, 0.0000000, 38.8888893),
-    (-38.8888893, 11.1111107, 38.8888893),
-    (-27.7777786, 22.2222214, 38.8888893),
-    (-16.6666679, 33.3333321, 38.8888893),
-    (-5.5555558, 44.4444427, 38.8888893),
-    (5.5555558, 55.5555573, 38.8888893),
-    (16.6666679, 66.6666641, 38.8888893),
-    (27.7777786, 77.7777786, 38.8888893),
-    (38.8888893, 88.8888855, 38.8888893),
-    (50.0000000, 100.0000000, 38.8888893),
-    (-50.0000000, 0.0000000, 50.0000000),
-    (-38.8888893, 11.1111107, 50.0000000),
-    (-27.7777786, 22.2222214, 50.0000000),
-    (-16.6666679, 33.3333321, 50.0000000),
-    (-5.5555558, 44.4444427, 50.0000000),
-    (5.5555558, 55.5555573, 50.0000000),
-    (16.6666679, 66.6666641, 50.0000000),
-    (27.7777786, 77.7777786, 50.0000000),
-    (38.8888893, 88.8888855, 50.0000000),
-    (50.0000000, 100.0000000, 50.0000000),
-]
-
-CLOTH_FACES = [
-    1, 12, 2,
-    1, 11, 12,
-    2, 12, 3,
-    12, 13, 3,
-    3, 14, 4,
-    3, 13, 14,
-    4, 14, 5,
-    14, 15, 5,
-    5, 16, 6,
-    5, 15, 16,
-    6, 16, 7,
-    16, 17, 7,
-    7, 18, 8,
-    7, 17, 18,
-    8, 18, 9,
-    18, 19, 9,
-    9, 20, 10,
-    9, 19, 20,
-    11, 21, 12,
-    21, 22, 12,
-    12, 23, 13,
-    12, 22, 23,
-    13, 23, 14,
-    23, 24, 14,
-    14, 25, 15,
-    14, 24, 25,
-    15, 25, 16,
-    25, 26, 16,
-    16, 27, 17,
-    16, 26, 27,
-    17, 27, 18,
-    27, 28, 18,
-    18, 29, 19,
-    18, 28, 29,
-    19, 29, 20,
-    29, 30, 20,
-    21, 32, 22,
-    21, 31, 32,
-    22, 32, 23,
-    32, 33, 23,
-    23, 34, 24,
-    23, 33, 34,
-    24, 34, 25,
-    34, 35, 25,
-    25, 36, 26,
-    25, 35, 36,
-    26, 36, 27,
-    36, 37, 27,
-    27, 38, 28,
-    27, 37, 38,
-    28, 38, 29,
-    38, 39, 29,
-    29, 40, 30,
-    29, 39, 40,
-    31, 41, 32,
-    41, 42, 32,
-    32, 43, 33,
-    32, 42, 43,
-    33, 43, 34,
-    43, 44, 34,
-    34, 45, 35,
-    34, 44, 45,
-    35, 45, 36,
-    45, 46, 36,
-    36, 47, 37,
-    36, 46, 47,
-    37, 47, 38,
-    47, 48, 38,
-    38, 49, 39,
-    38, 48, 49,
-    39, 49, 40,
-    49, 50, 40,
-    41, 52, 42,
-    41, 51, 52,
-    42, 52, 43,
-    52, 53, 43,
-    43, 54, 44,
-    43, 53, 54,
-    44, 54, 45,
-    54, 55, 45,
-    45, 56, 46,
-    45, 55, 56,
-    46, 56, 47,
-    56, 57, 47,
-    47, 58, 48,
-    47, 57, 58,
-    48, 58, 49,
-    58, 59, 49,
-    49, 60, 50,
-    49, 59, 60,
-    51, 61, 52,
-    61, 62, 52,
-    52, 63, 53,
-    52, 62, 63,
-    53, 63, 54,
-    63, 64, 54,
-    54, 65, 55,
-    54, 64, 65,
-    55, 65, 56,
-    65, 66, 56,
-    56, 67, 57,
-    56, 66, 67,
-    57, 67, 58,
-    67, 68, 58,
-    58, 69, 59,
-    58, 68, 69,
-    59, 69, 60,
-    69, 70, 60,
-    61, 72, 62,
-    61, 71, 72,
-    62, 72, 63,
-    72, 73, 63,
-    63, 74, 64,
-    63, 73, 74,
-    64, 74, 65,
-    74, 75, 65,
-    65, 76, 66,
-    65, 75, 76,
-    66, 76, 67,
-    76, 77, 67,
-    67, 78, 68,
-    67, 77, 78,
-    68, 78, 69,
-    78, 79, 69,
-    69, 80, 70,
-    69, 79, 80,
-    71, 81, 72,
-    81, 82, 72,
-    72, 83, 73,
-    72, 82, 83,
-    73, 83, 74,
-    83, 84, 74,
-    74, 85, 75,
-    74, 84, 85,
-    75, 85, 76,
-    85, 86, 76,
-    76, 87, 77,
-    76, 86, 87,
-    77, 87, 78,
-    87, 88, 78,
-    78, 89, 79,
-    78, 88, 89,
-    79, 89, 80,
-    89, 90, 80,
-    81, 92, 82,
-    81, 91, 92,
-    82, 92, 83,
-    92, 93, 83,
-    83, 94, 84,
-    83, 93, 94,
-    84, 94, 85,
-    94, 95, 85,
-    85, 96, 86,
-    85, 95, 96,
-    86, 96, 87,
-    96, 97, 87,
-    87, 98, 88,
-    87, 97, 98,
-    88, 98, 89,
-    98, 99, 89,
-    89, 100, 90,
-    89, 99, 100
-]
-
-# fmt: on
-class ClothSim:
-    def __init__(self, device, solver, use_cuda_graph=False, do_rendering=False):
-        self.frame_dt = 1 / 60
-        self.num_test_frames = 50
-        self.iterations = 5
-        self.do_rendering = do_rendering
-        self.device = device
-        self.use_cuda_graph = self.device.is_cuda and use_cuda_graph
-        self.builder = wp.sim.ModelBuilder()
-        self.solver = solver
-        self.renderer_scale_factor = 1.0
-
-        if solver != "semi_implicit":
-            self.num_substeps = 10
-        else:
-            self.num_substeps = 32
-        self.dt = self.frame_dt / self.num_substeps
-
-    def set_up_sagging_experiment(self):
-        self.input_scale_factor = 1.0
-        self.renderer_scale_factor = 0.01
-        vertices = [wp.vec3(v) * self.input_scale_factor for v in CLOTH_POINTS]
-        faces_flatten = [fv - 1 for fv in CLOTH_FACES]
-
-        kd = 1.0e-7
-
-        if self.solver != "semi_implicit":
-            stretching_stiffness = 1e4
-            spring_ke = 1e3
-            bending_ke = 10
-        else:
-            stretching_stiffness = 1e5
-            spring_ke = 1e2
-            bending_ke = 0.0
-
-        self.builder.add_cloth_mesh(
-            pos=wp.vec3(0.0, 0.0, 0.0),
-            rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), 0.0),
-            scale=1.0,
-            vertices=vertices,
-            indices=faces_flatten,
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            density=0.1,
-            tri_ke=stretching_stiffness,
-            tri_ka=stretching_stiffness,
-            tri_kd=kd,
-            edge_ke=bending_ke,
-            add_springs=self.solver == "xpbd",
-            spring_ke=spring_ke,
-            spring_kd=0.0,
-        )
-
-        self.fixed_particles = [0, 9]
-
-        self.finalize(ground=False)
-
-        self.state1.particle_q.fill_(0.0)
-
-    def set_up_bending_experiment(self):
-        stretching_stiffness = 1e4
-        stretching_damping = 1e-6
-        bending_damping = 1e-3
-        # fmt: off
-        vs = [[-6.0, 0.0, -6.0], [-3.6, 0.0, -6.0], [-1.2, 0.0, -6.0], [1.2, 0.0, -6.0], [3.6, 0.0, -6.0], [6.0, 0.0, -6.0],
-         [-6.0, 0.0, -3.6], [-3.6, 0.0, -3.6], [-1.2, 0.0, -3.6], [1.2, 0.0, -3.6], [3.6, 0.0, -3.6], [6.0, 0.0, -3.6],
-         [-6.0, 0.0, -1.2], [-3.6, 0.0, -1.2], [-1.2, 0.0, -1.2], [1.2, 0.0, -1.2], [3.6, 0.0, -1.2], [6.0, 0.0, -1.2],
-         [-6.0, 0.0, 1.2], [-3.6, 0.0, 1.2], [-1.2, 0.0, 1.2], [1.2, 0.0, 1.2], [3.6, 0.0, 1.2], [6.0, 0.0, 1.2],
-         [-6.0, 0.0, 3.6], [-3.6, 0.0, 3.6], [-1.2, 0.0, 3.6], [1.2, 0.0, 3.6], [3.6, 0.0, 3.6], [6.0, 0.0, 3.6],
-         [-6.0, 0.0, 6.0], [-3.6, 0.0, 6.0], [-1.2, 0.0, 6.0], [1.2, 0.0, 6.0], [3.6, 0.0, 6.0], [6.0, 0.0, 6.0]]
-
-        fs = [0, 7, 1, 0, 6, 7, 1, 7, 2, 7, 8, 2, 2, 9, 3, 2, 8, 9, 3, 9, 4, 9, 10, 4, 4, 11, 5, 4, 10, 11, 6, 12, 7, 12, 13,
-         7, 7, 14, 8, 7, 13, 14, 8, 14, 9, 14, 15, 9, 9, 16, 10, 9, 15, 16, 10, 16, 11, 16, 17, 11, 12, 19, 13, 12, 18,
-         19, 13, 19, 14, 19, 20, 14, 14, 21, 15, 14, 20, 21, 15, 21, 16, 21, 22, 16, 16, 23, 17, 16, 22, 23, 18, 24, 19,
-         24, 25, 19, 19, 26, 20, 19, 25, 26, 20, 26, 21, 26, 27, 21, 21, 28, 22, 21, 27, 28, 22, 28, 23, 28, 29, 23, 24,
-         31, 25, 24, 30, 31, 25, 31, 26, 31, 32, 26, 26, 33, 27, 26, 32, 33, 27, 33, 28, 33, 34, 28, 28, 35, 29, 28, 34,
-         35]
-        # fmt: on
-
-        vs = [wp.vec3(v) for v in vs]
-
-        self.builder.add_cloth_mesh(
-            pos=wp.vec3(0.0, 10.0, 0.0),
-            rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), 0.0),
-            scale=1.0,
-            vertices=vs,
-            indices=fs,
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            density=0.02,
-            tri_ke=stretching_stiffness,
-            tri_ka=stretching_stiffness,
-            tri_kd=stretching_damping,
-            edge_ke=10,
-            edge_kd=bending_damping,
-            add_springs=self.solver == "xpbd",
-            spring_ke=1.0e3,
-            spring_kd=0.0,
-        )
-
-        self.builder.add_cloth_mesh(
-            pos=wp.vec3(15.0, 10.0, 0.0),
-            rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), 0.0),
-            scale=1.0,
-            vertices=vs,
-            indices=fs,
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            density=0.02,
-            tri_ke=stretching_stiffness,
-            tri_ka=stretching_stiffness,
-            tri_kd=stretching_damping,
-            edge_ke=100,
-            edge_kd=bending_damping,
-            add_springs=self.solver == "xpbd",
-            spring_ke=1.0e3,
-            spring_kd=0.0,
-        )
-
-        self.builder.add_cloth_mesh(
-            pos=wp.vec3(30.0, 10.0, 0.0),
-            rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), 0.0),
-            scale=1.0,
-            vertices=vs,
-            indices=fs,
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            density=0.02,
-            tri_ke=stretching_stiffness,
-            tri_ka=stretching_stiffness,
-            tri_kd=stretching_damping,
-            edge_ke=1000,
-            edge_kd=bending_damping,
-            add_springs=self.solver == "xpbd",
-            spring_ke=1.0e3,
-            spring_kd=0.0,
-        )
-
-        self.fixed_particles = [0, 29, 36, 65, 72, 101]
-
-        self.finalize()
-
-    def set_self_collision_experiment(self):
-        elasticity_ke = 1e4
-        elasticity_kd = 1e-6
-
-        vs1 = [wp.vec3(v) for v in [[0, 0, 0], [1, 0, 0], [1, 0, 1], [0, 0, 1]]]
-        fs1 = [0, 1, 2, 0, 2, 3]
-
-        self.builder.add_cloth_mesh(
-            pos=wp.vec3(0.0, 0.0, 0.0),
-            rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), 0.0),
-            scale=1.0,
-            vertices=vs1,
-            indices=fs1,
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            density=0.02,
-            tri_ke=elasticity_ke,
-            tri_ka=elasticity_ke,
-            tri_kd=elasticity_kd,
-            add_springs=self.solver == "xpbd",
-            spring_ke=1.0e3,
-            spring_kd=0.0,
-        )
-
-        vs2 = [wp.vec3(v) for v in [[0.3, 0, 0.7], [0.3, 0, 0.2], [0.8, 0, 0.4]]]
-        fs2 = [0, 1, 2]
-
-        self.builder.add_cloth_mesh(
-            pos=wp.vec3(0.0, 0.5, 0.0),
-            rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), 0.0),
-            scale=1.0,
-            vertices=vs2,
-            indices=fs2,
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            density=0.02,
-            tri_ke=elasticity_ke,
-            tri_ka=elasticity_ke,
-            tri_kd=elasticity_kd,
-            add_springs=self.solver == "xpbd",
-            spring_ke=1.0e3,
-            spring_kd=0.0,
-        )
-
-        self.fixed_particles = range(0, 4)
-
-        self.finalize(handle_self_contact=True, ground=False)
-        self.model.soft_contact_radius = 0.1
-        self.model.soft_contact_margin = 0.1
-        self.model.soft_contact_ke = 1e4
-        self.model.soft_contact_kd = 1e-3
-        self.model.soft_contact_mu = 0.2
-        self.model.gravity = wp.vec3(0.0, -1000.0, 0)
-        self.num_test_frames = 30
-
-    def set_body_collision_experiment(self, handle_self_contact=False):
-        self.renderer_scale_factor = 1.0
-        elasticity_ke = 1e4
-        elasticity_kd = 1e-6
-
-        vs1 = [wp.vec3(v) for v in [[0, 0, 0], [1, 0, 0], [1, 0, 1], [0, 0, 1]]]
-        fs1 = [0, 1, 2, 0, 2, 3]
-
-        self.builder.add_cloth_mesh(
-            pos=wp.vec3(0.0, 0.0, 0.0),
-            rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), 0.0),
-            scale=1.0,
-            vertices=vs1,
-            indices=fs1,
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            density=0.02,
-            tri_ke=elasticity_ke,
-            tri_ka=elasticity_ke,
-            tri_kd=elasticity_kd,
-            add_springs=self.solver == "xpbd",
-            spring_ke=1.0e3,
-            spring_kd=0.0,
-            particle_radius=0.1,
-        )
-
-        self.builder.add_shape_box(-1, pos=wp.vec3(0, -3.3, 0), hx=3, hy=3, hz=3)
-
-        self.fixed_particles = []
-
-        self.finalize(handle_self_contact=handle_self_contact, ground=False)
-        self.model.soft_contact_radius = 0.1
-        self.model.soft_contact_margin = 0.1
-        self.model.soft_contact_ke = 1e4
-        self.model.soft_contact_kd = 1e-3
-        self.model.soft_contact_mu = 0.2
-        self.model.gravity = wp.vec3(0.0, -1000.0, 0)
-        self.num_test_frames = 30
-
-    def set_up_non_zero_rest_angle_bending_experiment(self):
-        # fmt: off
-        vs =[
-            [ 0.     ,  1.     , -1.     ],
-            [ 0.     ,  1.     ,  1.     ],
-            [ 0.70711,  0.70711, -1.     ],
-            [ 0.70711,  0.70711,  1.     ],
-            [ 1.     ,  0.     , -1.     ],
-            [ 1.     , -0.     ,  1.     ],
-            [ 0.70711, -0.70711, -1.     ],
-            [ 0.70711, -0.70711,  1.     ],
-            [ 0.     , -1.     , -1.     ],
-            [ 0.     , -1.     ,  1.     ],
-            [-0.70711, -0.70711, -1.     ],
-            [-0.70711, -0.70711,  1.     ],
-            [-1.     ,  0.     , -1.     ],
-            [-1.     , -0.     ,  1.     ],
-            [-0.70711,  0.70711, -1.     ],
-            [-0.70711,  0.70711,  1.     ],
-        ]
-        fs = [
-             1,  2,  0,
-             3,  4,  2,
-             5,  6,  4,
-             7,  8,  6,
-             9, 10,  8,
-            11, 12, 10,
-             3,  5,  4,
-            13, 14, 12,
-            15,  0, 14,
-             1,  3,  2,
-             5,  7,  6,
-             7,  9,  8,
-             9, 11, 10,
-            11, 13, 12,
-            13, 15, 14,
-            15,  1,  0,
-        ]
-        # fmt: on
-
-        stretching_stiffness = 1e5
-        stretching_damping = 1e-5
-        edge_ke = 100
-        bending_damping = 1e-4
-        vs = [wp.vec3(v) for v in vs]
-
-        self.builder.add_cloth_mesh(
-            pos=wp.vec3(0.0, 0.0, 0.0),
-            rot=wp.quat_identity(),
-            scale=1.0,
-            vertices=vs,
-            indices=fs,
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            density=0.02,
-            tri_ke=stretching_stiffness,
-            tri_ka=stretching_stiffness,
-            tri_kd=stretching_damping,
-            edge_ke=edge_ke,
-            edge_kd=bending_damping,
-            add_springs=self.solver == "xpbd",
-            spring_ke=1.0e3,
-            spring_kd=0.0,
-        )
-        self.fixed_particles = [0, 1]
-
-        self.finalize(handle_self_contact=False, ground=False)
-
-    def set_free_falling_experiment(self):
-        self.input_scale_factor = 1.0
-        self.renderer_scale_factor = 0.01
-        vertices = [wp.vec3(v) * self.input_scale_factor for v in CLOTH_POINTS]
-        faces_flatten = [fv - 1 for fv in CLOTH_FACES]
-        if self.solver != "semi_implicit":
-            stretching_stiffness = 1e4
-            spring_ke = 1e3
-            bending_ke = 10
-        else:
-            stretching_stiffness = 1e2
-            spring_ke = 1e2
-            bending_ke = 10
-
-        self.builder.add_cloth_mesh(
-            vertices=vertices,
-            indices=faces_flatten,
-            scale=0.1,
-            density=2,
-            pos=wp.vec3(0.0, 4.0, 0.0),
-            rot=wp.quat_identity(),
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            edge_ke=bending_ke,
-            edge_kd=0.0,
-            tri_ke=stretching_stiffness,
-            tri_ka=stretching_stiffness,
-            tri_kd=0.0,
-            add_springs=self.solver == "xpbd",
-            spring_ke=spring_ke,
-            spring_kd=0.0,
-        )
-        self.fixed_particles = []
-        self.num_test_frames = 30
-        self.finalize(ground=False)
-
-    def finalize(self, handle_self_contact=False, ground=True):
-        self.builder.color(include_bending=True)
-
-        self.model = self.builder.finalize(device=self.device)
-        self.model.ground = ground
-        self.model.gravity = wp.vec3(0, -1000.0, 0)
-        self.model.soft_contact_ke = 1.0e4
-        self.model.soft_contact_kd = 1.0e-2
-
-        self.set_points_fixed(self.model, self.fixed_particles)
-
-        if self.solver == "vbd":
-            self.integrator = wp.sim.VBDIntegrator(self.model, self.iterations, handle_self_contact=handle_self_contact)
-        elif self.solver == "xpbd":
-            self.integrator = wp.sim.XPBDIntegrator(
-                self.iterations,
-            )
-        elif self.solver == "semi_implicit":
-            self.integrator = wp.sim.SemiImplicitIntegrator()
-        else:
-            raise ValueError("Unsupported solver type: " + self.solver)
-
-        self.state0 = self.model.state()
-        self.state1 = self.model.state()
-
-        self.init_pos = np.array(self.state0.particle_q.numpy(), copy=True)
-
-        self.graph = None
-        if self.use_cuda_graph:
-            if self.solver == "vbd":
-                wp.set_module_options({"block_dim": 256}, warp.sim.integrator_vbd)
-                wp.load_module(warp.sim.integrator_vbd, device=self.device)
-            elif self.solver == "xpbd":
-                wp.set_module_options({"block_dim": 256}, warp.sim.integrator_xpbd)
-                wp.load_module(warp.sim.integrator_xpbd, device=self.device)
-            elif self.solver == "semi_implicit":
-                wp.set_module_options({"block_dim": 256}, warp.sim.integrator_euler)
-                wp.load_module(warp.sim.integrator_euler, device=self.device)
-            wp.load_module(warp.sim.particles, device=self.device)
-            wp.load_module(warp.sim.integrator, device=self.device)
-            collide_module = importlib.import_module("warp.sim.collide")
-            wp.set_module_options({"block_dim": 256}, collide_module)
-            wp.load_module(collide_module, device=self.device)
-            wp.load_module(device=self.device)
-            with wp.ScopedCapture(device=self.device, force_module_load=False) as capture:
-                self.simulate()
-            self.graph = capture.graph
-
-    def simulate(self):
-        for _step in range(self.num_substeps):
-            self.state0.clear_forces()
-            wp.sim.collide(self.model, self.state0)
-
-            self.integrator.simulate(self.model, self.state0, self.state1, self.dt, None)
-            (self.state0, self.state1) = (self.state1, self.state0)
-
-    def run(self):
-        self.sim_time = 0.0
-
-        if self.do_rendering:
-            self.renderer = wp.sim.render.SimRendererOpenGL(self.model, "cloth_sim", scaling=self.renderer_scale_factor)
-        else:
-            self.renderer = None
-
-        for _frame in range(self.num_test_frames):
-            if self.graph:
-                wp.capture_launch(self.graph)
-            else:
-                self.simulate()
-
-                if self.renderer is not None:
-                    self.renderer.begin_frame()
-                    self.renderer.render(self.state0)
-                    self.renderer.end_frame()
-
-            self.sim_time = self.sim_time + self.frame_dt
-
-    def set_points_fixed(self, model, fixed_particles):
-        if len(fixed_particles):
-            flags = model.particle_flags.numpy()
-            for fixed_v_id in fixed_particles:
-                flags[fixed_v_id] = wp.uint32(int(flags[fixed_v_id]) & ~int(PARTICLE_FLAG_ACTIVE))
-
-            model.particle_flags = wp.array(flags, device=model.device)
-
-
-def test_cloth_sagging(test, device, solver):
-    example = ClothSim(device, solver, use_cuda_graph=True)
-    example.set_up_sagging_experiment()
-
-    initial_pos = example.state0.particle_q.numpy().copy()
-
-    example.run()
-
-    fixed_points = np.where(np.logical_not(example.model.particle_flags.numpy()))
-    # examine that the simulation does not explode
-    final_pos = example.state0.particle_q.numpy()
-    test.assertTrue((initial_pos[fixed_points, :] == final_pos[fixed_points, :]).all())
-    test.assertTrue((final_pos < 1e5).all())
-    # examine that the simulation has moved
-    test.assertTrue((example.init_pos != final_pos).any())
-
-
-def test_cloth_bending(test, device, solver):
-    example = ClothSim(device, solver, use_cuda_graph=True)
-    example.set_up_bending_experiment()
-
-    example.run()
-
-    # examine that the simulation does not explode
-    final_pos = example.state0.particle_q.numpy()
-    test.assertTrue((final_pos < 1e5).all())
-    # examine that the simulation has moved
-    test.assertTrue((example.init_pos != final_pos).any())
-
-
-def test_cloth_bending_non_zero_rest_angle_bending(test, device, solver):
-    example = ClothSim(device, solver, use_cuda_graph=True)
-    example.set_up_non_zero_rest_angle_bending_experiment()
-
-    example.run()
-
-    # examine that the simulation does not explode
-    final_pos = example.state0.particle_q.numpy()
-    test.assertTrue((np.abs(final_pos) < 1e5).all())
-    # examine that the simulation has moved
-    test.assertTrue((example.init_pos != final_pos).any())
-
-
-def test_cloth_body_collision(test, device, solver):
-    example = ClothSim(device, solver, use_cuda_graph=True)
-    example.set_body_collision_experiment(handle_self_contact=False)
-
-    example.run()
-
-    # examine that the velocity has died out
-    final_vel = example.state0.particle_qd.numpy()
-    final_pos = example.state0.particle_q.numpy()
-    test.assertTrue((np.linalg.norm(final_vel, axis=1) < 1.0).all())
-    # examine that the simulation has moved
-    test.assertTrue((example.init_pos[:, 1] != final_pos[:, 1]).any())
-
-    # run again with handle_self_contact=True
-    example = ClothSim(device, solver, use_cuda_graph=True)
-    example.set_body_collision_experiment(handle_self_contact=True)
-    example.run()
-    # examine that the velocity has died out
-    final_vel = example.state0.particle_qd.numpy()
-    final_pos = example.state0.particle_q.numpy()
-    test.assertTrue((np.linalg.norm(final_vel, axis=1) < 1.0).all())
-    # examine that the simulation has moved
-    test.assertTrue((example.init_pos[:, 1] != final_pos[:, 1]).any())
-
-
-def test_cloth_self_collision(test, device, solver):
-    example = ClothSim(device, solver, use_cuda_graph=True)
-    example.set_self_collision_experiment()
-
-    example.run()
-
-    # examine that the velocity has died out
-    final_vel = example.state0.particle_qd.numpy()
-    final_pos = example.state0.particle_q.numpy()
-    test.assertTrue((np.linalg.norm(final_vel, axis=1) < 1.0).all())
-    # examine that the simulation has moved
-    test.assertTrue((example.init_pos != final_pos).any())
-
-
-def test_cloth_free_fall(test, device, solver):
-    example = ClothSim(device, solver)
-    example.set_free_falling_experiment()
-
-    initial_pos = example.state0.particle_q.numpy().copy()
-
-    example.run()
-
-    # examine that the simulation does not explode
-    final_pos = example.state0.particle_q.numpy()
-    test.assertTrue((final_pos < 1e5).all())
-    # examine that the simulation has moved
-    test.assertTrue((example.init_pos != final_pos).any())
-
-    gravity = np.array(example.model.gravity)
-    diff = final_pos - initial_pos
-    vertical_translation_norm = diff @ gravity[..., None] / (np.linalg.norm(gravity) ** 2)
-    # ensure it's free-falling
-    test.assertTrue((np.abs(vertical_translation_norm - 0.5 * np.linalg.norm(gravity) * (example.dt**2)) < 2e-1).all())
-    horizontal_move = diff - (vertical_translation_norm * gravity)
-    # ensure its horizontal translation is minimal
-    test.assertTrue((np.abs(horizontal_move) < 1e-1).all())
-
-
-devices = get_test_devices(mode="basic")
-
-
-class TestCloth(unittest.TestCase):
-    pass
-
-
-tests_to_run = {
-    "xpbd": [
-        test_cloth_free_fall,
-        test_cloth_sagging,
-        test_cloth_bending,
-        test_cloth_bending_non_zero_rest_angle_bending,
-    ],
-    "semi_implicit": [
-        test_cloth_free_fall,
-        test_cloth_sagging,
-        test_cloth_bending,
-    ],
-    "vbd": [
-        test_cloth_free_fall,
-        test_cloth_sagging,
-        test_cloth_bending,
-        test_cloth_self_collision,
-        test_cloth_body_collision,
-        test_cloth_bending_non_zero_rest_angle_bending,
-    ],
-}
-
-for solver, tests in tests_to_run.items():
-    for test in tests:
-        add_function_test(
-            TestCloth, f"{test.__name__}_{solver}", partial(test, solver=solver), devices=devices, check_output=False
-        )
-
-
-if __name__ == "__main__":
-    wp.clear_kernel_cache()
-    unittest.main(verbosity=2, failfast=True)
diff --git a/warp/tests/sim/test_collision.py b/warp/tests/sim/test_collision.py
deleted file mode 100644
index 0e84a79e..00000000
--- a/warp/tests/sim/test_collision.py
+++ /dev/null
@@ -1,743 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2024 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-import unittest
-
-import warp as wp
-import warp.examples
-import warp.sim
-from warp.sim.collide import (
-    TriMeshCollisionDetector,
-    init_triangle_collision_data_kernel,
-    triangle_closest_point,
-    vertex_adjacent_to_triangle,
-)
-from warp.sim.integrator_euler import eval_triangles_contact
-from warp.tests.unittest_utils import *
-
-
-@wp.kernel
-def vertex_triangle_collision_detection_brute_force(
-    query_radius: float,
-    bvh_id: wp.uint64,
-    pos: wp.array(dtype=wp.vec3),
-    tri_indices: wp.array(dtype=wp.int32, ndim=2),
-    vertex_colliding_triangles: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_count: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_offsets: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_buffer_size: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_min_dist: wp.array(dtype=float),
-    triangle_colliding_vertices: wp.array(dtype=wp.int32),
-    triangle_colliding_vertices_count: wp.array(dtype=wp.int32),
-    triangle_colliding_vertices_buffer_offsets: wp.array(dtype=wp.int32),
-    triangle_colliding_vertices_buffer_sizes: wp.array(dtype=wp.int32),
-    triangle_colliding_vertices_min_dist: wp.array(dtype=float),
-    resize_flags: wp.array(dtype=wp.int32),
-):
-    v_index = wp.tid()
-    v = pos[v_index]
-
-    vertex_num_collisions = wp.int32(0)
-    min_dis_to_tris = query_radius
-    for tri_index in range(tri_indices.shape[0]):
-        t1 = tri_indices[tri_index, 0]
-        t2 = tri_indices[tri_index, 1]
-        t3 = tri_indices[tri_index, 2]
-        if vertex_adjacent_to_triangle(v_index, t1, t2, t3):
-            continue
-
-        u1 = pos[t1]
-        u2 = pos[t2]
-        u3 = pos[t3]
-
-        closest_p, bary, feature_type = triangle_closest_point(u1, u2, u3, v)
-
-        dis = wp.length(closest_p - v)
-
-        if dis < query_radius:
-            vertex_num_collisions = vertex_num_collisions + 1
-            min_dis_to_tris = wp.min(dis, min_dis_to_tris)
-
-            wp.atomic_add(triangle_colliding_vertices_count, tri_index, 1)
-            wp.atomic_min(triangle_colliding_vertices_min_dist, tri_index, dis)
-
-    vertex_colliding_triangles_count[v_index] = vertex_num_collisions
-    vertex_colliding_triangles_min_dist[v_index] = min_dis_to_tris
-
-
-@wp.kernel
-def vertex_triangle_collision_detection_brute_force_no_triangle_buffers(
-    query_radius: float,
-    bvh_id: wp.uint64,
-    pos: wp.array(dtype=wp.vec3),
-    tri_indices: wp.array(dtype=wp.int32, ndim=2),
-    vertex_colliding_triangles: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_count: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_offsets: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_buffer_size: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_min_dist: wp.array(dtype=float),
-    triangle_colliding_vertices_min_dist: wp.array(dtype=float),
-    resize_flags: wp.array(dtype=wp.int32),
-):
-    v_index = wp.tid()
-    v = pos[v_index]
-
-    vertex_num_collisions = wp.int32(0)
-    min_dis_to_tris = query_radius
-    for tri_index in range(tri_indices.shape[0]):
-        t1 = tri_indices[tri_index, 0]
-        t2 = tri_indices[tri_index, 1]
-        t3 = tri_indices[tri_index, 2]
-        if vertex_adjacent_to_triangle(v_index, t1, t2, t3):
-            continue
-
-        u1 = pos[t1]
-        u2 = pos[t2]
-        u3 = pos[t3]
-
-        closest_p, bary, feature_type = triangle_closest_point(u1, u2, u3, v)
-
-        dis = wp.length(closest_p - v)
-
-        if dis < query_radius:
-            vertex_num_collisions = vertex_num_collisions + 1
-            min_dis_to_tris = wp.min(dis, min_dis_to_tris)
-
-            wp.atomic_min(triangle_colliding_vertices_min_dist, tri_index, dis)
-
-    vertex_colliding_triangles_count[v_index] = vertex_num_collisions
-    vertex_colliding_triangles_min_dist[v_index] = min_dis_to_tris
-
-
-@wp.kernel
-def validate_vertex_collisions(
-    query_radius: float,
-    bvh_id: wp.uint64,
-    pos: wp.array(dtype=wp.vec3),
-    tri_indices: wp.array(dtype=wp.int32, ndim=2),
-    vertex_colliding_triangles: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_count: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_offsets: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_buffer_size: wp.array(dtype=wp.int32),
-    vertex_colliding_triangles_min_dist: wp.array(dtype=float),
-    resize_flags: wp.array(dtype=wp.int32),
-):
-    v_index = wp.tid()
-    v = pos[v_index]
-
-    num_cols = vertex_colliding_triangles_count[v_index]
-    offset = vertex_colliding_triangles_offsets[v_index]
-    min_dis = vertex_colliding_triangles_min_dist[v_index]
-    for col in range(vertex_colliding_triangles_buffer_size[v_index]):
-        vertex_index = vertex_colliding_triangles[2 * (offset + col)]
-        tri_index = vertex_colliding_triangles[2 * (offset + col) + 1]
-        if col < num_cols:
-            t1 = tri_indices[tri_index, 0]
-            t2 = tri_indices[tri_index, 1]
-            t3 = tri_indices[tri_index, 2]
-            # wp.expect_eq(vertex_on_triangle(v_index, t1, t2, t3), False)
-
-            u1 = pos[t1]
-            u2 = pos[t2]
-            u3 = pos[t3]
-
-            closest_p, bary, feature_type = triangle_closest_point(u1, u2, u3, v)
-            dis = wp.length(closest_p - v)
-            wp.expect_eq(dis < query_radius, True)
-            wp.expect_eq(dis >= min_dis, True)
-            wp.expect_eq(v_index == vertex_colliding_triangles[2 * (offset + col)], True)
-
-            # wp.printf("vertex %d, offset %d, num cols %d, colliding with triangle: %d, dis: %f\n",
-            #           v_index, offset, num_cols, tri_index, dis)
-        else:
-            wp.expect_eq(vertex_index == -1, True)
-            wp.expect_eq(tri_index == -1, True)
-
-
-@wp.kernel
-def validate_triangle_collisions(
-    query_radius: float,
-    bvh_id: wp.uint64,
-    pos: wp.array(dtype=wp.vec3),
-    tri_indices: wp.array(dtype=wp.int32, ndim=2),
-    triangle_colliding_vertices: wp.array(dtype=wp.int32),
-    triangle_colliding_vertices_count: wp.array(dtype=wp.int32),
-    triangle_colliding_vertices_buffer_offsets: wp.array(dtype=wp.int32),
-    triangle_colliding_vertices_buffer_sizes: wp.array(dtype=wp.int32),
-    triangle_colliding_vertices_min_dist: wp.array(dtype=float),
-    resize_flags: wp.array(dtype=wp.int32),
-):
-    tri_index = wp.tid()
-
-    t1 = tri_indices[tri_index, 0]
-    t2 = tri_indices[tri_index, 1]
-    t3 = tri_indices[tri_index, 2]
-    # wp.expect_eq(vertex_on_triangle(v_index, t1, t2, t3), False)
-
-    u1 = pos[t1]
-    u2 = pos[t2]
-    u3 = pos[t3]
-
-    num_cols = triangle_colliding_vertices_count[tri_index]
-    offset = triangle_colliding_vertices_buffer_offsets[tri_index]
-    min_dis = triangle_colliding_vertices_min_dist[tri_index]
-    for col in range(wp.min(num_cols, triangle_colliding_vertices_buffer_sizes[tri_index])):
-        v_index = triangle_colliding_vertices[offset + col]
-        v = pos[v_index]
-
-        closest_p, bary, feature_type = triangle_closest_point(u1, u2, u3, v)
-        dis = wp.length(closest_p - v)
-        wp.expect_eq(dis < query_radius, True)
-        wp.expect_eq(dis >= min_dis, True)
-
-        # wp.printf("vertex %d, offset %d, num cols %d, colliding with triangle: %d, dis: %f\n",
-        #           v_index, offset, num_cols, tri_index, dis)
-
-
-@wp.kernel
-def edge_edge_collision_detection_brute_force(
-    query_radius: float,
-    bvh_id: wp.uint64,
-    pos: wp.array(dtype=wp.vec3),
-    edge_indices: wp.array(dtype=wp.int32, ndim=2),
-    edge_colliding_edges_offsets: wp.array(dtype=wp.int32),
-    edge_colliding_edges_buffer_sizes: wp.array(dtype=wp.int32),
-    edge_edge_parallel_epsilon: float,
-    # outputs
-    edge_colliding_edges: wp.array(dtype=wp.int32),
-    edge_colliding_edges_count: wp.array(dtype=wp.int32),
-    edge_colliding_edges_min_dist: wp.array(dtype=float),
-    resize_flags: wp.array(dtype=wp.int32),
-):
-    e_index = wp.tid()
-
-    e0_v0 = edge_indices[e_index, 2]
-    e0_v1 = edge_indices[e_index, 3]
-
-    e0_v0_pos = pos[e0_v0]
-    e0_v1_pos = pos[e0_v1]
-
-    min_dis_to_edges = query_radius
-    edge_num_collisions = wp.int32(0)
-    for e1_index in range(edge_indices.shape[0]):
-        e1_v0 = edge_indices[e1_index, 2]
-        e1_v1 = edge_indices[e1_index, 3]
-
-        if e0_v0 == e1_v0 or e0_v0 == e1_v1 or e0_v1 == e1_v0 or e0_v1 == e1_v1:
-            continue
-
-        e1_v0_pos = pos[e1_v0]
-        e1_v1_pos = pos[e1_v1]
-
-        st = wp.closest_point_edge_edge(e0_v0_pos, e0_v1_pos, e1_v0_pos, e1_v1_pos, edge_edge_parallel_epsilon)
-        s = st[0]
-        t = st[1]
-        c1 = e0_v0_pos + (e0_v1_pos - e0_v0_pos) * s
-        c2 = e1_v0_pos + (e1_v1_pos - e1_v0_pos) * t
-
-        dist = wp.length(c1 - c2)
-        if dist < query_radius:
-            edge_buffer_offset = edge_colliding_edges_offsets[e_index]
-            edge_buffer_size = edge_colliding_edges_offsets[e_index + 1] - edge_buffer_offset
-
-            # record e-e collision to e0, and leave e1; e1 will detect this collision from its own thread
-            min_dis_to_edges = wp.min(min_dis_to_edges, dist)
-            if edge_num_collisions < edge_buffer_size:
-                edge_colliding_edges[edge_buffer_offset + edge_num_collisions] = e1_index
-            else:
-                resize_flags[1] = 1
-
-            edge_num_collisions = edge_num_collisions + 1
-
-    edge_colliding_edges_count[e_index] = edge_num_collisions
-    edge_colliding_edges_min_dist[e_index] = min_dis_to_edges
-
-
-@wp.kernel
-def validate_edge_collisions(
-    query_radius: float,
-    bvh_id: wp.uint64,
-    pos: wp.array(dtype=wp.vec3),
-    edge_indices: wp.array(dtype=wp.int32, ndim=2),
-    edge_colliding_edges_offsets: wp.array(dtype=wp.int32),
-    edge_colliding_edges_buffer_sizes: wp.array(dtype=wp.int32),
-    edge_edge_parallel_epsilon: float,
-    # outputs
-    edge_colliding_edges: wp.array(dtype=wp.int32),
-    edge_colliding_edges_count: wp.array(dtype=wp.int32),
-    edge_colliding_edges_min_dist: wp.array(dtype=float),
-    resize_flags: wp.array(dtype=wp.int32),
-):
-    e0_index = wp.tid()
-
-    e0_v0 = edge_indices[e0_index, 2]
-    e0_v1 = edge_indices[e0_index, 3]
-
-    e0_v0_pos = pos[e0_v0]
-    e0_v1_pos = pos[e0_v1]
-
-    num_cols = edge_colliding_edges_count[e0_index]
-    offset = edge_colliding_edges_offsets[e0_index]
-    min_dist = edge_colliding_edges_min_dist[e0_index]
-    for col in range(edge_colliding_edges_buffer_sizes[e0_index]):
-        e1_index = edge_colliding_edges[2 * (offset + col) + 1]
-
-        if col < num_cols:
-            e1_v0 = edge_indices[e1_index, 2]
-            e1_v1 = edge_indices[e1_index, 3]
-
-            if e0_v0 == e1_v0 or e0_v0 == e1_v1 or e0_v1 == e1_v0 or e0_v1 == e1_v1:
-                wp.expect_eq(False, True)
-
-            e1_v0_pos = pos[e1_v0]
-            e1_v1_pos = pos[e1_v1]
-
-            st = wp.closest_point_edge_edge(e0_v0_pos, e0_v1_pos, e1_v0_pos, e1_v1_pos, edge_edge_parallel_epsilon)
-            s = st[0]
-            t = st[1]
-            c1 = e0_v0_pos + (e0_v1_pos - e0_v0_pos) * s
-            c2 = e1_v0_pos + (e1_v1_pos - e1_v0_pos) * t
-
-            dist = wp.length(c2 - c1)
-
-            wp.expect_eq(dist >= min_dist, True)
-            wp.expect_eq(e0_index == edge_colliding_edges[2 * (offset + col)], True)
-        else:
-            wp.expect_eq(e1_index == -1, True)
-            wp.expect_eq(edge_colliding_edges[2 * (offset + col)] == -1, True)
-
-
-def init_model(vs, fs, device, record_triangle_contacting_vertices=True):
-    vertices = [wp.vec3(v) for v in vs]
-
-    builder = wp.sim.ModelBuilder()
-    builder.add_cloth_mesh(
-        pos=wp.vec3(0.0, 200.0, 0.0),
-        rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), 0.0),
-        scale=1.0,
-        vertices=vertices,
-        indices=fs,
-        vel=wp.vec3(0.0, 0.0, 0.0),
-        density=0.02,
-        tri_ke=0,
-        tri_ka=0,
-        tri_kd=0,
-    )
-    model = builder.finalize(device=device)
-
-    collision_detector = TriMeshCollisionDetector(model=model, record_triangle_contacting_vertices=True)
-
-    return model, collision_detector
-
-
-def get_data():
-    from pxr import Usd, UsdGeom
-
-    usd_stage = Usd.Stage.Open(os.path.join(warp.examples.get_asset_directory(), "bunny.usd"))
-    usd_geom = UsdGeom.Mesh(usd_stage.GetPrimAtPath("/root/bunny"))
-
-    vertices = np.array(usd_geom.GetPointsAttr().Get())
-    faces = np.array(usd_geom.GetFaceVertexIndicesAttr().Get())
-
-    return vertices, faces
-
-
-@unittest.skipUnless(USD_AVAILABLE, "Requires usd-core")
-def test_vertex_triangle_collision(test, device):
-    vertices, faces = get_data()
-
-    # record triangle contacting vertices
-    model, collision_detector = init_model(vertices, faces, device, True)
-
-    rs = [1e-2, 2e-2, 5e-2, 1e-1]
-
-    for query_radius in rs:
-        collision_detector.vertex_triangle_collision_detection(query_radius)
-        vertex_colliding_triangles_count_1 = collision_detector.vertex_colliding_triangles_count.numpy()
-        vertex_min_dis_1 = collision_detector.vertex_colliding_triangles_min_dist.numpy()
-
-        triangle_colliding_vertices_count_1 = collision_detector.triangle_colliding_vertices_count.numpy()
-        triangle_min_dis_1 = collision_detector.triangle_colliding_vertices_min_dist.numpy()
-
-        wp.launch(
-            kernel=validate_vertex_collisions,
-            inputs=[
-                query_radius,
-                collision_detector.bvh_tris.id,
-                collision_detector.model.particle_q,
-                collision_detector.model.tri_indices,
-                collision_detector.vertex_colliding_triangles,
-                collision_detector.vertex_colliding_triangles_count,
-                collision_detector.vertex_colliding_triangles_offsets,
-                collision_detector.vertex_colliding_triangles_buffer_sizes,
-                collision_detector.vertex_colliding_triangles_min_dist,
-                collision_detector.resize_flags,
-            ],
-            dim=model.particle_count,
-            device=device,
-        )
-
-        wp.launch(
-            kernel=validate_triangle_collisions,
-            inputs=[
-                query_radius,
-                collision_detector.bvh_tris.id,
-                collision_detector.model.particle_q,
-                collision_detector.model.tri_indices,
-                collision_detector.triangle_colliding_vertices,
-                collision_detector.triangle_colliding_vertices_count,
-                collision_detector.triangle_colliding_vertices_offsets,
-                collision_detector.triangle_colliding_vertices_buffer_sizes,
-                collision_detector.triangle_colliding_vertices_min_dist,
-                collision_detector.resize_flags,
-            ],
-            dim=model.tri_count,
-            device=model.device,
-        )
-
-        wp.launch(
-            kernel=init_triangle_collision_data_kernel,
-            inputs=[
-                query_radius,
-                collision_detector.triangle_colliding_vertices_count,
-                collision_detector.triangle_colliding_vertices_min_dist,
-                collision_detector.resize_flags,
-            ],
-            dim=model.tri_count,
-            device=model.device,
-        )
-
-        wp.launch(
-            kernel=vertex_triangle_collision_detection_brute_force,
-            inputs=[
-                query_radius,
-                collision_detector.bvh_tris.id,
-                collision_detector.model.particle_q,
-                collision_detector.model.tri_indices,
-                collision_detector.vertex_colliding_triangles,
-                collision_detector.vertex_colliding_triangles_count,
-                collision_detector.vertex_colliding_triangles_offsets,
-                collision_detector.vertex_colliding_triangles_buffer_sizes,
-                collision_detector.vertex_colliding_triangles_min_dist,
-                collision_detector.triangle_colliding_vertices,
-                collision_detector.triangle_colliding_vertices_count,
-                collision_detector.triangle_colliding_vertices_offsets,
-                collision_detector.triangle_colliding_vertices_buffer_sizes,
-                collision_detector.triangle_colliding_vertices_min_dist,
-                collision_detector.resize_flags,
-            ],
-            dim=model.particle_count,
-            device=model.device,
-        )
-
-        vertex_colliding_triangles_count_2 = collision_detector.vertex_colliding_triangles_count.numpy()
-        vertex_min_dis_2 = collision_detector.vertex_colliding_triangles_min_dist.numpy()
-
-        triangle_colliding_vertices_count_2 = collision_detector.triangle_colliding_vertices_count.numpy()
-        triangle_min_dis_2 = collision_detector.triangle_colliding_vertices_min_dist.numpy()
-
-        assert_np_equal(vertex_colliding_triangles_count_2, vertex_colliding_triangles_count_1)
-        assert_np_equal(triangle_min_dis_2, triangle_min_dis_1)
-        assert_np_equal(triangle_colliding_vertices_count_2, triangle_colliding_vertices_count_1)
-        assert_np_equal(vertex_min_dis_2, vertex_min_dis_1)
-
-        # do not record triangle contacting vertices
-        model, collision_detector = init_model(vertices, faces, device, False)
-
-        rs = [1e-2, 2e-2, 5e-2, 1e-1]
-
-    for query_radius in rs:
-        collision_detector.vertex_triangle_collision_detection(query_radius)
-        vertex_colliding_triangles_count_1 = collision_detector.vertex_colliding_triangles_count.numpy()
-        vertex_min_dis_1 = collision_detector.vertex_colliding_triangles_min_dist.numpy()
-
-        triangle_min_dis_1 = collision_detector.triangle_colliding_vertices_min_dist.numpy()
-
-        wp.launch(
-            kernel=validate_vertex_collisions,
-            inputs=[
-                query_radius,
-                collision_detector.bvh_tris.id,
-                collision_detector.model.particle_q,
-                collision_detector.model.tri_indices,
-                collision_detector.vertex_colliding_triangles,
-                collision_detector.vertex_colliding_triangles_count,
-                collision_detector.vertex_colliding_triangles_offsets,
-                collision_detector.vertex_colliding_triangles_buffer_sizes,
-                collision_detector.vertex_colliding_triangles_min_dist,
-                collision_detector.resize_flags,
-            ],
-            dim=model.particle_count,
-            device=device,
-        )
-
-        wp.launch(
-            kernel=vertex_triangle_collision_detection_brute_force_no_triangle_buffers,
-            inputs=[
-                query_radius,
-                collision_detector.bvh_tris.id,
-                collision_detector.model.particle_q,
-                collision_detector.model.tri_indices,
-                collision_detector.vertex_colliding_triangles,
-                collision_detector.vertex_colliding_triangles_count,
-                collision_detector.vertex_colliding_triangles_offsets,
-                collision_detector.vertex_colliding_triangles_buffer_sizes,
-                collision_detector.vertex_colliding_triangles_min_dist,
-                collision_detector.triangle_colliding_vertices_min_dist,
-                collision_detector.resize_flags,
-            ],
-            dim=model.particle_count,
-            device=model.device,
-        )
-
-        vertex_colliding_triangles_count_2 = collision_detector.vertex_colliding_triangles_count.numpy()
-        vertex_min_dis_2 = collision_detector.vertex_colliding_triangles_min_dist.numpy()
-        triangle_min_dis_2 = collision_detector.triangle_colliding_vertices_min_dist.numpy()
-
-        assert_np_equal(vertex_colliding_triangles_count_2, vertex_colliding_triangles_count_1)
-        assert_np_equal(triangle_min_dis_2, triangle_min_dis_1)
-        assert_np_equal(vertex_min_dis_2, vertex_min_dis_1)
-
-
-@unittest.skipUnless(USD_AVAILABLE, "Requires usd-core")
-def test_edge_edge_collision(test, device):
-    vertices, faces = get_data()
-
-    model, collision_detector = init_model(vertices, faces, device)
-
-    rs = [1e-2, 2e-2, 5e-2, 1e-1]
-    edge_edge_parallel_epsilon = 1e-5
-
-    for query_radius in rs:
-        collision_detector.edge_edge_collision_detection(query_radius)
-        edge_colliding_edges_count_1 = collision_detector.edge_colliding_edges_count.numpy()
-        edge_min_dist_1 = collision_detector.edge_colliding_edges_min_dist.numpy()
-
-        wp.launch(
-            kernel=validate_edge_collisions,
-            inputs=[
-                query_radius,
-                collision_detector.bvh_edges.id,
-                collision_detector.model.particle_q,
-                collision_detector.model.edge_indices,
-                collision_detector.edge_colliding_edges_offsets,
-                collision_detector.edge_colliding_edges_buffer_sizes,
-                edge_edge_parallel_epsilon,
-            ],
-            outputs=[
-                collision_detector.edge_colliding_edges,
-                collision_detector.edge_colliding_edges_count,
-                collision_detector.edge_colliding_edges_min_dist,
-                collision_detector.resize_flags,
-            ],
-            dim=model.particle_count,
-            device=device,
-        )
-
-        wp.launch(
-            kernel=edge_edge_collision_detection_brute_force,
-            inputs=[
-                query_radius,
-                collision_detector.bvh_edges.id,
-                collision_detector.model.particle_q,
-                collision_detector.model.edge_indices,
-                collision_detector.edge_colliding_edges_offsets,
-                collision_detector.edge_colliding_edges_buffer_sizes,
-                edge_edge_parallel_epsilon,
-            ],
-            outputs=[
-                collision_detector.edge_colliding_edges,
-                collision_detector.edge_colliding_edges_count,
-                collision_detector.edge_colliding_edges_min_dist,
-                collision_detector.resize_flags,
-            ],
-            dim=model.edge_count,
-            device=device,
-        )
-
-        edge_colliding_edges_count_2 = collision_detector.edge_colliding_edges_count.numpy()
-        edge_min_dist_2 = collision_detector.edge_colliding_edges_min_dist.numpy()
-
-        assert_np_equal(edge_colliding_edges_count_2, edge_colliding_edges_count_1)
-        assert_np_equal(edge_min_dist_1, edge_min_dist_2)
-
-
-def test_particle_collision(test, device):
-    with wp.ScopedDevice(device):
-        contact_radius = 1.23
-        builder1 = wp.sim.ModelBuilder()
-        builder1.add_cloth_grid(
-            pos=wp.vec3(0.0, 0.0, 0.0),
-            rot=wp.quat_identity(),
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            dim_x=100,
-            dim_y=100,
-            cell_x=0.1,
-            cell_y=0.1,
-            mass=0.1,
-            particle_radius=contact_radius,
-        )
-
-    cloth_grid = builder1.finalize()
-    cloth_grid_particle_radius = cloth_grid.particle_radius.numpy()
-    assert_np_equal(cloth_grid_particle_radius, np.full(cloth_grid_particle_radius.shape, contact_radius), tol=1e-5)
-
-    vertices = [
-        [2.0, 0.0, 0.0],
-        [2.0, 2.0, 0.0],
-        [0.0, 0.0, 0.0],
-        [1.0, 0.0, 1.0],
-        [1.0, 1.0, 1.0],
-        [0.0, 0.0, 1.0],
-    ]
-    vertices = [wp.vec3(v) for v in vertices]
-    faces = [0, 1, 2, 3, 4, 5]
-
-    builder2 = wp.sim.ModelBuilder()
-    builder2.add_cloth_mesh(
-        pos=wp.vec3(0.0, 0.0, 0.0),
-        rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), 0.0),
-        scale=1.0,
-        vertices=vertices,
-        indices=faces,
-        tri_ke=1e4,
-        tri_ka=1e4,
-        tri_kd=1e-5,
-        edge_ke=10,
-        edge_kd=0.0,
-        vel=wp.vec3(0.0, 0.0, 0.0),
-        density=0.1,
-        particle_radius=contact_radius,
-    )
-    cloth_mesh = builder2.finalize()
-    cloth_mesh_particle_radius = cloth_mesh.particle_radius.numpy()
-    assert_np_equal(cloth_mesh_particle_radius, np.full(cloth_mesh_particle_radius.shape, contact_radius), tol=1e-5)
-
-    state = cloth_mesh.state()
-    particle_f = wp.zeros_like(state.particle_q)
-    wp.launch(
-        kernel=eval_triangles_contact,
-        dim=cloth_mesh.tri_count * cloth_mesh.particle_count,
-        inputs=[
-            cloth_mesh.particle_count,
-            state.particle_q,
-            state.particle_qd,
-            cloth_mesh.tri_indices,
-            cloth_mesh.tri_materials,
-            cloth_mesh.particle_radius,
-        ],
-        outputs=[particle_f],
-    )
-    test.assertTrue((np.linalg.norm(particle_f.numpy(), axis=1) != 0).all())
-
-    builder3 = wp.sim.ModelBuilder()
-    builder3.add_cloth_mesh(
-        pos=wp.vec3(0.0, 0.0, 0.0),
-        rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), 0.0),
-        scale=1.0,
-        vertices=vertices,
-        indices=faces,
-        tri_ke=1e4,
-        tri_ka=1e4,
-        tri_kd=1e-5,
-        edge_ke=10,
-        edge_kd=0.0,
-        vel=wp.vec3(0.0, 0.0, 0.0),
-        density=0.1,
-        particle_radius=0.5,
-    )
-    cloth_mesh_2 = builder3.finalize()
-    cloth_mesh_2_particle_radius = cloth_mesh_2.particle_radius.numpy()
-    assert_np_equal(cloth_mesh_2_particle_radius, np.full(cloth_mesh_2_particle_radius.shape, 0.5), tol=1e-5)
-
-    state_2 = cloth_mesh_2.state()
-    particle_f_2 = wp.zeros_like(cloth_mesh_2.particle_q)
-    wp.launch(
-        kernel=eval_triangles_contact,
-        dim=cloth_mesh_2.tri_count * cloth_mesh_2.particle_count,
-        inputs=[
-            cloth_mesh_2.particle_count,
-            state_2.particle_q,
-            state_2.particle_qd,
-            cloth_mesh_2.tri_indices,
-            cloth_mesh_2.tri_materials,
-            cloth_mesh_2.particle_radius,
-        ],
-        outputs=[particle_f_2],
-    )
-    test.assertTrue((np.linalg.norm(particle_f_2.numpy(), axis=1) == 0).all())
-
-
-def test_mesh_ground_collision_index(test, device):
-    # create a mesh with 1 triangle for testing
-    vertices = np.array(
-        [
-            [0.0, 0.0, 0.0],
-            [1.0, 1.0, 0.0],
-            [0.5, 2.0, 0.0],
-        ]
-    )
-    mesh = wp.sim.Mesh(vertices=vertices, indices=[0, 1, 2])
-    builder = wp.sim.ModelBuilder()
-    # create body with nonzero mass to ensure it is not static
-    # and contact points will be computed
-    b = builder.add_body(m=1.0)
-    builder.add_shape_mesh(
-        body=b,
-        mesh=mesh,
-        has_shape_collision=False,
-    )
-    # add another mesh that is not in contact
-    b2 = builder.add_body(m=1.0, origin=wp.transform((0.0, 3.0, 0.0), wp.quat_identity()))
-    builder.add_shape_mesh(
-        body=b2,
-        mesh=mesh,
-        has_shape_collision=False,
-    )
-    model = builder.finalize(device=device)
-    test.assertEqual(model.rigid_contact_max, 6)
-    test.assertEqual(model.shape_contact_pair_count, 0)
-    test.assertEqual(model.shape_ground_contact_pair_count, 2)
-    model.ground = True
-    # ensure all the mesh vertices will be within the contact margin
-    model.rigid_contact_margin = 2.0
-    state = model.state()
-    wp.sim.collide(model, state)
-    test.assertEqual(model.rigid_contact_count.numpy()[0], 3)
-    tids = model.rigid_contact_tids.list()
-    test.assertEqual(sorted(tids), [-1, -1, -1, 0, 1, 2])
-    tids = [t for t in tids if t != -1]
-    # retrieve the mesh vertices from the contact thread indices
-    assert_np_equal(model.rigid_contact_point0.numpy()[:3], vertices[tids])
-    assert_np_equal(model.rigid_contact_point1.numpy()[:3, 0], vertices[tids, 0])
-    assert_np_equal(model.rigid_contact_point1.numpy()[:3, 1:], np.zeros((3, 2)))
-    assert_np_equal(model.rigid_contact_normal.numpy()[:3], np.tile([0.0, 1.0, 0.0], (3, 1)))
-
-
-devices = get_test_devices(mode="basic")
-
-
-class TestCollision(unittest.TestCase):
-    pass
-
-
-add_function_test(TestCollision, "test_vertex_triangle_collision", test_vertex_triangle_collision, devices=devices)
-add_function_test(TestCollision, "test_edge_edge_collision", test_edge_edge_collision, devices=devices)
-add_function_test(TestCollision, "test_particle_collision", test_particle_collision, devices=devices)
-add_function_test(TestCollision, "test_mesh_ground_collision_index", test_mesh_ground_collision_index, devices=devices)
-
-if __name__ == "__main__":
-    wp.clear_kernel_cache()
-    unittest.main(verbosity=2, failfast=True)
diff --git a/warp/tests/sim/test_coloring.py b/warp/tests/sim/test_coloring.py
deleted file mode 100644
index fa7f81df..00000000
--- a/warp/tests/sim/test_coloring.py
+++ /dev/null
@@ -1,347 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2024 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-import itertools
-
-import numpy as np
-
-import warp as wp
-import warp.examples
-import warp.sim
-from warp.sim.graph_coloring import (
-    ColoringAlgorithm,
-    construct_trimesh_graph_edges,
-    convert_to_color_groups,
-    validate_graph_coloring,
-)
-from warp.tests.unittest_utils import *
-
-
-def color_lattice_grid(num_x, num_y):
-    colors = []
-    for _ in range(4):
-        colors.append([])
-
-    for xi in range(num_x + 1):
-        for yi in range(num_y + 1):
-            node_dx = yi * (num_x + 1) + xi
-
-            a = 1 if xi % 2 else 0
-            b = 1 if yi % 2 else 0
-
-            c = b * 2 + a
-
-            colors[c].append(node_dx)
-
-    color_groups = [np.array(group) for group in colors]
-
-    return color_groups
-
-
-def create_lattice_grid(N):
-    size = 10
-    position = (0, 0)
-
-    X = np.linspace(-0.5 * size + position[0], 0.5 * size + position[0], N)
-    Y = np.linspace(-0.5 * size + position[1], 0.5 * size + position[1], N)
-
-    X, Y = np.meshgrid(X, Y)
-
-    Z = []
-    for _i in range(N):
-        Z.append(np.linspace(0, size, N))
-
-    Z = np.array(Z)
-
-    vs = []
-    for i, j in itertools.product(range(N), range(N)):
-        vs.append(wp.vec3((X[i, j], Y[i, j], Z[i, j])))
-
-    fs = []
-    for i, j in itertools.product(range(0, N - 1), range(0, N - 1)):
-        vId = j + i * N
-
-        if (j + i) % 2:
-            fs.extend(
-                [
-                    vId,
-                    vId + N + 1,
-                    vId + 1,
-                ]
-            )
-            fs.extend(
-                [
-                    vId,
-                    vId + N,
-                    vId + N + 1,
-                ]
-            )
-        else:
-            fs.extend(
-                [
-                    vId,
-                    vId + N,
-                    vId + 1,
-                ]
-            )
-            fs.extend(
-                [
-                    vId + N,
-                    vId + N + 1,
-                    vId + 1,
-                ]
-            )
-
-    return vs, fs
-
-
-def test_coloring_corner_case(test, device):
-    builder_1 = wp.sim.ModelBuilder()
-    builder_1.color()
-    test.assertTrue(len(builder_1.particle_color_groups) == 0)
-
-    builder_2 = wp.sim.ModelBuilder()
-    builder_2.add_particle(pos=wp.vec3(0, 0, 0), vel=wp.vec3(0, 0, 0), mass=1.0)
-    builder_2.add_particle(pos=wp.vec3(1, 0, 0), vel=wp.vec3(0, 0, 0), mass=1.0)
-    builder_2.color()
-    test.assertTrue(len(builder_2.particle_color_groups) == 1)
-    test.assertTrue(builder_2.particle_color_groups[0].shape[0] == 2)
-
-
-@unittest.skipUnless(USD_AVAILABLE, "Requires usd-core")
-def test_coloring_trimesh(test, device):
-    from pxr import Usd, UsdGeom
-
-    with wp.ScopedDevice(device):
-        usd_stage = Usd.Stage.Open(os.path.join(wp.examples.get_asset_directory(), "bunny.usd"))
-        usd_geom = UsdGeom.Mesh(usd_stage.GetPrimAtPath("/root/bunny"))
-
-        vertices = np.array(usd_geom.GetPointsAttr().Get())
-        faces = np.array(usd_geom.GetFaceVertexIndicesAttr().Get())
-
-        builder = wp.sim.ModelBuilder()
-
-        builder.add_cloth_mesh(
-            pos=wp.vec3(0.0, 0.0, 0.0),
-            rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), 0.0),
-            scale=1.0,
-            vertices=[wp.vec3(p) for p in vertices],
-            indices=faces.flatten(),
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            density=0.02,
-        )
-
-        model = builder.finalize()
-
-        particle_colors = wp.empty(shape=(model.particle_count), dtype=int, device="cpu")
-
-        edge_indices_cpu = wp.array(model.edge_indices.numpy()[:, 2:], dtype=int, device="cpu")
-
-        # coloring without bending
-        num_colors_greedy = wp.context.runtime.core.wp_graph_coloring(
-            model.particle_count,
-            edge_indices_cpu.__ctype__(),
-            ColoringAlgorithm.GREEDY.value,
-            particle_colors.__ctype__(),
-        )
-        wp.launch(
-            kernel=validate_graph_coloring,
-            inputs=[edge_indices_cpu, particle_colors],
-            dim=edge_indices_cpu.shape[0],
-            device="cpu",
-        )
-
-        num_colors_mcs = wp.context.runtime.core.wp_graph_coloring(
-            model.particle_count,
-            edge_indices_cpu.__ctype__(),
-            ColoringAlgorithm.MCS.value,
-            particle_colors.__ctype__(),
-        )
-        wp.launch(
-            kernel=validate_graph_coloring,
-            inputs=[edge_indices_cpu, particle_colors],
-            dim=edge_indices_cpu.shape[0],
-            device="cpu",
-        )
-
-        # coloring with bending
-        edge_indices_cpu_with_bending = construct_trimesh_graph_edges(model.edge_indices, True)
-        num_colors_greedy = wp.context.runtime.core.wp_graph_coloring(
-            model.particle_count,
-            edge_indices_cpu_with_bending.__ctype__(),
-            ColoringAlgorithm.GREEDY.value,
-            particle_colors.__ctype__(),
-        )
-        wp.context.runtime.core.wp_balance_coloring(
-            model.particle_count,
-            edge_indices_cpu_with_bending.__ctype__(),
-            num_colors_greedy,
-            1.1,
-            particle_colors.__ctype__(),
-        )
-        wp.launch(
-            kernel=validate_graph_coloring,
-            inputs=[edge_indices_cpu_with_bending, particle_colors],
-            dim=edge_indices_cpu_with_bending.shape[0],
-            device="cpu",
-        )
-
-        num_colors_mcs = wp.context.runtime.core.wp_graph_coloring(
-            model.particle_count,
-            edge_indices_cpu_with_bending.__ctype__(),
-            ColoringAlgorithm.MCS.value,
-            particle_colors.__ctype__(),
-        )
-        max_min_ratio = wp.context.runtime.core.wp_balance_coloring(
-            model.particle_count,
-            edge_indices_cpu_with_bending.__ctype__(),
-            num_colors_mcs,
-            1.1,
-            particle_colors.__ctype__(),
-        )
-        wp.launch(
-            kernel=validate_graph_coloring,
-            inputs=[edge_indices_cpu_with_bending, particle_colors],
-            dim=edge_indices_cpu_with_bending.shape[0],
-            device="cpu",
-        )
-
-        color_categories_balanced = convert_to_color_groups(num_colors_mcs, particle_colors)
-
-        color_sizes = np.array([c.shape[0] for c in color_categories_balanced], dtype=np.float32)
-        test.assertTrue(np.max(color_sizes) / np.min(color_sizes) <= max_min_ratio)
-
-        # test if the color balance can quit from equilibrium
-        builder = wp.sim.ModelBuilder()
-
-        vs, fs = create_lattice_grid(100)
-        builder.add_cloth_mesh(
-            pos=wp.vec3(0.0, 0.0, 0.0),
-            rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), 0.0),
-            scale=1.0,
-            vertices=vs,
-            indices=fs,
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            density=0.02,
-        )
-
-        builder.color(include_bending=True)
-
-
-@unittest.skipUnless(USD_AVAILABLE, "Requires usd-core")
-def test_combine_coloring(test, device):
-    from pxr import Usd, UsdGeom
-
-    with wp.ScopedDevice(device):
-        builder1 = wp.sim.ModelBuilder()
-        usd_stage = Usd.Stage.Open(os.path.join(wp.examples.get_asset_directory(), "bunny.usd"))
-        usd_geom = UsdGeom.Mesh(usd_stage.GetPrimAtPath("/root/bunny"))
-
-        vertices = np.array(usd_geom.GetPointsAttr().Get())
-        faces = np.array(usd_geom.GetFaceVertexIndicesAttr().Get())
-
-        builder1.add_cloth_mesh(
-            pos=wp.vec3(0.0, 0.0, 0.0),
-            rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), 0.0),
-            scale=1.0,
-            vertices=[wp.vec3(p) for p in vertices],
-            indices=faces.flatten(),
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            density=0.02,
-        )
-
-        builder1.add_cloth_grid(
-            pos=wp.vec3(0.0, 4.0, 0.0),
-            rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), 0.0),
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            dim_x=50,
-            dim_y=100,
-            cell_x=0.1,
-            cell_y=0.1,
-            mass=0.1,
-            fix_left=True,
-        )
-        builder1.color()
-
-        builder2 = wp.sim.ModelBuilder()
-        builder2.add_cloth_grid(
-            pos=wp.vec3(0.0, 4.0, 0.0),
-            rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), 0.0),
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            dim_x=50,
-            dim_y=100,
-            cell_x=0.1,
-            cell_y=0.1,
-            mass=0.1,
-            # to include bending in coloring
-            edge_ke=100000,
-            fix_left=True,
-        )
-        builder2.color()
-
-        builder3 = wp.sim.ModelBuilder()
-        builder3.add_cloth_grid(
-            pos=wp.vec3(0.0, 4.0, 0.0),
-            rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), 0.0),
-            vel=wp.vec3(0.0, 0.0, 0.0),
-            dim_x=50,
-            dim_y=100,
-            cell_x=0.1,
-            cell_y=0.1,
-            mass=0.1,
-            fix_left=True,
-        )
-
-        builder3.set_coloring(
-            color_lattice_grid(50, 100),
-        )
-
-        builder1.add_builder(builder2)
-        builder1.add_builder(builder3)
-
-        model = builder2.finalize()
-
-        particle_number_colored = np.full((model.particle_count), -1, dtype=int)
-        particle_colors = np.full((model.particle_count), -1, dtype=int)
-        for color, color_group in enumerate(model.particle_color_groups):
-            particle_number_colored[color_group.numpy()] += 1
-            particle_colors[color_group.numpy()] = color
-
-        # all particles has been colored exactly once
-        assert_np_equal(particle_number_colored, 0)
-
-        edge_indices_cpu = wp.array(model.edge_indices.numpy()[:, 2:], dtype=int, device="cpu")
-        wp.launch(
-            kernel=validate_graph_coloring,
-            inputs=[edge_indices_cpu, wp.array(particle_colors, dtype=int, device="cpu")],
-            dim=edge_indices_cpu.shape[0],
-            device="cpu",
-        )
-
-
-devices = get_test_devices()
-
-
-class TestColoring(unittest.TestCase):
-    pass
-
-
-add_function_test(TestColoring, "test_coloring_trimesh", test_coloring_trimesh, devices=devices, check_output=False)
-add_function_test(TestColoring, "test_combine_coloring", test_combine_coloring, devices=devices)
-add_function_test(TestColoring, "test_coloring_corner_case", test_coloring_corner_case, devices=devices)
-
-if __name__ == "__main__":
-    wp.clear_kernel_cache()
-    unittest.main(verbosity=2)
diff --git a/warp/tests/sim/test_inertia.py b/warp/tests/sim/test_inertia.py
deleted file mode 100644
index 17ca6163..00000000
--- a/warp/tests/sim/test_inertia.py
+++ /dev/null
@@ -1,161 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2025 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-import unittest
-
-import numpy as np
-
-import warp as wp
-from warp.render.render_opengl import OpenGLRenderer
-from warp.sim import ModelBuilder
-from warp.sim.inertia import (
-    compute_box_inertia,
-    compute_mesh_inertia,
-    compute_sphere_inertia,
-)
-from warp.tests.unittest_utils import assert_np_equal
-
-
-class TestInertia(unittest.TestCase):
-    def test_cube_mesh_inertia(self):
-        # Unit cube
-        vertices = [
-            [1.0, 0.0, 0.0],
-            [1.0, 0.0, 1.0],
-            [0.0, 0.0, 1.0],
-            [0.0, 0.0, 0.0],
-            [1.0, 1.0, 0.0],
-            [1.0, 1.0, 1.0],
-            [0.0, 1.0, 1.0],
-            [0.0, 1.0, 0.0],
-        ]
-        indices = [
-            [1, 2, 3],
-            [7, 6, 5],
-            [4, 5, 1],
-            [5, 6, 2],
-            [2, 6, 7],
-            [0, 3, 7],
-            [0, 1, 3],
-            [4, 7, 5],
-            [0, 4, 1],
-            [1, 5, 2],
-            [3, 2, 7],
-            [4, 0, 7],
-        ]
-
-        mass_0, com_0, I_0, volume_0 = compute_mesh_inertia(
-            density=1000, vertices=vertices, indices=indices, is_solid=True
-        )
-
-        self.assertAlmostEqual(mass_0, 1000.0, delta=1e-6)
-        self.assertAlmostEqual(volume_0, 1.0, delta=1e-6)
-        assert_np_equal(np.array(com_0), np.array([0.5, 0.5, 0.5]), tol=1e-6)
-
-        # Check against analytical inertia
-        mass_box, com_box, I_box = compute_box_inertia(1000.0, 1.0, 1.0, 1.0)
-        self.assertAlmostEqual(mass_box, mass_0, delta=1e-6)
-        assert_np_equal(np.array(com_box), np.zeros(3), tol=1e-6)
-        assert_np_equal(np.array(I_0), np.array(I_box), tol=1e-4)
-
-        # Compute hollow box inertia
-        mass_0_hollow, com_0_hollow, I_0_hollow, volume_0_hollow = compute_mesh_inertia(
-            density=1000,
-            vertices=vertices,
-            indices=indices,
-            is_solid=False,
-            thickness=0.1,
-        )
-        assert_np_equal(np.array(com_0_hollow), np.array([0.5, 0.5, 0.5]), tol=1e-6)
-
-        # Add vertex between [0.0, 0.0, 0.0] and [1.0, 0.0, 0.0]
-        vertices.append([0.5, 0.0, 0.0])
-        indices[5] = [0, 8, 7]
-        indices.append([8, 3, 7])
-        indices[6] = [0, 1, 8]
-        indices.append([8, 1, 3])
-
-        mass_1, com_1, I_1, volume_1 = compute_mesh_inertia(
-            density=1000, vertices=vertices, indices=indices, is_solid=True
-        )
-
-        # Inertia values should be the same as before
-        self.assertAlmostEqual(mass_1, mass_0, delta=1e-6)
-        self.assertAlmostEqual(volume_1, volume_0, delta=1e-6)
-        assert_np_equal(np.array(com_1), np.array([0.5, 0.5, 0.5]), tol=1e-6)
-        assert_np_equal(np.array(I_1), np.array(I_0), tol=1e-4)
-
-        # Compute hollow box inertia
-        mass_1_hollow, com_1_hollow, I_1_hollow, volume_1_hollow = compute_mesh_inertia(
-            density=1000,
-            vertices=vertices,
-            indices=indices,
-            is_solid=False,
-            thickness=0.1,
-        )
-
-        # Inertia values should be the same as before
-        self.assertAlmostEqual(mass_1_hollow, mass_0_hollow, delta=2e-3)
-        self.assertAlmostEqual(volume_1_hollow, volume_0_hollow, delta=1e-6)
-        assert_np_equal(np.array(com_1_hollow), np.array([0.5, 0.5, 0.5]), tol=1e-6)
-        assert_np_equal(np.array(I_1_hollow), np.array(I_0_hollow), tol=1e-4)
-
-    def test_sphere_mesh_inertia(self):
-        vertices, indices = OpenGLRenderer._create_sphere_mesh(radius=2.5, num_latitudes=500, num_longitudes=500)
-
-        offset = np.array([1.0, 2.0, 3.0], dtype=np.float32)
-        vertices = vertices[:, :3] + offset
-
-        mass_mesh, com_mesh, I_mesh, vol_mesh = compute_mesh_inertia(
-            density=1000,
-            vertices=vertices,
-            indices=indices,
-            is_solid=True,
-        )
-
-        # Check against analytical inertia
-        mass_sphere, _, I_sphere = compute_sphere_inertia(1000.0, 2.5)
-        self.assertAlmostEqual(mass_mesh, mass_sphere, delta=1e2)
-        assert_np_equal(np.array(com_mesh), np.array(offset), tol=2e-3)
-        assert_np_equal(np.array(I_mesh), np.array(I_sphere), tol=4e2)
-        # Check volume
-        self.assertAlmostEqual(vol_mesh, 4.0 / 3.0 * np.pi * 2.5**3, delta=3e-2)
-
-    def test_body_inertia(self):
-        vertices, indices = OpenGLRenderer._create_sphere_mesh(radius=2.5, num_latitudes=500, num_longitudes=500)
-
-        offset = np.array([1.0, 2.0, 3.0], dtype=np.float32)
-        vertices = vertices[:, :3] + offset
-
-        builder = ModelBuilder()
-        b = builder.add_body()
-        tf = wp.transform(wp.vec3(4.0, 5.0, 6.0), wp.quat_rpy(0.5, -0.8, 1.3))
-        builder.add_shape_mesh(
-            b,
-            pos=tf.p,
-            rot=tf.q,
-            mesh=wp.sim.Mesh(vertices=vertices, indices=indices),
-            density=1000.0,
-        )
-        transformed_com = wp.transform_point(tf, wp.vec3(*offset))
-        assert_np_equal(np.array(builder.body_com[0]), np.array(transformed_com), tol=2e-3)
-        mass_sphere, _, I_sphere = compute_sphere_inertia(1000.0, 2.5)
-        assert_np_equal(np.array(builder.body_inertia[0]), np.array(I_sphere), tol=4e2)
-        self.assertAlmostEqual(builder.body_mass[0], mass_sphere, delta=1e2)
-
-
-if __name__ == "__main__":
-    wp.clear_kernel_cache()
-    unittest.main(verbosity=2)
diff --git a/warp/tests/sim/test_model.py b/warp/tests/sim/test_model.py
deleted file mode 100644
index 2c00defb..00000000
--- a/warp/tests/sim/test_model.py
+++ /dev/null
@@ -1,226 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-import math
-import unittest
-
-import numpy as np
-
-import warp as wp
-from warp.sim import ModelBuilder
-from warp.tests.unittest_utils import *
-
-
-class TestModel(unittest.TestCase):
-    def test_add_triangles(self):
-        rng = np.random.default_rng(123)
-
-        pts = np.array(
-            [
-                [-0.00585869, 0.34189449, -1.17415233],
-                [-1.894547, 0.1788074, 0.9251329],
-                [-1.26141048, 0.16140787, 0.08823282],
-                [-0.08609255, -0.82722546, 0.65995427],
-                [0.78827592, -1.77375711, -0.55582718],
-            ]
-        )
-        tris = np.array([[0, 3, 4], [0, 2, 3], [2, 1, 3], [1, 4, 3]])
-
-        builder1 = ModelBuilder()
-        builder2 = ModelBuilder()
-        for pt in pts:
-            builder1.add_particle(wp.vec3(pt), wp.vec3(), 1.0)
-            builder2.add_particle(wp.vec3(pt), wp.vec3(), 1.0)
-
-        # test add_triangle(s) with default arguments:
-        areas = builder2.add_triangles(tris[:, 0], tris[:, 1], tris[:, 2])
-        for i, t in enumerate(tris):
-            area = builder1.add_triangle(t[0], t[1], t[2])
-            self.assertAlmostEqual(area, areas[i], places=6)
-
-        # test add_triangle(s) with non default arguments:
-        tri_ke = rng.standard_normal(size=pts.shape[0])
-        tri_ka = rng.standard_normal(size=pts.shape[0])
-        tri_kd = rng.standard_normal(size=pts.shape[0])
-        tri_drag = rng.standard_normal(size=pts.shape[0])
-        tri_lift = rng.standard_normal(size=pts.shape[0])
-        for i, t in enumerate(tris):
-            builder1.add_triangle(
-                t[0],
-                t[1],
-                t[2],
-                tri_ke[i],
-                tri_ka[i],
-                tri_kd[i],
-                tri_drag[i],
-                tri_lift[i],
-            )
-        builder2.add_triangles(tris[:, 0], tris[:, 1], tris[:, 2], tri_ke, tri_ka, tri_kd, tri_drag, tri_lift)
-
-        assert_np_equal(np.array(builder1.tri_indices), np.array(builder2.tri_indices))
-        assert_np_equal(np.array(builder1.tri_poses), np.array(builder2.tri_poses), tol=1.0e-6)
-        assert_np_equal(np.array(builder1.tri_activations), np.array(builder2.tri_activations))
-        assert_np_equal(np.array(builder1.tri_materials), np.array(builder2.tri_materials))
-
-    def test_add_edges(self):
-        rng = np.random.default_rng(123)
-
-        pts = np.array(
-            [
-                [-0.00585869, 0.34189449, -1.17415233],
-                [-1.894547, 0.1788074, 0.9251329],
-                [-1.26141048, 0.16140787, 0.08823282],
-                [-0.08609255, -0.82722546, 0.65995427],
-                [0.78827592, -1.77375711, -0.55582718],
-            ]
-        )
-        edges = np.array([[0, 4, 3, 1], [3, 2, 4, 1]])
-
-        builder1 = ModelBuilder()
-        builder2 = ModelBuilder()
-        for pt in pts:
-            builder1.add_particle(wp.vec3(pt), wp.vec3(), 1.0)
-            builder2.add_particle(wp.vec3(pt), wp.vec3(), 1.0)
-
-        # test defaults:
-        for i in range(2):
-            builder1.add_edge(edges[i, 0], edges[i, 1], edges[i, 2], edges[i, 3])
-        builder2.add_edges(edges[:, 0], edges[:, 1], edges[:, 2], edges[:, 3])
-
-        # test non defaults:
-        rest = rng.standard_normal(size=2)
-        edge_ke = rng.standard_normal(size=2)
-        edge_kd = rng.standard_normal(size=2)
-        for i in range(2):
-            builder1.add_edge(edges[i, 0], edges[i, 1], edges[i, 2], edges[i, 3], rest[i], edge_ke[i], edge_kd[i])
-        builder2.add_edges(edges[:, 0], edges[:, 1], edges[:, 2], edges[:, 3], rest, edge_ke, edge_kd)
-
-        assert_np_equal(np.array(builder1.edge_indices), np.array(builder2.edge_indices))
-        assert_np_equal(np.array(builder1.edge_rest_angle), np.array(builder2.edge_rest_angle), tol=1.0e-4)
-        assert_np_equal(np.array(builder1.edge_bending_properties), np.array(builder2.edge_bending_properties))
-
-    def test_collapse_fixed_joints(self):
-        def add_three_cubes(builder: ModelBuilder, parent_body=-1):
-            unit_cube = {"hx": 0.5, "hy": 0.5, "hz": 0.5, "density": 1.0}
-            b0 = builder.add_body()
-            builder.add_shape_box(body=b0, **unit_cube)
-            builder.add_joint_fixed(parent=parent_body, child=b0, parent_xform=wp.transform(wp.vec3(1.0, 0.0, 0.0)))
-            b1 = builder.add_body()
-            builder.add_shape_box(body=b1, **unit_cube)
-            builder.add_joint_fixed(parent=parent_body, child=b1, parent_xform=wp.transform(wp.vec3(0.0, 1.0, 0.0)))
-            b2 = builder.add_body()
-            builder.add_shape_box(body=b2, **unit_cube)
-            builder.add_joint_fixed(parent=parent_body, child=b2, parent_xform=wp.transform(wp.vec3(0.0, 0.0, 1.0)))
-            return b2
-
-        builder = ModelBuilder()
-        # only fixed joints
-        builder.add_articulation()
-        add_three_cubes(builder)
-        assert builder.joint_count == 3
-        assert builder.body_count == 3
-
-        # fixed joints followed by a non-fixed joint
-        builder.add_articulation()
-        last_body = add_three_cubes(builder)
-        assert builder.joint_count == 6
-        assert builder.body_count == 6
-        assert builder.articulation_count == 2
-        b3 = builder.add_body()
-        builder.add_shape_box(body=b3, hx=0.5, hy=0.5, hz=0.5, density=1.0, pos=wp.vec3(1.0, 2.0, 3.0))
-        builder.add_joint_revolute(parent=last_body, child=b3, axis=wp.vec3(0.0, 1.0, 0.0))
-
-        # a non-fixed joint followed by fixed joints
-        builder.add_articulation()
-        b4 = builder.add_body()
-        builder.add_shape_box(body=b4, hx=0.5, hy=0.5, hz=0.5, density=1.0)
-        builder.add_joint_free(parent=-1, child=b4, parent_xform=wp.transform(wp.vec3(0.0, -1.0, 0.0)))
-        assert builder.joint_count == 8
-        assert builder.body_count == 8
-        assert builder.articulation_count == 3
-        lb = add_three_cubes(builder, parent_body=b4)
-        # add shape with no mass (e.g. visual only shape)
-        builder.add_shape_sphere(lb, density=0.0)
-
-        builder.collapse_fixed_joints()
-
-        assert builder.joint_count == 2
-        assert builder.articulation_count == 2
-        assert builder.articulation_start == [0, 1]
-        assert builder.joint_type == [wp.sim.JOINT_REVOLUTE, wp.sim.JOINT_FREE]
-        assert builder.shape_count == 12
-        assert builder.shape_body == [-1, -1, -1, -1, -1, -1, 0, 1, 1, 1, 1, 1]
-        assert builder.body_count == 2
-        assert builder.body_com[0] == wp.vec3(1.0, 2.0, 3.0)
-        assert builder.body_com[1] == wp.vec3(0.25, 0.25, 0.25)
-        assert builder.body_mass == [1.0, 4.0]
-        assert builder.body_inv_mass == [1.0, 0.25]
-
-        # create another builder, test add_builder function
-        builder2 = ModelBuilder()
-        builder2.add_builder(builder)
-        assert builder2.articulation_count == builder.articulation_count
-        assert builder2.joint_count == builder.joint_count
-        assert builder2.body_count == builder.body_count
-        assert builder2.shape_count == builder.shape_count
-        assert builder2.articulation_start == builder.articulation_start
-        # add the same builder again
-        builder2.add_builder(builder)
-        assert builder2.articulation_count == 2 * builder.articulation_count
-        assert builder2.articulation_start == [0, 1, 2, 3]
-
-    def test_add_builder_with_open_edges(self):
-        builder = wp.sim.ModelBuilder()
-
-        dim_x = 16
-        dim_y = 16
-
-        env_builder = wp.sim.ModelBuilder()
-        env_builder.add_cloth_grid(
-            pos=wp.vec3(0.0, 0.0, 0.0),
-            vel=wp.vec3(0.1, 0.1, 0.0),
-            rot=wp.quat_from_axis_angle(wp.vec3(1.0, 0.0, 0.0), -math.pi * 0.25),
-            dim_x=dim_x,
-            dim_y=dim_y,
-            cell_x=1.0 / dim_x,
-            cell_y=1.0 / dim_y,
-            mass=1.0,
-        )
-
-        num_envs = 2
-        env_offsets = np.array([[0.0, 0.0, 0.0], [0.0, 0.0, 0.0]])
-
-        builder_open_edge_count = np.sum(np.array(builder.edge_indices) == -1)
-        env_builder_open_edge_count = np.sum(np.array(env_builder.edge_indices) == -1)
-
-        for i in range(num_envs):
-            xform = wp.transform(env_offsets[i], wp.quat_identity())
-            builder.add_builder(
-                env_builder,
-                xform,
-                update_num_env_count=True,
-                separate_collision_group=True,
-            )
-
-        self.assertEqual(
-            np.sum(np.array(builder.edge_indices) == -1),
-            builder_open_edge_count + num_envs * env_builder_open_edge_count,
-            "builder does not have the expected number of open edges",
-        )
-
-
-if __name__ == "__main__":
-    wp.clear_kernel_cache()
-    unittest.main(verbosity=2)
diff --git a/warp/tests/sim/test_sim_grad.py b/warp/tests/sim/test_sim_grad.py
deleted file mode 100644
index bd61a791..00000000
--- a/warp/tests/sim/test_sim_grad.py
+++ /dev/null
@@ -1,287 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-import unittest
-
-import numpy as np
-
-import warp as wp
-import warp.sim
-import warp.sim.render
-from warp.tests.unittest_utils import *
-
-
-@wp.kernel
-def evaluate_loss(
-    joint_q: wp.array(dtype=float),
-    weighting: float,
-    target: float,
-    # output
-    loss: wp.array(dtype=float),
-):
-    tid = wp.tid()
-    d = (target - joint_q[tid * 2 + 1]) ** 2.0
-    wp.atomic_add(loss, 0, weighting * d)
-
-
-@wp.kernel
-def assign_action(action: wp.array(dtype=float), joint_act: wp.array(dtype=float)):
-    tid = wp.tid()
-    joint_act[2 * tid] = action[tid]
-
-
-@wp.kernel
-def assign_force(action: wp.array(dtype=float), body_f: wp.array(dtype=wp.spatial_vector)):
-    tid = wp.tid()
-    body_f[2 * tid] = wp.spatial_vector(0.0, 0.0, 0.0, action[tid], 0.0, 0.0)
-
-
-def gradcheck(func, inputs, device, eps=1e-1, tol=1e-2, print_grad=False):
-    """
-    Checks that the gradient of the Warp kernel is correct by comparing it to the
-    numerical gradient computed using finite differences.
-    """
-
-    def f(xs):
-        # call the kernel without taping for finite differences
-        wp_xs = [wp.array(xs[i], ndim=1, dtype=inputs[i].dtype, device=device) for i in range(len(inputs))]
-        output = func(*wp_xs)
-        return output.numpy()[0]
-
-    # compute analytical gradient
-    tape = wp.Tape()
-    with tape:
-        output = func(*inputs)
-
-    tape.backward(loss=output)
-
-    # compute numerical gradient
-    np_xs = []
-    for i in range(len(inputs)):
-        np_xs.append(inputs[i].numpy().flatten().copy())
-
-    for i in range(len(inputs)):
-        fd_grad = np.zeros_like(np_xs[i])
-        for j in range(len(np_xs[i])):
-            np_xs[i][j] += eps
-            y1 = f(np_xs)
-            np_xs[i][j] -= 2 * eps
-            y2 = f(np_xs)
-            np_xs[i][j] += eps
-            fd_grad[j] = (y1 - y2) / (2 * eps)
-
-        # compare gradients
-        ad_grad = tape.gradients[inputs[i]].numpy()
-        if print_grad:
-            print("grad ad:", ad_grad)
-            print("grad fd:", fd_grad)
-        assert_np_equal(ad_grad, fd_grad, tol=tol)
-        # ensure the signs match
-        assert np.allclose(ad_grad * fd_grad > 0, True)
-
-    tape.zero()
-
-
-def test_sphere_pushing_on_rails(
-    test,
-    device,
-    joint_type,
-    integrator_type,
-    apply_force=False,
-    static_contacts=True,
-    print_grad=False,
-):
-    # Two spheres on a rail (prismatic or D6 joint), one is pushed, the other is passive.
-    # The absolute distance to a target is measured and gradients are compared for
-    # a push that is too far and too close.
-    num_envs = 2
-    num_steps = 150
-    sim_substeps = 10
-    dt = 1 / 30
-
-    target = 3.0
-
-    if integrator_type == 0:
-        contact_ke = 1e3
-        contact_kd = 1e1
-    else:
-        contact_ke = 1e3
-        contact_kd = 1e1
-
-    complete_builder = wp.sim.ModelBuilder()
-
-    complete_builder.default_shape_ke = contact_ke
-    complete_builder.default_shape_kd = contact_kd
-
-    for _ in range(num_envs):
-        builder = wp.sim.ModelBuilder(gravity=0.0)
-
-        builder.default_shape_ke = complete_builder.default_shape_ke
-        builder.default_shape_kd = complete_builder.default_shape_kd
-
-        b0 = builder.add_body(name="pusher")
-        builder.add_shape_sphere(b0, radius=0.4, density=100.0)
-
-        b1 = builder.add_body(name="passive")
-        builder.add_shape_sphere(b1, radius=0.47, density=100.0)
-
-        if joint_type == 0:
-            builder.add_joint_prismatic(-1, b0)
-            builder.add_joint_prismatic(-1, b1)
-        else:
-            builder.add_joint_d6(-1, b0, linear_axes=[wp.sim.JointAxis((1.0, 0.0, 0.0))])
-            builder.add_joint_d6(-1, b1, linear_axes=[wp.sim.JointAxis((1.0, 0.0, 0.0))])
-
-        builder.joint_q[-2:] = [0.0, 2.0]
-        complete_builder.add_builder(builder)
-
-    assert complete_builder.body_count == 2 * num_envs
-    assert complete_builder.joint_count == 2 * num_envs
-    assert set(complete_builder.shape_collision_group) == set(range(1, num_envs + 1))
-
-    complete_builder.gravity = 0.0
-    model = complete_builder.finalize(device=device, requires_grad=True)
-    model.ground = False
-    model.joint_attach_ke = 32000.0 * 16
-    model.joint_attach_kd = 500.0 * 4
-
-    if static_contacts:
-        wp.sim.eval_fk(model, model.joint_q, model.joint_qd, None, model)
-        model.rigid_contact_margin = 10.0
-        state = model.state()
-        wp.sim.collide(model, state)
-
-    if integrator_type == 0:
-        integrator = wp.sim.FeatherstoneIntegrator(model, update_mass_matrix_every=num_steps * sim_substeps)
-    elif integrator_type == 1:
-        integrator = wp.sim.SemiImplicitIntegrator()
-        sim_substeps *= 5
-    else:
-        integrator = wp.sim.XPBDIntegrator(iterations=2, rigid_contact_relaxation=1.0)
-
-    # renderer = wp.sim.render.SimRendererOpenGL(model, "test_sim_grad.usd", scaling=1.0)
-    renderer = None
-    render_time = 0.0
-
-    if renderer:
-        renderer.render_sphere("target", pos=wp.vec3(target, 0, 0), rot=wp.quat_identity(), radius=0.1, color=(1, 0, 0))
-
-    def rollout(action: wp.array) -> wp.array:
-        nonlocal render_time
-        states = [model.state() for _ in range(num_steps * sim_substeps + 1)]
-
-        wp.sim.eval_fk(model, model.joint_q, model.joint_qd, None, states[0])
-
-        control_active = model.control()
-        control_nop = model.control()
-
-        if not apply_force:
-            wp.launch(
-                assign_action,
-                dim=num_envs,
-                inputs=[action],
-                outputs=[control_active.joint_act],
-                device=model.device,
-            )
-
-        i = 0
-        for step in range(num_steps):
-            state = states[i]
-            if not static_contacts:
-                wp.sim.collide(model, state)
-            if apply_force:
-                control = control_nop
-            else:
-                control = control_active if step < 10 else control_nop
-            if renderer:
-                renderer.begin_frame(render_time)
-                renderer.render(state)
-                renderer.end_frame()
-                render_time += dt
-            for _ in range(sim_substeps):
-                state = states[i]
-                next_state = states[i + 1]
-                if apply_force and step < 10:
-                    wp.launch(
-                        assign_force,
-                        dim=num_envs,
-                        inputs=[action],
-                        outputs=[state.body_f],
-                        device=model.device,
-                    )
-                integrator.simulate(model, state, next_state, dt / sim_substeps, control)
-                i += 1
-
-        if not isinstance(integrator, wp.sim.FeatherstoneIntegrator):
-            # compute generalized coordinates
-            wp.sim.eval_ik(model, states[-1], states[-1].joint_q, states[-1].joint_qd)
-
-        loss = wp.zeros(1, requires_grad=True, device=device)
-        weighting = 1.0
-        wp.launch(
-            evaluate_loss,
-            dim=num_envs,
-            inputs=[states[-1].joint_q, weighting, target],
-            outputs=[loss],
-            device=model.device,
-        )
-
-        # if renderer:
-        #     renderer.save()
-
-        return loss
-
-    action_too_far = wp.array(
-        [80.0 for _ in range(num_envs)],
-        device=device,
-        dtype=wp.float32,
-        requires_grad=True,
-    )
-    tol = 2e-1
-    if isinstance(integrator, wp.sim.XPBDIntegrator):
-        # Euler, XPBD do not yield as accurate gradients, but at least the
-        # signs should match
-        tol = 0.1
-    gradcheck(rollout, [action_too_far], device=device, eps=0.2, tol=tol, print_grad=print_grad)
-
-    action_too_close = wp.array(
-        [40.0 for _ in range(num_envs)],
-        device=device,
-        dtype=wp.float32,
-        requires_grad=True,
-    )
-    gradcheck(rollout, [action_too_close], device=device, eps=0.2, tol=tol, print_grad=print_grad)
-
-
-devices = get_test_devices(mode="basic")
-
-
-class TestSimGradients(unittest.TestCase):
-    pass
-
-
-for jt_type, jt_name in enumerate(["prismatic", "d6"]):
-    test_name = f"test_sphere_pushing_on_rails_{jt_name}"
-
-    def test_fn(self, device, jt_type=jt_type, int_type=1):
-        return test_sphere_pushing_on_rails(
-            self, device, jt_type, int_type, apply_force=True, static_contacts=True, print_grad=False
-        )
-
-    add_function_test(TestSimGradients, test_name, test_fn, devices=devices)
-
-if __name__ == "__main__":
-    wp.clear_kernel_cache()
-    unittest.main(verbosity=2, failfast=True)
diff --git a/warp/tests/sim/test_sim_grad_bounce_linear.py b/warp/tests/sim/test_sim_grad_bounce_linear.py
deleted file mode 100644
index 9cfad811..00000000
--- a/warp/tests/sim/test_sim_grad_bounce_linear.py
+++ /dev/null
@@ -1,212 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2025 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-import numpy as np
-
-import warp as wp
-import warp.optim
-import warp.sim
-import warp.sim.render
-from warp.tests.unittest_utils import *
-
-
-@wp.kernel
-def update_trajectory_kernel(
-    trajectory: wp.array(dtype=wp.vec3),
-    q: wp.array(dtype=wp.transform),
-    time_step: wp.int32,
-    q_idx: wp.int32,
-):
-    trajectory[time_step] = wp.transform_get_translation(q[q_idx])
-
-
-@wp.kernel
-def trajectory_loss_kernel(
-    trajectory: wp.array(dtype=wp.vec3f),
-    target_trajectory: wp.array(dtype=wp.vec3f),
-    loss: wp.array(dtype=wp.float32),
-):
-    tid = wp.tid()
-    diff = trajectory[tid] - target_trajectory[tid]
-    distance_loss = wp.dot(diff, diff)
-    wp.atomic_add(loss, 0, distance_loss)
-
-
-class BallBounceLinearTest:
-    def __init__(self, gravity=True, rendering=False):
-        # Ball bouncing scenario inspired by https://github.com/NVIDIA/warp/issues/349
-        self.fps = 30
-        self.num_frames = 60
-        self.sim_substeps = 20  # XXX need to use enough substeps to achieve smooth gradients
-        self.frame_dt = 1.0 / self.fps
-        self.sim_dt = self.frame_dt / self.sim_substeps
-        self.sim_duration = self.num_frames * self.frame_dt
-        self.sim_steps = int(self.sim_duration // self.sim_dt)
-
-        self.target_force_linear = 100.0
-
-        if gravity:
-            builder = wp.sim.ModelBuilder(up_vector=wp.vec3(0, 0, 1))
-        else:
-            builder = wp.sim.ModelBuilder(gravity=0.0, up_vector=wp.vec3(0, 0, 1))
-
-        b = builder.add_body(origin=wp.transform((0.5, 0.0, 1.0), wp.quat_identity()), name="ball")
-        builder.add_shape_sphere(
-            body=b, radius=0.1, density=100.0, ke=2000.0, kd=10.0, kf=200.0, mu=0.2, thickness=0.01
-        )
-        builder.set_ground_plane(ke=10, kd=10, kf=0.0, mu=0.2)
-        self.model = builder.finalize(requires_grad=True)
-
-        self.time = np.linspace(0, self.sim_duration, self.sim_steps)
-
-        self.integrator = wp.sim.SemiImplicitIntegrator()
-        if rendering:
-            self.renderer = wp.sim.render.SimRendererOpenGL(self.model, "ball_bounce_linear")
-        else:
-            self.renderer = None
-
-        self.loss = wp.array([0], dtype=wp.float32, requires_grad=True)
-        self.states = [self.model.state() for _ in range(self.sim_steps + 1)]
-        self.target_states = [self.model.state() for _ in range(self.sim_steps + 1)]
-
-        self.target_force = wp.array([0.0, 0.0, 0.0, 0.0, self.target_force_linear, 0.0], dtype=wp.spatial_vectorf)
-
-        self.trajectory = wp.empty(len(self.time), dtype=wp.vec3, requires_grad=True)
-        self.target_trajectory = wp.empty(len(self.time), dtype=wp.vec3)
-
-    def _reset(self):
-        self.loss = wp.array([0], dtype=wp.float32, requires_grad=True)
-
-    def generate_target_trajectory(self):
-        for i in range(self.sim_steps):
-            curr_state = self.target_states[i]
-            next_state = self.target_states[i + 1]
-            curr_state.clear_forces()
-            if i == 0:
-                wp.copy(curr_state.body_f, self.target_force, dest_offset=0, src_offset=0, count=1)
-            wp.sim.collide(self.model, curr_state)
-            self.integrator.simulate(self.model, curr_state, next_state, self.sim_dt)
-            wp.launch(kernel=update_trajectory_kernel, dim=1, inputs=[self.target_trajectory, curr_state.body_q, i, 0])
-
-    def forward(self, force: wp.array):
-        for i in range(self.sim_steps):
-            curr_state = self.states[i]
-            next_state = self.states[i + 1]
-            curr_state.clear_forces()
-            if i == 0:
-                wp.copy(curr_state.body_f, force, dest_offset=0, src_offset=0, count=1)
-            wp.sim.collide(self.model, curr_state)
-            self.integrator.simulate(self.model, curr_state, next_state, self.sim_dt)
-            wp.launch(kernel=update_trajectory_kernel, dim=1, inputs=[self.trajectory, curr_state.body_q, i, 0])
-
-            if self.renderer:
-                self.renderer.begin_frame(self.time[i])
-                self.renderer.render(curr_state)
-                self.renderer.end_frame()
-
-    def step(self, force: wp.array):
-        self.tape = wp.Tape()
-        self._reset()
-        with self.tape:
-            self.forward(force)
-            wp.launch(
-                kernel=trajectory_loss_kernel,
-                dim=len(self.trajectory),
-                inputs=[self.trajectory, self.target_trajectory, self.loss],
-            )
-        self.tape.backward(self.loss)
-        force_grad = force.grad.numpy()[0, 4]
-        self.tape.zero()
-
-        return self.loss.numpy()[0], force_grad
-
-    def evaluate(self, num_samples, plot_results=False):
-        forces = np.linspace(0, self.target_force_linear * 2, num_samples)
-        losses = np.zeros_like(forces)
-        grads = np.zeros_like(forces)
-
-        for i, fx in enumerate(forces):
-            force = wp.array([[0.0, 0.0, 0.0, 0.0, fx, 0.0]], dtype=wp.spatial_vectorf, requires_grad=True)
-            losses[i], grads[i] = self.step(force)
-            if plot_results:
-                print(f"Iteration {i + 1}/{num_samples}")
-                print(f"Force: {fx:.2f}, Loss: {losses[i]:.6f}, Grad: {grads[i]:.6f}")
-
-            assert np.isfinite(losses[i])
-            assert np.isfinite(grads[i])
-            if i > 0:
-                assert grads[i] >= grads[i - 1]
-
-        if plot_results:
-            import matplotlib.pyplot as plt
-
-            fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))
-
-            # Plot the loss curve
-            ax1.plot(forces, losses, label="Loss")
-            ax1.set_xlabel("Force")
-            ax1.set_ylabel("Loss")
-            ax1.set_title("Loss vs Force")
-            ax1.legend()
-
-            # Make sure the grads are not too large
-            grads = np.clip(grads, -1e4, 1e4)
-
-            # Plot the gradient curve
-            ax2.plot(forces, grads, label="Gradient", color="orange")
-            ax2.set_xlabel("Force")
-            ax2.set_ylabel("Gradient")
-            ax2.set_title("Gradient vs Force")
-            ax2.legend()
-
-            plt.suptitle("Loss and Gradient vs Force")
-            plt.tight_layout(rect=[0, 0, 1, 0.95])
-            plt.show()
-
-        return losses, grads
-
-
-def test_sim_grad_bounce_linear(test, device):
-    with wp.ScopedDevice(device):
-        model = BallBounceLinearTest()
-        model.generate_target_trajectory()
-
-        num_samples = 20
-        losses, grads = model.evaluate(num_samples=num_samples)
-        # gradients must approximate linear behavior with zero crossing in the middle
-        test.assertTrue(np.abs(grads[1:] - grads[:-1]).max() < 1.1)
-        test.assertTrue(np.all(grads[: num_samples // 2] <= 0.0))
-        test.assertTrue(np.all(grads[num_samples // 2 :] >= 0.0))
-        # losses must follow a parabolic behavior
-        test.assertTrue(np.allclose(losses[: num_samples // 2], losses[num_samples // 2 :][::-1], atol=1.0))
-        diffs = losses[1:] - losses[:-1]
-        test.assertTrue(np.all(diffs[: num_samples // 2 - 1] <= 0.0))
-        test.assertTrue(np.all(diffs[num_samples // 2 - 1 :] >= 0.0))
-        # second derivative must be constant positive
-        diffs2 = diffs[1:] - diffs[:-1]
-        test.assertTrue(np.allclose(diffs2, diffs2[0], atol=1e-2))
-        test.assertTrue(np.all(diffs2 >= 0.0))
-
-
-class TestSimGradBounceLinear(unittest.TestCase):
-    pass
-
-
-devices = get_test_devices("basic")
-add_function_test(TestSimGradBounceLinear, "test_sim_grad_bounce_linear", test_sim_grad_bounce_linear, devices=devices)
-
-if __name__ == "__main__":
-    wp.clear_kernel_cache()
-    unittest.main(verbosity=2, failfast=True)
diff --git a/warp/tests/sim/test_sim_kinematics.py b/warp/tests/sim/test_sim_kinematics.py
deleted file mode 100644
index 71c41516..00000000
--- a/warp/tests/sim/test_sim_kinematics.py
+++ /dev/null
@@ -1,98 +0,0 @@
-# SPDX-FileCopyrightText: Copyright (c) 2022 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
-# SPDX-License-Identifier: Apache-2.0
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-# http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-import math
-import os
-import unittest
-
-import warp as wp
-import warp.examples
-import warp.sim
-from warp.tests.unittest_utils import *
-
-
-def test_fk_ik(test, device):
-    builder = wp.sim.ModelBuilder()
-
-    num_envs = 1
-
-    for i in range(num_envs):
-        wp.sim.parse_mjcf(
-            os.path.join(warp.examples.get_asset_directory(), "nv_ant.xml"),
-            builder,
-            stiffness=0.0,
-            damping=1.0,
-            armature=0.1,
-            contact_ke=1.0e4,
-            contact_kd=1.0e2,
-            contact_kf=1.0e2,
-            contact_mu=0.75,
-            limit_ke=1.0e3,
-            limit_kd=1.0e1,
-            up_axis="y",
-        )
-
-        coord_count = 15
-        dof_count = 14
-
-        coord_start = i * coord_count
-        dof_start = i * dof_count
-
-        # base
-        builder.joint_q[coord_start : coord_start + 3] = [i * 2.0, 0.70, 0.0]
-        builder.joint_q[coord_start + 3 : coord_start + 7] = wp.quat_from_axis_angle(
-            wp.vec3(1.0, 0.0, 0.0), -math.pi * 0.5
-        )
-
-        # joints
-        builder.joint_q[coord_start + 7 : coord_start + coord_count] = [0.0, 1.0, 0.0, -1.0, 0.0, -1.0, 0.0, 1.0]
-        builder.joint_qd[dof_start + 6 : dof_start + dof_count] = [1.0, 1.0, 1.0, -1.0, 1.0, -1.0, 1.0, 1.0]
-
-    # finalize model
-    model = builder.finalize(device=device)
-    model.ground = True
-    model.joint_attach_ke *= 16.0
-    model.joint_attach_kd *= 4.0
-
-    state = model.state()
-
-    # save a copy of joint values
-    q_fk = model.joint_q.numpy()
-    qd_fk = model.joint_qd.numpy()
-
-    wp.sim.eval_fk(model, model.joint_q, model.joint_qd, None, state)
-
-    q_ik = wp.zeros_like(model.joint_q, device=device)
-    qd_ik = wp.zeros_like(model.joint_qd, device=device)
-
-    wp.sim.eval_ik(model, state, q_ik, qd_ik)
-
-    assert_np_equal(q_fk, q_ik.numpy(), tol=1e-6)
-    assert_np_equal(qd_fk, qd_ik.numpy(), tol=1e-6)
-
-
-devices = get_test_devices()
-
-
-class TestSimKinematics(unittest.TestCase):
-    pass
-
-
-add_function_test(TestSimKinematics, "test_fk_ik", test_fk_ik, devices=devices)
-
-
-if __name__ == "__main__":
-    wp.clear_kernel_cache()
-    unittest.main(verbosity=2, failfast=True)
diff --git a/warp/tests/test_adam.py b/warp/tests/test_adam.py
index 6a29da8a..68a70a88 100644
--- a/warp/tests/test_adam.py
+++ b/warp/tests/test_adam.py
@@ -19,7 +19,6 @@ import numpy as np
 
 import warp as wp
 import warp.optim
-import warp.sim
 from warp.tests.unittest_utils import *
 
 
diff --git a/warp/tests/test_array.py b/warp/tests/test_array.py
index 9560359b..5cb6d33b 100644
--- a/warp/tests/test_array.py
+++ b/warp/tests/test_array.py
@@ -1011,7 +1011,7 @@ def test_fill_slices(test, device):
         assert_np_equal(a3.numpy(), np.zeros(a3.shape, dtype=nptype))
         assert_np_equal(a4.numpy(), np.zeros(a4.shape, dtype=nptype))
 
-        # partititon each array into even and odd slices
+        # partition each array into even and odd slices
         a1a = a1[::2]
         a1b = a1[1::2]
         a2a = a2[::2]
@@ -3169,6 +3169,428 @@ def test_cuda_interface_conversion(test, device):
     assert wp_array.ptr != 0
 
 
+@wp.kernel
+def test_array1d_slicing_kernel(arr: wp.array1d(dtype=int)):
+    sub = arr[:3]
+    wp.expect_eq(sub.ndim, 1)
+    wp.expect_eq(sub.shape[0], 3)
+    wp.expect_eq(sub.shape[1], 0)
+    wp.expect_eq(sub[0], 0)
+    wp.expect_eq(sub[2], 2)
+
+    sub = arr[3:5]
+    wp.expect_eq(sub.ndim, 1)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 0)
+    wp.expect_eq(sub[0], 3)
+    wp.expect_eq(sub[1], 4)
+
+    sub = arr[3::-1]
+    wp.expect_eq(sub.ndim, 1)
+    wp.expect_eq(sub.shape[0], 4)
+    wp.expect_eq(sub.shape[1], 0)
+    wp.expect_eq(sub[0], 3)
+    wp.expect_eq(sub[3], 0)
+
+    sub = arr[::-3]
+    sub = sub[::2]
+    wp.expect_eq(sub.ndim, 1)
+    wp.expect_eq(sub.shape[0], 3)
+    wp.expect_eq(sub.shape[1], 0)
+    wp.expect_eq(sub[0], 15)
+    wp.expect_eq(sub[2], 3)
+
+
+def test_array1d_slicing(test, device):
+    arr = wp.array(tuple(range(16)), dtype=int, device=device)
+    wp.launch(test_array1d_slicing_kernel, dim=1, inputs=(arr,), device=device)
+
+
+@wp.kernel
+def test_array2d_slicing_kernel(arr: wp.array2d(dtype=int)):
+    sub = arr[:2]
+    wp.expect_eq(sub.ndim, 2)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 4)
+    wp.expect_eq(sub.shape[2], 0)
+    wp.expect_eq(sub[0, 0], 0)
+    wp.expect_eq(sub[1, 3], 7)
+
+    sub = arr[:2, 1]
+    wp.expect_eq(sub.ndim, 1)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 0)
+    wp.expect_eq(sub[0], 1)
+    wp.expect_eq(sub[1], 5)
+
+    sub = arr[-4, :3]
+    wp.expect_eq(sub.ndim, 1)
+    wp.expect_eq(sub.shape[0], 3)
+    wp.expect_eq(sub.shape[1], 0)
+    wp.expect_eq(sub[0], 16)
+    wp.expect_eq(sub[2], 18)
+
+    sub = arr[3:5, 3:1:-1]
+    wp.expect_eq(sub.ndim, 2)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 2)
+    wp.expect_eq(sub.shape[2], 0)
+    wp.expect_eq(sub[0, 0], 15)
+    wp.expect_eq(sub[1, 1], 18)
+
+    sub = arr[::4]
+    sub = sub[:, ::-3]
+    wp.expect_eq(sub.ndim, 2)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 2)
+    wp.expect_eq(sub.shape[2], 0)
+    wp.expect_eq(sub[0, 0], 3)
+    wp.expect_eq(sub[1, 1], 16)
+
+
+def test_array2d_slicing(test, device):
+    arr = wp.array(tuple(range(32)), dtype=int, shape=(8, 4), device=device)
+    wp.launch(test_array2d_slicing_kernel, dim=1, inputs=(arr,), device=device)
+
+
+@wp.kernel
+def test_array3d_slicing_kernel(arr: wp.array3d(dtype=int)):
+    sub = arr[-1:]
+    wp.expect_eq(sub.ndim, 3)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 8)
+    wp.expect_eq(sub.shape[2], 4)
+    wp.expect_eq(sub.shape[3], 0)
+    wp.expect_eq(sub[0, 0, 0], 32)
+    wp.expect_eq(sub[0, 7, 3], 63)
+
+    sub = arr[:2, -3]
+    wp.expect_eq(sub.ndim, 2)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 4)
+    wp.expect_eq(sub.shape[2], 0)
+    wp.expect_eq(sub[0, 0], 20)
+    wp.expect_eq(sub[1, 3], 55)
+
+    sub = arr[1, 2:]
+    wp.expect_eq(sub.ndim, 2)
+    wp.expect_eq(sub.shape[0], 6)
+    wp.expect_eq(sub.shape[1], 4)
+    wp.expect_eq(sub.shape[2], 0)
+    wp.expect_eq(sub[0, 0], 40)
+    wp.expect_eq(sub[5, 3], 63)
+
+    sub = arr[:1, 3:1:-1]
+    wp.expect_eq(sub.ndim, 3)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 2)
+    wp.expect_eq(sub.shape[2], 4)
+    wp.expect_eq(sub.shape[3], 0)
+    wp.expect_eq(sub[0, 0, 0], 12)
+    wp.expect_eq(sub[0, 1, 3], 11)
+
+    sub = arr[::-2, 1, 3]
+    wp.expect_eq(sub.ndim, 1)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 0)
+    wp.expect_eq(sub[0], 39)
+
+    sub = arr[0, 2:5, -3]
+    wp.expect_eq(sub.ndim, 1)
+    wp.expect_eq(sub.shape[0], 3)
+    wp.expect_eq(sub.shape[1], 0)
+    wp.expect_eq(sub[0], 9)
+    wp.expect_eq(sub[2], 17)
+
+    sub = arr[0, -2, ::2]
+    wp.expect_eq(sub.ndim, 1)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 0)
+    wp.expect_eq(sub[0], 24)
+    wp.expect_eq(sub[1], 26)
+
+    sub = arr[-1:, :5:2, 0]
+    wp.expect_eq(sub.ndim, 2)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 3)
+    wp.expect_eq(sub.shape[2], 0)
+    wp.expect_eq(sub[0, 0], 32)
+    wp.expect_eq(sub[0, 2], 48)
+
+    sub = arr[:, 0, ::2]
+    wp.expect_eq(sub.ndim, 2)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 2)
+    wp.expect_eq(sub.shape[2], 0)
+    wp.expect_eq(sub[0, 0], 0)
+    wp.expect_eq(sub[1, 1], 34)
+
+    sub = arr[1, ::-4, ::-3]
+    wp.expect_eq(sub.ndim, 2)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 2)
+    wp.expect_eq(sub.shape[2], 0)
+    wp.expect_eq(sub[0, 0], 63)
+    wp.expect_eq(sub[1, 1], 44)
+
+    sub = arr[::2, :3:, -2:]
+    wp.expect_eq(sub.ndim, 3)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 3)
+    wp.expect_eq(sub.shape[2], 2)
+    wp.expect_eq(sub.shape[3], 0)
+    wp.expect_eq(sub[0, 0, 0], 2)
+    wp.expect_eq(sub[0, 2, 1], 11)
+
+    sub = arr[:, :1]
+    sub = sub[:, :, :2]
+    wp.expect_eq(sub.ndim, 3)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 1)
+    wp.expect_eq(sub.shape[2], 2)
+    wp.expect_eq(sub.shape[3], 0)
+    wp.expect_eq(sub[0, 0, 0], 0)
+    wp.expect_eq(sub[1, 0, 1], 33)
+
+
+def test_array3d_slicing(test, device):
+    arr = wp.array(tuple(range(64)), dtype=int, shape=(2, 8, 4), device=device)
+    wp.launch(test_array3d_slicing_kernel, dim=1, inputs=(arr,), device=device)
+
+
+@wp.kernel
+def test_array4d_slicing_kernel(arr: wp.array4d(dtype=int)):
+    sub = arr[:1]
+    wp.expect_eq(sub.ndim, 4)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 2)
+    wp.expect_eq(sub.shape[2], 2)
+    wp.expect_eq(sub.shape[3], 4)
+    wp.expect_eq(sub[0, 0, 0, 0], 0)
+    wp.expect_eq(sub[0, 1, 1, 3], 15)
+
+    sub = arr[2:, 0]
+    wp.expect_eq(sub.ndim, 3)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 2)
+    wp.expect_eq(sub.shape[2], 4)
+    wp.expect_eq(sub.shape[3], 0)
+    wp.expect_eq(sub[0, 0, 0], 32)
+    wp.expect_eq(sub[1, 1, 3], 55)
+
+    sub = arr[-1, -1:]
+    wp.expect_eq(sub.ndim, 3)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 2)
+    wp.expect_eq(sub.shape[2], 4)
+    wp.expect_eq(sub.shape[3], 0)
+    wp.expect_eq(sub[0, 0, 0], 56)
+    wp.expect_eq(sub[0, 1, 3], 63)
+
+    sub = arr[3:4, :1]
+    wp.expect_eq(sub.ndim, 4)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 1)
+    wp.expect_eq(sub.shape[2], 2)
+    wp.expect_eq(sub.shape[3], 4)
+    wp.expect_eq(sub[0, 0, 0, 0], 48)
+    wp.expect_eq(sub[0, 0, 1, 3], 55)
+
+    sub = arr[2::, 0, -1]
+    wp.expect_eq(sub.ndim, 2)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 4)
+    wp.expect_eq(sub.shape[2], 0)
+    wp.expect_eq(sub[0, 0], 36)
+    wp.expect_eq(sub[1, 3], 55)
+
+    sub = arr[-2, ::2, -2]
+    wp.expect_eq(sub.ndim, 2)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 4)
+    wp.expect_eq(sub.shape[2], 0)
+    wp.expect_eq(sub[0, 0], 32)
+    wp.expect_eq(sub[0, 3], 35)
+
+    sub = arr[1, -1, ::-3]
+    wp.expect_eq(sub.ndim, 2)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 4)
+    wp.expect_eq(sub.shape[2], 0)
+    wp.expect_eq(sub[0, 0], 28)
+    wp.expect_eq(sub[0, 3], 31)
+
+    sub = arr[1::2, :-1, 0]
+    wp.expect_eq(sub.ndim, 3)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 1)
+    wp.expect_eq(sub.shape[2], 4)
+    wp.expect_eq(sub.shape[3], 0)
+    wp.expect_eq(sub[0, 0, 0], 16)
+    wp.expect_eq(sub[1, 0, 3], 51)
+
+    sub = arr[:2, 1, 1:]
+    wp.expect_eq(sub.ndim, 3)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 1)
+    wp.expect_eq(sub.shape[2], 4)
+    wp.expect_eq(sub.shape[3], 0)
+    wp.expect_eq(sub[0, 0, 0], 12)
+    wp.expect_eq(sub[1, 0, 3], 31)
+
+    sub = arr[-1, :1, ::-3]
+    wp.expect_eq(sub.ndim, 3)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 1)
+    wp.expect_eq(sub.shape[2], 4)
+    wp.expect_eq(sub.shape[3], 0)
+    wp.expect_eq(sub[0, 0, 0], 52)
+    wp.expect_eq(sub[0, 0, 3], 55)
+
+    sub = arr[::-4, :1, 1:]
+    wp.expect_eq(sub.ndim, 4)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 1)
+    wp.expect_eq(sub.shape[2], 1)
+    wp.expect_eq(sub.shape[3], 4)
+    wp.expect_eq(sub[0, 0, 0, 0], 52)
+    wp.expect_eq(sub[0, 0, 0, 3], 55)
+
+    sub = arr[:2, 0, 1, 2]
+    wp.expect_eq(sub.ndim, 1)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 0)
+    wp.expect_eq(sub[0], 6)
+    wp.expect_eq(sub[1], 22)
+
+    sub = arr[-3, ::2, 0, 2]
+    wp.expect_eq(sub.ndim, 1)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 0)
+    wp.expect_eq(sub[0], 18)
+
+    sub = arr[2, 0, :-1, 1]
+    wp.expect_eq(sub.ndim, 1)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 0)
+    wp.expect_eq(sub[0], 33)
+
+    sub = arr[1, 0, 1, :]
+    wp.expect_eq(sub.ndim, 1)
+    wp.expect_eq(sub.shape[0], 4)
+    wp.expect_eq(sub.shape[1], 0)
+    wp.expect_eq(sub[0], 20)
+    wp.expect_eq(sub[3], 23)
+
+    sub = arr[1:, :2, 1, -3]
+    wp.expect_eq(sub.ndim, 2)
+    wp.expect_eq(sub.shape[0], 3)
+    wp.expect_eq(sub.shape[1], 2)
+    wp.expect_eq(sub.shape[2], 0)
+    wp.expect_eq(sub[0, 0], 21)
+    wp.expect_eq(sub[2, 1], 61)
+
+    sub = arr[2:, 0, :2, 1]
+    wp.expect_eq(sub.ndim, 2)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 2)
+    wp.expect_eq(sub.shape[2], 0)
+    wp.expect_eq(sub[0, 0], 33)
+    wp.expect_eq(sub[1, 1], 53)
+
+    sub = arr[::-2, 0, 0, ::3]
+    wp.expect_eq(sub.ndim, 2)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 2)
+    wp.expect_eq(sub.shape[2], 0)
+    wp.expect_eq(sub[0, 0], 48)
+    wp.expect_eq(sub[1, 1], 19)
+
+    sub = arr[-2, 1:2, ::-1, 0]
+    wp.expect_eq(sub.ndim, 2)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 2)
+    wp.expect_eq(sub.shape[2], 0)
+    wp.expect_eq(sub[0, 0], 44)
+    wp.expect_eq(sub[0, 1], 40)
+
+    sub = arr[1, :2, 0, ::-2]
+    wp.expect_eq(sub.ndim, 2)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 2)
+    wp.expect_eq(sub.shape[2], 0)
+    wp.expect_eq(sub[0, 0], 19)
+    wp.expect_eq(sub[1, 1], 25)
+
+    sub = arr[-1, 0, ::3, -4:-1]
+    wp.expect_eq(sub.ndim, 2)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 3)
+    wp.expect_eq(sub.shape[2], 0)
+    wp.expect_eq(sub[0, 0], 48)
+    wp.expect_eq(sub[0, 2], 50)
+
+    sub = arr[-2:, 1:2, ::3, 1]
+    wp.expect_eq(sub.ndim, 3)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 1)
+    wp.expect_eq(sub.shape[2], 1)
+    wp.expect_eq(sub.shape[3], 0)
+    wp.expect_eq(sub[0, 0, 0], 41)
+    wp.expect_eq(sub[1, 0, 0], 57)
+
+    sub = arr[:1, :, 1, -2:]
+    wp.expect_eq(sub.ndim, 3)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 2)
+    wp.expect_eq(sub.shape[2], 2)
+    wp.expect_eq(sub.shape[3], 0)
+    wp.expect_eq(sub[0, 0, 0], 6)
+    wp.expect_eq(sub[0, 1, 1], 15)
+
+    sub = arr[:2:-1, 0, -1:, ::-1]
+    wp.expect_eq(sub.ndim, 3)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 1)
+    wp.expect_eq(sub.shape[2], 4)
+    wp.expect_eq(sub.shape[3], 0)
+    wp.expect_eq(sub[0, 0, 0], 55)
+    wp.expect_eq(sub[0, 0, 3], 52)
+
+    sub = arr[-2, ::-1, -2:, 1:3]
+    wp.expect_eq(sub.ndim, 3)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 2)
+    wp.expect_eq(sub.shape[2], 2)
+    wp.expect_eq(sub.shape[3], 0)
+    wp.expect_eq(sub[0, 0, 0], 41)
+    wp.expect_eq(sub[1, 1, 1], 38)
+
+    sub = arr[:2, 1:, 1:, :-2]
+    wp.expect_eq(sub.ndim, 4)
+    wp.expect_eq(sub.shape[0], 2)
+    wp.expect_eq(sub.shape[1], 1)
+    wp.expect_eq(sub.shape[2], 1)
+    wp.expect_eq(sub.shape[3], 2)
+    wp.expect_eq(sub[0, 0, 0, 0], 12)
+    wp.expect_eq(sub[1, 0, 0, 1], 29)
+
+    sub = arr[-2:, 1, ::-1]
+    sub = sub[::2]
+    wp.expect_eq(sub.ndim, 3)
+    wp.expect_eq(sub.shape[0], 1)
+    wp.expect_eq(sub.shape[1], 2)
+    wp.expect_eq(sub.shape[2], 4)
+    wp.expect_eq(sub.shape[3], 0)
+    wp.expect_eq(sub[0, 0, 0], 44)
+    wp.expect_eq(sub[0, 1, 3], 43)
+
+
+def test_array4d_slicing(test, device):
+    arr = wp.array(tuple(range(64)), dtype=int, shape=(4, 2, 2, 4), device=device)
+    wp.launch(test_array4d_slicing_kernel, dim=1, inputs=(arr,), device=device)
+
+
 devices = get_test_devices()
 
 
@@ -3249,6 +3671,11 @@ add_function_test(TestArray, "test_array_len", test_array_len, devices=devices)
 add_function_test(TestArray, "test_cuda_interface_conversion", test_cuda_interface_conversion, devices=devices)
 add_function_test(TestArray, "test_array_from_data", test_array_from_data, devices=devices)
 
+add_function_test(TestArray, "test_array1d_slicing", test_array1d_slicing, devices=devices)
+add_function_test(TestArray, "test_array2d_slicing", test_array2d_slicing, devices=devices)
+add_function_test(TestArray, "test_array3d_slicing", test_array3d_slicing, devices=devices)
+add_function_test(TestArray, "test_array4d_slicing", test_array4d_slicing, devices=devices)
+
 try:
     import torch
 
diff --git a/warp/tests/test_atomic.py b/warp/tests/test_atomic.py
index a2edb813..9d6a125d 100644
--- a/warp/tests/test_atomic.py
+++ b/warp/tests/test_atomic.py
@@ -132,14 +132,18 @@ test_atomic_mat44 = make_atomic_test(wp.mat44)
 
 
 def test_atomic_add_supported_dtypes(test, device, dtype):
+    N = 1024
     scalar_type = getattr(dtype, "_wp_scalar_type_", dtype)
 
     @wp.kernel
     def kernel(arr: wp.array(dtype=dtype)):
-        wp.atomic_add(arr, 0, dtype(scalar_type(0)))
+        wp.atomic_add(arr, 0, dtype(scalar_type(1)))
 
     arr = wp.zeros(1, dtype=dtype, device=device)
-    wp.launch(kernel, dim=1, outputs=(arr,), device=device)
+    wp.launch(kernel, dim=N, outputs=(arr,), device=device)
+
+    size = 1 if not hasattr(dtype, "_shape_") else dtype._shape_
+    assert_np_equal(arr.numpy().flatten(), np.full(size, N, dtype=wp.types.warp_type_to_np_dtype[scalar_type]))
 
 
 def test_atomic_min_supported_dtypes(test, device, dtype):
diff --git a/warp/tests/test_atomic_bitwise.py b/warp/tests/test_atomic_bitwise.py
new file mode 100644
index 00000000..0b552011
--- /dev/null
+++ b/warp/tests/test_atomic_bitwise.py
@@ -0,0 +1,209 @@
+# SPDX-FileCopyrightText: Copyright (c) 2025 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
+# SPDX-License-Identifier: Apache-2.0
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+# http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+import unittest
+
+import numpy as np
+
+import warp as wp
+from warp.tests.unittest_utils import *
+
+
+@wp.kernel
+def test_atomic_bitwise_kernel(a: wp.array(dtype=wp.uint32), b: wp.array(dtype=wp.uint32), op_type: int):
+    i = wp.tid()
+    word_idx = i // 32
+    bit_idx = i % 32
+    bit_mask = wp.uint32(1) << wp.uint32(bit_idx)
+    if op_type == 0:
+        a[word_idx] &= (b[word_idx] & bit_mask) | ~bit_mask
+    elif op_type == 1:
+        a[word_idx] |= b[word_idx] & bit_mask
+    elif op_type == 2:
+        a[word_idx] ^= b[word_idx] & bit_mask
+    elif op_type == 3:
+        wp.atomic_and(a, word_idx, (b[word_idx] & bit_mask) | ~bit_mask)
+    elif op_type == 4:
+        wp.atomic_or(a, word_idx, b[word_idx] & bit_mask)
+    elif op_type == 5:
+        wp.atomic_xor(a, word_idx, b[word_idx] & bit_mask)
+
+
+def test_atomic_bitwise_scalar(test, device):
+    n = 1024
+    rng = np.random.default_rng(42)
+
+    a = rng.integers(0, np.iinfo(np.uint32).max, size=n, dtype=np.uint32)
+    b = rng.integers(0, np.iinfo(np.uint32).max, size=n, dtype=np.uint32)
+
+    expected_and = a & b
+    expected_or = a | b
+    expected_xor = a ^ b
+
+    with wp.ScopedDevice(device):
+        and_op_array = wp.array(a, dtype=wp.uint32, device=device)
+        or_op_array = wp.array(a, dtype=wp.uint32, device=device)
+        xor_op_array = wp.array(a, dtype=wp.uint32, device=device)
+        atomic_and_array = wp.array(a, dtype=wp.uint32, device=device)
+        atomic_or_array = wp.array(a, dtype=wp.uint32, device=device)
+        atomic_xor_array = wp.array(a, dtype=wp.uint32, device=device)
+
+        target_array = wp.array(b, dtype=wp.uint32, device=device)
+
+        wp.launch(test_atomic_bitwise_kernel, dim=n * 32, inputs=[and_op_array, target_array, 0])
+        wp.launch(test_atomic_bitwise_kernel, dim=n * 32, inputs=[or_op_array, target_array, 1])
+        wp.launch(test_atomic_bitwise_kernel, dim=n * 32, inputs=[xor_op_array, target_array, 2])
+        wp.launch(test_atomic_bitwise_kernel, dim=n * 32, inputs=[atomic_and_array, target_array, 3])
+        wp.launch(test_atomic_bitwise_kernel, dim=n * 32, inputs=[atomic_or_array, target_array, 4])
+        wp.launch(test_atomic_bitwise_kernel, dim=n * 32, inputs=[atomic_xor_array, target_array, 5])
+
+        assert_np_equal(and_op_array.numpy(), expected_and)
+        assert_np_equal(or_op_array.numpy(), expected_or)
+        assert_np_equal(xor_op_array.numpy(), expected_xor)
+        assert_np_equal(atomic_and_array.numpy(), expected_and)
+        assert_np_equal(atomic_or_array.numpy(), expected_or)
+        assert_np_equal(atomic_xor_array.numpy(), expected_xor)
+
+
+@wp.kernel
+def test_atomic_bitwise_vector_kernel(a: wp.array(dtype=wp.vec3ui), b: wp.array(dtype=wp.vec3ui), op_type: int):
+    i = wp.tid()
+    word_idx = i // 32
+    bit_idx = i % 32
+    bit_mask = wp.vec3ui(wp.uint32(1)) << wp.vec3ui(wp.uint32(bit_idx))
+    if op_type == 0:
+        a[word_idx] &= (b[word_idx] & bit_mask) | ~bit_mask
+    elif op_type == 1:
+        a[word_idx] |= b[word_idx] & bit_mask
+    elif op_type == 2:
+        a[word_idx] ^= b[word_idx] & bit_mask
+    elif op_type == 3:
+        wp.atomic_and(a, word_idx, (b[word_idx] & bit_mask) | ~bit_mask)
+    elif op_type == 4:
+        wp.atomic_or(a, word_idx, b[word_idx] & bit_mask)
+    elif op_type == 5:
+        wp.atomic_xor(a, word_idx, b[word_idx] & bit_mask)
+
+
+def test_atomic_bitwise_vector(test, device):
+    n = 1024
+    rng = np.random.default_rng(42)
+
+    a = rng.integers(0, np.iinfo(np.uint32).max, size=(n, 3), dtype=np.uint32)
+    b = rng.integers(0, np.iinfo(np.uint32).max, size=(n, 3), dtype=np.uint32)
+
+    expected_and = a & b
+    expected_or = a | b
+    expected_xor = a ^ b
+
+    with wp.ScopedDevice(device):
+        and_op_array = wp.array(a, dtype=wp.vec3ui, device=device)
+        or_op_array = wp.array(a, dtype=wp.vec3ui, device=device)
+        xor_op_array = wp.array(a, dtype=wp.vec3ui, device=device)
+        atomic_and_array = wp.array(a, dtype=wp.vec3ui, device=device)
+        atomic_or_array = wp.array(a, dtype=wp.vec3ui, device=device)
+        atomic_xor_array = wp.array(a, dtype=wp.vec3ui, device=device)
+
+        target_array = wp.array(b, dtype=wp.vec3ui, device=device)
+
+        wp.launch(test_atomic_bitwise_vector_kernel, dim=n * 32, inputs=[and_op_array, target_array, 0])
+        wp.launch(test_atomic_bitwise_vector_kernel, dim=n * 32, inputs=[or_op_array, target_array, 1])
+        wp.launch(test_atomic_bitwise_vector_kernel, dim=n * 32, inputs=[xor_op_array, target_array, 2])
+        wp.launch(test_atomic_bitwise_vector_kernel, dim=n * 32, inputs=[atomic_and_array, target_array, 3])
+        wp.launch(test_atomic_bitwise_vector_kernel, dim=n * 32, inputs=[atomic_or_array, target_array, 4])
+        wp.launch(test_atomic_bitwise_vector_kernel, dim=n * 32, inputs=[atomic_xor_array, target_array, 5])
+
+        assert_np_equal(and_op_array.numpy(), expected_and)
+        assert_np_equal(or_op_array.numpy(), expected_or)
+        assert_np_equal(xor_op_array.numpy(), expected_xor)
+        assert_np_equal(atomic_and_array.numpy(), expected_and)
+        assert_np_equal(atomic_or_array.numpy(), expected_or)
+        assert_np_equal(atomic_xor_array.numpy(), expected_xor)
+
+
+mat33ui = wp.types.matrix(shape=(3, 3), dtype=wp.uint32)
+
+
+@wp.kernel
+def test_atomic_bitwise_matrix_kernel(a: wp.array(dtype=mat33ui), b: wp.array(dtype=mat33ui), op_type: int):
+    i = wp.tid()
+    word_idx = i // 32
+    bit_idx = i % 32
+    bit_mask = mat33ui(wp.uint32(1)) << mat33ui(wp.uint32(bit_idx))
+    if op_type == 0:
+        a[word_idx] &= (b[word_idx] & bit_mask) | ~bit_mask
+    elif op_type == 1:
+        a[word_idx] |= b[word_idx] & bit_mask
+    elif op_type == 2:
+        a[word_idx] ^= b[word_idx] & bit_mask
+    elif op_type == 3:
+        wp.atomic_and(a, word_idx, (b[word_idx] & bit_mask) | ~bit_mask)
+    elif op_type == 4:
+        wp.atomic_or(a, word_idx, b[word_idx] & bit_mask)
+    elif op_type == 5:
+        wp.atomic_xor(a, word_idx, b[word_idx] & bit_mask)
+
+
+def test_atomic_bitwise_matrix(test, device):
+    n = 1024
+    rng = np.random.default_rng(42)
+
+    a = rng.integers(0, np.iinfo(np.uint32).max, size=(n, 3, 3), dtype=np.uint32)
+    b = rng.integers(0, np.iinfo(np.uint32).max, size=(n, 3, 3), dtype=np.uint32)
+
+    expected_and = a & b
+    expected_or = a | b
+    expected_xor = a ^ b
+
+    with wp.ScopedDevice(device):
+        and_op_array = wp.array(a, dtype=mat33ui, device=device)
+        or_op_array = wp.array(a, dtype=mat33ui, device=device)
+        xor_op_array = wp.array(a, dtype=mat33ui, device=device)
+        atomic_and_array = wp.array(a, dtype=mat33ui, device=device)
+        atomic_or_array = wp.array(a, dtype=mat33ui, device=device)
+        atomic_xor_array = wp.array(a, dtype=mat33ui, device=device)
+
+        target_array = wp.array(b, dtype=mat33ui, device=device)
+
+        wp.launch(test_atomic_bitwise_matrix_kernel, dim=n * 32, inputs=[and_op_array, target_array, 0])
+        wp.launch(test_atomic_bitwise_matrix_kernel, dim=n * 32, inputs=[or_op_array, target_array, 1])
+        wp.launch(test_atomic_bitwise_matrix_kernel, dim=n * 32, inputs=[xor_op_array, target_array, 2])
+        wp.launch(test_atomic_bitwise_matrix_kernel, dim=n * 32, inputs=[atomic_and_array, target_array, 3])
+        wp.launch(test_atomic_bitwise_matrix_kernel, dim=n * 32, inputs=[atomic_or_array, target_array, 4])
+        wp.launch(test_atomic_bitwise_matrix_kernel, dim=n * 32, inputs=[atomic_xor_array, target_array, 5])
+
+        assert_np_equal(and_op_array.numpy(), expected_and)
+        assert_np_equal(or_op_array.numpy(), expected_or)
+        assert_np_equal(xor_op_array.numpy(), expected_xor)
+        assert_np_equal(atomic_and_array.numpy(), expected_and)
+        assert_np_equal(atomic_or_array.numpy(), expected_or)
+        assert_np_equal(atomic_xor_array.numpy(), expected_xor)
+
+
+devices = get_test_devices()
+
+
+class TestAtomicBitwise(unittest.TestCase):
+    pass
+
+
+add_function_test(TestAtomicBitwise, "test_atomic_bitwise_scalar", test_atomic_bitwise_scalar, devices=devices)
+add_function_test(TestAtomicBitwise, "test_atomic_bitwise_vector", test_atomic_bitwise_vector, devices=devices)
+add_function_test(TestAtomicBitwise, "test_atomic_bitwise_matrix", test_atomic_bitwise_matrix, devices=devices)
+
+
+if __name__ == "__main__":
+    wp.clear_kernel_cache()
+    unittest.main(verbosity=2)
diff --git a/warp/tests/test_copy.py b/warp/tests/test_copy.py
index 12c2f2d7..f0896308 100644
--- a/warp/tests/test_copy.py
+++ b/warp/tests/test_copy.py
@@ -13,6 +13,8 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
+import gc
+import importlib
 import unittest
 
 import numpy as np
@@ -45,164 +47,217 @@ def mul_4d(a: wp.array4d(dtype=float), s: float):
     a[i, j, k, l] = a[i, j, k, l] * s
 
 
-def test_copy_strided(test, device):
-    with wp.ScopedDevice(device):
-        np_data1 = np.arange(10, dtype=np.float32)
-        np_data2 = np.arange(100, dtype=np.float32).reshape((10, 10))
-        np_data3 = np.arange(1000, dtype=np.float32).reshape((10, 10, 10))
-        np_data4 = np.arange(10000, dtype=np.float32).reshape((10, 10, 10, 10))
-
-        wp_data1 = wp.array(data=np_data1, copy=True)
-        wp_data2 = wp.array(data=np_data2, copy=True)
-        wp_data3 = wp.array(data=np_data3, copy=True)
-        wp_data4 = wp.array(data=np_data4, copy=True)
-
-        expected1 = np_data1[1::2]
-        expected2 = np_data2[1::2, 1::2]
-        expected3 = np_data3[1::2, 1::2, 1::2]
-        expected4 = np_data4[1::2, 1::2, 1::2, 1::2]
-
-        a1 = wp_data1[1::2]
-        a2 = wp_data2[1::2, 1::2]
-        a3 = wp_data3[1::2, 1::2, 1::2]
-        a4 = wp_data4[1::2, 1::2, 1::2, 1::2]
-
-        assert_np_equal(a1.numpy(), expected1)
-        assert_np_equal(a2.numpy(), expected2)
-        assert_np_equal(a3.numpy(), expected3)
-        assert_np_equal(a4.numpy(), expected4)
-
-        b1 = wp.zeros_like(a1)
-        b2 = wp.zeros_like(a2)
-        b3 = wp.zeros_like(a3)
-        b4 = wp.zeros_like(a4)
-
-        test.assertFalse(a1.is_contiguous)
-        test.assertFalse(a2.is_contiguous)
-        test.assertFalse(a3.is_contiguous)
-        test.assertFalse(a4.is_contiguous)
-
-        test.assertTrue(b1.is_contiguous)
-        test.assertTrue(b2.is_contiguous)
-        test.assertTrue(b3.is_contiguous)
-        test.assertTrue(b4.is_contiguous)
-
-        # copy non-contiguous to contiguous
-        wp.copy(b1, a1)
-        wp.copy(b2, a2)
-        wp.copy(b3, a3)
-        wp.copy(b4, a4)
-
-        assert_np_equal(a1.numpy(), b1.numpy())
-        assert_np_equal(a2.numpy(), b2.numpy())
-        assert_np_equal(a3.numpy(), b3.numpy())
-        assert_np_equal(a4.numpy(), b4.numpy())
-
-        s = 2.0
-
-        wp.launch(mul_1d, dim=b1.shape, inputs=[b1, s])
-        wp.launch(mul_2d, dim=b2.shape, inputs=[b2, s])
-        wp.launch(mul_3d, dim=b3.shape, inputs=[b3, s])
-        wp.launch(mul_4d, dim=b4.shape, inputs=[b4, s])
-
-        # copy contiguous to non-contiguous
-        wp.copy(a1, b1)
-        wp.copy(a2, b2)
-        wp.copy(a3, b3)
-        wp.copy(a4, b4)
-
-        assert_np_equal(a1.numpy(), b1.numpy())
-        assert_np_equal(a2.numpy(), b2.numpy())
-        assert_np_equal(a3.numpy(), b3.numpy())
-        assert_np_equal(a4.numpy(), b4.numpy())
-
-        assert_np_equal(a1.numpy(), expected1 * s)
-        assert_np_equal(a2.numpy(), expected2 * s)
-        assert_np_equal(a3.numpy(), expected3 * s)
-        assert_np_equal(a4.numpy(), expected4 * s)
-
-
-def test_copy_indexed(test, device):
-    with wp.ScopedDevice(device):
-        np_data1 = np.arange(10, dtype=np.float32)
-        np_data2 = np.arange(100, dtype=np.float32).reshape((10, 10))
-        np_data3 = np.arange(1000, dtype=np.float32).reshape((10, 10, 10))
-        np_data4 = np.arange(10000, dtype=np.float32).reshape((10, 10, 10, 10))
-
-        wp_data1 = wp.array(data=np_data1, copy=True)
-        wp_data2 = wp.array(data=np_data2, copy=True)
-        wp_data3 = wp.array(data=np_data3, copy=True)
-        wp_data4 = wp.array(data=np_data4, copy=True)
-
-        np_indices = np.array([1, 5, 8, 9])
-        wp_indices = wp.array(data=np_indices, dtype=wp.int32)
-
-        # Note: Indexing using multiple index arrays works differently
-        #       in Numpy and Warp, so the syntax is different.
-
-        expected1 = np_data1[np_indices]
-        expected2 = np_data2[np_indices][:, np_indices]
-        expected3 = np_data3[np_indices][:, np_indices][:, :, np_indices]
-        expected4 = np_data4[np_indices][:, np_indices][:, :, np_indices][:, :, :, np_indices]
-
-        a1 = wp_data1[wp_indices]
-        a2 = wp_data2[wp_indices, wp_indices]
-        a3 = wp_data3[wp_indices, wp_indices, wp_indices]
-        a4 = wp_data4[wp_indices, wp_indices, wp_indices, wp_indices]
-
-        assert_np_equal(a1.numpy(), expected1)
-        assert_np_equal(a2.numpy(), expected2)
-        assert_np_equal(a3.numpy(), expected3)
-        assert_np_equal(a4.numpy(), expected4)
-
-        b1 = wp.zeros_like(a1)
-        b2 = wp.zeros_like(a2)
-        b3 = wp.zeros_like(a3)
-        b4 = wp.zeros_like(a4)
-
-        test.assertFalse(a1.is_contiguous)
-        test.assertFalse(a2.is_contiguous)
-        test.assertFalse(a3.is_contiguous)
-        test.assertFalse(a4.is_contiguous)
-
-        test.assertTrue(b1.is_contiguous)
-        test.assertTrue(b2.is_contiguous)
-        test.assertTrue(b3.is_contiguous)
-        test.assertTrue(b4.is_contiguous)
-
-        # copy non-contiguous to contiguous
-        wp.copy(b1, a1)
-        wp.copy(b2, a2)
-        wp.copy(b3, a3)
-        wp.copy(b4, a4)
-
-        assert_np_equal(a1.numpy(), b1.numpy())
-        assert_np_equal(a2.numpy(), b2.numpy())
-        assert_np_equal(a3.numpy(), b3.numpy())
-        assert_np_equal(a4.numpy(), b4.numpy())
-
-        s = 2.0
-
-        wp.launch(mul_1d, dim=b1.shape, inputs=[b1, s])
-        wp.launch(mul_2d, dim=b2.shape, inputs=[b2, s])
-        wp.launch(mul_3d, dim=b3.shape, inputs=[b3, s])
-        wp.launch(mul_4d, dim=b4.shape, inputs=[b4, s])
-
-        # copy contiguous to non-contiguous
-        wp.copy(a1, b1)
-        wp.copy(a2, b2)
-        wp.copy(a3, b3)
-        wp.copy(a4, b4)
-
-        assert_np_equal(a1.numpy(), b1.numpy())
-        assert_np_equal(a2.numpy(), b2.numpy())
-        assert_np_equal(a3.numpy(), b3.numpy())
-        assert_np_equal(a4.numpy(), b4.numpy())
-
-        assert_np_equal(a1.numpy(), expected1 * s)
-        assert_np_equal(a2.numpy(), expected2 * s)
-        assert_np_equal(a3.numpy(), expected3 * s)
-        assert_np_equal(a4.numpy(), expected4 * s)
+@wp.kernel
+def all_equal_kernel(a: wp.array(dtype=float), value: float, result: wp.array(dtype=int)):
+    tid = wp.tid()
+    wp.atomic_min(result, 0, int(a[tid] == value))
+
+
+def assert_all_equal(a: wp.array(dtype=float), value: float):
+    result = wp.ones(1, dtype=int, device=a.device)
+    wp.launch(all_equal_kernel, dim=a.shape, inputs=[a, value, result], device=a.device)
+    assert result.numpy()[0] == 1
+
+
+def test_copy_strided(test, _, device1, device2):
+    np_data1 = np.arange(10, dtype=np.float32)
+    np_data2 = np.arange(100, dtype=np.float32).reshape((10, 10))
+    np_data3 = np.arange(1000, dtype=np.float32).reshape((10, 10, 10))
+    np_data4 = np.arange(10000, dtype=np.float32).reshape((10, 10, 10, 10))
+
+    wp_data1 = wp.array(data=np_data1, copy=True, device=device1)
+    wp_data2 = wp.array(data=np_data2, copy=True, device=device1)
+    wp_data3 = wp.array(data=np_data3, copy=True, device=device1)
+    wp_data4 = wp.array(data=np_data4, copy=True, device=device1)
+
+    expected1 = np_data1[1::2]
+    expected2 = np_data2[1::2, 1::2]
+    expected3 = np_data3[1::2, 1::2, 1::2]
+    expected4 = np_data4[1::2, 1::2, 1::2, 1::2]
+
+    a1 = wp_data1[1::2]
+    a2 = wp_data2[1::2, 1::2]
+    a3 = wp_data3[1::2, 1::2, 1::2]
+    a4 = wp_data4[1::2, 1::2, 1::2, 1::2]
+
+    assert_np_equal(a1.numpy(), expected1)
+    assert_np_equal(a2.numpy(), expected2)
+    assert_np_equal(a3.numpy(), expected3)
+    assert_np_equal(a4.numpy(), expected4)
+
+    b1 = wp.zeros_like(a1, device=device2)
+    b2 = wp.zeros_like(a2, device=device2)
+    b3 = wp.zeros_like(a3, device=device2)
+    b4 = wp.zeros_like(a4, device=device2)
+
+    test.assertFalse(a1.is_contiguous)
+    test.assertFalse(a2.is_contiguous)
+    test.assertFalse(a3.is_contiguous)
+    test.assertFalse(a4.is_contiguous)
+
+    test.assertTrue(b1.is_contiguous)
+    test.assertTrue(b2.is_contiguous)
+    test.assertTrue(b3.is_contiguous)
+    test.assertTrue(b4.is_contiguous)
+
+    # copy non-contiguous to contiguous
+    wp.synchronize_device(device1)
+    wp.copy(b1, a1)
+    wp.copy(b2, a2)
+    wp.copy(b3, a3)
+    wp.copy(b4, a4)
+
+    assert_np_equal(a1.numpy(), b1.numpy())
+    assert_np_equal(a2.numpy(), b2.numpy())
+    assert_np_equal(a3.numpy(), b3.numpy())
+    assert_np_equal(a4.numpy(), b4.numpy())
+
+    s = 2.0
+
+    wp.launch(mul_1d, dim=b1.shape, inputs=[b1, s], device=device2)
+    wp.launch(mul_2d, dim=b2.shape, inputs=[b2, s], device=device2)
+    wp.launch(mul_3d, dim=b3.shape, inputs=[b3, s], device=device2)
+    wp.launch(mul_4d, dim=b4.shape, inputs=[b4, s], device=device2)
+
+    # copy contiguous to non-contiguous
+    wp.synchronize_device(device2)
+    wp.copy(a1, b1)
+    wp.copy(a2, b2)
+    wp.copy(a3, b3)
+    wp.copy(a4, b4)
+
+    assert_np_equal(a1.numpy(), b1.numpy())
+    assert_np_equal(a2.numpy(), b2.numpy())
+    assert_np_equal(a3.numpy(), b3.numpy())
+    assert_np_equal(a4.numpy(), b4.numpy())
+
+    assert_np_equal(a1.numpy(), expected1 * s)
+    assert_np_equal(a2.numpy(), expected2 * s)
+    assert_np_equal(a3.numpy(), expected3 * s)
+    assert_np_equal(a4.numpy(), expected4 * s)
+
+
+def test_copy_indexed(test, _, device1, device2):
+    np_data1 = np.arange(10, dtype=np.float32)
+    np_data2 = np.arange(100, dtype=np.float32).reshape((10, 10))
+    np_data3 = np.arange(1000, dtype=np.float32).reshape((10, 10, 10))
+    np_data4 = np.arange(10000, dtype=np.float32).reshape((10, 10, 10, 10))
+
+    wp_data1 = wp.array(data=np_data1, copy=True, device=device1)
+    wp_data2 = wp.array(data=np_data2, copy=True, device=device1)
+    wp_data3 = wp.array(data=np_data3, copy=True, device=device1)
+    wp_data4 = wp.array(data=np_data4, copy=True, device=device1)
+
+    np_indices = np.array([1, 5, 8, 9])
+    wp_indices = wp.array(data=np_indices, dtype=wp.int32, device=device1)
+
+    # Note: Indexing using multiple index arrays works differently
+    #       in Numpy and Warp, so the syntax is different.
+
+    expected1 = np_data1[np_indices]
+    expected2 = np_data2[np_indices][:, np_indices]
+    expected3 = np_data3[np_indices][:, np_indices][:, :, np_indices]
+    expected4 = np_data4[np_indices][:, np_indices][:, :, np_indices][:, :, :, np_indices]
+
+    a1 = wp_data1[wp_indices]
+    a2 = wp_data2[wp_indices, wp_indices]
+    a3 = wp_data3[wp_indices, wp_indices, wp_indices]
+    a4 = wp_data4[wp_indices, wp_indices, wp_indices, wp_indices]
+
+    assert_np_equal(a1.numpy(), expected1)
+    assert_np_equal(a2.numpy(), expected2)
+    assert_np_equal(a3.numpy(), expected3)
+    assert_np_equal(a4.numpy(), expected4)
+
+    b1 = wp.zeros_like(a1, device=device2)
+    b2 = wp.zeros_like(a2, device=device2)
+    b3 = wp.zeros_like(a3, device=device2)
+    b4 = wp.zeros_like(a4, device=device2)
+
+    test.assertFalse(a1.is_contiguous)
+    test.assertFalse(a2.is_contiguous)
+    test.assertFalse(a3.is_contiguous)
+    test.assertFalse(a4.is_contiguous)
+
+    test.assertTrue(b1.is_contiguous)
+    test.assertTrue(b2.is_contiguous)
+    test.assertTrue(b3.is_contiguous)
+    test.assertTrue(b4.is_contiguous)
+
+    # copy non-contiguous to contiguous
+    wp.synchronize_device(device1)
+    wp.copy(b1, a1)
+    wp.copy(b2, a2)
+    wp.copy(b3, a3)
+    wp.copy(b4, a4)
+
+    assert_np_equal(a1.numpy(), b1.numpy())
+    assert_np_equal(a2.numpy(), b2.numpy())
+    assert_np_equal(a3.numpy(), b3.numpy())
+    assert_np_equal(a4.numpy(), b4.numpy())
+
+    s = 2.0
+
+    wp.launch(mul_1d, dim=b1.shape, inputs=[b1, s], device=device2)
+    wp.launch(mul_2d, dim=b2.shape, inputs=[b2, s], device=device2)
+    wp.launch(mul_3d, dim=b3.shape, inputs=[b3, s], device=device2)
+    wp.launch(mul_4d, dim=b4.shape, inputs=[b4, s], device=device2)
+
+    # copy contiguous to non-contiguous
+    wp.synchronize_device(device2)
+    wp.copy(a1, b1)
+    wp.copy(a2, b2)
+    wp.copy(a3, b3)
+    wp.copy(a4, b4)
+
+    assert_np_equal(a1.numpy(), b1.numpy())
+    assert_np_equal(a2.numpy(), b2.numpy())
+    assert_np_equal(a3.numpy(), b3.numpy())
+    assert_np_equal(a4.numpy(), b4.numpy())
+
+    assert_np_equal(a1.numpy(), expected1 * s)
+    assert_np_equal(a2.numpy(), expected2 * s)
+    assert_np_equal(a3.numpy(), expected3 * s)
+    assert_np_equal(a4.numpy(), expected4 * s)
+
+
+def test_copy_large_stride(test, _, device1, device2):
+    # NOTE: This test can use ~8GB of memory. To prevent errors, we skip if there is insufficient memory.
+
+    gc.collect()
+
+    if device1.is_cpu or device2.is_cpu:
+        if importlib.util.find_spec("psutil") is None:
+            test.skipTest("The 'psutil' package is required to check available memory")
+
+    if device1.free_memory < 12e9 or device2.free_memory < 12e9:
+        test.skipTest("Insufficient free memory")
+
+    N = 500_000_000
+
+    a_data = wp.empty((N, 2), dtype=wp.float32, device=device1)
+    a = a_data[:, 0]  # array with a large stride (offsets > 32 bits)
+
+    b = wp.empty_like(a, device=device2)
+
+    a.fill_(1)
+    b.fill_(2)
+
+    # NOTE: use a memory-efficient check to avoid running out of memory
+    assert_all_equal(a, 1)
+    assert_all_equal(b, 2)
+
+    # copy to large-strided array
+    wp.synchronize_device(device2)
+    wp.copy(a, b)
+    assert_all_equal(a, 2)
+
+    a.fill_(1)
+
+    # copy from large-strided array
+    wp.synchronize_device(device1)
+    wp.copy(b, a)
+    assert_all_equal(b, 1)
 
 
 def test_copy_adjoint(test, device):
@@ -228,10 +283,36 @@ class TestCopy(unittest.TestCase):
     pass
 
 
-add_function_test(TestCopy, "test_copy_strided", test_copy_strided, devices=devices)
-add_function_test(TestCopy, "test_copy_indexed", test_copy_indexed, devices=devices)
-add_function_test(TestCopy, "test_copy_adjoint", test_copy_adjoint, devices=devices)
+for src_device in devices:
+    src_name = "cpu" if src_device.is_cpu else f"cuda{src_device.ordinal}"
+    for dst_device in devices:
+        dst_name = "cpu" if dst_device.is_cpu else f"cuda{dst_device.ordinal}"
+        add_function_test(
+            TestCopy,
+            f"test_copy_strided_{src_name}_{dst_name}",
+            test_copy_strided,
+            devices=None,
+            device1=src_device,
+            device2=dst_device,
+        )
+        add_function_test(
+            TestCopy,
+            f"test_copy_indexed_{src_name}_{dst_name}",
+            test_copy_indexed,
+            devices=None,
+            device1=src_device,
+            device2=dst_device,
+        )
+        add_function_test(
+            TestCopy,
+            f"test_copy_large_stride_{src_name}_{dst_name}",
+            test_copy_large_stride,
+            devices=None,
+            device1=src_device,
+            device2=dst_device,
+        )
 
+add_function_test(TestCopy, "test_copy_adjoint", test_copy_adjoint, devices=devices)
 
 if __name__ == "__main__":
     wp.clear_kernel_cache()
diff --git a/warp/tests/test_examples.py b/warp/tests/test_examples.py
index f20b0ce7..ce094941 100644
--- a/warp/tests/test_examples.py
+++ b/warp/tests/test_examples.py
@@ -52,8 +52,6 @@ from warp.tests.unittest_utils import (
 )
 from warp.utils import check_p2p
 
-wp.init()  # For wp.context.runtime.core.wp_is_debug_enabled()
-
 
 def _build_command_line_options(test_options: Dict[str, Any]) -> list:
     """Helper function to build command-line options from the test options dictionary."""
@@ -280,25 +278,6 @@ class TestOptimExamples(unittest.TestCase):
     pass
 
 
-add_example_test(
-    TestOptimExamples,
-    name="optim.example_bounce",
-    devices=test_devices,
-    test_options_cpu={"train_iters": 3},
-)
-add_example_test(
-    TestOptimExamples,
-    name="optim.example_drone",
-    devices=test_devices,
-    test_options={"headless": True},
-    test_options_cpu={"num_frames": 10},
-)
-add_example_test(
-    TestOptimExamples,
-    name="optim.example_cloth_throw",
-    devices=test_devices,
-    test_options_cpu={"train_iters": 3},
-)
 add_example_test(
     TestOptimExamples,
     name="optim.example_diffray",
@@ -312,68 +291,6 @@ add_example_test(
     devices=cuda_test_devices,
     test_options={"headless": True, "train_iters": 5, "num_frames": 300, "pillow_required": True},
 )
-add_example_test(TestOptimExamples, name="optim.example_inverse_kinematics", devices=test_devices)
-add_example_test(
-    TestOptimExamples,
-    name="optim.example_inverse_kinematics_torch",
-    devices=test_devices,
-    test_options={"torch_required": True},
-)
-add_example_test(TestOptimExamples, name="optim.example_spring_cage", devices=test_devices)
-add_example_test(
-    TestOptimExamples,
-    name="optim.example_trajectory",
-    devices=test_devices,
-    test_options={"headless": True, "train_iters": 50},
-)
-add_example_test(
-    TestOptimExamples,
-    name="optim.example_softbody_properties",
-    devices=test_devices,
-    test_options_cuda={
-        "train_iters": 1 if warp.context.runtime.core.wp_is_debug_enabled() else 3,
-    },
-    test_options_cpu={"train_iters": 1},
-)
-
-
-class TestSimExamples(unittest.TestCase):
-    pass
-
-
-add_example_test(TestSimExamples, name="sim.example_cartpole", devices=test_devices)
-add_example_test(
-    TestSimExamples,
-    name="sim.example_cloth",
-    devices=test_devices,
-    test_options={"usd_required": True},
-    test_options_cpu={"num_frames": 10},
-)
-add_example_test(
-    TestSimExamples, name="sim.example_granular", devices=test_devices, test_options_cpu={"num_frames": 10}
-)
-add_example_test(TestSimExamples, name="sim.example_granular_collision_sdf", devices=cuda_test_devices)
-add_example_test(TestSimExamples, name="sim.example_jacobian_ik", devices=test_devices)
-add_example_test(TestSimExamples, name="sim.example_particle_chain", devices=test_devices)
-add_example_test(
-    TestSimExamples, name="sim.example_quadruped", devices=test_devices, test_options_cpu={"num_frames": 100}
-)
-add_example_test(TestSimExamples, name="sim.example_rigid_chain", devices=test_devices)
-add_example_test(
-    TestSimExamples,
-    name="sim.example_rigid_contact",
-    devices=test_devices,
-    test_options={"usd_required": True},
-    test_options_cpu={"num_frames": 3},
-)
-add_example_test(
-    TestSimExamples, name="sim.example_rigid_soft_contact", devices=test_devices, test_options_cpu={"num_frames": 10}
-)
-add_example_test(TestSimExamples, name="sim.example_rigid_force", devices=test_devices)
-add_example_test(TestSimExamples, name="sim.example_rigid_gyroscopic", devices=test_devices)
-add_example_test(
-    TestSimExamples, name="sim.example_soft_body", devices=test_devices, test_options_cpu={"num_frames": 10}
-)
 
 
 class TestFemExamples(unittest.TestCase):
diff --git a/warp/tests/test_func.py b/warp/tests/test_func.py
index eb72fd82..d45a8e7f 100644
--- a/warp/tests/test_func.py
+++ b/warp/tests/test_func.py
@@ -443,10 +443,7 @@ class TestFunc(unittest.TestCase):
             a * b
 
     def test_cpython_call_user_function_with_error(self):
-        with self.assertRaisesRegex(
-            ZeroDivisionError,
-            "float division by zero",
-        ):
+        with self.assertRaises(ZeroDivisionError):
             divide_by_zero(1.0)
 
     def test_cpython_call_user_function_with_wrong_argument_types(self):
diff --git a/warp/tests/test_map.py b/warp/tests/test_map.py
index 4d3a503e..29031268 100644
--- a/warp/tests/test_map.py
+++ b/warp/tests/test_map.py
@@ -101,6 +101,37 @@ def test_lambda(test, device):
     expected = np.array(np.arange(10) * local_var, dtype=np.float32)
     assert_np_equal(out2.numpy(), expected)
 
+    # inline variable construction which uses parentheses
+    out = wp.map(lambda a: wp.length(wp.vec3(a, a + 1.0, a + 2.0)), a1)
+    expected = np.array([np.sqrt(i * i + (i + 1) * (i + 1) + (i + 2) * (i + 2)) for i in range(10)], dtype=np.float32)
+    assert_np_equal(out.numpy(), expected)
+
+    # multi-line lambda
+    # fmt: off
+    out = wp.map(lambda a: (\
+        a + 1.0 + 2.0 + 3.0 + 4.0 + 5.0 \
+            + 6.0 + 7.0 + 8.0 + 9.0 + 10.0\
+    ), a1)
+    # fmt: on
+    expected = np.array([np.sum(np.arange(1, 11)) + i for i in range(10)], dtype=np.float32)
+    assert_np_equal(out.numpy(), expected)
+
+    # complicated expression with parentheses and line continuation
+    # fmt: off
+    out = wp.map(lambda a: (
+        a + 1.0 + ((
+            + 6.0 + 7.0 + 8.0) + 9.0 + (10.0
+            # an inline comment to make sure it is ignored
+            + 0.0) \
+            + wp.clamp(a, -0.5, 0.5) \
+            + (wp.sin(a) + wp.cos(a))
+    )), a1)
+    # fmt: on
+    expected = np.array(
+        [41.0 + i + np.clip(i, -0.5, 0.5) + (np.sin(i) + np.cos(i)) for i in range(10)], dtype=np.float32
+    )
+    assert_np_equal(out.numpy(), expected, tol=1e-6)
+
 
 def test_multiple_return_values(test, device):
     @wp.func
diff --git a/warp/tests/test_quat.py b/warp/tests/test_quat.py
index c93bc0a7..6be3e937 100644
--- a/warp/tests/test_quat.py
+++ b/warp/tests/test_quat.py
@@ -18,7 +18,6 @@ import unittest
 import numpy as np
 
 import warp as wp
-import warp.sim
 from warp.tests.unittest_utils import *
 
 np_float_types = [np.float32, np.float64, np.float16]
@@ -26,6 +25,43 @@ np_float_types = [np.float32, np.float64, np.float16]
 kernel_cache = {}
 
 
+@wp.func
+def quat_from_euler(e: wp.vec3, i: int, j: int, k: int) -> wp.quat:
+    """
+    Convert Euler angles to a quaternion.
+
+    :math:`i, j, k` are the indices in :math:`[0, 1, 2]` of the axes in which the Euler angles are provided
+    (:math:`i \\neq j, j \\neq k`), e.g. (0, 1, 2) for Euler sequence XYZ.
+
+    Args:
+        e (vec3): The Euler angles (in radians)
+        i (int): The index of the first axis
+        j (int): The index of the second axis
+        k (int): The index of the third axis
+
+    Returns:
+        quat: The quaternion
+    """
+    # Half angles
+    half_e = e / 2.0
+
+    # Precompute sines and cosines of half angles
+    cr = wp.cos(half_e[i])
+    sr = wp.sin(half_e[i])
+    cp = wp.cos(half_e[j])
+    sp = wp.sin(half_e[j])
+    cy = wp.cos(half_e[k])
+    sy = wp.sin(half_e[k])
+
+    # Components of the quaternion based on the rotation sequence
+    return wp.quat(
+        (cy * sr * cp - sy * cr * sp),
+        (cy * cr * sp + sy * sr * cp),
+        (sy * cr * cp - cy * sr * sp),
+        (cy * cr * cp + sy * sr * sp),
+    )
+
+
 def getkernel(func, suffix=""):
     key = func.__name__ + "_" + suffix
     if key not in kernel_cache:
@@ -1909,7 +1945,7 @@ def test_quat_euler_conversion(test, device, dtype, register_kernels=False):
 
     rpy_arr = rng.uniform(low=-np.pi, high=np.pi, size=(N, 3))
 
-    quats_from_euler = [list(wp.sim.quat_from_euler(wp.vec3(*rpy), 0, 1, 2)) for rpy in rpy_arr]
+    quats_from_euler = [list(quat_from_euler(wp.vec3(*rpy), 0, 1, 2)) for rpy in rpy_arr]
     quats_from_rpy = [list(wp.quat_rpy(rpy[0], rpy[1], rpy[2])) for rpy in rpy_arr]
 
     assert_np_equal(np.array(quats_from_euler), np.array(quats_from_rpy), tol=1e-4)
diff --git a/warp/tests/test_sparse.py b/warp/tests/test_sparse.py
index 9e465fab..7ee9dbf8 100644
--- a/warp/tests/test_sparse.py
+++ b/warp/tests/test_sparse.py
@@ -59,6 +59,17 @@ def _triplets_to_dense(shape, rows, cols, values):
     return mat
 
 
+def _bsr_pruned(bsr):
+    return bsr_from_triplets(
+        rows_of_blocks=bsr.nrow,
+        cols_of_blocks=bsr.ncol,
+        rows=bsr.uncompress_rows(),
+        columns=bsr.columns,
+        values=bsr.values,
+        prune_numerical_zeros=True,
+    )
+
+
 def _bsr_to_dense(bsr):
     mat = np.zeros(bsr.shape)
 
@@ -363,9 +374,9 @@ def make_test_bsr_transpose(block_shape, scalar_type):
         bsr_set_from_triplets(bsr, rows, cols, vals)
         ref = 2.0 * np.transpose(_bsr_to_dense(bsr))
 
-        bsr_transposed = (2.0 * bsr).transpose()
+        bsr_transposed = (2.0 * bsr).transpose().eval()
 
-        res = _bsr_to_dense(bsr_transposed.eval())
+        res = _bsr_to_dense(bsr_transposed)
         assert_np_equal(res, ref, 0.0001)
 
         if block_shape[0] != block_shape[-1]:
@@ -373,6 +384,22 @@ def make_test_bsr_transpose(block_shape, scalar_type):
             with test.assertRaisesRegex(ValueError, "Destination block shape must be"):
                 bsr_set_transpose(dest=bsr, src=bsr)
 
+        # test masked transpose
+        # remove some non zeros from src and dest matrices
+        bsr_set_from_triplets(bsr, rows[:3], cols[:3], vals[:3])
+        bsr_transposed = bsr_from_triplets(
+            bsr_transposed.nrow,
+            bsr_transposed.ncol,
+            bsr_transposed.uncompress_rows()[:3],
+            bsr_transposed.columns[:3],
+            bsr_transposed.values[:3],
+        )
+
+        assert_np_equal(bsr_transposed.uncompress_rows().numpy()[:3], [0, 1, 1])
+        assert_np_equal(bsr_transposed.columns.numpy()[:3], [2, 0, 2])
+        bsr_set_transpose(bsr_transposed, bsr, masked=True)
+        assert _bsr_pruned(bsr_transposed).nnz_sync() == 2
+
     return test_bsr_transpose
 
 
@@ -664,6 +691,45 @@ def make_test_bsr_multiply_deep(block_shape, scalar_type):
     return test_bsr_multiply_deep
 
 
+def test_capturability(test, device):
+    """Test that BSR operations are graph-capturable"""
+
+    N = 5
+    M = 3
+
+    C = bsr_diag(wp.zeros(N, dtype=wp.mat33, device=device))
+
+    rows = wp.array([3, 4, 2, 0, 1], dtype=int, device=device)
+    columns = wp.array([2, 0, 1, 2, 1], dtype=int, device=device)
+    values = wp.ones(5, dtype=wp.mat33, device=device)
+
+    def test_body():
+        A = bsr_from_triplets(
+            N,
+            M,
+            rows=rows,
+            columns=columns,
+            values=values,
+        )
+        B = A + bsr_copy(A * 2.0)
+        bsr_mm(A, bsr_transposed(B), C, masked=True)
+
+    # ensure necessary modules are loaded and reset result
+    test_body()
+    C *= 0.0
+
+    with wp.ScopedDevice(device):
+        with wp.ScopedCapture(force_module_load=False) as capture:
+            test_body()
+
+    assert_array_equal(bsr_get_diag(C), wp.zeros(N, dtype=wp.mat33, device=device))
+
+    wp.capture_launch(capture.graph)
+    wp.synchronize_device(device)
+
+    assert_array_equal(bsr_get_diag(C), wp.full(N, value=wp.mat33(9.0), dtype=wp.mat33, device=device))
+
+
 devices = get_test_devices()
 cuda_test_devices = get_selected_cuda_test_devices()
 
@@ -686,7 +752,10 @@ class TestSparse(unittest.TestCase):
         bsr_scale(x=diag_copy, alpha=0.0)
         self.assertEqual(diag_copy.nrow, nrow)
         self.assertEqual(diag_copy.ncol, nrow)
-        self.assertEqual(diag_copy.nnz, 0)
+        self.assertEqual(diag_copy.nnz, diag_bsr.nnz)
+
+        diag_pruned = _bsr_pruned(diag_copy)
+        self.assertEqual(diag_pruned.nnz_sync(), 0)
 
 
 add_function_test(TestSparse, "test_csr_from_triplets", test_csr_from_triplets, devices=devices)
@@ -728,6 +797,7 @@ add_function_test(TestSparse, "test_csr_mv", make_test_bsr_mv((1, 1), wp.float32
 add_function_test(TestSparse, "test_bsr_mv_1_3", make_test_bsr_mv((1, 3), wp.float32), devices=devices)
 add_function_test(TestSparse, "test_bsr_mv_3_3", make_test_bsr_mv((3, 3), wp.float64), devices=devices)
 
+add_function_test(TestSparse, "test_capturability", test_capturability, devices=cuda_test_devices)
 
 if __name__ == "__main__":
     wp.clear_kernel_cache()
diff --git a/warp/tests/test_spatial.py b/warp/tests/test_spatial.py
index 25e1836a..405afba2 100644
--- a/warp/tests/test_spatial.py
+++ b/warp/tests/test_spatial.py
@@ -147,12 +147,12 @@ def test_spatial_vector_indexing(test, device, dtype, register_kernels=False):
         input: wp.array(dtype=spatial_vector),
         out: wp.array(dtype=wptype),
     ):
-        inpt = input[0]
+        elem = input[0]
 
         # multiply outputs by 2 so we've got something to backpropagate:
         idx = 0
         for i in range(6):
-            out[idx] = wptype(2) * inpt[i]
+            out[idx] = wptype(2) * elem[i]
             idx = idx + 1
 
     kernel = getkernel(check_spatial_vector_indexing, suffix=dtype.__name__)
@@ -679,12 +679,12 @@ def test_transform_indexing(test, device, dtype, register_kernels=False):
         input: wp.array(dtype=transform),
         out: wp.array(dtype=wptype),
     ):
-        inpt = input[0]
+        elem = input[0]
 
         # multiply outputs by 2 so we've got something to backpropagate:
         idx = 0
         for i in range(7):
-            out[idx] = wptype(2) * inpt[i]
+            out[idx] = wptype(2) * elem[i]
             idx = idx + 1
 
     kernel = getkernel(check_transform_indexing, suffix=dtype.__name__)
@@ -1349,13 +1349,13 @@ def test_spatial_matrix_indexing(test, device, dtype, register_kernels=False):
         input: wp.array(dtype=spatial_matrix),
         out: wp.array(dtype=wptype),
     ):
-        inpt = input[0]
+        elem = input[0]
 
         # multiply outputs by 2 so we've got something to backpropagate:
         idx = 0
         for i in range(6):
             for j in range(6):
-                out[idx] = wptype(2) * inpt[i, j]
+                out[idx] = wptype(2) * elem[i, j]
                 idx = idx + 1
 
     kernel = getkernel(check_spatial_matrix_indexing, suffix=dtype.__name__)
diff --git a/warp/tests/test_static.py b/warp/tests/test_static.py
index 98629534..7d3f9c99 100644
--- a/warp/tests/test_static.py
+++ b/warp/tests/test_static.py
@@ -155,7 +155,7 @@ def test_invalid_static_expression(test, device):
         wp.static(1.0 / 0.0)
 
     with test.assertRaisesRegex(
-        warp.codegen.WarpCodegenError, r"Error evaluating static expression\: float division by zero"
+        warp.codegen.WarpCodegenError, r"Error evaluating static expression\: (?:float )?division by zero"
     ):
         wp.launch(invalid_kernel, 1, device=device)
 
diff --git a/warp/tests/test_triangle_closest_point.py b/warp/tests/test_triangle_closest_point.py
index f087024a..d284215c 100644
--- a/warp/tests/test_triangle_closest_point.py
+++ b/warp/tests/test_triangle_closest_point.py
@@ -15,10 +15,57 @@
 
 import unittest
 
-from warp.sim.collide import triangle_closest_point_barycentric
 from warp.tests.unittest_utils import *
 
 
+@wp.func
+def triangle_closest_point_barycentric(a: wp.vec3, b: wp.vec3, c: wp.vec3, p: wp.vec3):
+    ab = b - a
+    ac = c - a
+    ap = p - a
+
+    d1 = wp.dot(ab, ap)
+    d2 = wp.dot(ac, ap)
+
+    if d1 <= 0.0 and d2 <= 0.0:
+        return wp.vec3(1.0, 0.0, 0.0)
+
+    bp = p - b
+    d3 = wp.dot(ab, bp)
+    d4 = wp.dot(ac, bp)
+
+    if d3 >= 0.0 and d4 <= d3:
+        return wp.vec3(0.0, 1.0, 0.0)
+
+    vc = d1 * d4 - d3 * d2
+    v = d1 / (d1 - d3)
+    if vc <= 0.0 and d1 >= 0.0 and d3 <= 0.0:
+        return wp.vec3(1.0 - v, v, 0.0)
+
+    cp = p - c
+    d5 = wp.dot(ab, cp)
+    d6 = wp.dot(ac, cp)
+
+    if d6 >= 0.0 and d5 <= d6:
+        return wp.vec3(0.0, 0.0, 1.0)
+
+    vb = d5 * d2 - d1 * d6
+    w = d2 / (d2 - d6)
+    if vb <= 0.0 and d2 >= 0.0 and d6 <= 0.0:
+        return wp.vec3(1.0 - w, 0.0, w)
+
+    va = d3 * d6 - d5 * d4
+    w = (d4 - d3) / ((d4 - d3) + (d5 - d6))
+    if va <= 0.0 and (d4 - d3) >= 0.0 and (d5 - d6) >= 0.0:
+        return wp.vec3(0.0, 1.0 - w, w)
+
+    denom = 1.0 / (va + vb + vc)
+    v = vb * denom
+    w = vc * denom
+
+    return wp.vec3(1.0 - v - w, v, w)
+
+
 # a-b is the edge where the closest point is located at
 @wp.func
 def check_edge_feasible_region(p: wp.vec3, a: wp.vec3, b: wp.vec3, c: wp.vec3, eps: float):
diff --git a/warp/tests/tile/test_tile_atomic_bitwise.py b/warp/tests/tile/test_tile_atomic_bitwise.py
new file mode 100644
index 00000000..3966aa6d
--- /dev/null
+++ b/warp/tests/tile/test_tile_atomic_bitwise.py
@@ -0,0 +1,403 @@
+# SPDX-FileCopyrightText: Copyright (c) 2025 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
+# SPDX-License-Identifier: Apache-2.0
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+# http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+import unittest
+
+import numpy as np
+
+import warp as wp
+from warp.tests.unittest_utils import *
+
+
+@wp.kernel
+def test_tile_atomic_bitwise_scalar_kernel(
+    a: wp.array(dtype=wp.uint32), b: wp.array(dtype=wp.uint32), c: wp.array(dtype=wp.uint32), op_type: int
+):
+    word_idx, bit_idx = wp.tid()
+    block_dim = wp.block_dim()
+    assert block_dim == 32
+    s = wp.tile_zeros(shape=1, dtype=wp.uint32)
+    # write to tile first, then write only once to the array
+    s[0] = a[word_idx]
+    if op_type < 3:
+        bit_mask = wp.uint32(1) << wp.uint32(bit_idx)
+        if op_type == 0:
+            s[0] &= (b[word_idx] & bit_mask) | ~bit_mask
+        elif op_type == 1:
+            s[0] |= b[word_idx] & bit_mask
+        elif op_type == 2:
+            s[0] ^= b[word_idx] & bit_mask
+    else:
+        # inter-tile operations
+        s_bit_mask = wp.tile_zeros(shape=32, dtype=wp.uint32)
+        s_bit_mask[(bit_idx + 1) % 32] = wp.uint32(1) << wp.uint32((bit_idx + 1) % 32)
+        if op_type == 3:
+            s[0] &= (b[word_idx] & s_bit_mask[bit_idx]) | ~s_bit_mask[bit_idx]
+        elif op_type == 4:
+            s[0] |= b[word_idx] & s_bit_mask[bit_idx]
+        elif op_type == 5:
+            s[0] ^= b[word_idx] & s_bit_mask[bit_idx]
+    c[word_idx] = s[0]
+
+
+@wp.kernel
+def test_tile_atomic_bitwise_scalar_tilewise_kernel(
+    a: wp.array(dtype=wp.uint32), b: wp.array(dtype=wp.uint32), c: wp.array(dtype=wp.uint32), op_type: int
+):
+    batch_idx, _ = wp.tid()
+    block_dim = wp.block_dim()
+    assert block_dim == 32
+    # Each tile is responsible for a batch of 32 elements
+    s1 = wp.tile_load(a, shape=32, offset=batch_idx * 32)
+    s2 = wp.tile_load(b, shape=32, offset=batch_idx * 32)
+    # inter-tile operations (batch-wise)
+    if op_type < 9:
+        if op_type == 6:
+            s1 &= s2
+        elif op_type == 7:
+            s1 |= s2
+        elif op_type == 8:
+            s1 ^= s2
+        wp.tile_store(c, s1, offset=batch_idx * 32)
+    else:
+        if op_type == 9:
+            s3 = s1 & s2
+        elif op_type == 10:
+            s3 = s1 | s2
+        elif op_type == 11:
+            s3 = s1 ^ s2
+        wp.tile_store(c, s3, offset=batch_idx * 32)
+
+
+def test_tile_atomic_bitwise_scalar(test, device):
+    n = 1024
+    rng = np.random.default_rng(42)
+
+    a = rng.integers(0, np.iinfo(np.uint32).max, size=n, dtype=np.uint32)
+    b = rng.integers(0, np.iinfo(np.uint32).max, size=n, dtype=np.uint32)
+
+    expected_and = a & b
+    expected_or = a | b
+    expected_xor = a ^ b
+
+    with wp.ScopedDevice(device):
+        a_wp = wp.array(a, dtype=wp.uint32, device=device)
+        b_wp = wp.array(b, dtype=wp.uint32, device=device)
+        c_wp = wp.zeros(shape=n, dtype=wp.uint32, device=device)
+
+        wp.launch_tiled(test_tile_atomic_bitwise_scalar_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 0], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_and)
+        wp.launch_tiled(test_tile_atomic_bitwise_scalar_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 1], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_or)
+        wp.launch_tiled(test_tile_atomic_bitwise_scalar_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 2], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_xor)
+        wp.launch_tiled(test_tile_atomic_bitwise_scalar_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 3], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_and)
+        wp.launch_tiled(test_tile_atomic_bitwise_scalar_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 4], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_or)
+        wp.launch_tiled(test_tile_atomic_bitwise_scalar_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 5], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_xor)
+
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_scalar_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 6], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_and)
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_scalar_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 7], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_or)
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_scalar_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 8], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_xor)
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_scalar_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 9], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_and)
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_scalar_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 10], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_or)
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_scalar_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 11], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_xor)
+
+
+@wp.kernel
+def test_tile_atomic_bitwise_vector_kernel(
+    a: wp.array(dtype=wp.vec3ui), b: wp.array(dtype=wp.vec3ui), c: wp.array(dtype=wp.vec3ui), op_type: int
+):
+    word_idx, bit_idx = wp.tid()
+    block_dim = wp.block_dim()
+    assert block_dim == 32
+    s = wp.tile_zeros(shape=1, dtype=wp.vec3ui)
+    # write to tile first, then write only once to the array
+    s[0] = a[word_idx]
+    if op_type < 3:
+        bit_mask = wp.vec3ui(wp.uint32(1)) << wp.vec3ui(wp.uint32(bit_idx))
+        if op_type == 0:
+            s[0] &= (b[word_idx] & bit_mask) | ~bit_mask
+        elif op_type == 1:
+            s[0] |= b[word_idx] & bit_mask
+        elif op_type == 2:
+            s[0] ^= b[word_idx] & bit_mask
+    else:
+        # inter-tile operations
+        s_bit_mask = wp.tile_zeros(shape=32, dtype=wp.vec3ui)
+        s_bit_mask[(bit_idx + 1) % 32] = wp.vec3ui(wp.uint32(1) << wp.uint32((bit_idx + 1) % 32))
+        if op_type == 3:
+            s[0] &= (b[word_idx] & s_bit_mask[bit_idx]) | ~s_bit_mask[bit_idx]
+        elif op_type == 4:
+            s[0] |= b[word_idx] & s_bit_mask[bit_idx]
+        elif op_type == 5:
+            s[0] ^= b[word_idx] & s_bit_mask[bit_idx]
+    c[word_idx] = s[0]
+
+
+@wp.kernel
+def test_tile_atomic_bitwise_vector_tilewise_kernel(
+    a: wp.array(dtype=wp.vec3ui), b: wp.array(dtype=wp.vec3ui), c: wp.array(dtype=wp.vec3ui), op_type: int
+):
+    batch_idx, _ = wp.tid()
+    block_dim = wp.block_dim()
+    assert block_dim == 32
+    # Each tile is responsible for a batch of 32 elements
+    s1 = wp.tile_load(a, shape=32, offset=batch_idx * 32)
+    s2 = wp.tile_load(b, shape=32, offset=batch_idx * 32)
+    # inter-tile operations (batch-wise)
+    if op_type < 9:
+        if op_type == 6:
+            s1 &= s2
+        elif op_type == 7:
+            s1 |= s2
+        elif op_type == 8:
+            s1 ^= s2
+        wp.tile_store(c, s1, offset=batch_idx * 32)
+    else:
+        if op_type == 9:
+            s3 = s1 & s2
+        elif op_type == 10:
+            s3 = s1 | s2
+        elif op_type == 11:
+            s3 = s1 ^ s2
+        wp.tile_store(c, s3, offset=batch_idx * 32)
+
+
+def test_tile_atomic_bitwise_vector(test, device):
+    n = 1024
+    rng = np.random.default_rng(42)
+
+    a = rng.integers(0, np.iinfo(np.uint32).max, size=(n, 3), dtype=np.uint32)
+    b = rng.integers(0, np.iinfo(np.uint32).max, size=(n, 3), dtype=np.uint32)
+
+    expected_and = a & b
+    expected_or = a | b
+    expected_xor = a ^ b
+
+    with wp.ScopedDevice(device):
+        a_wp = wp.array(a, dtype=wp.vec3ui, device=device)
+        b_wp = wp.array(b, dtype=wp.vec3ui, device=device)
+        c_wp = wp.zeros(shape=n, dtype=wp.vec3ui, device=device)
+
+        wp.launch_tiled(test_tile_atomic_bitwise_vector_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 0], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_and)
+        wp.launch_tiled(test_tile_atomic_bitwise_vector_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 1], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_or)
+        wp.launch_tiled(test_tile_atomic_bitwise_vector_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 2], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_xor)
+        wp.launch_tiled(test_tile_atomic_bitwise_vector_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 3], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_and)
+        wp.launch_tiled(test_tile_atomic_bitwise_vector_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 4], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_or)
+        wp.launch_tiled(test_tile_atomic_bitwise_vector_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 5], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_xor)
+
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_vector_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 6], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_and)
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_vector_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 7], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_or)
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_vector_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 8], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_xor)
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_vector_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 9], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_and)
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_vector_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 10], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_or)
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_vector_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 11], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_xor)
+
+
+mat33ui = wp.types.matrix(shape=(3, 3), dtype=wp.uint32)
+
+
+@wp.kernel
+def test_tile_atomic_bitwise_matrix_kernel(
+    a: wp.array(dtype=mat33ui), b: wp.array(dtype=mat33ui), c: wp.array(dtype=mat33ui), op_type: int
+):
+    word_idx, bit_idx = wp.tid()
+    block_dim = wp.block_dim()
+    assert block_dim == 32
+    s = wp.tile_zeros(shape=1, dtype=mat33ui)
+    # write to tile first, then write only once to the array
+    s[0] = a[word_idx]
+    if op_type < 3:
+        bit_mask = mat33ui(wp.uint32(1)) << mat33ui(wp.uint32(bit_idx))
+        if op_type == 0:
+            s[0] &= (b[word_idx] & bit_mask) | ~bit_mask
+        elif op_type == 1:
+            s[0] |= b[word_idx] & bit_mask
+        elif op_type == 2:
+            s[0] ^= b[word_idx] & bit_mask
+    else:
+        # inter-tile operations
+        s_bit_mask = wp.tile_zeros(shape=32, dtype=mat33ui)
+        s_bit_mask[(bit_idx + 1) % 32] = mat33ui(wp.uint32(1) << wp.uint32((bit_idx + 1) % 32))
+        if op_type == 3:
+            s[0] &= (b[word_idx] & s_bit_mask[bit_idx]) | ~s_bit_mask[bit_idx]
+        elif op_type == 4:
+            s[0] |= b[word_idx] & s_bit_mask[bit_idx]
+        elif op_type == 5:
+            s[0] ^= b[word_idx] & s_bit_mask[bit_idx]
+    c[word_idx] = s[0]
+
+
+@wp.kernel
+def test_tile_atomic_bitwise_matrix_tilewise_kernel(
+    a: wp.array(dtype=mat33ui), b: wp.array(dtype=mat33ui), c: wp.array(dtype=mat33ui), op_type: int
+):
+    batch_idx, _ = wp.tid()
+    block_dim = wp.block_dim()
+    assert block_dim == 32
+    # Each tile is responsible for a batch of 32 elements
+    s1 = wp.tile_load(a, shape=32, offset=batch_idx * 32)
+    s2 = wp.tile_load(b, shape=32, offset=batch_idx * 32)
+    # inter-tile operations (batch-wise)
+    if op_type < 9:
+        if op_type == 6:
+            s1 &= s2
+        elif op_type == 7:
+            s1 |= s2
+        elif op_type == 8:
+            s1 ^= s2
+        wp.tile_store(c, s1, offset=batch_idx * 32)
+    else:
+        if op_type == 9:
+            s3 = s1 & s2
+        elif op_type == 10:
+            s3 = s1 | s2
+        elif op_type == 11:
+            s3 = s1 ^ s2
+        wp.tile_store(c, s3, offset=batch_idx * 32)
+
+
+def test_tile_atomic_bitwise_matrix(test, device):
+    n = 1024
+    rng = np.random.default_rng(42)
+
+    a = rng.integers(0, np.iinfo(np.uint32).max, size=(n, 3, 3), dtype=np.uint32)
+    b = rng.integers(0, np.iinfo(np.uint32).max, size=(n, 3, 3), dtype=np.uint32)
+
+    expected_and = a & b
+    expected_or = a | b
+    expected_xor = a ^ b
+
+    with wp.ScopedDevice(device):
+        a_wp = wp.array(a, dtype=mat33ui, device=device)
+        b_wp = wp.array(b, dtype=mat33ui, device=device)
+        c_wp = wp.zeros(shape=n, dtype=mat33ui, device=device)
+
+        wp.launch_tiled(test_tile_atomic_bitwise_matrix_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 0], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_and)
+        wp.launch_tiled(test_tile_atomic_bitwise_matrix_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 1], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_or)
+        wp.launch_tiled(test_tile_atomic_bitwise_matrix_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 2], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_xor)
+        wp.launch_tiled(test_tile_atomic_bitwise_matrix_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 3], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_and)
+        wp.launch_tiled(test_tile_atomic_bitwise_matrix_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 4], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_or)
+        wp.launch_tiled(test_tile_atomic_bitwise_matrix_kernel, dim=n, inputs=[a_wp, b_wp, c_wp, 5], block_dim=32)
+        assert_np_equal(c_wp.numpy(), expected_xor)
+
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_matrix_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 6], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_and)
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_matrix_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 7], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_or)
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_matrix_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 8], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_xor)
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_matrix_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 9], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_and)
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_matrix_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 10], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_or)
+        wp.launch_tiled(
+            test_tile_atomic_bitwise_matrix_tilewise_kernel, dim=n // 32, inputs=[a_wp, b_wp, c_wp, 11], block_dim=32
+        )
+        assert_np_equal(c_wp.numpy(), expected_xor)
+
+
+devices = get_cuda_test_devices()
+
+
+class TestTileAtomicBitwise(unittest.TestCase):
+    pass
+
+
+add_function_test(
+    TestTileAtomicBitwise,
+    "test_tile_atomic_bitwise_scalar",
+    test_tile_atomic_bitwise_scalar,
+    devices=devices,
+)
+
+add_function_test(
+    TestTileAtomicBitwise,
+    "test_tile_atomic_bitwise_vector",
+    test_tile_atomic_bitwise_vector,
+    devices=devices,
+)
+
+add_function_test(
+    TestTileAtomicBitwise,
+    "test_tile_atomic_bitwise_matrix",
+    test_tile_atomic_bitwise_matrix,
+    devices=devices,
+)
+
+
+if __name__ == "__main__":
+    wp.clear_kernel_cache()
+    unittest.main(verbosity=2)
diff --git a/warp/tests/tile/test_tile_load.py b/warp/tests/tile/test_tile_load.py
index 15a74007..e364e868 100644
--- a/warp/tests/tile/test_tile_load.py
+++ b/warp/tests/tile/test_tile_load.py
@@ -40,6 +40,7 @@ def tile_load_1d_kernel(
     input: wp.array1d(dtype=float),
     out_full: wp.array1d(dtype=float),
     out_padded: wp.array1d(dtype=float),
+    out_sliced: wp.array1d(dtype=float),
     out_offset: wp.array1d(dtype=float),
 ):
     full0 = wp.tile_load(input, TILE_M)
@@ -50,8 +51,13 @@ def tile_load_1d_kernel(
     padded1 = wp.tile_load(input, shape=TILE_M, offset=TILE_OFFSET)
     padded2 = wp.tile_load(input, shape=(TILE_M,), offset=(TILE_OFFSET,))
 
+    sliced0 = wp.tile_load(input[::2], TILE_M)
+    sliced1 = wp.tile_load(input[::2], shape=TILE_M)
+    sliced2 = wp.tile_load(input[::2], shape=(TILE_M,))
+
     wp.tile_store(out_full, full0)
     wp.tile_store(out_padded, padded0)
+    wp.tile_store(out_sliced, sliced0)
     wp.tile_store(out_offset, full0, offset=(TILE_OFFSET,))
 
 
@@ -60,13 +66,16 @@ def tile_load_2d_kernel(
     input: wp.array2d(dtype=float),
     out_full: wp.array2d(dtype=float),
     out_padded: wp.array2d(dtype=float),
+    out_sliced: wp.array2d(dtype=float),
     out_offset: wp.array2d(dtype=float),
 ):
     full0 = wp.tile_load(input, shape=(TILE_M, TILE_N))
     padded0 = wp.tile_load(input, shape=(TILE_M, TILE_N), offset=(TILE_OFFSET, TILE_OFFSET))
+    sliced0 = wp.tile_load(input[::2, ::2], shape=(TILE_M, TILE_N))
 
     wp.tile_store(out_full, full0)
     wp.tile_store(out_padded, padded0)
+    wp.tile_store(out_sliced, sliced0)
     wp.tile_store(out_offset, full0, offset=(TILE_OFFSET, TILE_OFFSET))
 
 
@@ -75,13 +84,16 @@ def tile_load_3d_kernel(
     input: wp.array3d(dtype=float),
     out_full: wp.array3d(dtype=float),
     out_padded: wp.array3d(dtype=float),
+    out_sliced: wp.array3d(dtype=float),
     out_offset: wp.array3d(dtype=float),
 ):
     full0 = wp.tile_load(input, shape=(TILE_M, TILE_N, TILE_O))
     padded0 = wp.tile_load(input, shape=(TILE_M, TILE_N, TILE_O), offset=(TILE_OFFSET, TILE_OFFSET, TILE_OFFSET))
+    sliced0 = wp.tile_load(input[::2, ::2, ::2], shape=(TILE_M, TILE_N, TILE_O))
 
     wp.tile_store(out_full, full0)
     wp.tile_store(out_padded, padded0)
+    wp.tile_store(out_sliced, sliced0)
     wp.tile_store(out_offset, full0, offset=(TILE_OFFSET, TILE_OFFSET, TILE_OFFSET))
 
 
@@ -90,15 +102,18 @@ def tile_load_4d_kernel(
     input: wp.array4d(dtype=float),
     out_full: wp.array4d(dtype=float),
     out_padded: wp.array4d(dtype=float),
+    out_sliced: wp.array4d(dtype=float),
     out_offset: wp.array4d(dtype=float),
 ):
     full0 = wp.tile_load(input, shape=(TILE_M, TILE_N, TILE_O, TILE_P))
     padded0 = wp.tile_load(
         input, shape=(TILE_M, TILE_N, TILE_O, TILE_P), offset=(TILE_OFFSET, TILE_OFFSET, TILE_OFFSET, TILE_OFFSET)
     )
+    sliced0 = wp.tile_load(input[::2, ::2, ::2, ::2], shape=(TILE_M, TILE_N, TILE_O, TILE_P))
 
     wp.tile_store(out_full, full0)
     wp.tile_store(out_padded, padded0)
+    wp.tile_store(out_sliced, sliced0)
     wp.tile_store(out_offset, full0, offset=(TILE_OFFSET, TILE_OFFSET, TILE_OFFSET, TILE_OFFSET))
 
 
@@ -112,13 +127,14 @@ def test_tile_load(kernel, ndim):
         input = wp.array(rng.random(shape), dtype=float, requires_grad=True, device=device)
         output_full = wp.zeros(shape, dtype=float, device=device)
         output_padded = wp.zeros(shape, dtype=float, device=device)
+        output_sliced = wp.zeros(shape, dtype=float, device=device)
         output_offset = wp.zeros(shape, dtype=float, device=device)
 
         with wp.Tape() as tape:
             wp.launch_tiled(
                 kernel,
                 dim=[1],
-                inputs=[input, output_full, output_padded, output_offset],
+                inputs=[input, output_full, output_padded, output_sliced, output_offset],
                 block_dim=TILE_DIM,
                 device=device,
             )
@@ -134,8 +150,16 @@ def test_tile_load(kernel, ndim):
         ref_offset = np.zeros_like(ref_full)
         ref_offset[src_slice] = ref_full[dest_slice]
 
+        # construct a slice for the source/dest sliced arrays
+        src_slice = tuple(slice(0, dim, 2) for dim in shape)
+        dest_slice = tuple(slice(0, (dim + 1) // 2) for dim in shape)
+
+        ref_sliced = np.zeros_like(ref_full)
+        ref_sliced[dest_slice] = ref_full[src_slice]
+
         assert_np_equal(output_full.numpy(), ref_full)
         assert_np_equal(output_padded.numpy(), ref_padded)
+        assert_np_equal(output_sliced.numpy(), ref_sliced)
         assert_np_equal(output_offset.numpy(), ref_offset)
 
         output_full.grad = wp.ones_like(output_full)
diff --git a/warp/tests/unittest_suites.py b/warp/tests/unittest_suites.py
index 440c5ff2..ba811e81 100644
--- a/warp/tests/unittest_suites.py
+++ b/warp/tests/unittest_suites.py
@@ -113,17 +113,12 @@ def default_suite(test_loader: unittest.TestLoader = unittest.defaultTestLoader)
     from warp.tests.interop.test_dlpack import TestDLPack
     from warp.tests.interop.test_jax import TestJax
     from warp.tests.interop.test_torch import TestTorch
-    from warp.tests.sim.test_cloth import TestCloth
-    from warp.tests.sim.test_collision import TestCollision
-    from warp.tests.sim.test_coloring import TestColoring
-    from warp.tests.sim.test_model import TestModel
-    from warp.tests.sim.test_sim_grad import TestSimGradients
-    from warp.tests.sim.test_sim_kinematics import TestSimKinematics
     from warp.tests.test_adam import TestAdam
     from warp.tests.test_arithmetic import TestArithmetic
     from warp.tests.test_array import TestArray
     from warp.tests.test_array_reduce import TestArrayReduce
     from warp.tests.test_atomic import TestAtomic
+    from warp.tests.test_atomic_bitwise import TestAtomicBitwise
     from warp.tests.test_atomic_cas import TestAtomicCAS
     from warp.tests.test_bool import TestBool
     from warp.tests.test_builtins_resolution import TestBuiltinsResolution
@@ -142,7 +137,6 @@ def default_suite(test_loader: unittest.TestLoader = unittest.defaultTestLoader)
         TestFemDiffusionExamples,
         TestFemExamples,
         TestOptimExamples,
-        TestSimExamples,
     )
     from warp.tests.test_fabricarray import TestFabricArray
     from warp.tests.test_fast_math import TestFastMath
@@ -199,6 +193,7 @@ def default_suite(test_loader: unittest.TestLoader = unittest.defaultTestLoader)
     from warp.tests.test_vec_scalar_ops import TestVecScalarOps
     from warp.tests.test_verify_fp import TestVerifyFP
     from warp.tests.tile.test_tile import TestTile
+    from warp.tests.tile.test_tile_atomic_bitwise import TestTileAtomicBitwise
     from warp.tests.tile.test_tile_cholesky import TestTileCholesky
     from warp.tests.tile.test_tile_load import TestTileLoad
     from warp.tests.tile.test_tile_mathdx import TestTileMathDx
@@ -215,16 +210,14 @@ def default_suite(test_loader: unittest.TestLoader = unittest.defaultTestLoader)
         TestArrayReduce,
         TestAsync,
         TestAtomic,
+        TestAtomicBitwise,
         TestAtomicCAS,
         TestBool,
         TestBuiltinsResolution,
         TestBvh,
         TestClosestPointEdgeEdgeMethods,
-        TestCloth,
         TestCodeGen,
         TestCodeGenInstancing,
-        TestCollision,
-        TestColoring,
         TestConditional,
         TestConstants,
         TestContext,
@@ -237,7 +230,6 @@ def default_suite(test_loader: unittest.TestLoader = unittest.defaultTestLoader)
         TestFemDiffusionExamples,
         TestFemExamples,
         TestOptimExamples,
-        TestSimExamples,
         TestFabricArray,
         TestFastMath,
         TestFem,
@@ -272,7 +264,6 @@ def default_suite(test_loader: unittest.TestLoader = unittest.defaultTestLoader)
         TestMeshQueryAABBMethods,
         TestMeshQueryPoint,
         TestMeshQueryRay,
-        TestModel,
         TestModuleHashing,
         TestModuleLite,
         TestMultiGPU,
@@ -289,8 +280,6 @@ def default_suite(test_loader: unittest.TestLoader = unittest.defaultTestLoader)
         TestRounding,
         TestRunlengthEncode,
         TestScalarOps,
-        TestSimGradients,
-        TestSimKinematics,
         TestSmoothstep,
         TestSnippets,
         TestSparse,
@@ -301,6 +290,7 @@ def default_suite(test_loader: unittest.TestLoader = unittest.defaultTestLoader)
         TestStruct,
         TestTape,
         TestTile,
+        TestTileAtomicBitwise,
         TestTileCholesky,
         TestTileLoad,
         TestTileMathDx,
diff --git a/warp/tests/unittest_utils.py b/warp/tests/unittest_utils.py
index ded83555..1c80887d 100644
--- a/warp/tests/unittest_utils.py
+++ b/warp/tests/unittest_utils.py
@@ -376,24 +376,25 @@ def write_junit_results(
     )
 
     for test_data in test_records:
-        test = test_data[0]
-        test_duration = test_data[1]
-        test_status = test_data[2]
+        test_classname = test_data[0]
+        test_methodname = test_data[1]
+        test_duration = test_data[2]
+        test_status = test_data[3]
 
         test_case = ET.SubElement(
-            root, "testcase", classname=test.__class__.__name__, name=test._testMethodName, time=f"{test_duration:.3f}"
+            root, "testcase", classname=test_classname, name=test_methodname, time=f"{test_duration:.3f}"
         )
 
         if test_status == "FAIL":
-            failure = ET.SubElement(test_case, "failure", message=str(test_data[3]))
-            failure.text = str(test_data[4])  # Stacktrace
+            failure = ET.SubElement(test_case, "failure", message=str(test_data[4]))
+            failure.text = str(test_data[5])  # Stacktrace
         elif test_status == "ERROR":
             error = ET.SubElement(test_case, "error")
-            error.text = str(test_data[4])  # Stacktrace
+            error.text = str(test_data[5])  # Stacktrace
         elif test_status == "SKIP":
             skip = ET.SubElement(test_case, "skipped")
             # Set the skip reason
-            skip.set("message", str(test_data[3]))
+            skip.set("message", str(test_data[4]))
 
     tree = ET.ElementTree(root)
 
@@ -425,7 +426,7 @@ class ParallelJunitTestResult(unittest.TextTestResult):
 
     def _record_test(self, test, code, message=None, details=None):
         duration = round((time.perf_counter_ns() - self.start_time) * 1e-9, 3)  # [s]
-        self.test_record.append((test, duration, code, message, details))
+        self.test_record.append((test.__class__.__name__, test._testMethodName, duration, code, message, details))
 
     def addSuccess(self, test):
         super(unittest.TextTestResult, self).addSuccess(test)
diff --git a/warp/types.py b/warp/types.py
index d57099a8..3f08fa83 100644
--- a/warp/types.py
+++ b/warp/types.py
@@ -2031,6 +2031,10 @@ def is_tuple(t) -> builtins.bool:
     return isinstance(t, tuple_t)
 
 
+def is_slice(t) -> builtins.bool:
+    return isinstance(t, slice_t)
+
+
 def scalars_equal(a, b, match_generic=False):
     # convert to canonical types
     if a == float:
@@ -2161,6 +2165,9 @@ def types_equal(a, b, match_generic=False):
     if is_tile(a) and is_tile(b):
         return True
 
+    if is_slice(a) and is_slice(b):
+        return True
+
     return scalars_equal(a, b, match_generic)
 
 
@@ -2881,7 +2888,7 @@ class array(Array[DType]):
                 # Performance note: avoid wrapping the external stream in a temporary Stream object
                 if stream != array_stream.cuda_stream:
                     warp.context.runtime.core.wp_cuda_stream_wait_stream(
-                        stream, array_stream.cuda_stream, array_stream.cached_event.cuda_event
+                        stream, array_stream.cuda_stream, array_stream.cached_event.cuda_event, False
                     )
             elif self.device.is_cpu:
                 # on CPU, stream must be None or -1
@@ -4143,6 +4150,59 @@ class Bvh:
             self.runtime.core.wp_bvh_refit_device(self.id)
             self.runtime.verify_cuda_device(self.device)
 
+    def rebuild(self, constructor: str | None = None):
+        """Rebuild the BVH hierarchy **in place** from the current ``lowers``/``uppers`` arrays.
+
+        This method does not allocate new memory; it reuses the existing BVH buffers.
+
+        Unlike :meth:`refit`, which only tightens parent AABBs while preserving the existing
+        tree topology, ``rebuild`` discards the old hierarchy and constructs a new one. Use
+        this when primitive distributions change significantly (large deformations,
+        insertions/removals, or reordered items), or when you want to switch construction
+        algorithms.
+
+        Args:
+            constructor (str | None): Construction algorithm to use. One of ``"sah"``,
+                ``"median"``, ``"lbvh"``, or ``None``. If ``None``, the default is chosen
+                based on the device (CPU  ``"sah"``, CUDA  ``"lbvh"``). On CPU,
+                ``"sah"`` and ``"median"`` are supported; requesting ``"lbvh"`` falls back
+                to ``"sah"`` with a warning. On CUDA, in-place rebuild supports ``"lbvh"``
+                only; other values fall back to ``"lbvh"`` with a warning.
+
+        Notes:
+            - This method is CUDA graph-capture safe: previously captured graphs that include
+              queries on this BVH remain valid after ``rebuild`` because buffers are reused.
+            - If you need a CPU top-down constructor (``"sah"``/``"median"``) for a GPU tree,
+              create a new BVH via the class constructor instead.
+
+        Raises:
+            ValueError: If an unknown constructor is provided.
+        """
+        if constructor is None:
+            if self.device.is_cpu:
+                constructor = "sah"
+            else:
+                constructor = "lbvh"
+
+        if constructor not in bvh_constructor_values:
+            raise ValueError(f"Unrecognized BVH constructor type: {constructor}")
+
+        if self.device.is_cpu:
+            if constructor == "lbvh":
+                warp.utils.warn(
+                    "LBVH constructor is not available for a CPU tree. Falling back to SAH constructor.", stacklevel=2
+                )
+                constructor = "sah"
+            self.runtime.core.wp_bvh_rebuild_host(self.id, bvh_constructor_values[constructor])
+        else:
+            if constructor != "lbvh":
+                warp.utils.warn(
+                    "In-place rebuild method on the CUDA device only supports LBVH constructor. Falling back to LBVH constructor.",
+                    stacklevel=2,
+                )
+            self.runtime.core.wp_bvh_rebuild_device(self.id)
+            self.runtime.verify_cuda_device(self.device)
+
 
 class Mesh:
     from warp.codegen import Var
@@ -4658,8 +4718,7 @@ class Volume:
         """Create a :class:`Volume` object from a serialized NanoVDB file or in-memory buffer.
 
         Returns:
-
-            A ``warp.Volume`` object.
+            A :class:`Volume` object.
         """
         try:
             data = file_or_buffer.read()
@@ -4718,14 +4777,16 @@ class Volume:
         return cls(data_array)
 
     def save_to_nvdb(self, path, codec: Literal["none", "zip", "blosc"] = "none"):
-        """Serialize the Volume into a NanoVDB (.nvdb) file.
+        """Serialize the :class:`Volume` into a NanoVDB (``.nvdb``) file.
 
         Args:
-            path: File path to save.
-            codec: Compression codec used
-                "none" - no compression
-                "zip" - ZIP compression
-                "blosc" - BLOSC compression, requires the blosc module to be installed
+            path: File path where the ``.nvdb`` file will be saved.
+            codec: Compression codec to use. Defaults to ``"none"``.
+                Available options:
+
+                - ``"none"`` - No compression
+                - ``"zip"`` - ZIP compression
+                - ``"blosc"`` - BLOSC compression (requires ``blosc`` package)
         """
 
         codec_dict = {"none": 0, "zip": 1, "blosc": 2}
@@ -4852,23 +4913,30 @@ class Volume:
 
     @classmethod
     def load_from_address(cls, grid_ptr: int, buffer_size: int = 0, device=None) -> Volume:
-        """
-        Creates a new :class:`Volume` aliasing an in-memory grid buffer.
+        """Create a new :class:`Volume` aliasing an in-memory grid buffer.
 
         In contrast to :meth:`load_from_nvdb` which should be used to load serialized NanoVDB grids,
         here the buffer must be uncompressed and must not contain file header information.
         If the passed address does not contain a NanoVDB grid, the behavior of this function is undefined.
 
         Args:
-            grid_ptr: Integer address of the start of the grid buffer
-            buffer_size: Size of the buffer, in bytes. If not provided, the size will be assumed to be that of the single grid starting at `grid_ptr`.
-            device: Device of the buffer, and of the returned Volume. If not provided, the current Warp device is assumed.
+            grid_ptr: Integer address of the start of the grid buffer.
+            buffer_size: Size of the buffer, in bytes.
+              If not provided, the size will be assumed to be that of the single grid starting at ``grid_ptr``.
+            device: Device of the buffer and of the returned :class:`Volume`.
+              If not provided, the current Warp device is assumed.
+
+        Returns:
+            The newly created :class:`Volume`.
 
-        Returns the newly created Volume.
+        Raises:
+            RuntimeError: If ``grid_ptr`` is invalid (null pointer).
+            RuntimeError: If a Warp Volume has already been created for this grid address.
         """
+        warp.init()
 
         if not grid_ptr:
-            raise (RuntimeError, "Invalid grid buffer pointer")
+            raise RuntimeError("Invalid grid buffer pointer")
 
         # Check that a Volume has not already been created for this address
         # (to allow this we would need to ref-count the volume descriptor)
@@ -4879,22 +4947,21 @@ class Volume:
         )
 
         if existing_buf.value is not None:
-            raise RuntimeError(
-                "A warp Volume has already been created for this grid, aliasing it more than once is not possible."
-            )
+            raise RuntimeError("A Warp Volume has already been created for this grid, aliasing it is not possible.")
 
         data_array = array(ptr=grid_ptr, dtype=uint8, shape=buffer_size, device=device)
 
         return cls(data_array, copy=False)
 
-    def load_next_grid(self) -> Volume:
-        """
-        Tries to create a new warp Volume for the next grid that is linked to by this Volume.
+    def load_next_grid(self) -> Volume | None:
+        """Create a new :class:`Volume` for the next grid that is linked to by this :class:`Volume`.
 
-        The existence of a next grid is deduced from the `grid_index` and `grid_count` metadata
-        as well as the size of this Volume's in-memory buffer.
+        The existence of a next grid is determined by checking if there are more grids in the sequence
+        (based on ``grid_index`` and ``grid_count`` metadata) and if there is sufficient buffer space
+        remaining in this :class:`Volume`'s in-memory buffer.
 
-        Returns the newly created Volume, or None if there is no next grid.
+        Returns:
+            The newly created :class:`Volume`, or ``None`` if there is no next grid.
         """
 
         grid = self.get_grid_info()
@@ -4907,16 +4974,16 @@ class Volume:
         next_volume = Volume.load_from_address(
             array.ptr + grid.size_in_bytes, buffer_size=array.capacity - grid.size_in_bytes, device=self.device
         )
-        # makes the new Volume keep a reference to the current grid, as we're aliasing its buffer
+        # Make the new Volume keep a reference to the current grid, as we're aliasing its buffer
         next_volume._previous_grid = self
 
         return next_volume
 
     @classmethod
     def load_from_numpy(
-        cls, ndarray: np.array, min_world=(0.0, 0.0, 0.0), voxel_size=1.0, bg_value=0.0, device=None
+        cls, ndarray: np.ndarray, min_world=(0.0, 0.0, 0.0), voxel_size=1.0, bg_value=0.0, device=None
     ) -> Volume:
-        """Creates a Volume object from a dense 3D NumPy array.
+        """Create a :class:`Volume` object from a dense 3D NumPy array.
 
         This function is only supported for CUDA devices.
 
@@ -4930,9 +4997,6 @@ class Volume:
 
             A ``warp.Volume`` object.
         """
-
-        import math
-
         target_shape = (
             math.ceil(ndarray.shape[0] / 8) * 8,
             math.ceil(ndarray.shape[1] / 8) * 8,
@@ -4950,12 +5014,15 @@ class Volume:
                 math.ceil(ndarray.shape[1] / 8) * 8 - ndarray.shape[1],
                 math.ceil(ndarray.shape[2] / 8) * 8 - ndarray.shape[2],
             )
-            padded_array = np.pad(
-                ndarray,
-                ((0, padded_amount[0]), (0, padded_amount[1]), (0, padded_amount[2])),
-                mode="constant",
-                constant_values=bg_value,
+
+            # Manual padding to avoid np.pad compatibility issues with code coverage tools (e.g., coverage.py)
+            target_shape = (
+                ndarray.shape[0] + padded_amount[0],
+                ndarray.shape[1] + padded_amount[1],
+                ndarray.shape[2] + padded_amount[2],
             )
+            padded_array = np.full(target_shape, bg_value, dtype=ndarray.dtype)
+            padded_array[: ndarray.shape[0], : ndarray.shape[1], : ndarray.shape[2]] = ndarray
 
         shape = padded_array.shape
         volume = warp.Volume.allocate(
@@ -5022,11 +5089,11 @@ class Volume:
         Args:
             min (array-like): Lower 3D coordinates of the bounding box in index space or world space, inclusive.
             max (array-like): Upper 3D coordinates of the bounding box in index space or world space, inclusive.
-            voxel_size (float): Voxel size of the new volume.
-            bg_value (float or array-like): Value of unallocated voxels of the volume, also defines the volume's type, a :class:`warp.vec3` volume is created if this is `array-like`, otherwise a float volume is created
-            translation (array-like): translation between the index and world spaces.
-            device (Devicelike): The CUDA device to create the volume on, e.g.: "cuda" or "cuda:0".
-
+            voxel_size: Voxel size of the new volume.
+            bg_value (float or array-like): Value of unallocated voxels of the volume, also defines the volume's type,
+              a :class:`warp.vec3` volume is created if this is `array-like`, otherwise a float volume is created
+            translation (array-like): Translation between the index and world spaces.
+            device (Devicelike): The CUDA device to create the volume on, e.g.: ``"cuda"`` or ``"cuda:0"``.
         """
         if points_in_world_space:
             min = np.around((np.array(min, dtype=np.float32) - translation) / voxel_size)
@@ -5049,8 +5116,8 @@ class Volume:
 
     @staticmethod
     def _fill_transform_buffers(
-        voxel_size: float | list[float],
-        translation,
+        voxel_size: float | list[float] | tuple[float, float, float] | None,
+        translation: list[float] | tuple[float, float, float],
         transform,
     ):
         if transform is None:
@@ -5085,28 +5152,31 @@ class Volume:
         device=None,
         transform=None,
     ) -> Volume:
-        """Allocate a new Volume with active tiles for each point tile_points.
+        """Allocate a new :class:`Volume` with active tiles for each point ``tile_points``.
 
         This function is only supported for CUDA devices.
 
         The smallest unit of allocation is a dense tile of 8x8x8 voxels.
-        This is the primary method for allocating sparse volumes. It uses an array of points indicating the tiles that must be allocated.
+        This is the primary method for allocating sparse volumes.
+        It uses an array of points indicating the tiles that must be allocated.
 
         Example use cases:
-            * `tile_points` can mark tiles directly in index space as in the case this method is called by `allocate`.
-            * `tile_points` can be a list of points used in a simulation that needs to transfer data to a volume.
+            * ``tile_points`` can mark tiles directly in index space as in the case this method is called by :meth:`allocate`.
+            * ``tile_points`` can be a list of points used in a simulation that needs to transfer data to a volume.
 
         Args:
             tile_points (:class:`warp.array`): Array of positions that define the tiles to be allocated.
-                The array may use an integer scalar type (2D N-by-3 array of :class:`warp.int32` or 1D array of `warp.vec3i` values), indicating index space positions,
-                or a floating point scalar type (2D N-by-3 array of :class:`warp.float32` or 1D array of `warp.vec3f` values), indicating world space positions.
-                Repeated points per tile are allowed and will be efficiently deduplicated.
-            voxel_size (float or array-like): Voxel size(s) of the new volume. Ignored if `transform` is given.
-            bg_value (array-like, scalar or None): Value of unallocated voxels of the volume, also defines the volume's type. An index volume will be created if `bg_value` is ``None``.
-              Other supported grid types are `int`, `float`, `vec3f`, and `vec4f`.
+              The array may use an integer scalar type (2D N-by-3 array of :class:`warp.int32` or 1D array of :class:`warp.vec3i` values), indicating index space positions,
+              or a floating point scalar type (2D N-by-3 array of :class:`warp.float32` or 1D array of :class:`warp.vec3f` values), indicating world space positions.
+              Repeated points per tile are allowed and will be efficiently deduplicated.
+            voxel_size (float or array-like): Voxel size(s) of the new volume. Ignored if ``transform`` is given.
+            bg_value (array-like, scalar or None): Value of unallocated voxels of the volume, also defines the volume's type.
+              An index volume will be created if ``bg_value`` is ``None``.
+              Other supported grid types are ``int``, ``float``, ``vec3f``, and ``vec4f``.
             translation (array-like): Translation between the index and world spaces.
-            transform (array-like): Linear transform between the index and world spaces. If ``None``, deduced from `voxel_size`.
-            device (Devicelike): The CUDA device to create the volume on, e.g.: "cuda" or "cuda:0".
+            transform (array-like): Linear transform between the index and world spaces.
+              If ``None``, deduced from ``voxel_size``.
+            device (Devicelike): The CUDA device to create the volume on, e.g. ``"cuda"`` or ``"cuda:0"``.
 
         """
         device = warp.get_device(device)
@@ -5147,9 +5217,9 @@ class Volume:
             # look for corresponding nvdb type
             try:
                 nvdb_type = next(
-                    typ
-                    for typ in Volume._supported_allocation_types
-                    if types_equal(grid_type, Volume._nvdb_type_to_dtype[typ])
+                    alloc_type
+                    for alloc_type in Volume._supported_allocation_types
+                    if types_equal(grid_type, Volume._nvdb_type_to_dtype[alloc_type])
                 )
             except StopIteration as err:
                 raise TypeError(
@@ -5192,9 +5262,9 @@ class Volume:
         device=None,
         transform=None,
     ) -> Volume:
-        """Allocate a new Volume with active voxel for each point voxel_points.
+        """Allocate a new :class:`Volume` with active voxel for each point ``voxel_points``.
 
-        This function creates an *index* Volume, a special kind of volume that does not any store any
+        This function creates an *index* volume, a special kind of volume that does not any store any
         explicit payload but encodes a linearized index for each active voxel, allowing to lookup and
         sample data from arbitrary external arrays.
 
@@ -5202,14 +5272,21 @@ class Volume:
 
         Args:
             voxel_points (:class:`warp.array`): Array of positions that define the voxels to be allocated.
-                The array may use an integer scalar type (2D N-by-3 array of :class:`warp.int32` or 1D array of `warp.vec3i` values), indicating index space positions,
-                or a floating point scalar type (2D N-by-3 array of :class:`warp.float32` or 1D array of `warp.vec3f` values), indicating world space positions.
+                The array may use an integer scalar type (2D N-by-3 array of :class:`warp.int32` or 1D array of :class:`warp.vec3i` values), indicating index space positions,
+                or a floating point scalar type (2D N-by-3 array of :class:`warp.float32` or 1D array of :class:`warp.vec3f` values), indicating world space positions.
                 Repeated points per tile are allowed and will be efficiently deduplicated.
-            voxel_size (float or array-like): Voxel size(s) of the new volume. Ignored if `transform` is given.
+            voxel_size (float or array-like): Voxel size(s) of the new volume. Ignored if ``transform`` is given.
             translation (array-like): Translation between the index and world spaces.
-            transform (array-like): Linear transform between the index and world spaces. If ``None``, deduced from `voxel_size`.
-            device (Devicelike): The CUDA device to create the volume on, e.g.: "cuda" or "cuda:0".
+            transform (array-like): Linear transform between the index and world spaces.
+              If ``None``, deduced from ``voxel_size``.
+            device (Devicelike): The CUDA device to create the volume on, e.g. ``"cuda"`` or ``"cuda:0"``.
 
+        Raises:
+            RuntimeError: If the ``device`` is not a CUDA device.
+            RuntimeError: If ``voxel_points`` is not a contiguous array of the correct type and shape.
+            RuntimeError: If :class:`Volume` creation fails.
+            ValueError: If neither ``voxel_size`` nor ``transform`` is provided.
+            ValueError: If both ``voxel_size`` and ``transform`` are provided.
         """
         device = warp.get_device(device)
 
@@ -5217,7 +5294,7 @@ class Volume:
             raise RuntimeError("Only CUDA devices are supported for allocate_by_tiles")
         if not _is_contiguous_vec_like_array(voxel_points, vec_length=3, scalar_types=(float32, int32)):
             raise RuntimeError(
-                "voxel_points must be contiguous and either a 1D warp array of vec3f or vec3i or a 2D n-by-3 array of int32 or float32."
+                "voxel_points must be contiguous and either a 1D Warp array of vec3f or vec3i or a 2D n-by-3 array of int32 or float32."
             )
         if not voxel_points.device.is_cuda:
             voxel_points = voxel_points.to(device)
diff --git a/warp/utils.py b/warp/utils.py
index fdc6f5be..d04f587e 100644
--- a/warp/utils.py
+++ b/warp/utils.py
@@ -62,7 +62,7 @@ def warp_showwarning(message, category, filename, lineno, file=None, line=None):
     sys.stdout.write(s)
 
 
-def warn(message, category=None, stacklevel=1):
+def warn(message, category=None, stacklevel=1, once=False):
     if (category, message) in warnings_seen:
         return
 
@@ -75,7 +75,7 @@ def warn(message, category=None, stacklevel=1):
             stacklevel=stacklevel + 1,  # Increment stacklevel by 1 since we are in a wrapper
         )
 
-    if category is DeprecationWarning:
+    if category is DeprecationWarning or once:
         warnings_seen.add((category, message))
 
 
